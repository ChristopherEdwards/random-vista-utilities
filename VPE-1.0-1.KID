KIDS Distribution saved on Jun 17, 2012@20:05:53
TMGVPE*1.0*1
**KIDS**:TMGVPE*1.0*1^

**INSTALL NAME**
TMGVPE*1.0*1
"BLD",7671,0)
TMGVPE*1.0*1^^0^3120617^n
"BLD",7671,4,0)
^9.64PA^^
"BLD",7671,6.3)
8
"BLD",7671,"INI")
ZVEMBLD
"BLD",7671,"INID")
^^n
"BLD",7671,"KRN",0)
^9.67PA^8989.52^19
"BLD",7671,"KRN",.4,0)
.4
"BLD",7671,"KRN",.401,0)
.401
"BLD",7671,"KRN",.402,0)
.402
"BLD",7671,"KRN",.403,0)
.403
"BLD",7671,"KRN",.5,0)
.5
"BLD",7671,"KRN",.84,0)
.84
"BLD",7671,"KRN",3.6,0)
3.6
"BLD",7671,"KRN",3.8,0)
3.8
"BLD",7671,"KRN",9.2,0)
9.2
"BLD",7671,"KRN",9.8,0)
9.8
"BLD",7671,"KRN",9.8,"NM",0)
^9.68A^258^258
"BLD",7671,"KRN",9.8,"NM",1,0)
%ZVEMD^^0^B10478433
"BLD",7671,"KRN",9.8,"NM",2,0)
%ZVEMD1^^0^B4709729
"BLD",7671,"KRN",9.8,"NM",3,0)
%ZVEMDC^^0^B4289514
"BLD",7671,"KRN",9.8,"NM",4,0)
%ZVEMDI^^0^B24029726
"BLD",7671,"KRN",9.8,"NM",5,0)
%ZVEMDL^^0^B13756810
"BLD",7671,"KRN",9.8,"NM",6,0)
%ZVEMDL1^^0^B3976794
"BLD",7671,"KRN",9.8,"NM",7,0)
%ZVEMDLB^^0^B4986436
"BLD",7671,"KRN",9.8,"NM",8,0)
%ZVEMDLD^^0^B10779468
"BLD",7671,"KRN",9.8,"NM",9,0)
%ZVEMDLE^^0^B9238671
"BLD",7671,"KRN",9.8,"NM",10,0)
%ZVEMDLI^^0^B6091257
"BLD",7671,"KRN",9.8,"NM",11,0)
%ZVEMDLM^^0^B2800089
"BLD",7671,"KRN",9.8,"NM",12,0)
%ZVEMDM^^0^B8642981
"BLD",7671,"KRN",9.8,"NM",13,0)
%ZVEMDN^^0^B8463697
"BLD",7671,"KRN",9.8,"NM",14,0)
%ZVEMDPR^^0^B6063778
"BLD",7671,"KRN",9.8,"NM",15,0)
%ZVEMDPT^^0^B9827584
"BLD",7671,"KRN",9.8,"NM",16,0)
%ZVEMDT^^0^B11008890
"BLD",7671,"KRN",9.8,"NM",17,0)
%ZVEMDU^^0^B8947117
"BLD",7671,"KRN",9.8,"NM",18,0)
%ZVEMDU1^^0^B9635629
"BLD",7671,"KRN",9.8,"NM",19,0)
%ZVEMDUM^^0^B1441935
"BLD",7671,"KRN",9.8,"NM",20,0)
%ZVEMDX^^0^B10711387
"BLD",7671,"KRN",9.8,"NM",21,0)
%ZVEMDXK^^0^B25603477
"BLD",7671,"KRN",9.8,"NM",22,0)
%ZVEMDY^^0^B5182538
"BLD",7671,"KRN",9.8,"NM",23,0)
%ZVEMG^^0^B9001932
"BLD",7671,"KRN",9.8,"NM",24,0)
%ZVEMG1^^0^B9010287
"BLD",7671,"KRN",9.8,"NM",25,0)
%ZVEMGE^^0^B10962303
"BLD",7671,"KRN",9.8,"NM",26,0)
%ZVEMGE1^^0^B11391965
"BLD",7671,"KRN",9.8,"NM",27,0)
%ZVEMGI^^0^B13539956
"BLD",7671,"KRN",9.8,"NM",28,0)
%ZVEMGI1^^0^B7075695
"BLD",7671,"KRN",9.8,"NM",29,0)
%ZVEMGM^^0^B3844221
"BLD",7671,"KRN",9.8,"NM",30,0)
%ZVEMGM1^^0^B6805273
"BLD",7671,"KRN",9.8,"NM",31,0)
%ZVEMGMC^^0^B7051341
"BLD",7671,"KRN",9.8,"NM",32,0)
%ZVEMGO^^0^B9914414
"BLD",7671,"KRN",9.8,"NM",33,0)
%ZVEMGP^^0^B14985118
"BLD",7671,"KRN",9.8,"NM",34,0)
%ZVEMGPI^^0^B10673644
"BLD",7671,"KRN",9.8,"NM",35,0)
%ZVEMGPS^^0^B12242122
"BLD",7671,"KRN",9.8,"NM",36,0)
%ZVEMGR^^0^B10985096
"BLD",7671,"KRN",9.8,"NM",37,0)
%ZVEMGR1^^0^B7973256
"BLD",7671,"KRN",9.8,"NM",38,0)
%ZVEMGS^^0^B5117917
"BLD",7671,"KRN",9.8,"NM",39,0)
%ZVEMGU^^0^B11574955
"BLD",7671,"KRN",9.8,"NM",40,0)
%ZVEMGUM^^0^B7165094
"BLD",7671,"KRN",9.8,"NM",41,0)
%ZVEMGY^^0^B5986665
"BLD",7671,"KRN",9.8,"NM",42,0)
%ZVEMKC^^0^B5704374
"BLD",7671,"KRN",9.8,"NM",43,0)
%ZVEMKDT^^0^B3570788
"BLD",7671,"KRN",9.8,"NM",44,0)
%ZVEMKE^^0^B2692713
"BLD",7671,"KRN",9.8,"NM",45,0)
%ZVEMKEA^^0^B6796846
"BLD",7671,"KRN",9.8,"NM",46,0)
%ZVEMKEB^^0^B5376375
"BLD",7671,"KRN",9.8,"NM",47,0)
%ZVEMKEC^^0^B6325382
"BLD",7671,"KRN",9.8,"NM",48,0)
%ZVEMKI1^^0^B20221277
"BLD",7671,"KRN",9.8,"NM",49,0)
%ZVEMKI2^^0^B12959090
"BLD",7671,"KRN",9.8,"NM",50,0)
%ZVEMKI3^^0^B8222940
"BLD",7671,"KRN",9.8,"NM",51,0)
%ZVEMKI4^^0^B18106983
"BLD",7671,"KRN",9.8,"NM",52,0)
%ZVEMKI5^^0^B5430472
"BLD",7671,"KRN",9.8,"NM",53,0)
%ZVEMKP^^0^B3113408
"BLD",7671,"KRN",9.8,"NM",54,0)
%ZVEMKR^^0^B14104561
"BLD",7671,"KRN",9.8,"NM",55,0)
%ZVEMKRN^^0^B15013571
"BLD",7671,"KRN",9.8,"NM",56,0)
%ZVEMKST^^0^B6300535
"BLD",7671,"KRN",9.8,"NM",57,0)
%ZVEMKT^^0^B22043150
"BLD",7671,"KRN",9.8,"NM",58,0)
%ZVEMKT1^^0^B14147838
"BLD",7671,"KRN",9.8,"NM",59,0)
%ZVEMKT2^^0^B9094397
"BLD",7671,"KRN",9.8,"NM",60,0)
%ZVEMKTF^^0^B8528062
"BLD",7671,"KRN",9.8,"NM",61,0)
%ZVEMKTG^^0^B16365161
"BLD",7671,"KRN",9.8,"NM",62,0)
%ZVEMKTM^^0^B9733691
"BLD",7671,"KRN",9.8,"NM",63,0)
%ZVEMKTR^^0^B9585363
"BLD",7671,"KRN",9.8,"NM",64,0)
%ZVEMKTS^^0^B23445002
"BLD",7671,"KRN",9.8,"NM",65,0)
%ZVEMKTT^^0^B24892395
"BLD",7671,"KRN",9.8,"NM",66,0)
%ZVEMKTU^^0^B6452309
"BLD",7671,"KRN",9.8,"NM",67,0)
%ZVEMKU^^0^B9868565
"BLD",7671,"KRN",9.8,"NM",68,0)
%ZVEMKU1^^0^B4089605
"BLD",7671,"KRN",9.8,"NM",69,0)
%ZVEMKY^^0^B16890743
"BLD",7671,"KRN",9.8,"NM",70,0)
%ZVEMKY1^^0^B23953965
"BLD",7671,"KRN",9.8,"NM",71,0)
%ZVEMKY2^^0^B15983555
"BLD",7671,"KRN",9.8,"NM",72,0)
%ZVEMKY3^^0^B11891512
"BLD",7671,"KRN",9.8,"NM",73,0)
%ZVEMKYB^^0^B15050131
"BLD",7671,"KRN",9.8,"NM",74,0)
%ZVEMO^^0^B7291860
"BLD",7671,"KRN",9.8,"NM",75,0)
%ZVEMOC^^0^B7936734
"BLD",7671,"KRN",9.8,"NM",76,0)
%ZVEMOE^^0^B6408025
"BLD",7671,"KRN",9.8,"NM",77,0)
%ZVEMOE1^^0^B7353628
"BLD",7671,"KRN",9.8,"NM",78,0)
%ZVEMOE2^^0^B7354249
"BLD",7671,"KRN",9.8,"NM",79,0)
%ZVEMOEA^^0^B14759941
"BLD",7671,"KRN",9.8,"NM",80,0)
%ZVEMOEB^^0^B12992560
"BLD",7671,"KRN",9.8,"NM",81,0)
%ZVEMOEP^^0^B6447347
"BLD",7671,"KRN",9.8,"NM",82,0)
%ZVEMOEU^^0^B2466878
"BLD",7671,"KRN",9.8,"NM",83,0)
%ZVEMOM^^0^B16386258
"BLD",7671,"KRN",9.8,"NM",84,0)
%ZVEMOM1^^0^B7627930
"BLD",7671,"KRN",9.8,"NM",85,0)
%ZVEMOM2^^0^B3829163
"BLD",7671,"KRN",9.8,"NM",86,0)
%ZVEMOS^^0^B14540313
"BLD",7671,"KRN",9.8,"NM",87,0)
%ZVEMOSS^^0^B13672112
"BLD",7671,"KRN",9.8,"NM",88,0)
%ZVEMOU^^0^B12442978
"BLD",7671,"KRN",9.8,"NM",89,0)
%ZVEMOUM^^0^B6468509
"BLD",7671,"KRN",9.8,"NM",90,0)
%ZVEMOY^^0^B6885681
"BLD",7671,"KRN",9.8,"NM",91,0)
%ZVEMR^^0^B16523829
"BLD",7671,"KRN",9.8,"NM",92,0)
%ZVEMRC^^0^B11499880
"BLD",7671,"KRN",9.8,"NM",93,0)
%ZVEMRE^^0^B20271610
"BLD",7671,"KRN",9.8,"NM",94,0)
%ZVEMRE1^^0^B7818414
"BLD",7671,"KRN",9.8,"NM",95,0)
%ZVEMRE2^^0^B12026766
"BLD",7671,"KRN",9.8,"NM",96,0)
%ZVEMREA^^0^B12718966
"BLD",7671,"KRN",9.8,"NM",97,0)
%ZVEMREB^^0^B11045143
"BLD",7671,"KRN",9.8,"NM",98,0)
%ZVEMREJ^^0^B18152564
"BLD",7671,"KRN",9.8,"NM",99,0)
%ZVEMREL^^0^B8434496
"BLD",7671,"KRN",9.8,"NM",100,0)
%ZVEMREM^^0^B6609745
"BLD",7671,"KRN",9.8,"NM",101,0)
%ZVEMREO^^0^B12508668
"BLD",7671,"KRN",9.8,"NM",102,0)
%ZVEMREP^^0^B14865653
"BLD",7671,"KRN",9.8,"NM",103,0)
%ZVEMRER^^0^B7317936
"BLD",7671,"KRN",9.8,"NM",104,0)
%ZVEMREW^^0^B19826459
"BLD",7671,"KRN",9.8,"NM",105,0)
%ZVEMRI^^0^B8753383
"BLD",7671,"KRN",9.8,"NM",106,0)
%ZVEMRI1^^0^B5168975
"BLD",7671,"KRN",9.8,"NM",107,0)
%ZVEMRID^^0^B14750257
"BLD",7671,"KRN",9.8,"NM",108,0)
%ZVEMRIE^^0^B8946116
"BLD",7671,"KRN",9.8,"NM",109,0)
%ZVEMRLI^^0^B13102376
"BLD",7671,"KRN",9.8,"NM",110,0)
%ZVEMRLM^^0^B14216997
"BLD",7671,"KRN",9.8,"NM",111,0)
%ZVEMRLO^^0^B7193083
"BLD",7671,"KRN",9.8,"NM",112,0)
%ZVEMRLP^^0^B11509333
"BLD",7671,"KRN",9.8,"NM",113,0)
%ZVEMRLU^^0^B20570634
"BLD",7671,"KRN",9.8,"NM",114,0)
%ZVEMRLV^^0^B10522742
"BLD",7671,"KRN",9.8,"NM",115,0)
%ZVEMRLX^^0^B4096384
"BLD",7671,"KRN",9.8,"NM",116,0)
%ZVEMRLY^^0^B29479846
"BLD",7671,"KRN",9.8,"NM",117,0)
%ZVEMRLZ^^0^B39253979
"BLD",7671,"KRN",9.8,"NM",118,0)
%ZVEMRM^^0^B19495283
"BLD",7671,"KRN",9.8,"NM",119,0)
%ZVEMRM1^^0^B18500520
"BLD",7671,"KRN",9.8,"NM",120,0)
%ZVEMRM2^^0^B21594791
"BLD",7671,"KRN",9.8,"NM",121,0)
%ZVEMRMG^^0^B4267721
"BLD",7671,"KRN",9.8,"NM",122,0)
%ZVEMRMS^^0^B8655818
"BLD",7671,"KRN",9.8,"NM",123,0)
%ZVEMRP^^0^B21848818
"BLD",7671,"KRN",9.8,"NM",124,0)
%ZVEMRP1^^0^B13414292
"BLD",7671,"KRN",9.8,"NM",125,0)
%ZVEMRP2^^0^B23060620
"BLD",7671,"KRN",9.8,"NM",126,0)
%ZVEMRS^^0^B14888231
"BLD",7671,"KRN",9.8,"NM",127,0)
%ZVEMRS1^^0^B2657927
"BLD",7671,"KRN",9.8,"NM",128,0)
%ZVEMRSS^^0^B37014762
"BLD",7671,"KRN",9.8,"NM",129,0)
%ZVEMRU^^0^B12383017
"BLD",7671,"KRN",9.8,"NM",130,0)
%ZVEMRUM^^0^B6031618
"BLD",7671,"KRN",9.8,"NM",131,0)
%ZVEMRUS^^0^B1882935
"BLD",7671,"KRN",9.8,"NM",132,0)
%ZVEMRV^^0^B11657532
"BLD",7671,"KRN",9.8,"NM",133,0)
%ZVEMRY^^0^B6478655
"BLD",7671,"KRN",9.8,"NM",134,0)
%ZVEMSCL^^0^B9518950
"BLD",7671,"KRN",9.8,"NM",135,0)
%ZVEMSCU^^0^B1997187
"BLD",7671,"KRN",9.8,"NM",136,0)
%ZVEMSD^^0^B7235058
"BLD",7671,"KRN",9.8,"NM",137,0)
%ZVEMSF^^0^B19734632
"BLD",7671,"KRN",9.8,"NM",138,0)
%ZVEMSH^^0^B10700786
"BLD",7671,"KRN",9.8,"NM",139,0)
%ZVEMSHY^^0^B2140061
"BLD",7671,"KRN",9.8,"NM",140,0)
%ZVEMSID^^0^B12995482
"BLD",7671,"KRN",9.8,"NM",141,0)
%ZVEMSL^^0^B7444961
"BLD",7671,"KRN",9.8,"NM",142,0)
%ZVEMSNR^^0^B9487926
"BLD",7671,"KRN",9.8,"NM",143,0)
%ZVEMSO^^0^B6047197
"BLD",7671,"KRN",9.8,"NM",144,0)
%ZVEMSO1^^0^B4938296
"BLD",7671,"KRN",9.8,"NM",145,0)
%ZVEMSP^^0^B16409385
"BLD",7671,"KRN",9.8,"NM",146,0)
%ZVEMSPS^^0^B6417846
"BLD",7671,"KRN",9.8,"NM",147,0)
%ZVEMSQ^^0^B6921882
"BLD",7671,"KRN",9.8,"NM",148,0)
%ZVEMSQA^^0^B6445449
"BLD",7671,"KRN",9.8,"NM",149,0)
%ZVEMSQE^^0^B11786287
"BLD",7671,"KRN",9.8,"NM",150,0)
%ZVEMSQL^^0^B11218369
"BLD",7671,"KRN",9.8,"NM",151,0)
%ZVEMSQS^^0^B13199885
"BLD",7671,"KRN",9.8,"NM",152,0)
%ZVEMSQU^^0^B5028790
"BLD",7671,"KRN",9.8,"NM",153,0)
%ZVEMSQV^^0^B6095667
"BLD",7671,"KRN",9.8,"NM",154,0)
%ZVEMSQW^^0^B7543155
"BLD",7671,"KRN",9.8,"NM",155,0)
%ZVEMSRL^^0^B9215264
"BLD",7671,"KRN",9.8,"NM",156,0)
%ZVEMSS^^0^B14807749
"BLD",7671,"KRN",9.8,"NM",157,0)
%ZVEMSS1^^0^B7959367
"BLD",7671,"KRN",9.8,"NM",158,0)
%ZVEMST^^0^B12344059
"BLD",7671,"KRN",9.8,"NM",159,0)
%ZVEMSTO^^0^B9696495
"BLD",7671,"KRN",9.8,"NM",160,0)
%ZVEMSU^^0^B9492918
"BLD",7671,"KRN",9.8,"NM",161,0)
%ZVEMSU1^^0^B9294180
"BLD",7671,"KRN",9.8,"NM",162,0)
%ZVEMSU2^^0^B3775138
"BLD",7671,"KRN",9.8,"NM",163,0)
%ZVEMSY^^0^B24494812
"BLD",7671,"KRN",9.8,"NM",164,0)
%ZVEMSY1^^0^B13691164
"BLD",7671,"KRN",9.8,"NM",165,0)
%ZVEMSY2^^0^B2736809
"BLD",7671,"KRN",9.8,"NM",166,0)
VEEMI001^^0^B9166523
"BLD",7671,"KRN",9.8,"NM",167,0)
VEEMI002^^0^B12882797
"BLD",7671,"KRN",9.8,"NM",168,0)
VEEMI003^^0^B16040385
"BLD",7671,"KRN",9.8,"NM",169,0)
VEEMI004^^0^B29700065
"BLD",7671,"KRN",9.8,"NM",170,0)
VEEMI005^^0^B21641135
"BLD",7671,"KRN",9.8,"NM",171,0)
VEEMI006^^0^B24804433
"BLD",7671,"KRN",9.8,"NM",172,0)
VEEMI007^^0^B18056322
"BLD",7671,"KRN",9.8,"NM",173,0)
VEEMI008^^0^B29790897
"BLD",7671,"KRN",9.8,"NM",174,0)
VEEMI009^^0^B28618790
"BLD",7671,"KRN",9.8,"NM",175,0)
VEEMI00A^^0^B27961283
"BLD",7671,"KRN",9.8,"NM",176,0)
VEEMI00B^^0^B28017477
"BLD",7671,"KRN",9.8,"NM",177,0)
VEEMI00C^^0^B28508700
"BLD",7671,"KRN",9.8,"NM",178,0)
VEEMI00D^^0^B27415503
"BLD",7671,"KRN",9.8,"NM",179,0)
VEEMI00E^^0^B28564047
"BLD",7671,"KRN",9.8,"NM",180,0)
VEEMI00F^^0^B29318210
"BLD",7671,"KRN",9.8,"NM",181,0)
VEEMI00G^^0^B25928541
"BLD",7671,"KRN",9.8,"NM",182,0)
VEEMI00H^^0^B29341833
"BLD",7671,"KRN",9.8,"NM",183,0)
VEEMI00I^^0^B14938470
"BLD",7671,"KRN",9.8,"NM",184,0)
VEEMI00J^^0^B25448476
"BLD",7671,"KRN",9.8,"NM",185,0)
VEEMI00K^^0^B22507510
"BLD",7671,"KRN",9.8,"NM",186,0)
VEEMI00L^^0^B24805616
"BLD",7671,"KRN",9.8,"NM",187,0)
VEEMI00M^^0^B24549315
"BLD",7671,"KRN",9.8,"NM",188,0)
VEEMI00N^^0^B24982447
"BLD",7671,"KRN",9.8,"NM",189,0)
VEEMI00O^^0^B28258721
"BLD",7671,"KRN",9.8,"NM",190,0)
VEEMI00P^^0^B27594566
"BLD",7671,"KRN",9.8,"NM",191,0)
VEEMI00Q^^0^B26140851
"BLD",7671,"KRN",9.8,"NM",192,0)
VEEMI00R^^0^B29582470
"BLD",7671,"KRN",9.8,"NM",193,0)
VEEMI00S^^0^B6096604
"BLD",7671,"KRN",9.8,"NM",194,0)
VEEMINI1^^0^B6522142
"BLD",7671,"KRN",9.8,"NM",195,0)
VEEMINI2^^0^B6721390
"BLD",7671,"KRN",9.8,"NM",196,0)
VEEMINI3^^0^B27036495
"BLD",7671,"KRN",9.8,"NM",197,0)
VEEMINI4^^0^B4280461
"BLD",7671,"KRN",9.8,"NM",198,0)
VEEMINI5^^0^B1174761
"BLD",7671,"KRN",9.8,"NM",199,0)
VEEMINIS^^0^B4303329
"BLD",7671,"KRN",9.8,"NM",200,0)
VEEMINIT^^0^B14975659
"BLD",7671,"KRN",9.8,"NM",201,0)
VEEMVPE^^0^B1972060
"BLD",7671,"KRN",9.8,"NM",202,0)
ZVEMBLD^^0^B2632287
"BLD",7671,"KRN",9.8,"NM",203,0)
ZVEMBLDA^^0^B8470651
"BLD",7671,"KRN",9.8,"NM",204,0)
ZVEMBLDB^^0^B5123279
"BLD",7671,"KRN",9.8,"NM",205,0)
ZVEMBLDL^^0^B5503046
"BLD",7671,"KRN",9.8,"NM",206,0)
ZVEMBLDO^^0^B4526548
"BLD",7671,"KRN",9.8,"NM",207,0)
ZVEMDH1^^0^B4798983
"BLD",7671,"KRN",9.8,"NM",208,0)
ZVEMDH2^^0^B8418896
"BLD",7671,"KRN",9.8,"NM",209,0)
ZVEMDH3^^0^B5660370
"BLD",7671,"KRN",9.8,"NM",210,0)
ZVEMDH4^^0^B10174356
"BLD",7671,"KRN",9.8,"NM",211,0)
ZVEMDH5^^0^B10128668
"BLD",7671,"KRN",9.8,"NM",212,0)
ZVEMGH^^0^B9287570
"BLD",7671,"KRN",9.8,"NM",213,0)
ZVEMGH1^^0^B11600309
"BLD",7671,"KRN",9.8,"NM",214,0)
ZVEMGH2^^0^B7702211
"BLD",7671,"KRN",9.8,"NM",215,0)
ZVEMOH^^0^B12758953
"BLD",7671,"KRN",9.8,"NM",216,0)
ZVEMOH1^^0^B11870886
"BLD",7671,"KRN",9.8,"NM",217,0)
ZVEMOH2^^0^B9681063
"BLD",7671,"KRN",9.8,"NM",218,0)
ZVEMRH^^0^B9866100
"BLD",7671,"KRN",9.8,"NM",219,0)
ZVEMRH1^^0^B17033275
"BLD",7671,"KRN",9.8,"NM",220,0)
ZVEMRHK^^0^B6846622
"BLD",7671,"KRN",9.8,"NM",221,0)
ZVEMRHL^^0^B35770473
"BLD",7671,"KRN",9.8,"NM",222,0)
ZVEMRHW^^0^B2410370
"BLD",7671,"KRN",9.8,"NM",223,0)
ZVEMS^^0^B3407255
"BLD",7671,"KRN",9.8,"NM",224,0)
ZVEMSF1^^0^B9773043
"BLD",7671,"KRN",9.8,"NM",225,0)
ZVEMSF2^^0^B21894065
"BLD",7671,"KRN",9.8,"NM",226,0)
ZVEMSF3^^0^B17059126
"BLD",7671,"KRN",9.8,"NM",227,0)
ZVEMSF4^^0^B11292960
"BLD",7671,"KRN",9.8,"NM",228,0)
ZVEMSF5^^0^B17303117
"BLD",7671,"KRN",9.8,"NM",229,0)
ZVEMSF6^^0^B13243807
"BLD",7671,"KRN",9.8,"NM",230,0)
ZVEMSF7^^0^B16563158
"BLD",7671,"KRN",9.8,"NM",231,0)
ZVEMSF8^^0^B15138868
"BLD",7671,"KRN",9.8,"NM",232,0)
ZVEMSF9^^0^B18122882
"BLD",7671,"KRN",9.8,"NM",233,0)
ZVEMSFA^^0^B15852291
"BLD",7671,"KRN",9.8,"NM",234,0)
ZVEMSFB^^0^B14995914
"BLD",7671,"KRN",9.8,"NM",235,0)
ZVEMSFC^^0^B20158740
"BLD",7671,"KRN",9.8,"NM",236,0)
ZVEMSFD^^0^B18949552
"BLD",7671,"KRN",9.8,"NM",237,0)
ZVEMSG^^0^B8067461
"BLD",7671,"KRN",9.8,"NM",238,0)
ZVEMSGC^^0^B15263283
"BLD",7671,"KRN",9.8,"NM",239,0)
ZVEMSGD^^0^B7738660
"BLD",7671,"KRN",9.8,"NM",240,0)
ZVEMSGH^^0^B6307007
"BLD",7671,"KRN",9.8,"NM",241,0)
ZVEMSGR^^0^B1507659
"BLD",7671,"KRN",9.8,"NM",242,0)
ZVEMSGS^^0^B19123992
"BLD",7671,"KRN",9.8,"NM",243,0)
ZVEMSGT^^0^B10059374
"BLD",7671,"KRN",9.8,"NM",244,0)
ZVEMSGU^^0^B15550473
"BLD",7671,"KRN",9.8,"NM",245,0)
ZVEMSH1^^0^B13860223
"BLD",7671,"KRN",9.8,"NM",246,0)
ZVEMSH2^^0^B15154003
"BLD",7671,"KRN",9.8,"NM",247,0)
ZVEMSH3^^0^B19427018
"BLD",7671,"KRN",9.8,"NM",248,0)
ZVEMSH4^^0^B19769085
"BLD",7671,"KRN",9.8,"NM",249,0)
ZVEMSH5^^0^B17891783
"BLD",7671,"KRN",9.8,"NM",250,0)
ZVEMSH6^^0^B13779911
"BLD",7671,"KRN",9.8,"NM",251,0)
ZVEMSH7^^0^B11560809
"BLD",7671,"KRN",9.8,"NM",252,0)
ZVEMSH8^^0^B17834043
"BLD",7671,"KRN",9.8,"NM",253,0)
ZVEMSH9^^0^B7480262
"BLD",7671,"KRN",9.8,"NM",254,0)
ZVEMSLA^^0^B15237705
"BLD",7671,"KRN",9.8,"NM",255,0)
ZVEMSLB^^0^B6120940
"BLD",7671,"KRN",9.8,"NM",256,0)
ZVEMSLC^^0^B7539969
"BLD",7671,"KRN",9.8,"NM",257,0)
ZVEMSLD^^0^B6932697
"BLD",7671,"KRN",9.8,"NM",258,0)
ZVEMSN^^0^B24843046
"BLD",7671,"KRN",9.8,"NM","B","%ZVEMD",1)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMD1",2)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMDC",3)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMDI",4)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMDL",5)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMDL1",6)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMDLB",7)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMDLD",8)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMDLE",9)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMDLI",10)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMDLM",11)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMDM",12)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMDN",13)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMDPR",14)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMDPT",15)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMDT",16)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMDU",17)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMDU1",18)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMDUM",19)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMDX",20)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMDXK",21)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMDY",22)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMG",23)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMG1",24)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMGE",25)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMGE1",26)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMGI",27)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMGI1",28)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMGM",29)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMGM1",30)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMGMC",31)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMGO",32)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMGP",33)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMGPI",34)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMGPS",35)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMGR",36)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMGR1",37)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMGS",38)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMGU",39)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMGUM",40)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMGY",41)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMKC",42)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMKDT",43)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMKE",44)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMKEA",45)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMKEB",46)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMKEC",47)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMKI1",48)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMKI2",49)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMKI3",50)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMKI4",51)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMKI5",52)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMKP",53)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMKR",54)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMKRN",55)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMKST",56)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMKT",57)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMKT1",58)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMKT2",59)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMKTF",60)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMKTG",61)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMKTM",62)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMKTR",63)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMKTS",64)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMKTT",65)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMKTU",66)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMKU",67)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMKU1",68)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMKY",69)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMKY1",70)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMKY2",71)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMKY3",72)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMKYB",73)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMO",74)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMOC",75)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMOE",76)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMOE1",77)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMOE2",78)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMOEA",79)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMOEB",80)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMOEP",81)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMOEU",82)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMOM",83)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMOM1",84)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMOM2",85)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMOS",86)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMOSS",87)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMOU",88)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMOUM",89)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMOY",90)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMR",91)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMRC",92)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMRE",93)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMRE1",94)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMRE2",95)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMREA",96)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMREB",97)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMREJ",98)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMREL",99)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMREM",100)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMREO",101)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMREP",102)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMRER",103)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMREW",104)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMRI",105)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMRI1",106)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMRID",107)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMRIE",108)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMRLI",109)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMRLM",110)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMRLO",111)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMRLP",112)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMRLU",113)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMRLV",114)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMRLX",115)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMRLY",116)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMRLZ",117)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMRM",118)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMRM1",119)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMRM2",120)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMRMG",121)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMRMS",122)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMRP",123)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMRP1",124)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMRP2",125)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMRS",126)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMRS1",127)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMRSS",128)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMRU",129)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMRUM",130)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMRUS",131)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMRV",132)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMRY",133)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMSCL",134)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMSCU",135)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMSD",136)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMSF",137)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMSH",138)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMSHY",139)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMSID",140)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMSL",141)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMSNR",142)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMSO",143)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMSO1",144)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMSP",145)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMSPS",146)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMSQ",147)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMSQA",148)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMSQE",149)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMSQL",150)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMSQS",151)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMSQU",152)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMSQV",153)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMSQW",154)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMSRL",155)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMSS",156)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMSS1",157)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMST",158)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMSTO",159)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMSU",160)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMSU1",161)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMSU2",162)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMSY",163)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMSY1",164)

"BLD",7671,"KRN",9.8,"NM","B","%ZVEMSY2",165)

"BLD",7671,"KRN",9.8,"NM","B","VEEMI001",166)

"BLD",7671,"KRN",9.8,"NM","B","VEEMI002",167)

"BLD",7671,"KRN",9.8,"NM","B","VEEMI003",168)

"BLD",7671,"KRN",9.8,"NM","B","VEEMI004",169)

"BLD",7671,"KRN",9.8,"NM","B","VEEMI005",170)

"BLD",7671,"KRN",9.8,"NM","B","VEEMI006",171)

"BLD",7671,"KRN",9.8,"NM","B","VEEMI007",172)

"BLD",7671,"KRN",9.8,"NM","B","VEEMI008",173)

"BLD",7671,"KRN",9.8,"NM","B","VEEMI009",174)

"BLD",7671,"KRN",9.8,"NM","B","VEEMI00A",175)

"BLD",7671,"KRN",9.8,"NM","B","VEEMI00B",176)

"BLD",7671,"KRN",9.8,"NM","B","VEEMI00C",177)

"BLD",7671,"KRN",9.8,"NM","B","VEEMI00D",178)

"BLD",7671,"KRN",9.8,"NM","B","VEEMI00E",179)

"BLD",7671,"KRN",9.8,"NM","B","VEEMI00F",180)

"BLD",7671,"KRN",9.8,"NM","B","VEEMI00G",181)

"BLD",7671,"KRN",9.8,"NM","B","VEEMI00H",182)

"BLD",7671,"KRN",9.8,"NM","B","VEEMI00I",183)

"BLD",7671,"KRN",9.8,"NM","B","VEEMI00J",184)

"BLD",7671,"KRN",9.8,"NM","B","VEEMI00K",185)

"BLD",7671,"KRN",9.8,"NM","B","VEEMI00L",186)

"BLD",7671,"KRN",9.8,"NM","B","VEEMI00M",187)

"BLD",7671,"KRN",9.8,"NM","B","VEEMI00N",188)

"BLD",7671,"KRN",9.8,"NM","B","VEEMI00O",189)

"BLD",7671,"KRN",9.8,"NM","B","VEEMI00P",190)

"BLD",7671,"KRN",9.8,"NM","B","VEEMI00Q",191)

"BLD",7671,"KRN",9.8,"NM","B","VEEMI00R",192)

"BLD",7671,"KRN",9.8,"NM","B","VEEMI00S",193)

"BLD",7671,"KRN",9.8,"NM","B","VEEMINI1",194)

"BLD",7671,"KRN",9.8,"NM","B","VEEMINI2",195)

"BLD",7671,"KRN",9.8,"NM","B","VEEMINI3",196)

"BLD",7671,"KRN",9.8,"NM","B","VEEMINI4",197)

"BLD",7671,"KRN",9.8,"NM","B","VEEMINI5",198)

"BLD",7671,"KRN",9.8,"NM","B","VEEMINIS",199)

"BLD",7671,"KRN",9.8,"NM","B","VEEMINIT",200)

"BLD",7671,"KRN",9.8,"NM","B","VEEMVPE",201)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMBLD",202)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMBLDA",203)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMBLDB",204)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMBLDL",205)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMBLDO",206)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMDH1",207)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMDH2",208)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMDH3",209)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMDH4",210)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMDH5",211)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMGH",212)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMGH1",213)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMGH2",214)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMOH",215)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMOH1",216)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMOH2",217)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMRH",218)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMRH1",219)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMRHK",220)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMRHL",221)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMRHW",222)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMS",223)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMSF1",224)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMSF2",225)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMSF3",226)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMSF4",227)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMSF5",228)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMSF6",229)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMSF7",230)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMSF8",231)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMSF9",232)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMSFA",233)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMSFB",234)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMSFC",235)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMSFD",236)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMSG",237)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMSGC",238)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMSGD",239)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMSGH",240)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMSGR",241)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMSGS",242)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMSGT",243)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMSGU",244)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMSH1",245)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMSH2",246)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMSH3",247)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMSH4",248)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMSH5",249)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMSH6",250)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMSH7",251)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMSH8",252)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMSH9",253)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMSLA",254)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMSLB",255)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMSLC",256)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMSLD",257)

"BLD",7671,"KRN",9.8,"NM","B","ZVEMSN",258)

"BLD",7671,"KRN",19,0)
19
"BLD",7671,"KRN",19,"NM",0)
^9.68A^3^3
"BLD",7671,"KRN",19,"NM",1,0)
TMG VPE DD^^0
"BLD",7671,"KRN",19,"NM",2,0)
VPEEDITOR^^0
"BLD",7671,"KRN",19,"NM",3,0)
VPEGLOBALLISTER^^0
"BLD",7671,"KRN",19,"NM","B","TMG VPE DD",1)

"BLD",7671,"KRN",19,"NM","B","VPEEDITOR",2)

"BLD",7671,"KRN",19,"NM","B","VPEGLOBALLISTER",3)

"BLD",7671,"KRN",19.1,0)
19.1
"BLD",7671,"KRN",101,0)
101
"BLD",7671,"KRN",409.61,0)
409.61
"BLD",7671,"KRN",771,0)
771
"BLD",7671,"KRN",870,0)
870
"BLD",7671,"KRN",8989.51,0)
8989.51
"BLD",7671,"KRN",8989.52,0)
8989.52
"BLD",7671,"KRN",8994,0)
8994
"BLD",7671,"KRN","B",.4,.4)

"BLD",7671,"KRN","B",.401,.401)

"BLD",7671,"KRN","B",.402,.402)

"BLD",7671,"KRN","B",.403,.403)

"BLD",7671,"KRN","B",.5,.5)

"BLD",7671,"KRN","B",.84,.84)

"BLD",7671,"KRN","B",3.6,3.6)

"BLD",7671,"KRN","B",3.8,3.8)

"BLD",7671,"KRN","B",9.2,9.2)

"BLD",7671,"KRN","B",9.8,9.8)

"BLD",7671,"KRN","B",19,19)

"BLD",7671,"KRN","B",19.1,19.1)

"BLD",7671,"KRN","B",101,101)

"BLD",7671,"KRN","B",409.61,409.61)

"BLD",7671,"KRN","B",771,771)

"BLD",7671,"KRN","B",870,870)

"BLD",7671,"KRN","B",8989.51,8989.51)

"BLD",7671,"KRN","B",8989.52,8989.52)

"BLD",7671,"KRN","B",8994,8994)

"BLD",7671,"QUES",0)
^9.62^^
"BLD",7671,"REQB",0)
^9.611^^
"INI")
ZVEMBLD
"KRN",19,10988,-1)
0^1
"KRN",19,10988,0)
TMG VPE DD^VPE DATA DICTIONARY^^A^^^^^^^^FP OF GREENEVILLE (TMG)^y^1
"KRN",19,10988,20)
DO ^%ZVEMD
"KRN",19,10988,"U")
VPE DATA DICTIONARY
"KRN",19,10998,-1)
0^3
"KRN",19,10998,0)
VPEGLOBALLISTER^VPE Global Lister^^A^^^^^^^^^y^1
"KRN",19,10998,20)
DO ^%ZVEMG
"KRN",19,10998,"U")
VPE GLOBAL LISTER
"KRN",19,10999,-1)
0^2
"KRN",19,10999,0)
VPEEDITOR^VPE Editor^^A^^^^^^^^^y^1
"KRN",19,10999,20)
X ^%ZVEMS("E")
"KRN",19,10999,"U")
VPE EDITOR
"MBREQ")
0
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
258
"RTN","%ZVEMD")
0^1^B10478433
"RTN","%ZVEMD",1,0)
%ZVEMD ;DJB,VEDD**Electronic Data Dictionary ; 9/23/02 1:31pm
"RTN","%ZVEMD",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMD",3,0)
 ;
"RTN","%ZVEMD",4,0)
EN ;Entry point
"RTN","%ZVEMD",5,0)
 I '$D(^DD(0)) D  Q
"RTN","%ZVEMD",6,0)
 . W $C(7),!!?2,"You don't have Filemanager in this UCI.",!
"RTN","%ZVEMD",7,0)
 . D:$G(FLAGVPE)["VGL"!($G(FLAGVPE)["VRR") PAUSE^%ZVEMKC(2)
"RTN","%ZVEMD",8,0)
 I $G(DUZ)'>0 D ID^%ZVEMKU Q:$G(DUZ)=""
"RTN","%ZVEMD",9,0)
 NEW X S X="ERROR^%ZVEMDY",@($$TRAP^%ZVEMKU1) KILL X
"RTN","%ZVEMD",10,0)
START ;
"RTN","%ZVEMD",11,0)
 NEW FLAGE,FLAGG,FLAGGL,FLAGGL1,FLAGH,FLAGM,FLAGP,FLAGP1,FLAGQ
"RTN","%ZVEMD",12,0)
 NEW DIC,VEDDATE,I,PRINTING,X,Y,Z1,ZGL,ZNAM,ZNUM,ZZGL
"RTN","%ZVEMD",13,0)
 I $G(VEEX)]"" D  KILL VEEX
"RTN","%ZVEMD",14,0)
 . S:VEEX="TAG-DIR"!(VEEX="TAG-PARAM") FLAGH=1 Q
"RTN","%ZVEMD",15,0)
 I $D(VEE("OS"))#2=0 NEW VEE
"RTN","%ZVEMD",16,0)
 I $G(VEELINE)']"" NEW VEEIOST,VEELINE,VEELINE1,VEELINE2,VEESIZE,VEEX,VEEY
"RTN","%ZVEMD",17,0)
 ;FLAGVPE="VEDD^VGL^VRR^EDIT"
"RTN","%ZVEMD",18,0)
 I '$D(FLAGVPE) NEW FLAGVPE
"RTN","%ZVEMD",19,0)
 S $P(FLAGVPE,"^",1)="VEDD" ;Marks that VEDD is running
"RTN","%ZVEMD",20,0)
 ;
"RTN","%ZVEMD",21,0)
 S FLAGQ=0 D INIT^%ZVEMDY G:FLAGQ EX
"RTN","%ZVEMD",22,0)
 ;
"RTN","%ZVEMD",23,0)
TOP ;
"RTN","%ZVEMD",24,0)
 S (FLAGP,FLAGQ)=0 KILL ^TMP("VEE","VEDD",$J)
"RTN","%ZVEMD",25,0)
 D:'FLAGH HD^%ZVEMD1 D GETFILE G:FLAGQ EX
"RTN","%ZVEMD",26,0)
 I $G(VEESHL)="RUN" D CLHSET^%ZVEMSCL("VEDD",ZNAM) ;Cmnd Line History
"RTN","%ZVEMD",27,0)
 D MULT^%ZVEMDPR,MENU^%ZVEMD1 G:FLAGE EX
"RTN","%ZVEMD",28,0)
 S FLAGH=1 G TOP ;Set FLAGH to bypass opening screen
"RTN","%ZVEMD",29,0)
EX ;Exit
"RTN","%ZVEMD",30,0)
 KILL ^TMP("VEE","VEDD",$J)
"RTN","%ZVEMD",31,0)
 Q
"RTN","%ZVEMD",32,0)
 ;==================================================================
"RTN","%ZVEMD",33,0)
GETFILE ;File lookup
"RTN","%ZVEMD",34,0)
 NEW DIC
"RTN","%ZVEMD",35,0)
 I $G(FLAGPRM)="VEDD" S FLAGQ=1 Q  ;Onetime pass when parameter passing.
"RTN","%ZVEMD",36,0)
 I $G(FLAGPRM)=1 S FLAGPRM="VEDD",X=%1 G GETFILE1
"RTN","%ZVEMD",37,0)
 I $G(VEESHL)="RUN" D  G:X?1"<".E1">" GETFILE G GETFILE1
"RTN","%ZVEMD",38,0)
 . S X=$$CLHEDIT^%ZVEMSCL("VEDD"," Select FILE: ")
"RTN","%ZVEMD",39,0)
 W !?2,"Select FILE: "
"RTN","%ZVEMD",40,0)
 R X:VEE("TIME") S:'$T X="^"
"RTN","%ZVEMD",41,0)
GETFILE1 ;Parameter passing
"RTN","%ZVEMD",42,0)
 I "^"[X S FLAGQ=1 Q
"RTN","%ZVEMD",43,0)
 S DIC="^DIC(",DIC(0)="QEM" D ^DIC I Y<0 D  Q:FLAGQ  G GETFILE
"RTN","%ZVEMD",44,0)
 . Q:$G(FLAGPRM)'="VEDD"  S FLAGQ=1
"RTN","%ZVEMD",45,0)
 . W !!?2,"First parameter is not a valid file name/number.",!
"RTN","%ZVEMD",46,0)
 S ZNUM=+Y,ZNAM=$P(Y,U,2)
"RTN","%ZVEMD",47,0)
 I '$D(^DIC(ZNUM,0,"GL")) D  S FLAGQ=1 Q
"RTN","%ZVEMD",48,0)
 . W $C(7),!!?2,"WARNING...This file is missing node ^DIC(",ZNUM,",0,""GL"")",!
"RTN","%ZVEMD",49,0)
 I ^DIC(ZNUM,0,"GL")']"" D  S FLAGQ=1 Q
"RTN","%ZVEMD",50,0)
 . W $C(7),!!?2,"WARNING...Node ^DIC(",ZNUM,",0,""GL"") is null.",!
"RTN","%ZVEMD",51,0)
 S VEEX=^DIC(ZNUM,0,"GL")_"0)" I '$D(@VEEX) D  S FLAGQ=1 Q
"RTN","%ZVEMD",52,0)
 . W $C(7),!!?2,"WARNING...This file is missing its data global - ",^DIC(ZNUM,0,"GL"),!
"RTN","%ZVEMD",53,0)
 I '$D(^DD(ZNUM,0)) D  S FLAGQ=1 Q
"RTN","%ZVEMD",54,0)
 . W $C(7),!!?2,"WARNING...This file is missing the zero node of the data dictionary.",!?12,"--> ^DD(",ZNUM,",0)",!
"RTN","%ZVEMD",55,0)
 S ZGL=^DIC(ZNUM,0,"GL")
"RTN","%ZVEMD",56,0)
 Q
"RTN","%ZVEMD",57,0)
DIR ;Supress heading
"RTN","%ZVEMD",58,0)
 I $G(DUZ)'>0 D ID^%ZVEMKU I $G(DUZ)="" Q
"RTN","%ZVEMD",59,0)
 S VEEX="TAG-DIR" G EN
"RTN","%ZVEMD",60,0)
PARAM(X,Y,Z) ;Parameter Passing
"RTN","%ZVEMD",61,0)
 ;   X = ^Global -or- File name
"RTN","%ZVEMD",62,0)
 ;   Y = EDD Main Menu option
"RTN","%ZVEMD",63,0)
 ;   Z = Fields
"RTN","%ZVEMD",64,0)
 S ^TMP("VEE",$J)=$G(X)_"]]"_$G(Y)_"]]"_$G(Z)
"RTN","%ZVEMD",65,0)
 I $G(DUZ)'>0 D ID^%ZVEMKU I $G(DUZ)="" KILL ^TMP("VEE",$J) Q
"RTN","%ZVEMD",66,0)
 I $P(^TMP("VEE",$J),"]]",1)]"" S X=^($J) NEW FLAGPRM,%1,%2,%3 S FLAGPRM=1 D
"RTN","%ZVEMD",67,0)
 . S %1=$P(X,"]]",1),%2=$P(X,"]]",2),%3=$P(X,"]]",3)
"RTN","%ZVEMD",68,0)
 . I %2]"" D CHECK^%ZVEMDM I %2']"" S FLAGPRM="QUIT"
"RTN","%ZVEMD",69,0)
 KILL X,^TMP("VEE",$J) S VEEX="TAG-PARAM"
"RTN","%ZVEMD",70,0)
 I $G(FLAGPRM)="QUIT" KILL VEEX Q
"RTN","%ZVEMD",71,0)
 G EN
"RTN","%ZVEMD1")
0^2^B4709729
"RTN","%ZVEMD1",1,0)
%ZVEMD1 ;DJB,VEDD**Main Menu, Headings [09/25/94]
"RTN","%ZVEMD1",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMD1",3,0)
 ;
"RTN","%ZVEMD1",4,0)
HD ;
"RTN","%ZVEMD1",5,0)
 W @VEE("IOF"),!?65,"David Bolduc"
"RTN","%ZVEMD1",6,0)
 W !!!!?34,"V E D D",!?34,"~~~~~~~",!?35,"~~~~~",!?36,"~~~",!?37,"~"
"RTN","%ZVEMD1",7,0)
 W !!!?25,"VElectronic Data Dictionary"
"RTN","%ZVEMD1",8,0)
 W !!!?22,"*",?25,"Everything you ever wanted",?53,"*",!?22,"*",?25,"to know about a file but",?53,"*",!?22,"*",?25,"were afraid to ask.",?53,"*"
"RTN","%ZVEMD1",9,0)
 W !!
"RTN","%ZVEMD1",10,0)
 Q
"RTN","%ZVEMD1",11,0)
HD1 ;Heading for Top of Main Menu
"RTN","%ZVEMD1",12,0)
 W @VEE("IOF"),!?2,"A.) FILE NAME:------------- ",ZNAM
"RTN","%ZVEMD1",13,0)
 W !?48,"F.) FILE ACCESS:"
"RTN","%ZVEMD1",14,0)
 W !?2,"B.) FILE NUMBER:----------- ",ZNUM
"RTN","%ZVEMD1",15,0)
 W ?53,"DD______ ",$S($D(^DIC(ZNUM,0,"DD")):^("DD"),1:"")
"RTN","%ZVEMD1",16,0)
 W !?53,"Read____ ",$S($D(^DIC(ZNUM,0,"RD")):^("RD"),1:"")
"RTN","%ZVEMD1",17,0)
 W !?2,"C.) NUM OF FLDS:----------- ",^TMP("VEE","VEDD",$J,"TOT")
"RTN","%ZVEMD1",18,0)
 W ?53,"Write___ ",$S($D(^DIC(ZNUM,0,"WR")):^("WR"),1:"")
"RTN","%ZVEMD1",19,0)
 W !?53,"Delete__ ",$S($D(^DIC(ZNUM,0,"DEL")):^("DEL"),1:"")
"RTN","%ZVEMD1",20,0)
 W !?2,"D.) DATA GLOBAL:----------- ",ZGL
"RTN","%ZVEMD1",21,0)
 W ?53,"Laygo___ ",$S($D(^DIC(ZNUM,0,"LAYGO")):^("LAYGO"),1:"")
"RTN","%ZVEMD1",22,0)
 W !!?2,"E.) TOTAL GLOBAL ENTRIES:-- "
"RTN","%ZVEMD1",23,0)
 S ZZGL=ZGL_"0)",ZZGL=@ZZGL W $S($P(ZZGL,U,4)]"":$P(ZZGL,U,4),1:"Blank")
"RTN","%ZVEMD1",24,0)
 I PRINTING="YES" W ?48,"G.) PRINTING STATUS:-- ",$S(FLAGP:"On",1:"Off")
"RTN","%ZVEMD1",25,0)
 W !,$E(VEELINE1,1,VEE("IOM"))
"RTN","%ZVEMD1",26,0)
 Q
"RTN","%ZVEMD1",27,0)
MENU ;Main Menu
"RTN","%ZVEMD1",28,0)
 S (FLAGE,FLAGG,FLAGM,FLAGQ,FLAGP1)=0
"RTN","%ZVEMD1",29,0)
 I $G(FLAGPRM)="VEDD",$G(%2)]"" G MENU1
"RTN","%ZVEMD1",30,0)
 D HD1
"RTN","%ZVEMD1",31,0)
MENU1 ;Parameter passing
"RTN","%ZVEMD1",32,0)
 D ^%ZVEMDM G:FLAGP1 MENU I FLAGP S:$E(VEEIOST,1,2)="P-" FLAGQ=1 D PRINT^%ZVEMDPR ;Turn off printing
"RTN","%ZVEMD1",33,0)
 I $G(FLAGPRM)="VEDD",$G(%2)]"" S FLAGE=1 Q
"RTN","%ZVEMD1",34,0)
 Q:FLAGM!FLAGE  G:FLAGQ MENU
"RTN","%ZVEMD1",35,0)
 I $Y'>VEESIZE F I=$Y:1:VEESIZE W !
"RTN","%ZVEMD1",36,0)
 W !!?2 S Z1=$$CHOICE^%ZVEMKC("MAIN_MENU^EXIT",1) I Z1'=1 S FLAGE=1 Q
"RTN","%ZVEMD1",37,0)
 G MENU
"RTN","%ZVEMDC")
0^3^B4289514
"RTN","%ZVEMDC",1,0)
%ZVEMDC ;DJB,VEDD**File Characteristics [07/12/94]
"RTN","%ZVEMDC",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMDC",3,0)
 ;
"RTN","%ZVEMDC",4,0)
CHAR ;Identifiers, Post Selection Actions, Special Look-up Program
"RTN","%ZVEMDC",5,0)
 I '$D(^DD(ZNUM,0,"ID")),'$D(^DD(ZNUM,0,"ACT")),'$D(^DD(ZNUM,0,"DIC")) D  S FLAGG=1 Q
"RTN","%ZVEMDC",6,0)
 . W !?10,"No Identifiers, Post Selection Actions, or Special Look-up Program."
"RTN","%ZVEMDC",7,0)
 NEW LINE,STRING
"RTN","%ZVEMDC",8,0)
 D INIT^%ZVEMDPR G:FLAGQ EX
"RTN","%ZVEMDC",9,0)
 W !?21,"F I L E   C H A R A C T E R I S T I C S"
"RTN","%ZVEMDC",10,0)
 W !?20,"-----------------------------------------"
"RTN","%ZVEMDC",11,0)
 W !!?1,"1. POST SELECTION ACTION:" I $D(^DD(ZNUM,0,"ACT")) D
"RTN","%ZVEMDC",12,0)
 . W "  The following code is executed after an entry to"
"RTN","%ZVEMDC",13,0)
 . W !?28,"this file has been selected. If Y=-1 entry will"
"RTN","%ZVEMDC",14,0)
 . W !?28,"not be selected:"
"RTN","%ZVEMDC",15,0)
 . W !?14,"CODE:" S STRING=^DD(ZNUM,0,"ACT") D STRING
"RTN","%ZVEMDC",16,0)
 W !!?1,"2. SPECIAL LOOK-UP PROGRAM: "
"RTN","%ZVEMDC",17,0)
 I $D(^DD(ZNUM,0,"DIC")) W "^",^DD(ZNUM,0,"DIC")
"RTN","%ZVEMDC",18,0)
 W !!?1,"3. IDENTIFIERS:"
"RTN","%ZVEMDC",19,0)
 I $D(^DD(ZNUM,0,"ID")) D NOTE,HD S VEEX="" D  ;
"RTN","%ZVEMDC",20,0)
 . F  S VEEX=$O(^DD(ZNUM,0,"ID",VEEX)) Q:VEEX=""!FLAGQ  D  W !
"RTN","%ZVEMDC",21,0)
 . . W !?1,$J(VEEX,11),?14,$S(+VEEX=VEEX:"Yes",1:"No")
"RTN","%ZVEMDC",22,0)
 . . S STRING=^DD(ZNUM,0,"ID",VEEX) D STRING
"RTN","%ZVEMDC",23,0)
EX ;Exit
"RTN","%ZVEMDC",24,0)
 Q
"RTN","%ZVEMDC",25,0)
STRING ;String=code - Prints a string in lines of 55 characters
"RTN","%ZVEMDC",26,0)
 W ?20,$E(STRING,1,55) I $Y>VEESIZE D PAGE Q:FLAGQ
"RTN","%ZVEMDC",27,0)
 S STRING=$E(STRING,56,9999) Q:STRING']""  W !
"RTN","%ZVEMDC",28,0)
 G STRING
"RTN","%ZVEMDC",29,0)
PAGE ;
"RTN","%ZVEMDC",30,0)
 I FLAGP,$E(VEEIOST,1,2)="P-" W @VEE("IOF"),!!! D HD Q
"RTN","%ZVEMDC",31,0)
 D PAUSEQE^%ZVEMKC(2) Q:FLAGQ  W @VEE("IOF") D HD
"RTN","%ZVEMDC",32,0)
 Q
"RTN","%ZVEMDC",33,0)
NOTE ;
"RTN","%ZVEMDC",34,0)
 W "  If ASK=Yes, field is asked when a new entry is added.",!
"RTN","%ZVEMDC",35,0)
 Q
"RTN","%ZVEMDC",36,0)
HD ;Heading
"RTN","%ZVEMDC",37,0)
 W !?7,"FIELD",?14,"ASK",?30,"WRITE STATEMENT TO GENERATE DISPLAY",!?7,"-----",?14,"---",?20,"-------------------------------------------------------"
"RTN","%ZVEMDC",38,0)
 Q
"RTN","%ZVEMDI")
0^4^B24029726
"RTN","%ZVEMDI",1,0)
%ZVEMDI ;DJB,VEDD**Indiv Fld Sum ; 12/8/00 7:23am
"RTN","%ZVEMDI",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMDI",3,0)
 ;
"RTN","%ZVEMDI",4,0)
 NEW %,%XX,%Y,%YY,D,DDH,DIC,X,Y
"RTN","%ZVEMDI",5,0)
 NEW A,CNT,DATA,FILE,FLD,FNAM,FNUM,I,LEV,M,ZDSUB
"RTN","%ZVEMDI",6,0)
 ;
"RTN","%ZVEMDI",7,0)
 D INIT
"RTN","%ZVEMDI",8,0)
 D:FLAGP HD
"RTN","%ZVEMDI",9,0)
 I $G(FLAGPRM)="VEDD",$G(%3)]"" NEW PARAM,XXX S PARAM=0 D GETFLDP G EX
"RTN","%ZVEMDI",10,0)
 D GETFLD
"RTN","%ZVEMDI",11,0)
 I FLAGP,$D(^TMP("VEE","VEDD",$J,"IND")) D PRINT
"RTN","%ZVEMDI",12,0)
EX ;
"RTN","%ZVEMDI",13,0)
 KILL ^TMP("VEE","VEDD",$J,"IND")
"RTN","%ZVEMDI",14,0)
 S FLAGQ=1
"RTN","%ZVEMDI",15,0)
 Q
"RTN","%ZVEMDI",16,0)
 ;
"RTN","%ZVEMDI",17,0)
GETFLD ;Field lookup. LEV increments and decrements with Multiple layers.
"RTN","%ZVEMDI",18,0)
 S FLAGQ=0
"RTN","%ZVEMDI",19,0)
 S DIC="^DD("_FILE(LEV)_","
"RTN","%ZVEMDI",20,0)
 S DIC(0)="QEAN"
"RTN","%ZVEMDI",21,0)
 S DIC("A")=$S(LEV=1:"  Select FIELD: ",1:"  Select SUBFIELD: ")
"RTN","%ZVEMDI",22,0)
 S DIC("W")="W ""   ["",$P($G(^(0)),U,4),""] ["",$P($G(^(0)),U,2),""]"" W:$P($P($G(^(0)),U,4),"";"",2)=0 ?72,""<-Mult"""
"RTN","%ZVEMDI",23,0)
 D ^DIC
"RTN","%ZVEMDI",24,0)
 KILL DIC("A")
"RTN","%ZVEMDI",25,0)
 KILL DIC("W")
"RTN","%ZVEMDI",26,0)
 I Y<0 S LEV=LEV-1 Q:LEV=0  G GETFLD
"RTN","%ZVEMDI",27,0)
 S FNUM=+Y,FNAM=$P(Y,U,2)
"RTN","%ZVEMDI",28,0)
 S VEEX=+$P(^DD(FILE(LEV),FNUM,0),U,2)
"RTN","%ZVEMDI",29,0)
 I VEEX D  G GETFLD
"RTN","%ZVEMDI",30,0)
 . S LEV=LEV+1
"RTN","%ZVEMDI",31,0)
 . S FILE(LEV)=VEEX
"RTN","%ZVEMDI",32,0)
 I 'FLAGP D INDIV^%ZVEMKI1(FILE(LEV),FNUM) Q:FLAGE  G GETFLD
"RTN","%ZVEMDI",33,0)
 S ^TMP("VEE","VEDD",$J,"IND",CNT)=FILE(LEV)_"^"_FNUM_"^"_FNAM
"RTN","%ZVEMDI",34,0)
 S CNT=CNT+1
"RTN","%ZVEMDI",35,0)
 G GETFLD
"RTN","%ZVEMDI",36,0)
 ;
"RTN","%ZVEMDI",37,0)
GETFLDP ;Parameter passing
"RTN","%ZVEMDI",38,0)
 S PARAM=PARAM+1
"RTN","%ZVEMDI",39,0)
 S X=$P(%3,";",PARAM) I X']"" Q
"RTN","%ZVEMDI",40,0)
 I $E(X)="""" S X=$E(X,2,99) I $E($L(X))="""" S X=$E(X,1,$L(X)-1)
"RTN","%ZVEMDI",41,0)
 S FLD=X
"RTN","%ZVEMDI",42,0)
 S (CNT,LEV)=1
"RTN","%ZVEMDI",43,0)
 S FILE(LEV)=ZNUM
"RTN","%ZVEMDI",44,0)
 ;
"RTN","%ZVEMDI",45,0)
GETFLDP1 S DIC="^DD("_FILE(LEV)_","
"RTN","%ZVEMDI",46,0)
 S DIC(0)="M"
"RTN","%ZVEMDI",47,0)
 D ^DIC
"RTN","%ZVEMDI",48,0)
 I Y<0 D MULT Q:FLAGQ  G GETFLDP
"RTN","%ZVEMDI",49,0)
 S FNUM=+Y,FNAM=$P(Y,U,2)
"RTN","%ZVEMDI",50,0)
 S VEEX=+$P(^DD(FILE(LEV),FNUM,0),U,2)
"RTN","%ZVEMDI",51,0)
 I VEEX D  G GETFLDP1
"RTN","%ZVEMDI",52,0)
 . S LEV=LEV+1
"RTN","%ZVEMDI",53,0)
 . S FILE(LEV)=VEEX
"RTN","%ZVEMDI",54,0)
 D INDIV^%ZVEMKI1(FILE(LEV),FNUM) Q:FLAGQ
"RTN","%ZVEMDI",55,0)
 I $P(%3,";",(PARAM+1))]"" W ! I $$CHOICE^%ZVEMKC("NEXT_FIELD^QUIT",1)'=1 S FLAGQ=1 Q
"RTN","%ZVEMDI",56,0)
 G GETFLDP
"RTN","%ZVEMDI",57,0)
 ;
"RTN","%ZVEMDI",58,0)
MULT ;Process a multiple field
"RTN","%ZVEMDI",59,0)
 NEW CNT,DATA,FLD1,FLDCNT,I,LEVEL,MAR,MAR1,Z1,ZDD,ZNAME,ZNUMBER
"RTN","%ZVEMDI",60,0)
 KILL ^TMP("VEE","VEDD",$J,"FLD")
"RTN","%ZVEMDI",61,0)
 D LIST
"RTN","%ZVEMDI",62,0)
 D TRACE
"RTN","%ZVEMDI",63,0)
 KILL ^TMP("VEE","VEDD",$J,"FLD")
"RTN","%ZVEMDI",64,0)
 Q
"RTN","%ZVEMDI",65,0)
 ;
"RTN","%ZVEMDI",66,0)
LIST ;
"RTN","%ZVEMDI",67,0)
 S FLDCNT=1
"RTN","%ZVEMDI",68,0)
 S ZDD=""
"RTN","%ZVEMDI",69,0)
 F  S ZDD=$O(^TMP("VEE","VEDD",$J,"TMP",ZDD)) Q:ZDD=""  D  ;
"RTN","%ZVEMDI",70,0)
 . S LEVEL=$P(^(ZDD),U,2)
"RTN","%ZVEMDI",71,0)
 . S ZNAME=""
"RTN","%ZVEMDI",72,0)
 . F  S ZNAME=$O(^DD(ZDD,"B",ZNAME)) Q:ZNAME=""  I $E(ZNAME,1,$L(FLD))=FLD D  ;
"RTN","%ZVEMDI",73,0)
 .. S ZNUMBER=$O(^DD(ZDD,"B",ZNAME,""))
"RTN","%ZVEMDI",74,0)
 .. Q:^DD(ZDD,"B",ZNAME,ZNUMBER)=1
"RTN","%ZVEMDI",75,0)
 .. S ^TMP("VEE","VEDD",$J,"FLD",FLDCNT)=ZNAME_"^"_ZDD_"^"_ZNUMBER_"^"_LEVEL
"RTN","%ZVEMDI",76,0)
 .. S FLDCNT=FLDCNT+1
"RTN","%ZVEMDI",77,0)
 Q
"RTN","%ZVEMDI",78,0)
 ;
"RTN","%ZVEMDI",79,0)
PRINT ;
"RTN","%ZVEMDI",80,0)
 D INIT^%ZVEMDPR
"RTN","%ZVEMDI",81,0)
 S CNT=""
"RTN","%ZVEMDI",82,0)
 F  S CNT=$O(^TMP("VEE","VEDD",$J,"IND",CNT)) Q:CNT=""  D  Q:FLAGQ
"RTN","%ZVEMDI",83,0)
 . S DATA=^TMP("VEE","VEDD",$J,"IND",CNT)
"RTN","%ZVEMDI",84,0)
 . S FILE(LEV)=$P(DATA,U)
"RTN","%ZVEMDI",85,0)
 . S FNUM=$P(DATA,U,2)
"RTN","%ZVEMDI",86,0)
 . S FNAM=$P(DATA,U,3)
"RTN","%ZVEMDI",87,0)
 . D INDIV^%ZVEMKI1(FILE(LEV),FNUM) Q:FLAGQ
"RTN","%ZVEMDI",88,0)
 . Q:$O(^TMP("VEE","VEDD",$J,"IND",CNT))=""
"RTN","%ZVEMDI",89,0)
 . W ! Q:$$CHECK^%ZVEMKI3
"RTN","%ZVEMDI",90,0)
 . W !,$E(VEELINE2,1,VEE("IOM")) Q:$$CHECK^%ZVEMKI3
"RTN","%ZVEMDI",91,0)
 . W ! Q:$$CHECK^%ZVEMKI3
"RTN","%ZVEMDI",92,0)
 . W ! Q:$$CHECK^%ZVEMKI3
"RTN","%ZVEMDI",93,0)
 Q
"RTN","%ZVEMDI",94,0)
 ;
"RTN","%ZVEMDI",95,0)
TRACE ;If more than one match do NUM
"RTN","%ZVEMDI",96,0)
 Q:'$D(^TMP("VEE","VEDD",$J,"FLD"))
"RTN","%ZVEMDI",97,0)
 S FLDCNT=""
"RTN","%ZVEMDI",98,0)
 F  S FLDCNT=$O(^TMP("VEE","VEDD",$J,"FLD",FLDCNT)) Q:FLDCNT=""  S I=FLDCNT
"RTN","%ZVEMDI",99,0)
 I I=1 D  D INDIV^%ZVEMKI1(FILE(LEV),FNUM) Q
"RTN","%ZVEMDI",100,0)
 . S FNAM=$P(^TMP("VEE","VEDD",$J,"FLD",I),U)
"RTN","%ZVEMDI",101,0)
 . S FNUM=$P(^(I),U,3)
"RTN","%ZVEMDI",102,0)
 . S FILE(LEV)=$P(^(I),U,2)
"RTN","%ZVEMDI",103,0)
 ;
"RTN","%ZVEMDI",104,0)
 D HD1
"RTN","%ZVEMDI",105,0)
 S FLDCNT=""
"RTN","%ZVEMDI",106,0)
 F  S FLDCNT=$O(^TMP("VEE","VEDD",$J,"FLD",FLDCNT)) Q:FLDCNT=""  D  Q:FLAGQ
"RTN","%ZVEMDI",107,0)
 . S FNAM=$P(^TMP("VEE","VEDD",$J,"FLD",FLDCNT),U)
"RTN","%ZVEMDI",108,0)
 . S FNUM=$P(^(FLDCNT),U,3)
"RTN","%ZVEMDI",109,0)
 . S LEVEL=$P(^(FLDCNT),U,4)
"RTN","%ZVEMDI",110,0)
 . S FILE(LEV)=$P(^(FLDCNT),U,2)
"RTN","%ZVEMDI",111,0)
 . W ! W:$P(^DD(FILE(LEV),FNUM,0),U,2)>0 "Mult->"
"RTN","%ZVEMDI",112,0)
 . W ?6,$J(FLDCNT,3),".",?LEVEL*5+6,"  ",FNAM,"  (",FNUM,")"
"RTN","%ZVEMDI",113,0)
 . D:$Y>VEESIZE PAGE
"RTN","%ZVEMDI",114,0)
TRACE1 ;
"RTN","%ZVEMDI",115,0)
 W !!?2,"Select Number: "
"RTN","%ZVEMDI",116,0)
 R FLD1:VEE("TIME") S:'$T FLD1="^^" S:FLD1="" FLD1="^"
"RTN","%ZVEMDI",117,0)
 I FLD1["^" S FLAGQ=1 S:FLD1="^^" FLAGE=1 Q
"RTN","%ZVEMDI",118,0)
 I '$D(^TMP("VEE","VEDD",$J,"FLD",FLD1)) D  G TRACE1
"RTN","%ZVEMDI",119,0)
 . W !?2,"Enter a number from the left hand column."
"RTN","%ZVEMDI",120,0)
 S CNT=1
"RTN","%ZVEMDI",121,0)
 S FNAM=$P(^TMP("VEE","VEDD",$J,"FLD",FLD1),U)
"RTN","%ZVEMDI",122,0)
 S FNUM=$P(^(FLD1),U,3)
"RTN","%ZVEMDI",123,0)
 S LEV=$P(^(FLD1),U,4)
"RTN","%ZVEMDI",124,0)
 S FILE(LEV)=$P(^(FLD1),U,2)
"RTN","%ZVEMDI",125,0)
 D INDIV^%ZVEMKI1(FILE(LEV),FNUM)
"RTN","%ZVEMDI",126,0)
 Q
"RTN","%ZVEMDI",127,0)
 ;
"RTN","%ZVEMDI",128,0)
PAGE ;
"RTN","%ZVEMDI",129,0)
 D PAUSEQE^%ZVEMKC(2) Q:FLAGQ  D HD
"RTN","%ZVEMDI",130,0)
 Q
"RTN","%ZVEMDI",131,0)
 ;
"RTN","%ZVEMDI",132,0)
HD ;
"RTN","%ZVEMDI",133,0)
 W @VEE("IOF"),!,$E(VEELINE1,1,VEE("IOM"))
"RTN","%ZVEMDI",134,0)
 W !?5,"Enter one at a time, as many fields as you wish to print."
"RTN","%ZVEMDI",135,0)
 W !?5,"The fields will print in the order entered."
"RTN","%ZVEMDI",136,0)
 W !,$E(VEELINE1,1,VEE("IOM")),!
"RTN","%ZVEMDI",137,0)
 Q
"RTN","%ZVEMDI",138,0)
 ;
"RTN","%ZVEMDI",139,0)
HD1 ;Trace a field
"RTN","%ZVEMDI",140,0)
 W @VEE("IOF"),!
"RTN","%ZVEMDI",141,0)
 W !,"MULTIPLE",?13,"1    2    3    4    5    6    7"
"RTN","%ZVEMDI",142,0)
 W !,"LEVELS",?13,"|    |    |    |    |    |    |"
"RTN","%ZVEMDI",143,0)
 W !,$E(VEELINE,1,VEE("IOM")),!
"RTN","%ZVEMDI",144,0)
 Q
"RTN","%ZVEMDI",145,0)
 ;
"RTN","%ZVEMDI",146,0)
INIT ;
"RTN","%ZVEMDI",147,0)
 KILL ^TMP("VEE","VEDD",$J,"IND")
"RTN","%ZVEMDI",148,0)
 S (CNT,LEV)=1
"RTN","%ZVEMDI",149,0)
 S FILE(LEV)=ZNUM
"RTN","%ZVEMDI",150,0)
 S DIC(0)="QEAM"
"RTN","%ZVEMDI",151,0)
 S DIC("W")="I $P(^DD(FILE(LEV),Y,0),U,2)>0 W ""    -->Mult Fld"""
"RTN","%ZVEMDI",152,0)
 Q
"RTN","%ZVEMDL")
0^5^B13756810
"RTN","%ZVEMDL",1,0)
%ZVEMDL ;DJB,VEDD**Fld Global Location [11/17/96 7:38am]
"RTN","%ZVEMDL",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMDL",3,0)
 ;
"RTN","%ZVEMDL",4,0)
PRINT ;Called by START,LOOP
"RTN","%ZVEMDL",5,0)
 Q:'$D(^DD(FILE(LEV),FLD(LEV),0))
"RTN","%ZVEMDL",6,0)
 S ZDATA=^DD(FILE(LEV),FLD(LEV),0)
"RTN","%ZVEMDL",7,0)
 S FLDNAM=$P(ZDATA,U),SYM=$P(ZDATA,U,2)
"RTN","%ZVEMDL",8,0)
 I SYM]"" S SYM="["_SYM_"]"
"RTN","%ZVEMDL",9,0)
 S NP=$S($P(ZDATA,U,4)=" ; ":"Computed",1:$P(ZDATA,U,4))
"RTN","%ZVEMDL",10,0)
 S PIECE=$P($P(ZDATA,U,4),";",2)
"RTN","%ZVEMDL",11,0)
 I PIECE=0 D  I 1
"RTN","%ZVEMDL",12,0)
 . NEW TMP
"RTN","%ZVEMDL",13,0)
 . S TMP="<-Mult"
"RTN","%ZVEMDL",14,0)
 . I $P($G(^DD(+$P(ZDATA,U,2),.01,0)),U,2)["W" S TMP="<-WP"
"RTN","%ZVEMDL",15,0)
 . S SYM=TMP_" "_SYM
"RTN","%ZVEMDL",16,0)
 . I $G(^DD(FILE(LEV),FLD(LEV),8))]"" S SYM="R:"_^(8)_" "_SYM
"RTN","%ZVEMDL",17,0)
 . I $G(^(8.5))]"" S SYM="D:"_^(8.5)_" "_SYM
"RTN","%ZVEMDL",18,0)
 . I $G(^(9))]"" S SYM="W:"_^(9)_" "_SYM
"RTN","%ZVEMDL",19,0)
 E  I $P(ZDATA,U,2)["P"!($P(ZDATA,U,2)["V") D
"RTN","%ZVEMDL",20,0)
 . NEW TMP
"RTN","%ZVEMDL",21,0)
 . S TMP="<-Pntr "
"RTN","%ZVEMDL",22,0)
 . I $P(ZDATA,U,2)["V" S TMP=TMP_"Var"
"RTN","%ZVEMDL",23,0)
 . S SYM=TMP_" "_SYM
"RTN","%ZVEMDL",24,0)
 S VEEX=$J($S(FLAGP:"",PIECE=0:"",1:RCNT),3)_"  "_DASHES_NP
"RTN","%ZVEMDL",25,0)
 S VEEX=VEEX_$J("",19-$L(VEEX))_$J(FLD(LEV),8)
"RTN","%ZVEMDL",26,0)
 S VEEX=VEEX_$J("",29-$L(VEEX))_DASHES_FLDNAM
"RTN","%ZVEMDL",27,0)
 S VEEX=VEEX_$J("",79-$L(VEEX)-$L(SYM)-1)_SYM
"RTN","%ZVEMDL",28,0)
 I FLAGP W !,VEEX Q  ;Quit here if sending to printer
"RTN","%ZVEMDL",29,0)
 ;Next: Save field name for F=Find utility
"RTN","%ZVEMDL",30,0)
 S ^TMP("VEE","ID"_VEDDS,$J,"FLD",VEET("BOT"))=FLDNAM
"RTN","%ZVEMDL",31,0)
 I PIECE'=0 D  ;Multiple field
"RTN","%ZVEMDL",32,0)
 . S ^TMP("VEE","VEDD"_VEDDS,$J,RCNT)=FILE(LEV)_U_FLD(LEV)_U_VEET("BOT") ;REF number
"RTN","%ZVEMDL",33,0)
 . S ^TMP("VEE","ID"_VEDDS,$J,"SCR",VEET("BOT"))=RCNT ;This allows you to use highlight to select a node.
"RTN","%ZVEMDL",34,0)
 . S RCNT=RCNT+1 ;REF column
"RTN","%ZVEMDL",35,0)
 S VEET=VEEX D ^%ZVEMDLI ;.......................Import to scroller
"RTN","%ZVEMDL",36,0)
 Q
"RTN","%ZVEMDL",37,0)
EN ;Entry Point
"RTN","%ZVEMDL",38,0)
 NEW X S X="ERROR^%ZVEMDL1",@($$TRAP^%ZVEMKU1) KILL X
"RTN","%ZVEMDL",39,0)
 NEW A,BAR,FILE,FLD,HD,II,LENGTH,LEV,SFLD,SPACE,SUB,SUBCNT,SUBSEL,SUBTEXT,SYM,TABHLD,TOT,Z1,ZDSUB
"RTN","%ZVEMDL",40,0)
 NEW DASHES,FLAGFIND,FLAGSTRT,FLDNAM,NP,PIECE,RCNT,ZDATA
"RTN","%ZVEMDL",41,0)
 NEW DX,DY,VEET NEW:'$D(VEES) VEES ;..........IMPORT (For scrolling)
"RTN","%ZVEMDL",42,0)
 I $G(VEDDS)'>0 NEW VEDDS S VEDDS=0
"RTN","%ZVEMDL",43,0)
 S VEDDS=VEDDS+1 ;Tracks migration to pointed-to files
"RTN","%ZVEMDL",44,0)
 KILL ^TMP("VEE","VEDD"_VEDDS,$J),^TMP("VEE","ID"_VEDDS,$J)
"RTN","%ZVEMDL",45,0)
 D ASK^%ZVEMDL1 G:FLAGQ EX
"RTN","%ZVEMDL",46,0)
 I FLAGP S HD="HD" D INIT^%ZVEMDPR,HD^%ZVEMDL1,START,LOOP G EX
"RTN","%ZVEMDL",47,0)
 D IMPORT,START,LOOP,FINISH^%ZVEMDLI
"RTN","%ZVEMDL",48,0)
EX ;Exit
"RTN","%ZVEMDL",49,0)
 I FLAGQ!FLAGE!FLAGP S:$E(VEEIOST,1,2)="P-" FLAGQ=1
"RTN","%ZVEMDL",50,0)
 KILL ^TMP("VEE","VEDD"_VEDDS,$J),^TMP("VEE","ID"_VEDDS,$J)
"RTN","%ZVEMDL",51,0)
 S VEDDS=VEDDS-1 ;.............This is done AFTER kill in above line
"RTN","%ZVEMDL",52,0)
 Q
"RTN","%ZVEMDL",53,0)
START ;Print if data, otherwise continue to loop.
"RTN","%ZVEMDL",54,0)
 Q:'$D(^DD(FILE(LEV),FLD(LEV),0))#2
"RTN","%ZVEMDL",55,0)
 D DASHES,PRINT
"RTN","%ZVEMDL",56,0)
 I PIECE=0 S LEV=LEV+1,FILE(LEV)=+$P(ZDATA,U,2),FLD(LEV)=0
"RTN","%ZVEMDL",57,0)
 Q
"RTN","%ZVEMDL",58,0)
LOOP ;Start For Loop
"RTN","%ZVEMDL",59,0)
 S FLD(LEV)=$O(^DD(FILE(LEV),FLD(LEV)))
"RTN","%ZVEMDL",60,0)
 I +FLD(LEV)=0 S LEV=LEV-1 G:LEV LOOP Q
"RTN","%ZVEMDL",61,0)
 D DASHES,PRINT Q:FLAGQ!FLAGE
"RTN","%ZVEMDL",62,0)
 I PIECE=0 S LEV=LEV+1,FILE(LEV)=+$P(ZDATA,U,2),FLD(LEV)=0
"RTN","%ZVEMDL",63,0)
 G:$Y'>VEESIZE LOOP
"RTN","%ZVEMDL",64,0)
 I FLAGP D  D HD^%ZVEMDL1 G LOOP
"RTN","%ZVEMDL",65,0)
 . W @VEE("IOF") W:$E(VEEIOST,1,2)="P-" !!!
"RTN","%ZVEMDL",66,0)
 G LOOP
"RTN","%ZVEMDL",67,0)
DASHES ;Set dashes for mult level flds
"RTN","%ZVEMDL",68,0)
 S (SPACE,BAR)="" F II=1:1:LEV-1 S SPACE=SPACE_" ",BAR=BAR_"-"
"RTN","%ZVEMDL",69,0)
 S DASHES=SPACE_BAR
"RTN","%ZVEMDL",70,0)
 Q
"RTN","%ZVEMDL",71,0)
IMPORT ;Set up for scroller
"RTN","%ZVEMDL",72,0)
 NEW HD,HD1,LINE,MAR
"RTN","%ZVEMDL",73,0)
 S MAR=$G(VEE("IOM")) S:MAR'>0 MAR=80
"RTN","%ZVEMDL",74,0)
 S $P(LINE,"=",MAR)=""
"RTN","%ZVEMDL",75,0)
 S HD="File: "_ZNAM
"RTN","%ZVEMDL",76,0)
 S HD=HD_$J("",MAR-$L(HD)-11)_"Branch: "_VEDDS
"RTN","%ZVEMDL",77,0)
 S HD1="REF  NODE;PIECE     FLD NUM  FIELD NAME"
"RTN","%ZVEMDL",78,0)
 S VEET("HD")=3
"RTN","%ZVEMDL",79,0)
 S VEET("HD",1)=HD
"RTN","%ZVEMDL",80,0)
 S VEET("HD",2)=HD1
"RTN","%ZVEMDL",81,0)
 S VEET("HD",3)=LINE
"RTN","%ZVEMDL",82,0)
 S VEET("FT")=3
"RTN","%ZVEMDL",83,0)
 S VEET("FT",1)=LINE
"RTN","%ZVEMDL",84,0)
 S VEET("FT",2)="<>  'n',I=FldDD  DA=Data  F=Find  G=Goto  N=Node  P=Pointer  VGL=VGL  ?=Help"
"RTN","%ZVEMDL",85,0)
 S VEET("FT",3)=" Select: "
"RTN","%ZVEMDL",86,0)
 S VEET("S1")=4,VEET("S2")=(VEE("IOSL")-3)
"RTN","%ZVEMDL",87,0)
 S VEET("GET")="D SETARRAY^%ZVEMDLI"
"RTN","%ZVEMDL",88,0)
 D IMPORTS^%ZVEMKT("ID"_VEDDS)
"RTN","%ZVEMDL",89,0)
 Q
"RTN","%ZVEMDL1")
0^6^B3976794
"RTN","%ZVEMDL1",1,0)
%ZVEMDL1 ;DJB,VEDD**Start at a particular field?,Hd,Error ; 9/6/02 8:08am
"RTN","%ZVEMDL1",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMDL1",3,0)
 ;
"RTN","%ZVEMDL1",4,0)
ASK ;Start at a particular field?
"RTN","%ZVEMDL1",5,0)
 I $G(VEDDS)>1 D  Q  ;Don't ask when branching
"RTN","%ZVEMDL1",6,0)
 . S DASHES="",(LEV,RCNT)=1,FILE(LEV)=ZNUM,FLD(LEV)=0
"RTN","%ZVEMDL1",7,0)
 I $G(FLAGPRM)="VEDD",$G(%2)="G" S SFLD="" G ASK1
"RTN","%ZVEMDL1",8,0)
 W ! I VEDDS'>1 D  Q:FLAGQ
"RTN","%ZVEMDL1",9,0)
 . S SFLD=$$CHOICE^%ZVEMKC("ALL_FIELDS^STARTING_FIELD^QUIT^EXIT",1)
"RTN","%ZVEMDL1",10,0)
 . I "0,3,4"[SFLD S FLAGQ=1 S:SFLD=4 FLAGE=1 Q
"RTN","%ZVEMDL1",11,0)
 . S SFLD=$S(SFLD=2:"F",1:"")
"RTN","%ZVEMDL1",12,0)
 I VEDDS>1 D  Q:FLAGQ
"RTN","%ZVEMDL1",13,0)
 . S SFLD=$$CHOICE^%ZVEMKC("ALL_FIELDS^STARTING_FIELD^QUIT",1)
"RTN","%ZVEMDL1",14,0)
 . I "0,3"[SFLD S FLAGQ=1 Q
"RTN","%ZVEMDL1",15,0)
 . S SFLD=$S(SFLD=2:"F",1:"")
"RTN","%ZVEMDL1",16,0)
ASK1 ;Parameter passing
"RTN","%ZVEMDL1",17,0)
 S DASHES="",(LEV,RCNT)=1,FILE(LEV)=ZNUM,FLD(LEV)=0
"RTN","%ZVEMDL1",18,0)
 I SFLD="F" D  Q:FLAGQ
"RTN","%ZVEMDL1",19,0)
 . S DIC="^DD("_ZNUM_",",DIC(0)="QEAN"
"RTN","%ZVEMDL1",20,0)
 . S DIC("W")="I $P(^DD(ZNUM,Y,0),U,2)>0 W ?65,""  -->Mult"""
"RTN","%ZVEMDL1",21,0)
 . S DIC("A")="  Select FIELD: "
"RTN","%ZVEMDL1",22,0)
 . W ! D ^DIC KILL DIC("A"),DIC("W") I Y<0 S FLAGQ=1 Q
"RTN","%ZVEMDL1",23,0)
 . S FLAGSTRT=$P(Y,"^",2)
"RTN","%ZVEMDL1",24,0)
 I $G(FLAGPRM)="VEDD",$G(%3)]"" D  Q:FLAGQ
"RTN","%ZVEMDL1",25,0)
 . S X=%3,%3="",DIC="^DD("_ZNUM_",",DIC(0)="QEN"
"RTN","%ZVEMDL1",26,0)
 . D ^DIC I Y<0 D  S FLAGQ=1 Q
"RTN","%ZVEMDL1",27,0)
 . . W !!?2,"Third parameter is not a valid field name/number.",!
"RTN","%ZVEMDL1",28,0)
 . S FLAGFIND=$P(Y,"^",2)
"RTN","%ZVEMDL1",29,0)
 . Q
"RTN","%ZVEMDL1",30,0)
 Q
"RTN","%ZVEMDL1",31,0)
 ;====================================================================
"RTN","%ZVEMDL1",32,0)
HD ;Heading when printing
"RTN","%ZVEMDL1",33,0)
 W !?5,"NODE ; PIECE",?19,"FLD NUM",?49,"FIELD NAME"
"RTN","%ZVEMDL1",34,0)
 W !?5,"------------",?19,"--------",?29,"--------------------------------------------------"
"RTN","%ZVEMDL1",35,0)
 Q
"RTN","%ZVEMDL1",36,0)
ERROR ;Error trap
"RTN","%ZVEMDL1",37,0)
 NEW ZE
"RTN","%ZVEMDL1",38,0)
 S @("ZE="_VEE("$ZE"))
"RTN","%ZVEMDL1",39,0)
 S FLAGQ=1 D ENDSCR^%ZVEMKT2
"RTN","%ZVEMDL1",40,0)
 I $G(VEDDS)>0 D  S VEDDS=VEDDS-1
"RTN","%ZVEMDL1",41,0)
 . KILL ^TMP("VEE","VEDD"_VEDDS,$J),^TMP("VEE","ID"_VEDDS,$J)
"RTN","%ZVEMDL1",42,0)
 I ZE["<INRPT>" W !!?1,"....Interrupted.",!! Q
"RTN","%ZVEMDL1",43,0)
 D ERRMSG^%ZVEMKU1("FGL/VEDD"),PAUSE^%ZVEMKU(2)
"RTN","%ZVEMDL1",44,0)
 Q
"RTN","%ZVEMDLB")
0^7^B4986436
"RTN","%ZVEMDLB",1,0)
%ZVEMDLB ;DJB,VEDD**Branch to Pointed-To File [11/07/94]
"RTN","%ZVEMDLB",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMDLB",3,0)
 ;
"RTN","%ZVEMDLB",4,0)
EN ;
"RTN","%ZVEMDLB",5,0)
 S U="^"
"RTN","%ZVEMDLB",6,0)
 S ^TMP("VEE",$J)=$$GETFILE() I ^TMP("VEE",$J)'>0 KILL ^($J) Q
"RTN","%ZVEMDLB",7,0)
 D ENDSCR^%ZVEMKT2
"RTN","%ZVEMDLB",8,0)
 D SYMTAB^%ZVEMKST("C","VEDDL",VEDDS) ;Clear symbol table
"RTN","%ZVEMDLB",9,0)
 S ZNUM=$P(^TMP("VEE",$J),U,1),ZNAM=$P(^($J),U,2),ZGL="^"_$P(^($J),U,3)
"RTN","%ZVEMDLB",10,0)
 S (FLAGE,FLAGQ,FLAGP)=0
"RTN","%ZVEMDLB",11,0)
 KILL ^TMP("VEE",$J)
"RTN","%ZVEMDLB",12,0)
 D EN^%ZVEMDL ;Recursive call
"RTN","%ZVEMDLB",13,0)
 D SYMTAB^%ZVEMKST("R","VEDDL",VEDDS) ;Restore symbol table
"RTN","%ZVEMDLB",14,0)
 Q
"RTN","%ZVEMDLB",15,0)
GETFILE() ;Return file number or zero
"RTN","%ZVEMDLB",16,0)
 NEW DATA,DD,FILE,FILENUM,FLD,GLB,I,REF,VEEX,VEEY
"RTN","%ZVEMDLB",17,0)
 S REF=$$GETREF^%ZVEMKTR("ID"_VEDDS) I REF="^" Q 0
"RTN","%ZVEMDLB",18,0)
 I REF="***" W $C(7) Q 0
"RTN","%ZVEMDLB",19,0)
 I '$D(^TMP("VEE","VEDD"_VEDDS,$J,REF)) Q 0
"RTN","%ZVEMDLB",20,0)
 S DATA=^(REF),FILE=$P(DATA,U,1),FLD=$P(DATA,U,2)
"RTN","%ZVEMDLB",21,0)
 I '$D(^DD(FILE,FLD,0)) Q 0
"RTN","%ZVEMDLB",22,0)
 S DD=^(0) I $P(DD,U,2)'["P",$P(DD,U,2)'["V" D MSG^%ZVEMDUM(1,1) Q 0
"RTN","%ZVEMDLB",23,0)
 S (VEEX,VEEY)=$P(DD,U,2) D @$S(VEEX["P":"POINTER",1:"VAR")
"RTN","%ZVEMDLB",24,0)
 I FILENUM'>0 Q 0
"RTN","%ZVEMDLB",25,0)
 I '$D(^DD(FILENUM)) D MSG^%ZVEMDUM(2,1) Q 0
"RTN","%ZVEMDLB",26,0)
 S GLB=$G(^DIC(FILENUM,0,"GL")) I GLB']"" D MSG^%ZVEMDUM(7,1) Q 0
"RTN","%ZVEMDLB",27,0)
 I $E(GLB)="^" S GLB=$E(GLB,2,999)
"RTN","%ZVEMDLB",28,0)
 Q FILENUM_"^"_$$GETNAME(FILENUM)_"^"_GLB
"RTN","%ZVEMDLB",29,0)
GETNAME(X) ;File file name
"RTN","%ZVEMDLB",30,0)
 I '$D(^DIC(X,0)) Q ""
"RTN","%ZVEMDLB",31,0)
 Q $P(^DIC(X,0),"^",1)
"RTN","%ZVEMDLB",32,0)
POINTER ;Get file number from piece 2 of data dictionary
"RTN","%ZVEMDLB",33,0)
 F I=1:1:$L(VEEX) Q:$E(VEEX,I)?1N!($E(VEEX,I)=".")  S VEEY=$E(VEEY,2,99)
"RTN","%ZVEMDLB",34,0)
 S FILENUM=+VEEY
"RTN","%ZVEMDLB",35,0)
 Q
"RTN","%ZVEMDLB",36,0)
VAR ;Variable Pointer
"RTN","%ZVEMDLB",37,0)
 NEW ANS,CHOICE,CNT,VAR,X,Y
"RTN","%ZVEMDLB",38,0)
 S FILENUM=0 I '$D(^DD(FILE,FLD,"V",0)) D MSG^%ZVEMDUM(3,1) Q
"RTN","%ZVEMDLB",39,0)
 D ENDSCR^%ZVEMKT2
"RTN","%ZVEMDLB",40,0)
 W !!?1,"VARIABLE POINTER:" S X=0,CNT=1
"RTN","%ZVEMDLB",41,0)
 F  S X=$O(^DD(FILE,FLD,"V",X)) Q:X'>0  S Y=^(X,0) D  ;
"RTN","%ZVEMDLB",42,0)
 . W !?3,CNT,". ",$P(Y,U,2)," (",$P(Y,U),")"
"RTN","%ZVEMDLB",43,0)
 . S VAR(CNT)=$P(Y,U),CNT=CNT+1
"RTN","%ZVEMDLB",44,0)
 W !
"RTN","%ZVEMDLB",45,0)
VAR1 W !?1,"Select NUMBER of your choice: "
"RTN","%ZVEMDLB",46,0)
 R ANS:VEE("TIME") S:'$T ANS="^" I "^"[ANS Q
"RTN","%ZVEMDLB",47,0)
 I '$D(VAR(ANS)) D  G VAR1
"RTN","%ZVEMDLB",48,0)
 . W !?1,"Enter number of your choice from left hand column"
"RTN","%ZVEMDLB",49,0)
 S FILENUM=VAR(ANS)
"RTN","%ZVEMDLB",50,0)
 Q
"RTN","%ZVEMDLD")
0^8^B10779468
"RTN","%ZVEMDLD",1,0)
%ZVEMDLD ;DJB,VEDD**Data: Look-up [08/12/94]
"RTN","%ZVEMDLD",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMDLD",3,0)
 ;
"RTN","%ZVEMDLD",4,0)
 I $G(ZGL)["^DIA(" D  D PAUSE^%ZVEMKC(3) Q
"RTN","%ZVEMDLD",5,0)
 . D ENDSCR^%ZVEMKT2
"RTN","%ZVEMDLD",6,0)
 . W $C(7),!?1,"You can't view data from ^DIA"
"RTN","%ZVEMDLD",7,0)
 NEW D0,D1,D2,D3,D4,D5,D6,DA,DIC,DICHOLD,DIQ,DR
"RTN","%ZVEMDLD",8,0)
 NEW FILE,FILEUP,FLAGLONG,FLAGQ,FLAGT,FLAGWP,FLD,FLDUP,FNAM
"RTN","%ZVEMDLD",9,0)
 NEW ANS,I,II,NODE,REF,REF1,TEMP,TYPE,WP,XXUP,ZDIC,ZDIQ
"RTN","%ZVEMDLD",10,0)
 S FLAGQ=0 D ACCESS^%ZVEMDLE Q:FLAGQ
"RTN","%ZVEMDLD",11,0)
 KILL ^UTILITY("DIQ1",$J),^TMP("VEE","VEDD",$J,"DATA")
"RTN","%ZVEMDLD",12,0)
 S FLAGLONG=0 ;FLAGLONG set to 1 if DR string too long.
"RTN","%ZVEMDLD",13,0)
 S REF=$$GETRANG^%ZVEMKTR("VEDD"_VEDDS) Q:REF="^"
"RTN","%ZVEMDLD",14,0)
 D ENDSCR^%ZVEMKT2 D GETTYPE^%ZVEMDLE Q:FLAGQ
"RTN","%ZVEMDLD",15,0)
 I REF["^" F REF1=$P(REF,"^",1):1:$P(REF,"^",2) D SET,BUILD
"RTN","%ZVEMDLD",16,0)
 I REF["," F I=1:1:$L(REF,",") S REF1=$P(REF,",",I) D SET,BUILD
"RTN","%ZVEMDLD",17,0)
 D DR F  D DA Q:FLAGQ  D DIQ,PRINT^%ZVEMDLE KILL ^UTILITY("DIQ1",$J) Q:FLAGQ
"RTN","%ZVEMDLD",18,0)
KILL ;
"RTN","%ZVEMDLD",19,0)
 KILL ^UTILITY("DIQ1",$J),^TMP("VEE","VEDD",$J,"DATA")
"RTN","%ZVEMDLD",20,0)
 Q
"RTN","%ZVEMDLD",21,0)
 ;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
"RTN","%ZVEMDLD",22,0)
SET ;Set Variables FILE & FLD
"RTN","%ZVEMDLD",23,0)
 S FILE=$P(^TMP("VEE","VEDD"_VEDDS,$J,REF1),U)
"RTN","%ZVEMDLD",24,0)
 S FLD=$P(^(REF1),U,2)
"RTN","%ZVEMDLD",25,0)
 I $P(^DD(FILE,FLD,0),U,2)["W" S FLAGWP(FILE)="" ;Word Processing Fld
"RTN","%ZVEMDLD",26,0)
 Q
"RTN","%ZVEMDLD",27,0)
BUILD ;Set ^TMP("VEE","VEDD",$J,"DATA") to sort FILE and FLD to be used to build DR variable.
"RTN","%ZVEMDLD",28,0)
 S FLAGT=0 F  D  Q:FLAGT
"RTN","%ZVEMDLD",29,0)
 . I '$D(^DD(FILE,0,"UP")) S ^TMP("VEE","VEDD",$J,"DATA",FILE,FLD)="",FLAGT=1 Q
"RTN","%ZVEMDLD",30,0)
 . S ^TMP("VEE","VEDD",$J,"DATA",FILE,FLD)=""
"RTN","%ZVEMDLD",31,0)
 . S FILEUP=^DD(FILE,0,"UP"),FLDUP=$O(^DD(FILEUP,"SB",FILE,""))
"RTN","%ZVEMDLD",32,0)
 . S NODE(FILE)=$P($P(^DD(FILEUP,FLDUP,0),U,4),";")
"RTN","%ZVEMDLD",33,0)
 . I +NODE(FILE)'=NODE(FILE) S NODE(FILE)=""""_NODE(FILE)_"""" ;If NODE(FILE) is a string, enclose in quotes.
"RTN","%ZVEMDLD",34,0)
 . S FILE=FILEUP,FLD=FLDUP
"RTN","%ZVEMDLD",35,0)
 Q
"RTN","%ZVEMDLD",36,0)
DR ;Build DR variable
"RTN","%ZVEMDLD",37,0)
 S (DR,FILE)="" F I=1:1 S FILE=$O(^TMP("VEE","VEDD",$J,"DATA",FILE)) Q:FILE=""!FLAGLONG  S:I=1 DR="" S:I>1 DR(FILE)="" S FLD="" F II=1:1 S FLD=$O(^TMP("VEE","VEDD",$J,"DATA",FILE,FLD)) Q:FLD=""!FLAGLONG  D
"RTN","%ZVEMDLD",38,0)
 . I I=1 S DR=DR_$S(II>1:";",1:"")_FLD S:$L(DR)>225 FLAGLONG=1 Q
"RTN","%ZVEMDLD",39,0)
 . S DR(FILE)=DR(FILE)_$S(II>1:";",1:"")_FLD
"RTN","%ZVEMDLD",40,0)
 . S:$L(DR(FILE))>225 FLAGLONG=1
"RTN","%ZVEMDLD",41,0)
 Q
"RTN","%ZVEMDLD",42,0)
DA ;Set DA Variable for each layer
"RTN","%ZVEMDLD",43,0)
 S FLAGQ=0,DIC=ZGL,DIC(0)="QEAM"
"RTN","%ZVEMDLD",44,0)
 W ! D ^DIC I Y<0 S FLAGQ=1 S:X="^^" FLAGE=1 Q
"RTN","%ZVEMDLD",45,0)
 S (DA,D0)=+Y,ZDIC(ZNUM)=DIC_+Y_"," ;EN^DIQ1 needs D0 defined
"RTN","%ZVEMDLD",46,0)
 S FILE="" F  S FILE=$O(DR(FILE)) Q:FILE=""!FLAGQ  D
"RTN","%ZVEMDLD",47,0)
 . I $D(FLAGWP(FILE)) S DA(FILE)=1 Q
"RTN","%ZVEMDLD",48,0)
 . S FILEUP=^DD(FILE,0,"UP"),TEMP=ZDIC(FILEUP)_NODE(FILE)_",0)"
"RTN","%ZVEMDLD",49,0)
 . I $O(@TEMP)'>0 D  Q
"RTN","%ZVEMDLD",50,0)
 . . I ZDIQ'["N" F I=1:1:$L(DR(FILE),";") S ^UTILITY("DIQ1",$J,FILE,DA,$P(DR(FILE),";",I),TYPE)="" ;No data at this node. This will display each field as blank.
"RTN","%ZVEMDLD",51,0)
 . . S ZDIC(FILE)=ZDIC(FILEUP)_NODE(FILE)_",""VEDD""," ;So any levels below this will be null.
"RTN","%ZVEMDLD",52,0)
 . S DIC=ZDIC(FILEUP)_NODE(FILE)_","
"RTN","%ZVEMDLD",53,0)
 . D ^DIC I Y<0 S FLAGQ=1 S:X="^^" FLAGE=1 Q
"RTN","%ZVEMDLD",54,0)
 . S DA(FILE)=+Y,ZDIC(FILE)=DIC_+Y_","
"RTN","%ZVEMDLD",55,0)
 Q
"RTN","%ZVEMDLD",56,0)
DIQ ;Call EN^DIQ1 to set up VEDD array.
"RTN","%ZVEMDLD",57,0)
 S DIC=ZGL,DIQ(0)=ZDIQ D EN^DIQ1
"RTN","%ZVEMDLD",58,0)
 Q
"RTN","%ZVEMDLE")
0^9^B9238671
"RTN","%ZVEMDLE",1,0)
%ZVEMDLE ;DJB,VEDD**Data: Type,Access [07/31/94]
"RTN","%ZVEMDLE",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMDLE",3,0)
 ;
"RTN","%ZVEMDLE",4,0)
GETTYPE ;Select data type for DATA Option
"RTN","%ZVEMDLE",5,0)
 W !?1,"Select DISPLAY TYPE: EN//"
"RTN","%ZVEMDLE",6,0)
 R ZDIQ:VEE("TIME") S:'$T ZDIQ="^" S:ZDIQ="" ZDIQ="EN"
"RTN","%ZVEMDLE",7,0)
 I ZDIQ["^" S FLAGQ=1 Q
"RTN","%ZVEMDLE",8,0)
 I ZDIQ["?" D HELP G GETTYPE
"RTN","%ZVEMDLE",9,0)
 S ZDIQ=$$ALLCAPS^%ZVEMKU(ZDIQ)
"RTN","%ZVEMDLE",10,0)
 I ",E,I,EN,IN,"'[(","_ZDIQ_",") W $C(7),"  ??" G GETTYPE
"RTN","%ZVEMDLE",11,0)
 S TYPE=$S(",E,EN,"[(","_ZDIQ_","):"E",1:"I")
"RTN","%ZVEMDLE",12,0)
 Q
"RTN","%ZVEMDLE",13,0)
HELP ;
"RTN","%ZVEMDLE",14,0)
 W !?10,"'E' Display external value of fields",!?10,"'I' Display internal value of fields",!?9,"'EN' Display external value of fields and ignore null fields",!?9,"'IN' Display internal value of fields and ignore null fields"
"RTN","%ZVEMDLE",15,0)
 Q
"RTN","%ZVEMDLE",16,0)
ACCESS ;Check users READ access
"RTN","%ZVEMDLE",17,0)
 NEW DIFILE,DIAC
"RTN","%ZVEMDLE",18,0)
 Q:DUZ(0)["@"!('$D(^DIC(ZNUM,0,"RD")))
"RTN","%ZVEMDLE",19,0)
 I ^DD("VERSION")<18 D:DUZ(0)'=^DIC(ZNUM,0,"RD") MSG Q
"RTN","%ZVEMDLE",20,0)
 S DIFILE=ZNUM,DIAC="RD" D ^DIAC I DIAC<1 D MSG
"RTN","%ZVEMDLE",21,0)
 Q
"RTN","%ZVEMDLE",22,0)
MSG ;Access message
"RTN","%ZVEMDLE",23,0)
 S FLAGQ=1 W $C(7),!!?2,"You do not have READ access to the ",ZNAM," file." D PAUSE^%ZVEMKC(2)
"RTN","%ZVEMDLE",24,0)
 Q
"RTN","%ZVEMDLE",25,0)
PRINT ;Print Field(s)
"RTN","%ZVEMDLE",26,0)
 W @VEE("IOF") D HD S FILE=""
"RTN","%ZVEMDLE",27,0)
 F  S FILE=$O(^UTILITY("DIQ1",$J,FILE)) Q:FILE=""!FLAGQ  S DA="" F  S DA=$O(^UTILITY("DIQ1",$J,FILE,DA)) Q:DA=""!FLAGQ  S FLD="" F  S FLD=$O(^UTILITY("DIQ1",$J,FILE,DA,FLD)) Q:FLD=""!FLAGQ  D  I $Y>VEESIZE D PAGE
"RTN","%ZVEMDLE",28,0)
 .I $D(^UTILITY("DIQ1",$J,FILE,DA,FLD,TYPE)) W !,$J($P(^DD(FILE,FLD,0),U),20),":  ",^UTILITY("DIQ1",$J,FILE,DA,FLD,TYPE) Q
"RTN","%ZVEMDLE",29,0)
 .W !!,$J($P(^DD(FILE,FLD,0),U),20),":   Word Processing" I $Y>VEESIZE D PAGE Q:FLAGQ
"RTN","%ZVEMDLE",30,0)
 .S WP="" F  S WP=$O(^UTILITY("DIQ1",$J,FILE,DA,FLD,WP)) Q:WP=""  W !,^UTILITY("DIQ1",$J,FILE,DA,FLD,WP) I $Y>VEESIZE D PAGE Q:FLAGQ
"RTN","%ZVEMDLE",31,0)
 .W !
"RTN","%ZVEMDLE",32,0)
 Q:FLAGE
"RTN","%ZVEMDLE",33,0)
 W:'$D(^UTILITY("DIQ1",$J)) !?2,"No data in requested fields." W !,$E(VEELINE,1,VEE("IOM"))
"RTN","%ZVEMDLE",34,0)
 Q
"RTN","%ZVEMDLE",35,0)
PAGE ;Page
"RTN","%ZVEMDLE",36,0)
 D PAUSEQE^%ZVEMKC(2) Q:FLAGQ  W @VEE("IOF")
"RTN","%ZVEMDLE",37,0)
 Q
"RTN","%ZVEMDLE",38,0)
HD ;Heading
"RTN","%ZVEMDLE",39,0)
 I FLAGLONG W $C(7),!?2,"NOTE: You asked for too many fields. I will display as many as I can.",!
"RTN","%ZVEMDLE",40,0)
 W !?29,"D A T A   D I S P L A Y",!?2,"File: ",ZNAM,!,$E(VEELINE,1,VEE("IOM"))
"RTN","%ZVEMDLE",41,0)
 Q
"RTN","%ZVEMDLI")
0^10^B6091257
"RTN","%ZVEMDLI",1,0)
%ZVEMDLI ;DJB,VEDD**Import [5/3/95 12:49pm]
"RTN","%ZVEMDLI",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMDLI",3,0)
 ;
"RTN","%ZVEMDLI",4,0)
 Q:FLAGP  D SETARRAY,LIST
"RTN","%ZVEMDLI",5,0)
 Q
"RTN","%ZVEMDLI",6,0)
 ;===================================================================
"RTN","%ZVEMDLI",7,0)
GETVEET ;Set VEET=Display text
"RTN","%ZVEMDLI",8,0)
 S VEET=$G(^TMP("VEE","ID"_VEDDS,$J,VEET("BOT")))
"RTN","%ZVEMDLI",9,0)
 Q
"RTN","%ZVEMDLI",10,0)
LIST ;Display text
"RTN","%ZVEMDLI",11,0)
 Q:'$D(^TMP("VEE","ID"_VEDDS,$J,VEET("BOT")))
"RTN","%ZVEMDLI",12,0)
 D GETVEET W !,VEET
"RTN","%ZVEMDLI",13,0)
 S VEET("BOT")=VEET("BOT")+1
"RTN","%ZVEMDLI",14,0)
 S:VEET("GAP") VEET("GAP")=VEET("GAP")-1
"RTN","%ZVEMDLI",15,0)
 S VEET("HLN")=VEET("HLN")+1
"RTN","%ZVEMDLI",16,0)
 S:VEET("H$Y")<VEET("S2") VEET("H$Y")=VEET("H$Y")+1
"RTN","%ZVEMDLI",17,0)
 I $G(FLAGSTRT)]"" D FINDCHK(1) G:$G(FLAGSTRT)]"" LIST ;Starting field
"RTN","%ZVEMDLI",18,0)
 I VEET=" <> <> <>"!'VEET("GAP") D READ Q:FLAGQ!FLAGE
"RTN","%ZVEMDLI",19,0)
 G LIST
"RTN","%ZVEMDLI",20,0)
SETARRAY ;Set scroll array - ^TMP("VEE","ID"_VEDDS
"RTN","%ZVEMDLI",21,0)
 NEW NUM S NUM=VEET("BOT")
"RTN","%ZVEMDLI",22,0)
 I $G(VEET)']""!($G(VEET)=" <> <> <>") D  Q
"RTN","%ZVEMDLI",23,0)
 . S ^TMP("VEE","ID"_VEDDS,$J,NUM)=" <> <> <>"
"RTN","%ZVEMDLI",24,0)
 S ^TMP("VEE","ID"_VEDDS,$J,NUM)=VEET
"RTN","%ZVEMDLI",25,0)
 Q
"RTN","%ZVEMDLI",26,0)
ENDFILE() ;1=End-of-file  0=Ok
"RTN","%ZVEMDLI",27,0)
 I VEET("GAP") W $C(7) Q 1
"RTN","%ZVEMDLI",28,0)
 I ^TMP("VEE","ID"_VEDDS,$J,VEET("BOT")-1)=" <> <> <>" W $C(7) Q 1
"RTN","%ZVEMDLI",29,0)
 Q 0
"RTN","%ZVEMDLI",30,0)
READ ;Get input
"RTN","%ZVEMDLI",31,0)
 I $G(FLAGFIND)]"" D FINDCHK(2) Q:$G(FLAGFIND)]""  ;Find a field
"RTN","%ZVEMDLI",32,0)
 NEW KEY,PKG
"RTN","%ZVEMDLI",33,0)
READ1 S PKG="ID"_VEDDS W @VEES("CON") ;Turn cursor back on
"RTN","%ZVEMDLI",34,0)
 D CURSOR^%ZVEMKU1(9,VEET("S2")+VEET("FT")-1,1)
"RTN","%ZVEMDLI",35,0)
 S KEY=$$READ^%ZVEMKTM(PKG) Q:KEY="QUIT"
"RTN","%ZVEMDLI",36,0)
 I KEY="<TAB>" D  ;
"RTN","%ZVEMDLI",37,0)
 . S TABHLD=VEET("HLN")_"^"_VEET("H$Y") ;Keeps highlight at same node
"RTN","%ZVEMDLI",38,0)
 . S KEY=VEET("HLN")-1,KEY=$G(^TMP("VEE",PKG,$J,"SCR",KEY))
"RTN","%ZVEMDLI",39,0)
 . S:KEY']"" KEY="***"
"RTN","%ZVEMDLI",40,0)
 I ",?,<ESCH>,D,DA,F,G,I,G,N,P,VGL,"'[(","_KEY_","),KEY'?1.N W $C(7) G READ1
"RTN","%ZVEMDLI",41,0)
 D RUN^%ZVEMDLM(KEY) Q:FLAGQ  D REDRAW^%ZVEMKT2()
"RTN","%ZVEMDLI",42,0)
 Q
"RTN","%ZVEMDLI",43,0)
FINDCHK(TYPE) ;Find a field
"RTN","%ZVEMDLI",44,0)
 ;TYPE - 1=Starting Field  2=Field Search
"RTN","%ZVEMDLI",45,0)
 NEW NAM
"RTN","%ZVEMDLI",46,0)
 I VEET=" <> <> <>" W $C(7) KILL FLAGFIND,FLAGSTRT Q
"RTN","%ZVEMDLI",47,0)
 S NAM=$G(^TMP("VEE","ID"_VEDDS,$J,"FLD",VEET("BOT")-1)) Q:NAM']""
"RTN","%ZVEMDLI",48,0)
 I $G(TYPE)=2,$E(NAM,1,$L(FLAGFIND))=FLAGFIND KILL FLAGFIND Q
"RTN","%ZVEMDLI",49,0)
 I $G(TYPE)=1,$E(NAM,1,$L(FLAGSTRT))=FLAGSTRT KILL FLAGSTRT Q
"RTN","%ZVEMDLI",50,0)
 S VEET("TOP")=VEET("TOP")+1
"RTN","%ZVEMDLI",51,0)
 Q
"RTN","%ZVEMDLI",52,0)
FINISH ;Call here AFTER calling IMPORT
"RTN","%ZVEMDLI",53,0)
 I $G(FLAGFIND)]"" W $C(7) KILL FLAGFIND
"RTN","%ZVEMDLI",54,0)
 I 'FLAGQ,'FLAGE S VEET=" <> <> <>" D SETARRAY,LIST
"RTN","%ZVEMDLI",55,0)
 D ENDSCR^%ZVEMKT2 ;Reset scroll region to full screen
"RTN","%ZVEMDLI",56,0)
 Q
"RTN","%ZVEMDLM")
0^11^B2800089
"RTN","%ZVEMDLM",1,0)
%ZVEMDLM ;DJB,VEDD**Menu,Find,Goto [11/25/95 12:22pm]
"RTN","%ZVEMDLM",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMDLM",3,0)
 ;
"RTN","%ZVEMDLM",4,0)
RUN(Z1) ;
"RTN","%ZVEMDLM",5,0)
 I Z1?1.N D INDFLD Q
"RTN","%ZVEMDLM",6,0)
 I Z1="DA" D ^%ZVEMDLD Q
"RTN","%ZVEMDLM",7,0)
 I Z1="F" D FIND Q
"RTN","%ZVEMDLM",8,0)
 I Z1="G" D GOTO Q
"RTN","%ZVEMDLM",9,0)
 I Z1="P" D ^%ZVEMDLB Q
"RTN","%ZVEMDLM",10,0)
 D ENDSCR^%ZVEMKT2
"RTN","%ZVEMDLM",11,0)
 I Z1="<ESCH>" D HELP^%ZVEMKT2 Q
"RTN","%ZVEMDLM",12,0)
 I Z1="?" D HELP^%ZVEMKT("VEDD2") Q
"RTN","%ZVEMDLM",13,0)
 I Z1="I" D ^%ZVEMDI S FLAGQ=0 Q
"RTN","%ZVEMDLM",14,0)
 I Z1="N" D ^%ZVEMDN Q
"RTN","%ZVEMDLM",15,0)
 I Z1="VGL" D VGL2^%ZVEMDY Q
"RTN","%ZVEMDLM",16,0)
 Q
"RTN","%ZVEMDLM",17,0)
INDFLD ;Print Indiv Fld DD
"RTN","%ZVEMDLM",18,0)
 NEW FILE,FLAGQ,FNUM
"RTN","%ZVEMDLM",19,0)
 I '$D(^TMP("VEE","VEDD"_VEDDS,$J,Z1)) D MSG^%ZVEMDUM(4,1) Q
"RTN","%ZVEMDLM",20,0)
 D ENDSCR^%ZVEMKT2
"RTN","%ZVEMDLM",21,0)
 S FILE=$P(^TMP("VEE","VEDD"_VEDDS,$J,Z1),U)
"RTN","%ZVEMDLM",22,0)
 S FNUM=$P(^(Z1),U,2)
"RTN","%ZVEMDLM",23,0)
 S FLAGQ=0 D INDIV^%ZVEMKI1(FILE,FNUM) Q:FLAGQ  D PAUSE^%ZVEMKC(1)
"RTN","%ZVEMDLM",24,0)
 Q
"RTN","%ZVEMDLM",25,0)
FIND ;Find a field. Return FLAGFIND if search is valid
"RTN","%ZVEMDLM",26,0)
 R "   Enter FIELD NAME: ",FLAGFIND:VEE("TIME")
"RTN","%ZVEMDLM",27,0)
 S:'$T FLAGFIND="^" I "^"[FLAGFIND KILL FLAGFIND Q
"RTN","%ZVEMDLM",28,0)
 I "??"[FLAGFIND D MSG^%ZVEMDUM(5) G FIND
"RTN","%ZVEMDLM",29,0)
 I $L(FLAGFIND)>30!(FLAGFIND["""")!(FLAGFIND["=") D MSG^%ZVEMDUM(6) G FIND
"RTN","%ZVEMDLM",30,0)
 Q
"RTN","%ZVEMDLM",31,0)
GOTO ;Goto line number
"RTN","%ZVEMDLM",32,0)
 NEW ND,PKG,X S PKG="ID"_VEDDS
"RTN","%ZVEMDLM",33,0)
 S ND=$$GETREF^%ZVEMKTR(PKG) Q:ND="^"
"RTN","%ZVEMDLM",34,0)
 I ND="***" W $C(7) Q
"RTN","%ZVEMDLM",35,0)
 I '$D(^TMP("VEE","VEDD"_VEDDS,$J,ND)) D  Q:ND'>0
"RTN","%ZVEMDLM",36,0)
 . S ND=$O(^TMP("VEE","VEDD"_VEDDS,$J,ND)) Q:ND>0
"RTN","%ZVEMDLM",37,0)
 . S ND=$O(^TMP("VEE","VEDD"_VEDDS,$J,ND),-1)
"RTN","%ZVEMDLM",38,0)
 S VEET("TOP")=$$GETSCR^%ZVEMKTR(ND,PKG)
"RTN","%ZVEMDLM",39,0)
 Q
"RTN","%ZVEMDM")
0^12^B8642981
"RTN","%ZVEMDM",1,0)
%ZVEMDM ;DJB,VEDD**Menu Driver ; 12/6/00 9:18pm
"RTN","%ZVEMDM",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMDM",3,0)
 ;
"RTN","%ZVEMDM",4,0)
EN ;Entry Point
"RTN","%ZVEMDM",5,0)
 NEW I,LIST,OPT,X,Y
"RTN","%ZVEMDM",6,0)
 D INIT
"RTN","%ZVEMDM",7,0)
 I $G(FLAGPRM)="VEDD",$G(%2)]"" S OPT=%2 G GETOPT1
"RTN","%ZVEMDM",8,0)
 D HD
"RTN","%ZVEMDM",9,0)
 I FLAGP F I=1,7,13,2,8,14,3,9,4,10,5,11,6,12 S X=$T(MENU+I) Q:X=""  W @$S(I<7:"!?1",I<13:"?26",1:"?56"),$S(I=5:"*",I=9:"*",I=12:"*",I=13:"*",1:" "),$J($P(LIST,"^",I),3)_"  ",$P(X,";",3)
"RTN","%ZVEMDM",10,0)
 E  F I=1,7,13,2,8,14,3,9,4,10,5,11,6,12 S X=$T(MENU+I) Q:X=""  W @$S(I<7:"!?1",I<13:"?26",1:"?56")," ",$J($P(LIST,"^",I),3)_"  ",$P(X,";",3)
"RTN","%ZVEMDM",11,0)
 W !
"RTN","%ZVEMDM",12,0)
GETOPT ;Get Menu option to run
"RTN","%ZVEMDM",13,0)
 I $G(FLAGPRM)="VEDD",$G(%2)]"" G EX
"RTN","%ZVEMDM",14,0)
 R !?2,"Select OPTION: ",OPT:VEE("TIME") S:'$T OPT="^^" I "^"[OPT S FLAGM=1 G EX
"RTN","%ZVEMDM",15,0)
GETOPT1 ;Parameter passing
"RTN","%ZVEMDM",16,0)
 I OPT="^^" S FLAGE=1 G EX
"RTN","%ZVEMDM",17,0)
 S OPT=$$ALLCAPS^%ZVEMKU(OPT)
"RTN","%ZVEMDM",18,0)
 I ",C,D,G,GR,H,I,PI,PO,PR,R,T,TR,VGL,X,"[(","_OPT_",") F I=1:1:$L(LIST,"^") I $P(LIST,"^",I)=OPT S OPT=I Q
"RTN","%ZVEMDM",19,0)
 I OPT?1.N,$T(MENU+OPT)'="" G RUN
"RTN","%ZVEMDM",20,0)
 I OPT'?1.N F I=1:1 S X=$P($T(MENU+I),";",5) Q:X=""  I $E(X,1,$L(OPT))=OPT W $E(X,$L(OPT)+1,VEE("IOM")) S OPT=I G RUN
"RTN","%ZVEMDM",21,0)
 W:OPT'["?" $C(7) W "   Enter Option mnemonic or name."
"RTN","%ZVEMDM",22,0)
 G GETOPT
"RTN","%ZVEMDM",23,0)
RUN ;Run selected menu option
"RTN","%ZVEMDM",24,0)
 S X=$T(MENU+OPT) D
"RTN","%ZVEMDM",25,0)
 . I $P(X,";",5)="HELP" D @$P(X,";",4) S FLAGQ=1 Q
"RTN","%ZVEMDM",26,0)
 . D @$P(X,";",4)
"RTN","%ZVEMDM",27,0)
 I FLAGG S FLAGG=0 G GETOPT ;FLAGG=No Groups or no Pointers.
"RTN","%ZVEMDM",28,0)
EX ;
"RTN","%ZVEMDM",29,0)
 Q
"RTN","%ZVEMDM",30,0)
HD ;Heading
"RTN","%ZVEMDM",31,0)
 W !?31,"M A I N   M E N U" W:FLAGP ?56,"[*=Opts not printable]" W !
"RTN","%ZVEMDM",32,0)
 Q
"RTN","%ZVEMDM",33,0)
INIT ;
"RTN","%ZVEMDM",34,0)
 S LIST="X^PI^PO^GR^TR^I^G^T^D^C^R^VGL^PR^H"
"RTN","%ZVEMDM",35,0)
 Q
"RTN","%ZVEMDM",36,0)
CHECK ;Check validity of mnemonic passed as %2. Called by PARAM^%ZVEMD.
"RTN","%ZVEMDM",37,0)
 Q:",X,PI,PO,GR,TR,I,G,T,D,C,R,"[(","_%2_",")
"RTN","%ZVEMDM",38,0)
 S %2="" W $C(7),!!?2,"Second parameter is not a valid menu option mnemonic."
"RTN","%ZVEMDM",39,0)
 W !?2,"Valid mnemonics: X,PI,PO,GR,TR,I,G,T,D,C,R",!
"RTN","%ZVEMDM",40,0)
 Q
"RTN","%ZVEMDM",41,0)
MENU ;MENU OPTIONS
"RTN","%ZVEMDM",42,0)
 ;;Keys & Indexes;^%ZVEMDX;KEYS & INDEXES
"RTN","%ZVEMDM",43,0)
 ;;Pointers IN;PTI^%ZVEMDPT;POINTERS IN
"RTN","%ZVEMDM",44,0)
 ;;Pointers OUT;PTO^%ZVEMDPT;POINTERS OUT
"RTN","%ZVEMDM",45,0)
 ;;Groups;GRP^%ZVEMDU;GROUPS
"RTN","%ZVEMDM",46,0)
 ;;Trace a Field;EN^%ZVEMDT;TRACE A FIELD
"RTN","%ZVEMDM",47,0)
 ;;Indiv Fld DD;^%ZVEMDI;INDIV FLD DD
"RTN","%ZVEMDM",48,0)
 ;;Fld Global Location;EN^%ZVEMDL;FLD GLOBAL LOCATION
"RTN","%ZVEMDM",49,0)
 ;;Templates;EN^%ZVEMDU1;TEMPLATES
"RTN","%ZVEMDM",50,0)
 ;;File Description;DES^%ZVEMDU1;FILE DESCRIPTION
"RTN","%ZVEMDM",51,0)
 ;;File Characteristics;CHAR^%ZVEMDC;FILE CHARACTERISTICS
"RTN","%ZVEMDM",52,0)
 ;;Required Fields;REQ^%ZVEMDU;REQUIRED FIELDS
"RTN","%ZVEMDM",53,0)
 ;;VGlobal Lister;VGL1^%ZVEMDY;VGLOBAL LISTER
"RTN","%ZVEMDM",54,0)
 ;;Printing-On/Off;PRINTM^%ZVEMDPR;PRINTING-ON/OFF
"RTN","%ZVEMDM",55,0)
 ;;Help;HELP^%ZVEMKT("VEDD1");HELP
"RTN","%ZVEMDN")
0^13^B8463697
"RTN","%ZVEMDN",1,0)
%ZVEMDN ;DJB,VEDD**NODE Lookup and Look-up by Global [11/04/94]
"RTN","%ZVEMDN",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMDN",3,0)
 ;
"RTN","%ZVEMDN",4,0)
 NEW FILE,FLD,NODE,NODE0,NODE1,PIECE
"RTN","%ZVEMDN",5,0)
 NEW FLAGD,FNAM,FNUM,LEV,NP
"RTN","%ZVEMDN",6,0)
 KILL ^TMP("VEE","VEDD",$J,"NP") S FILE=ZNUM
"RTN","%ZVEMDN",7,0)
ND ;Lookup by NODE and PIECE
"RTN","%ZVEMDN",8,0)
 D NDGET G:FLAGQ EX D NDBLD
"RTN","%ZVEMDN",9,0)
 I '$D(^TMP("VEE","VEDD",$J,"NP")) W $C(7),"   No such node." G ND
"RTN","%ZVEMDN",10,0)
ND1 D NDPRT G:FLAGQ EX
"RTN","%ZVEMDN",11,0)
 I $O(^TMP("VEE","VEDD",$J,"NP",NODE,""))=0 S FILE=+$P(^TMP("VEE","VEDD",$J,"NP",NODE,0),U,3),NODE1=NODE G ND
"RTN","%ZVEMDN",12,0)
 D NDSUM G:FLAGD ND G:FLAGE EX
"RTN","%ZVEMDN",13,0)
 S FLAGQ=0 G ND1
"RTN","%ZVEMDN",14,0)
EX ;
"RTN","%ZVEMDN",15,0)
 S:'FLAGE FLAGQ=0 KILL ^TMP("VEE","VEDD",$J,"NP")
"RTN","%ZVEMDN",16,0)
 Q
"RTN","%ZVEMDN",17,0)
NDGET ;Node get
"RTN","%ZVEMDN",18,0)
NDGET1 I FILE'=ZNUM W !!,"Select '",NODE1,"' SUBNODE: "
"RTN","%ZVEMDN",19,0)
 E  W !,"Select NODE: "
"RTN","%ZVEMDN",20,0)
 R NODE:VEE("TIME") S:'$T NODE="^" I "^"[NODE S FLAGQ=1 Q
"RTN","%ZVEMDN",21,0)
 I NODE="?" D HELP G NDGET1
"RTN","%ZVEMDN",22,0)
 Q
"RTN","%ZVEMDN",23,0)
NDBLD ;
"RTN","%ZVEMDN",24,0)
 S FLD=0 KILL ^TMP("VEE","VEDD",$J,"NP")
"RTN","%ZVEMDN",25,0)
 F  S FLD=$O(^DD(FILE,FLD)) Q:FLD'>0  I $P($P(^DD(FILE,FLD,0),U,4),";")=NODE S NODE0=^(0),NP=$P(NODE0,U,4),PIECE=$P(NP,";",2),^TMP("VEE","VEDD",$J,"NP",NODE,PIECE)=FLD_U_$P(NODE0,U,1,4)
"RTN","%ZVEMDN",26,0)
 Q
"RTN","%ZVEMDN",27,0)
NDPRT ;Print
"RTN","%ZVEMDN",28,0)
 S PIECE="" W @VEE("IOF") D HD
"RTN","%ZVEMDN",29,0)
 F  S PIECE=$O(^TMP("VEE","VEDD",$J,"NP",NODE,PIECE)) Q:PIECE=""  W !?3,$J(NODE_";"_PIECE,12),?20,$J($P(^TMP("VEE","VEDD",$J,"NP",NODE,PIECE),U),7),?32,$P(^(PIECE),U,2) I $Y>VEESIZE D PAGE Q:FLAGQ=1
"RTN","%ZVEMDN",30,0)
 Q
"RTN","%ZVEMDN",31,0)
NDSUM ;
"RTN","%ZVEMDN",32,0)
 W !!?2,"You may now do an 'INDIVIDUAL FIELD DD'",!?2,"on the field(s) listed above.."
"RTN","%ZVEMDN",33,0)
 S FLAGD=0 W ! S DIC="^DD("_FILE_",",DIC(0)="QEAM" D ^DIC I Y<0 S FLAGD=1 Q
"RTN","%ZVEMDN",34,0)
 S FNUM=+Y,FNAM=$P(Y,U,2),LEV=1,FILE(LEV)=FILE D INDIV^%ZVEMKI1(FILE(LEV),FNUM) Q:FLAGQ
"RTN","%ZVEMDN",35,0)
 I $Y'>VEESIZE F I=$Y:1:VEESIZE W !
"RTN","%ZVEMDN",36,0)
 D PAUSE^%ZVEMKC(2)
"RTN","%ZVEMDN",37,0)
 Q
"RTN","%ZVEMDN",38,0)
PAGE ;
"RTN","%ZVEMDN",39,0)
 D PAUSEQE^%ZVEMKC(2) Q:FLAGQ  W @VEE("IOF") D HD
"RTN","%ZVEMDN",40,0)
 Q
"RTN","%ZVEMDN",41,0)
HELP ;
"RTN","%ZVEMDN",42,0)
 NEW FLD,NDTEMP
"RTN","%ZVEMDN",43,0)
 S FLD=0 KILL ^TMP("VEE","VEDD",$J,"NP")
"RTN","%ZVEMDN",44,0)
 F  S FLD=$O(^DD(FILE,FLD)) Q:FLD'>0  S NDTEMP=$P($P(^DD(FILE,FLD,0),U,4),";") W:'$D(^TMP("VEE","VEDD",$J,"NP",NDTEMP))#2 "  ",NDTEMP W:$X>70 !?5 S ^TMP("VEE","VEDD",$J,"NP",NDTEMP)=""
"RTN","%ZVEMDN",45,0)
 KILL ^TMP("VEE","VEDD",$J,"NP") Q
"RTN","%ZVEMDN",46,0)
HD ;Node look-up
"RTN","%ZVEMDN",47,0)
 W !?3,"NODE ; PIECE",?20,"FLD NUM",?42,"FIELD NAME"
"RTN","%ZVEMDN",48,0)
 W !?3,"------------",?20,"-------",?32,"------------------------------"
"RTN","%ZVEMDN",49,0)
 Q
"RTN","%ZVEMDPR")
0^14^B6063778
"RTN","%ZVEMDPR",1,0)
%ZVEMDPR ;DJB,VEDD**Printing, Count Fields [6/28/95 6:42pm]
"RTN","%ZVEMDPR",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMDPR",3,0)
 ;
"RTN","%ZVEMDPR",4,0)
 ;;This is run each time VEDD is run, right after you select a File.
"RTN","%ZVEMDPR",5,0)
 ;;It sets up multiples in ^TMP("VEE","VEDD",$J,"TMP")
"RTN","%ZVEMDPR",6,0)
PRINTM ;Print Option in Main Menu
"RTN","%ZVEMDPR",7,0)
 I PRINTING'="YES" D  Q
"RTN","%ZVEMDPR",8,0)
 . W $C(7),!!?2,"NOTE: To use this option you must have ^%ZIS routines and the DEVICE and"
"RTN","%ZVEMDPR",9,0)
 . W !?8,"TERMINAL TYPE files on your system."
"RTN","%ZVEMDPR",10,0)
 S FLAGP1=1 ;Redraws Main Menu. See MENU+2^%ZVEMD.
"RTN","%ZVEMDPR",11,0)
PRINT ;
"RTN","%ZVEMDPR",12,0)
 S FLAGP=FLAGP=0 I FLAGP=0 D  Q  ;FLAGM-User hit <RET> at Main Menu
"RTN","%ZVEMDPR",13,0)
 . W:$E(VEEIOST,1,2)="P-"&('FLAGM) @VEE("IOF") D ^%ZISC
"RTN","%ZVEMDPR",14,0)
 . S VEESIZE=(IOSL-6),VEE("IOF")=IOF,VEE("IOM")=IOM-1
"RTN","%ZVEMDPR",15,0)
 . S VEE("IOSL")=IOSL,VEEIOST=IOST
"RTN","%ZVEMDPR",16,0)
 S %ZIS("A")="  DEVICE: " D ^%ZIS KILL %ZIS("A") I POP S FLAGP=0
"RTN","%ZVEMDPR",17,0)
 Q
"RTN","%ZVEMDPR",18,0)
TXT ;
"RTN","%ZVEMDPR",19,0)
 I 'FLAGP W @VEE("IOF") Q
"RTN","%ZVEMDPR",20,0)
 I $E(VEEIOST,1,2)="P-" W !!!
"RTN","%ZVEMDPR",21,0)
 E  W @VEE("IOF")
"RTN","%ZVEMDPR",22,0)
 I '$D(VEDDATE) NEW %DT,X,Y D
"RTN","%ZVEMDPR",23,0)
 . S X="NOW",%DT="T" D ^%DT
"RTN","%ZVEMDPR",24,0)
 . S VEDDATE=$$DATEDASH^%ZVEMKU1(Y)
"RTN","%ZVEMDPR",25,0)
 W !,$E(VEELINE1,1,VEE("IOM"))
"RTN","%ZVEMDPR",26,0)
 W !?2,"File:---- ",ZNAM,!?2,"Global:-- ",ZGL
"RTN","%ZVEMDPR",27,0)
 W ?(VEE("IOM")-17),"Date: ",VEDDATE,!,$E(VEELINE1,1,VEE("IOM")),!
"RTN","%ZVEMDPR",28,0)
 Q
"RTN","%ZVEMDPR",29,0)
INIT ;
"RTN","%ZVEMDPR",30,0)
 I FLAGP D  W:$E(VEEIOST,1,2)="P-" !?1,"Printing.." U IO
"RTN","%ZVEMDPR",31,0)
 . S VEESIZE=(IOSL-6),VEE("IOF")=IOF,VEE("IOM")=IOM-1
"RTN","%ZVEMDPR",32,0)
 . S VEE("IOSL")=IOSL,VEEIOST=IOST
"RTN","%ZVEMDPR",33,0)
 D TXT
"RTN","%ZVEMDPR",34,0)
 Q
"RTN","%ZVEMDPR",35,0)
MULT ;
"RTN","%ZVEMDPR",36,0)
 NEW CNT,TMP
"RTN","%ZVEMDPR",37,0)
 D MULTBLD
"RTN","%ZVEMDPR",38,0)
 Q
"RTN","%ZVEMDPR",39,0)
MULTBLD ;
"RTN","%ZVEMDPR",40,0)
 KILL ^TMP("VEE","VEDD",$J,"TMP") S CNT=1
"RTN","%ZVEMDPR",41,0)
 S ^TMP("VEE","VEDD",$J,"TMP",ZNUM)=$P(^DD(ZNUM,0),U,4)_"^"_CNT
"RTN","%ZVEMDPR",42,0)
 S ^TMP("VEE","VEDD",$J,"TOT")=$P(^DD(ZNUM,0),U,4)
"RTN","%ZVEMDPR",43,0)
 Q:'$D(^DD(ZNUM,"SB"))  S TMP(1)=ZNUM,CNT=2,TMP(CNT)=""
"RTN","%ZVEMDPR",44,0)
 F  S TMP(CNT)=$O(^DD(TMP(CNT-1),"SB",TMP(CNT))) D MULTBLD1 Q:CNT=1
"RTN","%ZVEMDPR",45,0)
 Q
"RTN","%ZVEMDPR",46,0)
MULTBLD1 ;
"RTN","%ZVEMDPR",47,0)
 I TMP(CNT)="" S CNT=CNT-1 Q
"RTN","%ZVEMDPR",48,0)
 I '$D(^DD(TMP(CNT),0)) Q
"RTN","%ZVEMDPR",49,0)
 S ^TMP("VEE","VEDD",$J,"TMP",TMP(CNT))=$P(^DD(TMP(CNT),0),U,4)_"^"_CNT_"^"_$O(^DD(TMP(CNT-1),"SB",TMP(CNT),""))
"RTN","%ZVEMDPR",50,0)
 S ^TMP("VEE","VEDD",$J,"TOT")=^TMP("VEE","VEDD",$J,"TOT")+$P(^DD(TMP(CNT),0),U,4)
"RTN","%ZVEMDPR",51,0)
 I $D(^DD(TMP(CNT),"SB")) S CNT=CNT+1,TMP(CNT)=""
"RTN","%ZVEMDPR",52,0)
 Q
"RTN","%ZVEMDPT")
0^15^B9827584
"RTN","%ZVEMDPT",1,0)
%ZVEMDPT ;DJB,VEDD**Pointers In, Pointers Out [1/7/97 3:13pm]
"RTN","%ZVEMDPT",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMDPT",3,0)
 ;
"RTN","%ZVEMDPT",4,0)
PTI ;Pointers In
"RTN","%ZVEMDPT",5,0)
 I '$D(^DD(ZNUM,0,"PT")) D  S FLAGG=1 Q
"RTN","%ZVEMDPT",6,0)
 . W ?30,"No files point to this file."
"RTN","%ZVEMDPT",7,0)
 NEW FLAGPT,HD,Z1,ZCNT,ZFILE,ZFILEN,ZFLD
"RTN","%ZVEMDPT",8,0)
 D INIT^%ZVEMDPR,HD
"RTN","%ZVEMDPT",9,0)
 S ZFILE="",ZCNT=1,HD="HD"
"RTN","%ZVEMDPT",10,0)
 F  S ZFILE=$O(^DD(ZNUM,0,"PT",ZFILE)) Q:ZFILE=""!FLAGQ  S FLAGPT=0 D @$S($D(^DIC(ZFILE,0)):"PTIYES",1:"PTINO") I 'FLAGPT S ZFLD="" F  S ZFLD=$O(^DD(ZNUM,0,"PT",ZFILE,ZFLD)) Q:ZFLD=""!FLAGQ  D PTIPRT
"RTN","%ZVEMDPT",11,0)
EX ;
"RTN","%ZVEMDPT",12,0)
 Q
"RTN","%ZVEMDPT",13,0)
PTINO ;Get file name, using a subfile
"RTN","%ZVEMDPT",14,0)
 NEW UP
"RTN","%ZVEMDPT",15,0)
 I '$D(^DD(ZFILE,0,"UP")) S FLAGPT=1 Q
"RTN","%ZVEMDPT",16,0)
 S UP=ZFILE
"RTN","%ZVEMDPT",17,0)
 F  S UP=^DD(UP,0,"UP") Q:$D(^DIC(UP,0))  Q:'$D(^DD(UP,0,"UP"))
"RTN","%ZVEMDPT",18,0)
 I '$D(^DIC(UP,0)) S FLAGPT=1 Q
"RTN","%ZVEMDPT",19,0)
 S ZFILEN=$P(^DIC(UP,0),U)
"RTN","%ZVEMDPT",20,0)
 Q
"RTN","%ZVEMDPT",21,0)
PTIYES ;Get file name
"RTN","%ZVEMDPT",22,0)
 S ZFILEN=$P(^DIC(ZFILE,0),U)
"RTN","%ZVEMDPT",23,0)
 Q
"RTN","%ZVEMDPT",24,0)
PTIPRT ;
"RTN","%ZVEMDPT",25,0)
 W !,$J(ZCNT,4),".",?6,ZFILE,?21,$E(ZFILEN,1,25),?48
"RTN","%ZVEMDPT",26,0)
 I $D(^DD(ZFILE,ZFLD,0)),$P(^(0),U)]"" D  ;
"RTN","%ZVEMDPT",27,0)
 . W $E($P(^(0),U),1,22)," (",ZFLD,")"
"RTN","%ZVEMDPT",28,0)
 E  W "--> Field ",ZFLD," does not exist."
"RTN","%ZVEMDPT",29,0)
 S ZCNT=ZCNT+1 I $Y>VEESIZE D PAGE Q:FLAGQ
"RTN","%ZVEMDPT",30,0)
 Q
"RTN","%ZVEMDPT",31,0)
PTO ;Pointers Out
"RTN","%ZVEMDPT",32,0)
 NEW CNT,FILE,HD,NAME,NODE0,NUMBER,Z1,ZDD
"RTN","%ZVEMDPT",33,0)
 D INIT^%ZVEMDPR S HD="HD1" D @HD,PTOGET
"RTN","%ZVEMDPT",34,0)
 Q
"RTN","%ZVEMDPT",35,0)
PTOGET ;
"RTN","%ZVEMDPT",36,0)
 S ZDD="",CNT=1
"RTN","%ZVEMDPT",37,0)
 F  S ZDD=$O(^TMP("VEE","VEDD",$J,"TMP",ZDD)) Q:ZDD=""!(FLAGQ)  S NAME="" F  S NAME=$O(^DD(ZDD,"B",NAME)) Q:NAME=""  S NUMBER="",NUMBER=$O(^DD(ZDD,"B",NAME,"")) D PTOLIST Q:FLAGQ
"RTN","%ZVEMDPT",38,0)
 I CNT=1 W !!!!!?20,"This file has no fields that",!?20,"point to other files."
"RTN","%ZVEMDPT",39,0)
 Q
"RTN","%ZVEMDPT",40,0)
PTOLIST ;
"RTN","%ZVEMDPT",41,0)
 Q:^DD(ZDD,"B",NAME,NUMBER)=1  ;If node equals 1 it is TITLE not NAME
"RTN","%ZVEMDPT",42,0)
 S NODE0=^DD(ZDD,NUMBER,0)
"RTN","%ZVEMDPT",43,0)
 Q:$P(NODE0,U,2)'["P"&($P(NODE0,U,2)'["V")
"RTN","%ZVEMDPT",44,0)
 I $P(NODE0,U,2)["P" Q:$P(NODE0,U,3)']""
"RTN","%ZVEMDPT",45,0)
 W !?1,$S(ZDD'=ZNUM:"MULT",1:""),?6,$J(NUMBER,8),?16,NAME
"RTN","%ZVEMDPT",46,0)
 S FILE="^"_$P(NODE0,U,3)_"0)"
"RTN","%ZVEMDPT",47,0)
 W ?48,$S($P(NODE0,U,2)["V":"Variable Pointer",$D(@FILE):$E($P(@FILE,U),1,30),1:"-->No such file")
"RTN","%ZVEMDPT",48,0)
 S CNT=CNT+1 I $Y>VEESIZE D PAGE Q:FLAGQ=1
"RTN","%ZVEMDPT",49,0)
 Q
"RTN","%ZVEMDPT",50,0)
HD ;Pointers to this file
"RTN","%ZVEMDPT",51,0)
 W !?3,"Pointers TO this file..",!?9,"GLOBAL",?22,"FILE  (Truncated to 25)",?50,"FIELD   (Truncated to 22)"
"RTN","%ZVEMDPT",52,0)
 W !?6,"-------------",?21,"-------------------------",?48,"------------------------------"
"RTN","%ZVEMDPT",53,0)
 Q
"RTN","%ZVEMDPT",54,0)
HD1 ;Pointers from this file
"RTN","%ZVEMDPT",55,0)
 W !?3,"Pointers FROM this file..",!?6,"FLD NUM",?26,"FIELD NAME",?52,"FILE (Truncated to 30)"
"RTN","%ZVEMDPT",56,0)
 W !?6,"--------",?16,"------------------------------",?48,"------------------------------"
"RTN","%ZVEMDPT",57,0)
 Q
"RTN","%ZVEMDPT",58,0)
PAGE ;
"RTN","%ZVEMDPT",59,0)
 I FLAGP,$E(VEEIOST,1,2)="P-" W @VEE("IOF"),!!! D @HD Q
"RTN","%ZVEMDPT",60,0)
 D PAUSEQE^%ZVEMKC(2) Q:FLAGQ  W @VEE("IOF") D @HD
"RTN","%ZVEMDPT",61,0)
 Q
"RTN","%ZVEMDT")
0^16^B11008890
"RTN","%ZVEMDT",1,0)
%ZVEMDT ;DJB,VEDD**Trace a Field [3/9/95 6:35pm]
"RTN","%ZVEMDT",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMDT",3,0)
 ;
"RTN","%ZVEMDT",4,0)
EN ;
"RTN","%ZVEMDT",5,0)
 NEW CNT,DATA,FLD,FLD1,FLDCNT,I,LEVEL,MAR,MAR1,Z1,ZDD,ZNAME,ZNUMBER
"RTN","%ZVEMDT",6,0)
 KILL ^TMP("VEE","VEDD",$J,"FLD")
"RTN","%ZVEMDT",7,0)
 I FLAGP D PRINT^%ZVEMDPR ;Turn off printing
"RTN","%ZVEMDT",8,0)
 D GETFLD G:FLAGQ EX D LIST G:FLAGG!(FLAGE) EX
"RTN","%ZVEMDT",9,0)
 D TRACE G:FLAGQ EX D PRINT,ASK
"RTN","%ZVEMDT",10,0)
EX ;
"RTN","%ZVEMDT",11,0)
 KILL ^TMP("VEE","VEDD",$J,"FLD") S FLAGQ=1
"RTN","%ZVEMDT",12,0)
 Q
"RTN","%ZVEMDT",13,0)
GETFLD ;
"RTN","%ZVEMDT",14,0)
 I $G(FLAGPRM)="VEDD",$G(%3)]"" S FLD=%3 Q  ;Parameter passing
"RTN","%ZVEMDT",15,0)
 R !?2,"Enter Field Name: ALL FIELDS//",FLD:VEE("TIME") S:'$T FLD="^^" I FLD["^" S FLAGQ=1 S:FLD="^^" FLAGE=1 Q
"RTN","%ZVEMDT",16,0)
 I FLD="?" D  G GETFLD
"RTN","%ZVEMDT",17,0)
 . W !!?2,"Enter field name or any portion of name. I will display the field's path."
"RTN","%ZVEMDT",18,0)
 . W !?2,"Use this option to see the INDIVIDUAL FIELD DD of a field that is"
"RTN","%ZVEMDT",19,0)
 . W !?2,"decendent from a multiple.",!
"RTN","%ZVEMDT",20,0)
 Q
"RTN","%ZVEMDT",21,0)
LIST ;
"RTN","%ZVEMDT",22,0)
 S ZDD="",FLDCNT=1
"RTN","%ZVEMDT",23,0)
 F  S ZDD=$O(^TMP("VEE","VEDD",$J,"TMP",ZDD)) Q:ZDD=""!(FLAGQ)  S LEVEL=$P(^(ZDD),U,2),ZNAME="" F  S ZNAME=$O(^DD(ZDD,"B",ZNAME)) Q:ZNAME=""  I $E(ZNAME,1,$L(FLD))=FLD D LIST1 Q:FLAGQ
"RTN","%ZVEMDT",24,0)
 I '$D(^TMP("VEE","VEDD",$J,"FLD")) W "   No such field name." S FLAGG=1
"RTN","%ZVEMDT",25,0)
 S FLAGQ=0 Q
"RTN","%ZVEMDT",26,0)
LIST1 ;
"RTN","%ZVEMDT",27,0)
 S ZNUMBER=$O(^DD(ZDD,"B",ZNAME,"")) Q:^DD(ZDD,"B",ZNAME,ZNUMBER)=1
"RTN","%ZVEMDT",28,0)
 D:FLDCNT=1 HD
"RTN","%ZVEMDT",29,0)
 W ! W:$P(^DD(ZDD,ZNUMBER,0),U,2)>0 "Mult->" W ?6,$J(FLDCNT,3),".",?LEVEL*5+6,"  ",ZNAME,"  (",ZNUMBER,")"
"RTN","%ZVEMDT",30,0)
 S ^TMP("VEE","VEDD",$J,"FLD",FLDCNT)=ZNAME_"^"_ZDD_"^"_ZNUMBER_"^"_LEVEL
"RTN","%ZVEMDT",31,0)
 S FLDCNT=FLDCNT+1
"RTN","%ZVEMDT",32,0)
 D:$Y>VEESIZE PAGE Q:FLAGQ
"RTN","%ZVEMDT",33,0)
 Q
"RTN","%ZVEMDT",34,0)
TRACE ;If more than one match do NUM
"RTN","%ZVEMDT",35,0)
 W !
"RTN","%ZVEMDT",36,0)
TRACE1 W !?2,"Select Number: "
"RTN","%ZVEMDT",37,0)
 R FLD1:VEE("TIME") S:'$T FLD1="^^" S:FLD1="" FLD1="^" I FLD1["^" S FLAGQ=1 S:FLD1="^^" FLAGE=1 Q
"RTN","%ZVEMDT",38,0)
 I FLD1'?1.N!(FLD1<1)!(FLD1>(FLDCNT-1)) D  G TRACE1
"RTN","%ZVEMDT",39,0)
 . W $C(7),!?2,"Enter a number from the left hand column."
"RTN","%ZVEMDT",40,0)
 S CNT=1,ZNAME(CNT)=$P(^TMP("VEE","VEDD",$J,"FLD",FLD1),U)
"RTN","%ZVEMDT",41,0)
 S ZNUMBER(CNT)=$P(^(FLD1),U,3),ZDD=$P(^(FLD1),U,2)
"RTN","%ZVEMDT",42,0)
 I $G(FLAGPRM)="VEDD",$G(%3)]"" S %3=ZNAME(CNT) ;Parameter passing
"RTN","%ZVEMDT",43,0)
 Q:ZDD=ZNUM
"RTN","%ZVEMDT",44,0)
 F  S CNT=CNT+1,ZNUMBER(CNT)=$P(^TMP("VEE","VEDD",$J,"TMP",ZDD),U,3),ZDD=^DD(ZDD,0,"UP"),ZNAME(CNT)=$P(^DD(ZDD,ZNUMBER(CNT),0),U) Q:ZDD=ZNUM
"RTN","%ZVEMDT",45,0)
 Q
"RTN","%ZVEMDT",46,0)
PRINT ;Print data.
"RTN","%ZVEMDT",47,0)
 W @VEE("IOF"),!!!,?VEE("IOM")\2-11,"F I E L D    T R A C E",!,$E(VEELINE1,1,VEE("IOM"))
"RTN","%ZVEMDT",48,0)
 S MAR=5,MAR1=15
"RTN","%ZVEMDT",49,0)
 F  W !!?MAR,ZNUMBER(CNT),?MAR1,ZNAME(CNT) S CNT=CNT-1 Q:CNT=0  S MAR=MAR+5,MAR1=MAR1+5
"RTN","%ZVEMDT",50,0)
 Q
"RTN","%ZVEMDT",51,0)
ASK ;
"RTN","%ZVEMDT",52,0)
 I $Y'>VEESIZE F I=$Y:1:VEESIZE W !
"RTN","%ZVEMDT",53,0)
 W !,$E(VEELINE1,1,VEE("IOM"))
"RTN","%ZVEMDT",54,0)
 W ! S Z1=$$CHOICE^%ZVEMKC("MAIN_MENU^INDIV_FLD_DD",1)
"RTN","%ZVEMDT",55,0)
 I Z1=2 D ^%ZVEMDI
"RTN","%ZVEMDT",56,0)
 Q
"RTN","%ZVEMDT",57,0)
PAGE ;
"RTN","%ZVEMDT",58,0)
 D PAUSEQE^%ZVEMKC(2) Q:FLAGQ  D HD
"RTN","%ZVEMDT",59,0)
 Q
"RTN","%ZVEMDT",60,0)
HD ;Trace a field
"RTN","%ZVEMDT",61,0)
 W @VEE("IOF"),!!,"MULTIPLE",?13,"1    2    3    4    5    6    7",!,"LEVELS",?13,"|    |    |    |    |    |    |",!,$E(VEELINE,1,VEE("IOM")),!
"RTN","%ZVEMDT",62,0)
 Q
"RTN","%ZVEMDU")
0^17^B8947117
"RTN","%ZVEMDU",1,0)
%ZVEMDU ;DJB,VEDD**Groups,Required Fields [07/12/94]
"RTN","%ZVEMDU",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMDU",3,0)
 ;
"RTN","%ZVEMDU",4,0)
GRP ;Groups
"RTN","%ZVEMDU",5,0)
 NEW GRP,GRP1,GRP2,HD,X,Z,Z1,ZFLD,ZMULT
"RTN","%ZVEMDU",6,0)
 S ZMULT="",HD="HD1" D GRPBLD G:FLAGG EX D INIT^%ZVEMDPR,HD1,GRPPRT
"RTN","%ZVEMDU",7,0)
 G EX
"RTN","%ZVEMDU",8,0)
GRPBLD ;
"RTN","%ZVEMDU",9,0)
 S Z="",X=1
"RTN","%ZVEMDU",10,0)
 F  S Z=$O(^TMP("VEE","VEDD",$J,"TMP",Z)) Q:Z=""  I $D(^DD(Z,"GR")) D
"RTN","%ZVEMDU",11,0)
 . S GRP="" F  S GRP=$O(^DD(Z,"GR",GRP)) Q:GRP=""  S ZFLD="" F  S ZFLD=$O(^DD(Z,"GR",GRP,ZFLD)) Q:ZFLD=""  S ^TMP("VEE","VEDD",$J,"GRP",GRP,Z,ZFLD)=$P(^DD(Z,ZFLD,0),U),X=X+1 I X#9=0 W "."
"RTN","%ZVEMDU",12,0)
 I '$D(^TMP("VEE","VEDD",$J,"GRP")) W ?30,"No Groups established." S FLAGG=1
"RTN","%ZVEMDU",13,0)
 Q
"RTN","%ZVEMDU",14,0)
GRPPRT ;
"RTN","%ZVEMDU",15,0)
 S GRP="" F I=1:1 S GRP=$O(^TMP("VEE","VEDD",$J,"GRP",GRP)) Q:GRP=""!FLAGQ  W !,$J(I,3),". ",GRP D GRPPRT1
"RTN","%ZVEMDU",16,0)
 Q
"RTN","%ZVEMDU",17,0)
GRPPRT1 ;
"RTN","%ZVEMDU",18,0)
 S GRP1=""
"RTN","%ZVEMDU",19,0)
 F  S GRP1=$O(^TMP("VEE","VEDD",$J,"GRP",GRP,GRP1)) Q:GRP1=""!FLAGQ  S GRP2="" F  S GRP2=$O(^TMP("VEE","VEDD",$J,"GRP",GRP,GRP1,GRP2)) Q:GRP2=""  W ?18,$J(GRP1,6),?27,$J(GRP2,8),?39,^(GRP2),! I $Y>VEESIZE D PAGE Q:FLAGQ
"RTN","%ZVEMDU",20,0)
 Q
"RTN","%ZVEMDU",21,0)
 ;====================================================================
"RTN","%ZVEMDU",22,0)
REQ ;Required Fields
"RTN","%ZVEMDU",23,0)
 NEW FILE,FLD,HD,LEV,PAGE,PIECE,ZDATA
"RTN","%ZVEMDU",24,0)
 S HD="HD" D INIT^%ZVEMDPR,@HD,LOOP
"RTN","%ZVEMDU",25,0)
 G EX
"RTN","%ZVEMDU",26,0)
 ;
"RTN","%ZVEMDU",27,0)
LOOP ;Start For Loop
"RTN","%ZVEMDU",28,0)
 S (LEV,PAGE)=1,FILE(LEV)=ZNUM,FLD(LEV)=0 KILL ^TMP("VEE","VEDD",$J,"REQ")
"RTN","%ZVEMDU",29,0)
 F  S FLD(LEV)=$O(^DD(FILE(LEV),FLD(LEV))) D  Q:'LEV!(FLAGQ)
"RTN","%ZVEMDU",30,0)
 . I +FLD(LEV)=0 S LEV=LEV-1 Q
"RTN","%ZVEMDU",31,0)
 . Q:'$D(^DD(FILE(LEV),FLD(LEV),0))  S ZDATA=^DD(FILE(LEV),FLD(LEV),0)
"RTN","%ZVEMDU",32,0)
 . I $P($P(ZDATA,U,4),";",2)=0 S LEV=LEV+1,FILE(LEV)=+$P(ZDATA,U,2),FLD(LEV)=0 Q
"RTN","%ZVEMDU",33,0)
 . Q:$P(ZDATA,U,2)'["R"
"RTN","%ZVEMDU",34,0)
 . W !?1,$J(FLD(LEV),10),?14,$J(FILE(LEV),8),?25,$P(ZDATA,U)
"RTN","%ZVEMDU",35,0)
 . I $Y>(VEESIZE-1) D PAUSE Q:FLAGQ  W @VEE("IOF") W:$E(VEEIOST,1,2)="P-" !!! D @HD
"RTN","%ZVEMDU",36,0)
 Q
"RTN","%ZVEMDU",37,0)
PAUSE ;
"RTN","%ZVEMDU",38,0)
 Q:$E(VEEIOST,1,2)="P-"  D PAUSEQE^%ZVEMKC(2)
"RTN","%ZVEMDU",39,0)
 Q
"RTN","%ZVEMDU",40,0)
PAUSE1 ;
"RTN","%ZVEMDU",41,0)
 Q:$E(VEEIOST,1,2)="P-"  D PAUSE^%ZVEMKC(2)
"RTN","%ZVEMDU",42,0)
 Q
"RTN","%ZVEMDU",43,0)
 ;====================================================================
"RTN","%ZVEMDU",44,0)
EX ;Exit
"RTN","%ZVEMDU",45,0)
 KILL ^TMP("VEE","VEDD",$J,"GRP"),^TMP("VEE","VEDD",$J,"REQ")
"RTN","%ZVEMDU",46,0)
 Q
"RTN","%ZVEMDU",47,0)
HD ;Required Fields
"RTN","%ZVEMDU",48,0)
 W !?1,"Required Fields..",!?2,"FLD NUM",?17,"DD",?48,"FIELD NAME"
"RTN","%ZVEMDU",49,0)
 W !?1,"----------",?14,"--------",?25,"------------------------------------------------------"
"RTN","%ZVEMDU",50,0)
 Q
"RTN","%ZVEMDU",51,0)
HD1 ;Groups
"RTN","%ZVEMDU",52,0)
 W !?5,"GROUP NAME",?20,"DD",?27,"FLD NUM",?48,"FIELD NAME",!?5,"-----------",?18,"------",?27,"--------",?39,"------------------------------",!
"RTN","%ZVEMDU",53,0)
 Q
"RTN","%ZVEMDU",54,0)
PAGE ;
"RTN","%ZVEMDU",55,0)
 I FLAGP,$E(VEEIOST,1,2)="P-" W @VEE("IOF"),!!! D @HD Q
"RTN","%ZVEMDU",56,0)
 D PAUSEQE^%ZVEMKC(2) Q:FLAGQ  W @VEE("IOF") D @HD
"RTN","%ZVEMDU",57,0)
 Q
"RTN","%ZVEMDU1")
0^18^B9635629
"RTN","%ZVEMDU1",1,0)
%ZVEMDU1 ;DJB,VEDD**Templates,Description [7/19/95 9:08pm]
"RTN","%ZVEMDU1",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMDU1",3,0)
 ;
"RTN","%ZVEMDU1",4,0)
EN ;Templates
"RTN","%ZVEMDU1",5,0)
 I '$D(^DIBT("F"_ZNUM)),'$D(^DIPT("F"_ZNUM)),'$D(^DIE("F"_ZNUM)) D  G EX
"RTN","%ZVEMDU1",6,0)
 . W ?30,"No Templates" S FLAGG=1
"RTN","%ZVEMDU1",7,0)
 NEW A,B,DISYS,DIW,DIWI,DIWTC,DIWX,DIWT,DIWL,DIWF,DIWR,DN,HEAD,I,II,R,VAR,ZX
"RTN","%ZVEMDU1",8,0)
 S Z1="" D INIT^%ZVEMDPR,HD
"RTN","%ZVEMDU1",9,0)
 D DIPT G:FLAGQ EX D DIBT G:FLAGQ EX D DIE
"RTN","%ZVEMDU1",10,0)
EX ;
"RTN","%ZVEMDU1",11,0)
 Q
"RTN","%ZVEMDU1",12,0)
DIPT ;Print Templates
"RTN","%ZVEMDU1",13,0)
 S HEAD="A.)  PRINT TEMPLATES:" W !?2,HEAD,?45,"^DIPT("
"RTN","%ZVEMDU1",14,0)
 S A="",VAR="^DIPT"
"RTN","%ZVEMDU1",15,0)
 F II=1:1 S A=$O(^DIPT("F"_ZNUM,A)) Q:A=""  W !?12,$J(II,4),".  ",A S B=$O(^DIPT("F"_ZNUM,A,"")) W ?51,B W:$D(^DIPT(B,"ROU")) ?60,"Compiled: ",^DIPT(B,"ROU") I $Y>VEESIZE D PAGE Q:FLAGQ!(Z1="S")
"RTN","%ZVEMDU1",16,0)
 I II=1 W ?55,"No print templates..."
"RTN","%ZVEMDU1",17,0)
 Q
"RTN","%ZVEMDU1",18,0)
DIBT ;Sort Templates
"RTN","%ZVEMDU1",19,0)
 S HEAD="B.)  SORT TEMPLATES:" W !!?2,HEAD,?45,"^DIBT("
"RTN","%ZVEMDU1",20,0)
 S A="",VAR="^DIBT"
"RTN","%ZVEMDU1",21,0)
 F II=1:1 S A=$O(^DIBT("F"_ZNUM,A)) Q:A=""  W !?12,$J(II,4),".  ",A W ?51,$O(^DIBT("F"_ZNUM,A,"")) I $Y>VEESIZE D PAGE Q:FLAGQ!(Z1="S")
"RTN","%ZVEMDU1",22,0)
 I II=1 W ?55,"No sort templates..."
"RTN","%ZVEMDU1",23,0)
 Q
"RTN","%ZVEMDU1",24,0)
DIE ;Edit Templates
"RTN","%ZVEMDU1",25,0)
 S HEAD="C.)  INPUT TEMPLATES:" W !!?2,HEAD,?46,"^DIE("
"RTN","%ZVEMDU1",26,0)
 S A="",VAR="^DIE"
"RTN","%ZVEMDU1",27,0)
 F II=1:1 S A=$O(^DIE("F"_ZNUM,A)) Q:A=""  W !?12,$J(II,4),".  ",A S B=$O(^DIE("F"_ZNUM,A,"")) W ?51,B W:$D(^DIE(B,"ROU")) ?60,"Compiled: ",^DIE(B,"ROU") I $Y>VEESIZE D PAGE Q:FLAGQ!(VAR="")
"RTN","%ZVEMDU1",28,0)
 I II=1 W ?55,"No input templates..."
"RTN","%ZVEMDU1",29,0)
 Q
"RTN","%ZVEMDU1",30,0)
PAGE ;Templates
"RTN","%ZVEMDU1",31,0)
 I VAR="^DIE" S ZX=VAR_"(""F"_ZNUM_""","""_A_""")" I $O(@ZX)="" S VAR="" Q
"RTN","%ZVEMDU1",32,0)
 I FLAGP,$E(VEEIOST,1,2)="P-" W @VEE("IOF"),!!! D HD Q
"RTN","%ZVEMDU1",33,0)
 W !! S Z1=$$CHOICE^%ZVEMKC("CONTINUE^SKIP^QUIT^EXIT",1)
"RTN","%ZVEMDU1",34,0)
 I "0,3,4"[Z1 S FLAGQ=1 S:Z1=4 FLAGE=1 Q
"RTN","%ZVEMDU1",35,0)
 S Z1=$S(Z1=2:"S",1:"")
"RTN","%ZVEMDU1",36,0)
 I Z1="S",VAR="^DIE" S FLAGQ=1 Q
"RTN","%ZVEMDU1",37,0)
 S ZX=VAR_"(""F"_ZNUM_""","""_A_""")"
"RTN","%ZVEMDU1",38,0)
 W @VEE("IOF") D HD I Z1="S"!($O(@ZX)="") Q
"RTN","%ZVEMDU1",39,0)
 W !?2,HEAD," continued..." Q
"RTN","%ZVEMDU1",40,0)
PAGE1 ;File Description
"RTN","%ZVEMDU1",41,0)
 I FLAGP,$E(VEEIOST,1,2)="P-" W @VEE("IOF"),!!! D HD1 Q
"RTN","%ZVEMDU1",42,0)
 D PAUSEQE^%ZVEMKC(2) Q:FLAGQ  W @VEE("IOF") D HD1
"RTN","%ZVEMDU1",43,0)
 Q
"RTN","%ZVEMDU1",44,0)
DES ;File Description
"RTN","%ZVEMDU1",45,0)
 I FLAGP D PRINT^%ZVEMDPR ;Shut off printing
"RTN","%ZVEMDU1",46,0)
 I '$D(^DIC(ZNUM,"%D")) W ?30,"No description available." S FLAGG=1 Q
"RTN","%ZVEMDU1",47,0)
 NEW A,DIW,DIWF,DIWL,DIWR,DIWT,DN,Z
"RTN","%ZVEMDU1",48,0)
 W @VEE("IOF") D HD1
"RTN","%ZVEMDU1",49,0)
 KILL ^UTILITY($J,"W")
"RTN","%ZVEMDU1",50,0)
 S A=0 F  S A=$O(^DIC(ZNUM,"%D",A)) Q:A=""  S X=^DIC(ZNUM,"%D",A,0),DIWL=5,DIWR=75,DIWF="W" D ^DIWP I $Y>VEESIZE D PAGE1 Q:FLAGQ
"RTN","%ZVEMDU1",51,0)
 D:'FLAGQ ^DIWW
"RTN","%ZVEMDU1",52,0)
 G EX
"RTN","%ZVEMDU1",53,0)
HD ;Templates
"RTN","%ZVEMDU1",54,0)
 W !?2,"T E M P L A T E S        PRINT  *  SORT  *  INPUT",!,$E(VEELINE,1,VEE("IOM"))
"RTN","%ZVEMDU1",55,0)
 Q
"RTN","%ZVEMDU1",56,0)
HD1 ;File description
"RTN","%ZVEMDU1",57,0)
 W !?2,"File description for ",ZNAM," file.",!,$E(VEELINE1,1,VEE("IOM"))
"RTN","%ZVEMDU1",58,0)
 Q
"RTN","%ZVEMDUM")
0^19^B1441935
"RTN","%ZVEMDUM",1,0)
%ZVEMDUM ;DJB,VEDD**Scroll Messages [9/24/95 3:26pm]
"RTN","%ZVEMDUM",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMDUM",3,0)
 ;
"RTN","%ZVEMDUM",4,0)
MSG(NUM,PAUSE) ;Messages
"RTN","%ZVEMDUM",5,0)
 ;NUM=Subroutine number  PAUSE=Pause screen
"RTN","%ZVEMDUM",6,0)
 Q:$G(NUM)'>0
"RTN","%ZVEMDUM",7,0)
 S DX=0,DY=VEET("S2")+VEET("FT")-2
"RTN","%ZVEMDUM",8,0)
 D CURSOR^%ZVEMKU1(DX,DY,1),@NUM
"RTN","%ZVEMDUM",9,0)
 S DX=0,DY=DY+1 I $G(PAUSE) X VEES("CRSR") D PAUSE^%ZVEMKU(0)
"RTN","%ZVEMDUM",10,0)
 Q
"RTN","%ZVEMDUM",11,0)
1 W $C(7),"You may only branch from pointer fields (marked with ""<-Pntr"")" Q
"RTN","%ZVEMDUM",12,0)
2 W $C(7),"Pointed-to file doesn't exist." Q
"RTN","%ZVEMDUM",13,0)
3 W $C(7),"No files on record." Q
"RTN","%ZVEMDUM",14,0)
4 W $C(7),"Enter REF number from left hand column" Q
"RTN","%ZVEMDUM",15,0)
5 W "Enter field name or part of field name." Q
"RTN","%ZVEMDUM",16,0)
6 W $C(7),"Invalid field name." Q
"RTN","%ZVEMDUM",17,0)
7 W $C(7),"There is no reference to a data global in ^DD." Q
"RTN","%ZVEMDX")
0^20^B10711387
"RTN","%ZVEMDX",1,0)
%ZVEMDX ;DJB,VEDD**List Old-style Xrefs ; 12/9/00 1:36pm
"RTN","%ZVEMDX",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMDX",3,0)
 ;
"RTN","%ZVEMDX",4,0)
 NEW CHK,CNT,CNTINDEX,CNTKEY,DATA,FILE,FLD,GLTEMP,INDENT
"RTN","%ZVEMDX",5,0)
 NEW LEV,LINE,NAM,PAGE,VEES,ZDATA
"RTN","%ZVEMDX",6,0)
TOP ;
"RTN","%ZVEMDX",7,0)
 W "   Please wait.."
"RTN","%ZVEMDX",8,0)
 D INIT
"RTN","%ZVEMDX",9,0)
 D INIT^%ZVEMDPR ;Print heading
"RTN","%ZVEMDX",10,0)
 D KEYS G:FLAGQ EX
"RTN","%ZVEMDX",11,0)
 D NEWSTYLE G:FLAGQ EX
"RTN","%ZVEMDX",12,0)
 D OLDSTYLE
"RTN","%ZVEMDX",13,0)
EX ;
"RTN","%ZVEMDX",14,0)
 KILL ^TMP("VEE","XREF",$J)
"RTN","%ZVEMDX",15,0)
 Q
"RTN","%ZVEMDX",16,0)
 ;
"RTN","%ZVEMDX",17,0)
KEYS ;Display Keys, introduced with FM22.
"RTN","%ZVEMDX",18,0)
 D KEYS^%ZVEMDXK(ZNUM)
"RTN","%ZVEMDX",19,0)
 Q
"RTN","%ZVEMDX",20,0)
 ;
"RTN","%ZVEMDX",21,0)
NEWSTYLE ;Display new-style indexes introduced with FM22.
"RTN","%ZVEMDX",22,0)
 D INDEX^%ZVEMDXK(ZNUM)
"RTN","%ZVEMDX",23,0)
 Q
"RTN","%ZVEMDX",24,0)
 ;
"RTN","%ZVEMDX",25,0)
OLDSTYLE ;Display old-style indexes
"RTN","%ZVEMDX",26,0)
 ;
"RTN","%ZVEMDX",27,0)
 ;Heading
"RTN","%ZVEMDX",28,0)
 I CNTINDEX>1!(CNTKEY>1) W ! D:$Y>VEESIZE PAGE^%ZVEMDXK Q:FLAGQ
"RTN","%ZVEMDX",29,0)
 I FLAGP,$E(VEEIOST,1,2)="P-" D  ;...Printer
"RTN","%ZVEMDX",30,0)
 . W !!,"<<< OLD-STYLE INDEXES >>>",!
"RTN","%ZVEMDX",31,0)
 E  D  ;...CRT
"RTN","%ZVEMDX",32,0)
 . W !,@VEE("RON")," OLD-STYLE INDEXES ",@VEE("ROFF")
"RTN","%ZVEMDX",33,0)
 D:$Y>VEESIZE PAGE^%ZVEMDXK Q:FLAGQ
"RTN","%ZVEMDX",34,0)
 W ! D:$Y>VEESIZE PAGE^%ZVEMDXK Q:FLAGQ
"RTN","%ZVEMDX",35,0)
 ;
"RTN","%ZVEMDX",36,0)
 D LOOP Q:FLAGQ
"RTN","%ZVEMDX",37,0)
 D:CNTINDEX=1 HD ;Use New-style Indexes heading
"RTN","%ZVEMDX",38,0)
 D PRINT
"RTN","%ZVEMDX",39,0)
 Q
"RTN","%ZVEMDX",40,0)
 ;
"RTN","%ZVEMDX",41,0)
LOOP ;Loop thru ^DD
"RTN","%ZVEMDX",42,0)
 S (CNT,LEV,PAGE)=1
"RTN","%ZVEMDX",43,0)
 S FILE(LEV)=ZNUM
"RTN","%ZVEMDX",44,0)
 S FLD(LEV)=0
"RTN","%ZVEMDX",45,0)
 F  S FLD(LEV)=$O(^DD(FILE(LEV),FLD(LEV))) D  Q:'LEV!(FLAGQ)
"RTN","%ZVEMDX",46,0)
 . I +FLD(LEV)=0 S LEV=LEV-1 Q
"RTN","%ZVEMDX",47,0)
 . Q:'$D(^DD(FILE(LEV),FLD(LEV),0))
"RTN","%ZVEMDX",48,0)
 . S ZDATA=^DD(FILE(LEV),FLD(LEV),0)
"RTN","%ZVEMDX",49,0)
 . D:$D(^DD(FILE(LEV),FLD(LEV),1)) XREF
"RTN","%ZVEMDX",50,0)
 . Q:$P($P(ZDATA,U,4),";",2)'=0
"RTN","%ZVEMDX",51,0)
 . S LEV=LEV+1
"RTN","%ZVEMDX",52,0)
 . S FILE(LEV)=+$P(ZDATA,U,2)
"RTN","%ZVEMDX",53,0)
 . S FLD(LEV)=0
"RTN","%ZVEMDX",54,0)
 Q
"RTN","%ZVEMDX",55,0)
 ;
"RTN","%ZVEMDX",56,0)
XREF ;
"RTN","%ZVEMDX",57,0)
 NEW DATA,K,FNAM
"RTN","%ZVEMDX",58,0)
 S K=0
"RTN","%ZVEMDX",59,0)
 F  S K=$O(^DD(FILE(LEV),FLD(LEV),1,K)) Q:'K!FLAGQ  D  ;
"RTN","%ZVEMDX",60,0)
 . S DATA=^(K,0)
"RTN","%ZVEMDX",61,0)
 . S NAM=$P(DATA,U,2)
"RTN","%ZVEMDX",62,0)
 . I NAM']"" S NAM=$E($P(DATA,U,3),1,8) I NAM]"" S NAM="["_NAM_"]"
"RTN","%ZVEMDX",63,0)
 . S:NAM']"" NAM="[Unknown]"
"RTN","%ZVEMDX",64,0)
 . I LEV>1 S NAM=$E(INDENT,1,LEV-1)_NAM
"RTN","%ZVEMDX",65,0)
 . S FNAM=$P(^DD(FILE(LEV),FLD(LEV),0),U,1)
"RTN","%ZVEMDX",66,0)
 . S ^TMP("VEE",$J,NAM,CNT)=FILE(LEV)_U_FLD(LEV)_U_FNAM
"RTN","%ZVEMDX",67,0)
 . S CNT=CNT+1
"RTN","%ZVEMDX",68,0)
 Q
"RTN","%ZVEMDX",69,0)
 ;
"RTN","%ZVEMDX",70,0)
PRINT ;Print Xref's
"RTN","%ZVEMDX",71,0)
 NEW X,Y S X=""
"RTN","%ZVEMDX",72,0)
 F  S X=$O(^TMP("VEE",$J,X)) Q:X=""!FLAGQ  S Y="" F  S Y=$O(^TMP("VEE",$J,X,Y)) Q:Y=""!FLAGQ  D  ;
"RTN","%ZVEMDX",73,0)
 . S DATA=^(Y)
"RTN","%ZVEMDX",74,0)
 . S NAM=$TR(X,"}","-")
"RTN","%ZVEMDX",75,0)
 .
"RTN","%ZVEMDX",76,0)
 . ;Mark Index indicating data
"RTN","%ZVEMDX",77,0)
 . I "-,["'[$E(NAM) D  ;..Ignore multiples, triggers, & bulletins
"RTN","%ZVEMDX",78,0)
 .. S GLTEMP=ZGL_""""_NAM_""""_")"
"RTN","%ZVEMDX",79,0)
 .. S NAM=$S($D(@GLTEMP):"*",1:"")_NAM
"RTN","%ZVEMDX",80,0)
 . I $E(NAM)'="*" S NAM=" "_NAM
"RTN","%ZVEMDX",81,0)
 . ;
"RTN","%ZVEMDX",82,0)
 . W !,NAM,?20,$P(DATA,U,1),?37,$P(DATA,U,3)_" (#"_$P(DATA,U,2)_")"
"RTN","%ZVEMDX",83,0)
 . D:$Y>VEESIZE PAGE
"RTN","%ZVEMDX",84,0)
 Q
"RTN","%ZVEMDX",85,0)
 ;
"RTN","%ZVEMDX",86,0)
HD ;Heading
"RTN","%ZVEMDX",87,0)
 W !?7,"INDEX",?25,"FILE",?52,"FIELD(S)"
"RTN","%ZVEMDX",88,0)
 W !,"------------------",?20,"---------------",?37,"----------------------------------------"
"RTN","%ZVEMDX",89,0)
 Q
"RTN","%ZVEMDX",90,0)
 ;
"RTN","%ZVEMDX",91,0)
PAGE ;
"RTN","%ZVEMDX",92,0)
 I FLAGP,$E(VEEIOST,1,2)="P-" W @VEE("IOF"),!!! D HD Q
"RTN","%ZVEMDX",93,0)
 D PAUSEQE^%ZVEMKC(2) Q:FLAGQ  W @VEE("IOF") D HD
"RTN","%ZVEMDX",94,0)
 Q
"RTN","%ZVEMDX",95,0)
 ;
"RTN","%ZVEMDX",96,0)
INIT ;
"RTN","%ZVEMDX",97,0)
 KILL ^TMP("VEE",$J)
"RTN","%ZVEMDX",98,0)
 S INDENT="}}}}}}}}}}}}}}}}}}}}}}}}}}}"
"RTN","%ZVEMDX",99,0)
 S $P(LINE,".",220)=""
"RTN","%ZVEMDX",100,0)
 S CNTINDEX=1
"RTN","%ZVEMDX",101,0)
 S CNTKEY=1
"RTN","%ZVEMDX",102,0)
 D REVVID^%ZVEMKY2
"RTN","%ZVEMDX",103,0)
 Q
"RTN","%ZVEMDXK")
0^21^B25603477
"RTN","%ZVEMDXK",1,0)
%ZVEMDXK ;DJB,VEDD**List Keys ; 12/9/00 5:01pm
"RTN","%ZVEMDXK",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMDXK",3,0)
 ;
"RTN","%ZVEMDXK",4,0)
KEYS(ZNUM) ;Get all Keys for this file and any subfiles.
"RTN","%ZVEMDXK",5,0)
 ;ZNUM = File number.
"RTN","%ZVEMDXK",6,0)
 ;
"RTN","%ZVEMDXK",7,0)
 D LOOP("K")
"RTN","%ZVEMDXK",8,0)
 Q
"RTN","%ZVEMDXK",9,0)
 ;
"RTN","%ZVEMDXK",10,0)
KEYS1(FILE) ;Keys for a particular file
"RTN","%ZVEMDXK",11,0)
 ;FILE = File number
"RTN","%ZVEMDXK",12,0)
 ;
"RTN","%ZVEMDXK",13,0)
 NEW FLD,FNAM,I,IEN,INAM,INDEX,ND,MULT,NUM,PRIOR
"RTN","%ZVEMDXK",14,0)
 ;
"RTN","%ZVEMDXK",15,0)
 Q:'$G(FILE)
"RTN","%ZVEMDXK",16,0)
 Q:'$D(^DD("KEY","BB",FILE))
"RTN","%ZVEMDXK",17,0)
 ;
"RTN","%ZVEMDXK",18,0)
 ;Get file name
"RTN","%ZVEMDXK",19,0)
 S MULT=0
"RTN","%ZVEMDXK",20,0)
 I '$D(^DD(FILE,0,"UP")) S FNAM=$P($G(^DIC(FILE,0)),"^",1)
"RTN","%ZVEMDXK",21,0)
 E  S MULT=1,FNAM=$P($G(^DD(FILE,0)),"^",1) ;...Subfile
"RTN","%ZVEMDXK",22,0)
 Q:FNAM']""
"RTN","%ZVEMDXK",23,0)
 ;
"RTN","%ZVEMDXK",24,0)
 ;Heading
"RTN","%ZVEMDXK",25,0)
 I CNTKEY=1 D  Q:FLAGQ
"RTN","%ZVEMDXK",26,0)
 . I FLAGP,$E(VEEIOST,1,2)="P-" D  Q  ;...Printer
"RTN","%ZVEMDXK",27,0)
 .. W !!,"<<< KEYS >>>",!
"RTN","%ZVEMDXK",28,0)
 . W !,@VEE("RON")," KEYS ",@VEE("ROFF") ;...CRT
"RTN","%ZVEMDXK",29,0)
 S CNTKEY=CNTKEY+1
"RTN","%ZVEMDXK",30,0)
 W ! D:$Y>VEESIZE PAGE Q:FLAGQ
"RTN","%ZVEMDXK",31,0)
 W !,$S(MULT:"Subfile: #",1:"File: #")_FILE
"RTN","%ZVEMDXK",32,0)
 D:$Y>VEESIZE PAGE Q:FLAGQ
"RTN","%ZVEMDXK",33,0)
 ;
"RTN","%ZVEMDXK",34,0)
 S INAM=""
"RTN","%ZVEMDXK",35,0)
 F  S INAM=$O(^DD("KEY","BB",FILE,INAM)) Q:INAM=""!FLAGQ  D  ;
"RTN","%ZVEMDXK",36,0)
 . S IEN=$O(^DD("KEY","BB",FILE,INAM,0)) Q:'IEN
"RTN","%ZVEMDXK",37,0)
 . S ND=$G(^DD("KEY",IEN,0))
"RTN","%ZVEMDXK",38,0)
 . S PRIOR=$P(ND,"^",3)
"RTN","%ZVEMDXK",39,0)
 . D KEYSHD(IEN,INAM,PRIOR) ;...Index heading
"RTN","%ZVEMDXK",40,0)
 . S NUM=0
"RTN","%ZVEMDXK",41,0)
 . F I=1:1 S NUM=$O(^DD("KEY",IEN,2,"S",NUM)) Q:'NUM!FLAGQ  D  ;
"RTN","%ZVEMDXK",42,0)
 .. S FLD=$O(^DD("KEY",IEN,2,"S",NUM,0)) Q:'FLD
"RTN","%ZVEMDXK",43,0)
 .. W !
"RTN","%ZVEMDXK",44,0)
 .. W:I=1 ?6,"Field(s):"
"RTN","%ZVEMDXK",45,0)
 .. W ?16,NUM_") "
"RTN","%ZVEMDXK",46,0)
 .. W $P($G(^DD(FILE,FLD,0)),"^",1)
"RTN","%ZVEMDXK",47,0)
 .. W " (#"_FLD_")"
"RTN","%ZVEMDXK",48,0)
 .. S CNTKEY=CNTKEY+1
"RTN","%ZVEMDXK",49,0)
 .. D:$Y>VEESIZE PAGE
"RTN","%ZVEMDXK",50,0)
 Q
"RTN","%ZVEMDXK",51,0)
 ;
"RTN","%ZVEMDXK",52,0)
INDEX(ZNUM) ;Get all Indexes for this file and any subfiles.
"RTN","%ZVEMDXK",53,0)
 ;ZNUM = File number.
"RTN","%ZVEMDXK",54,0)
 ;
"RTN","%ZVEMDXK",55,0)
 ;The file number displayed is either:
"RTN","%ZVEMDXK",56,0)
 ;     ROOT FILE field for non-field type xrefs
"RTN","%ZVEMDXK",57,0)
 ;     FILE field in the CROSS-REFERENCE VALUES multiple
"RTN","%ZVEMDXK",58,0)
 ;
"RTN","%ZVEMDXK",59,0)
 D LOOP("I")
"RTN","%ZVEMDXK",60,0)
 Q
"RTN","%ZVEMDXK",61,0)
 ;
"RTN","%ZVEMDXK",62,0)
INDEX1(FILE) ;Get all Indexes for this file and any subfiles.
"RTN","%ZVEMDXK",63,0)
 ;FILE = File number
"RTN","%ZVEMDXK",64,0)
 ;
"RTN","%ZVEMDXK",65,0)
 NEW FLD,FNAM,GL,I,IEN,IEN1,IFILE,INDEX,MARK,ND,NUM
"RTN","%ZVEMDXK",66,0)
 ;
"RTN","%ZVEMDXK",67,0)
 Q:'$G(FILE)
"RTN","%ZVEMDXK",68,0)
 Q:'$D(^DD("IX","BB",FILE))
"RTN","%ZVEMDXK",69,0)
 ;
"RTN","%ZVEMDXK",70,0)
 ;Heading
"RTN","%ZVEMDXK",71,0)
 I CNTKEY>1,CNTINDEX=1 W ! D:$Y>VEESIZE PAGE Q:FLAGQ
"RTN","%ZVEMDXK",72,0)
 ;
"RTN","%ZVEMDXK",73,0)
 I CNTINDEX=1 D  Q:FLAGQ
"RTN","%ZVEMDXK",74,0)
 . I FLAGP,$E(VEEIOST,1,2)="P-" D  ;...Printer
"RTN","%ZVEMDXK",75,0)
 .. W !!,"<<< NEW-STYLE INDEXES >>>",!
"RTN","%ZVEMDXK",76,0)
 . E  D  ;...CRT
"RTN","%ZVEMDXK",77,0)
 .. W !,@VEE("RON")," NEW-STYLE INDEXES ",@VEE("ROFF")
"RTN","%ZVEMDXK",78,0)
 . D:$Y>VEESIZE PAGE Q:FLAGQ
"RTN","%ZVEMDXK",79,0)
 . W ! D:$Y>VEESIZE PAGE Q:FLAGQ
"RTN","%ZVEMDXK",80,0)
 . D HD^%ZVEMDX
"RTN","%ZVEMDXK",81,0)
 ;
"RTN","%ZVEMDXK",82,0)
 S CNTKEY=CNTKEY+1
"RTN","%ZVEMDXK",83,0)
 S CNTINDEX=CNTINDEX+1
"RTN","%ZVEMDXK",84,0)
 ;
"RTN","%ZVEMDXK",85,0)
 S INDEX=""
"RTN","%ZVEMDXK",86,0)
 F  S INDEX=$O(^DD("IX","BB",FILE,INDEX)) Q:INDEX=""!FLAGQ  D  ;
"RTN","%ZVEMDXK",87,0)
 . S IEN=$O(^DD("IX","BB",FILE,INDEX,0)) Q:'IEN
"RTN","%ZVEMDXK",88,0)
 . S ND=$G(^DD("IX",IEN,0))
"RTN","%ZVEMDXK",89,0)
 . ;
"RTN","%ZVEMDXK",90,0)
 . ;Mark Index if it's at top level and it has data.
"RTN","%ZVEMDXK",91,0)
 . S MARK=" "
"RTN","%ZVEMDXK",92,0)
 . I '$D(^DD(FILE,0,"UP")) D  ;
"RTN","%ZVEMDXK",93,0)
 .. S GL=ZGL_""""_INDEX_""""_")"
"RTN","%ZVEMDXK",94,0)
 .. S MARK=$S($D(@GL):"*",1:MARK)
"RTN","%ZVEMDXK",95,0)
 . ;
"RTN","%ZVEMDXK",96,0)
 . W ! D:$Y>VEESIZE PAGE^%ZVEMDX Q:FLAGQ
"RTN","%ZVEMDXK",97,0)
 . W !,MARK_INDEX
"RTN","%ZVEMDXK",98,0)
 . ;
"RTN","%ZVEMDXK",99,0)
 . ;Display a xref that's 'Mumps' rather than 'Regular'.
"RTN","%ZVEMDXK",100,0)
 . I $P(ND,U,4)="MU" D  Q
"RTN","%ZVEMDXK",101,0)
 .. W ?20,$P(ND,U,9) ;...Root file
"RTN","%ZVEMDXK",102,0)
 .. W ?37,"Mumps code..."
"RTN","%ZVEMDXK",103,0)
 .. D:$Y>VEESIZE PAGE^%ZVEMDX Q:FLAGQ
"RTN","%ZVEMDXK",104,0)
 . ;
"RTN","%ZVEMDXK",105,0)
 . I '$D(^DD("IX",IEN,11.1,"AC")) D  Q
"RTN","%ZVEMDXK",106,0)
 .. W ?20,$P(ND,U,9) ;...Root file
"RTN","%ZVEMDXK",107,0)
 . ;
"RTN","%ZVEMDXK",108,0)
 . S NUM=0
"RTN","%ZVEMDXK",109,0)
 . F I=1:1 S NUM=$O(^DD("IX",IEN,11.1,"AC",NUM)) Q:'NUM!FLAGQ  D  ;
"RTN","%ZVEMDXK",110,0)
 .. S IEN1=$O(^DD("IX",IEN,11.1,"AC",NUM,0)) Q:'IEN1
"RTN","%ZVEMDXK",111,0)
 .. S ND=$G(^DD("IX",IEN,11.1,IEN1,0))
"RTN","%ZVEMDXK",112,0)
 .. ;
"RTN","%ZVEMDXK",113,0)
 .. S CNTINDEX=CNTINDEX+1
"RTN","%ZVEMDXK",114,0)
 .. W:I>1 !
"RTN","%ZVEMDXK",115,0)
 .. ;
"RTN","%ZVEMDXK",116,0)
 .. ;Computed field
"RTN","%ZVEMDXK",117,0)
 .. I $P(ND,U,2)="C" D  Q
"RTN","%ZVEMDXK",118,0)
 ... I I=1 W ?20,$P($G(^DD("IX",IEN,0)),U,9) ;...Root file
"RTN","%ZVEMDXK",119,0)
 ... W ?37,"Computed..."
"RTN","%ZVEMDXK",120,0)
 ... D:$Y>VEESIZE PAGE^%ZVEMDX
"RTN","%ZVEMDXK",121,0)
 .. ;
"RTN","%ZVEMDXK",122,0)
 .. S IFILE=$P(ND,U,3)
"RTN","%ZVEMDXK",123,0)
 .. S FLD=$P(ND,U,4)
"RTN","%ZVEMDXK",124,0)
 .. S FNAM=$P($G(^DD(IFILE,FLD,0)),U,1)
"RTN","%ZVEMDXK",125,0)
 .. ;
"RTN","%ZVEMDXK",126,0)
 .. W:I=1 ?20,IFILE ;.........File
"RTN","%ZVEMDXK",127,0)
 .. W ?37,FNAM_" (#"_FLD_")" ;Field
"RTN","%ZVEMDXK",128,0)
 .. ;
"RTN","%ZVEMDXK",129,0)
 .. D:$Y>VEESIZE PAGE^%ZVEMDX  Q:FLAGQ
"RTN","%ZVEMDXK",130,0)
 Q
"RTN","%ZVEMDXK",131,0)
 ;
"RTN","%ZVEMDXK",132,0)
 ;==================================================================
"RTN","%ZVEMDXK",133,0)
 ;
"RTN","%ZVEMDXK",134,0)
LOOP(TYPE) ;Loop thru ^DD to get numbers for file and all subfiles.
"RTN","%ZVEMDXK",135,0)
 ;TYPE: K=Keys, I=Indexes
"RTN","%ZVEMDXK",136,0)
 ;
"RTN","%ZVEMDXK",137,0)
 NEW CNT,DATA,FILE,FLD,KEY,LEV,PAGE
"RTN","%ZVEMDXK",138,0)
 S (CNT,LEV,PAGE)=1
"RTN","%ZVEMDXK",139,0)
 S FILE(LEV)=ZNUM
"RTN","%ZVEMDXK",140,0)
 I TYPE="K" D KEYS1(FILE(LEV)) ;Check for keys
"RTN","%ZVEMDXK",141,0)
 I TYPE="I" D INDEX1(FILE(LEV)) ;Check for indexes
"RTN","%ZVEMDXK",142,0)
 ;
"RTN","%ZVEMDXK",143,0)
 S FLD(LEV)=0
"RTN","%ZVEMDXK",144,0)
 F  S FLD(LEV)=$O(^DD(FILE(LEV),FLD(LEV))) D  Q:'LEV!FLAGQ
"RTN","%ZVEMDXK",145,0)
 . I +FLD(LEV)=0 S LEV=LEV-1 Q
"RTN","%ZVEMDXK",146,0)
 . Q:'$D(^DD(FILE(LEV),FLD(LEV),0))
"RTN","%ZVEMDXK",147,0)
 . S DATA=^DD(FILE(LEV),FLD(LEV),0)
"RTN","%ZVEMDXK",148,0)
 . Q:$P($P(DATA,U,4),";",2)'=0
"RTN","%ZVEMDXK",149,0)
 . S LEV=LEV+1
"RTN","%ZVEMDXK",150,0)
 . S FILE(LEV)=+$P(DATA,U,2)
"RTN","%ZVEMDXK",151,0)
 . S FLD(LEV)=0
"RTN","%ZVEMDXK",152,0)
 . ;
"RTN","%ZVEMDXK",153,0)
 . I TYPE="K" D KEYS1(FILE(LEV)) ;Check for keys
"RTN","%ZVEMDXK",154,0)
 . I TYPE="I" D INDEX1(FILE(LEV)) ;Check for indexes
"RTN","%ZVEMDXK",155,0)
 Q
"RTN","%ZVEMDXK",156,0)
 ;
"RTN","%ZVEMDXK",157,0)
KEYSHD(IEN,INAM,PRIOR) ;Write Index heading
"RTN","%ZVEMDXK",158,0)
 ;INAM...Index name
"RTN","%ZVEMDXK",159,0)
 ;PRIOR..Priority
"RTN","%ZVEMDXK",160,0)
 ;
"RTN","%ZVEMDXK",161,0)
 NEW UINDEX
"RTN","%ZVEMDXK",162,0)
 W ! D:$Y>VEESIZE PAGE Q:FLAGQ
"RTN","%ZVEMDXK",163,0)
 W !?3,$S(PRIOR="P":"PRIMARY",1:"SECONDARY")
"RTN","%ZVEMDXK",164,0)
 W " KEY: "_INAM
"RTN","%ZVEMDXK",165,0)
 S UINDEX=$P($G(^DD("KEY",IEN,0)),"^",4) Q:'UINDEX
"RTN","%ZVEMDXK",166,0)
 S UINDEX=$P($G(^DD("IX",UINDEX,0)),"^",2)
"RTN","%ZVEMDXK",167,0)
 W ?30,"Uniqueness Index: ",UINDEX
"RTN","%ZVEMDXK",168,0)
 D:$Y>VEESIZE PAGE Q:FLAGQ
"RTN","%ZVEMDXK",169,0)
 Q
"RTN","%ZVEMDXK",170,0)
 ;
"RTN","%ZVEMDXK",171,0)
PAGE ;
"RTN","%ZVEMDXK",172,0)
 S (CNTKEY,CNTINDEX)=1
"RTN","%ZVEMDXK",173,0)
 I FLAGP,$E(VEEIOST,1,2)="P-" W @VEE("IOF"),!!! Q
"RTN","%ZVEMDXK",174,0)
 D PAUSEQE^%ZVEMKC(2) Q:FLAGQ
"RTN","%ZVEMDXK",175,0)
 W @VEE("IOF")
"RTN","%ZVEMDXK",176,0)
 Q
"RTN","%ZVEMDY")
0^22^B5182538
"RTN","%ZVEMDY",1,0)
%ZVEMDY ;DJB,VEDD**Init,Partition,Branching,Error ; 9/23/02 1:31pm
"RTN","%ZVEMDY",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMDY",3,0)
 ;
"RTN","%ZVEMDY",4,0)
INIT ;
"RTN","%ZVEMDY",5,0)
 S:'$D(FLAGH) FLAGH=0
"RTN","%ZVEMDY",6,0)
 ;If PRINTING="YES", Print option in Main Menu will be enabled.
"RTN","%ZVEMDY",7,0)
 S PRINTING="NO" I $D(^%ZIS(1)),$D(^%ZIS(2)) S PRINTING="YES"
"RTN","%ZVEMDY",8,0)
 I '$D(VEE("OS")) D OS^%ZVEMKY Q:FLAGQ
"RTN","%ZVEMDY",9,0)
 I '$D(VEE("$ZE")) D ZE^%ZVEMKY1
"RTN","%ZVEMDY",10,0)
 D INIT^%ZVEMKY
"RTN","%ZVEMDY",11,0)
 I $D(VEE("TRMON"))#2=0 D TRMREAD^%ZVEMKY1
"RTN","%ZVEMDY",12,0)
 Q
"RTN","%ZVEMDY",13,0)
VGL1 ;Global Lister called from Main Menu
"RTN","%ZVEMDY",14,0)
 I $G(FLAGVPE)["VRR" D  S FLAGG=1 Q
"RTN","%ZVEMDY",15,0)
 . W $C(7),"   You can't call VGL when VRR is running."
"RTN","%ZVEMDY",16,0)
 I $G(FLAGVPE)["VGL" D  S FLAGG=1 Q
"RTN","%ZVEMDY",17,0)
 . W $C(7),"   You are already running VGL."
"RTN","%ZVEMDY",18,0)
 I '$$EXIST^%ZVEMKU("%ZVEMG") D  S FLAGG=1 Q
"RTN","%ZVEMDY",19,0)
 . W $C(7),"   You don't have the 'Acme Global Lister' Routines."
"RTN","%ZVEMDY",20,0)
 I $G(DUZ(0))'["@",$G(DUZ(0))'["#" D  S FLAGG=1 Q
"RTN","%ZVEMDY",21,0)
 . W $C(7),"   You don't have access. See Help option."
"RTN","%ZVEMDY",22,0)
 D VGLRUN Q
"RTN","%ZVEMDY",23,0)
VGL2 ;Global Lister called from 'Fld Global Location' option
"RTN","%ZVEMDY",24,0)
 I $G(FLAGVPE)["VRR" D  D PAUSE^%ZVEMKC(2) Q
"RTN","%ZVEMDY",25,0)
 . W $C(7),!!?1,"You can't call VGL when VRR is running."
"RTN","%ZVEMDY",26,0)
 I $G(FLAGVPE)["VGL" D  D PAUSE^%ZVEMKC(2) Q
"RTN","%ZVEMDY",27,0)
 . W $C(7),!!?1,"You are already running VGL."
"RTN","%ZVEMDY",28,0)
 I '$$EXIST^%ZVEMKU("%ZVEMG") D  D PAUSE^%ZVEMKC(2) Q
"RTN","%ZVEMDY",29,0)
 . W $C(7),!!?1,"You don't have the 'Acme Global Lister' Routines."
"RTN","%ZVEMDY",30,0)
 I $G(DUZ(0))'["@",$G(DUZ(0))'["#" D  D PAUSE^%ZVEMKC(2) Q
"RTN","%ZVEMDY",31,0)
 . W $C(7),!!?1,"You don't have access. See Help option in Main Menu."
"RTN","%ZVEMDY",32,0)
 D VGLRUN Q
"RTN","%ZVEMDY",33,0)
VGLRUN ;Run the Acme Global Lister
"RTN","%ZVEMDY",34,0)
 I FLAGP D PRINT^%ZVEMDPR ;Shut off printing
"RTN","%ZVEMDY",35,0)
 W !?1,"VGL - VGlobal Lister"
"RTN","%ZVEMDY",36,0)
 D SYMTAB^%ZVEMKST("C","VEDD",1) ;Clear symbol table
"RTN","%ZVEMDY",37,0)
 D ^%ZVEMG
"RTN","%ZVEMDY",38,0)
 D SYMTAB^%ZVEMKST("R","VEDD",1) ;Restore symbol table
"RTN","%ZVEMDY",39,0)
 S FLAGQ=1
"RTN","%ZVEMDY",40,0)
 Q
"RTN","%ZVEMDY",41,0)
ERROR ;Error trap.
"RTN","%ZVEMDY",42,0)
 NEW ZE
"RTN","%ZVEMDY",43,0)
 S @("ZE="_VEE("$ZE"))
"RTN","%ZVEMDY",44,0)
 S FLAGE=1 KILL ^TMP("VEE","VEDD",$J)
"RTN","%ZVEMDY",45,0)
 I ZE["<INRPT>" W !!?1,"....Interrupted.",!! Q
"RTN","%ZVEMDY",46,0)
 D ERRMSG^%ZVEMKU1("VEDD")
"RTN","%ZVEMDY",47,0)
 I $G(FLAGVPE)["VGL"!($G(FLAGVPE)["VRR") D PAUSE^%ZVEMKU(2)
"RTN","%ZVEMDY",48,0)
 Q
"RTN","%ZVEMG")
0^23^B9001932
"RTN","%ZVEMG",1,0)
%ZVEMG ;DJB,VGL**VGlobal Lister ; 9/4/02 12:54pm
"RTN","%ZVEMG",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMG",3,0)
 ;
"RTN","%ZVEMG",4,0)
EN ;Entry point
"RTN","%ZVEMG",5,0)
 I $G(DUZ)'>0 D ID^%ZVEMKU Q:$G(DUZ)=""
"RTN","%ZVEMG",6,0)
 NEW X S X="ERROR^%ZVEMGY",@($$TRAP^%ZVEMKU1) KILL X
"RTN","%ZVEMG",7,0)
START ;
"RTN","%ZVEMG",8,0)
 NEW DX,DY,VEES,VEET ;IMPORT (For scrolling)
"RTN","%ZVEMG",9,0)
 NEW ZGL,CHK,CNTX,CNTY,CODE,COL,DATA,I,II,KEY,NEWSUB,NODE,FLAGSKIP,SKIPHLD,SUBCHK,SUBNAM,SUBNUM,TABHLD,TEMP,TEMP1,TOTAL,TOTAL1,VGLREV,Z1,Z2,ZDSUB,ZREF
"RTN","%ZVEMG",10,0)
 NEW GL,GLNAM,GLSUB,GLVAL,GLVAL1,GLX
"RTN","%ZVEMG",11,0)
 NEW ZDELIM,ZDELIM1,ZDELIM2
"RTN","%ZVEMG",12,0)
 NEW FLAGC,FLAGC1,FLAGE,FLAGOPEN,FLAGPAR,FLAGQ
"RTN","%ZVEMG",13,0)
 ;FLAGVPE="VEDD^VGL^VRR^EDIT"
"RTN","%ZVEMG",14,0)
 I '$D(FLAGVPE) NEW FLAGVPE
"RTN","%ZVEMG",15,0)
 I $G(FLAGVPE)'["VGL" NEW GLS
"RTN","%ZVEMG",16,0)
 I $G(VEEIOF)="" NEW VEEIOST,VEELINE,VEELINE1,VEELINE2,VEESIZE,VEEX,VEEY
"RTN","%ZVEMG",17,0)
 I $D(VEE("OS"))#2=0 NEW VEE
"RTN","%ZVEMG",18,0)
 S VGLREV=0 I $G(REVERSE)="YES" S VGLREV=1 KILL REVERSE
"RTN","%ZVEMG",19,0)
 ;
"RTN","%ZVEMG",20,0)
 S FLAGQ=0 D INIT^%ZVEMGY G:FLAGQ EX D IMPORT
"RTN","%ZVEMG",21,0)
 ;
"RTN","%ZVEMG",22,0)
 S $P(FLAGVPE,"^",2)="VGL" ;Marks that VGL is running.
"RTN","%ZVEMG",23,0)
TOP ;Start of Loop
"RTN","%ZVEMG",24,0)
 ;  VEET("STATUS")="START^FINISH^HEADING^SEARCH^PROT"
"RTN","%ZVEMG",25,0)
 ;  START marks if STARTSCR^%ZVEMKT2 has been called.
"RTN","%ZVEMG",26,0)
 ;  FINISH marks if FINISH^%ZVEMGI has been called.
"RTN","%ZVEMG",27,0)
 ;  HEADING controls whether heading is displayed
"RTN","%ZVEMG",28,0)
 ;  SEARCH marks if code search is currently active
"RTN","%ZVEMG",29,0)
 ;  PROT marks <PROT> error so "No data" is displayed.
"RTN","%ZVEMG",30,0)
 S VEET("STATUS")=$S($G(VEET("STATUS"))["HEADING":"^^HEADING",1:0)
"RTN","%ZVEMG",31,0)
 KILL ^TMP("VEE","IG"_GLS,$J),^TMP("VEE","VGL"_GLS,$J),^TMP("VEE",$J)
"RTN","%ZVEMG",32,0)
 S (CODE,FLAGC,FLAGC1,FLAGE,FLAGOPEN,FLAGQ)=0,ZREF=1
"RTN","%ZVEMG",33,0)
 D GETGL^%ZVEMG1 G:FLAGQ=1 EX G:FLAGQ=2 TOP
"RTN","%ZVEMG",34,0)
 I $G(VEESHL)="RUN" D  ;Cmnd Line History
"RTN","%ZVEMG",35,0)
 . S:$G(FLAGPAR)=1 ZGL=$E(ZGL,1,$L(ZGL)-1)
"RTN","%ZVEMG",36,0)
 . D CLHSET^%ZVEMSCL("VGL",ZGL)
"RTN","%ZVEMG",37,0)
 D ^%ZVEMGR,FINISH^%ZVEMGI
"RTN","%ZVEMG",38,0)
 G TOP
"RTN","%ZVEMG",39,0)
IMPORT ;Set up for scroller
"RTN","%ZVEMG",40,0)
 NEW LINE,MAR
"RTN","%ZVEMG",41,0)
 S MAR=$G(VEE("IOM")) S:'MAR MAR=80
"RTN","%ZVEMG",42,0)
 S $P(LINE,"=",MAR)=""
"RTN","%ZVEMG",43,0)
 S VEET("S2")=(VEE("IOSL")-3)
"RTN","%ZVEMG",44,0)
 S VEET("GET")="D SETARRAY^%ZVEMGI"
"RTN","%ZVEMG",45,0)
 S VEET("HD")=1,VEET("FT")=3
"RTN","%ZVEMG",46,0)
 S VEET("HD",1)=$E(LINE,1,(MAR-12)\2)_"[Session "_GLS_"]"_$E(LINE,1,(MAR-12)\2)
"RTN","%ZVEMG",47,0)
 S VEET("FT",1)=LINE
"RTN","%ZVEMG",48,0)
 S VEET("FT",2)="<>  'n'=Pieces  A=Alt  G=Goto  S'n'=Skip  C=CdSrch  ?=Help  M=More..."
"RTN","%ZVEMG",49,0)
 S VEET("FT",3)=" Select: "
"RTN","%ZVEMG",50,0)
 Q
"RTN","%ZVEMG",51,0)
EX ;
"RTN","%ZVEMG",52,0)
 KILL ^TMP("VEE","IG"_GLS,$J)
"RTN","%ZVEMG",53,0)
 KILL ^TMP("VEE","VGL"_GLS,$J)
"RTN","%ZVEMG",54,0)
 KILL ^TMP("VEE",$J)
"RTN","%ZVEMG",55,0)
 S GLS=GLS-1 ;Make sure this line FOLLOWS previous line
"RTN","%ZVEMG",56,0)
 S ^%ZVEMS("%",$J_$G(^%ZVEMS("SY")),"GLS")=GLS
"RTN","%ZVEMG",57,0)
 I GLS=0 KILL ^%ZVEMS("%",$J_$G(^%ZVEMS("SY")),"GLS")
"RTN","%ZVEMG",58,0)
 Q
"RTN","%ZVEMG",59,0)
 ;====================================================================
"RTN","%ZVEMG",60,0)
R ;Reverse video
"RTN","%ZVEMG",61,0)
 I '$D(^DD)!('$D(^DIC)) D  Q  ;Needs Fileman
"RTN","%ZVEMG",62,0)
 . W $C(7),!?1,"Fileman must be present to use this calling point.",!
"RTN","%ZVEMG",63,0)
 I $G(DUZ)'>0 D ID^%ZVEMKU I $G(DUZ)="" KILL ^TMP("VEE",$J) Q
"RTN","%ZVEMG",64,0)
 NEW REVERSE S REVERSE="YES"
"RTN","%ZVEMG",65,0)
 G EN
"RTN","%ZVEMG",66,0)
PARAM(X) ;Parameter Passing....X=^Global -or- X=File Name
"RTN","%ZVEMG",67,0)
 S ^TMP("VEE",$J)=$G(X)
"RTN","%ZVEMG",68,0)
 I $G(DUZ)'>0 D ID^%ZVEMKU I $G(DUZ)="" KILL ^TMP("VEE",$J) Q
"RTN","%ZVEMG",69,0)
 I ^TMP("VEE",$J)]"" NEW FLAGPRM,%1 S FLAGPRM=1,%1=^($J)
"RTN","%ZVEMG",70,0)
 KILL ^TMP("VEE",$J)
"RTN","%ZVEMG",71,0)
 G EN
"RTN","%ZVEMG1")
0^24^B9010287
"RTN","%ZVEMG1",1,0)
%ZVEMG1 ;DJB,VGL**Get Global ; 9/6/02 10:04am
"RTN","%ZVEMG1",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMG1",3,0)
 ;
"RTN","%ZVEMG1",4,0)
GETGL ;Get Global
"RTN","%ZVEMG1",5,0)
 ; FLAGPRM = Parameter passing. Used by VEDD,VGL,VRR
"RTN","%ZVEMG1",6,0)
 I $G(FLAGPRM)="VGL" S FLAGQ=1 Q
"RTN","%ZVEMG1",7,0)
 I $G(FLAGPRM)=1 S FLAGPRM="VGL",ZGL=%1 D  Q:FLAGQ  G GETGL1
"RTN","%ZVEMG1",8,0)
 . I $E(ZGL)'="^" D GETFILE^%ZVEMGU I ZGL']"" S FLAGQ=1
"RTN","%ZVEMG1",9,0)
 D:GLS=1 HD^%ZVEMGU
"RTN","%ZVEMG1",10,0)
 I $G(VEESHL)="RUN" D  G:ZGL?1"<".E1">" GETGL G GETGL1
"RTN","%ZVEMG1",11,0)
 . S FLAGPAR=0 ;FLAGPAR tells CLH to remove ending ")"
"RTN","%ZVEMG1",12,0)
 . W ! S ZGL=$$CLHEDIT^%ZVEMSCL("VGL","Session "_GLS_"...Global ^")
"RTN","%ZVEMG1",13,0)
 W !!?1,"Session ",GLS,"...Global ^"
"RTN","%ZVEMG1",14,0)
 R ZGL:VEE("TIME") S:'$T ZGL="^"
"RTN","%ZVEMG1",15,0)
GETGL1 ;Come here when passing a parameter
"RTN","%ZVEMG1",16,0)
 I "^"[ZGL S FLAGQ=1 W ! Q
"RTN","%ZVEMG1",17,0)
 I ZGL=" " D GETFILE^%ZVEMGU I ZGL']"" S FLAGQ=2 Q  ;Lookup by File name or number.
"RTN","%ZVEMG1",18,0)
 I ZGL?1.E1"*" S ZGL=$$GLBLIST^%ZVEMGU(ZGL) I ZGL']"" S FLAGQ=2 Q
"RTN","%ZVEMG1",19,0)
 I $E(ZGL)="?" D HELP^%ZVEMKT("VGL1") G GETGL
"RTN","%ZVEMG1",20,0)
 I ZGL="*D" W @VEE("IOF") D @$S(VEE("OS")=9:"^%gd",1:"^%GD") G GETGL
"RTN","%ZVEMG1",21,0)
 I ZGL="*%D" W @VEE("IOF") D @$S(VEE("OS")=9:"^%gd",VEE("OS")=8:"^%GDE",1:"LIB^%GD") G GETGL
"RTN","%ZVEMG1",22,0)
 I ZGL'?1"^".E S ZGL="^"_ZGL
"RTN","%ZVEMG1",23,0)
 I ",%,[,|,"'[(","_$E(ZGL,2)_","),$E(ZGL,2)'?1A D  G GETGL
"RTN","%ZVEMG1",24,0)
 . W !!?1,"Global name must begin with alpha or '%'"
"RTN","%ZVEMG1",25,0)
 I ZGL?.E1."," D  S FLAGC1="NP" ;FLAGC used in PRINT^%ZVEMGI to limit subscript levels to that marked by commas.
"RTN","%ZVEMG1",26,0)
 . F  Q:ZGL'?.E1","  S FLAGC=FLAGC+1,ZGL=$E(ZGL,1,$L(ZGL)-1)
"RTN","%ZVEMG1",27,0)
 I ZGL?.E1.","1")" S ZGL=$E(ZGL,1,$L(ZGL)-1) D  S FLAGC1="P"
"RTN","%ZVEMG1",28,0)
 . F  Q:ZGL'?.E1","  S FLAGC=FLAGC+1,ZGL=$E(ZGL,1,$L(ZGL)-1)
"RTN","%ZVEMG1",29,0)
 I ZGL?.E1"(".E1")" S FLAGOPEN=1 ;FLAGOPEN notes if right ")" was entered.
"RTN","%ZVEMG1",30,0)
 I ZGL?.E1"(" S ZGL=$P(ZGL,"(")
"RTN","%ZVEMG1",31,0)
 I ZGL?.E1"(".E,ZGL'?.E1")" S ZGL=ZGL_")",FLAGPAR=1 ;FLAGPAR tells Command Line History to remove ending ")"
"RTN","%ZVEMG1",32,0)
 S TEMP=$P(ZGL,"(") D  I FLAGQ W !!?1,"Invalid global name." Q
"RTN","%ZVEMG1",33,0)
 . I TEMP["[" D  Q
"RTN","%ZVEMG1",34,0)
 . . ;--------> ^["MGR","ROU"]%ZIS <--------
"RTN","%ZVEMG1",35,0)
 . . I VEE("OS")=9 S:TEMP'?1"^"1"["""1.AN1"""]".E FLAGQ=2
"RTN","%ZVEMG1",36,0)
 . . E  S:TEMP'?1"^"1"["""1.AN1""","""1.AN1"""]".E FLAGQ=2
"RTN","%ZVEMG1",37,0)
 . . I $P(TEMP,"]",2)'?1"%".AN,$P(TEMP,"]",2)'?1A.AN S FLAGQ=2
"RTN","%ZVEMG1",38,0)
 . I TEMP["|" D  Q
"RTN","%ZVEMG1",39,0)
 . . ;--------> ^|"MGR","ROU"|%ZIS <--------
"RTN","%ZVEMG1",40,0)
 . . I VEE("OS")=9 S:TEMP'?1"^"1"|"""1.AN1"""|".E FLAGQ=2
"RTN","%ZVEMG1",41,0)
 . . E  S:TEMP'?1"^"1"|"""1.AN1""","""1.AN1"""|".E FLAGQ=2
"RTN","%ZVEMG1",42,0)
 . . I $P(TEMP,"|",3)'?1"%".AN,$P(TEMP,"|",3)'?1A.AN S FLAGQ=2
"RTN","%ZVEMG1",43,0)
 . I TEMP'?1"^".1"%".AN S FLAGQ=2
"RTN","%ZVEMG1",44,0)
 S NEWSUB=$$ZDELIM^%ZVEMGU(ZGL) ;Replace commas,spaces,colons (if not between quotes) with variable ZDELIM,ZDELIM1, or ZDELIM2
"RTN","%ZVEMG1",45,0)
 I FLAGQ=2 W !!?1,"Invalid subscript" Q
"RTN","%ZVEMG1",46,0)
 I FLAGC S FLAGC=FLAGC+($L(NEWSUB,ZDELIM))
"RTN","%ZVEMG1",47,0)
 I NEWSUB="" S ZGL=$P(ZGL,"(")
"RTN","%ZVEMG1",48,0)
 Q
"RTN","%ZVEMGE")
0^25^B10962303
"RTN","%ZVEMGE",1,0)
%ZVEMGE ;DJB,VGL**Edit Global Node [2/25/99 1:30pm]
"RTN","%ZVEMGE",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMGE",3,0)
 ;
"RTN","%ZVEMGE",4,0)
EDITV ;Edit node's value
"RTN","%ZVEMGE",5,0)
 NEW CD1,FLAGQ,NEW,ND,NODE,OLD,TAB,TEMP,TEMP1,X
"RTN","%ZVEMGE",6,0)
 NEW CD,VEESHC ;^%ZVEMKEA returns CD,VEESHC,VEE
"RTN","%ZVEMGE",7,0)
EDITV1 Q:'$$GETND()
"RTN","%ZVEMGE",8,0)
 I '$D(^TMP("VEE","VGL"_GLS,$J,ND)) D MSG^%ZVEMGUM(1) G EDITV1
"RTN","%ZVEMGE",9,0)
 S NODE=^(ND)
"RTN","%ZVEMGE",10,0)
 S (CD,CD1)=@NODE
"RTN","%ZVEMGE",11,0)
 ;I CD?.E1C.E D MSG^%ZVEMGUM(26) G EDITV1 ;Control characters
"RTN","%ZVEMGE",12,0)
 I VEE("OS")=9 S DX=0,DY=VEET("S2") X VEES("CRSR") W @VEES("BLANK_C_EOS")
"RTN","%ZVEMGE",13,0)
 D CURSOR^%ZVEMKU1(0,15,1)
"RTN","%ZVEMGE",14,0)
 W !,@VEE("RON"),!?32,"EDIT GLOBAL VALUE",?VEE("IOM"),@VEE("ROFF"),!!
"RTN","%ZVEMGE",15,0)
 S TEMP=NODE I $L(NODE)>40 S TEMP="" D  ;
"RTN","%ZVEMGE",16,0)
 . I $L(NODE)<VEE("IOM") W NODE Q
"RTN","%ZVEMGE",17,0)
 . W $E(NODE,1,VEE("IOM")),!?1,$E(NODE,VEE("IOM")+1,999)
"RTN","%ZVEMGE",18,0)
 D EDIT^%ZVEMKE(TEMP_" = ")
"RTN","%ZVEMGE",19,0)
 D:$G(VEESHC)="TOO LONG" PAUSE^%ZVEMKU(1) D KILLCHK^%ZVEMKU(CD)
"RTN","%ZVEMGE",20,0)
 I CD'=CD1 S @NODE=CD D RESET^%ZVEMGE1 ;Adj scroll array
"RTN","%ZVEMGE",21,0)
 Q
"RTN","%ZVEMGE",22,0)
EDITS ;Edit node's subscript
"RTN","%ZVEMGE",23,0)
 ;D NOTEMSG^%ZVEMGE1 Q
"RTN","%ZVEMGE",24,0)
 NEW CD1,FLAGQ,NEW,ND,NODE,OLD,TAB,TEMP,TEMP1
"RTN","%ZVEMGE",25,0)
 NEW CD,VEESHC ;^%ZVEMKEA returns CD,VEESHC,VEE
"RTN","%ZVEMGE",26,0)
EDITS1 Q:'$$GETND()
"RTN","%ZVEMGE",27,0)
 I '$D(^TMP("VEE","VGL"_GLS,$J,ND)) D MSG^%ZVEMGUM(12) G EDITS1
"RTN","%ZVEMGE",28,0)
 S NODE=^(ND)
"RTN","%ZVEMGE",29,0)
 I $D(@NODE)>1 D MSG^%ZVEMGUM(23) G EDITS1 ;Don't delete node with decendents
"RTN","%ZVEMGE",30,0)
 S CD=$P(NODE,"(",2,999),(CD,CD1)=$E(CD,1,$L(CD)-1) ;Set CD=Subscript Only
"RTN","%ZVEMGE",31,0)
 I CD']"" D MSG^%ZVEMGUM(14,1) Q
"RTN","%ZVEMGE",32,0)
 I VEE("OS")=9 S DX=0,DY=VEET("S2") X VEES("CRSR") W @VEES("BLANK_C_EOS")
"RTN","%ZVEMGE",33,0)
 D CURSOR^%ZVEMKU1(0,15,1)
"RTN","%ZVEMGE",34,0)
 W !,@VEE("RON"),!?29,"EDIT GLOBAL SUBSCRIPT",?VEE("IOM"),@VEE("ROFF")
"RTN","%ZVEMGE",35,0)
 W !!?1,NODE D EDIT^%ZVEMKE($J("",$F(NODE,"(")-1))
"RTN","%ZVEMGE",36,0)
 Q:CD=CD1  I CD']"" D KILLND Q
"RTN","%ZVEMGE",37,0)
 I $L(CD)>127 W ! D MSG^%ZVEMGUM(13,1) Q
"RTN","%ZVEMGE",38,0)
 S CD=$P(NODE,"(",1)_"("_CD_")"
"RTN","%ZVEMGE",39,0)
 NEW X S X="ERROR^%ZVEMGE",@($$TRAP^%ZVEMKU1) KILL X
"RTN","%ZVEMGE",40,0)
 I $D(@CD)#2 D MSG^%ZVEMGUM(12,1) Q  ;Don't overwrite existing node
"RTN","%ZVEMGE",41,0)
 NEW X S X="",@($$TRAP^%ZVEMKU1) KILL X
"RTN","%ZVEMGE",42,0)
 S TEMP=@NODE KILL @NODE S @CD=TEMP
"RTN","%ZVEMGE",43,0)
 S ^TMP("VEE","VGL"_GLS,$J,ND)=CD
"RTN","%ZVEMGE",44,0)
 D RESET^%ZVEMGE1 ;Adj scroll array
"RTN","%ZVEMGE",45,0)
 Q
"RTN","%ZVEMGE",46,0)
GETND() ;Get node. 0=No node selected  1=Node selected
"RTN","%ZVEMGE",47,0)
 S ND=$$GETREF^%ZVEMKTR("IG"_GLS) I ND="^" Q 0
"RTN","%ZVEMGE",48,0)
 I ND="***" W $C(7) Q 0
"RTN","%ZVEMGE",49,0)
 Q ND
"RTN","%ZVEMGE",50,0)
EDITR ;Edit a range of nodes
"RTN","%ZVEMGE",51,0)
 ;D NOTEMSG^%ZVEMGE1 Q
"RTN","%ZVEMGE",52,0)
 NEW RNG D MSG^%ZVEMGUM(24)
"RTN","%ZVEMGE",53,0)
 S RNG=$$GETRANG^%ZVEMKTR("VGL"_GLS) Q:RNG="^"  D RANGE^%ZVEMGE1(RNG)
"RTN","%ZVEMGE",54,0)
 Q
"RTN","%ZVEMGE",55,0)
KILLND ;Edit subscript - Kill node
"RTN","%ZVEMGE",56,0)
 NEW ANS
"RTN","%ZVEMGE",57,0)
 W !?2,"Do you want to delete this node? Yes// "
"RTN","%ZVEMGE",58,0)
 R ANS:300 Q:'$T!(ANS="^")  S:ANS="" ANS="YES"
"RTN","%ZVEMGE",59,0)
 S ANS=$$ALLCAPS^%ZVEMKU(ANS)
"RTN","%ZVEMGE",60,0)
 I "NY"'[$E(ANS) W "   Y=Yes  N=No" G KILLND
"RTN","%ZVEMGE",61,0)
 Q:$E(ANS)'="Y"  KILL @NODE D DELETE^%ZVEMGE1
"RTN","%ZVEMGE",62,0)
 Q
"RTN","%ZVEMGE",63,0)
ERROR ;Invalid subscript was entered
"RTN","%ZVEMGE",64,0)
 W $C(7),!!?3,"Invalid subscript." D PAUSE^%ZVEMKU(1)
"RTN","%ZVEMGE",65,0)
 Q
"RTN","%ZVEMGE",66,0)
STRIP ;Strip off control characters
"RTN","%ZVEMGE",67,0)
 NEW ASK,CD,CD1,I,ND,NODE,TMP
"RTN","%ZVEMGE",68,0)
STRIP1 Q:'$$GETND()
"RTN","%ZVEMGE",69,0)
 I '$D(^TMP("VEE","VGL"_GLS,$J,ND)) D MSG^%ZVEMGUM(1) G STRIP1
"RTN","%ZVEMGE",70,0)
 S NODE=^(ND)
"RTN","%ZVEMGE",71,0)
 S CD=@NODE
"RTN","%ZVEMGE",72,0)
 I CD'?.E1C.E D MSG^%ZVEMGUM(25) G STRIP1
"RTN","%ZVEMGE",73,0)
 IF CD'?.E1C.E W "  No control characters found" G STRIP1
"RTN","%ZVEMGE",74,0)
 S CD1=""
"RTN","%ZVEMGE",75,0)
 F I=1:1:$L(CD) S TMP=$E(CD,I) I TMP'?1C S CD1=CD1_TMP
"RTN","%ZVEMGE",76,0)
 Q:CD=CD1  ;No change
"RTN","%ZVEMGE",77,0)
 R "  Strip control characters? Y//",ASK:300 S:'$T ASK="^"
"RTN","%ZVEMGE",78,0)
 I ASK'="",$E(ASK)'="y",$E(ASK)'="Y" G STRIP1
"RTN","%ZVEMGE",79,0)
 S @NODE=CD1
"RTN","%ZVEMGE",80,0)
 D RESET^%ZVEMGE1 ;Adj scroll array
"RTN","%ZVEMGE",81,0)
 Q
"RTN","%ZVEMGE1")
0^26^B11391965
"RTN","%ZVEMGE1",1,0)
%ZVEMGE1 ;DJB,VGL**Edit Global Node - Range [2/25/99 3:22pm]
"RTN","%ZVEMGE1",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMGE1",3,0)
 ;
"RTN","%ZVEMGE1",4,0)
RESET ;Reset scroll array. NUM1,NUM2=Node range.
"RTN","%ZVEMGE1",5,0)
 NEW CHK,GLNAM,I,NUM,NUM1,NUM2,PKGS,PKGV,TEMP
"RTN","%ZVEMGE1",6,0)
 S PKGV="VGL"_GLS,PKGS="IG"_GLS
"RTN","%ZVEMGE1",7,0)
 S GLNAM=^TMP("VEE",PKGV,$J,ND)
"RTN","%ZVEMGE1",8,0)
 D GETRANGE,ARRAY,@$S(NUM=NUM2:"EQUAL",NUM<NUM2:"LESS",1:"MORE")
"RTN","%ZVEMGE1",9,0)
 Q
"RTN","%ZVEMGE1",10,0)
GETRANGE ;Get range of scroll array nodes - NUM1 to NUM2
"RTN","%ZVEMGE1",11,0)
 S NUM1=$$GETSCR^%ZVEMKTR(ND,PKGS)
"RTN","%ZVEMGE1",12,0)
 S NUM2=$O(^TMP("VEE",PKGS,$J,"SCR",NUM1))-1
"RTN","%ZVEMGE1",13,0)
 I NUM2'>0 S CHK=0 F I=NUM1:1 D  Q:CHK  S NUM2=I
"RTN","%ZVEMGE1",14,0)
 . I '$D(^TMP("VEE",PKGS,$J,I)) S CHK=1 Q
"RTN","%ZVEMGE1",15,0)
 . I $G(^TMP("VEE",PKGS,$J,I))=" <> <> <>" S CHK=1
"RTN","%ZVEMGE1",16,0)
 Q
"RTN","%ZVEMGE1",17,0)
ARRAY ;Set up temp array with new value. Return NUM=# of lines
"RTN","%ZVEMGE1",18,0)
 NEW LN,SP,VAL
"RTN","%ZVEMGE1",19,0)
 S @("LN="_GLNAM)
"RTN","%ZVEMGE1",20,0)
 I LN?.E1C.E S LN=$$CC^%ZVEMGI(LN) ;Control characters
"RTN","%ZVEMGE1",21,0)
 S SP=$J(ND,3)_") "_GLNAM
"RTN","%ZVEMGE1",22,0)
 S LN=SP_" = "_LN,SP=$L(SP)
"RTN","%ZVEMGE1",23,0)
 F NUM=NUM1:1 D  Q:LN']""
"RTN","%ZVEMGE1",24,0)
 . S TEMP(NUM)=$E(LN,1,VEE("IOM")-1)
"RTN","%ZVEMGE1",25,0)
 . S LN=$E(LN,VEE("IOM"),9999) Q:LN']""
"RTN","%ZVEMGE1",26,0)
 . I $L(GLNAM)<40 S LN=$J("",SP)_" = "_LN Q
"RTN","%ZVEMGE1",27,0)
 . I NUM=NUM1,($L(GLNAM)+10)>VEE("IOM") S LN="          "_LN Q
"RTN","%ZVEMGE1",28,0)
 . S LN="          = "_LN
"RTN","%ZVEMGE1",29,0)
 Q
"RTN","%ZVEMGE1",30,0)
EQUAL ;Edited node takes same number as array nodes
"RTN","%ZVEMGE1",31,0)
 F I=NUM1:1:NUM2 S ^TMP("VEE",PKGS,$J,I)=TEMP(I)
"RTN","%ZVEMGE1",32,0)
 Q
"RTN","%ZVEMGE1",33,0)
LESS ;Edited node takes fewer than array nodes
"RTN","%ZVEMGE1",34,0)
 F I=NUM1:1:NUM S ^TMP("VEE",PKGS,$J,I)=TEMP(I)
"RTN","%ZVEMGE1",35,0)
 F I=(NUM+1):1:NUM2 S ^TMP("VEE",PKGS,$J,I)=""
"RTN","%ZVEMGE1",36,0)
 Q
"RTN","%ZVEMGE1",37,0)
MORE ;Edited node takes more than array nodes
"RTN","%ZVEMGE1",38,0)
 D EQUAL NEW END,I,NEWLINES,START
"RTN","%ZVEMGE1",39,0)
 S END=0,NEWLINES=NUM-NUM2,START=NUM2+1
"RTN","%ZVEMGE1",40,0)
 F I=START:1 Q:'$D(^TMP("VEE",PKGS,$J,I))  S END=I
"RTN","%ZVEMGE1",41,0)
 F I=END:-1:START D  ;
"RTN","%ZVEMGE1",42,0)
 . S ^TMP("VEE",PKGS,$J,I+NEWLINES)=^TMP("VEE",PKGS,$J,I)
"RTN","%ZVEMGE1",43,0)
 . Q:'$D(^TMP("VEE",PKGS,$J,"SCR",I))  S ^(I+NEWLINES)=^(I)
"RTN","%ZVEMGE1",44,0)
 F I=START:1:NUM S ^TMP("VEE",PKGS,$J,I)=TEMP(I) KILL ^("SCR",I)
"RTN","%ZVEMGE1",45,0)
 Q
"RTN","%ZVEMGE1",46,0)
DELETE ;Node deleted
"RTN","%ZVEMGE1",47,0)
 NEW CHK,I,NUM1,NUM2,PKGS,PKGV
"RTN","%ZVEMGE1",48,0)
 S PKGV="VGL"_GLS,PKGS="IG"_GLS
"RTN","%ZVEMGE1",49,0)
 Q:'$D(^TMP("VEE",PKGV,$J,ND))  D GETRANGE
"RTN","%ZVEMGE1",50,0)
 F I=NUM1:1:NUM2 S ^TMP("VEE",PKGS,$J,I)=""
"RTN","%ZVEMGE1",51,0)
 KILL ^TMP("VEE",PKGV,$J,ND)
"RTN","%ZVEMGE1",52,0)
 Q
"RTN","%ZVEMGE1",53,0)
 ;====================================================================
"RTN","%ZVEMGE1",54,0)
RANGE(RNG) ;Edit a range of subscripts or values
"RTN","%ZVEMGE1",55,0)
 NEW ADJ,CD,FD,I,II,ND,NEW,NODE,OLD,START
"RTN","%ZVEMGE1",56,0)
 Q:$G(RNG)']""
"RTN","%ZVEMGE1",57,0)
 D CURSOR^%ZVEMKU1(0,VEET("S2")+VEET("FT")-2,1)
"RTN","%ZVEMGE1",58,0)
 R "Replace: ",OLD:VEE("TIME") Q:OLD=""
"RTN","%ZVEMGE1",59,0)
 R !,"With: ",NEW:VEE("TIME")
"RTN","%ZVEMGE1",60,0)
 I RNG["^" D  Q
"RTN","%ZVEMGE1",61,0)
 . F ND=$P(RNG,"^",1):1:$P(RNG,"^",2) D RANGE1
"RTN","%ZVEMGE1",62,0)
 I RNG["," D  Q
"RTN","%ZVEMGE1",63,0)
 . F I=1:1:$L(RNG,",") S ND=$P(RNG,",",I) D RANGE1
"RTN","%ZVEMGE1",64,0)
 Q
"RTN","%ZVEMGE1",65,0)
RANGE1 ;Replace OLD with NEW
"RTN","%ZVEMGE1",66,0)
 Q:'$D(^TMP("VEE","VGL"_GLS,$J,ND))  Q:^(ND)']""
"RTN","%ZVEMGE1",67,0)
 S NODE=^(ND),CD=@NODE I CD'[OLD Q
"RTN","%ZVEMGE1",68,0)
 S START=0,ADJ=$L(NEW)-$L(OLD) ;ADJ will adjust START if NEW is different length than OLD
"RTN","%ZVEMGE1",69,0)
 F II=1:1:($L(CD,OLD)-1) S FD=$F(CD,OLD,START),START=FD+ADJ,CD=$E(CD,1,(FD-$L(OLD)-1))_NEW_$E(CD,FD,999)
"RTN","%ZVEMGE1",70,0)
 Q:CD']""  S @NODE=CD
"RTN","%ZVEMGE1",71,0)
 Q
"RTN","%ZVEMGE1",72,0)
NOTEMSG ;Message about editing a subscript and editing a range of nodes.
"RTN","%ZVEMGE1",73,0)
 D ENDSCR^%ZVEMKT2
"RTN","%ZVEMGE1",74,0)
 W $C(7),!!?3,"NOTE: The code for this option has been developed, but I haven't"
"RTN","%ZVEMGE1",75,0)
 W !?3,"used it enough to feel it's been thoroughly tested. If there is a"
"RTN","%ZVEMGE1",76,0)
 W !?3,"demand for this option, I can make it available in a future version."
"RTN","%ZVEMGE1",77,0)
 W !?3,"Contact BOLDUC,DAV@FORUM.VA.GOV if you wish to make your feelings"
"RTN","%ZVEMGE1",78,0)
 W !?3,"known." D PAUSE^%ZVEMKC(2)
"RTN","%ZVEMGE1",79,0)
 Q
"RTN","%ZVEMGI")
0^27^B13539956
"RTN","%ZVEMGI",1,0)
%ZVEMGI ;DJB,VGL**Loop,Print,Import [2/25/99 3:19pm]
"RTN","%ZVEMGI",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMGI",3,0)
 ;
"RTN","%ZVEMGI",4,0)
TOP(ZGR) ;ZGR contains starting point, such as ^VA(200).
"RTN","%ZVEMGI",5,0)
 NEW X S X="ERROR^%ZVEMGI1",@($$TRAP^%ZVEMKU1) KILL X
"RTN","%ZVEMGI",6,0)
 I FLAGOPEN NEW GLB,FLAGSKIP,SKIPHLD,STK D  D:$D(@GLB(STK))#2 PRINT Q
"RTN","%ZVEMGI",7,0)
 . S STK=1,GLB(STK)=ZGR,FLAGSKIP=0 KILL SKIPHLD
"RTN","%ZVEMGI",8,0)
 NEW ZCHK,ZORD,GLB,FLAGSKIP,SKIPHLD,STK
"RTN","%ZVEMGI",9,0)
 S STK=1,GLB(STK)=ZGR,ZORD(STK)="",FLAGSKIP=0 KILL SKIPHLD
"RTN","%ZVEMGI",10,0)
LOOP ;Loop to increment and decrement STK to go up and down the subscript.
"RTN","%ZVEMGI",11,0)
 S ZCHK=$D(@GLB(STK)) D:ZCHK#2 PRINT Q:FLAGQ!FLAGE
"RTN","%ZVEMGI",12,0)
 I ZCHK=0 S STK=STK-1 Q:STK=0
"RTN","%ZVEMGI",13,0)
LOOP1 ;When ZORD(STK) is null come here
"RTN","%ZVEMGI",14,0)
 ;Convert double quotes to single quotes
"RTN","%ZVEMGI",15,0)
 I ZORD(STK)["""""" S ZORD(STK)=$$QUOTES1^%ZVEMKU(ZORD(STK))
"RTN","%ZVEMGI",16,0)
 S ZORD(STK)=$O(@GLB(STK)@(ZORD(STK)))
"RTN","%ZVEMGI",17,0)
 I ZORD(STK)="" S STK=STK-1 Q:STK=0  G LOOP1
"RTN","%ZVEMGI",18,0)
 ;Convert single quotes to double quotes
"RTN","%ZVEMGI",19,0)
 I ZORD(STK)["""" S ZORD(STK)=$$QUOTES2^%ZVEMKU(ZORD(STK))
"RTN","%ZVEMGI",20,0)
 I GLB(STK)?.E1")" S VEEX=$E(GLB(STK),1,$L(GLB(STK))-1)_","""_ZORD(STK)_""")",STK=STK+1,ZORD(STK)="",GLB(STK)=VEEX G LOOP
"RTN","%ZVEMGI",21,0)
 S VEEX=ZGL_"("""_ZORD(STK)_""")",STK=STK+1,GLB(STK)=VEEX,ZORD(STK)=""
"RTN","%ZVEMGI",22,0)
 G LOOP
"RTN","%ZVEMGI",23,0)
 ;==================================================================
"RTN","%ZVEMGI",24,0)
PRINT ;Print a single node
"RTN","%ZVEMGI",25,0)
 ;Next line: restrict levels because user entered commas.
"RTN","%ZVEMGI",26,0)
 I FLAGC S SUBCHK=$$ZDELIM^%ZVEMGU(GLB(STK)) Q:FLAGC1="NP"&($L(SUBCHK,ZDELIM)<FLAGC)  Q:FLAGC1="P"&($L(SUBCHK,ZDELIM)'=FLAGC)
"RTN","%ZVEMGI",27,0)
 I VEET("STATUS")'["START" D IMPORTS^%ZVEMKT("IG"_GLS) S $P(VEET("STATUS"),"^",1)="START"
"RTN","%ZVEMGI",28,0)
 S GLNAM=GLB(STK),GL=$P(GLNAM,"("),GLVAL=@GLB(STK)
"RTN","%ZVEMGI",29,0)
 S GLSUB=$P($E(GLNAM,1,$L(GLNAM)-1),"(",2,99)
"RTN","%ZVEMGI",30,0)
 ;Next strip quotes from numeric subscripts.
"RTN","%ZVEMGI",31,0)
 F I=1:1 S VEEX=$P(GLSUB,",",I) Q:VEEX=""  D
"RTN","%ZVEMGI",32,0)
 . I VEEX?1"""".E1"""",VEEX'["E",VEEX'["e" D
"RTN","%ZVEMGI",33,0)
 . . S VEEX=$E(VEEX,2,$L(VEEX)-1) I +VEEX=VEEX S $P(GLSUB,",",I)=VEEX
"RTN","%ZVEMGI",34,0)
 I GLSUB]"" S GLNAM=GL_"("_GLSUB_")"
"RTN","%ZVEMGI",35,0)
 I CODE'=0 X CODE E  R VEEX#1:0 Q:'$T  D  Q
"RTN","%ZVEMGI",36,0)
 . S CODE=0,$P(VEET("STATUS"),"^",4)="" ;Hit any key to quit
"RTN","%ZVEMGI",37,0)
 S ^TMP("VEE","VGL"_GLS,$J,ZREF)=GLNAM
"RTN","%ZVEMGI",38,0)
 I $G(VGLREV) S GLNAM("REV")=$$GLOBNAME^%ZVEMGI1(GLNAM)
"RTN","%ZVEMGI",39,0)
 S VEET=GLNAM D SETARRAY,LIST
"RTN","%ZVEMGI",40,0)
 S ZREF=ZREF+1
"RTN","%ZVEMGI",41,0)
 Q
"RTN","%ZVEMGI",42,0)
 ;====================[ IMPORT TO SCROLLER ]=========================
"RTN","%ZVEMGI",43,0)
GETVEET ;Set VEET=Display text
"RTN","%ZVEMGI",44,0)
 S VEET=$G(^TMP("VEE","IG"_GLS,$J,VEET("BOT")))
"RTN","%ZVEMGI",45,0)
 Q
"RTN","%ZVEMGI",46,0)
LIST ;Display text
"RTN","%ZVEMGI",47,0)
 Q:'$D(^TMP("VEE","IG"_GLS,$J,VEET("BOT")))  D GETVEET
"RTN","%ZVEMGI",48,0)
 I VEET[$C(127) D REVERSE^%ZVEMGI1(VEET) I 1
"RTN","%ZVEMGI",49,0)
 E  W !,VEET
"RTN","%ZVEMGI",50,0)
 S VEET("BOT")=VEET("BOT")+1
"RTN","%ZVEMGI",51,0)
 S:VEET("GAP") VEET("GAP")=VEET("GAP")-1
"RTN","%ZVEMGI",52,0)
 S VEET("HLN")=VEET("HLN")+1
"RTN","%ZVEMGI",53,0)
 S:VEET("H$Y")<VEET("S2") VEET("H$Y")=VEET("H$Y")+1
"RTN","%ZVEMGI",54,0)
 I VEET=" <> <> <>"!'VEET("GAP") D READ^%ZVEMGM Q:FLAGQ!FLAGE
"RTN","%ZVEMGI",55,0)
 G LIST
"RTN","%ZVEMGI",56,0)
SETARRAY ;Set scroll array - ^TMP("VEE","IG"_GLS,$J
"RTN","%ZVEMGI",57,0)
 NEW LN,NUM,SP,VAL
"RTN","%ZVEMGI",58,0)
 S NUM=VEET("BOT"),VEET=$G(VEET)
"RTN","%ZVEMGI",59,0)
 I VEET']""!(VEET=" <> <> <>") D  Q
"RTN","%ZVEMGI",60,0)
 . S ^TMP("VEE","IG"_GLS,$J,NUM)=" <> <> <>"
"RTN","%ZVEMGI",61,0)
 ;Next line tracks what scroll nodes are associated to what VGL nodes.
"RTN","%ZVEMGI",62,0)
 S ^TMP("VEE","IG"_GLS,$J,"SCR",NUM)=ZREF
"RTN","%ZVEMGI",63,0)
 S @("LN="_VEET)
"RTN","%ZVEMGI",64,0)
 I LN?.E1C.E S LN=$$CC(LN) ;Control characters
"RTN","%ZVEMGI",65,0)
 S SP=$J(ZREF,3)_") "_$S('$G(VGLREV):VEET,1:GLNAM("REV"))
"RTN","%ZVEMGI",66,0)
 S LN=SP_" = "_LN,SP=$L(SP)
"RTN","%ZVEMGI",67,0)
 F NUM=NUM:1 D  Q:LN']""
"RTN","%ZVEMGI",68,0)
 . S VAL=$E(LN,1,VEE("IOM")-1)
"RTN","%ZVEMGI",69,0)
 . S ^TMP("VEE","IG"_GLS,$J,NUM)=VAL
"RTN","%ZVEMGI",70,0)
 . S LN=$E(LN,VEE("IOM"),999) Q:LN']""
"RTN","%ZVEMGI",71,0)
 . I $L(VEET)<40 S LN=$J("",SP)_" = "_LN Q
"RTN","%ZVEMGI",72,0)
 . I NUM=VEET("BOT"),($L(VEET)+10)>VEE("IOM") S LN="          "_LN Q
"RTN","%ZVEMGI",73,0)
 . S LN="          = "_LN
"RTN","%ZVEMGI",74,0)
 Q
"RTN","%ZVEMGI",75,0)
CC(TXT) ;Display control characters
"RTN","%ZVEMGI",76,0)
 ;Example: replace $C(9) with /009.
"RTN","%ZVEMGI",77,0)
 NEW I,TXT1,VAL
"RTN","%ZVEMGI",78,0)
 I $G(TXT)']"" Q ""
"RTN","%ZVEMGI",79,0)
 S TXT1=TXT,TXT=""
"RTN","%ZVEMGI",80,0)
 F I=1:1:$L(TXT1) S VAL=$A($E(TXT1,I)) D  ;
"RTN","%ZVEMGI",81,0)
 . I VAL>31 S TXT=TXT_$C(VAL) Q
"RTN","%ZVEMGI",82,0)
 . S TXT=TXT_"/"_$E("000",1,3-$L(VAL))_VAL
"RTN","%ZVEMGI",83,0)
 Q TXT
"RTN","%ZVEMGI",84,0)
FINISH ;Call here AFTER calling IMPORT
"RTN","%ZVEMGI",85,0)
 Q:$G(VEET("STATUS"))'["START"  S $P(VEET("STATUS"),"^",2)="FINISH"
"RTN","%ZVEMGI",86,0)
 ;Next terminate any Code Search
"RTN","%ZVEMGI",87,0)
 S $P(VEET("STATUS"),"^",4)="" I CODE'=0 W $C(7),$C(7) S CODE=0
"RTN","%ZVEMGI",88,0)
 I $G(FLAGSKIP) W $C(7) S FLAGSKIP=0 KILL SKIPHLD ;Turn off node skip
"RTN","%ZVEMGI",89,0)
 I 'FLAGQ,'FLAGE S VEET=" <> <> <>" D SETARRAY,LIST
"RTN","%ZVEMGI",90,0)
 D ENDSCR^%ZVEMKT2 ;Reset scroll region to full screen
"RTN","%ZVEMGI",91,0)
 Q
"RTN","%ZVEMGI1")
0^28^B7075695
"RTN","%ZVEMGI1",1,0)
%ZVEMGI1 ;DJB,VGL**Reverse Video,Set variables,Error ; 11/14/02 7:10am
"RTN","%ZVEMGI1",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMGI1",3,0)
 ;
"RTN","%ZVEMGI1",4,0)
GLOBNAME(GLOB) ;Write Global name with variable subscripts in reverse video.
"RTN","%ZVEMGI1",5,0)
 I GLOB'?.E1"(".E Q GLOB
"RTN","%ZVEMGI1",6,0)
 NEW FLAGT,FLAGT1,NAME
"RTN","%ZVEMGI1",7,0)
 D SUBSET(GLOB) S NAME=GL_"("
"RTN","%ZVEMGI1",8,0)
 ;Next: FLAGT set to stop printing reverse video after a Xref.
"RTN","%ZVEMGI1",9,0)
 S FLAGT=0 F I=1:1:$L(SUBCHK,ZDELIM) S FLAGT1=0 D
"RTN","%ZVEMGI1",10,0)
 . I SUBNUM="Y",I#2=0 D SET
"RTN","%ZVEMGI1",11,0)
 . I SUBNUM="N",I#2 D SET
"RTN","%ZVEMGI1",12,0)
 . S NAME=NAME_$P(SUBCHK,ZDELIM,I) I FLAGT1 S NAME=NAME_$C(127)
"RTN","%ZVEMGI1",13,0)
 . S NAME=NAME_$S(I=$L(SUBCHK,ZDELIM):")",1:",")
"RTN","%ZVEMGI1",14,0)
 Q NAME
"RTN","%ZVEMGI1",15,0)
SET ;
"RTN","%ZVEMGI1",16,0)
 S:+$P(SUBCHK,ZDELIM,I)=0 FLAGT=1
"RTN","%ZVEMGI1",17,0)
 I 'FLAGT S NAME=NAME_$C(127) S FLAGT1=1
"RTN","%ZVEMGI1",18,0)
 Q
"RTN","%ZVEMGI1",19,0)
SUBSET(GLOB) ;Set up variables GL,GLNAM,GLSUB,SUBCHK,SUBNUM.
"RTN","%ZVEMGI1",20,0)
 ;SUBNUM="Y" if Global root is numeric [Ex ^VA(200 ].
"RTN","%ZVEMGI1",21,0)
 ;SUBNUM="N" if Global root is NOT numeric [Ex ^DPT( ].
"RTN","%ZVEMGI1",22,0)
 NEW PIECE1,TEMP,X,Y
"RTN","%ZVEMGI1",23,0)
 Q:$G(GLOB)=""  S GLNAM=GLOB
"RTN","%ZVEMGI1",24,0)
 S GL=$P(GLNAM,"("),GLSUB=$P($E(GLOB,1,$L(GLOB)-1),"(",2,99)
"RTN","%ZVEMGI1",25,0)
 S SUBCHK=$$ZDELIM^%ZVEMGU(GLOB) ;replace commas with ZDELIM
"RTN","%ZVEMGI1",26,0)
 ;Next determine if file has a numeric root.
"RTN","%ZVEMGI1",27,0)
 S SUBNUM="NOFM" I GL="^DIA" Q
"RTN","%ZVEMGI1",28,0)
 S PIECE1=$P(SUBCHK,ZDELIM,1)
"RTN","%ZVEMGI1",29,0)
 S TEMP=GL_"("_PIECE1_",0)" I $D(@TEMP)#2 D
"RTN","%ZVEMGI1",30,0)
 . S X=$P(@TEMP,U) Q:X']""  I '$D(^DIC("B",X)) D  Q:'$D(^DIC("B",X))
"RTN","%ZVEMGI1",31,0)
 . . ;Allow for subscripts which are longer than 30 characters
"RTN","%ZVEMGI1",32,0)
 . . Q:$L(X)<31
"RTN","%ZVEMGI1",33,0)
 . . F  S X=$E(X,1,$L(X)-1) Q:$L(X)<31!($D(^DIC("B",X)))
"RTN","%ZVEMGI1",34,0)
 . I GL'="^DIC" S SUBNUM="Y" Q
"RTN","%ZVEMGI1",35,0)
 . S Y=$O(^DIC("B",X,0)) I Y'>0 S SUBNUM="DIC" Q  ;Invalid ^DIC node
"RTN","%ZVEMGI1",36,0)
 . I $G(^DIC(Y,0,"GL"))=(GL_"("_PIECE1_",") S SUBNUM="Y" Q
"RTN","%ZVEMGI1",37,0)
 . S SUBNUM="DIC"
"RTN","%ZVEMGI1",38,0)
 . Q
"RTN","%ZVEMGI1",39,0)
 Q:SUBNUM'="NOFM"
"RTN","%ZVEMGI1",40,0)
 S TEMP=GL_"(0)" I $D(@TEMP)#2 D
"RTN","%ZVEMGI1",41,0)
 . S X=$P(@TEMP,U) Q:X']""  I $D(^DIC("B",X)) S SUBNUM="N" Q
"RTN","%ZVEMGI1",42,0)
 . D  S:$D(^DIC("B",X)) SUBNUM="N"
"RTN","%ZVEMGI1",43,0)
 . . Q:$L(X)<31
"RTN","%ZVEMGI1",44,0)
 . . F  S X=$E(X,1,$L(X)-1) Q:$L(X)<31!($D(^DIC("B",X)))
"RTN","%ZVEMGI1",45,0)
 Q
"RTN","%ZVEMGI1",46,0)
REVERSE(TXT) ;Display subscript in reverse video
"RTN","%ZVEMGI1",47,0)
 ;TXT=Text to be displayed
"RTN","%ZVEMGI1",48,0)
 W ! I TXT'[$C(127) W TXT Q
"RTN","%ZVEMGI1",49,0)
 NEW DX,DY,D,L,PC,VEEY
"RTN","%ZVEMGI1",50,0)
 S VEEY=(VEE("IOSL")-1)
"RTN","%ZVEMGI1",51,0)
 S D=$C(127),L=$L(TXT,D)
"RTN","%ZVEMGI1",52,0)
 F PC=1:1:L D  ;
"RTN","%ZVEMGI1",53,0)
 . I (PC#2) W $P(TXT,D,PC) D  Q
"RTN","%ZVEMGI1",54,0)
 . . Q:PC'<L
"RTN","%ZVEMGI1",55,0)
 . . S DX=$X,DY=$S($Y>VEEY:VEEY,1:$Y)
"RTN","%ZVEMGI1",56,0)
 . . W @VEE("RON") X VEES("XY") W " "
"RTN","%ZVEMGI1",57,0)
 . W $P(TXT,D,PC)_" "
"RTN","%ZVEMGI1",58,0)
 . S DX=$X,DY=$S($Y>VEEY:VEEY,1:$Y) W @VEE("ROFF") X VEES("XY") Q
"RTN","%ZVEMGI1",59,0)
 Q
"RTN","%ZVEMGI1",60,0)
 ;====================================================================
"RTN","%ZVEMGI1",61,0)
ERROR ;Error trap.
"RTN","%ZVEMGI1",62,0)
 ;VEET("STATUS") - Don't display "No data" with <PROT> errors.
"RTN","%ZVEMGI1",63,0)
 NEW ZE
"RTN","%ZVEMGI1",64,0)
 S @("ZE="_VEE("$ZE"))
"RTN","%ZVEMGI1",65,0)
 I $G(VEET("STATUS"))["START" D ENDSCR^%ZVEMKT2 I 1
"RTN","%ZVEMGI1",66,0)
 E  S $P(VEET("STATUS"),"^",5)="PROT" ;Suppress 'No Data' display
"RTN","%ZVEMGI1",67,0)
 S FLAGQ=1
"RTN","%ZVEMGI1",68,0)
 I ZE["PROT" D  D PAUSE^%ZVEMKU(1) Q
"RTN","%ZVEMGI1",69,0)
 . W $C(7),!!?1,"Access denied (global protection)"
"RTN","%ZVEMGI1",70,0)
 D ERRMSG^%ZVEMKU1("VGL/I"),PAUSE^%ZVEMKU(1)
"RTN","%ZVEMGI1",71,0)
 Q
"RTN","%ZVEMGM")
0^29^B3844221
"RTN","%ZVEMGM",1,0)
%ZVEMGM ;DJB,VGL**Main Menu [2/23/99 2:24pm]
"RTN","%ZVEMGM",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMGM",3,0)
 ;
"RTN","%ZVEMGM",4,0)
READ ;Get input
"RTN","%ZVEMGM",5,0)
 ;Next: Quit if SKIP NODE
"RTN","%ZVEMGM",6,0)
 I $G(FLAGSKIP),$G(SKIPHLD)]"" D SKIPCHK^%ZVEMGO Q
"RTN","%ZVEMGM",7,0)
 ;Next: Quit if CODE SEARCH
"RTN","%ZVEMGM",8,0)
 I $P(VEET("STATUS"),"^",4)="SEARCH" S VEET("TOP")=VEET("TOP")+1 Q
"RTN","%ZVEMGM",9,0)
 NEW KEY,PKG
"RTN","%ZVEMGM",10,0)
READ1 S PKG="IG"_GLS W @VEES("CON") ;Turn cursor back on
"RTN","%ZVEMGM",11,0)
 S KEY=$$READ^%ZVEMKTM(PKG) Q:KEY="QUIT"
"RTN","%ZVEMGM",12,0)
 I KEY="<TAB>" D  ;
"RTN","%ZVEMGM",13,0)
 . S TABHLD=VEET("HLN")_"^"_VEET("H$Y") ;Keeps highlight at same node
"RTN","%ZVEMGM",14,0)
 . S KEY=VEET("HLN")-1,KEY=$G(^TMP("VEE",PKG,$J,"SCR",KEY))
"RTN","%ZVEMGM",15,0)
 . S:KEY']"" KEY="***"
"RTN","%ZVEMGM",16,0)
 I KEY?1"S"1.N G:$$ENDFILE^%ZVEMKTM() READ1 D  D REDRAW^%ZVEMKT2() Q
"RTN","%ZVEMGM",17,0)
 . S FLAGSKIP=+$E(KEY,2,99) D SKIP^%ZVEMGO
"RTN","%ZVEMGM",18,0)
 I ",?,<ESCH>,A,C,ER,ES,EV,G,M,SA,SC,UN,VEDD,"'[(","_KEY_","),KEY'?1.N W $C(7) G READ1
"RTN","%ZVEMGM",19,0)
 D RUN(KEY) Q:FLAGE  H 1 D REDRAW^%ZVEMKT2()
"RTN","%ZVEMGM",20,0)
 D:CODE'=0 CDSRCH^%ZVEMGO
"RTN","%ZVEMGM",21,0)
 Q
"RTN","%ZVEMGM",22,0)
RUN(Z1) ;Z1=Opt selected
"RTN","%ZVEMGM",23,0)
 NEW X S X="ERROR^%ZVEMGM",@($$TRAP^%ZVEMKU1) KILL X
"RTN","%ZVEMGM",24,0)
 NEW FLAGQ S FLAGQ=0
"RTN","%ZVEMGM",25,0)
 I Z1?1.N D PIECE^%ZVEMGM1 Q
"RTN","%ZVEMGM",26,0)
 I ",A,C,ES,EV,SC,"[(","_Z1_",") I '$$CHECK^%ZVEMGM1() Q
"RTN","%ZVEMGM",27,0)
 I Z1="ER" D EDITR^%ZVEMGE Q
"RTN","%ZVEMGM",28,0)
 I Z1="ES" D EDITS^%ZVEMGE Q
"RTN","%ZVEMGM",29,0)
 I Z1="EV" D EDITV^%ZVEMGE Q
"RTN","%ZVEMGM",30,0)
 I Z1="G" D GOTO^%ZVEMGMC Q
"RTN","%ZVEMGM",31,0)
 I Z1="SA" D SAVE^%ZVEMGS Q
"RTN","%ZVEMGM",32,0)
 I Z1="SC" D STRIP^%ZVEMGE Q
"RTN","%ZVEMGM",33,0)
 I Z1="UN" D UNSAVE^%ZVEMGS Q
"RTN","%ZVEMGM",34,0)
 I Z1="<ESCH>" D HELP^%ZVEMKT2 Q
"RTN","%ZVEMGM",35,0)
 D ENDSCR^%ZVEMKT2
"RTN","%ZVEMGM",36,0)
 I Z1["?" D HELP^%ZVEMKT("VGL2") Q
"RTN","%ZVEMGM",37,0)
 ;I Z1="A" NEW FLAGPRM D START^%ZVEMG Q
"RTN","%ZVEMGM",38,0)
 I Z1="A" D ALT^%ZVEMGM1 Q
"RTN","%ZVEMGM",39,0)
 I Z1="C" D CODE^%ZVEMGO Q
"RTN","%ZVEMGM",40,0)
 I Z1="M" D MORE^%ZVEMGM1 Q
"RTN","%ZVEMGM",41,0)
 I Z1="VEDD" D VEDD^%ZVEMGY Q
"RTN","%ZVEMGM",42,0)
 Q
"RTN","%ZVEMGM",43,0)
ERROR ;
"RTN","%ZVEMGM",44,0)
 D ENDSCR^%ZVEMKT2,ERRMSG^%ZVEMKU1("VGL/RUN"),PAUSE^%ZVEMKU(1)
"RTN","%ZVEMGM",45,0)
 Q
"RTN","%ZVEMGM1")
0^30^B6805273
"RTN","%ZVEMGM1",1,0)
%ZVEMGM1 ;DJB,VGL**Main Menu cont. [2/24/99 8:06am]
"RTN","%ZVEMGM1",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMGM1",3,0)
 ;
"RTN","%ZVEMGM1",4,0)
PIECE ;List pieces
"RTN","%ZVEMGM1",5,0)
 NEW FLAG,FLAGXREF S FLAG=0
"RTN","%ZVEMGM1",6,0)
 I '$D(^TMP("VEE","VGL"_GLS,$J,Z1)) D MSG^%ZVEMGUM(1,1) Q
"RTN","%ZVEMGM1",7,0)
 I ^TMP("VEE","VGL"_GLS,$J,Z1)']"" D MSG^%ZVEMGUM(1,1) Q  ;Node was deleted with ES (edit subscript).
"RTN","%ZVEMGM1",8,0)
 Q:'$$CHECKFM^%ZVEMGMC()
"RTN","%ZVEMGM1",9,0)
 S VEEX=^TMP("VEE","VGL"_GLS,$J,Z1)
"RTN","%ZVEMGM1",10,0)
 I VEEX'?.E1"(".E D MSG^%ZVEMGUM(2,1) Q
"RTN","%ZVEMGM1",11,0)
 D SUBSET^%ZVEMGI1(VEEX) I SUBNUM="NOFM" D MSG^%ZVEMGUM(3,1) Q
"RTN","%ZVEMGM1",12,0)
 D CHKNODE^%ZVEMGMC Q:FLAGQ  D ENDSCR^%ZVEMKT2
"RTN","%ZVEMGM1",13,0)
 D @$S(FLAG="ZERO":"ZERO^%ZVEMGPS",FLAG="WP":"WP^%ZVEMGPS",FLAG="XREF":"XREF^%ZVEMGPS",1:"^%ZVEMGP")
"RTN","%ZVEMGM1",14,0)
 Q
"RTN","%ZVEMGM1",15,0)
ALT ;Alternate Session
"RTN","%ZVEMGM1",16,0)
 D SYMTAB^%ZVEMKST("C","VGL",GLS) ;Clear symbol table
"RTN","%ZVEMGM1",17,0)
 D START^%ZVEMG
"RTN","%ZVEMGM1",18,0)
 D SYMTAB^%ZVEMKST("R","VGL",GLS) ;Restore symbol table
"RTN","%ZVEMGM1",19,0)
 Q
"RTN","%ZVEMGM1",20,0)
MORE ;
"RTN","%ZVEMGM1",21,0)
 W !?2,"VEDD ......: Victory Electonic Data Dictionary"
"RTN","%ZVEMGM1",22,0)
 W !?2,"ER ........: EDITOR - Edit range of nodes"
"RTN","%ZVEMGM1",23,0)
 W !?2,"ES ........: EDITOR - Edit node's subscript"
"RTN","%ZVEMGM1",24,0)
 W !?2,"EV ........: EDITOR - Edit node's value"
"RTN","%ZVEMGM1",25,0)
 W !?2,"SA ........: SAve code so it can be UNsaved into a routine"
"RTN","%ZVEMGM1",26,0)
 W !?2,"SC ........: Strip control characters from a node. Control"
"RTN","%ZVEMGM1",27,0)
 W !?2,"             characters will appear as 'c' in reverse video."
"RTN","%ZVEMGM1",28,0)
 W !?2,"UN ........: UNsave code that's been previously SAved"
"RTN","%ZVEMGM1",29,0)
 W !?2,"<ESC>H ....: Scroll Help"
"RTN","%ZVEMGM1",30,0)
 W !!?2,"Call VGL at R^%ZVEMG to display subscript ""constants"" in reverse video."
"RTN","%ZVEMGM1",31,0)
 D PAUSE^%ZVEMKC(2)
"RTN","%ZVEMGM1",32,0)
 Q
"RTN","%ZVEMGM1",33,0)
CHECK() ;0=Quit 1=Ok   Check: A,C,ES,EV
"RTN","%ZVEMGM1",34,0)
 I ",C,ES,EV,"[(","_Z1_","),$G(DUZ(0))'["@" D MSG^%ZVEMGUM(4,1) Q 0
"RTN","%ZVEMGM1",35,0)
 I ",C,ES,EV,"[(","_Z1_","),$G(VGLREV) D MSG^%ZVEMGUM(5,1) Q 0
"RTN","%ZVEMGM1",36,0)
 I ",ES,EV,"[(","_Z1_","),$G(FLAGVPE)["VRR"!($G(FLAGVPE)["VEDD") D MSG^%ZVEMGUM(6,1) Q 0
"RTN","%ZVEMGM1",37,0)
 I ",ES,EV,"[(","_Z1_","),GLS>1 D MSG^%ZVEMGUM(7,1) Q 0
"RTN","%ZVEMGM1",38,0)
 I Z1="C",VEET("STATUS")["SEARCH" D MSG^%ZVEMGUM(8,1) Q 0
"RTN","%ZVEMGM1",39,0)
 I Z1="C",'$D(^TMP("VEE","VGL"_GLS,$J)) D MSG^%ZVEMGUM(9,1) Q 0
"RTN","%ZVEMGM1",40,0)
 I Z1="A",GLS>1 D MSG^%ZVEMGUM(10,1) Q 0
"RTN","%ZVEMGM1",41,0)
 I Z1="A",$G(FLAGVPE)["VRR"!($G(FLAGVPE)["VEDD") D MSG^%ZVEMGUM(11,1) Q 0
"RTN","%ZVEMGM1",42,0)
 Q 1
"RTN","%ZVEMGMC")
0^31^B7051341
"RTN","%ZVEMGMC",1,0)
%ZVEMGMC ;DJB,VGL**Check FM, Check Node [6/14/95 10:39pm]
"RTN","%ZVEMGMC",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMGMC",3,0)
 ;
"RTN","%ZVEMGMC",4,0)
GOTO ;Goto line number
"RTN","%ZVEMGMC",5,0)
 NEW ND,X
"RTN","%ZVEMGMC",6,0)
 S ND=$$GETREF^%ZVEMKTR("IG"_GLS) Q:ND="^"
"RTN","%ZVEMGMC",7,0)
 I ND="***" W $C(7) Q
"RTN","%ZVEMGMC",8,0)
 I '$D(^TMP("VEE","VGL"_GLS,$J,ND)) D  Q:ND'>0
"RTN","%ZVEMGMC",9,0)
 . S ND=$O(^TMP("VEE","VGL"_GLS,$J,ND)) Q:ND>0
"RTN","%ZVEMGMC",10,0)
 . S ND=$O(^TMP("VEE","VGL"_GLS,$J,ND),-1)
"RTN","%ZVEMGMC",11,0)
 S VEET("TOP")=$$GETSCR^%ZVEMKTR(ND,"IG"_GLS)
"RTN","%ZVEMGMC",12,0)
 S VEET("HLN")=VEET("TOP")+1
"RTN","%ZVEMGMC",13,0)
 Q
"RTN","%ZVEMGMC",14,0)
CHECKFM() ;;0=Fileman not present  1=Fileman
"RTN","%ZVEMGMC",15,0)
 I $D(^DD),$D(^DIC) Q 1
"RTN","%ZVEMGMC",16,0)
 D MSG^%ZVEMGUM(18,1)
"RTN","%ZVEMGMC",17,0)
 Q 0
"RTN","%ZVEMGMC",18,0)
CHKNODE ;Do not display Xref or Zero nodes
"RTN","%ZVEMGMC",19,0)
 I SUBNUM="Y" D  Q:FLAGQ
"RTN","%ZVEMGMC",20,0)
 . I $P(SUBCHK,ZDELIM,2)=0,$L(SUBCHK,ZDELIM)>2 D MSG^%ZVEMGUM(2,1) S FLAGQ=1  Q
"RTN","%ZVEMGMC",21,0)
 . F I=2:2:$L(SUBCHK,ZDELIM) I +$P(SUBCHK,ZDELIM,I)'=$P(SUBCHK,ZDELIM,I) D  Q
"RTN","%ZVEMGMC",22,0)
 . . I $P(SUBCHK,ZDELIM,I)["%" D MSG^%ZVEMGUM(15,1) S FLAGQ=1 Q
"RTN","%ZVEMGMC",23,0)
 . . S FLAG="XREF",FLAGXREF=I ;Marks a Xref node
"RTN","%ZVEMGMC",24,0)
 I SUBNUM="Y",FLAG'="XREF",$L(SUBCHK,ZDELIM)#2=0 S FLAG="ZERO"
"RTN","%ZVEMGMC",25,0)
 I SUBNUM="N" D  Q:FLAGQ
"RTN","%ZVEMGMC",26,0)
 . I $P(SUBCHK,ZDELIM)=0,$L(SUBCHK,ZDELIM)>1 D MSG^%ZVEMGUM(2,1) S FLAGQ=1 Q
"RTN","%ZVEMGMC",27,0)
 . F I=1:2:$L(SUBCHK,ZDELIM) I +$P(SUBCHK,ZDELIM,I)'=$P(SUBCHK,ZDELIM,I) D  Q
"RTN","%ZVEMGMC",28,0)
 . . I $P(SUBCHK,ZDELIM,I)["%" D MSG^%ZVEMGUM(15,1) S FLAGQ=1 Q
"RTN","%ZVEMGMC",29,0)
 . . S FLAG="XREF",FLAGXREF=I ;Marks a Xref node
"RTN","%ZVEMGMC",30,0)
 I SUBNUM="N",FLAG'="XREF",$L(SUBCHK,ZDELIM)#2 S FLAG="ZERO"
"RTN","%ZVEMGMC",31,0)
 I SUBNUM="DIC" D MSG^%ZVEMGUM(16,1) S FLAGQ=1 Q
"RTN","%ZVEMGMC",32,0)
 Q:FLAG="XREF"!(FLAG="ZERO")
"RTN","%ZVEMGMC",33,0)
 ;Verify zero node and check for Word Processing field.
"RTN","%ZVEMGMC",34,0)
 S TEMP="" I $L(SUBCHK,ZDELIM)>2 F I=1:1:$L(SUBCHK,ZDELIM)-2 S TEMP=TEMP_$P(SUBCHK,ZDELIM,I)_","
"RTN","%ZVEMGMC",35,0)
 S TEMP=GL_"("_TEMP_"0)" I '$D(@TEMP)#2 D MSG^%ZVEMGUM(17,1) S FLAGQ=1 Q
"RTN","%ZVEMGMC",36,0)
 S TEMP1=$P(@TEMP,U,2),VEEX="" F I=1:1:$L(TEMP1) I $E(TEMP1,I)?1N!($E(TEMP1,I)?1".") S VEEX=VEEX_$E(TEMP1,I) ;Strip off alpha
"RTN","%ZVEMGMC",37,0)
 I VEEX!($L(SUBCHK,ZDELIM)<4) Q
"RTN","%ZVEMGMC",38,0)
 S TEMP="" F I=1:1:($L(SUBCHK,ZDELIM)-4) S TEMP=TEMP_$P(SUBCHK,ZDELIM,I)_","
"RTN","%ZVEMGMC",39,0)
 S TEMP=GL_"("_TEMP_"0)" I '$D(@TEMP)#2 D MSG^%ZVEMGUM(17,1) S FLAGQ=1 Q
"RTN","%ZVEMGMC",40,0)
 S VEEX=$P(@TEMP,U,2),VEEY="" F I=1:1:$L(VEEX) I $E(VEEX,I)?1N!($E(VEEX,I)?1".") S VEEY=VEEY_$E(VEEX,I) ;Strip off alpha
"RTN","%ZVEMGMC",41,0)
 I VEEX']""!(VEEY']"") D MSG^%ZVEMGUM(17,1) S FLAGQ=1 Q
"RTN","%ZVEMGMC",42,0)
 S FLAG="WP"
"RTN","%ZVEMGMC",43,0)
 Q
"RTN","%ZVEMGO")
0^32^B9914414
"RTN","%ZVEMGO",1,0)
%ZVEMGO ;DJB,VGL**CODE SEARCH,SKIP [11/10/94]
"RTN","%ZVEMGO",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMGO",3,0)
 ;
"RTN","%ZVEMGO",4,0)
SKIP ;Skipping over nodes. Also, see first line of PRINT^%ZVEMGI.
"RTN","%ZVEMGO",5,0)
 Q:'$G(FLAGSKIP)  NEW SUBCHK D GETSUB Q:$G(SUBCHK)']""
"RTN","%ZVEMGO",6,0)
 S FLAGSKIP=$S(FLAGSKIP<1:0,FLAGSKIP>$L(SUBCHK,ZDELIM):0,1:FLAGSKIP)
"RTN","%ZVEMGO",7,0)
 Q:'FLAGSKIP  S SKIPHLD=$P(SUBCHK,ZDELIM,FLAGSKIP)
"RTN","%ZVEMGO",8,0)
 Q
"RTN","%ZVEMGO",9,0)
GETSUB ;Get SUBCHK
"RTN","%ZVEMGO",10,0)
 NEW ND,NUM S NUM=VEET("BOT")-1
"RTN","%ZVEMGO",11,0)
 F NUM=NUM:-1:0 S ND=$G(^TMP("VEE","IG"_GLS,$J,"SCR",NUM)) Q:ND>0
"RTN","%ZVEMGO",12,0)
 Q:ND'>0  S ND=^TMP("VEE","VGL"_GLS,$J,ND),SUBCHK=$$ZDELIM^%ZVEMGU(ND)
"RTN","%ZVEMGO",13,0)
 Q
"RTN","%ZVEMGO",14,0)
SKIPCHK ;See if node should be skipped
"RTN","%ZVEMGO",15,0)
 NEW ND,NUM S NUM=VEET("BOT")-1
"RTN","%ZVEMGO",16,0)
 I '$D(^TMP("VEE","IG"_GLS,$J,"SCR",NUM)) D  Q
"RTN","%ZVEMGO",17,0)
 . S VEET("TOP")=VEET("TOP")+1
"RTN","%ZVEMGO",18,0)
 S ND=^(NUM),ND=^TMP("VEE","VGL"_GLS,$J,ND)
"RTN","%ZVEMGO",19,0)
 S SUBCHK=$$ZDELIM^%ZVEMGU(ND)
"RTN","%ZVEMGO",20,0)
 I $P(SUBCHK,ZDELIM,FLAGSKIP)=SKIPHLD D  Q
"RTN","%ZVEMGO",21,0)
 . S VEET("TOP")=VEET("TOP")+1
"RTN","%ZVEMGO",22,0)
 S FLAGSKIP=0 KILL SKIPHLD
"RTN","%ZVEMGO",23,0)
 S VEET("TOP")=VEET("BOT")-1 D REDRAW^%ZVEMKT2()
"RTN","%ZVEMGO",24,0)
 Q
"RTN","%ZVEMGO",25,0)
 ;====================================================================
"RTN","%ZVEMGO",26,0)
CODE ;Get CODE for doing a Code Search.
"RTN","%ZVEMGO",27,0)
 W !!?2,"The following variables are available:"
"RTN","%ZVEMGO",28,0)
 W !!?5,"GLNAM = ""^DIC(4,1,0)"""
"RTN","%ZVEMGO",29,0)
 W !?5,"   GL = ""^DIC"""
"RTN","%ZVEMGO",30,0)
 W !?5,"GLSUB = ""4,1,0"""
"RTN","%ZVEMGO",31,0)
 W !?5,"GLVAL = The data in node ^DIC(4,1,0)"
"RTN","%ZVEMGO",32,0)
 W !?5,"    U = ""^""",!
"RTN","%ZVEMGO",33,0)
CODE1 R !?1,"Enter Mumps Code: ",CODE:VEE("TIME") S:'$T CODE=0
"RTN","%ZVEMGO",34,0)
 I "^"[CODE S CODE=0 Q:CODE=0
"RTN","%ZVEMGO",35,0)
 I $E(CODE)="?" D  G CODE1
"RTN","%ZVEMGO",36,0)
 . W "   If code evaluates to TRUE, node will be displayed."
"RTN","%ZVEMGO",37,0)
 NEW X S X="ERROR1^%ZVEMGY",@($$TRAP^%ZVEMKU1) KILL X X CODE
"RTN","%ZVEMGO",38,0)
 Q
"RTN","%ZVEMGO",39,0)
CDSRCH ;CODE search. Quit if search is currently active
"RTN","%ZVEMGO",40,0)
 NEW GLNAM,GLSUB,GLVAL,I,ZREF
"RTN","%ZVEMGO",41,0)
 Q:VEET("STATUS")["SEARCH"  S $P(VEET("STATUS"),"^",4)="SEARCH"
"RTN","%ZVEMGO",42,0)
 KILL ^TMP("VEE",$J),^TMP("VEE","IG"_GLS,$J)
"RTN","%ZVEMGO",43,0)
 S ^TMP("VEE","IG"_GLS,$J,1)=" CODE SEARCH IN PROGRESS.."
"RTN","%ZVEMGO",44,0)
 S ^TMP("VEE","IG"_GLS,$J,2)=" Hit any key to abort. BEEP indicates search is finished."
"RTN","%ZVEMGO",45,0)
 S ^TMP("VEE","IG"_GLS,$J,3)="~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"
"RTN","%ZVEMGO",46,0)
 S ZREF=0,VEET("BOT")=4,VEET("TOP")=1
"RTN","%ZVEMGO",47,0)
 F  S ZREF=$O(^TMP("VEE","VGL"_GLS,$J,ZREF)) Q:ZREF'>0  D  Q:CODE=0
"RTN","%ZVEMGO",48,0)
 . S GLNAM=^(ZREF),GL=$P(GLNAM,"("),GLVAL=@GLNAM
"RTN","%ZVEMGO",49,0)
 . S GLSUB=$P($E(GLNAM,1,$L(GLNAM)-1),"(",2,99)
"RTN","%ZVEMGO",50,0)
 . X CODE E  R VEEX#1:0 S:$T CODE=0 Q  ;Hit any key to quit
"RTN","%ZVEMGO",51,0)
 . S ^TMP("VEE",$J,ZREF)=GLNAM
"RTN","%ZVEMGO",52,0)
 . S VEET=GLNAM D SETARRAY^%ZVEMGI
"RTN","%ZVEMGO",53,0)
 . F I=VEET("BOT"):1 I '$D(^TMP("VEE","IG"_GLS,$J,I)) Q
"RTN","%ZVEMGO",54,0)
 . S VEET("BOT")=I ;Reset to include number of lines displayed
"RTN","%ZVEMGO",55,0)
 KILL ^TMP("VEE","VGL"_GLS,$J)
"RTN","%ZVEMGO",56,0)
 I $D(^TMP("VEE",$J)) S ZREF=0 F  S ZREF=$O(^TMP("VEE",$J,ZREF)) Q:ZREF'>0  S ^TMP("VEE","VGL"_GLS,$J,ZREF)=^(ZREF)
"RTN","%ZVEMGO",57,0)
 KILL ^TMP("VEE",$J)
"RTN","%ZVEMGO",58,0)
 I VEET("STATUS")["FINISH" D
"RTN","%ZVEMGO",59,0)
 . S CODE=0,^TMP("VEE","IG"_GLS,$J,VEET("BOT"))=" <> <> <>"
"RTN","%ZVEMGO",60,0)
 . W $C(7),$C(7) S $P(VEET("STATUS"),"^",4)=""
"RTN","%ZVEMGO",61,0)
 S VEET("BOT")=VEET("TOP")
"RTN","%ZVEMGO",62,0)
 S VEET("HLN")=VEET("TOP"),VEET("H$Y")=VEET("S1")-1
"RTN","%ZVEMGO",63,0)
 Q
"RTN","%ZVEMGP")
0^33^B14985118
"RTN","%ZVEMGP",1,0)
%ZVEMGP ;DJB,VGL**PIECES - Display Global Pieces [12/19/96 7:19am]
"RTN","%ZVEMGP",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMGP",3,0)
 ;
"RTN","%ZVEMGP",4,0)
TOP ;FLAGTYPE="IorX^SWITCH" when switching between Int or eXt views
"RTN","%ZVEMGP",5,0)
 NEW X S X="ERROR^%ZVEMGP",@($$TRAP^%ZVEMKU1) KILL X
"RTN","%ZVEMGP",6,0)
 NEW DD,DOTS,FLAGQ,FLAGTYPE,GLVAL,GLVAL1,KEY,NODE,SPACE
"RTN","%ZVEMGP",7,0)
 S DOTS=".........................................."
"RTN","%ZVEMGP",8,0)
 D GETNODE Q:'$D(^DD(DD,"GL",NODE))
"RTN","%ZVEMGP",9,0)
 S FLAGQ=0,FLAGTYPE="I",GLVAL=@GLNAM
"RTN","%ZVEMGP",10,0)
LOOP S GLVAL=@GLNAM,FLAGTYPE=$P(FLAGTYPE,U,1)
"RTN","%ZVEMGP",11,0)
 D LIST(FLAGTYPE)
"RTN","%ZVEMGP",12,0)
 I '$D(GLS) S GLS=$G(^%ZVEMS("%",$J_$G(^%ZVEMS("SY")),"GLS"))
"RTN","%ZVEMGP",13,0)
 Q:FLAGQ!FLAGE
"RTN","%ZVEMGP",14,0)
 G LOOP
"RTN","%ZVEMGP",15,0)
LIST(TYPE) ;List pieces. TYPE="I" (internal values),TYPE="X" (External values)
"RTN","%ZVEMGP",16,0)
 S:$G(TYPE)']"" TYPE="I"
"RTN","%ZVEMGP",17,0)
 NEW FNUM,I,PC,PCNT
"RTN","%ZVEMGP",18,0)
 NEW DX,DY,VEET NEW:'$D(VEES) VEES
"RTN","%ZVEMGP",19,0)
 D START^%ZVEMGPI
"RTN","%ZVEMGP",20,0)
 S PC=$O(^DD(DD,"GL",NODE,"")) I PC["E" D MUMPS Q  ;MUMPS fld typ
"RTN","%ZVEMGP",21,0)
 S (PCNT,PC)=0 F  S PC=$O(^DD(DD,"GL",NODE,PC)) Q:PC=""  S PCNT=PC
"RTN","%ZVEMGP",22,0)
 F PC=1:1:PCNT S VEEX=".) " D  Q:FLAGTYPE["SWITCH"!FLAGQ!FLAGE
"RTN","%ZVEMGP",23,0)
 . I $D(^DD(DD,"GL",NODE,PC)) D  ;
"RTN","%ZVEMGP",24,0)
 . . S FNUM=$O(^DD(DD,"GL",NODE,PC,""))  Q:'FNUM
"RTN","%ZVEMGP",25,0)
 . . Q:'$D(^DD(DD,FNUM,0))  I $P(^(0),U,2)["S" S VEEX="s) " Q
"RTN","%ZVEMGP",26,0)
 . . Q:$P(^(0),U,2)'["P"  S VEEX="p) " Q:TYPE'="X"
"RTN","%ZVEMGP",27,0)
 . . I $P(GLVAL,U,PC)]"",+$P(GLVAL,U,PC)'=$P(GLVAL,U,PC) D
"RTN","%ZVEMGP",28,0)
 . . . S $P(GLVAL,U,PC)="--> *Bad Pointer*"
"RTN","%ZVEMGP",29,0)
 . . Q
"RTN","%ZVEMGP",30,0)
 . S VEEX=$J(PC,3)_VEEX
"RTN","%ZVEMGP",31,0)
 . I TYPE="X",$G(FNUM)]"",$P(GLVAL,U,PC)'["*Bad Pointer*" D  Q:FLAGQ
"RTN","%ZVEMGP",32,0)
 . . NEW X S X="ERROR1^%ZVEMGP",@($$TRAP^%ZVEMKU1) KILL X
"RTN","%ZVEMGP",33,0)
 . . NEW C,I,Y S Y=$P(GLVAL,U,PC) Q:'$D(^DD(DD,FNUM,0))
"RTN","%ZVEMGP",34,0)
 . . S C=$P(^(0),U,2) D Y^DIQ S $P(GLVAL,U,PC)=Y
"RTN","%ZVEMGP",35,0)
 . S VEET=$$GETNAME(PC) S VEET=VEET_$E(DOTS,1,26-$L(VEET))_VEEX
"RTN","%ZVEMGP",36,0)
 . S SPACE=$L(VEET),GLVAL1=$P(GLVAL,U,PC),VEET=VEET_$E(GLVAL1,1,46)
"RTN","%ZVEMGP",37,0)
 . D IMPORT^%ZVEMGPI Q:FLAGQ!FLAGE
"RTN","%ZVEMGP",38,0)
 . F  S GLVAL1=$E(GLVAL1,47,999) Q:GLVAL1=""  D  Q:FLAGQ
"RTN","%ZVEMGP",39,0)
 . . S VEET=$J("",SPACE)_$E(GLVAL1,1,46) D IMPORT^%ZVEMGPI
"RTN","%ZVEMGP",40,0)
 I FLAGTYPE["SWITCH" Q  ;Switching between Int & Ext display.
"RTN","%ZVEMGP",41,0)
 D FINISH^%ZVEMGPI
"RTN","%ZVEMGP",42,0)
 Q
"RTN","%ZVEMGP",43,0)
GETNODE ;Returns DD & NODE
"RTN","%ZVEMGP",44,0)
 NEW TMP S TMP=""
"RTN","%ZVEMGP",45,0)
 I $L(SUBCHK,ZDELIM)>2 F I=1:1:$L(SUBCHK,ZDELIM)-2 D
"RTN","%ZVEMGP",46,0)
 . S TMP=TMP_$P(SUBCHK,ZDELIM,I)_","
"RTN","%ZVEMGP",47,0)
 S TMP=GL_"("_TMP_"0)",DD=+$P(@TMP,U,2) ;Use + to strip off alpha
"RTN","%ZVEMGP",48,0)
 S NODE=$P(SUBCHK,ZDELIM,$L(SUBCHK,ZDELIM))
"RTN","%ZVEMGP",49,0)
 I +NODE'=NODE S NODE=$E(NODE,2,$L(NODE)-1) ;If alpha, strip quotes.
"RTN","%ZVEMGP",50,0)
 Q
"RTN","%ZVEMGP",51,0)
GETNAME(PIECE) ;Get field name
"RTN","%ZVEMGP",52,0)
 NEW ERR,NAM S ERR="       *Not in use*       "
"RTN","%ZVEMGP",53,0)
 I $G(PIECE)']"" Q ERR
"RTN","%ZVEMGP",54,0)
 I '$D(^DD(DD,"GL",NODE,PIECE)) Q ERR
"RTN","%ZVEMGP",55,0)
 S NAM=$O(^DD(DD,"GL",NODE,PIECE,""))
"RTN","%ZVEMGP",56,0)
 I NAM,$D(^DD(DD,NAM,0)) S NAM=$P(^(0),U) I NAM]"" Q $E(NAM,1,25)
"RTN","%ZVEMGP",57,0)
 Q ERR
"RTN","%ZVEMGP",58,0)
MUMPS ;MUMPS data type
"RTN","%ZVEMGP",59,0)
 S VEEX="  1.) "
"RTN","%ZVEMGP",60,0)
 S VEET=$$GETNAME(PC) S VEET=VEET_$E(DOTS,1,25-$L(VEET))_VEEX
"RTN","%ZVEMGP",61,0)
 S SPACE=$L(VEET),GLVAL1=GLVAL,VEET=VEET_$E(GLVAL1,1,46)
"RTN","%ZVEMGP",62,0)
 D IMPORT^%ZVEMGPI Q:FLAGQ
"RTN","%ZVEMGP",63,0)
 F  S GLVAL1=$E(GLVAL1,47,999) Q:GLVAL1=""  D  Q:FLAGQ
"RTN","%ZVEMGP",64,0)
 . S VEET=$J("",SPACE)_$E(GLVAL1,1,46) D IMPORT^%ZVEMGPI
"RTN","%ZVEMGP",65,0)
 I 'FLAGQ D FINISH^%ZVEMGPI
"RTN","%ZVEMGP",66,0)
 Q
"RTN","%ZVEMGP",67,0)
INDIV(PIECE) ;Print indiv fld sum
"RTN","%ZVEMGP",68,0)
 Q:$G(PIECE)']""  NEW FLAGQ,FNUM,PC S FLAGQ=0
"RTN","%ZVEMGP",69,0)
 I PIECE=1,$O(^DD(DD,"GL",NODE,""))["E" D  ;MUMPS data type
"RTN","%ZVEMGP",70,0)
 . S PIECE=$O(^DD(DD,"GL",NODE,""))
"RTN","%ZVEMGP",71,0)
 I '$D(^DD(DD,"GL",NODE,PIECE)) D MSG Q
"RTN","%ZVEMGP",72,0)
 S FNUM=$O(^DD(DD,"GL",NODE,PIECE,0))
"RTN","%ZVEMGP",73,0)
 I FNUM']"" D MSG Q
"RTN","%ZVEMGP",74,0)
 D INDIV^%ZVEMKI1(DD,FNUM) I 'FLAGQ D PAUSE^%ZVEMKC(1)
"RTN","%ZVEMGP",75,0)
 Q
"RTN","%ZVEMGP",76,0)
MSG ;Display message if field is not viewable or no longer in use.
"RTN","%ZVEMGP",77,0)
 W $C(7),"   This field is not viewable, or is no longer in use."
"RTN","%ZVEMGP",78,0)
 D PAUSE^%ZVEMKC(2)
"RTN","%ZVEMGP",79,0)
 Q
"RTN","%ZVEMGP",80,0)
ERROR ;
"RTN","%ZVEMGP",81,0)
 D ENDSCR^%ZVEMKT2 KILL ^TMP("VEE",$J,"IGP")
"RTN","%ZVEMGP",82,0)
 D ERRMSG^%ZVEMKU1("Piece/VGL"),PAUSE^%ZVEMKU(2)
"RTN","%ZVEMGP",83,0)
 Q
"RTN","%ZVEMGP",84,0)
ERROR1 ;Trap error in Y^DIQ. Error is caused by the ^DD containing a
"RTN","%ZVEMGP",85,0)
 ;reference to D0 which is undefined.
"RTN","%ZVEMGP",86,0)
 S FLAGQ=1
"RTN","%ZVEMGP",87,0)
 D ENDSCR^%ZVEMKT2 KILL ^TMP("VEE",$J,"IGP")
"RTN","%ZVEMGP",88,0)
 W $C(7)
"RTN","%ZVEMGP",89,0)
 W !?1,"FM's Y^DIQ call has encountered an error. This is usually"
"RTN","%ZVEMGP",90,0)
 W !?1,"caused by references to D0 in the data dictionary of the"
"RTN","%ZVEMGP",91,0)
 W !?1,"global you are viewing. D0 is not defined with this call."
"RTN","%ZVEMGP",92,0)
 D PAUSE^%ZVEMKU(2)
"RTN","%ZVEMGP",93,0)
 Q
"RTN","%ZVEMGPI")
0^34^B10673644
"RTN","%ZVEMGPI",1,0)
%ZVEMGPI ;DJB,VGL**PIECES - Scroller Import [5/5/97 5:40pm]
"RTN","%ZVEMGPI",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMGPI",3,0)
 ;
"RTN","%ZVEMGPI",4,0)
IMPORT ;Import text to the scroller
"RTN","%ZVEMGPI",5,0)
 D SETARRAY,LIST
"RTN","%ZVEMGPI",6,0)
 Q
"RTN","%ZVEMGPI",7,0)
GETVEET ;Set VEET=Display text
"RTN","%ZVEMGPI",8,0)
 S VEET=$G(^TMP("VEE","IGP",$J,VEET("BOT")))
"RTN","%ZVEMGPI",9,0)
 Q
"RTN","%ZVEMGPI",10,0)
LIST ;Display text
"RTN","%ZVEMGPI",11,0)
 D GETVEET W !,VEET
"RTN","%ZVEMGPI",12,0)
 S VEET("BOT")=VEET("BOT")+1
"RTN","%ZVEMGPI",13,0)
 S:VEET("GAP") VEET("GAP")=VEET("GAP")-1
"RTN","%ZVEMGPI",14,0)
 I VEET=" <> <> <>"!'VEET("GAP") D READ
"RTN","%ZVEMGPI",15,0)
 Q:FLAGTYPE["SWITCH"!FLAGQ!FLAGE
"RTN","%ZVEMGPI",16,0)
 Q:'$D(^TMP("VEE","IGP",$J,VEET("BOT")))
"RTN","%ZVEMGPI",17,0)
 G LIST
"RTN","%ZVEMGPI",18,0)
SETARRAY ;Set scroll array
"RTN","%ZVEMGPI",19,0)
 I $G(VEET)']""!($G(VEET)=" <> <> <>") D  Q
"RTN","%ZVEMGPI",20,0)
 . S ^TMP("VEE","IGP",$J,VEET("BOT"))=" <> <> <>"
"RTN","%ZVEMGPI",21,0)
 S ^TMP("VEE","IGP",$J,VEET("BOT"))=VEET
"RTN","%ZVEMGPI",22,0)
 Q
"RTN","%ZVEMGPI",23,0)
ENDFILE() ;1=End-of-file  0=Ok
"RTN","%ZVEMGPI",24,0)
 I VEET("GAP") W $C(7) Q 1
"RTN","%ZVEMGPI",25,0)
 I ^TMP("VEE","IGP",$J,VEET("BOT")-1)=" <> <> <>"  W $C(7) Q 1
"RTN","%ZVEMGPI",26,0)
 Q 0
"RTN","%ZVEMGPI",27,0)
READ ;Get input
"RTN","%ZVEMGPI",28,0)
 W @VEES("CON") ;Turn cursor back on
"RTN","%ZVEMGPI",29,0)
 D CURSOR^%ZVEMKU1(9,VEET("S2")+VEET("FT")-1,1)
"RTN","%ZVEMGPI",30,0)
 S KEY=$$READ^%ZVEMKRN()
"RTN","%ZVEMGPI",31,0)
 I ",^, ,"[(","_KEY_",") S FLAGQ=1 Q
"RTN","%ZVEMGPI",32,0)
 I ",<ESC>,<F1E>,<F1Q>,<TAB>,<TO>,"[(","_VEE("K")_",") S FLAGQ=1 Q
"RTN","%ZVEMGPI",33,0)
 I ",<HOME>,<F4AL>,"[(","_VEE("K")_",") S VEET("TOP")=1 D REDRAW^%ZVEMKT2() Q
"RTN","%ZVEMGPI",34,0)
 I ",<END>,<F4AR>,"[(","_VEE("K")_",") D BOTTOM^%ZVEMKT2("IGP") Q
"RTN","%ZVEMGPI",35,0)
 I VEE("K")="<AU>" D  G READ
"RTN","%ZVEMGPI",36,0)
 . I VEET("TOP")'>1 W $C(7) Q
"RTN","%ZVEMGPI",37,0)
 . D UP^%ZVEMKT1("IGP")
"RTN","%ZVEMGPI",38,0)
 I VEE("K")="<AD>" G:$$ENDFILE() READ D DOWN^%ZVEMKT1 Q
"RTN","%ZVEMGPI",39,0)
 I ",<PGUP>,<F4AU>,"[(","_VEE("K")_","),VEET("TOP")'>1 W $C(7) G READ
"RTN","%ZVEMGPI",40,0)
 I ",<PGUP>,<F4AU>,"[(","_VEE("K")_",") D LEFT^%ZVEMKT1 Q
"RTN","%ZVEMGPI",41,0)
 I ",<PGDN>,<F4AD>,<RET>,"[(","_VEE("K")_",") G:$$ENDFILE() READ D RIGHT^%ZVEMKT1 Q
"RTN","%ZVEMGPI",42,0)
 S KEY=$$ALLCAPS^%ZVEMKU(KEY)
"RTN","%ZVEMGPI",43,0)
 I VEE("K")'="<ESCH>",",?,I,M,X,"'[(","_KEY_","),KEY'?1.N W $C(7) G READ
"RTN","%ZVEMGPI",44,0)
 I KEY="I" S FLAGTYPE="I^SWITCH" Q
"RTN","%ZVEMGPI",45,0)
 I KEY="X" S FLAGTYPE="X^SWITCH" Q
"RTN","%ZVEMGPI",46,0)
 D ENDSCR^%ZVEMKT2
"RTN","%ZVEMGPI",47,0)
 I KEY["?" D HELP
"RTN","%ZVEMGPI",48,0)
 I VEE("K")="<ESCH>" D HELP^%ZVEMKT2
"RTN","%ZVEMGPI",49,0)
 I KEY?1.N D INDIV^%ZVEMGP(KEY) Q:FLAGQ!FLAGE
"RTN","%ZVEMGPI",50,0)
 D REDRAW^%ZVEMKT2()
"RTN","%ZVEMGPI",51,0)
 Q
"RTN","%ZVEMGPI",52,0)
HELP ;
"RTN","%ZVEMGPI",53,0)
 W !?1,"'n'.........: Enter number from center column to view data dictionary"
"RTN","%ZVEMGPI",54,0)
 W !?2,"I .........: Display internal values on right side of screen"
"RTN","%ZVEMGPI",55,0)
 W !?2,"X .........: Display external values on right side of screen"
"RTN","%ZVEMGPI",56,0)
 D PAUSE^%ZVEMKC(2)
"RTN","%ZVEMGPI",57,0)
 Q
"RTN","%ZVEMGPI",58,0)
START ;Use Scroller
"RTN","%ZVEMGPI",59,0)
 NEW HD,LINE,MAR,TMP
"RTN","%ZVEMGPI",60,0)
 S MAR=$G(VEE("IOM")) S:MAR'>0 MAR=80
"RTN","%ZVEMGPI",61,0)
 S $P(LINE,"=",MAR)=""
"RTN","%ZVEMGPI",62,0)
 S TMP=GLNAM I TMP["""" S TMP=$$QUOTES2^%ZVEMKU(TMP)
"RTN","%ZVEMGPI",63,0)
 S HD=" "_Z1_") "_TMP,HD=HD_$J("",(MAR-17-$L(HD)))
"RTN","%ZVEMGPI",64,0)
 S HD=HD_$S(TYPE="X":"[EXTERNAL VALUE]",1:"[INTERNAL VALUE]")
"RTN","%ZVEMGPI",65,0)
 S VEET("HD")=2,VEET("FT")=3
"RTN","%ZVEMGPI",66,0)
 S VEET("HD",1)=HD
"RTN","%ZVEMGPI",67,0)
 S VEET("HD",2)=LINE
"RTN","%ZVEMGPI",68,0)
 S VEET("FT",1)=LINE
"RTN","%ZVEMGPI",69,0)
 S VEET("FT",2)="<>  'n'=FldDD  I=IntVal  X=ExtVal  ?=Help  <ESCH>=ScrollHelp"
"RTN","%ZVEMGPI",70,0)
 S VEET("FT",3)=" Select: "
"RTN","%ZVEMGPI",71,0)
 S VEET("S1")=3,VEET("S2")=(VEE("IOSL")-3)
"RTN","%ZVEMGPI",72,0)
 S VEET("GET")="D SETARRAY^%ZVEMGY"
"RTN","%ZVEMGPI",73,0)
 D IMPORTS^%ZVEMKT("IGP")
"RTN","%ZVEMGPI",74,0)
 Q
"RTN","%ZVEMGPI",75,0)
FINISH ;Call here AFTER calling IMPORT
"RTN","%ZVEMGPI",76,0)
 I 'FLAGQ,'FLAGE S VEET=" <> <> <>" D IMPORT
"RTN","%ZVEMGPI",77,0)
 KILL ^TMP("VEE","IGP",$J)
"RTN","%ZVEMGPI",78,0)
 D ENDSCR^%ZVEMKT2 ;Reset to full screen
"RTN","%ZVEMGPI",79,0)
 Q
"RTN","%ZVEMGPS")
0^35^B12242122
"RTN","%ZVEMGPS",1,0)
%ZVEMGPS ;DJB,VGL**PIECES - Xref,Word Proc,Zero Nodes [07/21/94]
"RTN","%ZVEMGPS",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMGPS",3,0)
 ;
"RTN","%ZVEMGPS",4,0)
XREF ;Display field if Xref node
"RTN","%ZVEMGPS",5,0)
 NEW DD,FLAGQ,FNUM,LENGTH,TMP,TMP1
"RTN","%ZVEMGPS",6,0)
 S FLAGQ=0,FLAG="XREF"
"RTN","%ZVEMGPS",7,0)
 S TMP="" F I=1:1:(FLAGXREF-1) S TMP=TMP_$P(SUBCHK,ZDELIM,I)_","
"RTN","%ZVEMGPS",8,0)
 S TMP=GL_"("_TMP_"0)" I '$D(@TMP)#2 D XREFMSG Q
"RTN","%ZVEMGPS",9,0)
 S TMP1=$P(SUBCHK,ZDELIM,FLAGXREF),TMP1=$$QUOTES(TMP1)
"RTN","%ZVEMGPS",10,0)
 S VEEX=$P(@TMP,U,2) I VEEX']"" D XREFMSG1 Q
"RTN","%ZVEMGPS",11,0)
 S VEEX=$$ALPHA(VEEX),DD=$O(^DD(VEEX,0,"IX",TMP1,""))
"RTN","%ZVEMGPS",12,0)
 I DD]"" S FNUM=$O(^DD(VEEX,0,"IX",TMP1,DD,""))
"RTN","%ZVEMGPS",13,0)
 I $G(FNUM)']""!($G(DD)']"") D XREFMSG Q
"RTN","%ZVEMGPS",14,0)
 D INDIV^%ZVEMKI1(DD,FNUM) I 'FLAGQ D PAUSE^%ZVEMKC(1)
"RTN","%ZVEMGPS",15,0)
 Q
"RTN","%ZVEMGPS",16,0)
XREFMSG ;No data on Xref
"RTN","%ZVEMGPS",17,0)
 W $C(7),!?1,"The Data Dictionary has no data on this Xref."
"RTN","%ZVEMGPS",18,0)
 D PAUSE^%ZVEMKC(2)
"RTN","%ZVEMGPS",19,0)
 Q
"RTN","%ZVEMGPS",20,0)
XREFMSG1 ;2nd Piece of zero node doesn't contain DD reference
"RTN","%ZVEMGPS",21,0)
 W $C(7),!?1,"NODE: "_TMP_" = "_@TMP
"RTN","%ZVEMGPS",22,0)
 W !!?1,"2nd Piece of above node is missing data dictionary #."
"RTN","%ZVEMGPS",23,0)
 D PAUSE^%ZVEMKC(2)
"RTN","%ZVEMGPS",24,0)
 Q
"RTN","%ZVEMGPS",25,0)
WP ;Display field if Word Processing node
"RTN","%ZVEMGPS",26,0)
 NEW DD,FLAGQ,FNUM,I,LENGTH,NODE,TMP,TMP1
"RTN","%ZVEMGPS",27,0)
 S FLAGQ=0,FLAG="WP"
"RTN","%ZVEMGPS",28,0)
 S TMP="" F I=1:1:($L(SUBCHK,ZDELIM)-4) S TMP=TMP_$P(SUBCHK,ZDELIM,I)_","
"RTN","%ZVEMGPS",29,0)
 S TMP=GL_"("_TMP_"0)" I '$D(@TMP)#2 D WPMSG,PAUSE^%ZVEMKC(1) Q
"RTN","%ZVEMGPS",30,0)
 S NODE=$P(SUBCHK,ZDELIM,($L(SUBCHK,ZDELIM)-2))
"RTN","%ZVEMGPS",31,0)
 I +NODE'=NODE S NODE=$$QUOTES(NODE)
"RTN","%ZVEMGPS",32,0)
 S VEEX=$P(@TMP,U,2),VEEX=$$ALPHA(VEEX)
"RTN","%ZVEMGPS",33,0)
 I VEEX']"" D WPMSG,PAUSE^%ZVEMKC(1) Q
"RTN","%ZVEMGPS",34,0)
 S TMP=$O(^DD(VEEX,"GL",NODE,0,"")),TMP="^DD("_VEEX_","_TMP_",0)"
"RTN","%ZVEMGPS",35,0)
 S VEEX=$P(@TMP,U,2),VEEX=$$ALPHA(VEEX)
"RTN","%ZVEMGPS",36,0)
 I VEEX']"" D WPMSG,PAUSE^%ZVEMKC(1) Q
"RTN","%ZVEMGPS",37,0)
 S DD=VEEX I DD]"" S FNUM=.01
"RTN","%ZVEMGPS",38,0)
 I $G(FNUM)']""!($G(DD)="") D WPMSG,PAUSE^%ZVEMKC(1) Q
"RTN","%ZVEMGPS",39,0)
 D INDIV^%ZVEMKI1(DD,FNUM) I 'FLAGQ D PAUSE^%ZVEMKC(1)
"RTN","%ZVEMGPS",40,0)
 Q
"RTN","%ZVEMGPS",41,0)
WPMSG ;Display msg if no data on Word Processing field.
"RTN","%ZVEMGPS",42,0)
 W $C(7),"   Invalid node."
"RTN","%ZVEMGPS",43,0)
 Q
"RTN","%ZVEMGPS",44,0)
QUOTES(STRING) ;Strip off quotes from STRING
"RTN","%ZVEMGPS",45,0)
 I $G(STRING)']"" Q ""
"RTN","%ZVEMGPS",46,0)
 S STRING=$E(STRING,2,$L(STRING)-1)
"RTN","%ZVEMGPS",47,0)
 Q STRING
"RTN","%ZVEMGPS",48,0)
ALPHA(STRING) ;Strip off alpha from STRING
"RTN","%ZVEMGPS",49,0)
 NEW I,X S X=""
"RTN","%ZVEMGPS",50,0)
 F I=1:1:$L(STRING) D
"RTN","%ZVEMGPS",51,0)
 . I $E(STRING,I)?1N!($E(STRING,I)?1".") S X=X_$E(STRING,I)
"RTN","%ZVEMGPS",52,0)
 Q X
"RTN","%ZVEMGPS",53,0)
ZERO ;Display characteristics of zero node
"RTN","%ZVEMGPS",54,0)
 W @VEE("IOF"),!?1,"Global Pieces(INT VALUE): ",Z1,") ",GLNAM,!,$E(VEELINE1,1,VEE("IOM"))
"RTN","%ZVEMGPS",55,0)
 W !?1 S GLVAL=@GLNAM F I=1:1:4 W:I>1 "    " W "(",I,") ",$P(GLVAL,U,I)
"RTN","%ZVEMGPS",56,0)
 W !!?1,"This is a Zero Node which has the following characteristics:"
"RTN","%ZVEMGPS",57,0)
 W !?4,"Piece 1 = File name",?32,"Piece 3 = Most recently assigned entry number"
"RTN","%ZVEMGPS",58,0)
 W !?4,"Piece 2 = File number",?32,"Piece 4 = Total number of entries"
"RTN","%ZVEMGPS",59,0)
 W !!?1,"The 2nd piece may also be followed by a string of alphabetic characters"
"RTN","%ZVEMGPS",60,0)
 W !?1,"to indicate various characteristics of the file:"
"RTN","%ZVEMGPS",61,0)
 W !?4,"D... .01 field is Date/Time"
"RTN","%ZVEMGPS",62,0)
 W !?4,"N... .01 field is a Number"
"RTN","%ZVEMGPS",63,0)
 W !?4,"P... .01 field is a Pointer to another file"
"RTN","%ZVEMGPS",64,0)
 W !?4,"S... .01 field is a Set of Codes"
"RTN","%ZVEMGPS",65,0)
 W !?4,"V... .01 field is a Variable Pointer"
"RTN","%ZVEMGPS",66,0)
 W !?4,"A... Adds entries without asking: ARE YOU ADDING A NEW ENTRY?"
"RTN","%ZVEMGPS",67,0)
 W !?4,"I... File has Identifiers"
"RTN","%ZVEMGPS",68,0)
 W !?4,"O... User is asked -OK? when a matching entry is found during look-up"
"RTN","%ZVEMGPS",69,0)
 W !?4,"s... (Lower case 's') File has a screen in ^DD(file,0,""SCR"")."
"RTN","%ZVEMGPS",70,0)
 W ! D PAUSE^%ZVEMKC(1)
"RTN","%ZVEMGPS",71,0)
 Q
"RTN","%ZVEMGR")
0^36^B10985096
"RTN","%ZVEMGR",1,0)
%ZVEMGR ;DJB,VGL**Process a Range of nodes [02/03/95]
"RTN","%ZVEMGR",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMGR",3,0)
 ;
"RTN","%ZVEMGR",4,0)
RANGE ;User asked for a range with ":" or ",,"
"RTN","%ZVEMGR",5,0)
 ;Set up GLOBAL,START(),END()
"RTN","%ZVEMGR",6,0)
 I ZGL'?.E1"(".E D TOP^%ZVEMGI(ZGL) D  Q
"RTN","%ZVEMGR",7,0)
 . Q:VEET("STATUS")["START"  Q:VEET("STATUS")["PROT"
"RTN","%ZVEMGR",8,0)
 . W !!?1,"No data" D VRR
"RTN","%ZVEMGR",9,0)
 NEW END,HOLD,I1,II,GLOBAL,LIMIT,START
"RTN","%ZVEMGR",10,0)
 S GLOBAL=$P(ZGL,"(")
"RTN","%ZVEMGR",11,0)
 ;Replace variables with their values.
"RTN","%ZVEMGR",12,0)
 D VARIABLE^%ZVEMGR1 I FLAGQ D VRR Q
"RTN","%ZVEMGR",13,0)
 ;Process a range with "spaces".
"RTN","%ZVEMGR",14,0)
 I NEWSUB[ZDELIM1 D SPACES^%ZVEMGR1 D:FLAGQ VRR Q
"RTN","%ZVEMGR",15,0)
 ;Process a range entered with ":" or ",,".
"RTN","%ZVEMGR",16,0)
 D SETPARAM I FLAGQ W !!?1,"Invalid quote marks" D VRR Q
"RTN","%ZVEMGR",17,0)
 D START I VEET("STATUS")'["START",VEET("STATUS")'["PROT" D  Q
"RTN","%ZVEMGR",18,0)
 . W !!?1,"No data" D VRR
"RTN","%ZVEMGR",19,0)
 Q
"RTN","%ZVEMGR",20,0)
VRR ;Pause screen if VGL was called from VRR.
"RTN","%ZVEMGR",21,0)
 I $G(FLAGVPE)["VRR" D PAUSE^%ZVEMKU(2)
"RTN","%ZVEMGR",22,0)
 Q
"RTN","%ZVEMGR",23,0)
SETPARAM ;Set starting and ending parameters
"RTN","%ZVEMGR",24,0)
 S LIMIT=$L(NEWSUB,ZDELIM) F I=1:1:LIMIT D  Q:FLAGQ  I START(I)'=END(I) S HOLD(I)=START(I)
"RTN","%ZVEMGR",25,0)
 . S (START(I),END(I))=$P(NEWSUB,ZDELIM,I)
"RTN","%ZVEMGR",26,0)
 . I START(I)[ZDELIM2 D  ;handle ":" range using ZDELIM2
"RTN","%ZVEMGR",27,0)
 . . S END(I)=$P(START(I),ZDELIM2,2),START(I)=$P(START(I),ZDELIM2)
"RTN","%ZVEMGR",28,0)
 . S:START(I)="" START(I)=0 S:END(I)="" END(I)="zzzzz"
"RTN","%ZVEMGR",29,0)
 . S $P(NEWSUB,ZDELIM,I)=START(I)
"RTN","%ZVEMGR",30,0)
 . ;Next check validity of any quote marks.
"RTN","%ZVEMGR",31,0)
 . I START(I)?1""""1.E1"""" D  Q:FLAGQ
"RTN","%ZVEMGR",32,0)
 . . F II=2:1:($L(START(I))-1) Q:$E(START(I),II)'=""""&FLAGQ  I $E(START(I),II)="""" S FLAGQ=FLAGQ=0
"RTN","%ZVEMGR",33,0)
 . I END(I)?1""""1.E1"""" D
"RTN","%ZVEMGR",34,0)
 . . F II=2:1:($L(END(I))-1) Q:$E(END(I),II)'=""""&FLAGQ  I $E(END(I),II)="""" S FLAGQ=FLAGQ=0
"RTN","%ZVEMGR",35,0)
 Q
"RTN","%ZVEMGR",36,0)
START ;Move up and down the subscript
"RTN","%ZVEMGR",37,0)
 NEW ACTLEV,HLDGLX,HLDEND,LOWLEV,RUNSUB,TEMPSUB,UPLEV
"RTN","%ZVEMGR",38,0)
 S FLAGQ=0,(ACTLEV,UPLEV)=LIMIT,LOWLEV=1
"RTN","%ZVEMGR",39,0)
 F I=1:1:UPLEV S GLX(I)=START(I)
"RTN","%ZVEMGR",40,0)
START1 ;Set each part of subscript to correct value during looping.
"RTN","%ZVEMGR",41,0)
 S RUNSUB="" F I=1:1:UPLEV S RUNSUB=RUNSUB_$S($G(HOLD(I))]"":HOLD(I),I=ACTLEV:GLX(I),1:START(I))_$S(I=UPLEV:"",1:ZDELIM)
"RTN","%ZVEMGR",42,0)
 ;W !,$$TRAN^%ZVEMGU(GLOBAL_"("_RUNSUB_")") R XXX ;Used for tracking the subscript when a range was specified.
"RTN","%ZVEMGR",43,0)
 D TOP^%ZVEMGI($$TRAN^%ZVEMGU(GLOBAL_"("_RUNSUB_")")) Q:FLAGQ!FLAGE
"RTN","%ZVEMGR",44,0)
START2 ;Now get new values for RUNSUB
"RTN","%ZVEMGR",45,0)
 Q:ACTLEV<LOWLEV
"RTN","%ZVEMGR",46,0)
 S TEMPSUB="" F I=1:1:ACTLEV S TEMPSUB=TEMPSUB_$S($G(HOLD(I))]"":HOLD(I),I=ACTLEV:GLX(I),1:START(I))_$S(I=ACTLEV:"",1:ZDELIM)
"RTN","%ZVEMGR",47,0)
 S GLX(ACTLEV)=$O(@$$TRAN^%ZVEMGU(GLOBAL_"("_TEMPSUB_")"))
"RTN","%ZVEMGR",48,0)
 I GLX(ACTLEV)="" D RESET G START2
"RTN","%ZVEMGR",49,0)
 S HLDGLX=$S(GLX(ACTLEV)["E"!(GLX(ACTLEV)["e"):"ALPH",+GLX(ACTLEV)'=GLX(ACTLEV):"ALPH",1:"NUM")
"RTN","%ZVEMGR",50,0)
 S HLDEND=$S(END(ACTLEV)["E"!(END(ACTLEV)["e"):"ALPH",+END(ACTLEV)'=END(ACTLEV):"ALPH",1:"NUM")
"RTN","%ZVEMGR",51,0)
 ;Next line converts any single quotes to double quotes
"RTN","%ZVEMGR",52,0)
 I HLDGLX="ALPH" S GLX(ACTLEV)=$$QUOTES2^%ZVEMKU(GLX(ACTLEV)),GLX(ACTLEV)=""""_GLX(ACTLEV)_""""
"RTN","%ZVEMGR",53,0)
 I HLDGLX="NUM",HLDEND="NUM",GLX(ACTLEV)>END(ACTLEV) D RESET G START2
"RTN","%ZVEMGR",54,0)
 I HLDGLX="ALPH",HLDEND="ALPH",GLX(ACTLEV)]END(ACTLEV) D RESET G START2
"RTN","%ZVEMGR",55,0)
 I HLDGLX="ALPH",HLDEND="NUM" D RESET G START2
"RTN","%ZVEMGR",56,0)
 I $G(HOLD(ACTLEV))]"" S HOLD(ACTLEV)=GLX(ACTLEV),ACTLEV=UPLEV ;HOLD(ACTLEV) handles ranges like ^DIC(3,,1:200
"RTN","%ZVEMGR",57,0)
 G START1
"RTN","%ZVEMGR",58,0)
 ;
"RTN","%ZVEMGR",59,0)
RESET ;Set HOLD to current value and go back up to UPLEV
"RTN","%ZVEMGR",60,0)
 S:$G(HOLD(ACTLEV))]"" HOLD(ACTLEV)=START(ACTLEV)
"RTN","%ZVEMGR",61,0)
 S GLX(ACTLEV)=START(ACTLEV),ACTLEV=ACTLEV-1
"RTN","%ZVEMGR",62,0)
 Q
"RTN","%ZVEMGR1")
0^37^B7973256
"RTN","%ZVEMGR1",1,0)
%ZVEMGR1 ;DJB,VGL**Process Variables [10/25/94]
"RTN","%ZVEMGR1",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMGR1",3,0)
 ;
"RTN","%ZVEMGR1",4,0)
VARIABLE ;Check if variable is valid and replace with its value
"RTN","%ZVEMGR1",5,0)
 NEW TEMP1,TEMP2,TEMPSP
"RTN","%ZVEMGR1",6,0)
 F I=1:1:$L(NEWSUB,ZDELIM) S TEMP=$P(NEWSUB,ZDELIM,I) D @$S(TEMP[ZDELIM1:"VAR1",1:"VAR2") S $P(NEWSUB,ZDELIM,I)=TEMP
"RTN","%ZVEMGR1",7,0)
 I FLAGQ W !!?1,"Subscript contains an invalid variable"
"RTN","%ZVEMGR1",8,0)
 Q
"RTN","%ZVEMGR1",9,0)
VAR1 ;TEMP contains spaces
"RTN","%ZVEMGR1",10,0)
 S TEMPSP=TEMP F I1=1:1:$L(TEMPSP,ZDELIM1) S TEMP=$P(TEMPSP,ZDELIM1,I1) D VAR2 S $P(TEMPSP,ZDELIM1,I1)=TEMP
"RTN","%ZVEMGR1",11,0)
 S TEMP=TEMPSP
"RTN","%ZVEMGR1",12,0)
 Q
"RTN","%ZVEMGR1",13,0)
VAR2 ;TEMP does not contain spaces
"RTN","%ZVEMGR1",14,0)
 I TEMP[ZDELIM2 S TEMP1=$$VARCHK($P(TEMP,ZDELIM2)),TEMP2=$$VARCHK($P(TEMP,ZDELIM2,2)),TEMP=TEMP1_ZDELIM2_TEMP2
"RTN","%ZVEMGR1",15,0)
 I TEMP'[ZDELIM2 S TEMP=$$VARCHK(TEMP)
"RTN","%ZVEMGR1",16,0)
 Q
"RTN","%ZVEMGR1",17,0)
VARCHK(VaR) ;If variable is alpha, make sure quote marks are correct. Use VaR so I don't interfere with Variable name.
"RTN","%ZVEMGR1",18,0)
 S VaR=$G(VaR) I VaR']"" Q VaR
"RTN","%ZVEMGR1",19,0)
 I +VaR=VaR!(VaR?1""""1.E1"""") Q VaR
"RTN","%ZVEMGR1",20,0)
 I VaR="$J" S VaR=$S(+$J=$J:$J,1:""""_$J_"""") Q VaR
"RTN","%ZVEMGR1",21,0)
 I VaR="$I" S VaR=$S(+$I=$I:$I,1:""""_$I_"""") Q VaR
"RTN","%ZVEMGR1",22,0)
 I VaR="$H" S VaR=$S(+$H=$H:$H,1:""""_$H_"""") Q VaR
"RTN","%ZVEMGR1",23,0)
 I VaR?1A.AN,$D(VaR)#2,$G(@VaR)]"" S VaR=@VaR D  Q VaR
"RTN","%ZVEMGR1",24,0)
 . I +VaR'=VaR S VaR=""""_VaR_""""
"RTN","%ZVEMGR1",25,0)
 S FLAGQ=1
"RTN","%ZVEMGR1",26,0)
 Q VaR
"RTN","%ZVEMGR1",27,0)
SPACES ;Process range entered with spaces.
"RTN","%ZVEMGR1",28,0)
 NEW ACTLEV,RUNSUB,SPACE,TEMPSUB,UPLEV
"RTN","%ZVEMGR1",29,0)
 S (ACTLEV,UPLEV)=$L(NEWSUB,ZDELIM),FLAGQ=0
"RTN","%ZVEMGR1",30,0)
 F I=1:1:UPLEV S CNTX(I)=1,TEMP=$P(NEWSUB,ZDELIM,I) F II=1:1:$L(TEMP,ZDELIM1) S SPACE(I,II)=$P(TEMP,ZDELIM1,II)
"RTN","%ZVEMGR1",31,0)
 D SPACECK I FLAGQ W !!?1,"Invalid subscript" Q
"RTN","%ZVEMGR1",32,0)
 D SPACES1 I VEET("STATUS")'["START",VEET("STATUS")'["PROT" W !!?1,"No data"
"RTN","%ZVEMGR1",33,0)
 Q
"RTN","%ZVEMGR1",34,0)
SPACES1 ;Set each part of subscript to correct value.
"RTN","%ZVEMGR1",35,0)
 S NEWSUB="" F I=1:1:UPLEV S NEWSUB=NEWSUB_SPACE(I,CNTX(I))_$S(I=UPLEV:"",1:ZDELIM)
"RTN","%ZVEMGR1",36,0)
 D SETPARAM^%ZVEMGR,START^%ZVEMGR Q:FLAGQ
"RTN","%ZVEMGR1",37,0)
SPACES2 ;Now get new values for NEWSUB
"RTN","%ZVEMGR1",38,0)
 Q:ACTLEV<1
"RTN","%ZVEMGR1",39,0)
 S CNTX(ACTLEV)=CNTX(ACTLEV)+1 I '$D(SPACE(ACTLEV,CNTX(ACTLEV))) S CNTX(ACTLEV)=1,ACTLEV=ACTLEV-1 G SPACES2
"RTN","%ZVEMGR1",40,0)
 S ACTLEV=UPLEV
"RTN","%ZVEMGR1",41,0)
 G SPACES1
"RTN","%ZVEMGR1",42,0)
SPACECK ;Check subscript
"RTN","%ZVEMGR1",43,0)
 NEW ACTLEV,RUNSUB,SPACE,TEMPSUB,UPLEV
"RTN","%ZVEMGR1",44,0)
 S (ACTLEV,UPLEV)=$L(NEWSUB,ZDELIM),FLAGQ=0
"RTN","%ZVEMGR1",45,0)
 F I=1:1:UPLEV S CNTX(I)=1,TEMP=$P(NEWSUB,ZDELIM,I) F II=1:1:$L(TEMP,ZDELIM1) S SPACE(I,II)=$P(TEMP,ZDELIM1,II)
"RTN","%ZVEMGR1",46,0)
 S NEWSUB="" F I=1:1:UPLEV S NEWSUB=NEWSUB_SPACE(I,CNTX(I))_$S(I=UPLEV:"",1:ZDELIM)
"RTN","%ZVEMGR1",47,0)
 D SETPARAM^%ZVEMGR
"RTN","%ZVEMGR1",48,0)
SPACECK1 ;Now get new values for NEWSUB
"RTN","%ZVEMGR1",49,0)
 Q:ACTLEV<1
"RTN","%ZVEMGR1",50,0)
 S CNTX(ACTLEV)=CNTX(ACTLEV)+1 I '$D(SPACE(ACTLEV,CNTX(ACTLEV))) S CNTX(ACTLEV)=1,ACTLEV=ACTLEV-1 G SPACECK1
"RTN","%ZVEMGR1",51,0)
 G SPACECK
"RTN","%ZVEMGS")
0^38^B5117917
"RTN","%ZVEMGS",1,0)
%ZVEMGS ;DJB,VGL**SAVE,UNSAVE [4/16/95 5:50am]
"RTN","%ZVEMGS",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMGS",3,0)
 ;
"RTN","%ZVEMGS",4,0)
SAVE ;Save lines of code (to be UNsaved to a new location).
"RTN","%ZVEMGS",5,0)
 NEW CNT,GLNAM,I,ND,RNG
"RTN","%ZVEMGS",6,0)
 S CNT=1,RNG=$$GETRANG^%ZVEMKTR("VGL"_GLS) Q:RNG="^"
"RTN","%ZVEMGS",7,0)
 I RNG["^" F ND=$P(RNG,"^",1):1:$P(RNG,"^",2) D SAVE1
"RTN","%ZVEMGS",8,0)
 I RNG["," F I=1:1:$L(RNG,",") S ND=$P(RNG,",",I) D SAVE1
"RTN","%ZVEMGS",9,0)
 S ^%ZVEMS("E","SAVE",$J,CNT)=""
"RTN","%ZVEMGS",10,0)
 W "   Save Complete" H 1
"RTN","%ZVEMGS",11,0)
 Q
"RTN","%ZVEMGS",12,0)
SAVE1 ;
"RTN","%ZVEMGS",13,0)
 Q:'$D(^TMP("VEE","VGL"_GLS,$J,ND))  S GLNAM=^(ND) Q:GLNAM']""
"RTN","%ZVEMGS",14,0)
 S ^%ZVEMS("E","SAVE",$J,CNT)=$C(9)_@GLNAM,CNT=CNT+1
"RTN","%ZVEMGS",15,0)
 Q
"RTN","%ZVEMGS",16,0)
 ;===================================================================
"RTN","%ZVEMGS",17,0)
UNSAVE ;Unsave code previously saved
"RTN","%ZVEMGS",18,0)
 I '$D(^%ZVEMS("E","SAVE",$J)) D MSG^%ZVEMGUM(22,1) Q
"RTN","%ZVEMGS",19,0)
 NEW CD,FLAGERR,I,J,LINES,NODE I $G(VEESHL)'="RUN" NEW VEESHC
"RTN","%ZVEMGS",20,0)
 D CURSOR^%ZVEMKU1(0,VEET("S2")+VEET("FT")-2,1)
"RTN","%ZVEMGS",21,0)
 F I=1:1 Q:^%ZVEMS("E","SAVE",$J,I)=""  Q:'$D(^(I))
"RTN","%ZVEMGS",22,0)
 S LINES=I-1 D  D PAUSE^%ZVEMKU(1)
"RTN","%ZVEMGS",23,0)
 . W LINES," LINE",$S(LINES=1:"",1:"S")," of code saved."
"RTN","%ZVEMGS",24,0)
 . W " NOTE: Exit and reenter VGL to see newly created nodes."
"RTN","%ZVEMGS",25,0)
 F I=1:1:LINES D UNSAVS Q:CD="^"
"RTN","%ZVEMGS",26,0)
 Q
"RTN","%ZVEMGS",27,0)
UNSAVS ;Get subscript
"RTN","%ZVEMGS",28,0)
 S CD="" D CURSOR^%ZVEMKU1(0,VEET("S2")+VEET("FT")-2,1)
"RTN","%ZVEMGS",29,0)
 W "Enter subscript to load LINE ",I," into a global node:"
"RTN","%ZVEMGS",30,0)
 D SCREEN^%ZVEMKEA(GL_"(",2,75)
"RTN","%ZVEMGS",31,0)
 I VEESHC="<ESCH>" D MSG^%ZVEMGUM(21,1) G UNSAVS
"RTN","%ZVEMGS",32,0)
 I CD="?"!(CD="??") D MSG^%ZVEMGUM(21,1) G UNSAVS
"RTN","%ZVEMGS",33,0)
 I ",<ESC>,<F1E>,<F1Q>,<TAB>,<TO>,"[(","_VEESHC_",")!(CD']"") S CD="^"
"RTN","%ZVEMGS",34,0)
 Q:CD="^"
"RTN","%ZVEMGS",35,0)
 I VEESHC'="<RET>",VEESHC?1"<".E1">".E G UNSAVS
"RTN","%ZVEMGS",36,0)
 S NODE=GL_"("_CD S:$E(NODE,$L(NODE))'=")" NODE=NODE_")"
"RTN","%ZVEMGS",37,0)
 S FLAGERR=0 D  G:FLAGERR UNSAVS
"RTN","%ZVEMGS",38,0)
 . NEW X S X="ERROR^%ZVEMGS",@($$TRAP^%ZVEMKU1) KILL X
"RTN","%ZVEMGS",39,0)
 . S CD=^%ZVEMS("E","SAVE",$J,I)
"RTN","%ZVEMGS",40,0)
 . F J=1:1:($L(CD,$C(9))-1) S CD=$P(CD,$C(9),1)_$P(CD,$C(9),2,999)
"RTN","%ZVEMGS",41,0)
 . I $D(@NODE)#2 D MSG^%ZVEMGUM(12,1) S CD="",FLAGERR=1 Q
"RTN","%ZVEMGS",42,0)
 . S @NODE=CD
"RTN","%ZVEMGS",43,0)
 Q
"RTN","%ZVEMGS",44,0)
ERROR ;
"RTN","%ZVEMGS",45,0)
 D CURSOR^%ZVEMKU1(0,VEET("S2")+VEET("FT")-2,1)
"RTN","%ZVEMGS",46,0)
 W $C(7),"Invalid subscript.."
"RTN","%ZVEMGS",47,0)
 S CD="",FLAGERR=1 D PAUSE^%ZVEMKU(1)
"RTN","%ZVEMGS",48,0)
 Q
"RTN","%ZVEMGU")
0^39^B11574955
"RTN","%ZVEMGU",1,0)
%ZVEMGU ;DJB,VGL**Utility Routine - ZDELIM,Get File,Heading [07/29/94]
"RTN","%ZVEMGU",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMGU",3,0)
 ;
"RTN","%ZVEMGU",4,0)
TRAN(X) ;Substitute ZDELIM with comma in subscript so I can check for $D.
"RTN","%ZVEMGU",5,0)
 NEW ZDELIM,I,Y S ZDELIM=$C(127)_$C(124),Y=""
"RTN","%ZVEMGU",6,0)
 F I=1:1:$L(X,ZDELIM) S Y=Y_$P(X,ZDELIM,I)_$S(I=$L(X,ZDELIM):"",1:",")
"RTN","%ZVEMGU",7,0)
 Q Y
"RTN","%ZVEMGU",8,0)
ZDELIM(SUB) ;Replace commas, spaces, and colons (if not between quotes) with variable ZDELIM, ZDELIM1, or ZDELIM2
"RTN","%ZVEMGU",9,0)
 I $G(SUB)="" Q ""
"RTN","%ZVEMGU",10,0)
 NEW CHK,NEWSUB,X,Y
"RTN","%ZVEMGU",11,0)
 S (CHK,X)=0,NEWSUB=$P($E(SUB,1,$L(SUB)-1),"(",2,99)
"RTN","%ZVEMGU",12,0)
 F  S X=X+1 Q:$E(NEWSUB,X)=""  S:$E(NEWSUB,X)="""" CHK=CHK=0 I 'CHK D
"RTN","%ZVEMGU",13,0)
 . S Y=$E(NEWSUB,X)
"RTN","%ZVEMGU",14,0)
 . S Y=$S(Y=",":ZDELIM,Y=" ":ZDELIM1,Y=":":ZDELIM2,1:"QUIT")
"RTN","%ZVEMGU",15,0)
 . Q:Y="QUIT"  S NEWSUB=$E(NEWSUB,1,X-1)_Y_$E(NEWSUB,X+1,99),X=X+1
"RTN","%ZVEMGU",16,0)
 . Q
"RTN","%ZVEMGU",17,0)
 Q NEWSUB
"RTN","%ZVEMGU",18,0)
GETFILE ;Select global by entering file name or number
"RTN","%ZVEMGU",19,0)
 NEW DIC,GLOBAL,X,Y
"RTN","%ZVEMGU",20,0)
 I '$D(^DIC)!('$D(^DD)) D  S ZGL="" D PAUSE^%ZVEMKC(2) Q
"RTN","%ZVEMGU",21,0)
 . W $C(7),!!?1,"VA Filemanager is not in this UCI."
"RTN","%ZVEMGU",22,0)
 I $G(FLAGPRM)="VGL" S DIC(0)="QEM",X=ZGL
"RTN","%ZVEMGU",23,0)
 E  S DIC(0)="QEAM"
"RTN","%ZVEMGU",24,0)
 S DIC="^DIC(" D ^DIC I Y<0 D  S ZGL="" Q
"RTN","%ZVEMGU",25,0)
 . Q:$G(FLAGPRM)'="VGL"
"RTN","%ZVEMGU",26,0)
 . W !!?1,"First parameter is not a valid file name/number."
"RTN","%ZVEMGU",27,0)
 . D PAUSE^%ZVEMKC(2)
"RTN","%ZVEMGU",28,0)
 S GLOBAL=$G(^DIC(+Y,0,"GL")) I GLOBAL="" D  S ZGL="" Q
"RTN","%ZVEMGU",29,0)
 . W $C(7),!!?1,"^DIC(",+Y,",0,""GL"") is not defined."
"RTN","%ZVEMGU",30,0)
 . D PAUSE^%ZVEMKC(2)
"RTN","%ZVEMGU",31,0)
GETFILE1 W !?13,"Global ",GLOBAL,"//"
"RTN","%ZVEMGU",32,0)
 R ZGL:VEE("TIME") S:'$T ZGL="^" S:ZGL="" ZGL=GLOBAL I ZGL="^" S ZGL=""
"RTN","%ZVEMGU",33,0)
 I $E(ZGL)="?" D  G GETFILE1
"RTN","%ZVEMGU",34,0)
 . W !?1,"Enter <RETURN> for default global, or a new global of your choice. Enter"
"RTN","%ZVEMGU",35,0)
 . W !?1,"<SPACE> to select up to 10 entries from the default global, for viewing."
"RTN","%ZVEMGU",36,0)
 I ZGL=" " NEW CNT S (DIC,ZGL)=GLOBAL,DIC(0)="QEAM" D  ;
"RTN","%ZVEMGU",37,0)
 . F CNT=1:1:10 D ^DIC Q:Y<0  S ZGL=ZGL_$S(CNT=1:"",1:" ")_+Y
"RTN","%ZVEMGU",38,0)
 Q
"RTN","%ZVEMGU",39,0)
GLBLIST(GLB) ;List globals
"RTN","%ZVEMGU",40,0)
 NEW CNT,DATA,DOTS,FLAG1ST,FLAGQ,SUB,X
"RTN","%ZVEMGU",41,0)
 I $G(GLB)']""!($G(GLB)'?1.E1"*") Q ""
"RTN","%ZVEMGU",42,0)
 S GLB=$TR(GLB,"*") S:$E(GLB)'="^" GLB="^"_GLB
"RTN","%ZVEMGU",43,0)
 S:GLB["(" GLB=$P(GLB,"(",1)
"RTN","%ZVEMGU",44,0)
 I GLB'?1"^".1"%"1A.AN W !!?1,"Global name invalid" Q ""
"RTN","%ZVEMGU",45,0)
 S (FLAG1ST,FLAGQ,X)=0,CNT=1,$P(DOTS,".",20)="" KILL ^TMP("VEE",$J)
"RTN","%ZVEMGU",46,0)
 F  S X=$O(@GLB@(X)) Q:X=""  D  Q:FLAGQ
"RTN","%ZVEMGU",47,0)
 . S SUB=X I +SUB'=SUB S SUB=""""_SUB_"""" ;Alpha
"RTN","%ZVEMGU",48,0)
 . S DATA=$S($D(@GLB@(X,0))#2:$P(^(0),"^",1),$D(@GLB@(X))#2:$E(^(X),1,49),1:"")
"RTN","%ZVEMGU",49,0)
 . W:'FLAG1ST @VEE("IOF") S FLAG1ST=1
"RTN","%ZVEMGU",50,0)
 . W !,$J(CNT,4)_". "_GLB_"("_SUB_" "_$E(DOTS,1,20-$L(SUB)-$L(GLB))_": "_DATA
"RTN","%ZVEMGU",51,0)
 . S ^TMP("VEE",$J,CNT)=GLB_"("_SUB,CNT=CNT+1
"RTN","%ZVEMGU",52,0)
 . I $Y>(VEE("IOSL")-5) D PAUSEQ^%ZVEMKC(2) W:'FLAGQ @VEE("IOF")
"RTN","%ZVEMGU",53,0)
 I '$D(^TMP("VEE",$J)) W !!?1,"No data" Q ""
"RTN","%ZVEMGU",54,0)
 W !
"RTN","%ZVEMGU",55,0)
GLBLIST1 W !,"Enter NODE Number: " R CNT:VEE("TIME") S:'$T CNT="^"
"RTN","%ZVEMGU",56,0)
 I "^"[CNT KILL ^TMP("VEE",$J) Q ""
"RTN","%ZVEMGU",57,0)
 I '$D(^TMP("VEE",$J,CNT)) D  G GLBLIST1
"RTN","%ZVEMGU",58,0)
 . W !,"Enter number of your choice from left hand column."
"RTN","%ZVEMGU",59,0)
 S GLB=^TMP("VEE",$J,CNT) KILL ^TMP("VEE",$J)
"RTN","%ZVEMGU",60,0)
 Q GLB
"RTN","%ZVEMGU",61,0)
HD ;Heading
"RTN","%ZVEMGU",62,0)
 I $G(FLAGVPE)["VEDD" Q  ;Global Lister called by VEDD
"RTN","%ZVEMGU",63,0)
 I $G(FLAGVPE)["VRR" Q  ;Global Lister called by VRR
"RTN","%ZVEMGU",64,0)
 I VEET("STATUS")["HEADING" Q  ;Only do heading when starting over
"RTN","%ZVEMGU",65,0)
 S $P(VEET("STATUS"),"^",3)="HEADING"
"RTN","%ZVEMGU",66,0)
 W !!?1,"VGL . . . Victory Global Lister . . . . . . . . . . . . . . . . David Bolduc"
"RTN","%ZVEMGU",67,0)
 W !?1,"<SPACE>=File Name/Number   Global*=List   ?=Help"
"RTN","%ZVEMGU",68,0)
 Q
"RTN","%ZVEMGUM")
0^40^B7165094
"RTN","%ZVEMGUM",1,0)
%ZVEMGUM ;DJB,VGL**Scroll Messages [2/24/99 10:39am]
"RTN","%ZVEMGUM",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMGUM",3,0)
 ;
"RTN","%ZVEMGUM",4,0)
MSG(NUM,PAUSE) ;Messages
"RTN","%ZVEMGUM",5,0)
 ;NUM=Subroutine number  PAUSE=Pause screen
"RTN","%ZVEMGUM",6,0)
 Q:$G(NUM)'>0
"RTN","%ZVEMGUM",7,0)
 S DX=0,DY=VEET("S2")+VEET("FT")-2
"RTN","%ZVEMGUM",8,0)
 D CURSOR^%ZVEMKU1(DX,DY,1),@NUM
"RTN","%ZVEMGUM",9,0)
 S DX=0,DY=DY+1 I $G(PAUSE) X VEES("CRSR") D PAUSE^%ZVEMKU(0)
"RTN","%ZVEMGUM",10,0)
 Q
"RTN","%ZVEMGUM",11,0)
 ;====================================================================
"RTN","%ZVEMGUM",12,0)
1 W $C(7),"Enter number from left hand column." Q
"RTN","%ZVEMGUM",13,0)
2 W $C(7),"This node is not viewable." Q
"RTN","%ZVEMGUM",14,0)
3 W $C(7),"Node not viewable. Isn't in standard Fileman format." Q
"RTN","%ZVEMGUM",15,0)
4 W $C(7),"You don't have access. See Help option." Q
"RTN","%ZVEMGUM",16,0)
5 W $C(7),"You can't use this option while reverse video is active." Q
"RTN","%ZVEMGUM",17,0)
6 W $C(7),"No editing while ",$S($G(FLAGVPE)["VEDD":"VEDD",1:"VRR")," is running" Q
"RTN","%ZVEMGUM",18,0)
7 W $C(7),"You can't edit in an alternate session." Q
"RTN","%ZVEMGUM",19,0)
8 W $C(7),"You're already doing a code search!?" Q
"RTN","%ZVEMGUM",20,0)
9 W $C(7),"There is no data to be searched" Q
"RTN","%ZVEMGUM",21,0)
10 W $C(7),"Only 1 Alternate Session allowed." Q
"RTN","%ZVEMGUM",22,0)
11 W $C(7),"No Alternate Session allowed when ",$S($G(FLAGVPE)["VEDD":"VEDD",1:"VRR")," is running" Q
"RTN","%ZVEMGUM",23,0)
12 W $C(7),"Invalid. This node already exists." Q
"RTN","%ZVEMGUM",24,0)
13 W $C(7),"Subscript is greater than 127 characters" Q
"RTN","%ZVEMGUM",25,0)
14 W $C(7),"You may not edit a null node" Q
"RTN","%ZVEMGUM",26,0)
15 W $C(7),"Invalid selection ('%' Node)." Q
"RTN","%ZVEMGUM",27,0)
16 W $C(7),"Invalid selection (File of files not viewable)." Q
"RTN","%ZVEMGUM",28,0)
17 W $C(7),"This is not a valid node." Q
"RTN","%ZVEMGUM",29,0)
18 W $C(7),"VA Filemanager must be present to run this option." Q
"RTN","%ZVEMGUM",30,0)
19 W "Enter number from left hand column, or a range of numbers (Ex: 3-5)" Q
"RTN","%ZVEMGUM",31,0)
20 W $C(7),"Invalid range" Q
"RTN","%ZVEMGUM",32,0)
21 W "Enter new node to hold SAved code. Hit <TAB> to quit." Q
"RTN","%ZVEMGUM",33,0)
22 W $C(7),"No code has been saved." Q
"RTN","%ZVEMGUM",34,0)
23 W $C(7),"You may NOT edit the subscript of a node that has decendents" Q
"RTN","%ZVEMGUM",35,0)
24 W "After editing a range of nodes, exit and reenter VGL to see your changes." Q
"RTN","%ZVEMGUM",36,0)
25 W "No control characters found." Q
"RTN","%ZVEMGUM",37,0)
26 W "This node has control characters. Use SC to strip them out before editing." Q
"RTN","%ZVEMGY")
0^41^B5986665
"RTN","%ZVEMGY",1,0)
%ZVEMGY ;DJB,VGL**Init,Partition,Branching,Error ; 10/11/03 2:25pm
"RTN","%ZVEMGY",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMGY",3,0)
 ;
"RTN","%ZVEMGY",4,0)
INIT ;Initialize variables
"RTN","%ZVEMGY",5,0)
 S GLS=$S($G(GLS)=1:GLS+1,1:1) ;GLS is the current session number.
"RTN","%ZVEMGY",6,0)
 S ^%ZVEMS("%",$J_$G(^%ZVEMS("SY")),"GLS")=GLS ;Protect GLS variable
"RTN","%ZVEMGY",7,0)
 S ZDELIM=$C(127)_$C(124) ;Commas
"RTN","%ZVEMGY",8,0)
 S ZDELIM1=$C(127)_$C(126) ;Spaces
"RTN","%ZVEMGY",9,0)
 S ZDELIM2=$C(127)_$C(64) ;Colons
"RTN","%ZVEMGY",10,0)
 I $D(VEE("OS"))#2=0 D OS^%ZVEMKY Q:FLAGQ
"RTN","%ZVEMGY",11,0)
 I $D(VEE("$ZE"))#2=0 D ZE^%ZVEMKY1
"RTN","%ZVEMGY",12,0)
 I $D(VEE("TRMON"))#2=0 D TRMREAD^%ZVEMKY1
"RTN","%ZVEMGY",13,0)
 D REVVID^%ZVEMKY2
"RTN","%ZVEMGY",14,0)
 D INIT^%ZVEMKY
"RTN","%ZVEMGY",15,0)
 Q
"RTN","%ZVEMGY",16,0)
VEDD ;Call VEDD, VElectronic Data Dictionary
"RTN","%ZVEMGY",17,0)
 I $G(FLAGVPE)["VEDD" D  D PAUSE Q
"RTN","%ZVEMGY",18,0)
 . W $C(7),!?1,"You are already running VEDD."
"RTN","%ZVEMGY",19,0)
 I GLS>1 D  D PAUSE Q
"RTN","%ZVEMGY",20,0)
 . W $C(7),!?1,"You may not call VEDD from an Alternate session."
"RTN","%ZVEMGY",21,0)
 I $T(^%ZVEMD)']"" D  D PAUSE Q
"RTN","%ZVEMGY",22,0)
 . W $C(7),!?1,"You do not have ^%ZVEMD routine on your system."
"RTN","%ZVEMGY",23,0)
 I $G(FLAGVPE)["VRR" D  D PAUSE Q
"RTN","%ZVEMGY",24,0)
 . W $C(7),!?1,"You can't call VEDD when VRR is running."
"RTN","%ZVEMGY",25,0)
 I '$$EXIST^%ZVEMKU("%ZVEMD") D  D PAUSE Q
"RTN","%ZVEMGY",26,0)
 . W $C(7),!?1,"You don't have the 'VEDD' routines."
"RTN","%ZVEMGY",27,0)
 D SYMTAB^%ZVEMKST("C","VGL",GLS) ;Clear symbol table
"RTN","%ZVEMGY",28,0)
 D ^%ZVEMD
"RTN","%ZVEMGY",29,0)
 D SYMTAB^%ZVEMKST("R","VGL",GLS) ;Restore symbol table
"RTN","%ZVEMGY",30,0)
 Q
"RTN","%ZVEMGY",31,0)
PAUSE ;Pause screen
"RTN","%ZVEMGY",32,0)
 Q:$E($G(VEEIOST),1,2)="P-"  D PAUSE^%ZVEMKU(2)
"RTN","%ZVEMGY",33,0)
 Q
"RTN","%ZVEMGY",34,0)
ERROR ;Normal error trap.
"RTN","%ZVEMGY",35,0)
 NEW ZE
"RTN","%ZVEMGY",36,0)
 S @("ZE="_VEE("$ZE"))
"RTN","%ZVEMGY",37,0)
 I '$D(GLS) S GLS=$G(^%ZVEMS("%",$J_$G(^%ZVEMS("SY")),"GLS"))
"RTN","%ZVEMGY",38,0)
 KILL ^TMP("VEE","IG"_GLS,$J)
"RTN","%ZVEMGY",39,0)
 KILL ^TMP("VEE","VGL"_GLS,$J),^TMP("VEE",$J)
"RTN","%ZVEMGY",40,0)
 S GLS=GLS-1
"RTN","%ZVEMGY",41,0)
 S ^%ZVEMS("%",$J_$G(^%ZVEMS("SY")),"GLS")=GLS
"RTN","%ZVEMGY",42,0)
 I $G(VEET("STATUS"))["START" D ENDSCR^%ZVEMKT2 ;Reset scroll region back to full screen
"RTN","%ZVEMGY",43,0)
 S FLAGQ=1 I ZE["<INRPT>" W !!?1,"....Interrupted.",!! Q
"RTN","%ZVEMGY",44,0)
 D ERRMSG^%ZVEMKU1("VGL")
"RTN","%ZVEMGY",45,0)
 I $G(FLAGVPE)["VEDD"!($G(FLAGVPE)["VRR") D PAUSE^%ZVEMKU(2)
"RTN","%ZVEMGY",46,0)
 Q
"RTN","%ZVEMGY",47,0)
ERROR1 ;Error Trap when testing validity of CODE.
"RTN","%ZVEMGY",48,0)
 W $C(7),!!?5,"There is an error in your code. Remember, you must set $T with"
"RTN","%ZVEMGY",49,0)
 W !?5,"an IF statement.",!
"RTN","%ZVEMGY",50,0)
 G CODE1^%ZVEMGO
"RTN","%ZVEMKC")
0^42^B5704374
"RTN","%ZVEMKC",1,0)
%ZVEMKC ;DJB,KRN**Select Choices ; 12/20/00 8:23am
"RTN","%ZVEMKC",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMKC",3,0)
 ;
"RTN","%ZVEMKC",4,0)
CHOICE(OPTIONS,LEV,DX,DY) ;
"RTN","%ZVEMKC",5,0)
 ;;OPTIONS=String containing options. Ex: "YES^NO"
"RTN","%ZVEMKC",6,0)
 ;;LEV=Number of option to be highlighted
"RTN","%ZVEMKC",7,0)
 ;;DX,DY=Pass DX&DY to place prompts on the screen
"RTN","%ZVEMKC",8,0)
 ;
"RTN","%ZVEMKC",9,0)
 I $G(OPTIONS)']"" Q 0
"RTN","%ZVEMKC",10,0)
 NEW ALLCAPS,ANS,FLAGQ,I,LIMIT,PIECE,VEES,X
"RTN","%ZVEMKC",11,0)
 S FLAGQ=0 D INIT Q:FLAGQ
"RTN","%ZVEMKC",12,0)
 D LOCATION
"RTN","%ZVEMKC",13,0)
 X VEES("RM0")
"RTN","%ZVEMKC",14,0)
 W @VEES("COFF")
"RTN","%ZVEMKC",15,0)
 D LOOP
"RTN","%ZVEMKC",16,0)
 W @VEES("CON")
"RTN","%ZVEMKC",17,0)
 Q LEV
"RTN","%ZVEMKC",18,0)
 ;
"RTN","%ZVEMKC",19,0)
LOCATION ;Starting location for each piece
"RTN","%ZVEMKC",20,0)
 F I=1:1 S X=$P(OPTIONS,"^",I) Q:X=""  D
"RTN","%ZVEMKC",21,0)
 . S PIECE(I)=X
"RTN","%ZVEMKC",22,0)
 . S ALLCAPS(I)=$$ALLCAPS^%ZVEMKU(X)
"RTN","%ZVEMKC",23,0)
 . I I=1 S DX(I)=(DX+2) Q
"RTN","%ZVEMKC",24,0)
 . S DX(I)=(DX(I-1)+$L(PIECE(I-1))+2)
"RTN","%ZVEMKC",25,0)
 S LIMIT=(I-1)
"RTN","%ZVEMKC",26,0)
 Q
"RTN","%ZVEMKC",27,0)
 ;
"RTN","%ZVEMKC",28,0)
LOOP ;Get users response
"RTN","%ZVEMKC",29,0)
 D DRAW
"RTN","%ZVEMKC",30,0)
 S ANS=$$READ^%ZVEMKRN("",1,1)
"RTN","%ZVEMKC",31,0)
 I VEE("K")="<RET>" Q
"RTN","%ZVEMKC",32,0)
 I ANS="^"!(",<ESC>,<F1E>,<F1Q>,<TO>,"[(","_VEE("K")_",")) S LEV=0 Q
"RTN","%ZVEMKC",33,0)
 I VEE("K")="<AL>" S LEV=LEV-1 S:LEV<1 LEV=1 G LOOP
"RTN","%ZVEMKC",34,0)
 I VEE("K")="<AR>" S LEV=LEV+1 S:LEV>LIMIT LEV=LIMIT G LOOP
"RTN","%ZVEMKC",35,0)
 I ANS=" " S LEV=LEV+1 S:LEV>LIMIT LEV=1 G LOOP
"RTN","%ZVEMKC",36,0)
 S ANS=$$ALLCAPS^%ZVEMKU(ANS)
"RTN","%ZVEMKC",37,0)
 F I=1:1:LIMIT I I'=LEV,ANS=$E(ALLCAPS(I),1) S LEV=I Q
"RTN","%ZVEMKC",38,0)
 G LOOP
"RTN","%ZVEMKC",39,0)
 ;
"RTN","%ZVEMKC",40,0)
DRAW ;Display options
"RTN","%ZVEMKC",41,0)
 F I=1:1:LIMIT S DX=DX(I) X VEES("CRSR") D  ;
"RTN","%ZVEMKC",42,0)
 . I I=LEV W @VEE("RON") X VEES("XY")
"RTN","%ZVEMKC",43,0)
 . W PIECE(I) W:I=LEV @VEE("ROFF")
"RTN","%ZVEMKC",44,0)
 Q
"RTN","%ZVEMKC",45,0)
 ;
"RTN","%ZVEMKC",46,0)
INIT ;
"RTN","%ZVEMKC",47,0)
 NEW L,TMP
"RTN","%ZVEMKC",48,0)
 I '$D(VEE("OS")) D OS^%ZVEMKY Q:FLAGQ
"RTN","%ZVEMKC",49,0)
 D SCRNVAR^%ZVEMKY2
"RTN","%ZVEMKC",50,0)
 D REVVID^%ZVEMKY2
"RTN","%ZVEMKC",51,0)
 D CRSROFF^%ZVEMKY2
"RTN","%ZVEMKC",52,0)
 S:$G(LEV)'>0 LEV=1
"RTN","%ZVEMKC",53,0)
 S L=$L(OPTIONS)+(2*$L(OPTIONS,"^"))-(1*($L(OPTIONS,"^")-1))
"RTN","%ZVEMKC",54,0)
 S L=VEE("IOM")-1-L
"RTN","%ZVEMKC",55,0)
 I $G(DX)>0 S:DX>L DX=0 I 1
"RTN","%ZVEMKC",56,0)
 E  S DX=$S($X>L:0,1:$X)
"RTN","%ZVEMKC",57,0)
 S TMP=$S($G(VEE("IOSL")):(VEE("IOSL")-1),1:23)
"RTN","%ZVEMKC",58,0)
 I $G(DY)>0 S:DY>TMP DY=TMP I 1
"RTN","%ZVEMKC",59,0)
 E  S DY=$S($Y>TMP:TMP,1:$Y)
"RTN","%ZVEMKC",60,0)
 Q
"RTN","%ZVEMKC",61,0)
 ;
"RTN","%ZVEMKC",62,0)
PAUSE(LF) ;LF=# of line feeds
"RTN","%ZVEMKC",63,0)
 NEW X
"RTN","%ZVEMKC",64,0)
 F X=1:1:+$G(LF) W !
"RTN","%ZVEMKC",65,0)
 S X=$$CHOICE("<RETURN>",1)
"RTN","%ZVEMKC",66,0)
 Q
"RTN","%ZVEMKC",67,0)
 ;
"RTN","%ZVEMKC",68,0)
PAUSEQ(LF) ;LF=# of line feeds
"RTN","%ZVEMKC",69,0)
 NEW X
"RTN","%ZVEMKC",70,0)
 F X=1:1:+$G(LF) W !
"RTN","%ZVEMKC",71,0)
 S:$$CHOICE("CONTINUE^QUIT",1)'=1 FLAGQ=1
"RTN","%ZVEMKC",72,0)
 Q
"RTN","%ZVEMKC",73,0)
 ;
"RTN","%ZVEMKC",74,0)
PAUSEQE(LF) ;LF=# of line feeds
"RTN","%ZVEMKC",75,0)
 NEW X
"RTN","%ZVEMKC",76,0)
 F X=1:1:+$G(LF) W !
"RTN","%ZVEMKC",77,0)
 S X=$$CHOICE("CONTINUE^QUIT^EXIT",1)
"RTN","%ZVEMKC",78,0)
 S:X'=1 FLAGQ=1
"RTN","%ZVEMKC",79,0)
 S:X=3 FLAGE=1
"RTN","%ZVEMKC",80,0)
 Q
"RTN","%ZVEMKDT")
0^43^B3570788
"RTN","%ZVEMKDT",1,0)
%ZVEMKDT ;DJB,KRN**Date/Time [12/30/95 9:15am]
"RTN","%ZVEMKDT",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMKDT",3,0)
 ;
"RTN","%ZVEMKDT",4,0)
 W !!?1,"Calling points: S DATE=$$DATE^%ZVEMKDT(1|2|3)"
"RTN","%ZVEMKDT",5,0)
 W !?1,"                S FMDATE=$$FMDATE^%ZVEMKDT()"
"RTN","%ZVEMKDT",6,0)
 W !?1,"                S TIME=$$TIME^%ZVEMKDT(1|2|3)",!
"RTN","%ZVEMKDT",7,0)
 Q
"RTN","%ZVEMKDT",8,0)
DATE(TYPE) ;TYPE=1 20-MAY-95   TYPE=2 3/5/95  TYPE=3 03/05/95
"RTN","%ZVEMKDT",9,0)
 NEW DATE,DAY,H,I,LEAPYR,MONTH,MONTHNAM,R,YR
"RTN","%ZVEMKDT",10,0)
 S:",1,2,3,"'[(","_$G(TYPE)_",") TYPE=1
"RTN","%ZVEMKDT",11,0)
 S MONTHNAM="JAN FEB MAR APR MAY JUN JUL AUG SEP OCT NOV DEC"
"RTN","%ZVEMKDT",12,0)
 S H=+$H,H=H>21914+H
"RTN","%ZVEMKDT",13,0)
 S LEAPYR=H\1461,R=H#1461,YR=LEAPYR*4+1841+(R\365),DAY=R#365,MONTH=1
"RTN","%ZVEMKDT",14,0)
 I R=1460,LEAPYR'=14 S DAY=365,YR=YR-1
"RTN","%ZVEMKDT",15,0)
 F I=31,(R>1154)&(LEAPYR'=14)+28,31,30,31,30,31,31,30,31,30 Q:I'<DAY  S MONTH=MONTH+1,DAY=DAY-I
"RTN","%ZVEMKDT",16,0)
 I DAY=0 S YR=YR-1,MONTH=12,DAY=31
"RTN","%ZVEMKDT",17,0)
 I TYPE=1 S DATE=DAY_"-"_$P(MONTHNAM," ",MONTH)_"-"_$E(YR,3,4)
"RTN","%ZVEMKDT",18,0)
 I TYPE=2 S DATE=MONTH_"/"_DAY_"/"_$E(YR,3,4)
"RTN","%ZVEMKDT",19,0)
 I TYPE=3 D  S DATE=MONTH_"/"_DAY_"/"_$E(YR,3,4)
"RTN","%ZVEMKDT",20,0)
 . I $L(MONTH)=1 S MONTH=0_MONTH
"RTN","%ZVEMKDT",21,0)
 . I $L(DAY)=1 S DAY=0_DAY
"RTN","%ZVEMKDT",22,0)
 Q DATE
"RTN","%ZVEMKDT",23,0)
FMDATE() ;Returns current date in FM format
"RTN","%ZVEMKDT",24,0)
 NEW DATE,DAY,H,MONTH,YR
"RTN","%ZVEMKDT",25,0)
 S H=$H>21608+$H-.1,YR=H\365.25+141,H=H#365.25\1
"RTN","%ZVEMKDT",26,0)
 S DAY=H+306#(YR#4=0+365)#153#61#31+1,MONTH=H-DAY\29+1
"RTN","%ZVEMKDT",27,0)
 S DATE=YR_"00"+MONTH_"00"+DAY
"RTN","%ZVEMKDT",28,0)
 Q DATE
"RTN","%ZVEMKDT",29,0)
TIME(TYPE) ;TYPE=1 3:42 PM   TYPE=2: 3:42pm  TYPE=3 15:42
"RTN","%ZVEMKDT",30,0)
 NEW I,MIN,N,NP,TIME
"RTN","%ZVEMKDT",31,0)
 S:",1,2,3,"'[(","_$G(TYPE)_",") TYPE=1
"RTN","%ZVEMKDT",32,0)
 S MIN=$P($H,",",2)\60
"RTN","%ZVEMKDT",33,0)
 S TIME=MIN\60_":"_(MIN#60\10)_(MIN#10)
"RTN","%ZVEMKDT",34,0)
 I $G(TYPE)=3 Q TIME
"RTN","%ZVEMKDT",35,0)
 S N=" AM" S:MIN'<720 MIN=MIN-720,N=" PM" S:MIN<60 MIN=MIN+720
"RTN","%ZVEMKDT",36,0)
 I $G(TYPE)=2 S N=$TR(N,"AMPM ","ampm")
"RTN","%ZVEMKDT",37,0)
 S I=MIN\600 S:'I I=" "
"RTN","%ZVEMKDT",38,0)
 S TIME=I_(MIN\60#10)_":"_$S($L(MIN#60)=1:0,1:"")_(MIN#60)_N
"RTN","%ZVEMKDT",39,0)
 Q TIME
"RTN","%ZVEMKE")
0^44^B2692713
"RTN","%ZVEMKE",1,0)
%ZVEMKE ;DJB,KRN**Line Editor [9/9/95 2:43pm]
"RTN","%ZVEMKE",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMKE",3,0)
 ;
"RTN","%ZVEMKE",4,0)
EDIT(PROMPT) ;Calling point for VPE modules
"RTN","%ZVEMKE",5,0)
 S PROMPT=$G(PROMPT)
"RTN","%ZVEMKE",6,0)
 I $G(^%ZVEMS("E","EDIT",DUZ))="LINE" D LINE(PROMPT) Q
"RTN","%ZVEMKE",7,0)
 D SCREEN^%ZVEMKEA(PROMPT,1,VEE("IOM")-2)
"RTN","%ZVEMKE",8,0)
 Q
"RTN","%ZVEMKE",9,0)
 ;===========================Line Editor=============================
"RTN","%ZVEMKE",10,0)
LINE(PROMPT) ;Line Editor
"RTN","%ZVEMKE",11,0)
 NEW CHK,CHK1,NEW,OLD,TEMP,TEMP1
"RTN","%ZVEMKE",12,0)
 I $G(CD)']"" W $C(7),!!?1,"Variable CD must contain string to be edited.",! Q
"RTN","%ZVEMKE",13,0)
LINE1 ;
"RTN","%ZVEMKE",14,0)
 W !!,$G(PROMPT),CD
"RTN","%ZVEMKE",15,0)
 R !!?1,"Replace: ",OLD:600 Q:OLD=""  S:OLD="end" OLD="END"
"RTN","%ZVEMKE",16,0)
 I OLD="..." S OLD=CD
"RTN","%ZVEMKE",17,0)
 I OLD?.E1"...".E S TEMP=$P(OLD,"..."),TEMP1=$P(OLD,"...",2) D  I CD'[OLD!CHK1 D MSG1 G LINE1
"RTN","%ZVEMKE",18,0)
 . S CHK1=0 S:TEMP]""&(CD'[TEMP) CHK1=1 S:TEMP1]""&(CD'[TEMP1) CHK1=1 Q:CHK1
"RTN","%ZVEMKE",19,0)
 . I TEMP="" S OLD=$E(CD,1,($F(CD,TEMP1)-1)) Q
"RTN","%ZVEMKE",20,0)
 . I TEMP1="" S OLD=$E(CD,($F(CD,TEMP)-$L(TEMP)),$L(CD)) Q
"RTN","%ZVEMKE",21,0)
 . S CHK=$F(CD,TEMP),OLD=$E(CD,(CHK-$L(TEMP)),($F(CD,TEMP1,CHK)-1))
"RTN","%ZVEMKE",22,0)
 I OLD'="END",CD'[OLD D MSG1 G LINE1
"RTN","%ZVEMKE",23,0)
 R !?1,"With: ",NEW:600 Q:'$T
"RTN","%ZVEMKE",24,0)
 I $L(CD_NEW)>244 D MSG2 G LINE1
"RTN","%ZVEMKE",25,0)
 S CD=$S(OLD="END":CD_NEW,1:$P(CD,OLD)_NEW_$P(CD,OLD,2,999))
"RTN","%ZVEMKE",26,0)
 Q:CD']""  G LINE1
"RTN","%ZVEMKE",27,0)
MSG1 W $C(7),!!?2,"No match" Q
"RTN","%ZVEMKE",28,0)
MSG2 W $C(7),!!?2,"Code length may not exceed 245" Q
"RTN","%ZVEMKEA")
0^45^B6796846
"RTN","%ZVEMKEA",1,0)
%ZVEMKEA ;DJB,KRN**Screen Mode Line Editor ; 11/14/02 6:56am
"RTN","%ZVEMKEA",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMKEA",3,0)
 ;
"RTN","%ZVEMKEA",4,0)
SCREEN(PROMPT,LMAR,RMAR) ;Edit a line of text
"RTN","%ZVEMKEA",5,0)
 ;PROMPT = Prompt
"RTN","%ZVEMKEA",6,0)
 ;LMAR=Left Margin
"RTN","%ZVEMKEA",7,0)
 ;RMAR=Right Margin
"RTN","%ZVEMKEA",8,0)
 ;
"RTN","%ZVEMKEA",9,0)
 NEW DX,DY,FLAGQ,I,START,WIDTH,X,XCHAR,XCUR,YCNT,YCUR
"RTN","%ZVEMKEA",10,0)
 NEW:'$D(VEES) VEES
"RTN","%ZVEMKEA",11,0)
 ;
"RTN","%ZVEMKEA",12,0)
 S FLAGQ=0
"RTN","%ZVEMKEA",13,0)
 D INIT Q:FLAGQ
"RTN","%ZVEMKEA",14,0)
 X VEES("RM0")
"RTN","%ZVEMKEA",15,0)
 W ! D LISTCD
"RTN","%ZVEMKEA",16,0)
 D SETUP
"RTN","%ZVEMKEA",17,0)
 F  D READ Q:X="QUIT"
"RTN","%ZVEMKEA",18,0)
EX ;
"RTN","%ZVEMKEA",19,0)
 ;Reposition cursor to bottom line
"RTN","%ZVEMKEA",20,0)
 I YCUR<YCNT F I=1:1:(YCNT-YCUR) W !
"RTN","%ZVEMKEA",21,0)
 X VEES("RM80")
"RTN","%ZVEMKEA",22,0)
 Q
"RTN","%ZVEMKEA",23,0)
 ;
"RTN","%ZVEMKEA",24,0)
READ ;
"RTN","%ZVEMKEA",25,0)
 S X=$$READ^%ZVEMKRN("",1),VEESHC=$G(VEE("K"))
"RTN","%ZVEMKEA",26,0)
 I ",<ESC>,<F1E>,<F1Q>,<TO>,"[(","_VEESHC_",") S X="QUIT" Q
"RTN","%ZVEMKEA",27,0)
 I ",<AU>,<AD>,<AR>,<AL>,"[(","_VEESHC_",") D ARROW^%ZVEMKEC Q
"RTN","%ZVEMKEA",28,0)
 I ",<F1AL>,<F1AR>,<F2AL>,<F2AR>,"[(","_VEESHC_",") D OTHER^%ZVEMKEC Q
"RTN","%ZVEMKEA",29,0)
 I ",<BS>,<DEL>,"[(","_VEESHC_",") D  D DELETE^%ZVEMKEB Q
"RTN","%ZVEMKEA",30,0)
 . S:$G(VEE("BS"))="SAME" VEESHC="<BS>"
"RTN","%ZVEMKEA",31,0)
 I VEESHC?1"<".E1">".E S X="QUIT" Q
"RTN","%ZVEMKEA",32,0)
 D INSERT^%ZVEMKEB
"RTN","%ZVEMKEA",33,0)
 Q
"RTN","%ZVEMKEA",34,0)
 ;
"RTN","%ZVEMKEA",35,0)
LISTCD ;Print Code with controlled wrapping.
"RTN","%ZVEMKEA",36,0)
 NEW TEMP
"RTN","%ZVEMKEA",37,0)
 S TEMP=CD
"RTN","%ZVEMKEA",38,0)
 I TEMP?.E1C.E S TEMP=$$CC(TEMP) ;Control characters
"RTN","%ZVEMKEA",39,0)
 W ?LMAR,PROMPT
"RTN","%ZVEMKEA",40,0)
 W ?START,$E(TEMP,1,WIDTH)
"RTN","%ZVEMKEA",41,0)
 S TEMP=$E(TEMP,WIDTH+1,999)
"RTN","%ZVEMKEA",42,0)
LISTCD1 ;Print remainder of line
"RTN","%ZVEMKEA",43,0)
 I TEMP="" Q
"RTN","%ZVEMKEA",44,0)
 W !?START,$E(TEMP,1,WIDTH)
"RTN","%ZVEMKEA",45,0)
 S TEMP=$E(TEMP,WIDTH+1,999)
"RTN","%ZVEMKEA",46,0)
 G LISTCD1
"RTN","%ZVEMKEA",47,0)
 ;
"RTN","%ZVEMKEA",48,0)
SETUP ;Set up starting values.
"RTN","%ZVEMKEA",49,0)
 F YCNT=1:1 Q:$L(CD)<(YCNT*WIDTH+1)
"RTN","%ZVEMKEA",50,0)
 S XCHAR=$L(CD)+1
"RTN","%ZVEMKEA",51,0)
 S XCUR=$X
"RTN","%ZVEMKEA",52,0)
 S YCUR=YCNT
"RTN","%ZVEMKEA",53,0)
 ;
"RTN","%ZVEMKEA",54,0)
 ;If CD is exactly the screen width move the cursor to next line.
"RTN","%ZVEMKEA",55,0)
 I $L(CD)>0,$L(CD)#WIDTH=0 D  ;
"RTN","%ZVEMKEA",56,0)
 . S YCUR=YCUR+1
"RTN","%ZVEMKEA",57,0)
 . S XCUR=START
"RTN","%ZVEMKEA",58,0)
 . W ! Q:START'>0
"RTN","%ZVEMKEA",59,0)
 . W $C(27)_"["_START_"C"
"RTN","%ZVEMKEA",60,0)
 . D RESETY
"RTN","%ZVEMKEA",61,0)
 Q
"RTN","%ZVEMKEA",62,0)
 ;
"RTN","%ZVEMKEA",63,0)
CC(TXT) ;Control characters
"RTN","%ZVEMKEA",64,0)
 ;Substitute a 'c' for any control characters.
"RTN","%ZVEMKEA",65,0)
 ;
"RTN","%ZVEMKEA",66,0)
 NEW I
"RTN","%ZVEMKEA",67,0)
 I $G(TXT)']"" Q ""
"RTN","%ZVEMKEA",68,0)
 F I=1:1:$L(TXT) I $E(TXT,I)?.E1C.E D  ;
"RTN","%ZVEMKEA",69,0)
 . S TXT=$E(TXT,1,I-1)_"c"_$E(TXT,I+1,9999)
"RTN","%ZVEMKEA",70,0)
 Q TXT
"RTN","%ZVEMKEA",71,0)
 ;
"RTN","%ZVEMKEA",72,0)
RESETY ;Reset $Y
"RTN","%ZVEMKEA",73,0)
 NEW VEEY
"RTN","%ZVEMKEA",74,0)
 S VEEY=(VEE("IOSL")-1)
"RTN","%ZVEMKEA",75,0)
 S DX=0,DY=$S($Y>VEEY:VEEY,1:$Y) X VEES("XY")
"RTN","%ZVEMKEA",76,0)
 Q
"RTN","%ZVEMKEA",77,0)
 ;
"RTN","%ZVEMKEA",78,0)
INIT ;
"RTN","%ZVEMKEA",79,0)
 I '$D(VEE("OS")) D OS^%ZVEMKY Q:FLAGQ
"RTN","%ZVEMKEA",80,0)
 I '$D(VEE("IOM")) D IO^%ZVEMKY
"RTN","%ZVEMKEA",81,0)
 D SCRNVAR^%ZVEMKY2
"RTN","%ZVEMKEA",82,0)
 D CRSRMOVE^%ZVEMKY2
"RTN","%ZVEMKEA",83,0)
 D CRSRSAVE^%ZVEMKY2
"RTN","%ZVEMKEA",84,0)
 D BLANK^%ZVEMKY3
"RTN","%ZVEMKEA",85,0)
 S CD=$G(CD),PROMPT=$G(PROMPT),LMAR=$G(LMAR),RMAR=$G(RMAR)
"RTN","%ZVEMKEA",86,0)
 S:LMAR'>0!(LMAR>(VEE("IOM")-5)) LMAR=0
"RTN","%ZVEMKEA",87,0)
 S:RMAR'>LMAR!(RMAR>VEE("IOM")) RMAR=VEE("IOM")-1
"RTN","%ZVEMKEA",88,0)
 S START=LMAR+$L(PROMPT)
"RTN","%ZVEMKEA",89,0)
 S WIDTH=RMAR-START
"RTN","%ZVEMKEA",90,0)
 D RESETY
"RTN","%ZVEMKEA",91,0)
 Q
"RTN","%ZVEMKEB")
0^46^B5376375
"RTN","%ZVEMKEB",1,0)
%ZVEMKEB ;DJB,KRN**INSERT,DELETE,PRINT ; 11/14/02 7:16am
"RTN","%ZVEMKEB",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMKEB",3,0)
 ;
"RTN","%ZVEMKEB",4,0)
INSERT ;Insert a character
"RTN","%ZVEMKEB",5,0)
 NEW VEEY
"RTN","%ZVEMKEB",6,0)
 S VEEY=(VEE("IOSL")-1)
"RTN","%ZVEMKEB",7,0)
 I $L(CD)>244 D  S VEESHC="TOO LONG",X="QUIT" Q  ;Tell calling routine line is too long.
"RTN","%ZVEMKEB",8,0)
 . I YCNT>YCUR W $C(27)_"["_(YCNT-YCUR)_"B" ;Move cursor to last line.
"RTN","%ZVEMKEB",9,0)
 . S DX=0,DY=$S($Y>VEEY:VEEY,1:$Y) X VEES("XY")
"RTN","%ZVEMKEB",10,0)
 . W $C(7),!!?3,"Line length may not exceed 245"
"RTN","%ZVEMKEB",11,0)
 I $L(CD)>0,$L(CD)#WIDTH=0 D  ;Allow for scroll at bottom of screen.
"RTN","%ZVEMKEB",12,0)
 . I YCNT>YCUR W $C(27)_"["_(YCNT-YCUR)_"B" ;Move cursor to last line.
"RTN","%ZVEMKEB",13,0)
 . W !,$C(27)_"["_(YCNT-YCUR+1)_"A" ;Linefeed,move cursor back up.
"RTN","%ZVEMKEB",14,0)
 . W $C(27)_"["_(XCUR+1)_"C" ;Move cursor right.
"RTN","%ZVEMKEB",15,0)
 S CD=$S(XCHAR=1:X_CD,1:$E(CD,1,XCHAR-1)_X_$E(CD,XCHAR,999))
"RTN","%ZVEMKEB",16,0)
 I XCHAR#WIDTH=0 S XCUR=START,YCUR=YCUR+1 D  I 1
"RTN","%ZVEMKEB",17,0)
 . W ! I START>0 W $C(27)_"["_START_"C" ;Cursor right
"RTN","%ZVEMKEB",18,0)
 E  S XCUR=XCUR+1
"RTN","%ZVEMKEB",19,0)
 S XCHAR=XCHAR+1 D PRINTL
"RTN","%ZVEMKEB",20,0)
 Q
"RTN","%ZVEMKEB",21,0)
DELETE ;Delete character
"RTN","%ZVEMKEB",22,0)
 ;---<DEL> key struck---
"RTN","%ZVEMKEB",23,0)
 I VEESHC="<DEL>" D  Q
"RTN","%ZVEMKEB",24,0)
 . S CD=$E(CD,1,XCHAR-1)_$E(CD,XCHAR+1,999) D PRINTL
"RTN","%ZVEMKEB",25,0)
 ;---<BS> key struck---
"RTN","%ZVEMKEB",26,0)
 Q:XCHAR=1  S XCHAR=XCHAR-1
"RTN","%ZVEMKEB",27,0)
 I XCHAR=1 S XCUR=XCUR-1,CD=$E(CD,2,999) W @VEES("CL") D PRINTL Q
"RTN","%ZVEMKEB",28,0)
 I XCHAR#WIDTH=0,YCUR>1 D  I 1
"RTN","%ZVEMKEB",29,0)
 . S XCUR=WIDTH+START-1,YCUR=YCUR-1
"RTN","%ZVEMKEB",30,0)
 . W @VEES("CU"),$C(27)_"["_(WIDTH-1)_"C"
"RTN","%ZVEMKEB",31,0)
 E  S XCUR=XCUR-1 W @VEES("CL")
"RTN","%ZVEMKEB",32,0)
 S CD=$E(CD,1,XCHAR-1)_$E(CD,XCHAR+1,999) D PRINTL
"RTN","%ZVEMKEB",33,0)
 Q
"RTN","%ZVEMKEB",34,0)
PRINTL ;Print Line
"RTN","%ZVEMKEB",35,0)
 NEW TEMP,VEEY
"RTN","%ZVEMKEB",36,0)
 S VEEY=(VEE("IOSL")-1)
"RTN","%ZVEMKEB",37,0)
 S TEMP=$E(CD,XCHAR,999)
"RTN","%ZVEMKEB",38,0)
 I TEMP?.E1C.E S TEMP=$$CC^%ZVEMKEA(TEMP) ;Control characters
"RTN","%ZVEMKEB",39,0)
 S DX=XCUR,DY=$S($Y>VEEY:VEEY,1:$Y)
"RTN","%ZVEMKEB",40,0)
 W @VEES("SC") ;Save cursor position
"RTN","%ZVEMKEB",41,0)
 W @VEES("BLANK_C_EOS") ;Blank screen
"RTN","%ZVEMKEB",42,0)
 X VEES("XY") ;Reset $X & $Y
"RTN","%ZVEMKEB",43,0)
 F YCNT=1:1 Q:$L(CD)<(YCNT*WIDTH+1)
"RTN","%ZVEMKEB",44,0)
 W $E(TEMP,1,WIDTH+START-XCUR)
"RTN","%ZVEMKEB",45,0)
 S TEMP=$E(TEMP,(WIDTH+START+1)-XCUR,999)
"RTN","%ZVEMKEB",46,0)
PRINTL1 ;Print remainder of line
"RTN","%ZVEMKEB",47,0)
 I TEMP="" W @VEES("RC") Q
"RTN","%ZVEMKEB",48,0)
 W !?START,$E(TEMP,1,WIDTH) S TEMP=$E(TEMP,WIDTH+1,999)
"RTN","%ZVEMKEB",49,0)
 G PRINTL1
"RTN","%ZVEMKEC")
0^47^B6325382
"RTN","%ZVEMKEC",1,0)
%ZVEMKEC ;DJB,KRN**ARROW,OTHER [02/14/95]
"RTN","%ZVEMKEC",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMKEC",3,0)
 ;
"RTN","%ZVEMKEC",4,0)
ARROW ;Process arrow keys
"RTN","%ZVEMKEC",5,0)
 NEW I D @$E(VEESHC,2,$L(VEESHC)-1)
"RTN","%ZVEMKEC",6,0)
 Q
"RTN","%ZVEMKEC",7,0)
AR ;Arrow right
"RTN","%ZVEMKEC",8,0)
 I $G(FLAGCLH)="CLH"!($G(FLAGCLH)=">>"),CD']"" S X="QUIT" Q
"RTN","%ZVEMKEC",9,0)
 Q:XCHAR>$L(CD)
"RTN","%ZVEMKEC",10,0)
 I XCHAR#WIDTH=0 S XCHAR=XCHAR+1,XCUR=START,YCUR=YCUR+1 W ! W:START>0 $C(27)_"["_START_"C" Q
"RTN","%ZVEMKEC",11,0)
 S XCHAR=XCHAR+1,XCUR=XCUR+1 W @VEES("CR")
"RTN","%ZVEMKEC",12,0)
 Q
"RTN","%ZVEMKEC",13,0)
AL ;Arrow left. FLAGCLH allows left arrow to show last 20 CLH commands.
"RTN","%ZVEMKEC",14,0)
 I $G(FLAGCLH)="CLH"!($G(FLAGCLH)=">>"),CD']"" S X="QUIT" Q
"RTN","%ZVEMKEC",15,0)
 Q:XCHAR=1  S XCHAR=XCHAR-1
"RTN","%ZVEMKEC",16,0)
 I XCHAR#WIDTH=0 S XCUR=WIDTH+START-1,YCUR=YCUR-1 W @VEES("CU"),$C(27)_"["_(WIDTH-1)_"C" Q
"RTN","%ZVEMKEC",17,0)
 S XCUR=XCUR-1 W @VEES("CL")
"RTN","%ZVEMKEC",18,0)
 Q
"RTN","%ZVEMKEC",19,0)
AD ;Cursor down 1 line (Bottom)
"RTN","%ZVEMKEC",20,0)
 I $G(FLAGCLH)="CLH",XCHAR>$L(CD) S X="QUIT" Q
"RTN","%ZVEMKEC",21,0)
 I $G(FLAGCLH)=">>",CD']"" S X="QUIT" Q
"RTN","%ZVEMKEC",22,0)
 Q:YCUR=YCNT
"RTN","%ZVEMKEC",23,0)
 S YCUR=YCUR+1,XCHAR=XCHAR+WIDTH W @VEES("CD")
"RTN","%ZVEMKEC",24,0)
 I XCHAR>($L(CD)+1) F I=1:1:(XCHAR-($L(CD)+1)) W @VEES("CL") S XCHAR=XCHAR-1,XCUR=XCUR-1
"RTN","%ZVEMKEC",25,0)
 Q
"RTN","%ZVEMKEC",26,0)
AU ;Cursor up 1 line (Top)
"RTN","%ZVEMKEC",27,0)
 I $G(FLAGCLH)="CLH",XCHAR>$L(CD) S X="QUIT" Q
"RTN","%ZVEMKEC",28,0)
 I $G(FLAGCLH)=">>",CD']"" S X="QUIT" Q
"RTN","%ZVEMKEC",29,0)
 Q:YCUR=1
"RTN","%ZVEMKEC",30,0)
 S YCUR=YCUR-1,XCHAR=XCHAR-WIDTH W @VEES("CU")
"RTN","%ZVEMKEC",31,0)
 Q
"RTN","%ZVEMKEC",32,0)
OTHER ;<F1AL>,<F1AR>,<F2AL>,<F2AR>
"RTN","%ZVEMKEC",33,0)
 NEW I D @$E(VEESHC,2,$L(VEESHC)-1)
"RTN","%ZVEMKEC",34,0)
 Q
"RTN","%ZVEMKEC",35,0)
F1AL ;Cursor to beginning of line
"RTN","%ZVEMKEC",36,0)
 I $G(FLAGCLH)="CLH"!($G(FLAGCLH)=">>"),CD']"" S X="QUIT" Q
"RTN","%ZVEMKEC",37,0)
 Q:CD']""
"RTN","%ZVEMKEC",38,0)
 F I=1:1:YCUR-1 W @VEES("CU")
"RTN","%ZVEMKEC",39,0)
 F I=1:1:XCUR-START W @VEES("CL")
"RTN","%ZVEMKEC",40,0)
 S XCUR=START,YCUR=1,XCHAR=1
"RTN","%ZVEMKEC",41,0)
 Q
"RTN","%ZVEMKEC",42,0)
F1AR ;Cursor to end of line
"RTN","%ZVEMKEC",43,0)
 I $G(FLAGCLH)="CLH"!($G(FLAGCLH)=">>"),CD']"" S X="QUIT" Q
"RTN","%ZVEMKEC",44,0)
 Q:CD']""  Q:XCHAR=($L(CD)+1)
"RTN","%ZVEMKEC",45,0)
 I YCNT>YCUR W $C(27)_"["_(YCNT-YCUR)_"B" S YCUR=YCNT ;Cursor down
"RTN","%ZVEMKEC",46,0)
 S XCUR=(($L(CD)#WIDTH)+START)
"RTN","%ZVEMKEC",47,0)
 W *13 W:XCUR>0 $C(27)_"["_XCUR_"C" ;Cursor right
"RTN","%ZVEMKEC",48,0)
 I $L(CD)>0,$L(CD)#WIDTH=0 W @VEES("CD") S YCUR=YCUR+1 ;Line is width of screen.
"RTN","%ZVEMKEC",49,0)
 S XCHAR=$L(CD)+1
"RTN","%ZVEMKEC",50,0)
 Q
"RTN","%ZVEMKEC",51,0)
F2AL ;Cursor left 15
"RTN","%ZVEMKEC",52,0)
 I $G(FLAGCLH)="CLH"!($G(FLAGCLH)=">>"),CD']"" S X="QUIT" Q
"RTN","%ZVEMKEC",53,0)
 Q:CD']""
"RTN","%ZVEMKEC",54,0)
 I XCUR>(15+START) S XCUR=XCUR-15,XCHAR=XCHAR-15 W $C(27)_"[15D"
"RTN","%ZVEMKEC",55,0)
 Q
"RTN","%ZVEMKEC",56,0)
F2AR ;Cursor right 15
"RTN","%ZVEMKEC",57,0)
 I $G(FLAGCLH)="CLH"!($G(FLAGCLH)=">>"),CD']"" S X="QUIT" Q
"RTN","%ZVEMKEC",58,0)
 Q:CD']""
"RTN","%ZVEMKEC",59,0)
 I XCUR<(RMAR-15),($L(CD)-XCHAR)>14 S XCUR=XCUR+15,XCHAR=XCHAR+15 W $C(27)_"[15C"
"RTN","%ZVEMKEC",60,0)
 Q
"RTN","%ZVEMKI1")
0^48^B20221277
"RTN","%ZVEMKI1",1,0)
%ZVEMKI1 ;DJB,KRN**Indiv Fld DD ; 9/28/02 11:53am
"RTN","%ZVEMKI1",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMKI1",3,0)
 ;
"RTN","%ZVEMKI1",4,0)
INDIV(DD,FNUM) ;Individual Field Summary
"RTN","%ZVEMKI1",5,0)
 ;DD   = File number
"RTN","%ZVEMKI1",6,0)
 ;FNUM = Field number
"RTN","%ZVEMKI1",7,0)
 ;
"RTN","%ZVEMKI1",8,0)
 NEW I,NODE,STRING,Z1,ZA,ZB,ZD
"RTN","%ZVEMKI1",9,0)
 NEW C1,C2,C3,C4,C5,C6,C7
"RTN","%ZVEMKI1",10,0)
 ;
"RTN","%ZVEMKI1",11,0)
 D INIT
"RTN","%ZVEMKI1",12,0)
 D DISPLAY
"RTN","%ZVEMKI1",13,0)
EX ;Exit
"RTN","%ZVEMKI1",14,0)
 Q:FLAGQ!$G(FLAGP)
"RTN","%ZVEMKI1",15,0)
 F I=$Y:1:(VEESIZE+1) W !
"RTN","%ZVEMKI1",16,0)
 W !,$E(VEELINE,1,VEE("IOM"))
"RTN","%ZVEMKI1",17,0)
 Q
"RTN","%ZVEMKI1",18,0)
 ;
"RTN","%ZVEMKI1",19,0)
DISPLAY ;Display data dictionary for individual field
"RTN","%ZVEMKI1",20,0)
 I '$G(FLAGP) W @VEE("IOF"),!,$E(VEELINE,1,VEE("IOM"))
"RTN","%ZVEMKI1",21,0)
 I $G(FLAG)="XREF" D  Q:$$CHECK
"RTN","%ZVEMKI1",22,0)
 . W !?(VEE("IOM")-32\2),"*** You selected a Xref node ***"
"RTN","%ZVEMKI1",23,0)
 I $G(FLAG)="WP" D  Q:$$CHECK
"RTN","%ZVEMKI1",24,0)
 . W !?(VEE("IOM")-43\2),"*** You selected a Word Processing node ***"
"RTN","%ZVEMKI1",25,0)
 W !?C1,"FIELD NAME:",?C4,$P(NODE(0),U,1) Q:$$CHECK
"RTN","%ZVEMKI1",26,0)
 W ! Q:$$CHECK
"RTN","%ZVEMKI1",27,0)
 W !?C1,"FLD NUMBER:",?C4,FNUM
"RTN","%ZVEMKI1",28,0)
 W ?36,"FLD TITLE:  ",$G(^DD(DD,FNUM,.1))
"RTN","%ZVEMKI1",29,0)
 Q:$$CHECK
"RTN","%ZVEMKI1",30,0)
 W !?C1,"NODE;PIECE:"
"RTN","%ZVEMKI1",31,0)
 W ?C4,$S($P(NODE(0),U,4)=" ; ":"Computed",1:$P(NODE(0),U,4))
"RTN","%ZVEMKI1",32,0)
 W ?35,"HELP FRAME:  ",$G(^DD(DD,FNUM,22))
"RTN","%ZVEMKI1",33,0)
 Q:$$CHECK
"RTN","%ZVEMKI1",34,0)
 W ! Q:$$CHECK
"RTN","%ZVEMKI1",35,0)
 W !?C1,"    ACCESS:"
"RTN","%ZVEMKI1",36,0)
 W ?C4,"RD: ",$G(^(8))
"RTN","%ZVEMKI1",37,0)
 W "   ","DEL: ",$G(^(8.5)),"   "
"RTN","%ZVEMKI1",38,0)
 W "WR: ",$G(^(9))
"RTN","%ZVEMKI1",39,0)
 Q:$$CHECK
"RTN","%ZVEMKI1",40,0)
 ;
"RTN","%ZVEMKI1",41,0)
DATATYPE S ZD=$P(NODE(0),U,2) D DTYPE^%ZVEMKI2 Q:FLAGQ
"RTN","%ZVEMKI1",42,0)
 ;
"RTN","%ZVEMKI1",43,0)
VERIFY I FNUM=".01" D  Q:FLAGQ
"RTN","%ZVEMKI1",44,0)
 . NEW FLD,ND,UP
"RTN","%ZVEMKI1",45,0)
 . S UP=$G(^DD(DD,0,"UP")) Q:'UP
"RTN","%ZVEMKI1",46,0)
 . S FLD=$O(^DD(UP,"SB",DD,"")) Q:'FLD
"RTN","%ZVEMKI1",47,0)
 . S ND=$G(^DD(UP,FLD,0)) Q:ND']""
"RTN","%ZVEMKI1",48,0)
 . I $P(ND,U,2)["A" D  Q:$$CHECK
"RTN","%ZVEMKI1",49,0)
 .. W !?C4,"Do not ask for verification when entering new subentry"
"RTN","%ZVEMKI1",50,0)
 . I $P(ND,U,2)["M" D  Q:$$CHECK
"RTN","%ZVEMKI1",51,0)
 .. W !?C4,"After select/add subentry, ask for another subentry"
"RTN","%ZVEMKI1",52,0)
 ;
"RTN","%ZVEMKI1",53,0)
 ;--> Input Transform
"RTN","%ZVEMKI1",54,0)
 I $P(NODE(0),U,5)]"" D  Q:FLAGQ
"RTN","%ZVEMKI1",55,0)
 . W ! Q:$$CHECK
"RTN","%ZVEMKI1",56,0)
 . W !?C1,$S(ZD["C":"CODE CREATING X:",1:"INPUT TRANSFORM:")
"RTN","%ZVEMKI1",57,0)
 . S STRING=$P(NODE(0),U,5,99) D STRING^%ZVEMKI3
"RTN","%ZVEMKI1",58,0)
 ;
"RTN","%ZVEMKI1",59,0)
 ;--> Output Transform
"RTN","%ZVEMKI1",60,0)
 I NODE(2)]"" D  Q:FLAGQ
"RTN","%ZVEMKI1",61,0)
 . W ! Q:$$CHECK
"RTN","%ZVEMKI1",62,0)
 . W !?C1,"OUTPUT TRANSFORM:"
"RTN","%ZVEMKI1",63,0)
 . S STRING=NODE(2) D STRING^%ZVEMKI3
"RTN","%ZVEMKI1",64,0)
 ;
"RTN","%ZVEMKI1",65,0)
DELETE I $D(^DD(DD,FNUM,"DEL")) D  Q:FLAGQ
"RTN","%ZVEMKI1",66,0)
 . W ! Q:$$CHECK
"RTN","%ZVEMKI1",67,0)
 . W !?C1,"DELETE NODE(S):"
"RTN","%ZVEMKI1",68,0)
 . W ?C4,"If $T is set to 1, no deleting."
"RTN","%ZVEMKI1",69,0)
 . Q:$$CHECK
"RTN","%ZVEMKI1",70,0)
 . S ZA=""
"RTN","%ZVEMKI1",71,0)
 . F  S ZA=$O(^DD(DD,FNUM,"DEL",ZA)) Q:ZA=""  D  Q:FLAGQ
"RTN","%ZVEMKI1",72,0)
 .. W !?6,"Node: ",ZA
"RTN","%ZVEMKI1",73,0)
 .. S STRING=^DD(DD,FNUM,"DEL",ZA,0) D STRING^%ZVEMKI3
"RTN","%ZVEMKI1",74,0)
 ;
"RTN","%ZVEMKI1",75,0)
 I $D(^DD(DD,0,"ID",FNUM)) D  Q:FLAGQ
"RTN","%ZVEMKI1",76,0)
 . W ! Q:$$CHECK
"RTN","%ZVEMKI1",77,0)
 . W !?C1,"IDENTIFIER:"
"RTN","%ZVEMKI1",78,0)
 . S STRING=^DD(DD,0,"ID",FNUM) D STRING^%ZVEMKI3
"RTN","%ZVEMKI1",79,0)
 ;
"RTN","%ZVEMKI1",80,0)
PROMPT I NODE(3)]"" D  Q:FLAGQ
"RTN","%ZVEMKI1",81,0)
 . W ! Q:$$CHECK
"RTN","%ZVEMKI1",82,0)
 . W !?C1,"PROMPT MESSAGE:"
"RTN","%ZVEMKI1",83,0)
 . S STRING=NODE(3) D WORD^%ZVEMKI3
"RTN","%ZVEMKI1",84,0)
 . Q:$$CHECK
"RTN","%ZVEMKI1",85,0)
 ;
"RTN","%ZVEMKI1",86,0)
 I $G(NODE(4))]"" D  Q:FLAGQ
"RTN","%ZVEMKI1",87,0)
 . W ! Q:$$CHECK
"RTN","%ZVEMKI1",88,0)
 . W !?C1,"EXECUTABLE HELP:"
"RTN","%ZVEMKI1",89,0)
 . S STRING=NODE(4) D STRING^%ZVEMKI3
"RTN","%ZVEMKI1",90,0)
 ;
"RTN","%ZVEMKI1",91,0)
 I NODE(7.5)]"" D  Q:FLAGQ
"RTN","%ZVEMKI1",92,0)
 . W ! Q:$$CHECK
"RTN","%ZVEMKI1",93,0)
 . W !?C1,"PRE-LOOKUP TRANS:"
"RTN","%ZVEMKI1",94,0)
 . S STRING=NODE(7.5) D STRING^%ZVEMKI3
"RTN","%ZVEMKI1",95,0)
 ;
"RTN","%ZVEMKI1",96,0)
 I NODE(9.1)]"" D  Q:FLAGQ
"RTN","%ZVEMKI1",97,0)
 . W ! Q:$$CHECK
"RTN","%ZVEMKI1",98,0)
 . W !?C1,"COMP. EXPRESSION:"
"RTN","%ZVEMKI1",99,0)
 . S STRING=NODE(9.1) D STRING^%ZVEMKI3
"RTN","%ZVEMKI1",100,0)
 ;
"RTN","%ZVEMKI1",101,0)
OVERFLOW ;Nodes 9.2 to 9.9, that contain overflow code
"RTN","%ZVEMKI1",102,0)
 I $D(^DD(DD,FNUM,9.2)) D  Q:FLAGQ
"RTN","%ZVEMKI1",103,0)
 . W ! Q:$$CHECK
"RTN","%ZVEMKI1",104,0)
 . W !?C1,"OVERFLOW EXECUTABLE CODE:" Q:$$CHECK
"RTN","%ZVEMKI1",105,0)
 . S ZA=9.199
"RTN","%ZVEMKI1",106,0)
 . F  S ZA=$O(^DD(DD,FNUM,ZA)) Q:ZA'?1"9."1N  D  Q:FLAGQ
"RTN","%ZVEMKI1",107,0)
 .. W !?6,"Node: ",ZA
"RTN","%ZVEMKI1",108,0)
 .. S STRING=^DD(DD,FNUM,ZA) D STRING^%ZVEMKI3
"RTN","%ZVEMKI1",109,0)
 ;
"RTN","%ZVEMKI1",110,0)
SCREEN I NODE(12)]"" D  Q:FLAGQ
"RTN","%ZVEMKI1",111,0)
 . W ! Q:$$CHECK
"RTN","%ZVEMKI1",112,0)
 . W !?C1,"SCREEN: "
"RTN","%ZVEMKI1",113,0)
 . S STRING=NODE(12) D STRING^%ZVEMKI3
"RTN","%ZVEMKI1",114,0)
 ;
"RTN","%ZVEMKI1",115,0)
 I NODE(12.1)]"" D  Q:FLAGQ
"RTN","%ZVEMKI1",116,0)
 . W !?C1,"SCREEN CODE:" Q:$$CHECK
"RTN","%ZVEMKI1",117,0)
 . S STRING=NODE(12.1) D STRING^%ZVEMKI3
"RTN","%ZVEMKI1",118,0)
 ;
"RTN","%ZVEMKI1",119,0)
DESCRIP ;Description
"RTN","%ZVEMKI1",120,0)
 I $D(^DD(DD,FNUM,21)) D  Q:FLAGQ
"RTN","%ZVEMKI1",121,0)
 . W ! Q:$$CHECK
"RTN","%ZVEMKI1",122,0)
 . W !?C1,"DESCRIPTION:"
"RTN","%ZVEMKI1",123,0)
 . D WORDA^%ZVEMKI3("^DD("_DD_","_FNUM_",21)",0)
"RTN","%ZVEMKI1",124,0)
 ;
"RTN","%ZVEMKI1",125,0)
TECHDESC ;Technical Description
"RTN","%ZVEMKI1",126,0)
 I $D(^DD(DD,FNUM,23)) D  Q:FLAGQ
"RTN","%ZVEMKI1",127,0)
 . W ! Q:$$CHECK
"RTN","%ZVEMKI1",128,0)
 . W !?C1,"TECH DESCRIPTION:"
"RTN","%ZVEMKI1",129,0)
 . D WORDA^%ZVEMKI3("^DD("_DD_","_FNUM_",23)",0)
"RTN","%ZVEMKI1",130,0)
 ;
"RTN","%ZVEMKI1",131,0)
HELP I $D(^DD(DD,FNUM,22)),^(22)]"" D HELP^%ZVEMKI2 Q:FLAGQ
"RTN","%ZVEMKI1",132,0)
 ;
"RTN","%ZVEMKI1",133,0)
KEY ;Keys
"RTN","%ZVEMKI1",134,0)
 D KEYS^%ZVEMKI4 Q:FLAGQ
"RTN","%ZVEMKI1",135,0)
 ;
"RTN","%ZVEMKI1",136,0)
NEWINDEX ;New-style indexes
"RTN","%ZVEMKI1",137,0)
 D INDEX^%ZVEMKI4 Q:FLAGQ
"RTN","%ZVEMKI1",138,0)
 ;
"RTN","%ZVEMKI1",139,0)
OLDINDEX ;Old-style indexes
"RTN","%ZVEMKI1",140,0)
 I $D(^DD(DD,FNUM,1)) D OLDINDX^%ZVEMKI2 Q:FLAGQ
"RTN","%ZVEMKI1",141,0)
 Q
"RTN","%ZVEMKI1",142,0)
 ;
"RTN","%ZVEMKI1",143,0)
CHECK() ;Check page length. 0=Ok  1=Quit
"RTN","%ZVEMKI1",144,0)
 I $Y'>(VEESIZE+1) Q 0
"RTN","%ZVEMKI1",145,0)
 D PAGE^%ZVEMKI3 I FLAGQ Q 1
"RTN","%ZVEMKI1",146,0)
 Q 0
"RTN","%ZVEMKI1",147,0)
 ;
"RTN","%ZVEMKI1",148,0)
INIT ;
"RTN","%ZVEMKI1",149,0)
 S FLAGQ=0,U="^"
"RTN","%ZVEMKI1",150,0)
 D REVVID^%ZVEMKY2
"RTN","%ZVEMKI1",151,0)
 S C1=2,C2=5,C3=15,C4=20,C5=22,C6=25,C7=38 ;Columns
"RTN","%ZVEMKI1",152,0)
 F I=0,2,3,4,7.5,9.1,12,12.1 S NODE(I)=$G(^DD(DD,FNUM,I))
"RTN","%ZVEMKI1",153,0)
 Q
"RTN","%ZVEMKI2")
0^49^B12959090
"RTN","%ZVEMKI2",1,0)
%ZVEMKI2 ;DJB,KRN**Indiv Fld DD - Old-Style Indexes,DESCRIP,DTYPE,HELPFRAME ; 12/12/00 9:51am
"RTN","%ZVEMKI2",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMKI2",3,0)
 ;
"RTN","%ZVEMKI2",4,0)
OLDINDX ;Old-style Indexes
"RTN","%ZVEMKI2",5,0)
 NEW CNT,XREFNAM,XREFTYPE
"RTN","%ZVEMKI2",6,0)
 S CNT=1
"RTN","%ZVEMKI2",7,0)
 S ZA=0
"RTN","%ZVEMKI2",8,0)
 F  S ZA=$O(^DD(DD,FNUM,1,ZA)) Q:ZA=""!(ZA'>0)!FLAGQ  D OLDINDX1
"RTN","%ZVEMKI2",9,0)
 Q
"RTN","%ZVEMKI2",10,0)
 ;
"RTN","%ZVEMKI2",11,0)
OLDINDX1 ;
"RTN","%ZVEMKI2",12,0)
 Q:'$D(^DD(DD,FNUM,1,ZA,0))
"RTN","%ZVEMKI2",13,0)
 S XREFNAM=$P(^(0),U,2)
"RTN","%ZVEMKI2",14,0)
 S:XREFNAM="" XREFNAM="-----"
"RTN","%ZVEMKI2",15,0)
 S XREFTYPE=$P(^(0),U,3)
"RTN","%ZVEMKI2",16,0)
 S:XREFTYPE="" XREFTYPE="REGULAR"
"RTN","%ZVEMKI2",17,0)
 ;
"RTN","%ZVEMKI2",18,0)
 W ! Q:$$CHECK
"RTN","%ZVEMKI2",19,0)
 ;
"RTN","%ZVEMKI2",20,0)
 ;Heading
"RTN","%ZVEMKI2",21,0)
 I CNT=1 D  Q:FLAGQ
"RTN","%ZVEMKI2",22,0)
 . W !,@VEE("RON")," OLD-STYLE INDEXES ",@VEE("ROFF") Q:$$CHECK
"RTN","%ZVEMKI2",23,0)
 . W ! Q:$$CHECK
"RTN","%ZVEMKI2",24,0)
 S CNT=CNT+1
"RTN","%ZVEMKI2",25,0)
 ;
"RTN","%ZVEMKI2",26,0)
 W !?C1,"INDEX: ",XREFNAM Q:$$CHECK
"RTN","%ZVEMKI2",27,0)
 W !?C2,"Type: ",XREFTYPE Q:$$CHECK
"RTN","%ZVEMKI2",28,0)
 S ZB=0
"RTN","%ZVEMKI2",29,0)
 F  S ZB=$O(^DD(DD,FNUM,1,ZA,ZB)) Q:ZB=""  D  Q:FLAGQ
"RTN","%ZVEMKI2",30,0)
 . I ZB="%D" D DESCRIP Q
"RTN","%ZVEMKI2",31,0)
 . Q:'$D(^DD(DD,FNUM,1,ZA,ZB))#2
"RTN","%ZVEMKI2",32,0)
 . W !
"RTN","%ZVEMKI2",33,0)
 . I ZB'>0 W ?C2
"RTN","%ZVEMKI2",34,0)
 . E  W ?C2
"RTN","%ZVEMKI2",35,0)
 . W "Node: ",ZB ;...ZB can be alpha or number
"RTN","%ZVEMKI2",36,0)
 . S STRING=^DD(DD,FNUM,1,ZA,ZB) D STRING^%ZVEMKI3
"RTN","%ZVEMKI2",37,0)
 Q
"RTN","%ZVEMKI2",38,0)
 ;
"RTN","%ZVEMKI2",39,0)
DESCRIP ;
"RTN","%ZVEMKI2",40,0)
 NEW INT
"RTN","%ZVEMKI2",41,0)
 W ! Q:$$CHECK
"RTN","%ZVEMKI2",42,0)
 W !?C2,"Index Desc:"
"RTN","%ZVEMKI2",43,0)
 D WORDA^%ZVEMKI3("^DD("_DD_","_FNUM_",1,"_ZA_",""%D"")",0)
"RTN","%ZVEMKI2",44,0)
 Q
"RTN","%ZVEMKI2",45,0)
 ;
"RTN","%ZVEMKI2",46,0)
DTYPE ;Data type
"RTN","%ZVEMKI2",47,0)
 W ! Q:$$CHECK
"RTN","%ZVEMKI2",48,0)
 W !?C1," DATA TYPE:",?C4 D DTYPE1 Q:$$CHECK
"RTN","%ZVEMKI2",49,0)
 F I=1:1:$L(ZD) S ZA=$E(ZD,I) D  Q:FLAGQ
"RTN","%ZVEMKI2",50,0)
 . I "IORXa*"[ZA W !?C4 D DTYPE2 Q:$$CHECK
"RTN","%ZVEMKI2",51,0)
 ;
"RTN","%ZVEMKI2",52,0)
 ;--> Set-of-Codes
"RTN","%ZVEMKI2",53,0)
 I ZD["S" F I=1:1:$L($P(NODE(0),U,3),";")-1 D  Q:$$CHECK
"RTN","%ZVEMKI2",54,0)
 . W !?C5,$P($P(NODE(0),U,3),";",I)
"RTN","%ZVEMKI2",55,0)
 Q:FLAGQ
"RTN","%ZVEMKI2",56,0)
 ;
"RTN","%ZVEMKI2",57,0)
 ;--> Pointer
"RTN","%ZVEMKI2",58,0)
 I ZD["P" W ! Q:$$CHECK  S ZA="^"_$P(NODE(0),U,3) D  Q:$$CHECK
"RTN","%ZVEMKI2",59,0)
 . W !?C1,"POINTS TO: ",?C4
"RTN","%ZVEMKI2",60,0)
 . S ZB=ZA_"0)"
"RTN","%ZVEMKI2",61,0)
 . I $D(@ZB) W $P(@ZB,U)," file  -  ",ZA Q
"RTN","%ZVEMKI2",62,0)
 . W " - Global doesn't exist."
"RTN","%ZVEMKI2",63,0)
 ;
"RTN","%ZVEMKI2",64,0)
 ;--> Variable pointer
"RTN","%ZVEMKI2",65,0)
 I ZD["V"&($D(^DD(DD,FNUM,"V",0))) W ! Q:$$CHECK  D  Q:FLAGQ
"RTN","%ZVEMKI2",66,0)
 . W !?C1,"POINTS TO:"
"RTN","%ZVEMKI2",67,0)
 . S ZA=0
"RTN","%ZVEMKI2",68,0)
 . F  S ZA=$O(^DD(DD,FNUM,"V",ZA)) Q:ZA'>0  S ZB=^(ZA,0) D  Q:FLAGQ
"RTN","%ZVEMKI2",69,0)
 . . W ?C4,$P(ZB,U),?C6,$P(ZB,U,2) Q:$$CHECK
"RTN","%ZVEMKI2",70,0)
 . . W:$O(^DD(DD,FNUM,"V",ZA))>0 !
"RTN","%ZVEMKI2",71,0)
 Q
"RTN","%ZVEMKI2",72,0)
 ;
"RTN","%ZVEMKI2",73,0)
DTYPE1 ;Data Types
"RTN","%ZVEMKI2",74,0)
 I ZD["C" D  Q
"RTN","%ZVEMKI2",75,0)
 . W "Computed"
"RTN","%ZVEMKI2",76,0)
 . I ZD["B" W ",True-False (""Boolean"")"
"RTN","%ZVEMKI2",77,0)
 . I ZD["D" W ",date-valued"
"RTN","%ZVEMKI2",78,0)
 . I ZD["m" W ",multilined"
"RTN","%ZVEMKI2",79,0)
 I ZD["D" W "Date-valued" Q
"RTN","%ZVEMKI2",80,0)
 I ZD["F" W "Free Text" Q
"RTN","%ZVEMKI2",81,0)
 I ZD["N" W "Numeric" Q
"RTN","%ZVEMKI2",82,0)
 I ZD["P" D  Q
"RTN","%ZVEMKI2",83,0)
 . W "Pointer"
"RTN","%ZVEMKI2",84,0)
 . I ZD["'" W ",LAYGO to 'pointed to' file not allowed"
"RTN","%ZVEMKI2",85,0)
 I ZD["S" W "Set of Codes" Q
"RTN","%ZVEMKI2",86,0)
 I ZD["W" W "Word Processing" Q
"RTN","%ZVEMKI2",87,0)
 I ZD["V" W "Variable Pointer" Q
"RTN","%ZVEMKI2",88,0)
 I ZD["K" W "MUMPS code" Q
"RTN","%ZVEMKI2",89,0)
 W "*****"
"RTN","%ZVEMKI2",90,0)
 Q
"RTN","%ZVEMKI2",91,0)
 ;
"RTN","%ZVEMKI2",92,0)
DTYPE2 ;Data types
"RTN","%ZVEMKI2",93,0)
 I ZA["I" W "Uneditable" Q
"RTN","%ZVEMKI2",94,0)
 I ZA["O" W "Has output transform" Q
"RTN","%ZVEMKI2",95,0)
 I ZA["R" W "Required field" Q
"RTN","%ZVEMKI2",96,0)
 I ZA["X" W "Input Transform has been modified in Utility Option" Q
"RTN","%ZVEMKI2",97,0)
 I ZA["a" W "Marked for auditing" Q
"RTN","%ZVEMKI2",98,0)
 I ZA["*" W "Field has a screen" Q
"RTN","%ZVEMKI2",99,0)
 Q
"RTN","%ZVEMKI2",100,0)
 ;
"RTN","%ZVEMKI2",101,0)
HELP ;Print HELP FRAME text (^DIC(9.2,)
"RTN","%ZVEMKI2",102,0)
 Q:$G(FLAGP)
"RTN","%ZVEMKI2",103,0)
 NEW ANS,XQH
"RTN","%ZVEMKI2",104,0)
 W ! Q:$$CHECK
"RTN","%ZVEMKI2",105,0)
 W !?C1,"This field has a HELP FRAME." Q:$$CHECK
"RTN","%ZVEMKI2",106,0)
 W !?C1,"Do you wish to see the HELP FRAME text?: [YES/NO] NO//"
"RTN","%ZVEMKI2",107,0)
 R ANS:VEE("TIME") S:'$T!(ANS="") ANS="N"
"RTN","%ZVEMKI2",108,0)
 I "Yy"'[$E(ANS) W ! Q
"RTN","%ZVEMKI2",109,0)
 S XQH=^DD(DD,FNUM,22)
"RTN","%ZVEMKI2",110,0)
 D EN^XQH
"RTN","%ZVEMKI2",111,0)
 Q
"RTN","%ZVEMKI2",112,0)
 ;
"RTN","%ZVEMKI2",113,0)
CHECK() ;Check page length. 0=Ok  1=Quit
"RTN","%ZVEMKI2",114,0)
 I $Y'>(VEESIZE+1) Q 0
"RTN","%ZVEMKI2",115,0)
 D PAGE^%ZVEMKI3 I FLAGQ Q 1
"RTN","%ZVEMKI2",116,0)
 Q 0
"RTN","%ZVEMKI3")
0^50^B8222940
"RTN","%ZVEMKI3",1,0)
%ZVEMKI3 ;DJB,KRN**Indiv Fld DD - STRING,WORD ; 12/12/00 9:49am
"RTN","%ZVEMKI3",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMKI3",3,0)
 ;
"RTN","%ZVEMKI3",4,0)
 ;Print STRING in lines of 59 characters
"RTN","%ZVEMKI3",5,0)
STRING ;--> STRING=Code
"RTN","%ZVEMKI3",6,0)
 Q:$G(STRING)']""
"RTN","%ZVEMKI3",7,0)
 NEW CNT
"RTN","%ZVEMKI3",8,0)
 F CNT=1:1 Q:STRING=""  D  Q:$$CHECK
"RTN","%ZVEMKI3",9,0)
 . W:CNT>1 !
"RTN","%ZVEMKI3",10,0)
 . W ?C4,$E(STRING,1,59)
"RTN","%ZVEMKI3",11,0)
 . S STRING=$E(STRING,60,9999)
"RTN","%ZVEMKI3",12,0)
 Q
"RTN","%ZVEMKI3",13,0)
 ;
"RTN","%ZVEMKI3",14,0)
WORD ;Display single Text node
"RTN","%ZVEMKI3",15,0)
 Q:$G(STRING)']""!(STRING?1." ")
"RTN","%ZVEMKI3",16,0)
 NEW I,LINE
"RTN","%ZVEMKI3",17,0)
WORD1 F I=1:1 Q:$E(STRING,I)'=" "
"RTN","%ZVEMKI3",18,0)
 S STRING=$E(STRING,I,999) ;Strip off starting spaces
"RTN","%ZVEMKI3",19,0)
 Q:$G(STRING)']""
"RTN","%ZVEMKI3",20,0)
 S LINE=$E(STRING,1,59)
"RTN","%ZVEMKI3",21,0)
 I $L(STRING)>59,LINE[" ",$E(STRING,60)'=" " D  ;
"RTN","%ZVEMKI3",22,0)
 . S LINE=$P(LINE," ",1,$L(LINE," ")-1)
"RTN","%ZVEMKI3",23,0)
 W:I>1 !
"RTN","%ZVEMKI3",24,0)
 W ?C4,LINE Q:$$CHECK
"RTN","%ZVEMKI3",25,0)
 S STRING=$E(STRING,$L(LINE)+1,9999)
"RTN","%ZVEMKI3",26,0)
 G WORD1
"RTN","%ZVEMKI3",27,0)
 ;
"RTN","%ZVEMKI3",28,0)
WORDA(ROOT,ND) ;Display Text array
"RTN","%ZVEMKI3",29,0)
 ;ROOT = The global root that contains text (Enter as closed root)
"RTN","%ZVEMKI3",30,0)
 ;ND   = The node that contains text
"RTN","%ZVEMKI3",31,0)
 ;Example:  ROOT="^%ZVEMS(""ZZ"",""%DT"")"
"RTN","%ZVEMKI3",32,0)
 ;          ND  = ""
"RTN","%ZVEMKI3",33,0)
 ;          Will display text at: ^%ZVEMS("ZZ","%DT",1)
"RTN","%ZVEMKI3",34,0)
 ;                                ^%ZVEMS("ZZ","%DT",2)
"RTN","%ZVEMKI3",35,0)
 ;                                etc
"RTN","%ZVEMKI3",36,0)
 ;
"RTN","%ZVEMKI3",37,0)
 NEW COMMA,GLB,I,IEN,LEFTOVER,LINE,ROOT1,STRING
"RTN","%ZVEMKI3",38,0)
 ;
"RTN","%ZVEMKI3",39,0)
 Q:$G(ROOT)']""
"RTN","%ZVEMKI3",40,0)
 S ND=$G(ND)
"RTN","%ZVEMKI3",41,0)
 I ND]"",+ND'=ND S ND=""""_ND_"""" ;Enclose ND in quotes if alpha
"RTN","%ZVEMKI3",42,0)
 ;
"RTN","%ZVEMKI3",43,0)
 S ROOT1=ROOT
"RTN","%ZVEMKI3",44,0)
 S COMMA=1 ;Needs a comma in subscript
"RTN","%ZVEMKI3",45,0)
 I ROOT1'["(" S ROOT1=ROOT1_"("
"RTN","%ZVEMKI3",46,0)
 I $E(ROOT1,$L(ROOT1))="(" S COMMA=0
"RTN","%ZVEMKI3",47,0)
 I $E(ROOT,$L(ROOT))=")" S ROOT1=$P(ROOT,")",1)
"RTN","%ZVEMKI3",48,0)
 ;
"RTN","%ZVEMKI3",49,0)
 S LEFTOVER=""
"RTN","%ZVEMKI3",50,0)
 S IEN=0
"RTN","%ZVEMKI3",51,0)
 F I=1:1 S IEN=$O(@ROOT@(IEN)) Q:'IEN!FLAGQ  D  ;
"RTN","%ZVEMKI3",52,0)
 . ;
"RTN","%ZVEMKI3",53,0)
 . ;Get text
"RTN","%ZVEMKI3",54,0)
 . I ND]"" D  ;
"RTN","%ZVEMKI3",55,0)
 .. I COMMA S GLB=ROOT1_","_IEN_","_ND_")"
"RTN","%ZVEMKI3",56,0)
 .. E  S GLB=ROOT1_IEN_","_ND_")"
"RTN","%ZVEMKI3",57,0)
 .. Q:'$D(@GLB)  S STRING=@GLB
"RTN","%ZVEMKI3",58,0)
 . E  D  ;
"RTN","%ZVEMKI3",59,0)
 .. I COMMA S GLB=ROOT1_","_IEN_")"
"RTN","%ZVEMKI3",60,0)
 .. E  S GLB=ROOT1_IEN_")"
"RTN","%ZVEMKI3",61,0)
 .. Q:'$D(@GLB)  S STRING=@GLB
"RTN","%ZVEMKI3",62,0)
 . ;
"RTN","%ZVEMKI3",63,0)
 . I LEFTOVER]"" S STRING=LEFTOVER_" "_STRING,LEFTOVER=""
"RTN","%ZVEMKI3",64,0)
 . D WORDA1(STRING)
"RTN","%ZVEMKI3",65,0)
 ;
"RTN","%ZVEMKI3",66,0)
 ;Write final line of text
"RTN","%ZVEMKI3",67,0)
 Q:LEFTOVER']""!FLAGQ
"RTN","%ZVEMKI3",68,0)
 S STRING=LEFTOVER
"RTN","%ZVEMKI3",69,0)
 D WORDA1(STRING)
"RTN","%ZVEMKI3",70,0)
 Q
"RTN","%ZVEMKI3",71,0)
 ;
"RTN","%ZVEMKI3",72,0)
WORDA1(STRING) ;Write text
"RTN","%ZVEMKI3",73,0)
 NEW LINE
"RTN","%ZVEMKI3",74,0)
WORDA1A S LINE=$E(STRING,1,59)
"RTN","%ZVEMKI3",75,0)
 ;
"RTN","%ZVEMKI3",76,0)
 I $L(STRING)>59,LINE[" ",$E(STRING,60)'=" " D  ;
"RTN","%ZVEMKI3",77,0)
 . S LINE=$P(LINE," ",1,$L(LINE," ")-1)
"RTN","%ZVEMKI3",78,0)
 ;
"RTN","%ZVEMKI3",79,0)
 W:I>1 !
"RTN","%ZVEMKI3",80,0)
 W ?C4,LINE
"RTN","%ZVEMKI3",81,0)
 Q:$$CHECK
"RTN","%ZVEMKI3",82,0)
 ;
"RTN","%ZVEMKI3",83,0)
 S STRING=$E(STRING,$L(LINE)+1,999)
"RTN","%ZVEMKI3",84,0)
 I $L(STRING)>59 G WORDA1A
"RTN","%ZVEMKI3",85,0)
 S LEFTOVER=STRING
"RTN","%ZVEMKI3",86,0)
 ;Strip any leading spaces from LEFTOVER.
"RTN","%ZVEMKI3",87,0)
 F  Q:$E(LEFTOVER)'=" "  S LEFTOVER=$E(LEFTOVER,2,$L(LEFTOVER))
"RTN","%ZVEMKI3",88,0)
 Q
"RTN","%ZVEMKI3",89,0)
 ;
"RTN","%ZVEMKI3",90,0)
PAGE ;
"RTN","%ZVEMKI3",91,0)
 I $G(FLAGP) D  Q
"RTN","%ZVEMKI3",92,0)
 . W @VEE("IOF") I $E(VEEIOST,1,2)="P-" W !!!
"RTN","%ZVEMKI3",93,0)
 NEW I
"RTN","%ZVEMKI3",94,0)
 I $Y'>(VEESIZE+1) F I=$Y:1:(VEESIZE+2) W !
"RTN","%ZVEMKI3",95,0)
 W !,$E(VEELINE,1,VEE("IOM"))
"RTN","%ZVEMKI3",96,0)
 D PAUSEQE^%ZVEMKC(1) Q:FLAGQ
"RTN","%ZVEMKI3",97,0)
 W @VEE("IOF"),?55,"FLD NUM: ",FNUM
"RTN","%ZVEMKI3",98,0)
 W !,$E(VEELINE,1,VEE("IOM"))
"RTN","%ZVEMKI3",99,0)
 Q
"RTN","%ZVEMKI3",100,0)
 ;
"RTN","%ZVEMKI3",101,0)
CHECK() ;Check page length. 0=Ok  1=Quit
"RTN","%ZVEMKI3",102,0)
 I $Y'>(VEESIZE+1) Q 0
"RTN","%ZVEMKI3",103,0)
 D PAGE I FLAGQ Q 1
"RTN","%ZVEMKI3",104,0)
 Q 0
"RTN","%ZVEMKI4")
0^51^B18106983
"RTN","%ZVEMKI4",1,0)
%ZVEMKI4 ;DJB,KRN**Indiv Fld DD - Keys, New-Style Indexes ; 12/12/00 6:31pm
"RTN","%ZVEMKI4",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMKI4",3,0)
 ;
"RTN","%ZVEMKI4",4,0)
KEYS ;Get Keys for this file/field.
"RTN","%ZVEMKI4",5,0)
 NEW IEN,IEN1,NAME,PRIOR,SEQ,ND,ND1,UNIQ
"RTN","%ZVEMKI4",6,0)
 ;
"RTN","%ZVEMKI4",7,0)
 Q:'$D(^DD("KEY","F",DD,FNUM))
"RTN","%ZVEMKI4",8,0)
 ;
"RTN","%ZVEMKI4",9,0)
 ;Heading
"RTN","%ZVEMKI4",10,0)
 I $G(FLAGP),$E(VEEIOST,1,2)="P-" D  Q  ;...Printer
"RTN","%ZVEMKI4",11,0)
 . W !!,"<<< KEYS >>>",!
"RTN","%ZVEMKI4",12,0)
 W ! Q:$$CHECK
"RTN","%ZVEMKI4",13,0)
 W !,@VEE("RON")," KEYS ",@VEE("ROFF") ;...CRT
"RTN","%ZVEMKI4",14,0)
 Q:$$CHECK
"RTN","%ZVEMKI4",15,0)
 ;
"RTN","%ZVEMKI4",16,0)
 S IEN=0
"RTN","%ZVEMKI4",17,0)
 F  S IEN=$O(^DD("KEY","F",DD,FNUM,IEN)) Q:'IEN!FLAGQ  D  ;
"RTN","%ZVEMKI4",18,0)
 . S IEN1=0
"RTN","%ZVEMKI4",19,0)
 . F  S IEN1=$O(^DD("KEY","F",DD,FNUM,IEN,IEN1)) Q:'IEN1!FLAGQ  D  ;
"RTN","%ZVEMKI4",20,0)
 .. S ND=$G(^DD("KEY",IEN,0))
"RTN","%ZVEMKI4",21,0)
 .. S ND1=$G(^DD("KEY",IEN,2,IEN1,0))
"RTN","%ZVEMKI4",22,0)
 .. S NAME=$P(ND,"^",2)
"RTN","%ZVEMKI4",23,0)
 .. S PRIOR=$P(ND,"^",3)
"RTN","%ZVEMKI4",24,0)
 .. S SEQ=$P(ND1,"^",3)
"RTN","%ZVEMKI4",25,0)
 .. S UNIQ=$P(ND,U,4)
"RTN","%ZVEMKI4",26,0)
 .. I UNIQ S UNIQ=$P($G(^DD("IX",UNIQ,0)),U,2)
"RTN","%ZVEMKI4",27,0)
 .. ;
"RTN","%ZVEMKI4",28,0)
 .. W ! Q:$$CHECK
"RTN","%ZVEMKI4",29,0)
 .. W !?C1,$S(PRIOR="P":"PRIMARY",1:"SECONDARY")_" KEY: "_NAME
"RTN","%ZVEMKI4",30,0)
 .. Q:$$CHECK
"RTN","%ZVEMKI4",31,0)
 .. W !?C2,"Sequence: ",SEQ
"RTN","%ZVEMKI4",32,0)
 .. Q:$$CHECK
"RTN","%ZVEMKI4",33,0)
 .. W !?C2,"Uniqueness Index: ",UNIQ
"RTN","%ZVEMKI4",34,0)
 .. Q:$$CHECK
"RTN","%ZVEMKI4",35,0)
 Q
"RTN","%ZVEMKI4",36,0)
 ;
"RTN","%ZVEMKI4",37,0)
INDEX ;Get Indexes for this file/field.
"RTN","%ZVEMKI4",38,0)
 NEW IEN,IEN1,ND,STRING
"RTN","%ZVEMKI4",39,0)
 NEW VENODE,VENODE0,VENODE2,VENODE3
"RTN","%ZVEMKI4",40,0)
 ;
"RTN","%ZVEMKI4",41,0)
 Q:'$D(^DD("IX","F",DD,FNUM))
"RTN","%ZVEMKI4",42,0)
 ;
"RTN","%ZVEMKI4",43,0)
 ;Heading
"RTN","%ZVEMKI4",44,0)
 I $G(FLAGP),$E(VEEIOST,1,2)="P-" D  Q  ;...Printer
"RTN","%ZVEMKI4",45,0)
 . W !!,"<<< NEW-STYLE INDEXES >>>",!
"RTN","%ZVEMKI4",46,0)
 W ! Q:$$CHECK
"RTN","%ZVEMKI4",47,0)
 W !,@VEE("RON")," NEW-STYLE INDEXES",@VEE("ROFF") ;...CRT
"RTN","%ZVEMKI4",48,0)
 Q:$$CHECK
"RTN","%ZVEMKI4",49,0)
 ;
"RTN","%ZVEMKI4",50,0)
 ;
"RTN","%ZVEMKI4",51,0)
 S IEN=0
"RTN","%ZVEMKI4",52,0)
 F  S IEN=$O(^DD("IX","F",DD,FNUM,IEN)) Q:'IEN!FLAGQ  D  ;
"RTN","%ZVEMKI4",53,0)
 . S IEN1=0
"RTN","%ZVEMKI4",54,0)
 . F  S IEN1=$O(^DD("IX","F",DD,FNUM,IEN,IEN1)) Q:'IEN1!FLAGQ  D  ;
"RTN","%ZVEMKI4",55,0)
 .. S VENODE=$G(^DD("IX",IEN,0))
"RTN","%ZVEMKI4",56,0)
 .. S VENODE0=$G(^DD("IX",IEN,11.1,IEN1,0))
"RTN","%ZVEMKI4",57,0)
 .. S VENODE2=$G(^DD("IX",IEN,11.1,IEN1,2))
"RTN","%ZVEMKI4",58,0)
 .. S VENODE3=$G(^DD("IX",IEN,11.1,IEN1,3))
"RTN","%ZVEMKI4",59,0)
 .. ;
"RTN","%ZVEMKI4",60,0)
 .. W ! Q:$$CHECK
"RTN","%ZVEMKI4",61,0)
 .. W !?C1,"INDEX: ",$P(VENODE,U,2) Q:$$CHECK
"RTN","%ZVEMKI4",62,0)
 .. D INDEXTYP Q:FLAGQ
"RTN","%ZVEMKI4",63,0)
 .. D INDEXCD^%ZVEMKI5 Q:FLAGQ
"RTN","%ZVEMKI4",64,0)
 Q
"RTN","%ZVEMKI4",65,0)
 ;
"RTN","%ZVEMKI4",66,0)
INDEXTYP ;Type of index info
"RTN","%ZVEMKI4",67,0)
 NEW ACT,EXEC,I,NUM,RFILE,RTYPE,TYPE,USE
"RTN","%ZVEMKI4",68,0)
 ;
"RTN","%ZVEMKI4",69,0)
 S TYPE=$P(VENODE,U,4) ;....Type
"RTN","%ZVEMKI4",70,0)
 S EXEC=$P(VENODE,U,6) ;....Execution
"RTN","%ZVEMKI4",71,0)
 S ACT=$P(VENODE,U,7) ;.....Activity
"RTN","%ZVEMKI4",72,0)
 S RTYPE=$P(VENODE,U,8) ;...Root type
"RTN","%ZVEMKI4",73,0)
 S RFILE=$P(VENODE,U,9) ;...Root file
"RTN","%ZVEMKI4",74,0)
 S USE=$P(VENODE,U,14) ;....Use
"RTN","%ZVEMKI4",75,0)
 ;
"RTN","%ZVEMKI4",76,0)
 W !?C2,"Type:"
"RTN","%ZVEMKI4",77,0)
 W ?C4,$S(TYPE="R":"REGULAR",TYPE="MU":"MUMPS",1:"")
"RTN","%ZVEMKI4",78,0)
 Q:$$CHECK
"RTN","%ZVEMKI4",79,0)
 ;
"RTN","%ZVEMKI4",80,0)
 W !?C2,"Root File:",?C4,RFILE
"RTN","%ZVEMKI4",81,0)
 I RTYPE="I" W " - Index & fields at same level"
"RTN","%ZVEMKI4",82,0)
 I RTYPE="W" W " - Whole file index on subfile fields"
"RTN","%ZVEMKI4",83,0)
 Q:$$CHECK
"RTN","%ZVEMKI4",84,0)
 ;
"RTN","%ZVEMKI4",85,0)
 ;Display fields in the CROSS-REFERENCE VALUES multiple
"RTN","%ZVEMKI4",86,0)
 D INDEXFLD Q:FLAGQ
"RTN","%ZVEMKI4",87,0)
 ;
"RTN","%ZVEMKI4",88,0)
 W !?C2,"Execute:"
"RTN","%ZVEMKI4",89,0)
 W ?C4,$S(EXEC="F":"After an index field changes",EXEC="R":"After all fields in a record are updated",1:"")
"RTN","%ZVEMKI4",90,0)
 Q:$$CHECK
"RTN","%ZVEMKI4",91,0)
 ;
"RTN","%ZVEMKI4",92,0)
 W !?C2,"Use:"
"RTN","%ZVEMKI4",93,0)
 W ?C4,$S(USE="LS":"Lookup & Sorting",USE="S":"Sorting only",USE="A":"Performs an action. Does not build an index.",1:"")
"RTN","%ZVEMKI4",94,0)
 Q:$$CHECK
"RTN","%ZVEMKI4",95,0)
 ;
"RTN","%ZVEMKI4",96,0)
 D  Q:FLAGQ
"RTN","%ZVEMKI4",97,0)
 . Q:$P(VENODE,U,3)']""
"RTN","%ZVEMKI4",98,0)
 . W !?C2,"Short Desc:"
"RTN","%ZVEMKI4",99,0)
 . S STRING=$P(VENODE,U,3) D STRING^%ZVEMKI3
"RTN","%ZVEMKI4",100,0)
 ;
"RTN","%ZVEMKI4",101,0)
 D  Q:FLAGQ
"RTN","%ZVEMKI4",102,0)
 . Q:'$D(^DD("IX",IEN,.1))
"RTN","%ZVEMKI4",103,0)
 . W !?C2,"Description:"
"RTN","%ZVEMKI4",104,0)
 . D WORDA^%ZVEMKI3("^DD(""IX"","_IEN_",.1)",0)
"RTN","%ZVEMKI4",105,0)
 ;
"RTN","%ZVEMKI4",106,0)
 W !?C2,"Activity:"
"RTN","%ZVEMKI4",107,0)
 I ACT["I" D  Q:FLAGQ
"RTN","%ZVEMKI4",108,0)
 . W ?C4,"Fired when installing an entry at a site"
"RTN","%ZVEMKI4",109,0)
 . Q:$$CHECK
"RTN","%ZVEMKI4",110,0)
 . W:ACT["R" !
"RTN","%ZVEMKI4",111,0)
 I ACT["R" W ?C4,"Fired when re-cross-referenced"
"RTN","%ZVEMKI4",112,0)
 Q:$$CHECK
"RTN","%ZVEMKI4",113,0)
 Q
"RTN","%ZVEMKI4",114,0)
 ;
"RTN","%ZVEMKI4",115,0)
INDEXFLD ;Display fields in the CROSS-REFERENCE VALUES multiple
"RTN","%ZVEMKI4",116,0)
 ;
"RTN","%ZVEMKI4",117,0)
 NEW COLL,LOOKUP,MAX
"RTN","%ZVEMKI4",118,0)
 ;
"RTN","%ZVEMKI4",119,0)
 W !?C2,"Order #:"
"RTN","%ZVEMKI4",120,0)
 W ?C4,$P(VENODE0,U,1)
"RTN","%ZVEMKI4",121,0)
 S MAX=$P(VENODE0,U,5)
"RTN","%ZVEMKI4",122,0)
 W ?C6,"Max Length:"
"RTN","%ZVEMKI4",123,0)
 W ?C7,MAX
"RTN","%ZVEMKI4",124,0)
 Q:$$CHECK
"RTN","%ZVEMKI4",125,0)
 ;
"RTN","%ZVEMKI4",126,0)
 W !?C2,"Subscript #:"
"RTN","%ZVEMKI4",127,0)
 W ?C4,$P(VENODE0,U,6)
"RTN","%ZVEMKI4",128,0)
 S COLL=$P(VENODE0,U,7)
"RTN","%ZVEMKI4",129,0)
 W ?C6,"Collation:"
"RTN","%ZVEMKI4",130,0)
 W ?C7,$S(COLL="B":"Back",1:"Forward")
"RTN","%ZVEMKI4",131,0)
 Q:$$CHECK
"RTN","%ZVEMKI4",132,0)
 ;
"RTN","%ZVEMKI4",133,0)
 S LOOKUP=$P(VENODE0,U,8)
"RTN","%ZVEMKI4",134,0)
 I LOOKUP]"" D  ;
"RTN","%ZVEMKI4",135,0)
 . W !?C2,"Lookup Prompt:"
"RTN","%ZVEMKI4",136,0)
 . W ?C4,LOOKUP
"RTN","%ZVEMKI4",137,0)
 Q:$$CHECK
"RTN","%ZVEMKI4",138,0)
 Q
"RTN","%ZVEMKI4",139,0)
 ;
"RTN","%ZVEMKI4",140,0)
CHECK() ;Check page length. 0=Ok  1=Quit
"RTN","%ZVEMKI4",141,0)
 I $Y'>(VEESIZE+1) Q 0
"RTN","%ZVEMKI4",142,0)
 D PAGE^%ZVEMKI3 I FLAGQ Q 1
"RTN","%ZVEMKI4",143,0)
 Q 0
"RTN","%ZVEMKI5")
0^52^B5430472
"RTN","%ZVEMKI5",1,0)
%ZVEMKI5 ;DJB,KRN**Indiv Fld DD - New-Style Indexes cont ; 12/12/00 6:30pm
"RTN","%ZVEMKI5",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMKI5",3,0)
 ;
"RTN","%ZVEMKI5",4,0)
INDEXCD ;Nodes that contain Mumps code
"RTN","%ZVEMKI5",5,0)
 ;
"RTN","%ZVEMKI5",6,0)
 NEW CD,NUM
"RTN","%ZVEMKI5",7,0)
 ;
"RTN","%ZVEMKI5",8,0)
 W ! Q:$$CHECK
"RTN","%ZVEMKI5",9,0)
 ;
"RTN","%ZVEMKI5",10,0)
 ;Set Logic
"RTN","%ZVEMKI5",11,0)
 D  Q:FLAGQ
"RTN","%ZVEMKI5",12,0)
 . S CD=$G(^DD("IX",IEN,1)) Q:CD']""
"RTN","%ZVEMKI5",13,0)
 . W !?C2,"Set Logic:"
"RTN","%ZVEMKI5",14,0)
 . S STRING=CD D STRING^%ZVEMKI3
"RTN","%ZVEMKI5",15,0)
 ;
"RTN","%ZVEMKI5",16,0)
 ;Overflow Set Logic code
"RTN","%ZVEMKI5",17,0)
 I $D(^DD("IX",IEN,1.2)) D  Q:FLAGQ
"RTN","%ZVEMKI5",18,0)
 . S NUM=0
"RTN","%ZVEMKI5",19,0)
 . F  S NUM=$O(^DD("IX",IEN,1.2,NUM)) Q:'NUM!FLAGQ  D  ;
"RTN","%ZVEMKI5",20,0)
 .. W !?C2,"  Node ",$P($G(^DD("IX",IEN,1.2,NUM,0)),U,1),":"
"RTN","%ZVEMKI5",21,0)
 .. S STRING=^DD("IX",IEN,1.2,NUM,1) D STRING^%ZVEMKI3
"RTN","%ZVEMKI5",22,0)
 ;
"RTN","%ZVEMKI5",23,0)
 ;Set Condition
"RTN","%ZVEMKI5",24,0)
 D  Q:FLAGQ
"RTN","%ZVEMKI5",25,0)
 . S CD=$G(^DD("IX",IEN,1.3)) Q:CD']""
"RTN","%ZVEMKI5",26,0)
 . W !?C2,"Set Condition:"
"RTN","%ZVEMKI5",27,0)
 . S STRING=CD D STRING^%ZVEMKI3
"RTN","%ZVEMKI5",28,0)
 ;
"RTN","%ZVEMKI5",29,0)
 ;Set Condition Code
"RTN","%ZVEMKI5",30,0)
 D  Q:FLAGQ
"RTN","%ZVEMKI5",31,0)
 . S CD=$G(^DD("IX",IEN,1.4)) Q:CD']""
"RTN","%ZVEMKI5",32,0)
 . W !?C2,"Set Cond Cd:"
"RTN","%ZVEMKI5",33,0)
 . S STRING=CD D STRING^%ZVEMKI3
"RTN","%ZVEMKI5",34,0)
 ;
"RTN","%ZVEMKI5",35,0)
 ;Kill Logic
"RTN","%ZVEMKI5",36,0)
 D  Q:FLAGQ
"RTN","%ZVEMKI5",37,0)
 . S CD=$G(^DD("IX",IEN,2)) Q:CD']""
"RTN","%ZVEMKI5",38,0)
 . W !?C2,"Kill Logic:"
"RTN","%ZVEMKI5",39,0)
 . S STRING=CD D STRING^%ZVEMKI3
"RTN","%ZVEMKI5",40,0)
 ;
"RTN","%ZVEMKI5",41,0)
 ;Overflow Kill Logic code
"RTN","%ZVEMKI5",42,0)
 I $D(^DD("IX",IEN,2.2)) D  Q:FLAGQ
"RTN","%ZVEMKI5",43,0)
 . S NUM=0
"RTN","%ZVEMKI5",44,0)
 . F  S NUM=$O(^DD("IX",IEN,2.2,NUM)) Q:'NUM!FLAGQ  D  ;
"RTN","%ZVEMKI5",45,0)
 .. W !?C2,"  Node ",$P($G(^DD("IX",IEN,2.2,NUM,0)),U,1),":"
"RTN","%ZVEMKI5",46,0)
 .. S STRING=^DD("IX",IEN,2.2,NUM,2) D STRING^%ZVEMKI3
"RTN","%ZVEMKI5",47,0)
 ;
"RTN","%ZVEMKI5",48,0)
 ;Kill Condition
"RTN","%ZVEMKI5",49,0)
 D  Q:FLAGQ
"RTN","%ZVEMKI5",50,0)
 . S CD=$G(^DD("IX",IEN,2.3)) Q:CD']""
"RTN","%ZVEMKI5",51,0)
 . W !?C2,"Kill Condition:"
"RTN","%ZVEMKI5",52,0)
 . S STRING=CD D STRING^%ZVEMKI3
"RTN","%ZVEMKI5",53,0)
 ;
"RTN","%ZVEMKI5",54,0)
 ;Kill Condition Code
"RTN","%ZVEMKI5",55,0)
 D  Q:FLAGQ
"RTN","%ZVEMKI5",56,0)
 . S CD=$G(^DD("IX",IEN,2.4)) Q:CD']""
"RTN","%ZVEMKI5",57,0)
 . W !?C2,"Kill Cond Cd:"
"RTN","%ZVEMKI5",58,0)
 . S STRING=CD D STRING^%ZVEMKI3
"RTN","%ZVEMKI5",59,0)
 ;
"RTN","%ZVEMKI5",60,0)
 ;Kill Index
"RTN","%ZVEMKI5",61,0)
 D  Q:FLAGQ
"RTN","%ZVEMKI5",62,0)
 . S CD=$G(^DD("IX",IEN,2.5)) Q:CD']""
"RTN","%ZVEMKI5",63,0)
 . W !?C2,"Kill Index:"
"RTN","%ZVEMKI5",64,0)
 . S STRING=CD D STRING^%ZVEMKI3
"RTN","%ZVEMKI5",65,0)
 ;
"RTN","%ZVEMKI5",66,0)
 I VENODE2]"" D  Q:FLAGQ
"RTN","%ZVEMKI5",67,0)
 . W !?C1,"Store Transfrm:"
"RTN","%ZVEMKI5",68,0)
 . S STRING=VENODE2 D STRING^%ZVEMKI3
"RTN","%ZVEMKI5",69,0)
 ;
"RTN","%ZVEMKI5",70,0)
 I VENODE3]"" D  Q:FLAGQ
"RTN","%ZVEMKI5",71,0)
 . W !?C1,"Display Transfrm:"
"RTN","%ZVEMKI5",72,0)
 . S STRING=VENODE3 D STRING^%ZVEMKI3
"RTN","%ZVEMKI5",73,0)
 Q
"RTN","%ZVEMKI5",74,0)
 ;
"RTN","%ZVEMKI5",75,0)
CHECK() ;Check page length. 0=Ok  1=Quit
"RTN","%ZVEMKI5",76,0)
 I $Y'>(VEESIZE+1) Q 0
"RTN","%ZVEMKI5",77,0)
 D PAGE^%ZVEMKI3 I FLAGQ Q 1
"RTN","%ZVEMKI5",78,0)
 Q 0
"RTN","%ZVEMKP")
0^53^B3113408
"RTN","%ZVEMKP",1,0)
%ZVEMKP ;DJB,VRR**Printing [12/30/95 8:23am]
"RTN","%ZVEMKP",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMKP",3,0)
 ;
"RTN","%ZVEMKP",4,0)
TASK(DEFAULT) ;Get device. FLAGQ indicates job has been queued.
"RTN","%ZVEMKP",5,0)
 ;DEFAULT=Default Device. Return FLAGQ=1 if taskman is used.
"RTN","%ZVEMKP",6,0)
 Q:'$D(^%ZIS)
"RTN","%ZVEMKP",7,0)
 S %ZIS="MQ" I $G(DEFAULT)]"" S %ZIS("B")=DEFAULT
"RTN","%ZVEMKP",8,0)
 W ! D ^%ZIS Q:POP  Q:'$D(IO("Q"))  S FLAGQ=1
"RTN","%ZVEMKP",9,0)
 D ^%ZTLOAD,HOME^%ZIS KILL IO("Q")
"RTN","%ZVEMKP",10,0)
 I $G(ZTSK)'>0 W !!?1,"Request cancelled.." S FLAGQ=1 Q
"RTN","%ZVEMKP",11,0)
 W !!?1,"This task has been queued...Task #",ZTSK,!
"RTN","%ZVEMKP",12,0)
 Q
"RTN","%ZVEMKP",13,0)
 ;====================================================================
"RTN","%ZVEMKP",14,0)
CAPTURE() ;Screen capture
"RTN","%ZVEMKP",15,0)
 ;Returns: YES or NO
"RTN","%ZVEMKP",16,0)
 NEW ANS
"RTN","%ZVEMKP",17,0)
 W @IOF,!?1,"***SCREEN CAPTURE***"
"RTN","%ZVEMKP",18,0)
 W !?1,"(Your terminal emulation software should be set to 'Line Wrap=OFF')"
"RTN","%ZVEMKP",19,0)
 W !!?1,"Follow these steps:"
"RTN","%ZVEMKP",20,0)
 W !?4,"1. TURN ON your screen capture software."
"RTN","%ZVEMKP",21,0)
 W !?4,"2. Press <RETURN> to initiate capture."
"RTN","%ZVEMKP",22,0)
 W !?4,"3. When the listing stops, TURN OFF your screen capture software."
"RTN","%ZVEMKP",23,0)
 W !?4,"4. Press <RETURN> to end capture."
"RTN","%ZVEMKP",24,0)
CAPTURE1 W !!?1,"Ready..... Press <RETURN> to begin, or '^' to abort:"
"RTN","%ZVEMKP",25,0)
 R !,ANS:300 S:'$T ANS="^"
"RTN","%ZVEMKP",26,0)
 I "^"'[ANS D  G CAPTURE1
"RTN","%ZVEMKP",27,0)
 . W !?1,"This option allows you to use your communication software"
"RTN","%ZVEMKP",28,0)
 . W !?1,"to do an ASCII download via screen capture."
"RTN","%ZVEMKP",29,0)
 I ANS="^" Q "NO"
"RTN","%ZVEMKP",30,0)
 Q "YES"
"RTN","%ZVEMKR")
0^54^B14104561
"RTN","%ZVEMKR",1,0)
%ZVEMKR ;DJB,KRN**OLD Single Character Read ; 12/16/00 7:30pm
"RTN","%ZVEMKR",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMKR",3,0)
 ;
"RTN","%ZVEMKR",4,0)
READ(PROMPT,LENGTH,NOECHO) ;
"RTN","%ZVEMKR",5,0)
 ;PROMPT  Display prompt.
"RTN","%ZVEMKR",6,0)
 ;LENGTH  Maximum # of characters user may enter.
"RTN","%ZVEMKR",7,0)
 ;NOECHO  1=Do not echo what user types.
"RTN","%ZVEMKR",8,0)
 ;
"RTN","%ZVEMKR",9,0)
 ;Return: Character(s) user entered
"RTN","%ZVEMKR",10,0)
 ;             -or-
"RTN","%ZVEMKR",11,0)
 ;        VEE("K") = If user hits a non-printable key, it's returned
"RTN","%ZVEMKR",12,0)
 ;                   in this variable enclosed in angle brackets.
"RTN","%ZVEMKR",13,0)
 ;                   Example: <BS> or <ESC>
"RTN","%ZVEMKR",14,0)
 ;
"RTN","%ZVEMKR",15,0)
 NEW CHAR,CHAR1,CHAR2,CLEAR,FLAGQ,I,STRING,TEST,Y
"RTN","%ZVEMKR",16,0)
 S FLAGQ=0
"RTN","%ZVEMKR",17,0)
 D INIT I FLAGQ Q "<OS>"
"RTN","%ZVEMKR",18,0)
 W PROMPT
"RTN","%ZVEMKR",19,0)
 X VEE("EOFF")
"RTN","%ZVEMKR",20,0)
 ;
"RTN","%ZVEMKR",21,0)
 F  D GETCHAR D  Q:($L(STRING)'<LENGTH)!FLAGQ
"RTN","%ZVEMKR",22,0)
 . I CHAR?1E S STRING=STRING_CHAR Q
"RTN","%ZVEMKR",23,0)
 . I ("<BS>,<DEL>"[CHAR)&(STRING]"") D  Q
"RTN","%ZVEMKR",24,0)
 . . S STRING=$E(STRING,1,$L(STRING)-1)
"RTN","%ZVEMKR",25,0)
 . . W $C(8)," ",$C(8)
"RTN","%ZVEMKR",26,0)
 . S FLAGQ=1
"RTN","%ZVEMKR",27,0)
 . S:(STRING="") VEE("K")=CHAR
"RTN","%ZVEMKR",28,0)
 ;
"RTN","%ZVEMKR",29,0)
 X VEE("EON")
"RTN","%ZVEMKR",30,0)
 Q STRING
"RTN","%ZVEMKR",31,0)
 ;
"RTN","%ZVEMKR",32,0)
GETCHAR ;Single character READ to get individual characters
"RTN","%ZVEMKR",33,0)
 R *CHAR:VEE("TIME")
"RTN","%ZVEMKR",34,0)
 I '$T S CHAR="<TO>" Q
"RTN","%ZVEMKR",35,0)
 I CHAR>31,CHAR<127 S CHAR=$C(CHAR) W:$G(NOECHO)'=1 CHAR Q
"RTN","%ZVEMKR",36,0)
 D:CHAR=0 OTHER
"RTN","%ZVEMKR",37,0)
 D:CHAR=27 ESCAPE
"RTN","%ZVEMKR",38,0)
 I CHAR="***" W $C(7) G GETCHAR
"RTN","%ZVEMKR",39,0)
 S CHAR=$S(CHAR<0:"TO",CHAR=4:"CTRLD",CHAR=8:"BS",CHAR=9:"TAB",CHAR=13:"RET",CHAR=20:"CTRLT",1:CHAR)
"RTN","%ZVEMKR",40,0)
 S CHAR=$S(CHAR=21:"F1",CHAR=22:"F2",CHAR=23:"F3",CHAR=24:"F4",CHAR=27:"ESC",CHAR=127:"DEL",1:CHAR)
"RTN","%ZVEMKR",41,0)
 S CHAR="<"_CHAR_">"
"RTN","%ZVEMKR",42,0)
 Q
"RTN","%ZVEMKR",43,0)
 ;====================================================================
"RTN","%ZVEMKR",44,0)
ESCAPE ;Process Escape Sequences
"RTN","%ZVEMKR",45,0)
 ;<ESCD>,<ESC1>,<ESCAU>, etc.
"RTN","%ZVEMKR",46,0)
 S TEST=0
"RTN","%ZVEMKR",47,0)
 R *CHAR:50
"RTN","%ZVEMKR",48,0)
 I '$T S CHAR=-1 Q
"RTN","%ZVEMKR",49,0)
 I CHAR=91 D CURSOR Q
"RTN","%ZVEMKR",50,0)
 I CHAR=79 D FKEYS Q
"RTN","%ZVEMKR",51,0)
 I CHAR>31,CHAR<97 S CHAR="ESC"_$C(CHAR) Q
"RTN","%ZVEMKR",52,0)
 I CHAR>122,CHAR<127 S CHAR="ESC"_$C(CHAR) Q
"RTN","%ZVEMKR",53,0)
 ;Convert lower case to uppercase
"RTN","%ZVEMKR",54,0)
 I CHAR>96,CHAR<123 S CHAR=CHAR-32,CHAR="ESC"_$C(CHAR) Q
"RTN","%ZVEMKR",55,0)
 ;Clean up. See if user hit ESC ESC
"RTN","%ZVEMKR",56,0)
 F I=1:1:10 R *CLEAR:0 S:$T TEST=1
"RTN","%ZVEMKR",57,0)
 Q:('TEST)&(CHAR=27)  S CHAR="***"
"RTN","%ZVEMKR",58,0)
 Q
"RTN","%ZVEMKR",59,0)
CURSOR ;Arrow Keys
"RTN","%ZVEMKR",60,0)
 ;<AU>,<AD>,<AL>,<AR>
"RTN","%ZVEMKR",61,0)
 R *CHAR:50
"RTN","%ZVEMKR",62,0)
 S CHAR=$S(CHAR=65:"AU",CHAR=66:"AD",CHAR=67:"AR",CHAR=68:"AL",CHAR=72:"HOME",CHAR=75:"END",1:CHAR)
"RTN","%ZVEMKR",63,0)
 I "1,3,4,5,6"[$C(CHAR) D OTHERDTM Q  ;"Other" Keys under DTM
"RTN","%ZVEMKR",64,0)
 Q
"RTN","%ZVEMKR",65,0)
PFKEYS ;F Keys. Call here when F Keys are to be used alone
"RTN","%ZVEMKR",66,0)
 R *CHAR:50
"RTN","%ZVEMKR",67,0)
 S CHAR=$S(CHAR=80:"F1",CHAR=81:"F2",CHAR=82:"F3",CHAR=83:"F4",1:CHAR)
"RTN","%ZVEMKR",68,0)
 Q
"RTN","%ZVEMKR",69,0)
FKEYS ;F Keys. Use F1,F2,F4 with cursor keys, F3 alone.
"RTN","%ZVEMKR",70,0)
 R *CHAR:50
"RTN","%ZVEMKR",71,0)
 I '$T S CHAR="***" Q
"RTN","%ZVEMKR",72,0)
 I CHAR=82 S CHAR="F3" Q
"RTN","%ZVEMKR",73,0)
 S CHAR=$S(CHAR=80:"F1",CHAR=81:"F2",CHAR=83:"F4",1:"***")
"RTN","%ZVEMKR",74,0)
 Q:CHAR="***"
"RTN","%ZVEMKR",75,0)
FKEYS1 R *CHAR1:50
"RTN","%ZVEMKR",76,0)
 I '$T S CHAR="***" Q
"RTN","%ZVEMKR",77,0)
 ;
"RTN","%ZVEMKR",78,0)
 ;--> <F1-1> thru <F1-9>
"RTN","%ZVEMKR",79,0)
 I CHAR1>48,CHAR1<53 D  Q
"RTN","%ZVEMKR",80,0)
 . F I=49:1:52 I CHAR1=I S CHAR=CHAR_"-"_(I-48) Q
"RTN","%ZVEMKR",81,0)
 ;
"RTN","%ZVEMKR",82,0)
 ;--> <F1A>,<F2B>, etc.
"RTN","%ZVEMKR",83,0)
 I CHAR1>31,CHAR1<49 S CHAR=CHAR_$C(CHAR1) Q
"RTN","%ZVEMKR",84,0)
 I CHAR1>52,CHAR1<97 S CHAR=CHAR_$C(CHAR1) Q
"RTN","%ZVEMKR",85,0)
 I CHAR1>122,CHAR1<127 S CHAR=CHAR_$C(CHAR1) Q
"RTN","%ZVEMKR",86,0)
 ;Convert lowercase to uppercase
"RTN","%ZVEMKR",87,0)
 I CHAR1>96,CHAR<123 S CHAR1=CHAR1-32,CHAR=CHAR_$C(CHAR1) Q
"RTN","%ZVEMKR",88,0)
 I CHAR1'=27 R *CHAR:0 S CHAR="***" Q
"RTN","%ZVEMKR",89,0)
 ;
"RTN","%ZVEMKR",90,0)
 ;--> <F1AU>,<F1AD>,<F1AL>,<F1AR>
"RTN","%ZVEMKR",91,0)
 R *CHAR1:50
"RTN","%ZVEMKR",92,0)
 ;Look for arrow keys, or F1,2,4 keys struck twice.
"RTN","%ZVEMKR",93,0)
 I ('$T)!((CHAR1'=91)&(CHAR1'=79)) R *CHAR2:0 S CHAR="***" Q
"RTN","%ZVEMKR",94,0)
 R *CHAR1:50
"RTN","%ZVEMKR",95,0)
 I '$T S CHAR="***" Q
"RTN","%ZVEMKR",96,0)
 S CHAR=CHAR_$S(CHAR1=65:"AU",CHAR1=66:"AD",CHAR1=67:"AR",CHAR1=68:"AL",CHAR1=80:"F1",CHAR1=81:"F2",CHAR1=83:"F4",1:CHAR1)
"RTN","%ZVEMKR",97,0)
 Q
"RTN","%ZVEMKR",98,0)
OTHER ;Pageup,Pagedown,Home,End
"RTN","%ZVEMKR",99,0)
 R *CHAR:50
"RTN","%ZVEMKR",100,0)
 I '$T S CHAR="***" Q
"RTN","%ZVEMKR",101,0)
 ;--> <PGUP>,<PGDN>,<HOME>,<END>
"RTN","%ZVEMKR",102,0)
 S CHAR=$S(CHAR=73:"PGUP",CHAR=81:"PGDN",CHAR=71:"HOME",CHAR=79:"END",1:CHAR)
"RTN","%ZVEMKR",103,0)
 Q
"RTN","%ZVEMKR",104,0)
OTHERDTM ;Pageup,Pagedown,Home,End,Delete - DataTree
"RTN","%ZVEMKR",105,0)
 R *CHAR1:50
"RTN","%ZVEMKR",106,0)
 I ('$T)!(CHAR1'=126) S CHAR="***" Q
"RTN","%ZVEMKR",107,0)
 S CHAR=$S(CHAR=49:"HOME",CHAR=52:"END",CHAR=53:"PGUP",CHAR=54:"PGDN",CHAR=51:"DEL",1:"***")
"RTN","%ZVEMKR",108,0)
 Q
"RTN","%ZVEMKR",109,0)
INIT ;
"RTN","%ZVEMKR",110,0)
 I $G(VEE("OS"))']"" D OS^%ZVEMKY Q:FLAGQ
"RTN","%ZVEMKR",111,0)
 I $G(VEE("TIME"))'>0 D TIME^%ZVEMKY
"RTN","%ZVEMKR",112,0)
 I $G(VEE("EON"))']"" D ECHO^%ZVEMKY1
"RTN","%ZVEMKR",113,0)
 I $G(VEE("EOFF"))']"" D ECHO^%ZVEMKY1
"RTN","%ZVEMKR",114,0)
 S (STRING,VEE("K"))=""
"RTN","%ZVEMKR",115,0)
 S PROMPT=$G(PROMPT),LENGTH=$S($G(LENGTH)>0:LENGTH,1:245)
"RTN","%ZVEMKR",116,0)
 Q
"RTN","%ZVEMKRN")
0^55^B15013571
"RTN","%ZVEMKRN",1,0)
%ZVEMKRN ;DJB,KRN**NEW Single Character Read ; 1/15/01 2:25pm
"RTN","%ZVEMKRN",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMKRN",3,0)
 ;
"RTN","%ZVEMKRN",4,0)
READ(PROMPT,LENGTH,NOECHO) ;
"RTN","%ZVEMKRN",5,0)
 ;PROMPT  Display prompt.
"RTN","%ZVEMKRN",6,0)
 ;LENGTH  Maximum # of characters user may enter.
"RTN","%ZVEMKRN",7,0)
 ;NOECHO  1=Do not echo what user types.
"RTN","%ZVEMKRN",8,0)
 ;
"RTN","%ZVEMKRN",9,0)
 ;Return: Character(s) user entered
"RTN","%ZVEMKRN",10,0)
 ;             -or-
"RTN","%ZVEMKRN",11,0)
 ;        VEE("K") = If user hits a non-printable key, it's returned
"RTN","%ZVEMKRN",12,0)
 ;                   in this variable enclosed in angle brackets.
"RTN","%ZVEMKRN",13,0)
 ;                   Example: <BS> or <ESC>
"RTN","%ZVEMKRN",14,0)
 ;
"RTN","%ZVEMKRN",15,0)
 NEW CHAR,CHAR1,CHAR2,CLEAR,FLAGQ,I,STRING,TEST,Y
"RTN","%ZVEMKRN",16,0)
 S FLAGQ=0
"RTN","%ZVEMKRN",17,0)
 D INIT I FLAGQ Q "<OS>"
"RTN","%ZVEMKRN",18,0)
 W PROMPT
"RTN","%ZVEMKRN",19,0)
 X VEE("TRMON")
"RTN","%ZVEMKRN",20,0)
 X VEE("EOFF")
"RTN","%ZVEMKRN",21,0)
 ;
"RTN","%ZVEMKRN",22,0)
 F  D GETCHAR D  Q:($L(STRING)'<LENGTH)!FLAGQ
"RTN","%ZVEMKRN",23,0)
 . I CHAR?1E S STRING=STRING_CHAR Q
"RTN","%ZVEMKRN",24,0)
 . I ",<BS>,<DEL>,"[(","_CHAR_","),$L(STRING) D  Q
"RTN","%ZVEMKRN",25,0)
 .. S STRING=$E(STRING,1,$L(STRING)-1)
"RTN","%ZVEMKRN",26,0)
 .. W $C(8)," ",$C(8)
"RTN","%ZVEMKRN",27,0)
 . S FLAGQ=1
"RTN","%ZVEMKRN",28,0)
 . S:('$L(STRING)) VEE("K")=CHAR
"RTN","%ZVEMKRN",29,0)
 ;
"RTN","%ZVEMKRN",30,0)
 X VEE("TRMOFF")
"RTN","%ZVEMKRN",31,0)
 X VEE("EON")
"RTN","%ZVEMKRN",32,0)
 Q STRING
"RTN","%ZVEMKRN",33,0)
 ;
"RTN","%ZVEMKRN",34,0)
GETCHAR ;Single character READ to get individual characters
"RTN","%ZVEMKRN",35,0)
 R CHAR#1:VEE("TIME")
"RTN","%ZVEMKRN",36,0)
 I '$T S CHAR="<TO>" Q
"RTN","%ZVEMKRN",37,0)
 I $A(CHAR)>31,$A(CHAR)<127 W:$G(NOECHO)'=1 CHAR Q
"RTN","%ZVEMKRN",38,0)
 X VEE("TRMRD") S CHAR=Y
"RTN","%ZVEMKRN",39,0)
 D:(CHAR=0) OTHER
"RTN","%ZVEMKRN",40,0)
 D:(CHAR=27) ESCAPE
"RTN","%ZVEMKRN",41,0)
 I (CHAR="***") W $C(7) G GETCHAR
"RTN","%ZVEMKRN",42,0)
 S CHAR=$S(CHAR<0:"TO",CHAR=4:"CTRLD",CHAR=8:"BS",CHAR=9:"TAB",CHAR=13:"RET",CHAR=20:"CTRLT",1:CHAR)
"RTN","%ZVEMKRN",43,0)
 S CHAR=$S(CHAR=21:"F1",CHAR=22:"F2",CHAR=23:"F3",CHAR=24:"F4",CHAR=27:"ESC",CHAR=127:"DEL",1:CHAR)
"RTN","%ZVEMKRN",44,0)
 S CHAR="<"_CHAR_">"
"RTN","%ZVEMKRN",45,0)
 Q
"RTN","%ZVEMKRN",46,0)
 ;====================================================================
"RTN","%ZVEMKRN",47,0)
ESCAPE ;Process Escape Sequences
"RTN","%ZVEMKRN",48,0)
 ;<ESCD>,<ESC1>,<ESCAU>, etc.
"RTN","%ZVEMKRN",49,0)
 S TEST=0
"RTN","%ZVEMKRN",50,0)
 R *CHAR:50
"RTN","%ZVEMKRN",51,0)
 I '$T S CHAR=-1 Q
"RTN","%ZVEMKRN",52,0)
 I CHAR=91 D CURSOR Q
"RTN","%ZVEMKRN",53,0)
 I CHAR=79 D FKEYS Q
"RTN","%ZVEMKRN",54,0)
 I CHAR>31,CHAR<97 S CHAR="ESC"_$C(CHAR) Q
"RTN","%ZVEMKRN",55,0)
 I CHAR>122,CHAR<127 S CHAR="ESC"_$C(CHAR) Q
"RTN","%ZVEMKRN",56,0)
 ;Convert lower case to uppercase
"RTN","%ZVEMKRN",57,0)
 I CHAR>96,CHAR<123 S CHAR=CHAR-32,CHAR="ESC"_$C(CHAR) Q
"RTN","%ZVEMKRN",58,0)
 ;Clean up. See if user hit ESC ESC
"RTN","%ZVEMKRN",59,0)
 F I=1:1:10 R *CLEAR:0 S:$T TEST=1
"RTN","%ZVEMKRN",60,0)
 Q:('TEST)&(CHAR=27)  S CHAR="***"
"RTN","%ZVEMKRN",61,0)
 Q
"RTN","%ZVEMKRN",62,0)
CURSOR ;Arrow Keys
"RTN","%ZVEMKRN",63,0)
 ;<AU>,<AD>,<AL>,<AR>
"RTN","%ZVEMKRN",64,0)
 R *CHAR:50
"RTN","%ZVEMKRN",65,0)
 S CHAR=$S(CHAR=65:"AU",CHAR=66:"AD",CHAR=67:"AR",CHAR=68:"AL",CHAR=72:"HOME",CHAR=75:"END",1:CHAR)
"RTN","%ZVEMKRN",66,0)
 I "1,3,4,5,6"[$C(CHAR) D OTHERDTM Q  ;"Other" Keys under DTM
"RTN","%ZVEMKRN",67,0)
 Q
"RTN","%ZVEMKRN",68,0)
PFKEYS ;F Keys. Call here when F Keys are to be used alone
"RTN","%ZVEMKRN",69,0)
 R *CHAR:50
"RTN","%ZVEMKRN",70,0)
 S CHAR=$S(CHAR=80:"F1",CHAR=81:"F2",CHAR=82:"F3",CHAR=83:"F4",1:CHAR)
"RTN","%ZVEMKRN",71,0)
 Q
"RTN","%ZVEMKRN",72,0)
FKEYS ;F Keys. Use F1,F2,F4 with cursor keys, F3 alone.
"RTN","%ZVEMKRN",73,0)
 R *CHAR:50
"RTN","%ZVEMKRN",74,0)
 I '$T S CHAR="***" Q
"RTN","%ZVEMKRN",75,0)
 I CHAR=82 S CHAR="F3" Q
"RTN","%ZVEMKRN",76,0)
 S CHAR=$S(CHAR=80:"F1",CHAR=81:"F2",CHAR=83:"F4",1:"***")
"RTN","%ZVEMKRN",77,0)
 Q:(CHAR="***")
"RTN","%ZVEMKRN",78,0)
FKEYS1 R *CHAR1:50
"RTN","%ZVEMKRN",79,0)
 I '$T S CHAR="***" Q
"RTN","%ZVEMKRN",80,0)
 ;
"RTN","%ZVEMKRN",81,0)
 ;--> <F1-1> thru <F1-9>
"RTN","%ZVEMKRN",82,0)
 I CHAR1>48,CHAR1<53 D  Q
"RTN","%ZVEMKRN",83,0)
 . F I=49:1:52 I CHAR1=I S CHAR=CHAR_"-"_(I-48) Q
"RTN","%ZVEMKRN",84,0)
 ;
"RTN","%ZVEMKRN",85,0)
 ;--> <F1A>,<F2B>, etc.
"RTN","%ZVEMKRN",86,0)
 I CHAR1>31,CHAR1<49 S CHAR=CHAR_$C(CHAR1) Q
"RTN","%ZVEMKRN",87,0)
 I CHAR1>52,CHAR1<97 S CHAR=CHAR_$C(CHAR1) Q
"RTN","%ZVEMKRN",88,0)
 I CHAR1>122,CHAR1<127 S CHAR=CHAR_$C(CHAR1) Q
"RTN","%ZVEMKRN",89,0)
 ;Convert lowercase to uppercase
"RTN","%ZVEMKRN",90,0)
 I CHAR1>96,CHAR<123 S CHAR1=CHAR1-32,CHAR=CHAR_$C(CHAR1) Q
"RTN","%ZVEMKRN",91,0)
 I CHAR1'=27 R *CHAR:0 S CHAR="***" Q
"RTN","%ZVEMKRN",92,0)
 ;
"RTN","%ZVEMKRN",93,0)
 ;--> <F1AU>,<F1AD>,<F1AL>,<F1AR>
"RTN","%ZVEMKRN",94,0)
 R *CHAR1:50
"RTN","%ZVEMKRN",95,0)
 ;Look for arrow keys, or F1,2,4 keys struck twice.
"RTN","%ZVEMKRN",96,0)
 I ('$T)!((CHAR1'=91)&(CHAR1'=79)) R *CHAR2:0 S CHAR="***" Q
"RTN","%ZVEMKRN",97,0)
 R *CHAR1:50
"RTN","%ZVEMKRN",98,0)
 I '$T S CHAR="***" Q
"RTN","%ZVEMKRN",99,0)
 S CHAR=CHAR_$S(CHAR1=65:"AU",CHAR1=66:"AD",CHAR1=67:"AR",CHAR1=68:"AL",CHAR1=80:"F1",CHAR1=81:"F2",CHAR1=83:"F4",1:CHAR1)
"RTN","%ZVEMKRN",100,0)
 Q
"RTN","%ZVEMKRN",101,0)
OTHER ;Pageup,Pagedown,Home,End
"RTN","%ZVEMKRN",102,0)
 R *CHAR:50
"RTN","%ZVEMKRN",103,0)
 I '$T S CHAR="***" Q
"RTN","%ZVEMKRN",104,0)
 ;--> <PGUP>,<PGDN>,<HOME>,<END>
"RTN","%ZVEMKRN",105,0)
 S CHAR=$S(CHAR=73:"PGUP",CHAR=81:"PGDN",CHAR=71:"HOME",CHAR=79:"END",1:CHAR)
"RTN","%ZVEMKRN",106,0)
 Q
"RTN","%ZVEMKRN",107,0)
OTHERDTM ;Pageup,Pagedown,Home,End,Delete - DataTree
"RTN","%ZVEMKRN",108,0)
 R *CHAR1:50
"RTN","%ZVEMKRN",109,0)
 I '$T!(CHAR1'=126) S CHAR="***" Q
"RTN","%ZVEMKRN",110,0)
 S CHAR=$S(CHAR=49:"HOME",CHAR=52:"END",CHAR=53:"PGUP",CHAR=54:"PGDN",CHAR=51:"DEL",1:"***")
"RTN","%ZVEMKRN",111,0)
 Q
"RTN","%ZVEMKRN",112,0)
INIT ;
"RTN","%ZVEMKRN",113,0)
 I $G(VEE("OS"))']"" D OS^%ZVEMKY Q:FLAGQ
"RTN","%ZVEMKRN",114,0)
 I $G(VEE("TIME"))'>0 D TIME^%ZVEMKY
"RTN","%ZVEMKRN",115,0)
 I $G(VEE("EON"))']"" D ECHO^%ZVEMKY1
"RTN","%ZVEMKRN",116,0)
 I $G(VEE("EOFF"))']"" D ECHO^%ZVEMKY1
"RTN","%ZVEMKRN",117,0)
 I $G(VEE("TRMON"))']"" D TRMREAD^%ZVEMKY1
"RTN","%ZVEMKRN",118,0)
 S (STRING,VEE("K"))=""
"RTN","%ZVEMKRN",119,0)
 S PROMPT=$G(PROMPT),LENGTH=$S($G(LENGTH)>0:LENGTH,1:245)
"RTN","%ZVEMKRN",120,0)
 Q
"RTN","%ZVEMKST")
0^56^B6300535
"RTN","%ZVEMKST",1,0)
%ZVEMKST ;DJB,KRN**Save Symbol Table [07/22/94]
"RTN","%ZVEMKST",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMKST",3,0)
 ;
"RTN","%ZVEMKST",4,0)
SYMTAB(ACTION,MODULE,SESSION) ; Symbol Table
"RTN","%ZVEMKST",5,0)
 ;ACTION ....: C=Clear  R=Restore  S=Save
"RTN","%ZVEMKST",6,0)
 ;MODULE ....: VEDD  VGL  VRR
"RTN","%ZVEMKST",7,0)
 ;SESSION ...: Number (VGL=Session number  VRR=Rtn Number)
"RTN","%ZVEMKST",8,0)
 Q:",C,R,S,"'[(","_$G(ACTION)_",")
"RTN","%ZVEMKST",9,0)
 Q:",VEDD,VEDDL,VGL,VRR,"'[(","_$G(MODULE)_",")
"RTN","%ZVEMKST",10,0)
 S:$G(SESSION)'>0 SESSION=1
"RTN","%ZVEMKST",11,0)
 I ACTION="C" D SAVE,CLEAR Q  ;Clear symbol table
"RTN","%ZVEMKST",12,0)
 I ACTION="R" D RESTORE Q  ;Restore symbol table
"RTN","%ZVEMKST",13,0)
 I ACTION="S" D SAVE Q  ;Save symbol table
"RTN","%ZVEMKST",14,0)
 Q
"RTN","%ZVEMKST",15,0)
SAVE ;Save symbol table.
"RTN","%ZVEMKST",16,0)
 KILL ^TMP("VEE","SYMTAB",$J,MODULE,SESSION)
"RTN","%ZVEMKST",17,0)
 Q:'$$EXIST^%ZVEMKU("%ZOSV")
"RTN","%ZVEMKST",18,0)
 NEW %,%X,%Y,%ZISOS,X,Y
"RTN","%ZVEMKST",19,0)
 S X="^TMP(""VEE"",""SYMTAB"","_$J_","""_MODULE_""","_SESSION_","
"RTN","%ZVEMKST",20,0)
 D DOLRO^%ZOSV
"RTN","%ZVEMKST",21,0)
 Q
"RTN","%ZVEMKST",22,0)
CLEAR ;Clear symbol table (Save certain variables)
"RTN","%ZVEMKST",23,0)
 Q:'$D(^TMP("VEE","SYMTAB",$J,MODULE,SESSION))
"RTN","%ZVEMKST",24,0)
 NEW %HLD,%PC,%REF,%VAR
"RTN","%ZVEMKST",25,0)
 S %REF="^TMP(""VEE"",""SYMTAB"","_$J_","""_MODULE_""","_SESSION_")"
"RTN","%ZVEMKST",26,0)
 S %HLD="""VEE"",""SYMTAB"","_$J_","""_MODULE_""","_SESSION_","
"RTN","%ZVEMKST",27,0)
 F  S %REF=$Q(@%REF) Q:%REF=""!(%REF'[%HLD)  D
"RTN","%ZVEMKST",28,0)
 . F %PC=1:1:10 Q:$P(%REF,",",%PC)["SYMTAB"  ;%PC varies with translation
"RTN","%ZVEMKST",29,0)
 . S %VAR=$P(%REF,",",(%PC+4)),%VAR=$P(%VAR,"""",2) ;Strip quotes
"RTN","%ZVEMKST",30,0)
 . I $P(%REF,",",(%PC+5))]""  S %VAR=%VAR_"("_$P(%REF,",",(%PC+5),99)
"RTN","%ZVEMKST",31,0)
 . I $E(%VAR,1,3)="DUZ"!($E(%VAR,1,2)="IO") Q
"RTN","%ZVEMKST",32,0)
 . I $E(%VAR,1,3)="VEE" Q
"RTN","%ZVEMKST",33,0)
 . I ",FLAGVPE,GLS,U,VEDDS,VRRS,"[(","_%VAR_",") Q  ;Module counters
"RTN","%ZVEMKST",34,0)
 . I ",%HLD,%PC,%REF,%VAR,"[(","_%VAR_",") Q  ;Used by RESTORE
"RTN","%ZVEMKST",35,0)
 . KILL @%VAR
"RTN","%ZVEMKST",36,0)
 . Q
"RTN","%ZVEMKST",37,0)
 Q
"RTN","%ZVEMKST",38,0)
RESTORE ;Restore symbol table.
"RTN","%ZVEMKST",39,0)
 Q:'$D(^TMP("VEE","SYMTAB",$J,MODULE,SESSION))
"RTN","%ZVEMKST",40,0)
 NEW %HLD,%PC,%REF,%VAR
"RTN","%ZVEMKST",41,0)
 S %REF="^TMP(""VEE"",""SYMTAB"","_$J_","""_MODULE_""","_SESSION_")"
"RTN","%ZVEMKST",42,0)
 S %HLD="""VEE"",""SYMTAB"","_$J_","""_MODULE_""","_SESSION_","
"RTN","%ZVEMKST",43,0)
 F  S %REF=$Q(@%REF) Q:%REF=""!(%REF'[%HLD)  D
"RTN","%ZVEMKST",44,0)
 . F %PC=1:1:10 Q:$P(%REF,",",%PC)["SYMTAB"  ;PC varies with translation
"RTN","%ZVEMKST",45,0)
 . S %VAR=$P(%REF,",",(%PC+4)),%VAR=$P(%VAR,"""",2) ;Strip quotes
"RTN","%ZVEMKST",46,0)
 . I $P(%REF,",",(%PC+5))]""  S %VAR=%VAR_"("_$P(%REF,",",(%PC+5),99)
"RTN","%ZVEMKST",47,0)
 . I ",%HLD,%PC,%REF,%VAR,,X,Y,"[(","_%VAR_",") Q  ;Used by RESTORE
"RTN","%ZVEMKST",48,0)
 . S @%VAR=@%REF
"RTN","%ZVEMKST",49,0)
 . Q
"RTN","%ZVEMKST",50,0)
 KILL ^TMP("VEE","SYMTAB",$J,MODULE,SESSION)
"RTN","%ZVEMKST",51,0)
 Q
"RTN","%ZVEMKT")
0^57^B22043150
"RTN","%ZVEMKT",1,0)
%ZVEMKT ;DJB,KRN**Txt Scroll-Start ; 11/16/00 8:14am
"RTN","%ZVEMKT",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMKT",3,0)
 ;
"RTN","%ZVEMKT",4,0)
IMPORT ;Display imported text passed in variable VEET
"RTN","%ZVEMKT",5,0)
 NEW X S X="ERROR^%ZVEMKT2",@$S($D(^%ZOSF("TRAP")):^("TRAP"),1:"$ZT=X") KILL X ;Keep this local for speed.
"RTN","%ZVEMKT",6,0)
 X VEET("GET")
"RTN","%ZVEMKT",7,0)
 D LIST^%ZVEMKT1
"RTN","%ZVEMKT",8,0)
 Q
"RTN","%ZVEMKT",9,0)
 ;
"RTN","%ZVEMKT",10,0)
IMPORTS(PKG) ;START - Call here BEFORE calling IMPORT
"RTN","%ZVEMKT",11,0)
 ;PKG=Calling package (G=VGL).
"RTN","%ZVEMKT",12,0)
 NEW TYPE
"RTN","%ZVEMKT",13,0)
 S TYPE="I"
"RTN","%ZVEMKT",14,0)
 KILL ^TMP("VEE",PKG,$J)
"RTN","%ZVEMKT",15,0)
 S FLAGQ=0
"RTN","%ZVEMKT",16,0)
 D INIT Q:FLAGQ  D INIT1,INIT2
"RTN","%ZVEMKT",17,0)
 S VEET("IMPORT")="YES"
"RTN","%ZVEMKT",18,0)
 D SCROLL^%ZVEMKT2()
"RTN","%ZVEMKT",19,0)
 Q
"RTN","%ZVEMKT",20,0)
 ;
"RTN","%ZVEMKT",21,0)
IMPORTF ;FINISH - Call here AFTER calling IMPORT
"RTN","%ZVEMKT",22,0)
 G:'$D(VEET) EX
"RTN","%ZVEMKT",23,0)
 I '$G(FLAGQ) S VEET=" <> <> <>" D IMPORT
"RTN","%ZVEMKT",24,0)
 D ENDSCR^%ZVEMKT2
"RTN","%ZVEMKT",25,0)
 G EX
"RTN","%ZVEMKT",26,0)
 ;====================================================================
"RTN","%ZVEMKT",27,0)
GLB(GLB,VEEMODE,VEEPAGE) ;Display a global
"RTN","%ZVEMKT",28,0)
 ;GLB=Global. Example: ^VA(200)
"RTN","%ZVEMKT",29,0)
 ;VEEMODE="SC"    Display without scrolling (for screen capture).
"RTN","%ZVEMKT",30,0)
 ;VEEPAGE=Number  Used when VEEMODE="SC".
"RTN","%ZVEMKT",31,0)
 ;                Pause after that many nodes display.
"RTN","%ZVEMKT",32,0)
 I $G(GLB)']"" D  Q
"RTN","%ZVEMKT",33,0)
 . W !?1,"You must include a global reference..",!
"RTN","%ZVEMKT",34,0)
 D  Q:GLB=""
"RTN","%ZVEMKT",35,0)
 . NEW X S X="ERROR^%ZVEMKT",@($$TRAP^%ZVEMKU1) KILL X
"RTN","%ZVEMKT",36,0)
 . I GLB["(",$E(GLB,$L(GLB))'=")" S GLB=GLB_")"
"RTN","%ZVEMKT",37,0)
 . I '$D(@(GLB)) S GLB="" ;Check for valid glb
"RTN","%ZVEMKT",38,0)
 NEW GLBHLD,TYPE
"RTN","%ZVEMKT",39,0)
 S GLBHLD=$P(GLB,")",1)
"RTN","%ZVEMKT",40,0)
 S TYPE="G"
"RTN","%ZVEMKT",41,0)
 I GLBHLD?1"^[".E S GLBHLD="^"_$P(GLBHLD,"]",2)
"RTN","%ZVEMKT",42,0)
 I GLBHLD?1"^|".E S GLBHLD="^"_$P(GLBHLD,"|",3)
"RTN","%ZVEMKT",43,0)
 G TOP
"RTN","%ZVEMKT",44,0)
 ;
"RTN","%ZVEMKT",45,0)
RTN(RTN,TAG) ;;RTN=Routine,TAG=LineTag
"RTN","%ZVEMKT",46,0)
 ;;If TAG, use Help text format. TYPE=R..Routine  TYPE=H..Help text
"RTN","%ZVEMKT",47,0)
 I $G(RTN)["^" F  S RTN=$P(RTN,"^",2,99) Q:RTN'["^"
"RTN","%ZVEMKT",48,0)
 Q:$G(RTN)']""
"RTN","%ZVEMKT",49,0)
 Q:'$$EXIST^%ZVEMKU(RTN)
"RTN","%ZVEMKT",50,0)
 NEW TYPE
"RTN","%ZVEMKT",51,0)
 S TYPE="R",TAG=$G(TAG)
"RTN","%ZVEMKT",52,0)
 I TAG]"" S TYPE="H"
"RTN","%ZVEMKT",53,0)
 G TOP
"RTN","%ZVEMKT",54,0)
 ;
"RTN","%ZVEMKT",55,0)
VERSION(IEN) ;;Display a routine from the Version file.
"RTN","%ZVEMKT",56,0)
 ;;IEN to file 19200.112
"RTN","%ZVEMKT",57,0)
 Q:'$G(IEN)
"RTN","%ZVEMKT",58,0)
 Q:'$D(^VEE(19200.112,IEN,"WP"))
"RTN","%ZVEMKT",59,0)
 NEW GLB,TYPE
"RTN","%ZVEMKT",60,0)
 S TYPE="V"
"RTN","%ZVEMKT",61,0)
 S GLB="^VEE(19200.112,"_IEN_",""WP"",0)"
"RTN","%ZVEMKT",62,0)
 G TOP
"RTN","%ZVEMKT",63,0)
 ;
"RTN","%ZVEMKT",64,0)
HELP(GLB) ;;GLB=Help text title for VPE VShell. Example: DIE
"RTN","%ZVEMKT",65,0)
 Q:$G(GLB)']""
"RTN","%ZVEMKT",66,0)
 S GLB="^%ZVEMS(""ZZ"","""_GLB_""")"
"RTN","%ZVEMKT",67,0)
 D  Q:GLB=""  ;Check for valid global
"RTN","%ZVEMKT",68,0)
 . NEW X S X="ERROR^%ZVEMKT",@($$TRAP^%ZVEMKU1) KILL X
"RTN","%ZVEMKT",69,0)
 . I '$D(@(GLB)) S GLB=""
"RTN","%ZVEMKT",70,0)
 NEW GLBHLD,TYPE
"RTN","%ZVEMKT",71,0)
 S GLBHLD=$P(GLB,")",1)
"RTN","%ZVEMKT",72,0)
 S TYPE="G"
"RTN","%ZVEMKT",73,0)
 G TOP
"RTN","%ZVEMKT",74,0)
 ;
"RTN","%ZVEMKT",75,0)
LIST(GLB,FM) ;;Generic Lister.
"RTN","%ZVEMKT",76,0)
 ;GLB=Global containing choices.
"RTN","%ZVEMKT",77,0)
 ;FM=1 if you want to list a Fileman word processing field.
"RTN","%ZVEMKT",78,0)
 ;   Example: D LIST^%ZVEMKT("^VEE(19200.114,2,""WP"",0)")
"RTN","%ZVEMKT",79,0)
 ;                   NOTE--Always reference zero node ^
"RTN","%ZVEMKT",80,0)
 Q:$G(GLB)']""
"RTN","%ZVEMKT",81,0)
 Q:GLB'?1.E1"("1.E1")"
"RTN","%ZVEMKT",82,0)
 D  Q:GLB=""  ;Check for valid global
"RTN","%ZVEMKT",83,0)
 . NEW X S X="ERROR^%ZVEMKT",@($$TRAP^%ZVEMKU1) KILL X
"RTN","%ZVEMKT",84,0)
 . I '$D(@(GLB)) S GLB=""
"RTN","%ZVEMKT",85,0)
 NEW GLBHLD,TYPE
"RTN","%ZVEMKT",86,0)
 S GLBHLD=$P(GLB,")",1)
"RTN","%ZVEMKT",87,0)
 S TYPE="L"
"RTN","%ZVEMKT",88,0)
 I $G(FM) S GLBHLD=$P(GLBHLD,",",1,$L(GLBHLD,",")-1)
"RTN","%ZVEMKT",89,0)
 G TOP
"RTN","%ZVEMKT",90,0)
 ;
"RTN","%ZVEMKT",91,0)
SELECT(GLB,NUMBER,NEW,TEMPLATE) ;;Generic Selector.
"RTN","%ZVEMKT",92,0)
 ;GLB.....: Global containing choices.
"RTN","%ZVEMKT",93,0)
 ;NUMBER..: If 1, number each line.
"RTN","%ZVEMKT",94,0)
 ;NEW.....: If 1, allow adding new entry
"RTN","%ZVEMKT",95,0)
 ;TEMPLATE: Array of preselected nodes
"RTN","%ZVEMKT",96,0)
 ;
"RTN","%ZVEMKT",97,0)
 Q:$G(GLB)']""
"RTN","%ZVEMKT",98,0)
 Q:GLB'?1.E1"("1.E1")"
"RTN","%ZVEMKT",99,0)
 D  Q:GLB=""  ;Error trap to check if valid global
"RTN","%ZVEMKT",100,0)
 . NEW X S X="ERROR^%ZVEMKT",@($$TRAP^%ZVEMKU1) KILL X
"RTN","%ZVEMKT",101,0)
 . I '$D(@(GLB)) S GLB=""
"RTN","%ZVEMKT",102,0)
 NEW GLBHLD,TYPE
"RTN","%ZVEMKT",103,0)
 S GLBHLD=$P(GLB,")",1)
"RTN","%ZVEMKT",104,0)
 S TYPE="S"
"RTN","%ZVEMKT",105,0)
 G TOP^%ZVEMKTS
"RTN","%ZVEMKT",106,0)
 ;====================================================================
"RTN","%ZVEMKT",107,0)
TOP ;
"RTN","%ZVEMKT",108,0)
 NEW X S X="ERROR^%ZVEMKT2",@($$TRAP^%ZVEMKU1) KILL X
"RTN","%ZVEMKT",109,0)
 NEW DX,DY,FLAGQ,VEET
"RTN","%ZVEMKT",110,0)
 NEW:'$D(VEE) VEE
"RTN","%ZVEMKT",111,0)
 NEW:'$D(VEES) VEES
"RTN","%ZVEMKT",112,0)
 KILL ^TMP("VEE","K",$J) ;"K" for VPE Kernel rtn
"RTN","%ZVEMKT",113,0)
 S FLAGQ=0
"RTN","%ZVEMKT",114,0)
 D INIT G:FLAGQ EX D INIT1,INIT2
"RTN","%ZVEMKT",115,0)
 I $G(VEEMODE)="SC" W @VEE("IOF") D LISTSC^%ZVEMKT1 G EX
"RTN","%ZVEMKT",116,0)
 W @VEE("IOF") D SCROLL^%ZVEMKT2()
"RTN","%ZVEMKT",117,0)
 D LIST^%ZVEMKT1,ENDSCR^%ZVEMKT2
"RTN","%ZVEMKT",118,0)
EX ;
"RTN","%ZVEMKT",119,0)
 KILL ^TMP("VEE","K",$J)
"RTN","%ZVEMKT",120,0)
 Q
"RTN","%ZVEMKT",121,0)
 ;
"RTN","%ZVEMKT",122,0)
INIT ;Screen variables
"RTN","%ZVEMKT",123,0)
 I '$D(VEE("OS")) D OS^%ZVEMKY Q:FLAGQ
"RTN","%ZVEMKT",124,0)
 D IO^%ZVEMKY
"RTN","%ZVEMKT",125,0)
 D REVVID^%ZVEMKY2
"RTN","%ZVEMKT",126,0)
 D SCRNVAR^%ZVEMKY2
"RTN","%ZVEMKT",127,0)
 D BLANK^%ZVEMKY3
"RTN","%ZVEMKT",128,0)
 D CRSROFF^%ZVEMKY2
"RTN","%ZVEMKT",129,0)
 D SCRL^%ZVEMKY2
"RTN","%ZVEMKT",130,0)
 Q
"RTN","%ZVEMKT",131,0)
 ;
"RTN","%ZVEMKT",132,0)
INIT1 ;Scroll area, Header, Footer
"RTN","%ZVEMKT",133,0)
 NEW LINE,MAR
"RTN","%ZVEMKT",134,0)
 S MAR=$G(VEE("IOM")) S:MAR'>0 MAR=80
"RTN","%ZVEMKT",135,0)
 S $P(LINE,"=",MAR)=""
"RTN","%ZVEMKT",136,0)
 S:'$D(VEET("S1")) VEET("S1")=2 ;S1 to S2 is the scroll region
"RTN","%ZVEMKT",137,0)
 S:'$D(VEET("S2")) VEET("S2")=(VEE("IOSL")-2)
"RTN","%ZVEMKT",138,0)
 I '$D(VEET("HD")) S VEET("HD")=1,VEET("HD",1)=LINE ;Header
"RTN","%ZVEMKT",139,0)
 I '$D(VEET("FT")) S VEET("FT")=2 D  ;Footer
"RTN","%ZVEMKT",140,0)
 . S VEET("FT",1)=LINE,VEET("FT",2)="<>  <ESC>H=ScrollHelp  F=Find  L=Locate"
"RTN","%ZVEMKT",141,0)
 S:'$D(VEET("GET")) VEET("GET")="D GET"_TYPE_"^%ZVEMKTG"
"RTN","%ZVEMKT",142,0)
 KILL TYPE
"RTN","%ZVEMKT",143,0)
 Q
"RTN","%ZVEMKT",144,0)
 ;
"RTN","%ZVEMKT",145,0)
INIT2 ;Scroller variables
"RTN","%ZVEMKT",146,0)
 S (VEET("GAP"),VEET("SL"))=VEET("S2")-VEET("S1")+1
"RTN","%ZVEMKT",147,0)
 S (VEET("BOT"),VEET("LNCNT"),VEET("TOP"))=1
"RTN","%ZVEMKT",148,0)
 S VEET("HLN")=1 ;Highlight line #
"RTN","%ZVEMKT",149,0)
 S VEET("H$Y")=VEET("S1")-1 ;Highlight line $Y
"RTN","%ZVEMKT",150,0)
 Q
"RTN","%ZVEMKT",151,0)
 ;
"RTN","%ZVEMKT",152,0)
ERROR ;
"RTN","%ZVEMKT",153,0)
 S GLB=""
"RTN","%ZVEMKT",154,0)
 W $C(7),!?1,"Invalid global reference..",!
"RTN","%ZVEMKT",155,0)
 Q
"RTN","%ZVEMKT1")
0^58^B14147838
"RTN","%ZVEMKT1",1,0)
%ZVEMKT1 ;DJB,KRN**Txt Scroll-List TEXT [8/20/98 10:25am]
"RTN","%ZVEMKT1",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMKT1",3,0)
 ;
"RTN","%ZVEMKT1",4,0)
GETVEET ;Set VEET=Display text
"RTN","%ZVEMKT1",5,0)
 I $D(^TMP("VEE","K",$J,VEET("BOT"))) S VEET=^(VEET("BOT")) Q
"RTN","%ZVEMKT1",6,0)
 Q:$G(VEET("IMPORT"))="YES"
"RTN","%ZVEMKT1",7,0)
 X VEET("GET") S VEET=$G(^TMP("VEE","K",$J,VEET("BOT")))
"RTN","%ZVEMKT1",8,0)
 Q
"RTN","%ZVEMKT1",9,0)
LIST ;Display text
"RTN","%ZVEMKT1",10,0)
 D GETVEET W !,VEET
"RTN","%ZVEMKT1",11,0)
 S VEET("BOT")=VEET("BOT")+1 ;Bottom line #
"RTN","%ZVEMKT1",12,0)
 S:VEET("GAP") VEET("GAP")=VEET("GAP")-1 ;Empty lines left on page
"RTN","%ZVEMKT1",13,0)
 I VEET=" <> <> <>"!'VEET("GAP") D READ Q:FLAGQ
"RTN","%ZVEMKT1",14,0)
 I $G(VEET("IMPORT"))="YES",'$D(^TMP("VEE","K",$J,VEET("BOT"))) Q
"RTN","%ZVEMKT1",15,0)
 G LIST
"RTN","%ZVEMKT1",16,0)
ENDFILE() ;1=End-of-file  0=Ok
"RTN","%ZVEMKT1",17,0)
 I VEET("GAP") W $C(7) Q 1
"RTN","%ZVEMKT1",18,0)
 I ^TMP("VEE","K",$J,VEET("BOT")-1)=" <> <> <>" W $C(7) Q 1
"RTN","%ZVEMKT1",19,0)
 Q 0
"RTN","%ZVEMKT1",20,0)
READ ;Get input
"RTN","%ZVEMKT1",21,0)
 I $G(VEET("FIND"))]"" D FINDCHK Q:$G(VEET("FIND"))]""  ;Find text
"RTN","%ZVEMKT1",22,0)
 NEW KEY,VK
"RTN","%ZVEMKT1",23,0)
READ1 S KEY=$$READ^%ZVEMKRN("",1,1),KEY=$$ALLCAPS^%ZVEMKU(KEY),VK=VEE("K")
"RTN","%ZVEMKT1",24,0)
 I VK="<AU>" W:VEET("TOP")'>1 $C(7) D:VEET("TOP")>1 UP("K") G READ1
"RTN","%ZVEMKT1",25,0)
 I VK="<AD>" G:$$ENDFILE() READ1 D DOWN Q
"RTN","%ZVEMKT1",26,0)
 I ",<ESC>,<F1E>,<F1Q>,<TO>,"[(","_VK_",") S FLAGQ=1 Q
"RTN","%ZVEMKT1",27,0)
 I KEY="^" S FLAGQ=1 Q
"RTN","%ZVEMKT1",28,0)
 I KEY=" " G READ1
"RTN","%ZVEMKT1",29,0)
 I KEY="?"!(VK="<ESCH>") D  Q
"RTN","%ZVEMKT1",30,0)
 . D HELP^%ZVEMKT2,REDRAW^%ZVEMKT2()
"RTN","%ZVEMKT1",31,0)
 I KEY="F"!(KEY="L") D FIND(KEY) Q
"RTN","%ZVEMKT1",32,0)
 I ",<PGUP>,<F4AU>,"[(","_VK_",")!(KEY="U") W:VEET("TOP")'>1 $C(7) G:VEET("TOP")'>1 READ1 D LEFT Q
"RTN","%ZVEMKT1",33,0)
 I ",<PGDN>,<F4AD>,<RET>,"[(","_VK_",")!(KEY="D") G:$$ENDFILE() READ1 D RIGHT Q
"RTN","%ZVEMKT1",34,0)
 I ",<HOME>,<F4AL>,"[(","_VK_",")!(KEY="T") S VEET("TOP")=1 D REDRAW^%ZVEMKT2() Q
"RTN","%ZVEMKT1",35,0)
 I ",<END>,<F4AR>,"[(","_VK_",")!(KEY="B") D BOTTOM^%ZVEMKT2() Q
"RTN","%ZVEMKT1",36,0)
 G READ1
"RTN","%ZVEMKT1",37,0)
 ;====================================================================
"RTN","%ZVEMKT1",38,0)
UP(PKG) ;Insert text at top.
"RTN","%ZVEMKT1",39,0)
 ;PKG=Calling package..."IG"_GLS=VGL,"K"=Generic
"RTN","%ZVEMKT1",40,0)
 S DX=0,DY=(VEET("S1")-2) X VEES("CRSR")
"RTN","%ZVEMKT1",41,0)
 W @VEES("INDEX"),@VEES("INSRT") X VEES("CRSR")
"RTN","%ZVEMKT1",42,0)
 I VEET("GAP") S VEET("GAP")=VEET("GAP")-1
"RTN","%ZVEMKT1",43,0)
 E  S VEET("BOT")=VEET("BOT")-1
"RTN","%ZVEMKT1",44,0)
 S VEET("TOP")=VEET("TOP")-1
"RTN","%ZVEMKT1",45,0)
 Q:^TMP("VEE",PKG,$J,VEET("TOP"))=" <> <> <>"  W !,^(VEET("TOP"))
"RTN","%ZVEMKT1",46,0)
 Q
"RTN","%ZVEMKT1",47,0)
DOWN ;Insert text at bottom
"RTN","%ZVEMKT1",48,0)
 S DX=0,DY=(VEET("S2")-1) X VEES("CRSR")
"RTN","%ZVEMKT1",49,0)
 S VEET("TOP")=VEET("TOP")+1
"RTN","%ZVEMKT1",50,0)
 Q
"RTN","%ZVEMKT1",51,0)
LEFT ;Back up a page
"RTN","%ZVEMKT1",52,0)
 S (VEET("BOT"),VEET("TOP"))=$S(VEET("TOP")>VEET("SL"):VEET("TOP")-VEET("SL"),1:1)
"RTN","%ZVEMKT1",53,0)
 S VEET("GAP")=VEET("SL") D SCROLL^%ZVEMKT2()
"RTN","%ZVEMKT1",54,0)
 Q
"RTN","%ZVEMKT1",55,0)
RIGHT ;Go forward a page
"RTN","%ZVEMKT1",56,0)
 S VEET("TOP")=VEET("BOT"),VEET("GAP")=VEET("SL")
"RTN","%ZVEMKT1",57,0)
 D SCROLL^%ZVEMKT2()
"RTN","%ZVEMKT1",58,0)
 Q
"RTN","%ZVEMKT1",59,0)
FIND(TYPE) ;
"RTN","%ZVEMKT1",60,0)
 D ENDSCR^%ZVEMKT2
"RTN","%ZVEMKT1",61,0)
 W !!?1,"S C R O L L E R   F I N D   U T I L I T Y"
"RTN","%ZVEMKT1",62,0)
 W !!?1,"Enter characters that you want the scroller to search for."
"RTN","%ZVEMKT1",63,0)
 W !?1,"If found, the line containing these characters will appear"
"RTN","%ZVEMKT1",64,0)
 W !?1,"at the bottom of the screen. If ""<> <> <>"" appears at the"
"RTN","%ZVEMKT1",65,0)
 W !?1,"bottom of the screen, you've reached the end of the display."
"RTN","%ZVEMKT1",66,0)
 W !!?1,"Enter CHARACTERS: "
"RTN","%ZVEMKT1",67,0)
 R VEET("FIND"):300 I '$T KILL VEET("FIND")
"RTN","%ZVEMKT1",68,0)
 D REDRAW^%ZVEMKT2()
"RTN","%ZVEMKT1",69,0)
 I $G(VEET("FIND"))']"" KILL VEET("FIND") Q
"RTN","%ZVEMKT1",70,0)
 S VEET("FIND")=TYPE_"^"_VEET("FIND")
"RTN","%ZVEMKT1",71,0)
 Q
"RTN","%ZVEMKT1",72,0)
FINDCHK ;Find text
"RTN","%ZVEMKT1",73,0)
 NEW FIND,TXT,TXT1,TYPE
"RTN","%ZVEMKT1",74,0)
 I VEET=" <> <> <>" W $C(7) KILL VEET("FIND") Q
"RTN","%ZVEMKT1",75,0)
 S TXT=$G(^TMP("VEE","K",$J,VEET("BOT")-1)) Q:TXT']""
"RTN","%ZVEMKT1",76,0)
 S TXT1=$S(TXT[$C(9):$P(TXT,$C(9),2,99),1:TXT)
"RTN","%ZVEMKT1",77,0)
 S TYPE=$P(VEET("FIND"),"^",1),FIND=$P(VEET("FIND"),"^",2,99)
"RTN","%ZVEMKT1",78,0)
 I TYPE="L",TXT[FIND KILL VEET("FIND") Q
"RTN","%ZVEMKT1",79,0)
 I TYPE="F" D  I $E(TXT1,1,$L(FIND))=FIND KILL VEET("FIND") Q
"RTN","%ZVEMKT1",80,0)
 . ;Remove leading numbers and spaces
"RTN","%ZVEMKT1",81,0)
 . F  Q:$E(TXT1)?1A!(TXT1']"")  S TXT1=$E(TXT1,2,99)
"RTN","%ZVEMKT1",82,0)
 S VEET("TOP")=VEET("TOP")+1
"RTN","%ZVEMKT1",83,0)
 Q
"RTN","%ZVEMKT1",84,0)
LISTSC ;Display text with no pause, for Screen capture
"RTN","%ZVEMKT1",85,0)
 D GETVEET Q:VEET=" <> <> <>"  W !,VEET
"RTN","%ZVEMKT1",86,0)
 I $G(VEEPAGE)>0,VEET("BOT")#VEEPAGE=0 D PAUSE^%ZVEMKU(2,"Q") Q:FLAGQ  W @VEE("IOF")
"RTN","%ZVEMKT1",87,0)
 S VEET("BOT")=VEET("BOT")+1 ;Bottom line #
"RTN","%ZVEMKT1",88,0)
 G LISTSC
"RTN","%ZVEMKT2")
0^59^B9094397
"RTN","%ZVEMKT2",1,0)
%ZVEMKT2 ;DJB,KRN**Txt Scroll-Other,Help ; 11/14/02 6:59am
"RTN","%ZVEMKT2",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMKT2",3,0)
 ;
"RTN","%ZVEMKT2",4,0)
SCROLL(CRSRON) ;End scroll, do form feed, start scroll
"RTN","%ZVEMKT2",5,0)
 D ENDSCR,STARTSCR($G(CRSRON))
"RTN","%ZVEMKT2",6,0)
 Q
"RTN","%ZVEMKT2",7,0)
STARTSCR(CRSRON) ;Start Scroll Region
"RTN","%ZVEMKT2",8,0)
 ;CRSRON=If 1, leave on cursor
"RTN","%ZVEMKT2",9,0)
 NEW I
"RTN","%ZVEMKT2",10,0)
 X VEES("RM0")
"RTN","%ZVEMKT2",11,0)
 I '$G(CRSRON) W @VEES("COFF")
"RTN","%ZVEMKT2",12,0)
 D SCROLL^%ZVEMKY2(VEET("S1"),VEET("S2"))
"RTN","%ZVEMKT2",13,0)
 W @VEE("IOF")
"RTN","%ZVEMKT2",14,0)
 I VEE("OS")=9 D  ;DTM-Blank screen below scroll area
"RTN","%ZVEMKT2",15,0)
 . S DX=0,DY=VEET("S2") X VEES("CRSR") W @VEES("BLANK_C_EOS")
"RTN","%ZVEMKT2",16,0)
 S DX=0,DY=VEET("S2")
"RTN","%ZVEMKT2",17,0)
 F I=1:1:VEET("FT") X VEES("CRSR") W VEET("FT",I) S DY=DY+1
"RTN","%ZVEMKT2",18,0)
 S DX=0,DY=VEET("S1")-VEET("HD")-1
"RTN","%ZVEMKT2",19,0)
 F I=1:1:VEET("HD") X VEES("CRSR") W VEET("HD",I) S DY=DY+1
"RTN","%ZVEMKT2",20,0)
 Q
"RTN","%ZVEMKT2",21,0)
ENDSCR ;End Scroll Region
"RTN","%ZVEMKT2",22,0)
 D SCROLL^%ZVEMKY2(1,VEE("IOSL"))
"RTN","%ZVEMKT2",23,0)
 I $D(VEES("CON")) W @VEES("CON")
"RTN","%ZVEMKT2",24,0)
 X VEES("RM80") W @VEE("IOF")
"RTN","%ZVEMKT2",25,0)
 Q
"RTN","%ZVEMKT2",26,0)
BOTTOM(PKG,CRSRON) ;Move to last line displayed.
"RTN","%ZVEMKT2",27,0)
 ; PKG    - Package
"RTN","%ZVEMKT2",28,0)
 ; CRSRON - If 1, tell REDRAW to leave on cursor
"RTN","%ZVEMKT2",29,0)
 ;
"RTN","%ZVEMKT2",30,0)
 NEW X
"RTN","%ZVEMKT2",31,0)
 S X=999999999
"RTN","%ZVEMKT2",32,0)
 S:$G(PKG)']"" PKG="K"
"RTN","%ZVEMKT2",33,0)
 F  S X=+$O(^TMP("VEE",PKG,$J,X),-1) Q:X=0  Q:$G(^(X))'=" <> <> <>"
"RTN","%ZVEMKT2",34,0)
 S VEET("TOP")=$S(X>0:X,1:1)
"RTN","%ZVEMKT2",35,0)
 D REDRAW($G(CRSRON))
"RTN","%ZVEMKT2",36,0)
 Q
"RTN","%ZVEMKT2",37,0)
REDRAW(CRSRON) ;Redraw screen after running a menu selection
"RTN","%ZVEMKT2",38,0)
 ;CRSRON=If 1, tell STARTSCR to leave on cursor
"RTN","%ZVEMKT2",39,0)
 S VEET("BOT")=VEET("TOP")
"RTN","%ZVEMKT2",40,0)
 S VEET("GAP")=VEET("SL")
"RTN","%ZVEMKT2",41,0)
 S VEET("HLN")=VEET("TOP")
"RTN","%ZVEMKT2",42,0)
 S VEET("H$Y")=VEET("S1")-1
"RTN","%ZVEMKT2",43,0)
 D SCROLL($G(CRSRON))
"RTN","%ZVEMKT2",44,0)
 Q
"RTN","%ZVEMKT2",45,0)
HELP ;
"RTN","%ZVEMKT2",46,0)
 D ENDSCR
"RTN","%ZVEMKT2",47,0)
 W !?25,"V P E   S C R O L L E R"
"RTN","%ZVEMKT2",48,0)
 W !,"The display you are viewing is utilizing the VPE generic scroller."
"RTN","%ZVEMKT2",49,0)
 W !,"Displays that use this scroller are marked with ""<>"" at the extreme"
"RTN","%ZVEMKT2",50,0)
 W !,"left side of the bar menu located at the bottom of the screen."
"RTN","%ZVEMKT2",51,0)
 W !!?4,"<ARROW UP> ..........: Move up one line"
"RTN","%ZVEMKT2",52,0)
 W !?4,"<ARROW DOWN> ........: Move down one line"
"RTN","%ZVEMKT2",53,0)
 ;W !?4,"<F1><AU> ............: Move highlight to screen top"
"RTN","%ZVEMKT2",54,0)
 ;W !?4,"<F1><AD> ............: Move highlight to screen bottom"
"RTN","%ZVEMKT2",55,0)
 W !?4,"U,<F4><AU> ..........: Move up one page"
"RTN","%ZVEMKT2",56,0)
 W !?4,"D,<F4><AD>,<RETURN> .: Move down one page"
"RTN","%ZVEMKT2",57,0)
 W !?4,"T,<F4><AL>,<HOME> ...: Move to page 1"
"RTN","%ZVEMKT2",58,0)
 W !?4,"B,<F4><AR>,<END> ....: Move to bottom (Last line displayed)"
"RTN","%ZVEMKT2",59,0)
 W !?4,"^,<ESC><ESC>,<F1>E,<F1>Q ..: Quit"
"RTN","%ZVEMKT2",60,0)
 W !?4,"F ...................: Find characters (Look on left side of line only)"
"RTN","%ZVEMKT2",61,0)
 W !?4,"L ...................: Locate characters (Anywhere in the line)"
"RTN","%ZVEMKT2",62,0)
 W !!,"If you hear a beep when you hit any of the above keys, you have reached"
"RTN","%ZVEMKT2",63,0)
 W !,"the top or bottom of the display and can go no further."
"RTN","%ZVEMKT2",64,0)
 D PAUSE^%ZVEMKC(1)
"RTN","%ZVEMKT2",65,0)
 Q
"RTN","%ZVEMKT2",66,0)
ERROR ;Error Trap
"RTN","%ZVEMKT2",67,0)
 S FLAGQ=1
"RTN","%ZVEMKT2",68,0)
 KILL ^TMP("VEE","K",$J)
"RTN","%ZVEMKT2",69,0)
 D ENDSCR,ERRMSG^%ZVEMKU1("SCROLLER"),PAUSE^%ZVEMKU(2)
"RTN","%ZVEMKT2",70,0)
 Q
"RTN","%ZVEMKTF")
0^60^B8528062
"RTN","%ZVEMKTF",1,0)
%ZVEMKTF ;DJB,KRN**Txt Scroll-Select FM Fields [2/1/97 10:23am]
"RTN","%ZVEMKTF",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMKTF",3,0)
 Q
"RTN","%ZVEMKTF",4,0)
SELECT(VEEFILE,VEELEVEL) ;Use Selector to get fields from a FM file.
"RTN","%ZVEMKTF",5,0)
 ;VEEFILE=File DD number
"RTN","%ZVEMKTF",6,0)
 ;VEELEVEL: TOP=Top level flds only  ALL=Include multiple fields
"RTN","%ZVEMKTF",7,0)
 ;Return array: ^TMP("VPE","FIELDS",$J,File#,Field#)
"RTN","%ZVEMKTF",8,0)
 ;
"RTN","%ZVEMKTF",9,0)
 Q:'$G(VEEFILE)
"RTN","%ZVEMKTF",10,0)
 I '$D(^DIC) D  Q
"RTN","%ZVEMKTF",11,0)
 . W $C(7),!!,"Fileman doesn't exist in this UCI",!
"RTN","%ZVEMKTF",12,0)
 . D PAUSE^%ZVEMKU(2,"P")
"RTN","%ZVEMKTF",13,0)
 I '$D(^DIC(VEEFILE,0)) D  Q
"RTN","%ZVEMKTF",14,0)
 . W $C(7),!!,"This file is missing from ^DIC",!
"RTN","%ZVEMKTF",15,0)
 NEW FILENAM,FLDNAM
"RTN","%ZVEMKTF",16,0)
 KILL ^TMP("VEE",$J)
"RTN","%ZVEMKTF",17,0)
 S:$G(VEELEVEL)'="TOP" VEELEVEL="ALL"
"RTN","%ZVEMKTF",18,0)
 S FILENAM=$P($G(^DIC(VEEFILE,0)),U,1)
"RTN","%ZVEMKTF",19,0)
 D BUILD Q:'$D(^TMP("VEE",$J))
"RTN","%ZVEMKTF",20,0)
 S ^TMP("VEE",$J,"HD")="   "_FILENAM_" file"
"RTN","%ZVEMKTF",21,0)
 D SELECT^%ZVEMKT("^TMP(""VEE"","_$J_")")
"RTN","%ZVEMKTF",22,0)
 D CONVERT
"RTN","%ZVEMKTF",23,0)
 KILL ^TMP("VPE","SELECT",$J)
"RTN","%ZVEMKTF",24,0)
 Q
"RTN","%ZVEMKTF",25,0)
BUILD ;Loop and get fields
"RTN","%ZVEMKTF",26,0)
 NEW BAR,CNT,DASHES,DATA,FILE,FLD,I,LEV,NP,PIECE,SPACE,SYM,TMP
"RTN","%ZVEMKTF",27,0)
 S (CNT,LEV)=1,FILE(LEV)=VEEFILE,FLD(LEV)=0
"RTN","%ZVEMKTF",28,0)
 I VEELEVEL="ALL" D BUILDA Q  ;...All flds
"RTN","%ZVEMKTF",29,0)
 D BUILDT ;....................Top level flds only
"RTN","%ZVEMKTF",30,0)
 Q
"RTN","%ZVEMKTF",31,0)
BUILDA ;Get all fields
"RTN","%ZVEMKTF",32,0)
 S FLD(LEV)=$O(^DD(FILE(LEV),FLD(LEV)))
"RTN","%ZVEMKTF",33,0)
 I +FLD(LEV)=0 S LEV=LEV-1 Q:'LEV  G BUILDA
"RTN","%ZVEMKTF",34,0)
 D DASH,SET ;..................Add dashes for each mult level
"RTN","%ZVEMKTF",35,0)
 I PIECE=0 S LEV=LEV+1,FILE(LEV)=+$P(DATA,U,2),FLD(LEV)=0
"RTN","%ZVEMKTF",36,0)
 G BUILDA
"RTN","%ZVEMKTF",37,0)
BUILDT ;Get only top level fields
"RTN","%ZVEMKTF",38,0)
 F  S FLD(LEV)=$O(^DD(FILE(LEV),FLD(LEV))) Q:'FLD(LEV)  D DASH,SET
"RTN","%ZVEMKTF",39,0)
 Q
"RTN","%ZVEMKTF",40,0)
DASH ;Add dashes for each mult level
"RTN","%ZVEMKTF",41,0)
 S (SPACE,BAR)=""
"RTN","%ZVEMKTF",42,0)
 F I=1:1:LEV-1 S SPACE=SPACE_" ",BAR=BAR_"-"
"RTN","%ZVEMKTF",43,0)
 S DASHES=SPACE_BAR
"RTN","%ZVEMKTF",44,0)
 Q
"RTN","%ZVEMKTF",45,0)
SET ;Set Selector array nodes
"RTN","%ZVEMKTF",46,0)
 S DATA=$G(^DD(FILE(LEV),FLD(LEV),0)) Q:DATA']""
"RTN","%ZVEMKTF",47,0)
 S FLDNAM=$P(DATA,U),SYM=$P(DATA,U,2)
"RTN","%ZVEMKTF",48,0)
 I SYM]"" S SYM="["_SYM_"]"
"RTN","%ZVEMKTF",49,0)
 S NP=$S($P(DATA,U,4)=" ; ":"Computed",1:$P(DATA,U,4))
"RTN","%ZVEMKTF",50,0)
 S PIECE=$P($P(DATA,U,4),";",2)
"RTN","%ZVEMKTF",51,0)
 I PIECE=0 Q:VEELEVEL'="ALL"  D  I 1
"RTN","%ZVEMKTF",52,0)
 . NEW TMP
"RTN","%ZVEMKTF",53,0)
 . S TMP="<-Mult"
"RTN","%ZVEMKTF",54,0)
 . I $P($G(^DD(+$P(DATA,U,2),.01,0)),U,2)["W" S TMP="<-WP"
"RTN","%ZVEMKTF",55,0)
 . S SYM=TMP_" "_SYM
"RTN","%ZVEMKTF",56,0)
 . I $G(^DD(FILE(LEV),FLD(LEV),8))]"" S SYM="R:"_^(8)_" "_SYM
"RTN","%ZVEMKTF",57,0)
 . I $G(^(8.5))]"" S SYM="D:"_^(8.5)_" "_SYM
"RTN","%ZVEMKTF",58,0)
 . I $G(^(9))]"" S SYM="W:"_^(9)_" "_SYM
"RTN","%ZVEMKTF",59,0)
 E  I $P(DATA,U,2)["P"!($P(DATA,U,2)["V") D
"RTN","%ZVEMKTF",60,0)
 . NEW TMP
"RTN","%ZVEMKTF",61,0)
 . S TMP="<-Pntr "
"RTN","%ZVEMKTF",62,0)
 . I $P(DATA,U,2)["V" S TMP=TMP_"Var"
"RTN","%ZVEMKTF",63,0)
 . S SYM=TMP_" "_SYM
"RTN","%ZVEMKTF",64,0)
 S TMP=DASHES_NP
"RTN","%ZVEMKTF",65,0)
 S TMP=TMP_$J("",12-$L(TMP))_$J(FLD(LEV),8)
"RTN","%ZVEMKTF",66,0)
 S TMP=TMP_$J("",23-$L(TMP))_DASHES_FLDNAM
"RTN","%ZVEMKTF",67,0)
 S TMP=TMP_$J("",76-$L(TMP)-$L(SYM)-1)_SYM
"RTN","%ZVEMKTF",68,0)
 S ^TMP("VEE",$J,CNT)=FILE(LEV)_";"_FLD(LEV)_$C(9)_TMP
"RTN","%ZVEMKTF",69,0)
 S CNT=CNT+1
"RTN","%ZVEMKTF",70,0)
 Q
"RTN","%ZVEMKTF",71,0)
CONVERT ;Sort Selector array into "File#,Field#" order
"RTN","%ZVEMKTF",72,0)
 NEW DATA,FIELD,FILE,X
"RTN","%ZVEMKTF",73,0)
 KILL ^TMP("VEE",$J)
"RTN","%ZVEMKTF",74,0)
 S X=0
"RTN","%ZVEMKTF",75,0)
 F  S X=$O(^TMP("VPE","SELECT",$J,X)) Q:'X  D  ;
"RTN","%ZVEMKTF",76,0)
 . S DATA=$G(^(X)) Q:DATA']""
"RTN","%ZVEMKTF",77,0)
 . S DATA=$P(DATA,$C(9),1)
"RTN","%ZVEMKTF",78,0)
 . S FILE=$P(DATA,";",1),FIELD=$P(DATA,";",2)
"RTN","%ZVEMKTF",79,0)
 . S ^TMP("VPE","FIELDS",$J,FILE,FIELD)=""
"RTN","%ZVEMKTF",80,0)
 Q
"RTN","%ZVEMKTG")
0^61^B16365161
"RTN","%ZVEMKTG",1,0)
%ZVEMKTG ;DJB,KRN**Txt Scroll-Get array ; 11/16/00 8:18am
"RTN","%ZVEMKTG",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMKTG",3,0)
 ;
"RTN","%ZVEMKTG",4,0)
GETG ;Get VEET from a GLOBAL
"RTN","%ZVEMKTG",5,0)
 NEW CHK,LN,MAR,NUM,TMP
"RTN","%ZVEMKTG",6,0)
 S NUM=VEET("BOT")
"RTN","%ZVEMKTG",7,0)
 S MAR=$G(VEE("IOM")) I MAR'>0 S MAR=80
"RTN","%ZVEMKTG",8,0)
 I $G(GLB)']"" S ^TMP("VEE","K",$J,NUM)=" <> <> <>" Q
"RTN","%ZVEMKTG",9,0)
 I $G(VEEMODE)="SC",'$D(^TMP("VEE","K",$J)),$D(@GLB)#2 G GETG1
"RTN","%ZVEMKTG",10,0)
 S GLB=$Q(@GLB)
"RTN","%ZVEMKTG",11,0)
 S CHK=0
"RTN","%ZVEMKTG",12,0)
 D  I CHK S ^TMP("VEE","K",$J,NUM)=" <> <> <>" Q
"RTN","%ZVEMKTG",13,0)
 . I GLB="" S CHK=1 Q
"RTN","%ZVEMKTG",14,0)
 . S TMP=GLB
"RTN","%ZVEMKTG",15,0)
 . I GLB?1"^[".E S TMP="^"_$P(GLB,"]",2)
"RTN","%ZVEMKTG",16,0)
 . I GLB?1"^|".E S TMP="^"_$P(GLB,"|",3)
"RTN","%ZVEMKTG",17,0)
 . I $E(TMP,1,$L(GLBHLD))'=GLBHLD S CHK=1 Q
"RTN","%ZVEMKTG",18,0)
 ;
"RTN","%ZVEMKTG",19,0)
 ;;I GLB["%ZVEMS" only display GLB value. It's VPE Help text.
"RTN","%ZVEMKTG",20,0)
GETG1 S @("LN="_GLB)
"RTN","%ZVEMKTG",21,0)
 I GLB'["%ZVEMS" S LN=GLB_" = "_LN
"RTN","%ZVEMKTG",22,0)
 F NUM=VEET("BOT"):1 D  Q:LN']""
"RTN","%ZVEMKTG",23,0)
 . S ^TMP("VEE","K",$J,NUM)=$E(LN,1,MAR-2)
"RTN","%ZVEMKTG",24,0)
 . S LN=$E(LN,MAR-1,999) Q:LN']""
"RTN","%ZVEMKTG",25,0)
 . I $L(GLB)<40 S LN=$J("",$L(GLB))_" = "_LN Q
"RTN","%ZVEMKTG",26,0)
 . S LN="          = "_LN
"RTN","%ZVEMKTG",27,0)
 Q
"RTN","%ZVEMKTG",28,0)
 ;
"RTN","%ZVEMKTG",29,0)
GETH ;Get VEET from a ROUTINE that's in Help text format
"RTN","%ZVEMKTG",30,0)
 NEW NUM,TXT
"RTN","%ZVEMKTG",31,0)
 S NUM=VEET("BOT")
"RTN","%ZVEMKTG",32,0)
 X "S TXT=$T("_TAG_"+"_VEET("LNCNT")_"^"_RTN_")"
"RTN","%ZVEMKTG",33,0)
 S VEET("LNCNT")=VEET("LNCNT")+1
"RTN","%ZVEMKTG",34,0)
 S:TXT']"" TXT=";;; <> <> <>"
"RTN","%ZVEMKTG",35,0)
 S ^TMP("VEE","K",$J,NUM)=$P(TXT,";;;",2,999)
"RTN","%ZVEMKTG",36,0)
 Q
"RTN","%ZVEMKTG",37,0)
 ;
"RTN","%ZVEMKTG",38,0)
GETI ;Get VEET from IMPORT
"RTN","%ZVEMKTG",39,0)
 NEW LN,MAR,NUM
"RTN","%ZVEMKTG",40,0)
 S MAR=$G(VEE("IOM")) I MAR'>0 S MAR=80
"RTN","%ZVEMKTG",41,0)
 S LN=VEET
"RTN","%ZVEMKTG",42,0)
 F NUM=VEET("BOT"):1 D  Q:LN']""
"RTN","%ZVEMKTG",43,0)
 . S ^TMP("VEE","K",$J,NUM)=$E(LN,1,MAR-2)
"RTN","%ZVEMKTG",44,0)
 . S LN=$E(LN,MAR-1,9999)
"RTN","%ZVEMKTG",45,0)
 Q
"RTN","%ZVEMKTG",46,0)
 ;
"RTN","%ZVEMKTG",47,0)
GETL ;Get VEET from a GLOBAL - Generic Lister
"RTN","%ZVEMKTG",48,0)
 NEW CHK,LN,NUM,TMP
"RTN","%ZVEMKTG",49,0)
 S NUM=VEET("BOT")
"RTN","%ZVEMKTG",50,0)
 I $G(GLB)']"" S ^TMP("VEE","K",$J,NUM)=" <> <> <>" Q
"RTN","%ZVEMKTG",51,0)
 S GLB=$Q(@GLB)
"RTN","%ZVEMKTG",52,0)
 S CHK=0
"RTN","%ZVEMKTG",53,0)
 D  I CHK S ^TMP("VEE","K",$J,NUM)=" <> <> <>" Q
"RTN","%ZVEMKTG",54,0)
 . I GLB="" S CHK=1 Q
"RTN","%ZVEMKTG",55,0)
 . I GLB["]" D  S:$E(TMP,1,$L(GLBHLD))'=GLBHLD CHK=1 Q
"RTN","%ZVEMKTG",56,0)
 . . S TMP=$P(GLB,"[",1)_$P(GLB,"]",2)
"RTN","%ZVEMKTG",57,0)
 . I GLB["|" D  S:$E(TMP,1,$L(GLBHLD))'=GLBHLD CHK=1 Q
"RTN","%ZVEMKTG",58,0)
 . . S TMP=$P(GLB,"|",1)_$P(GLB,"|",3)
"RTN","%ZVEMKTG",59,0)
 . I $E(GLB,1,$L(GLBHLD))'=GLBHLD S CHK=1 Q
"RTN","%ZVEMKTG",60,0)
 S @("LN="_GLB),^TMP("VEE","K",$J,NUM)=LN
"RTN","%ZVEMKTG",61,0)
 Q
"RTN","%ZVEMKTG",62,0)
 ;
"RTN","%ZVEMKTG",63,0)
GETR ;Get VEET from a ROUTINE
"RTN","%ZVEMKTG",64,0)
 NEW LN,MAR,NUM,TG,TXT
"RTN","%ZVEMKTG",65,0)
 S NUM=VEET("BOT")
"RTN","%ZVEMKTG",66,0)
 S MAR=$G(VEE("IOM")) I MAR'>0 S MAR=80
"RTN","%ZVEMKTG",67,0)
 X "S TXT=$T("_TAG_"+"_VEET("LNCNT")_"^"_RTN_")"
"RTN","%ZVEMKTG",68,0)
 I TXT']"" S ^TMP("VEE","K",$J,NUM)=" <> <> <>" Q
"RTN","%ZVEMKTG",69,0)
 S TG=$P(TXT," "),LN=$P(TXT," ",2,999)
"RTN","%ZVEMKTG",70,0)
 I TG]"" D  I 1
"RTN","%ZVEMKTG",71,0)
 . I $L(TG)>8 S LN=TG_LN Q
"RTN","%ZVEMKTG",72,0)
 . S LN=$J(TG,8)_" "_LN
"RTN","%ZVEMKTG",73,0)
 E  S LN=VEET("LNCNT")_$E("         ",1,9-$L(VEET("LNCNT")))_LN
"RTN","%ZVEMKTG",74,0)
 F NUM=VEET("BOT"):1 D  Q:LN']""
"RTN","%ZVEMKTG",75,0)
 . S ^TMP("VEE","K",$J,NUM)=$E(LN,1,MAR-2)
"RTN","%ZVEMKTG",76,0)
 . S LN=$E(LN,MAR-1,9999) Q:LN']""
"RTN","%ZVEMKTG",77,0)
 . S LN="         "_LN
"RTN","%ZVEMKTG",78,0)
 S VEET("LNCNT")=VEET("LNCNT")+1
"RTN","%ZVEMKTG",79,0)
 Q
"RTN","%ZVEMKTG",80,0)
 ;
"RTN","%ZVEMKTG",81,0)
GETS ;Get VEET from a GLOBAL - Generic Selector
"RTN","%ZVEMKTG",82,0)
 ;TOT is returned with count of entries
"RTN","%ZVEMKTG",83,0)
 NEW CHK,GLBN,LN,NUM,SUB,TMP
"RTN","%ZVEMKTG",84,0)
 S NUM=1,(SUB,TOT)=0
"RTN","%ZVEMKTG",85,0)
GETS1 S SUB=$O(@GLB@(SUB))
"RTN","%ZVEMKTG",86,0)
 S CHK=0
"RTN","%ZVEMKTG",87,0)
 D  I CHK S ^TMP("VEE","K",$J,NUM)=" <> <> <>" Q
"RTN","%ZVEMKTG",88,0)
 . I SUB'>0 S CHK=1 Q
"RTN","%ZVEMKTG",89,0)
 . S GLBN=GLBHLD_","_SUB_")"
"RTN","%ZVEMKTG",90,0)
 . I $O(@GLBN@(""))]"" S CHK=1 Q
"RTN","%ZVEMKTG",91,0)
 . I GLBN["]" D  S:$E(TMP,1,$L(GLBHLD))'=GLBHLD CHK=1 Q
"RTN","%ZVEMKTG",92,0)
 . . S TMP=$P(GLBN,"[",1)_$P(GLBN,"]",2)
"RTN","%ZVEMKTG",93,0)
 . I GLBN["|" D  S:$E(TMP,1,$L(GLBHLD))'=GLBHLD CHK=1 Q
"RTN","%ZVEMKTG",94,0)
 . . S TMP=$P(GLBN,"|",1)_$P(GLBN,"|",3)
"RTN","%ZVEMKTG",95,0)
 . I $E(GLBN,1,$L(GLBHLD))'=GLBHLD S CHK=1 Q
"RTN","%ZVEMKTG",96,0)
 S @("LN="_GLBN)
"RTN","%ZVEMKTG",97,0)
 S ^TMP("VEE","K",$J,NUM)=LN
"RTN","%ZVEMKTG",98,0)
 ;--> Set xref for FIND utility
"RTN","%ZVEMKTG",99,0)
 S ^TMP("VEE","K",$J,"B",$E($P(LN,$C(9),2),1,10),NUM)=""
"RTN","%ZVEMKTG",100,0)
 S TOT=NUM,NUM=NUM+1
"RTN","%ZVEMKTG",101,0)
 G GETS1
"RTN","%ZVEMKTG",102,0)
 ;
"RTN","%ZVEMKTG",103,0)
GETV ;Get VEET from Routine Version file (19200.112).
"RTN","%ZVEMKTG",104,0)
 NEW LN,MAR,NUM,TG,TXT
"RTN","%ZVEMKTG",105,0)
 S NUM=VEET("BOT")
"RTN","%ZVEMKTG",106,0)
 S MAR=$G(VEE("IOM")) I MAR'>0 S MAR=80
"RTN","%ZVEMKTG",107,0)
 ;
"RTN","%ZVEMKTG",108,0)
 I $G(GLB)']"" S ^TMP("VEE","K",$J,NUM)=" <> <> <>" Q
"RTN","%ZVEMKTG",109,0)
 S GLB=$Q(@GLB)
"RTN","%ZVEMKTG",110,0)
 I GLB="" S ^TMP("VEE","K",$J,NUM)=" <> <> <>" Q
"RTN","%ZVEMKTG",111,0)
 ;
"RTN","%ZVEMKTG",112,0)
 ;See if $QUERY has moved to a new IEN
"RTN","%ZVEMKTG",113,0)
 I $P(GLB,",",2)'=IEN S ^TMP("VEE","K",$J,NUM)=" <> <> <>" Q
"RTN","%ZVEMKTG",114,0)
 ;
"RTN","%ZVEMKTG",115,0)
 S @("TXT="_GLB)
"RTN","%ZVEMKTG",116,0)
 I TXT']"" S ^TMP("VEE","K",$J,NUM)=" <> <> <>" Q
"RTN","%ZVEMKTG",117,0)
 ;
"RTN","%ZVEMKTG",118,0)
 S TG=$P(TXT," "),LN=$P(TXT," ",2,999)
"RTN","%ZVEMKTG",119,0)
 I TG]"" D  I 1
"RTN","%ZVEMKTG",120,0)
 . I $L(TG)>8 S LN=TG_LN Q
"RTN","%ZVEMKTG",121,0)
 . S LN=$J(TG,8)_" "_LN
"RTN","%ZVEMKTG",122,0)
 E  S LN=VEET("LNCNT")_$E("         ",1,9-$L(VEET("LNCNT")))_LN
"RTN","%ZVEMKTG",123,0)
 F NUM=VEET("BOT"):1 D  Q:LN']""
"RTN","%ZVEMKTG",124,0)
 . S ^TMP("VEE","K",$J,NUM)=$E(LN,1,MAR-2)
"RTN","%ZVEMKTG",125,0)
 . S LN=$E(LN,MAR-1,9999) Q:LN']""
"RTN","%ZVEMKTG",126,0)
 . S LN="         "_LN
"RTN","%ZVEMKTG",127,0)
 S VEET("LNCNT")=VEET("LNCNT")+1
"RTN","%ZVEMKTG",128,0)
 Q
"RTN","%ZVEMKTM")
0^62^B9733691
"RTN","%ZVEMKTM",1,0)
%ZVEMKTM ;DJB,KRN**Txt Scroll-Highlight Menu [3/6/96 6:23pm]
"RTN","%ZVEMKTM",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMKTM",3,0)
 ;
"RTN","%ZVEMKTM",4,0)
ENDFILE() ;1=End-of-file  0=Ok
"RTN","%ZVEMKTM",5,0)
 I VEET("GAP") W $C(7) Q 1
"RTN","%ZVEMKTM",6,0)
 I $G(^TMP("VEE",PKG,$J,VEET("BOT")-1))=" <> <> <>"  W $C(7) Q 1
"RTN","%ZVEMKTM",7,0)
 Q 0
"RTN","%ZVEMKTM",8,0)
READ(PKG) ;PKG=Calling package's subscript ("IG"_GLS=VGL,"ID"_VEDDS=VEDD,etc)
"RTN","%ZVEMKTM",9,0)
 NEW HL,KEY,VK
"RTN","%ZVEMKTM",10,0)
READ1 I $G(TABHLD)]"" D  KILL TABHLD ;Keeps highlight at same node
"RTN","%ZVEMKTM",11,0)
 . S VEET("HLN")=$P(TABHLD,"^",1),VEET("H$Y")=$P(TABHLD,"^",2)
"RTN","%ZVEMKTM",12,0)
 D HIGHLITE("ON"),CURSOR^%ZVEMKU1(9,VEET("S2")+VEET("FT")-1,1)
"RTN","%ZVEMKTM",13,0)
 S KEY=$$READ^%ZVEMKRN(),KEY=$$ALLCAPS^%ZVEMKU(KEY),VK=VEE("K")
"RTN","%ZVEMKTM",14,0)
 I VK="<AU>" D  G READ1
"RTN","%ZVEMKTM",15,0)
 . I (VEET("HLN")-1)>VEET("TOP") D  Q
"RTN","%ZVEMKTM",16,0)
 . . D HIGHLITE("OFF") S VEET("HLN")=VEET("HLN")-1
"RTN","%ZVEMKTM",17,0)
 . . S VEET("H$Y")=VEET("H$Y")-1
"RTN","%ZVEMKTM",18,0)
 . I VEET("TOP")>1 D UP Q
"RTN","%ZVEMKTM",19,0)
 . W $C(7)
"RTN","%ZVEMKTM",20,0)
 I VK="<AD>",VEET("HLN")<VEET("BOT") D  G READ1
"RTN","%ZVEMKTM",21,0)
 . D HIGHLITE("OFF") S VEET("HLN")=VEET("HLN")+1
"RTN","%ZVEMKTM",22,0)
 . S VEET("H$Y")=VEET("H$Y")+1
"RTN","%ZVEMKTM",23,0)
 I VK="<AD>" G:$$ENDFILE() READ1 D DOWN Q "QUIT"
"RTN","%ZVEMKTM",24,0)
 I KEY=" " G READ1
"RTN","%ZVEMKTM",25,0)
 I KEY="^" S FLAGQ=1 Q "QUIT"
"RTN","%ZVEMKTM",26,0)
 I ",<ESC>,<F1E>,<F1Q>,<TO>,"[(","_VK_",") S FLAGQ=1 Q "QUIT"
"RTN","%ZVEMKTM",27,0)
 I KEY="?" Q KEY
"RTN","%ZVEMKTM",28,0)
 I VK="<ESCH>" Q VK
"RTN","%ZVEMKTM",29,0)
 I ",<HOME>,<F4AL>,"[(","_VK_",")!(KEY="T") S VEET("TOP")=1 D REDRAW^%ZVEMKT2() Q "QUIT"
"RTN","%ZVEMKTM",30,0)
 I ",<END>,<F4AR>,"[(","_VK_",")!(KEY="B") D BOTTOM^%ZVEMKT2(PKG) Q "QUIT"
"RTN","%ZVEMKTM",31,0)
 I VK="<F1AU>" D  G READ1
"RTN","%ZVEMKTM",32,0)
 . Q:(VEET("HLN")-1)'>VEET("TOP")
"RTN","%ZVEMKTM",33,0)
 . D HIGHLITE("OFF") S VEET("HLN")=VEET("TOP")+1
"RTN","%ZVEMKTM",34,0)
 . S VEET("H$Y")=VEET("S1")
"RTN","%ZVEMKTM",35,0)
 I VK="<F1AD>" D  G READ1
"RTN","%ZVEMKTM",36,0)
 . Q:VEET("HLN")'<VEET("BOT")
"RTN","%ZVEMKTM",37,0)
 . D HIGHLITE("OFF") S VEET("HLN")=VEET("BOT")
"RTN","%ZVEMKTM",38,0)
 . S VEET("H$Y")=$S(VEET("GAP"):VEET("S2")-VEET("GAP"),1:VEET("S2"))
"RTN","%ZVEMKTM",39,0)
 I ",<PGUP>,<F4AU>,"[(","_VK_",")!(KEY="U") W:VEET("TOP")'>1 $C(7) G:VEET("TOP")'>1 READ1 D LEFT Q "QUIT"
"RTN","%ZVEMKTM",40,0)
 I ",<PGDN>,<F4AD>,<RET>,"[(","_VK_",")!(KEY="D") G:$$ENDFILE() READ1 D RIGHT Q "QUIT"
"RTN","%ZVEMKTM",41,0)
 S:KEY']"" KEY=VK
"RTN","%ZVEMKTM",42,0)
 Q KEY
"RTN","%ZVEMKTM",43,0)
 ;===================================================================
"RTN","%ZVEMKTM",44,0)
UP ;Insert text at top.
"RTN","%ZVEMKTM",45,0)
 D HIGHLITE("OFF")
"RTN","%ZVEMKTM",46,0)
 S DX=0,DY=(VEET("S1")-2) X VEES("CRSR")
"RTN","%ZVEMKTM",47,0)
 W @VEES("INDEX"),@VEES("INSRT") X VEES("CRSR")
"RTN","%ZVEMKTM",48,0)
 I VEET("GAP") S VEET("GAP")=VEET("GAP")-1
"RTN","%ZVEMKTM",49,0)
 E  S VEET("BOT")=VEET("BOT")-1
"RTN","%ZVEMKTM",50,0)
 S VEET("TOP")=VEET("TOP")-1,VEET("HLN")=VEET("HLN")-1
"RTN","%ZVEMKTM",51,0)
 NEW TXT
"RTN","%ZVEMKTM",52,0)
 S TXT=$G(^TMP("VEE",PKG,$J,VEET("TOP")))
"RTN","%ZVEMKTM",53,0)
 Q:TXT=" <> <> <>"  I $G(VGLREV) D REVERSE^%ZVEMGI1(TXT) Q
"RTN","%ZVEMKTM",54,0)
 W !,TXT
"RTN","%ZVEMKTM",55,0)
 Q
"RTN","%ZVEMKTM",56,0)
DOWN ;Insert text at bottom
"RTN","%ZVEMKTM",57,0)
 D HIGHLITE("OFF")
"RTN","%ZVEMKTM",58,0)
 S DX=0,DY=(VEET("S2")-1) X VEES("CRSR")
"RTN","%ZVEMKTM",59,0)
 S VEET("TOP")=VEET("TOP")+1
"RTN","%ZVEMKTM",60,0)
 Q
"RTN","%ZVEMKTM",61,0)
LEFT ;Go back a page
"RTN","%ZVEMKTM",62,0)
 S VEET("TOP")=$S(VEET("TOP")>VEET("SL"):VEET("TOP")-VEET("SL"),1:1)
"RTN","%ZVEMKTM",63,0)
 S VEET("BOT")=VEET("TOP"),VEET("GAP")=VEET("SL")
"RTN","%ZVEMKTM",64,0)
 S VEET("HLN")=VEET("TOP"),VEET("H$Y")=VEET("S1")
"RTN","%ZVEMKTM",65,0)
 D SCROLL^%ZVEMKT2()
"RTN","%ZVEMKTM",66,0)
 Q
"RTN","%ZVEMKTM",67,0)
RIGHT ;Go forward a page
"RTN","%ZVEMKTM",68,0)
 S VEET("TOP")=VEET("BOT"),VEET("GAP")=VEET("SL")
"RTN","%ZVEMKTM",69,0)
 S VEET("HLN")=VEET("TOP"),VEET("H$Y")=VEET("S1")-1
"RTN","%ZVEMKTM",70,0)
 D SCROLL^%ZVEMKT2()
"RTN","%ZVEMKTM",71,0)
 Q
"RTN","%ZVEMKTM",72,0)
HIGHLITE(MODE) ; MODE="ON"  - Draw highlight
"RTN","%ZVEMKTM",73,0)
 ;      MODE="OFF" - Redraw with no highlight
"RTN","%ZVEMKTM",74,0)
 NEW HL I $G(MODE)'="ON" S MODE="OFF"
"RTN","%ZVEMKTM",75,0)
 S DX=0,DY=VEET("H$Y")-1 X VEES("CRSR")
"RTN","%ZVEMKTM",76,0)
 W:MODE="ON" @VEE("RON")
"RTN","%ZVEMKTM",77,0)
 S HL=$E($G(^TMP("VEE",PKG,$J,VEET("HLN")-1))) W $S(HL]"":HL,1:" ")
"RTN","%ZVEMKTM",78,0)
 W:MODE="ON" @VEE("ROFF")
"RTN","%ZVEMKTM",79,0)
 Q
"RTN","%ZVEMKTR")
0^63^B9585363
"RTN","%ZVEMKTR",1,0)
%ZVEMKTR ;DJB,KRN**Txt Scroll-Get REF Number [4/16/95 5:54am]
"RTN","%ZVEMKTR",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMKTR",3,0)
 ;
"RTN","%ZVEMKTR",4,0)
GETSCR(ND,PKG) ;Get scroll array equivilent for a given node
"RTN","%ZVEMKTR",5,0)
 ;ND=Node number from VGL display
"RTN","%ZVEMKTR",6,0)
 I $G(ND)'>0 Q 0
"RTN","%ZVEMKTR",7,0)
 I $G(PKG)']"" Q 0
"RTN","%ZVEMKTR",8,0)
 NEW X S X=0
"RTN","%ZVEMKTR",9,0)
 F  S X=$O(^TMP("VEE",PKG,$J,"SCR",X)) Q:X'>0  Q:^(X)=ND
"RTN","%ZVEMKTR",10,0)
 Q X
"RTN","%ZVEMKTR",11,0)
 ;====================================================================
"RTN","%ZVEMKTR",12,0)
GETREF(PKG) ;Get REF number. Return ^,***, or REF number 
"RTN","%ZVEMKTR",13,0)
 NEW DX,DY,REF,X I $G(PKG)']"" Q "^"
"RTN","%ZVEMKTR",14,0)
GETREF1 S DX=0,DY=(VEET("S2")+VEET("FT")-1)
"RTN","%ZVEMKTR",15,0)
 D CURSOR^%ZVEMKU1(DX,DY,1)
"RTN","%ZVEMKTR",16,0)
 W ?1,"Enter REF NUMBER: " S REF=$$READ^%ZVEMKRN()
"RTN","%ZVEMKTR",17,0)
 I REF="^" Q REF
"RTN","%ZVEMKTR",18,0)
 I ",<ESC>,<F1E>,<F1Q>,<RET>,<TO>,"[(","_VEE("K")_",") Q "^"
"RTN","%ZVEMKTR",19,0)
 I VEE("K")="<TAB>" D  Q REF
"RTN","%ZVEMKTR",20,0)
 . S REF=$G(^TMP("VEE",PKG,$J,"SCR",VEET("HLN")-1))
"RTN","%ZVEMKTR",21,0)
 . S:REF']"" REF="***"
"RTN","%ZVEMKTR",22,0)
 I VEE("K")?1"<A"1U1">" D  G GETREF1
"RTN","%ZVEMKTR",23,0)
 . I VEE("K")="<AU>" D  Q
"RTN","%ZVEMKTR",24,0)
 . . I VEET("HLN")-1=VEET("TOP") W $C(7) Q
"RTN","%ZVEMKTR",25,0)
 . . D HIGHLITE^%ZVEMKTM("OFF")
"RTN","%ZVEMKTR",26,0)
 . . S VEET("HLN")=VEET("HLN")-1,VEET("H$Y")=VEET("H$Y")-1
"RTN","%ZVEMKTR",27,0)
 . . D HIGHLITE^%ZVEMKTM("ON")
"RTN","%ZVEMKTR",28,0)
 . I VEE("K")="<AD>" D  Q
"RTN","%ZVEMKTR",29,0)
 . . I VEET("HLN")=VEET("BOT") W $C(7) Q
"RTN","%ZVEMKTR",30,0)
 . . D HIGHLITE^%ZVEMKTM("OFF")
"RTN","%ZVEMKTR",31,0)
 . . S VEET("HLN")=VEET("HLN")+1,VEET("H$Y")=VEET("H$Y")+1
"RTN","%ZVEMKTR",32,0)
 . . D HIGHLITE^%ZVEMKTM("ON")
"RTN","%ZVEMKTR",33,0)
 . I VEE("K")="<AL>" D  Q
"RTN","%ZVEMKTR",34,0)
 . . I VEET("HLN")-1=VEET("TOP") W $C(7) Q
"RTN","%ZVEMKTR",35,0)
 . . D HIGHLITE^%ZVEMKTM("OFF")
"RTN","%ZVEMKTR",36,0)
 . . S VEET("HLN")=VEET("TOP")+1,VEET("H$Y")=VEET("S1")
"RTN","%ZVEMKTR",37,0)
 . . D HIGHLITE^%ZVEMKTM("ON")
"RTN","%ZVEMKTR",38,0)
 . I VEE("K")="<AR>" D  Q
"RTN","%ZVEMKTR",39,0)
 . . I VEET("HLN")=VEET("BOT") W $C(7) Q
"RTN","%ZVEMKTR",40,0)
 . . D HIGHLITE^%ZVEMKTM("OFF")
"RTN","%ZVEMKTR",41,0)
 . . S VEET("HLN")=VEET("BOT"),VEET("H$Y")=VEET("S2")
"RTN","%ZVEMKTR",42,0)
 . . D HIGHLITE^%ZVEMKTM("ON")
"RTN","%ZVEMKTR",43,0)
 I $E(REF)="?"!(VEE("K")="<ESCH>") D MSG(1) G GETREF1
"RTN","%ZVEMKTR",44,0)
 I REF'>0!(REF'?1.N) W $C(7) D MSG(1) G GETREF1
"RTN","%ZVEMKTR",45,0)
 Q REF
"RTN","%ZVEMKTR",46,0)
 ;====================================================================
"RTN","%ZVEMKTR",47,0)
GETRANG(PKG) ;Get range of nodes. Return ^ or range of REF numbers
"RTN","%ZVEMKTR",48,0)
 NEW DX,DY,I,REF,REF1,REF2 Q:$G(PKG)']""
"RTN","%ZVEMKTR",49,0)
GETRANG1 S DX=0,DY=(VEET("S2")+VEET("FT")-1)
"RTN","%ZVEMKTR",50,0)
 D CURSOR^%ZVEMKU1(DX,DY,1)
"RTN","%ZVEMKTR",51,0)
 W ?1,"Enter REF NUMBERS(S): "
"RTN","%ZVEMKTR",52,0)
 R REF:VEE("TIME") S:'$T REF="^" I "^"[REF Q "^"
"RTN","%ZVEMKTR",53,0)
 I REF?1.N1"-"1.N D  G:REF']"" GETRANG1 Q REF
"RTN","%ZVEMKTR",54,0)
 . S REF1=$P(REF,"-"),REF2=$P(REF,"-",2)
"RTN","%ZVEMKTR",55,0)
 . I '$D(^TMP("VEE",PKG,$J,REF1))!('$D(^(REF2)))!(REF1>REF2) S REF="" D MSG(3) Q
"RTN","%ZVEMKTR",56,0)
 . S REF=REF1_"^"_REF2
"RTN","%ZVEMKTR",57,0)
 . Q
"RTN","%ZVEMKTR",58,0)
 I REF["," D  G:REF']"" GETRANG1 Q REF
"RTN","%ZVEMKTR",59,0)
 . F I=1:1:$L(REF,",") S REF1=$P(REF,",",I) D  Q:REF']""
"RTN","%ZVEMKTR",60,0)
 . . I REF1'>0 D MSG(1) S REF="" Q
"RTN","%ZVEMKTR",61,0)
 . . I '$D(^TMP("VEE",PKG,$J,REF1)) D MSG(1) S REF="" Q
"RTN","%ZVEMKTR",62,0)
 I REF'>0!(REF'?1.N) D  D MSG(4) G GETRANG1
"RTN","%ZVEMKTR",63,0)
 . Q:$E(REF)="?"!(REF="<ESCH>")  W $C(7)
"RTN","%ZVEMKTR",64,0)
 I '$D(^TMP("VEE",PKG,$J,REF)) D MSG(2) G GETRANG1
"RTN","%ZVEMKTR",65,0)
 Q REF_"^"_REF
"RTN","%ZVEMKTR",66,0)
 ;====================================================================
"RTN","%ZVEMKTR",67,0)
MSG(NUM) ;Messages
"RTN","%ZVEMKTR",68,0)
 ;NUM=Subroutine number
"RTN","%ZVEMKTR",69,0)
 Q:$G(NUM)'>0
"RTN","%ZVEMKTR",70,0)
 S DX=0,DY=(VEET("S2")+VEET("FT")-2)
"RTN","%ZVEMKTR",71,0)
 D CURSOR^%ZVEMKU1(DX,DY,1),@NUM
"RTN","%ZVEMKTR",72,0)
 Q
"RTN","%ZVEMKTR",73,0)
1 W "Enter REF number from left hand column or <TAB> for highlight." Q
"RTN","%ZVEMKTR",74,0)
2 W $C(7),"Invalid. Enter number from left hand column" Q
"RTN","%ZVEMKTR",75,0)
3 W $C(7),"Invalid range" Q
"RTN","%ZVEMKTR",76,0)
4 W "Enter number from left hand column, or range of numbers (Ex: 3-5 or 1,3,4)" Q
"RTN","%ZVEMKTS")
0^64^B23445002
"RTN","%ZVEMKTS",1,0)
%ZVEMKTS ;DJB,KRN**Txt Scroll-SELECTOR [8/28/98 1:31pm]
"RTN","%ZVEMKTS",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMKTS",3,0)
 ;
"RTN","%ZVEMKTS",4,0)
TOP ;
"RTN","%ZVEMKTS",5,0)
 NEW X S X="ERROR^%ZVEMKT2",@($$TRAP^%ZVEMKU1) KILL X
"RTN","%ZVEMKTS",6,0)
 NEW DX,DY,FLAGQ,VEET NEW:'$D(VEE) VEE NEW:'$D(VEES) VEES
"RTN","%ZVEMKTS",7,0)
 S FLAGQ=0
"RTN","%ZVEMKTS",8,0)
 KILL ^TMP("VEE","K",$J)
"RTN","%ZVEMKTS",9,0)
 KILL ^TMP("VPE","SELECT",$J)
"RTN","%ZVEMKTS",10,0)
 D INIT G:FLAGQ EX
"RTN","%ZVEMKTS",11,0)
 D TEMPLATE
"RTN","%ZVEMKTS",12,0)
 D SCROLL^%ZVEMKT2()
"RTN","%ZVEMKTS",13,0)
 D LIST
"RTN","%ZVEMKTS",14,0)
 D ENDSCR^%ZVEMKT2
"RTN","%ZVEMKTS",15,0)
EX ;
"RTN","%ZVEMKTS",16,0)
 KILL ^TMP("VEE","K",$J)
"RTN","%ZVEMKTS",17,0)
 I $G(DDS) X VEES("RM0") ;...Called from ScreenMan
"RTN","%ZVEMKTS",18,0)
 Q
"RTN","%ZVEMKTS",19,0)
 ;===============================================================
"RTN","%ZVEMKTS",20,0)
LIST ;Display text
"RTN","%ZVEMKTS",21,0)
 S VEET=$G(^TMP("VEE","K",$J,VEET("BOT")))
"RTN","%ZVEMKTS",22,0)
 W ! I VEET=" <> <> <>" W ?3,VEET
"RTN","%ZVEMKTS",23,0)
 E  D  ;
"RTN","%ZVEMKTS",24,0)
 . W:$D(^TMP("VPE","SELECT",$J,VEET("HLN"))) "=>"
"RTN","%ZVEMKTS",25,0)
 . W ?3 W:$G(NUMBER) $J(VEET("HLN"),3)_". "
"RTN","%ZVEMKTS",26,0)
 . W $S(VEET[$C(9):$P(VEET,$C(9),2,999),1:VEET)
"RTN","%ZVEMKTS",27,0)
 S VEET("BOT")=VEET("BOT")+1
"RTN","%ZVEMKTS",28,0)
 S:VEET("GAP") VEET("GAP")=VEET("GAP")-1
"RTN","%ZVEMKTS",29,0)
 S VEET("HLN")=VEET("HLN")+1 ;Highlight Line
"RTN","%ZVEMKTS",30,0)
 S:VEET("H$Y")<VEET("S2") VEET("H$Y")=VEET("H$Y")+1 ;Highlight $Y
"RTN","%ZVEMKTS",31,0)
 I VEET=" <> <> <>"!'VEET("GAP") D READ^%ZVEMKTT Q:FLAGQ
"RTN","%ZVEMKTS",32,0)
 G LIST
"RTN","%ZVEMKTS",33,0)
 ;====================================================================
"RTN","%ZVEMKTS",34,0)
TAG ;Tag/Untag a line
"RTN","%ZVEMKTS",35,0)
 I $D(^TMP("VPE","SELECT",$J,VEET("HLN")-1)) KILL ^(VEET("HLN")-1) Q
"RTN","%ZVEMKTS",36,0)
 D SET(VEET("HLN")-1)
"RTN","%ZVEMKTS",37,0)
 Q
"RTN","%ZVEMKTS",38,0)
ALL ;Tag all lines
"RTN","%ZVEMKTS",39,0)
 NEW I
"RTN","%ZVEMKTS",40,0)
 F I=1:1 Q:'$D(^TMP("VEE","K",$J,I))  D SET(I)
"RTN","%ZVEMKTS",41,0)
 D REDRAW^%ZVEMKT2()
"RTN","%ZVEMKTS",42,0)
 Q
"RTN","%ZVEMKTS",43,0)
CURSORUP ;Tag Cursor-to-Top
"RTN","%ZVEMKTS",44,0)
 NEW I
"RTN","%ZVEMKTS",45,0)
 F I=1:1:(VEET("HLN")-1) Q:'$D(^TMP("VEE","K",$J,I))  D SET(I)
"RTN","%ZVEMKTS",46,0)
 D REDRAW^%ZVEMKT2()
"RTN","%ZVEMKTS",47,0)
 Q
"RTN","%ZVEMKTS",48,0)
CURSORDN ;Tag Cursor-to-Bottom
"RTN","%ZVEMKTS",49,0)
 NEW I
"RTN","%ZVEMKTS",50,0)
 F I=(VEET("HLN")-1):1 Q:'$D(^TMP("VEE","K",$J,I))  D SET(I)
"RTN","%ZVEMKTS",51,0)
 D REDRAW^%ZVEMKT2()
"RTN","%ZVEMKTS",52,0)
 Q
"RTN","%ZVEMKTS",53,0)
CLEAR ;Clear all tagged lines
"RTN","%ZVEMKTS",54,0)
 KILL ^TMP("VPE","SELECT",$J) D REDRAW^%ZVEMKT2()
"RTN","%ZVEMKTS",55,0)
 Q
"RTN","%ZVEMKTS",56,0)
PAGE ;Tag a page
"RTN","%ZVEMKTS",57,0)
 NEW I
"RTN","%ZVEMKTS",58,0)
 F I=VEET("TOP"):1:(VEET("BOT")-1) D SET(I)
"RTN","%ZVEMKTS",59,0)
 D REDRAW^%ZVEMKT2()
"RTN","%ZVEMKTS",60,0)
 Q
"RTN","%ZVEMKTS",61,0)
FIND(MODE) ;MODE: +=Find&Tag  -=Find&Clear
"RTN","%ZVEMKTS",62,0)
 NEW AND,CHAR1,CHAR2,COL1,COL2,DATA,FIND,I
"RTN","%ZVEMKTS",63,0)
 D ENDSCR^%ZVEMKT2
"RTN","%ZVEMKTS",64,0)
 S MODE=$G(MODE)
"RTN","%ZVEMKTS",65,0)
 S (COL1,COL2,CHAR1,CHAR2,AND)=""
"RTN","%ZVEMKTS",66,0)
 W !,"F I N D   &   "
"RTN","%ZVEMKTS",67,0)
 W $S(MODE="+":"T A G",1:"C L E A R")_"   U T I L I T Y"
"RTN","%ZVEMKTS",68,0)
FIND1 S COL1=$$FINDCOL() I COL1="" D REDRAW^%ZVEMKT2() Q
"RTN","%ZVEMKTS",69,0)
FIND2 S CHAR1=$$FINDCHR() I CHAR1="" G FIND1
"RTN","%ZVEMKTS",70,0)
 W !
"RTN","%ZVEMKTS",71,0)
 G:$$ASK^%ZVEMKU("Do you want to include a 2nd criteria",2)'="Y" FIND6
"RTN","%ZVEMKTS",72,0)
FIND3 W !!,"[A]nd -or- [O]r: "
"RTN","%ZVEMKTS",73,0)
 R AND:300 S:'$T AND="" I "^"[AND G FIND6
"RTN","%ZVEMKTS",74,0)
 S AND=$$ALLCAPS^%ZVEMKU(AND)
"RTN","%ZVEMKTS",75,0)
 I AND'="A",AND'="O" D  G FIND3
"RTN","%ZVEMKTS",76,0)
 . W !,"If you want to include a 2nd criteria, then enter A or O."
"RTN","%ZVEMKTS",77,0)
 . W !,?3,"A = Both criteria must be true"
"RTN","%ZVEMKTS",78,0)
 . W !,?3,"O = Either criteria must be true"
"RTN","%ZVEMKTS",79,0)
FIND4 S COL2=$$FINDCOL() I COL2="" G FIND6
"RTN","%ZVEMKTS",80,0)
FIND5 S CHAR2=$$FINDCHR() I CHAR2="" G FIND4
"RTN","%ZVEMKTS",81,0)
FIND6 F I=1:1 Q:'$D(^TMP("VEE","K",$J,I))  S DATA=^(I) D  ;
"RTN","%ZVEMKTS",82,0)
 . I DATA[$C(9) S DATA=$P(DATA,$C(9),2,999)
"RTN","%ZVEMKTS",83,0)
 . I AND="",$P(DATA,"|",COL1)'[CHAR1 Q
"RTN","%ZVEMKTS",84,0)
 . I AND="A",$P(DATA,"|",COL1)'[CHAR1!($P(DATA,"|",COL2)'[CHAR2) Q
"RTN","%ZVEMKTS",85,0)
 . I AND="O",$P(DATA,"|",COL1)'[CHAR1&($P(DATA,"|",COL2)'[CHAR2) Q
"RTN","%ZVEMKTS",86,0)
 . I MODE="+" D SET(I) Q
"RTN","%ZVEMKTS",87,0)
 . KILL ^TMP("VPE","SELECT",$J,I) ;Clear tag
"RTN","%ZVEMKTS",88,0)
 D REDRAW^%ZVEMKT2()
"RTN","%ZVEMKTS",89,0)
 Q
"RTN","%ZVEMKTS",90,0)
 ;
"RTN","%ZVEMKTS",91,0)
FINDCOL() ;Get column #
"RTN","%ZVEMKTS",92,0)
 NEW COL
"RTN","%ZVEMKTS",93,0)
 W !!,"Look in which column?"
"RTN","%ZVEMKTS",94,0)
FINDCOL1 W !,"Enter COLUMN: "
"RTN","%ZVEMKTS",95,0)
 R COL:300 S:'$T COL="" I "^"[COL Q ""
"RTN","%ZVEMKTS",96,0)
 S COL=COL\1
"RTN","%ZVEMKTS",97,0)
 I COL<1 W "   Enter a valid column number." G FINDCOL1
"RTN","%ZVEMKTS",98,0)
 Q COL
"RTN","%ZVEMKTS",99,0)
 ;
"RTN","%ZVEMKTS",100,0)
FINDCHR() ;Get characters
"RTN","%ZVEMKTS",101,0)
 NEW CHAR
"RTN","%ZVEMKTS",102,0)
 W !!,"Look for what characters?"
"RTN","%ZVEMKTS",103,0)
FINDCHR1 W !,"Enter CHARACTERS: "
"RTN","%ZVEMKTS",104,0)
 R CHAR:300 S:'$T CHAR="" I "^"[CHAR Q ""
"RTN","%ZVEMKTS",105,0)
 I CHAR["?" W "   Enter characters to look for." G FINDCHR1
"RTN","%ZVEMKTS",106,0)
 Q CHAR
"RTN","%ZVEMKTS",107,0)
 ;
"RTN","%ZVEMKTS",108,0)
SET(VAL) ;Set "tagged" array. VAL=Line number
"RTN","%ZVEMKTS",109,0)
 Q:'$D(^TMP("VEE","K",$J,VAL))  Q:^(VAL)=" <> <> <>"
"RTN","%ZVEMKTS",110,0)
 S ^TMP("VPE","SELECT",$J,VAL)=^TMP("VEE","K",$J,VAL)
"RTN","%ZVEMKTS",111,0)
 Q
"RTN","%ZVEMKTS",112,0)
 ;====================================================================
"RTN","%ZVEMKTS",113,0)
TEMPLATE ;Set pre-selected nodes
"RTN","%ZVEMKTS",114,0)
 Q:$G(TEMPLATE)']""  Q:'$D(@TEMPLATE)
"RTN","%ZVEMKTS",115,0)
 NEW SUB
"RTN","%ZVEMKTS",116,0)
 S SUB=0
"RTN","%ZVEMKTS",117,0)
 F  S SUB=$O(@TEMPLATE@(SUB)) Q:'SUB  D  ;
"RTN","%ZVEMKTS",118,0)
 . Q:'$D(^TMP("VEE","K",$J,SUB))
"RTN","%ZVEMKTS",119,0)
 . S ^TMP("VPE","SELECT",$J,SUB)=^TMP("VEE","K",$J,SUB)
"RTN","%ZVEMKTS",120,0)
 Q
"RTN","%ZVEMKTS",121,0)
INIT ;
"RTN","%ZVEMKTS",122,0)
 NEW HD,TOT
"RTN","%ZVEMKTS",123,0)
 S FLAGQ=0
"RTN","%ZVEMKTS",124,0)
 D INIT^%ZVEMKT Q:FLAGQ
"RTN","%ZVEMKTS",125,0)
 D INIT1^%ZVEMKT
"RTN","%ZVEMKTS",126,0)
 D INIT2^%ZVEMKT
"RTN","%ZVEMKTS",127,0)
 S @("HD=$G("_GLBHLD_",""HD""))"),HD=$E(HD,1,VEE("IOM")-10)
"RTN","%ZVEMKTS",128,0)
 D GETS^%ZVEMKTG ;...Build array. TOT will equal number of entries.
"RTN","%ZVEMKTS",129,0)
 S TOT=TOT_$S(TOT>1:" Items",1:" Item")
"RTN","%ZVEMKTS",130,0)
 S VEET("HD")=2,VEET("HD",2)=VEET("HD",1)
"RTN","%ZVEMKTS",131,0)
 S VEET("HD",1)=" Select: "_$S(HD]"":HD,1:"ITEMS")
"RTN","%ZVEMKTS",132,0)
 S VEET("FT",1)=$E(VEET("FT",1),1,VEE("IOM")-$L(TOT)-6)_TOT_$E(VEET("FT",1),1,5)
"RTN","%ZVEMKTS",133,0)
 S VEET("FT",2)="<> <SPACE>=Tag  A=TgAll  C=ClrAll  +=Fnd&Tg  -=Fnd&Clr  ?=Help  M=More"_$S($G(NEW)=1:"  N=New",1:"")
"RTN","%ZVEMKTS",134,0)
 S VEET("S1")=3,(VEET("GAP"),VEET("SL"))=VEET("S2")-VEET("S1")+1
"RTN","%ZVEMKTS",135,0)
 S VEET("H$Y")=VEET("S1")-1 ;...Highlight line $Y
"RTN","%ZVEMKTS",136,0)
 Q
"RTN","%ZVEMKTT")
0^65^B24892395
"RTN","%ZVEMKTT",1,0)
%ZVEMKTT ;DJB,KRN**Txt Scroll-SELECTOR READ ; 11/30/00 1:44pm
"RTN","%ZVEMKTT",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMKTT",3,0)
 ;
"RTN","%ZVEMKTT",4,0)
READ ;Get input
"RTN","%ZVEMKTT",5,0)
 ;Move highlight to top line
"RTN","%ZVEMKTT",6,0)
 I $G(VEET("FIND-TOP"))]"" D FINDTOP KILL VEET("FIND-TOP")
"RTN","%ZVEMKTT",7,0)
 NEW KEY,PKG,VK
"RTN","%ZVEMKTT",8,0)
 S PKG="K",U="^"
"RTN","%ZVEMKTT",9,0)
READ1 D HIGHLITE("ON")
"RTN","%ZVEMKTT",10,0)
 S KEY=$$READ^%ZVEMKRN("",1,1),KEY=$$ALLCAPS^%ZVEMKU(KEY),VK=VEE("K")
"RTN","%ZVEMKTT",11,0)
 I VK="<AU>" D  G READ1
"RTN","%ZVEMKTT",12,0)
 . I (VEET("HLN")-1)>VEET("TOP") D  Q
"RTN","%ZVEMKTT",13,0)
 . . D HIGHLITE("OFF")
"RTN","%ZVEMKTT",14,0)
 . . S VEET("HLN")=VEET("HLN")-1,VEET("H$Y")=VEET("H$Y")-1
"RTN","%ZVEMKTT",15,0)
 . I VEET("TOP")>1 D UP Q
"RTN","%ZVEMKTT",16,0)
 . W $C(7)
"RTN","%ZVEMKTT",17,0)
 I VK="<AD>",VEET("HLN")<VEET("BOT") D  G READ1
"RTN","%ZVEMKTT",18,0)
 . D HIGHLITE("OFF") S VEET("HLN")=VEET("HLN")+1
"RTN","%ZVEMKTT",19,0)
 . S VEET("H$Y")=VEET("H$Y")+1
"RTN","%ZVEMKTT",20,0)
 I VK="<AD>" G:$$ENDFILE() READ1 D DOWN Q
"RTN","%ZVEMKTT",21,0)
 I KEY="^" S FLAGQ=1 Q
"RTN","%ZVEMKTT",22,0)
 I ",<ESC>,<F1E>,<F1Q>,<TO>,"[(","_VK_",") S FLAGQ=1 Q
"RTN","%ZVEMKTT",23,0)
 I VK="<ESCH>" D HELP^%ZVEMKT2,REDRAW^%ZVEMKT2() Q
"RTN","%ZVEMKTT",24,0)
 I KEY="?" D HELP^%ZVEMKTU,REDRAW^%ZVEMKT2() Q
"RTN","%ZVEMKTT",25,0)
 I KEY=" " D TAG^%ZVEMKTS G READ1
"RTN","%ZVEMKTT",26,0)
 I KEY="A" D ALL^%ZVEMKTS Q
"RTN","%ZVEMKTT",27,0)
 I KEY="C" D CLEAR^%ZVEMKTS Q
"RTN","%ZVEMKTT",28,0)
 ;I KEY="L" D FIND^%ZVEMKT1(KEY) Q
"RTN","%ZVEMKTT",29,0)
 I KEY="L" D LOCATE,REDRAW^%ZVEMKT2() Q
"RTN","%ZVEMKTT",30,0)
 I KEY="F" D FIND,REDRAW^%ZVEMKT2() Q
"RTN","%ZVEMKTT",31,0)
 I KEY="G" D GOTO,REDRAW^%ZVEMKT2() Q
"RTN","%ZVEMKTT",32,0)
 I KEY="+" D FIND^%ZVEMKTS("+") Q
"RTN","%ZVEMKTT",33,0)
 I KEY="-" D FIND^%ZVEMKTS("-") Q
"RTN","%ZVEMKTT",34,0)
 I KEY="M" D MORE^%ZVEMKTU,REDRAW^%ZVEMKT2() Q
"RTN","%ZVEMKTT",35,0)
 I KEY="N",$G(NEW)=1 D  S FLAGQ=1 Q
"RTN","%ZVEMKTT",36,0)
 . KILL ^TMP("VPE","SELECT",$J)
"RTN","%ZVEMKTT",37,0)
 . R KEY:1 ;Pause in case user hits N,<RETURN>
"RTN","%ZVEMKTT",38,0)
 . S ^TMP("VPE","SELECT",$J,"NEW")=""
"RTN","%ZVEMKTT",39,0)
 I KEY="P" D PAGE^%ZVEMKTS Q
"RTN","%ZVEMKTT",40,0)
 I KEY="S" D SHOW^%ZVEMKTU,REDRAW^%ZVEMKT2() Q
"RTN","%ZVEMKTT",41,0)
 I VK="<F4T>" D CURSORUP^%ZVEMKTS Q  ;Tag cursor to top line
"RTN","%ZVEMKTT",42,0)
 I VK="<F4B>" D CURSORDN^%ZVEMKTS Q  ;Tag cursor to bottom line
"RTN","%ZVEMKTT",43,0)
 I KEY="CT"!(VK="<F1AU>") D  G READ1 ;Cursor to top of page
"RTN","%ZVEMKTT",44,0)
 . Q:(VEET("HLN")-1)'>VEET("TOP")
"RTN","%ZVEMKTT",45,0)
 . D HIGHLITE("OFF") S VEET("HLN")=VEET("TOP")+1
"RTN","%ZVEMKTT",46,0)
 . S VEET("H$Y")=VEET("S1")
"RTN","%ZVEMKTT",47,0)
 I KEY="CD"!(VK="<F1AD>") D  G READ1 ;Cursor to bottom of page
"RTN","%ZVEMKTT",48,0)
 . Q:VEET("HLN")'<VEET("BOT")
"RTN","%ZVEMKTT",49,0)
 . D HIGHLITE("OFF") S VEET("HLN")=VEET("BOT")
"RTN","%ZVEMKTT",50,0)
 . S VEET("H$Y")=$S(VEET("GAP"):VEET("S2")-VEET("GAP"),1:VEET("S2"))
"RTN","%ZVEMKTT",51,0)
 I ",<PGUP>,<F4AU>,"[(","_VK_",")!(KEY="U") W:VEET("TOP")'>1 $C(7) G:VEET("TOP")'>1 READ1 D LEFT^%ZVEMKTM Q
"RTN","%ZVEMKTT",52,0)
 I ",<PGDN>,<F4AD>,<RET>,"[(","_VK_",")!(KEY="D") G:$$ENDFILE() READ1 D RIGHT^%ZVEMKTM Q
"RTN","%ZVEMKTT",53,0)
 I ",<HOME>,<F4AL>,"[(","_VK_",")!(KEY="T") S VEET("TOP")=1 D REDRAW^%ZVEMKT2() Q
"RTN","%ZVEMKTT",54,0)
 I ",<END>,<F4AR>,"[(","_VK_",")!(KEY="B") D BOTTOM^%ZVEMKT2(PKG) Q
"RTN","%ZVEMKTT",55,0)
 D HIGHLITE("OFF")
"RTN","%ZVEMKTT",56,0)
 G READ1
"RTN","%ZVEMKTT",57,0)
 ;====================================================================
"RTN","%ZVEMKTT",58,0)
ENDFILE() ;1=End-of-file  0=Ok
"RTN","%ZVEMKTT",59,0)
 I VEET("GAP") W $C(7) Q 1
"RTN","%ZVEMKTT",60,0)
 I ^TMP("VEE","K",$J,VEET("BOT")-1)=" <> <> <>" W $C(7) Q 1
"RTN","%ZVEMKTT",61,0)
 Q 0
"RTN","%ZVEMKTT",62,0)
HIGHLITE(MODE) ; MODE="ON"  - Draw highlight
"RTN","%ZVEMKTT",63,0)
 ;       MODE="OFF" - Redraw with no highlight
"RTN","%ZVEMKTT",64,0)
 NEW HL I $G(MODE)'="ON" S MODE="OFF"
"RTN","%ZVEMKTT",65,0)
 S DX=0,DY=VEET("H$Y")-1 X VEES("CRSR")
"RTN","%ZVEMKTT",66,0)
 W:MODE="ON" @VEE("RON")
"RTN","%ZVEMKTT",67,0)
 W $S($D(^TMP("VPE","SELECT",$J,VEET("HLN")-1)):"=>",1:"  ")
"RTN","%ZVEMKTT",68,0)
 W:MODE="ON" @VEE("ROFF")
"RTN","%ZVEMKTT",69,0)
 Q
"RTN","%ZVEMKTT",70,0)
 ;====================================================================
"RTN","%ZVEMKTT",71,0)
UP ;Insert text at top.
"RTN","%ZVEMKTT",72,0)
 D HIGHLITE("OFF")
"RTN","%ZVEMKTT",73,0)
 S DX=0,DY=(VEET("S1")-2) X VEES("CRSR")
"RTN","%ZVEMKTT",74,0)
 W @VEES("INDEX"),@VEES("INSRT") X VEES("CRSR")
"RTN","%ZVEMKTT",75,0)
 I VEET("GAP") S VEET("GAP")=VEET("GAP")-1
"RTN","%ZVEMKTT",76,0)
 E  S VEET("BOT")=VEET("BOT")-1
"RTN","%ZVEMKTT",77,0)
 S VEET("TOP")=VEET("TOP")-1,VEET("HLN")=VEET("HLN")-1
"RTN","%ZVEMKTT",78,0)
 NEW TXT
"RTN","%ZVEMKTT",79,0)
 S TXT=$G(^TMP("VEE",PKG,$J,VEET("TOP")))
"RTN","%ZVEMKTT",80,0)
 Q:TXT=" <> <> <>"
"RTN","%ZVEMKTT",81,0)
 W !?3 W:$G(NUMBER) $J(VEET("TOP"),3)_". "
"RTN","%ZVEMKTT",82,0)
 W $S(TXT[$C(9):$P(TXT,$C(9),2,999),1:TXT)
"RTN","%ZVEMKTT",83,0)
 Q
"RTN","%ZVEMKTT",84,0)
DOWN ;Insert text at bottom
"RTN","%ZVEMKTT",85,0)
 D HIGHLITE("OFF")
"RTN","%ZVEMKTT",86,0)
 S DX=0,DY=(VEET("S2")-1) X VEES("CRSR")
"RTN","%ZVEMKTT",87,0)
 S VEET("TOP")=VEET("TOP")+1
"RTN","%ZVEMKTT",88,0)
 Q
"RTN","%ZVEMKTT",89,0)
GOTO ;Goto line number
"RTN","%ZVEMKTT",90,0)
 NEW NUM
"RTN","%ZVEMKTT",91,0)
 D ENDSCR^%ZVEMKT2
"RTN","%ZVEMKTT",92,0)
GOTO1 W !,"Select LINE NUMBER: "
"RTN","%ZVEMKTT",93,0)
 R NUM:300 S:'$T NUM="^" I "^"[NUM Q
"RTN","%ZVEMKTT",94,0)
 I '$D(^TMP("VEE","K",$J,NUM)) W $C(7),"   Invalid" G GOTO1
"RTN","%ZVEMKTT",95,0)
 S (VEET("BOT"),VEET("TOP"))=NUM,VEET("GAP")=VEET("SL")
"RTN","%ZVEMKTT",96,0)
 S VEET("HLN")=VEET("TOP")+1,VEET("H$Y")=VEET("S1")-1
"RTN","%ZVEMKTT",97,0)
 Q
"RTN","%ZVEMKTT",98,0)
FIND ;Find text using "B" xref. Only 1st 10 characters of each line is
"RTN","%ZVEMKTT",99,0)
 ;stored in "B" xref.
"RTN","%ZVEMKTT",100,0)
 NEW FIND,FINDHLD,NUM
"RTN","%ZVEMKTT",101,0)
 D ENDSCR^%ZVEMKT2
"RTN","%ZVEMKTT",102,0)
 W !!,"F I N D   U T I L I T Y"
"RTN","%ZVEMKTT",103,0)
 W !!,"Enter characters you want to search for. If found, the line starting"
"RTN","%ZVEMKTT",104,0)
 W !,"with these characters will appear at the top of the screen."
"RTN","%ZVEMKTT",105,0)
 W !!,"Enter CHARACTERS: "
"RTN","%ZVEMKTT",106,0)
 R FIND:300 S:'$T FIND="" Q:FIND=""
"RTN","%ZVEMKTT",107,0)
 S FINDHLD=FIND
"RTN","%ZVEMKTT",108,0)
 S FIND=$O(^TMP("VEE","K",$J,"B",FIND))
"RTN","%ZVEMKTT",109,0)
 Q:$E(FIND,1,$L(FINDHLD))'=FINDHLD
"RTN","%ZVEMKTT",110,0)
 S NUM=$O(^TMP("VEE","K",$J,"B",FIND,"")) Q:'NUM
"RTN","%ZVEMKTT",111,0)
 D SET
"RTN","%ZVEMKTT",112,0)
 Q
"RTN","%ZVEMKTT",113,0)
LOCATE ;Locate line that contains text.
"RTN","%ZVEMKTT",114,0)
 NEW FLAGQ,LOCATE,ND,NUM
"RTN","%ZVEMKTT",115,0)
 D ENDSCR^%ZVEMKT2
"RTN","%ZVEMKTT",116,0)
 W !!,"L O C A T E   U T I L I T Y"
"RTN","%ZVEMKTT",117,0)
 W !!,"Enter characters you want to search for. If found, the line containing"
"RTN","%ZVEMKTT",118,0)
 W !,"these characters will appear at the top of the screen."
"RTN","%ZVEMKTT",119,0)
 W !!,"Enter CHARACTERS: "
"RTN","%ZVEMKTT",120,0)
 R LOCATE:300 S:'$T LOCATE="" Q:LOCATE=""
"RTN","%ZVEMKTT",121,0)
 S FLAGQ=0
"RTN","%ZVEMKTT",122,0)
 S NUM=VEET("TOP")
"RTN","%ZVEMKTT",123,0)
 F  S NUM=$O(^TMP("VEE","K",$J,NUM)) Q:'NUM  Q:FLAGQ  S ND=$G(^(NUM)) Q:ND=" <> <> <>"  D  ;
"RTN","%ZVEMKTT",124,0)
 . Q:ND'[LOCATE
"RTN","%ZVEMKTT",125,0)
 . D SET
"RTN","%ZVEMKTT",126,0)
 . S FLAGQ=1
"RTN","%ZVEMKTT",127,0)
 Q
"RTN","%ZVEMKTT",128,0)
SET ;Reset variables to correct line
"RTN","%ZVEMKTT",129,0)
 S (VEET("BOT"),VEET("TOP"))=NUM
"RTN","%ZVEMKTT",130,0)
 S VEET("GAP")=VEET("SL")
"RTN","%ZVEMKTT",131,0)
 S VEET("HLN")=VEET("TOP")+1
"RTN","%ZVEMKTT",132,0)
 S VEET("H$Y")=VEET("S1")-1
"RTN","%ZVEMKTT",133,0)
 S VEET("FIND-TOP")=1 ;So highlight is moved to top of screen
"RTN","%ZVEMKTT",134,0)
 Q
"RTN","%ZVEMKTT",135,0)
FINDTOP ;Move highlight at top of screen
"RTN","%ZVEMKTT",136,0)
 S VEET("HLN")=VEET("TOP")+1,VEET("H$Y")=VEET("S1")
"RTN","%ZVEMKTT",137,0)
 Q
"RTN","%ZVEMKTU")
0^66^B6452309
"RTN","%ZVEMKTU",1,0)
%ZVEMKTU ;DJB,KRN**Txt Scroll-SELECTOR Help [8/16/97 11:10am]
"RTN","%ZVEMKTU",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMKTU",3,0)
 ;
"RTN","%ZVEMKTU",4,0)
HELP ;
"RTN","%ZVEMKTU",5,0)
 D ENDSCR^%ZVEMKT2
"RTN","%ZVEMKTU",6,0)
 W !,"S E L E C T O R"
"RTN","%ZVEMKTU",7,0)
 W !!,"You may select any number of the displayed lines by tagging them. To tag"
"RTN","%ZVEMKTU",8,0)
 W !,"a line, position the highlight and hit <SPACE BAR>. A '=>' will appear in"
"RTN","%ZVEMKTU",9,0)
 W !,"front of the line, indicating it's been tagged. To deselect a line, hit"
"RTN","%ZVEMKTU",10,0)
 W !,"<SPACE BAR> again. This untags the line and the '=>' disappears."
"RTN","%ZVEMKTU",11,0)
 W !!,"Other ways to tag and untag lines:"
"RTN","%ZVEMKTU",12,0)
 W !!?3,"A     Tag all lines"
"RTN","%ZVEMKTU",13,0)
 W !?3,"P     Tag all lines on the displayed page"
"RTN","%ZVEMKTU",14,0)
 W !?3,"<F4>T Tag from cursor to top of list"
"RTN","%ZVEMKTU",15,0)
 W !?3,"<F4>B Tag from cursor to bottom of list"
"RTN","%ZVEMKTU",16,0)
 W !?3,"C     Clear all lines (Untag them)"
"RTN","%ZVEMKTU",17,0)
 W !?3,"+     Enter characters. SELECTOR will find all lines"
"RTN","%ZVEMKTU",18,0)
 W !?3,"      containing those characters, and tag them."
"RTN","%ZVEMKTU",19,0)
 W !?3,"-     Enter characters. SELECTOR will find all lines"
"RTN","%ZVEMKTU",20,0)
 W !?3,"      containing those characters, and untag them."
"RTN","%ZVEMKTU",21,0)
 W !!,"SELECTOR uses the SCROLLER. While in SELECTOR hit <ESC>H for scroller help."
"RTN","%ZVEMKTU",22,0)
 D PAUSE^%ZVEMKC(2)
"RTN","%ZVEMKTU",23,0)
 Q
"RTN","%ZVEMKTU",24,0)
MORE ;M=More menu option
"RTN","%ZVEMKTU",25,0)
 D ENDSCR^%ZVEMKT2
"RTN","%ZVEMKTU",26,0)
 W !,"A D D I T I O N A L   M E N U   I T E M S"
"RTN","%ZVEMKTU",27,0)
 W !?3,"F = Find characters (Look on left side of screen only)"
"RTN","%ZVEMKTU",28,0)
 W !?3,"L = Locate characters (Anywhere in the line)"
"RTN","%ZVEMKTU",29,0)
 W !?3,"S = Show selected items"
"RTN","%ZVEMKTU",30,0)
 W !!?3,"U = Move Up a page"
"RTN","%ZVEMKTU",31,0)
 W !?3,"D = Move Down a page"
"RTN","%ZVEMKTU",32,0)
 W !?3,"T = Move to Top of list"
"RTN","%ZVEMKTU",33,0)
 W !?3,"B = Move to Bottom of list"
"RTN","%ZVEMKTU",34,0)
 W !?3,"G = Goto a line number"
"RTN","%ZVEMKTU",35,0)
 D PAUSE^%ZVEMKC(2)
"RTN","%ZVEMKTU",36,0)
 Q
"RTN","%ZVEMKTU",37,0)
SHOW ;Show selected items
"RTN","%ZVEMKTU",38,0)
 D ENDSCR^%ZVEMKT2
"RTN","%ZVEMKTU",39,0)
 NEW FLAGQ,I,ITEM
"RTN","%ZVEMKTU",40,0)
 W !,"S E L E C T E D   I T E M S"
"RTN","%ZVEMKTU",41,0)
 S (FLAGQ,ITEM)=0
"RTN","%ZVEMKTU",42,0)
 F  S ITEM=$O(^TMP("VPE","SELECT",$J,ITEM)) Q:'ITEM!FLAGQ  D  ;
"RTN","%ZVEMKTU",43,0)
 . W !,$P($G(^TMP("VPE","SELECT",$J,ITEM)),$C(9),2)
"RTN","%ZVEMKTU",44,0)
 . I '$O(^TMP("VPE","SELECT",$J,ITEM)) D  S FLAGQ=1 Q
"RTN","%ZVEMKTU",45,0)
 . . F I=$Y:1:(VEE("IOSL")-4) W !
"RTN","%ZVEMKTU",46,0)
 . . D PAUSE^%ZVEMKC(1)
"RTN","%ZVEMKTU",47,0)
 . I $Y>(VEE("IOSL")-4) D PAUSEQ^%ZVEMKC(1) Q:FLAGQ  W @VEE("IOF")
"RTN","%ZVEMKTU",48,0)
 Q
"RTN","%ZVEMKU")
0^67^B9868565
"RTN","%ZVEMKU",1,0)
%ZVEMKU ;DJB,KRN**General Utilities [1/13/96 10:40pm]
"RTN","%ZVEMKU",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMKU",3,0)
 ;
"RTN","%ZVEMKU",4,0)
ASK(PROMPT,DEFAULT) ;Return: Y=YES, N=NO
"RTN","%ZVEMKU",5,0)
 ;PROMPT=Display prompt, DEFAULT= 1-YES, 2-NO
"RTN","%ZVEMKU",6,0)
 NEW YN
"RTN","%ZVEMKU",7,0)
 S DEFAULT=$S($G(DEFAULT)=2:"NO",1:"YES")
"RTN","%ZVEMKU",8,0)
ASK1 W !,$G(PROMPT),"? "_DEFAULT_"// "
"RTN","%ZVEMKU",9,0)
 R YN:300 S:'$T YN="^" S:YN="" YN=DEFAULT I YN="^" Q YN
"RTN","%ZVEMKU",10,0)
 S YN=$$ALLCAPS($E(YN,1))
"RTN","%ZVEMKU",11,0)
 I "YN"'[YN W "   Y=YES  N=NO" G ASK1
"RTN","%ZVEMKU",12,0)
 Q YN
"RTN","%ZVEMKU",13,0)
FILEMAN() ;Does Fileman exist? YES=1 NO=0
"RTN","%ZVEMKU",14,0)
 I '$D(^DIC)!('$D(^DD)) Q 0
"RTN","%ZVEMKU",15,0)
 Q 1
"RTN","%ZVEMKU",16,0)
EXIST(X) ;X=Rtn...0=Routine doesn't exist, 1=Routine exists
"RTN","%ZVEMKU",17,0)
 I $G(X)']"" Q 0
"RTN","%ZVEMKU",18,0)
 S:X["^" X=$P(X,"^",2) S:X["(" X=$P(X,"(",1)
"RTN","%ZVEMKU",19,0)
 I X'?1A.7AN,X'?1"%"1A.6AN Q 0
"RTN","%ZVEMKU",20,0)
 NEW FLAGQ,VEES S FLAGQ=0
"RTN","%ZVEMKU",21,0)
 D:'$D(VEE("OS")) OS^%ZVEMKY I FLAGQ Q 0
"RTN","%ZVEMKU",22,0)
 D EXIST^%ZVEMKY1
"RTN","%ZVEMKU",23,0)
 I "8,16"[VEE("OS"),$E(X)="%",@("$T(^"_X_")]""""") Q 1
"RTN","%ZVEMKU",24,0)
 X VEES("EXIST") E  Q 0
"RTN","%ZVEMKU",25,0)
 Q 1
"RTN","%ZVEMKU",26,0)
ID ;Get DUZ
"RTN","%ZVEMKU",27,0)
 I $D(^XUSEC(0)) D  Q  ;KERNEL loaded
"RTN","%ZVEMKU",28,0)
 . W !!,"------------------------------------------"
"RTN","%ZVEMKU",29,0)
 . W !,"Your DUZ isn't defined. I'm calling ^XUP."
"RTN","%ZVEMKU",30,0)
 . W !,"------------------------------------------",!
"RTN","%ZVEMKU",31,0)
 . I $G(VEESHL)'="RUN" D ^XUP Q  ;Shell not running
"RTN","%ZVEMKU",32,0)
 . D ^XUP S VEESHL="RUN" X ^%ZVEMS("ZS",3) ;Reset Shell variables
"RTN","%ZVEMKU",33,0)
 S DUZ=0,DUZ(0)=$S($G(DUZ(0))]"":DUZ(0),1:"@")
"RTN","%ZVEMKU",34,0)
 Q
"RTN","%ZVEMKU",35,0)
ALLCAPS(TXT) ;
"RTN","%ZVEMKU",36,0)
 I $G(TXT)']"" Q ""
"RTN","%ZVEMKU",37,0)
 S TXT=$TR(TXT,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","%ZVEMKU",38,0)
 Q TXT
"RTN","%ZVEMKU",39,0)
KILLCHK(CODE) ;Check for any exclusive KILLs
"RTN","%ZVEMKU",40,0)
 Q:$G(CODE)']""  NEW CHK,I,X
"RTN","%ZVEMKU",41,0)
 S CODE=$$ALLCAPS(CODE) Q:CODE'?.E1"K".E1"^".E  S CHK=0,X=""
"RTN","%ZVEMKU",42,0)
 F I=1:1:$L(CODE," ") S X=$P(CODE," ",I) I X["^",$P(CODE," ",I-1)["K" S CHK=1 Q
"RTN","%ZVEMKU",43,0)
 Q:'CHK  W $C(7),!!?3,"WARNING: Your code may be killing a global."
"RTN","%ZVEMKU",44,0)
 I $G(FLAGG)="GLB" D KILLCHK1 Q
"RTN","%ZVEMKU",45,0)
 D PAUSE^%ZVEMKU(1)
"RTN","%ZVEMKU",46,0)
 Q
"RTN","%ZVEMKU",47,0)
KILLCHK1 ;KILLCHK called by ^%ZVEMS global
"RTN","%ZVEMKU",48,0)
 NEW ANS,DEF
"RTN","%ZVEMKU",49,0)
 S DEF=$S($G(^%ZVEMS("PARAM",VEE("ID"),"WARN"))]"":^("WARN"),1:"NO")
"RTN","%ZVEMKU",50,0)
 W !?3,"Should I execute your code: ",DEF,"// "
"RTN","%ZVEMKU",51,0)
 R ANS:600 S:'$T ANS="N" S:ANS="" ANS=DEF S ANS=$E(ANS)
"RTN","%ZVEMKU",52,0)
 I "^YyNn"'[ANS W "   Y=Yes  N=No" G KILLCHK1
"RTN","%ZVEMKU",53,0)
 Q:"Yy"[ANS  S VEESHC="" W !!?3,"Code not executed..."
"RTN","%ZVEMKU",54,0)
 Q
"RTN","%ZVEMKU",55,0)
QUOTES1(X) ;If X contains double quotes, convert to single quotes.
"RTN","%ZVEMKU",56,0)
 I $G(X)']"" Q ""
"RTN","%ZVEMKU",57,0)
 I X'["""""" Q X
"RTN","%ZVEMKU",58,0)
 NEW I,LINE S LINE=""
"RTN","%ZVEMKU",59,0)
 F I=1:1:$L(X,"""""") S LINE=LINE_$P(X,"""""",I)_$S(I'=$L(X,""""""):"""",1:"")
"RTN","%ZVEMKU",60,0)
 Q LINE
"RTN","%ZVEMKU",61,0)
QUOTES2(X) ;If X contains quotes, convert to double quotes.
"RTN","%ZVEMKU",62,0)
 I $G(X)']"" Q ""
"RTN","%ZVEMKU",63,0)
 I X'["""" Q X
"RTN","%ZVEMKU",64,0)
 NEW CNT S CNT=0
"RTN","%ZVEMKU",65,0)
 F  S CNT=CNT+1 Q:$E(X,CNT)=""  I $E(X,CNT)="""" S X=$E(X,1,CNT-1)_""""""_$E(X,CNT+1,999),CNT=CNT+1
"RTN","%ZVEMKU",66,0)
 Q X
"RTN","%ZVEMKU",67,0)
PAUSE(LF,TYPE) ;May return FLAGQ/FLAGE
"RTN","%ZVEMKU",68,0)
 ;LF=# of linefeeds
"RTN","%ZVEMKU",69,0)
 ;TYPE=P/Q/QE  P=Pause Q=PauseQuit QE=PauseQuitExit
"RTN","%ZVEMKU",70,0)
 I $G(TYPE)']"" S TYPE="P"
"RTN","%ZVEMKU",71,0)
 I $G(VEE("TIME"))'>0 D TIME^%ZVEMKY
"RTN","%ZVEMKU",72,0)
 NEW XX F XX=1:1:+$G(LF) W !
"RTN","%ZVEMKU",73,0)
 I TYPE="P" D  Q
"RTN","%ZVEMKU",74,0)
 . R ?1,"<RETURN> to continue..",XX:VEE("TIME")
"RTN","%ZVEMKU",75,0)
 I TYPE="Q" D  Q
"RTN","%ZVEMKU",76,0)
 . W ?1,"<RETURN> to continue, '^' to quit: "
"RTN","%ZVEMKU",77,0)
 . R XX:VEE("TIME") S:'$T XX="^" I XX["^" S FLAGQ=1
"RTN","%ZVEMKU",78,0)
 I TYPE="QE" D  Q
"RTN","%ZVEMKU",79,0)
 . W ?1,"<RETURN> to continue, '^' to quit, '^^' to exit: "
"RTN","%ZVEMKU",80,0)
 . R XX:VEE("TIME") S:'$T XX="^" I XX["^" S FLAGQ=1 S:XX="^^" FLAGE=1
"RTN","%ZVEMKU",81,0)
 Q
"RTN","%ZVEMKU1")
0^68^B4089605
"RTN","%ZVEMKU1",1,0)
%ZVEMKU1 ;DJB,KRN**DATEDASH,CURSOR,YN,TRAP,ERRMSG,DISCLAIM ; 9/6/02 8:14am
"RTN","%ZVEMKU1",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMKU1",3,0)
 ;
"RTN","%ZVEMKU1",4,0)
DATEDASH(DATE) ;Convert date to "3/4/93" format.
"RTN","%ZVEMKU1",5,0)
 I $G(DATE)']"" Q ""
"RTN","%ZVEMKU1",6,0)
 S DATE=$E(DATE,4,5)_"/"_$E(DATE,6,7)_"/"_$E(DATE,2,3)
"RTN","%ZVEMKU1",7,0)
 Q DATE
"RTN","%ZVEMKU1",8,0)
CURSOR(DX,DY,ERASE) ;Position cursor. If ERASE, erase to end of screen
"RTN","%ZVEMKU1",9,0)
 S DX=+$G(DX),DY=+$G(DY),ERASE=+$G(ERASE) Q:'DY
"RTN","%ZVEMKU1",10,0)
 X VEES("CRSR") Q:'ERASE  W @VEES("BLANK_C_EOS") X VEES("XY")
"RTN","%ZVEMKU1",11,0)
 Q
"RTN","%ZVEMKU1",12,0)
YN(PROMPT,DFLT) ;Process YES/NO type questions. DFLT 1=YES, 2=NO
"RTN","%ZVEMKU1",13,0)
 NEW YN S PROMPT=$G(PROMPT),DFLT=$G(DFLT) S:DFLT']"" DFLT=0
"RTN","%ZVEMKU1",14,0)
YN1 ;
"RTN","%ZVEMKU1",15,0)
 W !,PROMPT,$P("YES// ^NO// ","^",DFLT)
"RTN","%ZVEMKU1",16,0)
 R YN:300 S:'$T YN="^" I YN["^" Q -1
"RTN","%ZVEMKU1",17,0)
 I YN="" Q DFLT
"RTN","%ZVEMKU1",18,0)
 S YN=$E(YN)
"RTN","%ZVEMKU1",19,0)
 I "YyNn"'[YN W:YN'="?" $C(7) W "   Y=YES   N=NO" G YN1
"RTN","%ZVEMKU1",20,0)
 I "Yy"[YN Q 1
"RTN","%ZVEMKU1",21,0)
 Q 2
"RTN","%ZVEMKU1",22,0)
TRAP() ;Set error trap
"RTN","%ZVEMKU1",23,0)
 I $D(^%ZOSF("TRAP")) Q ^("TRAP")
"RTN","%ZVEMKU1",24,0)
 Q "$ZT=X"
"RTN","%ZVEMKU1",25,0)
ERRMSG(PKG) ;Generic error message
"RTN","%ZVEMKU1",26,0)
 NEW ZE
"RTN","%ZVEMKU1",27,0)
 S @("ZE="_VEE("$ZE"))
"RTN","%ZVEMKU1",28,0)
 W $C(7),!!,"NOTE: You've discovered an error in "_PKG_"."
"RTN","%ZVEMKU1",29,0)
 W !,"Error: ",ZE
"RTN","%ZVEMKU1",30,0)
 W !,"Please report error to BOLDUC,DAVID@FORUM.VA.GOV.",!
"RTN","%ZVEMKU1",31,0)
 Q
"RTN","%ZVEMKU1",32,0)
DISCLAIM ;Disclaimer
"RTN","%ZVEMKU1",33,0)
 W !!,"=========================< D I S C L A I M E R >========================="
"RTN","%ZVEMKU1",34,0)
 W !,"IN NO EVENT WILL I, THE DEVELOPER OF THIS SOFTWARE, BE LIABLE FOR DIRECT,"
"RTN","%ZVEMKU1",35,0)
 W !,"INCIDENTAL, INDIRECT, SPECIAL, OR CONSEQUENTIAL DAMAGES RESULTING FROM"
"RTN","%ZVEMKU1",36,0)
 W !,"ANY DEFECT IN THIS SOFTWARE OR ITS DOCUMENTATION OR ARISING OUT OF THE"
"RTN","%ZVEMKU1",37,0)
 W !,"USE OF OR INABILITY TO USE THE SOFTWARE OR ACCOMPANYING DOCUMENTATION."
"RTN","%ZVEMKU1",38,0)
 W !,"DAVID BOLDUC"
"RTN","%ZVEMKU1",39,0)
 W !,"=========================================================================",!
"RTN","%ZVEMKU1",40,0)
 Q
"RTN","%ZVEMKY")
0^69^B16890743
"RTN","%ZVEMKY",1,0)
%ZVEMKY ;DJB,KRN**Kernel - Basic Init ; 4/5/03 7:35am
"RTN","%ZVEMKY",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMKY",3,0)
 ;
"RTN","%ZVEMKY",4,0)
INIT ;Initialize variables
"RTN","%ZVEMKY",5,0)
 D TIME
"RTN","%ZVEMKY",6,0)
 S U="^"
"RTN","%ZVEMKY",7,0)
 S $P(VEELINE,"-",212)=""
"RTN","%ZVEMKY",8,0)
 S $P(VEELINE1,"=",212)=""
"RTN","%ZVEMKY",9,0)
 S $P(VEELINE2,". ",106)=""
"RTN","%ZVEMKY",10,0)
 D IO
"RTN","%ZVEMKY",11,0)
 S VEESIZE=(VEE("IOSL")-6)
"RTN","%ZVEMKY",12,0)
 S VEEIOST=$S($G(IOST)]"":IOST,1:"C-VT100")
"RTN","%ZVEMKY",13,0)
 Q
"RTN","%ZVEMKY",14,0)
 ;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
"RTN","%ZVEMKY",15,0)
TIME ;Set timeout length
"RTN","%ZVEMKY",16,0)
 Q:$G(VEE("TIME"))>0
"RTN","%ZVEMKY",17,0)
 I $G(VEE("ID"))>0,$G(^%ZVEMS("PARAM",VEE("ID"),"TO"))>0 S VEE("TIME")=^("TO") Q
"RTN","%ZVEMKY",18,0)
 S VEE("TIME")=$S($D(DTIME):DTIME,1:300)
"RTN","%ZVEMKY",19,0)
 Q
"RTN","%ZVEMKY",20,0)
 ;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
"RTN","%ZVEMKY",21,0)
IO ;Form Feed, Margin, Sheet Length
"RTN","%ZVEMKY",22,0)
 I $D(VEE("IOF")),$D(VEE("IOSL")),$D(VEE("IOM")) Q
"RTN","%ZVEMKY",23,0)
 D  D PARAM
"RTN","%ZVEMKY",24,0)
 . I $G(IOF)]"",$G(IOSL)]"",$G(IOM)]"" D  Q
"RTN","%ZVEMKY",25,0)
 . . S VEE("IOF")=IOF,VEE("IOSL")=IOSL,VEE("IOM")=IOM
"RTN","%ZVEMKY",26,0)
 . I $D(^%ZIS(1)) D KERN Q
"RTN","%ZVEMKY",27,0)
 . D NOKERN
"RTN","%ZVEMKY",28,0)
 Q
"RTN","%ZVEMKY",29,0)
 ;
"RTN","%ZVEMKY",30,0)
PARAM ;Adjust screen length/width to ..PARAM settings
"RTN","%ZVEMKY",31,0)
 I $G(VEE("ID"))>0 D  ;
"RTN","%ZVEMKY",32,0)
 . S:$D(^%ZVEMS("PARAM",VEE("ID"),"WIDTH")) VEE("IOM")=^("WIDTH")
"RTN","%ZVEMKY",33,0)
 . S:$D(^%ZVEMS("PARAM",VEE("ID"),"LENGTH")) VEE("IOSL")=^("LENGTH")
"RTN","%ZVEMKY",34,0)
 S VEESIZE=VEE("IOSL")-$S(VEE("IOSL")>6:6,1:"")
"RTN","%ZVEMKY",35,0)
 Q
"RTN","%ZVEMKY",36,0)
 ;
"RTN","%ZVEMKY",37,0)
KERN ;VA KERNEL
"RTN","%ZVEMKY",38,0)
 D HOME^%ZIS
"RTN","%ZVEMKY",39,0)
 S VEE("IOSL")=IOSL
"RTN","%ZVEMKY",40,0)
 S VEE("IOF")=IOF
"RTN","%ZVEMKY",41,0)
 S VEE("IOM")=IOM
"RTN","%ZVEMKY",42,0)
 Q
"RTN","%ZVEMKY",43,0)
 ;
"RTN","%ZVEMKY",44,0)
NOKERN ;No VA KERNEL
"RTN","%ZVEMKY",45,0)
 S VEE("IOSL")=24
"RTN","%ZVEMKY",46,0)
 S VEE("IOF")="#,$C(27),""[2J"",$C(27),""[H"""
"RTN","%ZVEMKY",47,0)
 S VEE("IOM")=80
"RTN","%ZVEMKY",48,0)
 Q
"RTN","%ZVEMKY",49,0)
 ;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
"RTN","%ZVEMKY",50,0)
OS ;Get Operating System
"RTN","%ZVEMKY",51,0)
 ;This subroutine returns FLAGQ=1 if VEE("OS") cannot be set.
"RTN","%ZVEMKY",52,0)
 S FLAGQ=0 D  Q:FLAGQ
"RTN","%ZVEMKY",53,0)
 . I $D(^%ZOSF("OS")) S VEE("OS")=+$P(^("OS"),"^",2) Q:VEE("OS")>0
"RTN","%ZVEMKY",54,0)
 . I $D(^DD("OS")) S VEE("OS")=+^("OS") Q:VEE("OS")>0
"RTN","%ZVEMKY",55,0)
 . I $D(^%ZVEMS("OS")) S VEE("OS")=+^("OS") Q:VEE("OS")>0
"RTN","%ZVEMKY",56,0)
 . D SET
"RTN","%ZVEMKY",57,0)
 I VEE("OS")=9 D  Q
"RTN","%ZVEMKY",58,0)
 . X "I $I=1,$ZDEV(""VT"")=0 S FLAGQ=1 D DTMHELP" Q
"RTN","%ZVEMKY",59,0)
 Q
"RTN","%ZVEMKY",60,0)
 ;
"RTN","%ZVEMKY",61,0)
SET ;Get MUMPS System
"RTN","%ZVEMKY",62,0)
 NEW NUM
"RTN","%ZVEMKY",63,0)
 S NUM=7
"RTN","%ZVEMKY",64,0)
 I '$D(^%ZVEMS) D  S FLAGQ=1 Q
"RTN","%ZVEMKY",65,0)
 . W $C(7),!!,"Sorry, this software requires that you have either the VA KERNEL,"
"RTN","%ZVEMKY",66,0)
 . W !,"FileMan, or the VPE Shell on your system.",!
"RTN","%ZVEMKY",67,0)
 NEW X
"RTN","%ZVEMKY",68,0)
 W !!,"I need to know what type of Mumps system you are running."
"RTN","%ZVEMKY",69,0)
 W !,"Select from the following choices. Selecting a system other"
"RTN","%ZVEMKY",70,0)
 W !,"than the one you are running, will cause errors or"
"RTN","%ZVEMKY",71,0)
 W !,"unpredictable behavior. DO SET^%ZVEMKY again to correct."
"RTN","%ZVEMKY",72,0)
 W !!,"1. MSM",!,"2. DTM",!,"3. DSM",!,"4. VAX DSM",!,"5. CACHE",!,"6. GT.M (VMS)",!,"7. GT.M (Unix)"
"RTN","%ZVEMKY",73,0)
 W !
"RTN","%ZVEMKY",74,0)
SET1 R !,"Enter number: ",X:300 S:'$T X="^"
"RTN","%ZVEMKY",75,0)
 I "^"[X W ! S FLAGQ=1 Q
"RTN","%ZVEMKY",76,0)
 I X'?1N!(X<1)!(X>NUM) D  G SET1
"RTN","%ZVEMKY",77,0)
 . W "   Enter a number from 1 to "_NUM
"RTN","%ZVEMKY",78,0)
 S X=$S(X=1:8,X=2:9,X=3:2,X=4:16,X=5:18,X=6:17,X=7:19,1:"")
"RTN","%ZVEMKY",79,0)
 I X']"" Q
"RTN","%ZVEMKY",80,0)
 I $D(^%ZVEMS) S (^%ZVEMS("OS"),VEE("OS"))=X
"RTN","%ZVEMKY",81,0)
 I $D(^%ZVEMS("E")) S (^%ZVEMS("E","OS"),VEE("OS"))=X
"RTN","%ZVEMKY",82,0)
 Q
"RTN","%ZVEMKY",83,0)
 ;
"RTN","%ZVEMKY",84,0)
DTMHELP ;DataTree users on console device must be in VT220 emulation.
"RTN","%ZVEMKY",85,0)
 W !!,"============================================================================="
"RTN","%ZVEMKY",86,0)
 W $C(7),!!?2,"If you are using DataTree Mumps on the console device, you must enable"
"RTN","%ZVEMKY",87,0)
 W !?2,"the VT220 emulation features. You may set the VT device parameter as"
"RTN","%ZVEMKY",88,0)
 W !?2,"follows:"
"RTN","%ZVEMKY",89,0)
 W !!?10,"USE 1:VT=1   ;to enable",!?10,"USE 1:VT=0   ;to disable"
"RTN","%ZVEMKY",90,0)
 W !!?2,"The $ZDEV(""VT"") variable returns the current value of the VT parameter."
"RTN","%ZVEMKY",91,0)
 W !!?2,"If you have the DEVICE and TERMINAL TYPE files from the VA KERNEL on your"
"RTN","%ZVEMKY",92,0)
 W !?2,"system, go into the DEVICE file and edit the device whose $I field equals"
"RTN","%ZVEMKY",93,0)
 W !?2,"1, and enter ""VT=1"" in the USE PARAMETER field."
"RTN","%ZVEMKY",94,0)
 W !!,"=============================================================================",!
"RTN","%ZVEMKY",95,0)
 Q
"RTN","%ZVEMKY1")
0^70^B23953965
"RTN","%ZVEMKY1",1,0)
%ZVEMKY1 ;DJB,KRN**BS,TRMREAD,ECHO,EXIST,XY,$ZE ; 4/5/03 7:43am
"RTN","%ZVEMKY1",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMKY1",3,0)
 ;
"RTN","%ZVEMKY1",4,0)
BS ;Backspace options
"RTN","%ZVEMKY1",5,0)
 I '$D(VEE("ID")) S VEE("BS")="SAME" Q
"RTN","%ZVEMKY1",6,0)
 S VEE("BS")=$G(^%ZVEMS("PARAM",VEE("ID"),"BS"))
"RTN","%ZVEMKY1",7,0)
 I VEE("BS")']"" S VEE("BS")="SAME"
"RTN","%ZVEMKY1",8,0)
 Q
"RTN","%ZVEMKY1",9,0)
 ;
"RTN","%ZVEMKY1",10,0)
ZE ;$ZE Error info
"RTN","%ZVEMKY1",11,0)
 I VEE("OS")=17!(VEE("OS")=19) S VEE("$ZE")="$ZSTATUS" Q
"RTN","%ZVEMKY1",12,0)
 S VEE("$ZE")="$ZE"
"RTN","%ZVEMKY1",13,0)
 Q
"RTN","%ZVEMKY1",14,0)
 ;
"RTN","%ZVEMKY1",15,0)
TRMREAD ;Read terminators
"RTN","%ZVEMKY1",16,0)
 Q:$D(VEE("TRMON"))
"RTN","%ZVEMKY1",17,0)
 I $D(^%ZOSF("TRMON")) D  Q
"RTN","%ZVEMKY1",18,0)
 . S VEE("TRMON")=$G(^%ZOSF("TRMON"))
"RTN","%ZVEMKY1",19,0)
 . S VEE("TRMOFF")=$G(^%ZOSF("TRMOFF"))
"RTN","%ZVEMKY1",20,0)
 . S VEE("TRMRD")=$G(^%ZOSF("TRMRD"))
"RTN","%ZVEMKY1",21,0)
 ;
"RTN","%ZVEMKY1",22,0)
 ;-> DSM
"RTN","%ZVEMKY1",23,0)
 I VEE("OS")=2 D  Q
"RTN","%ZVEMKY1",24,0)
 . S VEE("TRMON")="U $I:(::::1572864::::$C(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31))"
"RTN","%ZVEMKY1",25,0)
 . S VEE("TRMOFF")="U $I:(:::::1572864:::$C(13,27))"
"RTN","%ZVEMKY1",26,0)
 . S VEE("TRMRD")="S Y=$ZB"
"RTN","%ZVEMKY1",27,0)
 ;
"RTN","%ZVEMKY1",28,0)
 ;-> MSM
"RTN","%ZVEMKY1",29,0)
 I VEE("OS")=8 D  Q
"RTN","%ZVEMKY1",30,0)
 . S VEE("TRMON")="U $I:(::::::::$C(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,127))"
"RTN","%ZVEMKY1",31,0)
 . S VEE("TRMOFF")="U $I:(::::::::$C(13,27))"
"RTN","%ZVEMKY1",32,0)
 . S VEE("TRMRD")="S Y=$ZB"
"RTN","%ZVEMKY1",33,0)
 ;
"RTN","%ZVEMKY1",34,0)
 ;-> DTM
"RTN","%ZVEMKY1",35,0)
 I VEE("OS")=9 D  Q
"RTN","%ZVEMKY1",36,0)
 . S VEE("TRMON")="U $I:IXINTERP=2"
"RTN","%ZVEMKY1",37,0)
 . S VEE("TRMOFF")="U $I:IXINTERP=$S($I>99:1,1:0)"
"RTN","%ZVEMKY1",38,0)
 . S VEE("TRMRD")="S Y=$S('$ZIOS:$ZIOT,1:0)"
"RTN","%ZVEMKY1",39,0)
 ;
"RTN","%ZVEMKY1",40,0)
 ;-> DSM for OpenVMS
"RTN","%ZVEMKY1",41,0)
 I VEE("OS")=16 D  Q
"RTN","%ZVEMKY1",42,0)
 . S VEE("TRMON")="U $I:TERM=$C(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,127)"
"RTN","%ZVEMKY1",43,0)
 . S VEE("TRMOFF")="U $I:TERM="""""
"RTN","%ZVEMKY1",44,0)
 . S VEE("TRMRD")="S Y=$ZB"
"RTN","%ZVEMKY1",45,0)
 ;
"RTN","%ZVEMKY1",46,0)
 ;-> CACHE
"RTN","%ZVEMKY1",47,0)
 I VEE("OS")=18 D  Q
"RTN","%ZVEMKY1",48,0)
 . S VEE("TRMON")="U $I:("""":""+I+T"")"
"RTN","%ZVEMKY1",49,0)
 . S VEE("TRMOFF")="U $I:("""":""-I-T"":$C(13,27))"
"RTN","%ZVEMKY1",50,0)
 . S VEE("TRMRD")="S Y=$A($ZB),Y=$S(Y<32:Y,Y=127:Y,1:0)"
"RTN","%ZVEMKY1",51,0)
 ;
"RTN","%ZVEMKY1",52,0)
 ;-> GTM
"RTN","%ZVEMKY1",53,0)
 I VEE("OS")=17!(VEE("OS")=19) D  Q
"RTN","%ZVEMKY1",54,0)
 . S VEE("TRMON")="U $I:(TERMINATOR=$C(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,127))"
"RTN","%ZVEMKY1",55,0)
 . S VEE("TRMOFF")="U $I:(TERMINATOR="""")"
"RTN","%ZVEMKY1",56,0)
 . S VEE("TRMRD")="S Y=$A($ZB)"
"RTN","%ZVEMKY1",57,0)
 ;
"RTN","%ZVEMKY1",58,0)
 ;-> Default
"RTN","%ZVEMKY1",59,0)
 S (VEE("TRMON"),VEE("TRMOFF"),VEE("TRMRD"))=""
"RTN","%ZVEMKY1",60,0)
 W !!,"I'm unable to set READ Terminators for your M system."
"RTN","%ZVEMKY1",61,0)
 W !,"Edit TRMREAD^%ZVEMKY1 and add code for your system."
"RTN","%ZVEMKY1",62,0)
 D PAUSE^%ZVEMKU(2)
"RTN","%ZVEMKY1",63,0)
 Q
"RTN","%ZVEMKY1",64,0)
 ;
"RTN","%ZVEMKY1",65,0)
ECHO ;Set up Echo On and Echo Off
"RTN","%ZVEMKY1",66,0)
 NEW CHK
"RTN","%ZVEMKY1",67,0)
 Q:$D(VEE("EON"))
"RTN","%ZVEMKY1",68,0)
 I $D(^%ZOSF("EON")),$D(^%ZOSF("EOFF")) S VEE("EON")=^%ZOSF("EON"),VEE("EOFF")=^%ZOSF("EOFF") D  Q
"RTN","%ZVEMKY1",69,0)
 . Q:VEE("OS")'=9
"RTN","%ZVEMKY1",70,0)
 . X "S CHK='$ZDEV(""ECHOA"")" Q:CHK
"RTN","%ZVEMKY1",71,0)
 . S VEE("EON")="U $I:ECHOA=1",VEE("EOFF")="U $I:ECHOA=0"
"RTN","%ZVEMKY1",72,0)
 ;
"RTN","%ZVEMKY1",73,0)
 ;-> DSM
"RTN","%ZVEMKY1",74,0)
 I VEE("OS")=2 D  Q
"RTN","%ZVEMKY1",75,0)
 . S VEE("EON")="U $I:(:::::1)",VEE("EOFF")="U $I:(::::1)"
"RTN","%ZVEMKY1",76,0)
 ;
"RTN","%ZVEMKY1",77,0)
 ;-> MSM
"RTN","%ZVEMKY1",78,0)
 I VEE("OS")=8 D  Q
"RTN","%ZVEMKY1",79,0)
 . S VEE("EON")="U $I:(:::::1)",VEE("EOFF")="U $I:(::::1)"
"RTN","%ZVEMKY1",80,0)
 ;
"RTN","%ZVEMKY1",81,0)
 ;-> DTM
"RTN","%ZVEMKY1",82,0)
 I VEE("OS")=9 D  Q
"RTN","%ZVEMKY1",83,0)
 . X "S CHK=$ZDEV(""ECHOA"")"
"RTN","%ZVEMKY1",84,0)
 . I CHK S VEE("EON")="U $I:ECHOA=1",VEE("EOFF")="U $I:ECHOA=0" Q
"RTN","%ZVEMKY1",85,0)
 . S (VEE("EON"),VEE("EOFF"))=""
"RTN","%ZVEMKY1",86,0)
 ;
"RTN","%ZVEMKY1",87,0)
 ;-> VAX DSM
"RTN","%ZVEMKY1",88,0)
 I VEE("OS")=16 D  Q
"RTN","%ZVEMKY1",89,0)
 . S VEE("EON")="U $I:ECHO"
"RTN","%ZVEMKY1",90,0)
 . S VEE("EOFF")="U $I:NOECHO"
"RTN","%ZVEMKY1",91,0)
 ;
"RTN","%ZVEMKY1",92,0)
 ;-> CACHE
"RTN","%ZVEMKY1",93,0)
 I VEE("OS")=18 D  Q
"RTN","%ZVEMKY1",94,0)
 . S VEE("EON")="U $I:("""":""-S"")"
"RTN","%ZVEMKY1",95,0)
 . S VEE("EOFF")="U $I:("""":""+S"")"
"RTN","%ZVEMKY1",96,0)
 . Q
"RTN","%ZVEMKY1",97,0)
 ;
"RTN","%ZVEMKY1",98,0)
 ;-> GTM
"RTN","%ZVEMKY1",99,0)
 I VEE("OS")=17!(VEE("OS")=19) D  Q
"RTN","%ZVEMKY1",100,0)
 . S VEE("EON")="U $I:(ECHO)"
"RTN","%ZVEMKY1",101,0)
 . S VEE("EOFF")="U $I:(NOECHO)"
"RTN","%ZVEMKY1",102,0)
 ;
"RTN","%ZVEMKY1",103,0)
 ;-> Default
"RTN","%ZVEMKY1",104,0)
 S (VEE("EON"),VEE("EOFF"))="" D ECHOMSG,PAUSE^%ZVEMKU(2)
"RTN","%ZVEMKY1",105,0)
 Q
"RTN","%ZVEMKY1",106,0)
 ;
"RTN","%ZVEMKY1",107,0)
EXIST ;Set up VEES("EXIST") to test existence of a routine.
"RTN","%ZVEMKY1",108,0)
 I $D(^%ZOSF("TEST")) S VEES("EXIST")=^("TEST") Q:VEES("EXIST")]""
"RTN","%ZVEMKY1",109,0)
 I $D(^DD("OS",VEE("OS"),18)) S VEES("EXIST")=^(18) Q:VEES("EXIST")]""
"RTN","%ZVEMKY1",110,0)
 I VEE("OS")=2 S VEES("EXIST")="I $D(^ (X))" Q
"RTN","%ZVEMKY1",111,0)
 I VEE("OS")=8 S VEES("EXIST")="I $D(^ (X))" Q
"RTN","%ZVEMKY1",112,0)
 I VEE("OS")=9 S VEES("EXIST")="I $ZRSTATUS(X)]""""" Q
"RTN","%ZVEMKY1",113,0)
 I VEE("OS")=16 S VEES("EXIST")="I $D(^ (X))!$D(^!(X))" Q
"RTN","%ZVEMKY1",114,0)
 I VEE("OS")=18 S VEES("EXIST")="I X?1(1""%"",1A).7AN,$D(^$ROUTINE(X))" Q
"RTN","%ZVEMKY1",115,0)
 I VEE("OS")=17!(VEE("OS")=19) D  Q
"RTN","%ZVEMKY1",116,0)
 . S VEES("EXIST")="I X]"""",$T(^@X)]"""""
"RTN","%ZVEMKY1",117,0)
 ;Default
"RTN","%ZVEMKY1",118,0)
 S VEES("EXIST")="I @(""$T(^""_X_"")]"""""""""")"
"RTN","%ZVEMKY1",119,0)
 Q
"RTN","%ZVEMKY1",120,0)
 ;
"RTN","%ZVEMKY1",121,0)
XY ;Resetting $X & $Y
"RTN","%ZVEMKY1",122,0)
 Q:$D(VEES("XY"))
"RTN","%ZVEMKY1",123,0)
 I $D(^%ZOSF("XY")) S VEES("XY")=^%ZOSF("XY") Q:VEES("XY")]""
"RTN","%ZVEMKY1",124,0)
 I VEE("OS")=2 S VEES("XY")="U $I:(::::::DY*256+DX)" Q
"RTN","%ZVEMKY1",125,0)
 I VEE("OS")=8 S VEES("XY")="U $I:(::::::DY*256+DX)" Q
"RTN","%ZVEMKY1",126,0)
 I VEE("OS")=9 S VEES("XY")="W /C(DX,DY)" Q
"RTN","%ZVEMKY1",127,0)
 I VEE("OS")=16 S VEES("XY")="U $I:(NOCURSOR,X=DX,Y=DY,CURSOR)" Q
"RTN","%ZVEMKY1",128,0)
 I VEE("OS")=18 S VEES("XY")="S $X=DX,$Y=DY" Q
"RTN","%ZVEMKY1",129,0)
 I VEE("OS")=17!(VEE("OS")=19) S VEES("XY")="S $X=DX,$Y=DY" Q
"RTN","%ZVEMKY1",130,0)
 ;Default
"RTN","%ZVEMKY1",131,0)
 S VEES("XY")="" D XYMSG,PAUSE^%ZVEMKU(2)
"RTN","%ZVEMKY1",132,0)
 Q
"RTN","%ZVEMKY1",133,0)
 ;
"RTN","%ZVEMKY1",134,0)
ECHOMSG ;Can't set ECHO ON/OFF
"RTN","%ZVEMKY1",135,0)
 W !!,"I'm unable to set ECHO ON/OFF for your M system."
"RTN","%ZVEMKY1",136,0)
 W !,"Edit ECHO^%ZVEMKY1 and add code for your system."
"RTN","%ZVEMKY1",137,0)
 Q
"RTN","%ZVEMKY1",138,0)
 ;
"RTN","%ZVEMKY1",139,0)
XYMSG ;Can't reset $X & $Y
"RTN","%ZVEMKY1",140,0)
 W !!,"I don't know how to reset $X & $Y on your M system. Edit XY^%ZVEMKY1"
"RTN","%ZVEMKY1",141,0)
 W !,"Edit XY^%ZVEMKY1 and add code for your system."
"RTN","%ZVEMKY1",142,0)
 Q
"RTN","%ZVEMKY2")
0^71^B15983555
"RTN","%ZVEMKY2",1,0)
%ZVEMKY2 ;DJB,KRN**Screen Variables ; 4/5/03 7:47am
"RTN","%ZVEMKY2",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMKY2",3,0)
 ;
"RTN","%ZVEMKY2",4,0)
 ;;X VEES("CRSR"),VEES("RM0"). All others are: W @()
"RTN","%ZVEMKY2",5,0)
SCRNVAR ;Screen Variables
"RTN","%ZVEMKY2",6,0)
 I $G(VEES("RM0"))']"" D RIGHTMAR ;.........Right Margin
"RTN","%ZVEMKY2",7,0)
 I $G(VEES("XY"))']"" D XY^%ZVEMKY1 ;.......Reset $X & $Y
"RTN","%ZVEMKY2",8,0)
 Q:$G(VEES("CRSR"))]""  ;...................Position cursor
"RTN","%ZVEMKY2",9,0)
 D CRSRPOS S VEES("CRSR")=VEES("CRSR")_" "_VEES("XY")
"RTN","%ZVEMKY2",10,0)
 Q
"RTN","%ZVEMKY2",11,0)
CRSRPOS ;Position cursor
"RTN","%ZVEMKY2",12,0)
 Q:$D(VEES("CRSR"))
"RTN","%ZVEMKY2",13,0)
 I $G(IOST(0))]"",$D(^%ZIS(2,IOST(0),"XY")) S VEES("CRSR")=^("XY") Q
"RTN","%ZVEMKY2",14,0)
 S VEES("CRSR")="W $C(27)_""[""_(DY+1)_"";""_(DX+1)_""H"""
"RTN","%ZVEMKY2",15,0)
 Q
"RTN","%ZVEMKY2",16,0)
RIGHTMAR ;Right Margin
"RTN","%ZVEMKY2",17,0)
 I $D(VEES("RM0")),$D(VEES("RM80")) Q
"RTN","%ZVEMKY2",18,0)
 ;
"RTN","%ZVEMKY2",19,0)
 ;--> Default
"RTN","%ZVEMKY2",20,0)
 S (VEES("RM0"),VEES("RM80"))=""
"RTN","%ZVEMKY2",21,0)
 ;
"RTN","%ZVEMKY2",22,0)
 I VEE("OS")=8!(VEE("OS")=18) S VEES("RM0")="U $I:0"
"RTN","%ZVEMKY2",23,0)
 ;I VEE("OS")=16 S VEES("RM0")="U $I:WIDTH=0"
"RTN","%ZVEMKY2",24,0)
 I VEE("OS")=17!(VEE("OS")=19) S VEES("RM0")="U $I:WIDTH=0"
"RTN","%ZVEMKY2",25,0)
 ;
"RTN","%ZVEMKY2",26,0)
 NEW RM
"RTN","%ZVEMKY2",27,0)
 I $G(VEE("ID")) S RM=$G(^%ZVEMS("PARAM",VEE("ID"),"WIDTH"))
"RTN","%ZVEMKY2",28,0)
 I $G(RM)']"" S RM=80 ;Default
"RTN","%ZVEMKY2",29,0)
 I VEE("OS")=8!(VEE("OS")=18) S VEES("RM80")="U $I:"_RM Q
"RTN","%ZVEMKY2",30,0)
 ;I VEE("OS")=16 S VEES("RM80")="U $I:WIDTH="_RM Q
"RTN","%ZVEMKY2",31,0)
 I VEE("OS")=17!(VEE("OS")=19) S VEES("RM80")="U $I:WIDTH="_RM Q
"RTN","%ZVEMKY2",32,0)
 Q
"RTN","%ZVEMKY2",33,0)
WRAP ;Wrap & no wrap
"RTN","%ZVEMKY2",34,0)
 I $D(VEES("WRAP")),$D(VEES("NOWRAP")) Q
"RTN","%ZVEMKY2",35,0)
 I $G(IOST(0))]"",$D(^%ZIS(2,IOST(0),15)),$P(^(15),"^",1)]"",$P(^(15),"^",2)]"" S VEES("WRAP")=$P(^(15),"^",1),VEES("NOWRAP")=$P(^(15),"^",2) Q
"RTN","%ZVEMKY2",36,0)
 S VEES("WRAP")="$C(27)_""[?7h"""
"RTN","%ZVEMKY2",37,0)
 S VEES("NOWRAP")="$C(27)_""[?7l"""
"RTN","%ZVEMKY2",38,0)
 Q
"RTN","%ZVEMKY2",39,0)
CRSRMOVE ;Cursor move
"RTN","%ZVEMKY2",40,0)
 I $D(VEES("CU")),$D(VEES("CD")),$D(VEES("CR")),$D(VEES("CL")) Q
"RTN","%ZVEMKY2",41,0)
 I $G(IOST(0))]"",$D(^%ZIS(2,IOST(0),8)),$P(^(8),"^",1,4)'["^^" NEW NODE8 S NODE8=^(8) D  Q
"RTN","%ZVEMKY2",42,0)
 . S VEES("CU")=$P(NODE8,"^",1),VEES("CD")=$P(NODE8,"^",2)
"RTN","%ZVEMKY2",43,0)
 . S VEES("CR")=$P(NODE8,"^",3),VEES("CL")=$P(NODE8,"^",4)
"RTN","%ZVEMKY2",44,0)
 S VEES("CU")="$C(27)_""[1A""" ;Cursor up
"RTN","%ZVEMKY2",45,0)
 S VEES("CD")="$C(27)_""[1B""" ;Cursor down
"RTN","%ZVEMKY2",46,0)
 S VEES("CR")="$C(27)_""[1C""" ;Cursor right
"RTN","%ZVEMKY2",47,0)
 S VEES("CL")="$C(27)_""[1D""" ;Cursor left
"RTN","%ZVEMKY2",48,0)
 Q
"RTN","%ZVEMKY2",49,0)
CRSROFF ;Cursor on/off
"RTN","%ZVEMKY2",50,0)
 I $D(VEES("CON")),$D(VEES("COFF")) Q
"RTN","%ZVEMKY2",51,0)
 S VEES("CON")="$C(27)_""[?25h""" ;Cursor on
"RTN","%ZVEMKY2",52,0)
 S VEES("COFF")="$C(27)_""[?25l""" ;Cursor off
"RTN","%ZVEMKY2",53,0)
 Q
"RTN","%ZVEMKY2",54,0)
CRSRSAVE ;Save Cursor/Restore Cursor
"RTN","%ZVEMKY2",55,0)
 I $D(VEES("SC")),$D(VEES("RC")) Q
"RTN","%ZVEMKY2",56,0)
 I $G(IOST(0))]"",$D(^%ZIS(2,IOST(0),14)),$P(^(14),"^",3)]"",$P(^(14),"^",4)]"" S VEES("SC")=$P(^(14),"^",3),VEES("RC")=$P(^(14),"^",4) Q
"RTN","%ZVEMKY2",57,0)
 S VEES("SC")="$C(27)_7"
"RTN","%ZVEMKY2",58,0)
 S VEES("RC")="$C(27)_8"
"RTN","%ZVEMKY2",59,0)
 Q
"RTN","%ZVEMKY2",60,0)
REVVID ;Reverse Video
"RTN","%ZVEMKY2",61,0)
 I $D(VEE("RON")),$D(VEE("ROFF")) Q
"RTN","%ZVEMKY2",62,0)
 I $G(IOST(0))]"",$D(^%ZIS(2,IOST(0),5)),$P(^(5),"^",4)]"",$P(^(5),"^",5)]"" S VEE("RON")=$P(^(5),"^",4),VEE("ROFF")=$P(^(5),"^",5) Q
"RTN","%ZVEMKY2",63,0)
 S VEE("RON")="$C(27)_""[7m""",VEE("ROFF")="$C(27)_""[0m"""
"RTN","%ZVEMKY2",64,0)
 Q
"RTN","%ZVEMKY2",65,0)
GRAPHICS ;Graphics On/Off
"RTN","%ZVEMKY2",66,0)
 I $D(VEES("GON")),$D(VEES("GOFF")) Q
"RTN","%ZVEMKY2",67,0)
 I $G(IOST(0))]"",$D(^%ZIS(2,IOST(0),"G1")),$D(^("G2")) S VEES("GON")=^("G1"),VEES("GOFF")=^("G0") Q
"RTN","%ZVEMKY2",68,0)
 S VEES("GON")="$C(27)_""(0""",VEES("GOFF")="$C(27)_""(B"""
"RTN","%ZVEMKY2",69,0)
 Q
"RTN","%ZVEMKY2",70,0)
SCROLL(TOP,BOTTOM) ;Set scroll region
"RTN","%ZVEMKY2",71,0)
 S:$G(TOP)'>0 TOP=1 S:$G(BOTTOM)'>0 BOTTOM=VEE("IOSL")
"RTN","%ZVEMKY2",72,0)
 W @("$C(27)_""["_TOP_";"_BOTTOM_"r""")
"RTN","%ZVEMKY2",73,0)
 Q
"RTN","%ZVEMKY2",74,0)
SCRL ;Scroll region variables
"RTN","%ZVEMKY2",75,0)
 S VEES("INDEX")="$C(27)_""D""",VEES("REVINDEX")="$C(27)_""M""" ;Index
"RTN","%ZVEMKY2",76,0)
 S VEES("INSRT")="$C(27)_""[1L""" ;Insert 1 line
"RTN","%ZVEMKY2",77,0)
 Q
"RTN","%ZVEMKY2",78,0)
SCRNVAR1 ;Lesser Used Screen Variables
"RTN","%ZVEMKY2",79,0)
 S VEES("CION")="$C(27)_""[4h""",VEES("CIOFF")="$C(27)_""[4l""" ;Character insert
"RTN","%ZVEMKY2",80,0)
 Q
"RTN","%ZVEMKY2",81,0)
DTM ;Support for DataTree Mumps
"RTN","%ZVEMKY2",82,0)
 Q:VEE("OS")'=9  Q:$I=1
"RTN","%ZVEMKY2",83,0)
 Q:$G(^%ZVEMS("%",$J_$G(^%ZVEMS("SY")),"SHL"))'="RUN"
"RTN","%ZVEMKY2",84,0)
 X "S ^%ZVEMS(""%"",$J_$G(^%ZVEMS(""SY"")),""DTM"")=$ZDEV(""IXXLATE"")_""^""_$ZDEV(""WRAP"")"
"RTN","%ZVEMKY2",85,0)
 X "U $I:(IXXLATE=0)" ;X "U $I:(IXXLATE=0:WRAP=0)"
"RTN","%ZVEMKY2",86,0)
 Q
"RTN","%ZVEMKY2",87,0)
BRK ;Enable Control C
"RTN","%ZVEMKY2",88,0)
 I $D(^%ZOSF("BRK")) X ^%ZOSF("BRK") Q
"RTN","%ZVEMKY2",89,0)
 I VEE("OS")=16 U $I:CENABLE Q
"RTN","%ZVEMKY2",90,0)
 I VEE("OS")=17 U $I:(CENABLE) Q
"RTN","%ZVEMKY2",91,0)
 I VEE("OS")=18 U $I:("":"+B") Q
"RTN","%ZVEMKY2",92,0)
 I VEE("OS")=19 U $I:(CENABLE) Q
"RTN","%ZVEMKY2",93,0)
 X "B 1"
"RTN","%ZVEMKY2",94,0)
 Q
"RTN","%ZVEMKY2",95,0)
NOBRK ;Disable Control C
"RTN","%ZVEMKY2",96,0)
 I $D(^%ZOSF("NBRK")) X ^%ZOSF("NBRK") Q
"RTN","%ZVEMKY2",97,0)
 I VEE("OS")=16 U $I:NOCENABLE Q
"RTN","%ZVEMKY2",98,0)
 I VEE("OS")=17 U $I:(NOCENABLE) Q
"RTN","%ZVEMKY2",99,0)
 I VEE("OS")=18 U $I:("":"-B") Q
"RTN","%ZVEMKY2",100,0)
 I VEE("OS")=19 U $I:(NOCENABLE) Q
"RTN","%ZVEMKY2",101,0)
 X "B 0"
"RTN","%ZVEMKY2",102,0)
 Q
"RTN","%ZVEMKY3")
0^72^B11891512
"RTN","%ZVEMKY3",1,0)
%ZVEMKY3 ;DJB,KRN**Screen Variables ; 9/8/02 6:20pm
"RTN","%ZVEMKY3",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMKY3",3,0)
 ;
"RTN","%ZVEMKY3",4,0)
BLANK ;
"RTN","%ZVEMKY3",5,0)
 D BLANK1,BLANK2,BLANK3,BLANK4
"RTN","%ZVEMKY3",6,0)
 Q
"RTN","%ZVEMKY3",7,0)
BLANK1 ;Blank - cursor to end-of-screen
"RTN","%ZVEMKY3",8,0)
 Q:$D(VEES("BLANK_C_EOS"))
"RTN","%ZVEMKY3",9,0)
 I $G(IOST(0))]"",$D(^%ZIS(2,IOST(0),5)),$P(^(5),"^",7)]"" S VEES("BLANK_C_EOS")=$P(^(5),"^",7) Q
"RTN","%ZVEMKY3",10,0)
 S VEES("BLANK_C_EOS")="$C(27)_""[J"""
"RTN","%ZVEMKY3",11,0)
 Q
"RTN","%ZVEMKY3",12,0)
BLANK2 ;Blank - top-of-screen to cursor
"RTN","%ZVEMKY3",13,0)
 Q:$D(VEES("BLANK_TOS_C"))
"RTN","%ZVEMKY3",14,0)
 I $G(IOST(0))]"",$D(^%ZIS(2,IOST(0),13)),$P(^(13),"^",1)]"" S VEES("BLANK_TOS_C")=$P(^(13),"^",1) Q
"RTN","%ZVEMKY3",15,0)
 S VEES("BLANK_TOS_C")="$C(27)_""[1J"""
"RTN","%ZVEMKY3",16,0)
 Q
"RTN","%ZVEMKY3",17,0)
BLANK3 ;Blank - cursor to end-of-line
"RTN","%ZVEMKY3",18,0)
 Q:$D(VEES("BLANK_C_EOL"))
"RTN","%ZVEMKY3",19,0)
 I $G(IOST(0))]"",$D(^%ZIS(2,IOST(0),5)),$P(^(5),"^",6)]"" S VEES("BLANK_C_EOL")=$P(^(5),"^",6) Q
"RTN","%ZVEMKY3",20,0)
 S VEES("BLANK_C_EOL")="$C(27)_""[K"""
"RTN","%ZVEMKY3",21,0)
 Q
"RTN","%ZVEMKY3",22,0)
BLANK4 ;Blank - start-of-line to cursor
"RTN","%ZVEMKY3",23,0)
 Q:$D(VEES("BLANK_SOL_C"))
"RTN","%ZVEMKY3",24,0)
 I $G(IOST(0))]"",$D(^%ZIS(2,IOST(0),13)),$P(^(13),"^",3)]"" S VEES("BLANK_SOL_C")=$P(^(13),"^",3) Q
"RTN","%ZVEMKY3",25,0)
 S VEES("BLANK_SOL_C")="$C(27)_""[1K"""
"RTN","%ZVEMKY3",26,0)
 Q
"RTN","%ZVEMKY3",27,0)
 ;====================================================================
"RTN","%ZVEMKY3",28,0)
ZSAVE ;Set up VEES("ZS") to zsave a routine.
"RTN","%ZVEMKY3",29,0)
 ;
"RTN","%ZVEMKY3",30,0)
 I $D(^DD("OS",VEE("OS"),"ZS")) S VEES("ZS")=^("ZS") Q:VEES("ZS")]""
"RTN","%ZVEMKY3",31,0)
 I $D(^DD("OS")),'$D(^DD("OS",VEE("OS"),"ZS")) S FLAGQ=1 D  Q
"RTN","%ZVEMKY3",32,0)
 . W $C(7),!!?5,"Your Mumps system has no way to ZSAVE a routine. I'm aborting.",!!
"RTN","%ZVEMKY3",33,0)
 ;
"RTN","%ZVEMKY3",34,0)
 ;DSM,MSM,DSM for Open VMS
"RTN","%ZVEMKY3",35,0)
 I ",2,8,16,"[(","_VEE("OS")_",") D  Q
"RTN","%ZVEMKY3",36,0)
 . S VEES("ZS")="NEW %Y ZR  S %Y=0 X ""F  S %Y=$O(^UTILITY($J,0,%Y)) Q:%Y'>0  ZI ^(%Y)"" ZS @X"
"RTN","%ZVEMKY3",37,0)
 ;
"RTN","%ZVEMKY3",38,0)
 ;DTM
"RTN","%ZVEMKY3",39,0)
 I VEE("OS")=9 D  Q
"RTN","%ZVEMKY3",40,0)
 . S VEES("ZS")="NEW %X,%Y S %X="""",%Y=0 X ""F  S %Y=$O(^UTILITY($J,0,%Y)) Q:%Y'>0  S %X=%X_$C(10)_^(%Y)"" ZS @X:$E(%X,2,999999)"
"RTN","%ZVEMKY3",41,0)
 ;
"RTN","%ZVEMKY3",42,0)
 ;CACHE
"RTN","%ZVEMKY3",43,0)
 I VEE("OS")=18 D  Q
"RTN","%ZVEMKY3",44,0)
 . S VEES("ZS")="NEW %Y ZR  S %Y=0 X ""F  S %Y=$O(^UTILITY($J,0,%Y)) Q:%Y'>0  Q:'$D(^(%Y))  ZI ^(%Y)"" ZS @X"
"RTN","%ZVEMKY3",45,0)
 ;
"RTN","%ZVEMKY3",46,0)
 ;-> GTM
"RTN","%ZVEMKY3",47,0)
 I VEE("OS")=17 D  Q
"RTN","%ZVEMKY3",48,0)
 . S VEES("ZS")="N %I,%F,%S S %I=$I,%F=$P($ZRO,"","")_X_"".m"" O %F:(NEWVERSION) U %F X ""S %S=0 F  S %S=$O(^UTILITY($J,0,%S)) Q:%S=""""""""  Q:'$D(^(%S))  S %=^UTILITY($J,0,%S) I $E(%)'="""";"""" W %,!"" C %F U %I"
"RTN","%ZVEMKY3",49,0)
 ;
"RTN","%ZVEMKY3",50,0)
 I VEE("OS")=19 D  Q
"RTN","%ZVEMKY3",51,0)
 . S VEES("ZS")="N %I,%F,%S S %I=$I,%F=$P($P($P($ZRO,"")""),""("",2),"" "",1)_""/""_$TR(X,""%"",""_"")_"".m"" O %F:(NEWVERSION) U %F X ""S %S=0  F  S %S=$O(^UTILITY($J,0,%S)) Q:%S=""""""""  Q:'$D(^(%S))  "
"RTN","%ZVEMKY3",52,0)
 . S VEES("ZS")=VEES("ZS")_"S %=^UTILITY($J,0,%S) I $E(%)'="""";"""" W %,!"" C %F U %I"
"RTN","%ZVEMKY3",53,0)
 ;
"RTN","%ZVEMKY3",54,0)
 ;-> Abort if no VEES("ZS")
"RTN","%ZVEMKY3",55,0)
 D ZSAVEMSG S FLAGQ=1
"RTN","%ZVEMKY3",56,0)
 Q
"RTN","%ZVEMKY3",57,0)
ZSAVEMSG ;Can't ZSAVE a routine
"RTN","%ZVEMKY3",58,0)
 W $C(7),!!?5,"You don't have VA Fileman in this UCI, and I don't know how to"
"RTN","%ZVEMKY3",59,0)
 W !?5,"ZSAVE a routine on your Mumps system. I'm aborting."
"RTN","%ZVEMKY3",60,0)
 W !!?5,"Review subroutine ZSAVE^%ZVEMKY3. You may edit this routine and"
"RTN","%ZVEMKY3",61,0)
 W !?5,"add code to cover your M system. If you are running VA Fileman,"
"RTN","%ZVEMKY3",62,0)
 W !?5,"see ^DD(""OS"",system#,""ZS"") for your M system.",!!
"RTN","%ZVEMKY3",63,0)
 Q
"RTN","%ZVEMKYB")
0^73^B15050131
"RTN","%ZVEMKYB",1,0)
%ZVEMKYB ;DJB,KRN**Manual version of ^%ZVEMKY2 Variables ; 4/5/03 8:02am
"RTN","%ZVEMKYB",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMKYB",3,0)
 ;
"RTN","%ZVEMKYB",4,0)
BLANK1 ;Blank - cursor to end-of-screen
"RTN","%ZVEMKYB",5,0)
 I $G(IOST(0))]"",$D(^%ZIS(2,IOST(0),5)),$P(^(5),"^",7)]"" W @($P(^(5),"^",7)) Q
"RTN","%ZVEMKYB",6,0)
 W $C(27)_"[J"
"RTN","%ZVEMKYB",7,0)
 Q
"RTN","%ZVEMKYB",8,0)
BLANK2 ;Blank - top-of-screen to cursor
"RTN","%ZVEMKYB",9,0)
 I $G(IOST(0))]"",$D(^%ZIS(2,IOST(0),13)),$P(^(13),"^",1)]"" W @($P(^(13),"^",1)) Q
"RTN","%ZVEMKYB",10,0)
 W $C(27)_"[1J"
"RTN","%ZVEMKYB",11,0)
 Q
"RTN","%ZVEMKYB",12,0)
BLANK3 ;Blank - cursor to end-of-line
"RTN","%ZVEMKYB",13,0)
 I $G(IOST(0))]"",$D(^%ZIS(2,IOST(0),5)),$P(^(5),"^",6)]"" W @($P(^(5),"^",6)) Q
"RTN","%ZVEMKYB",14,0)
 W $C(27)_"[K"
"RTN","%ZVEMKYB",15,0)
 Q
"RTN","%ZVEMKYB",16,0)
BLANK4 ;Blank - start-of-line to cursor
"RTN","%ZVEMKYB",17,0)
 I $G(IOST(0))]"",$D(^%ZIS(2,IOST(0),13)),$P(^(13),"^",3)]"" W @($P(^(13),"^",3)) Q
"RTN","%ZVEMKYB",18,0)
 W $C(27)_"[1K"
"RTN","%ZVEMKYB",19,0)
 Q
"RTN","%ZVEMKYB",20,0)
RIGHTMAR(MAR) ;Right Margin
"RTN","%ZVEMKYB",21,0)
 S:$G(MAR)'>0 MAR=0 X "I VEE(""OS"")=8 U $I:MAR"
"RTN","%ZVEMKYB",22,0)
 Q
"RTN","%ZVEMKYB",23,0)
WRAP(WHICH) ;Wrap & no wrap. WHICH=ON/OFF.
"RTN","%ZVEMKYB",24,0)
 S WHICH=$$ALLCAPS^%ZVEMKU(WHICH) Q:",ON,OFF,"'[(","_WHICH_",")
"RTN","%ZVEMKYB",25,0)
 I $G(IOST(0))]"",$D(^%ZIS(2,IOST(0),15)),$P(^(15),"^",1)]"",$P(^(15),"^",2)]"" D  Q
"RTN","%ZVEMKYB",26,0)
 . I WHICH="OFF" W @($P(^(15),"^",2)) Q
"RTN","%ZVEMKYB",27,0)
 . W @($P(^(15),"^",1))
"RTN","%ZVEMKYB",28,0)
 I WHICH="OFF" W $C(27)_"[?7l" Q
"RTN","%ZVEMKYB",29,0)
 W $C(27)_"[?7h"
"RTN","%ZVEMKYB",30,0)
 Q
"RTN","%ZVEMKYB",31,0)
CRSRPOS(DX,DY) ;Position cursor to coordinates DX & DY. Default is 0,0
"RTN","%ZVEMKYB",32,0)
 S:$G(DX)'>0 DX=0 S:$G(DY)'>0 DY=0
"RTN","%ZVEMKYB",33,0)
 I $G(IOST(0))]"",$D(^%ZIS(2,IOST(0),"XY")) X ^("XY") Q
"RTN","%ZVEMKYB",34,0)
 W $C(27)_"["_(DY+1)_";"_(DX+1)_"H"
"RTN","%ZVEMKYB",35,0)
 Q
"RTN","%ZVEMKYB",36,0)
CRSRMOVE(DIR) ;Cursor move up/down/right/left. DIR=U/D/R/L
"RTN","%ZVEMKYB",37,0)
 S DIR=$$ALLCAPS^%ZVEMKU(DIR) Q:",U,D,R,L,"'[(","_DIR_",")
"RTN","%ZVEMKYB",38,0)
 I $G(IOST(0))]"",$D(^%ZIS(2,IOST(0),8)),$P(^(8),"^",1,4)'["^^" D  Q
"RTN","%ZVEMKYB",39,0)
 . NEW I,NODE8,VAR S NODE8=^(8),VAR="U^D^R^L"
"RTN","%ZVEMKYB",40,0)
 . F I=1:1:4 I DIR=$P(VAR,"^",I) W @($P(NODE8,"^",I)) Q
"RTN","%ZVEMKYB",41,0)
 I DIR="U" W $C(27)_"[1A" Q
"RTN","%ZVEMKYB",42,0)
 I DIR="D" W $C(27)_"[1B" Q
"RTN","%ZVEMKYB",43,0)
 I DIR="R" W $C(27)_"[1C" Q
"RTN","%ZVEMKYB",44,0)
 I DIR="L" W $C(27)_"[1D"
"RTN","%ZVEMKYB",45,0)
 Q
"RTN","%ZVEMKYB",46,0)
CRSROFF(WHICH) ;Cursor on/off. WHICH=ON/OFF
"RTN","%ZVEMKYB",47,0)
 S WHICH=$$ALLCAPS^%ZVEMKU(WHICH) Q:",ON,OFF,"'[(","_WHICH_",")
"RTN","%ZVEMKYB",48,0)
 I WHICH="ON" W $C(27)_"[?25h" Q
"RTN","%ZVEMKYB",49,0)
 I WHICH="OFF" W $C(27)_"[?25l"
"RTN","%ZVEMKYB",50,0)
 Q
"RTN","%ZVEMKYB",51,0)
CRSRSAVE(WHICH) ;Cursor Save/Restore. WHICH=S/R
"RTN","%ZVEMKYB",52,0)
 S WHICH=$$ALLCAPS^%ZVEMKU(WHICH) Q:",R,S,"'[(","_WHICH_",")
"RTN","%ZVEMKYB",53,0)
 I $G(IOST(0))]"",$D(^%ZIS(2,IOST(0),14)),$P(^(14),"^",3)]"",$P(^(14),"^",4)]"" D  Q
"RTN","%ZVEMKYB",54,0)
 . I WHICH="R" W @($P(^(14),"^",4)) Q
"RTN","%ZVEMKYB",55,0)
 . I WHICH="S" W @($P(^(14),"^",3))
"RTN","%ZVEMKYB",56,0)
 I WHICH="R" W $C(27)_8 Q
"RTN","%ZVEMKYB",57,0)
 I WHICH="S" W $C(27)_7
"RTN","%ZVEMKYB",58,0)
 Q
"RTN","%ZVEMKYB",59,0)
REVVID(WHICH) ;Reverse Video. WHICH=ON/OFF
"RTN","%ZVEMKYB",60,0)
 S WHICH=$$ALLCAPS^%ZVEMKU(WHICH) Q:",ON,OFF,"'[(","_WHICH_",")
"RTN","%ZVEMKYB",61,0)
 I $G(IOST(0))]"",$D(^%ZIS(2,IOST(0),5)),$P(^(5),"^",4)]"",$P(^(5),"^",5)]"" D  Q
"RTN","%ZVEMKYB",62,0)
 . I WHICH="ON" W @($P(^(5),"^",4)) Q
"RTN","%ZVEMKYB",63,0)
 . I WHICH="OFF" W @($P(^(5),"^",5))
"RTN","%ZVEMKYB",64,0)
 I WHICH="ON" W $C(27)_"[7m" Q
"RTN","%ZVEMKYB",65,0)
 I WHICH="OFF" W $C(27)_"[0m"
"RTN","%ZVEMKYB",66,0)
 Q
"RTN","%ZVEMKYB",67,0)
GRAPHICS(WHICH) ;Graphics On/Off. WHICH=ON/OFF
"RTN","%ZVEMKYB",68,0)
 S WHICH=$$ALLCAPS^%ZVEMKU(WHICH) Q:",ON,OFF,"'[(","_WHICH_",")
"RTN","%ZVEMKYB",69,0)
 I $G(IOST(0))]"",$D(^%ZIS(2,IOST(0),"G1")),$D(^("G2")) S VEES("GON")=^("G1"),VEES("GOFF")=^("G0") Q
"RTN","%ZVEMKYB",70,0)
 . I WHICH="ON" X @(^("G1")) Q
"RTN","%ZVEMKYB",71,0)
 . I WHICH="OFF" X @(^("G0"))
"RTN","%ZVEMKYB",72,0)
 I WHICH="ON" W $C(27)_"(0" Q
"RTN","%ZVEMKYB",73,0)
 I WHICH="OFF" W $C(27)_"(B"
"RTN","%ZVEMKYB",74,0)
 Q
"RTN","%ZVEMKYB",75,0)
CHARI(WHICH) ;Character Insert. WHICH=ON/OFF
"RTN","%ZVEMKYB",76,0)
 S WHICH=$$ALLCAPS^%ZVEMKU(WHICH) Q:",ON,OFF,"'[(","_WHICH_",")
"RTN","%ZVEMKYB",77,0)
 I WHICH="ON" W $C(27)_"[4h" Q
"RTN","%ZVEMKYB",78,0)
 I WHICH="OFF" W $C(27)_"[4l"
"RTN","%ZVEMKYB",79,0)
 Q
"RTN","%ZVEMKYB",80,0)
HELP ;Help text
"RTN","%ZVEMKYB",81,0)
 W @VEE("IOF"),!?1,"xxxx^%ZVEMKYB()"
"RTN","%ZVEMKYB",82,0)
 W !?1,"BLANK1....:           :Blank cursor to end-of-screen"
"RTN","%ZVEMKYB",83,0)
 W !?1,"BLANK2....:           :Blank top-of-screen to cursor"
"RTN","%ZVEMKYB",84,0)
 W !?1,"BLANK3....:           :Blank cursor to end-of-line"
"RTN","%ZVEMKYB",85,0)
 W !?1,"BLANK4....:           :Blank start-of-line to cursor"
"RTN","%ZVEMKYB",86,0)
 W !?1,"RIGHTMAR..: MAR       :Right margin"
"RTN","%ZVEMKYB",87,0)
 W !?1,"WRAP......: ON/OFF    ;Wrap/nowrap"
"RTN","%ZVEMKYB",88,0)
 W !?1,"CRSRPOS...: DX/DY     ;Curor position"
"RTN","%ZVEMKYB",89,0)
 W !?1,"CRSRMOVE..: U/D/R/L   ;Cursor move"
"RTN","%ZVEMKYB",90,0)
 W !?1,"CRSROFF...: ON/OFF    ;Cursor on/off"
"RTN","%ZVEMKYB",91,0)
 W !?1,"CRSRSAVE..: S/R       ;Cursor save/restore"
"RTN","%ZVEMKYB",92,0)
 W !?1,"REVVID....: ON/OFF    ;Reverse video"
"RTN","%ZVEMKYB",93,0)
 W !?1,"GRAPHICS..: ON/OFF    ;Graphics on/off"
"RTN","%ZVEMKYB",94,0)
 W !?1,"CHARI.....: ON/OFF    ;Character insert"
"RTN","%ZVEMKYB",95,0)
 W ! Q
"RTN","%ZVEMO")
0^74^B7291860
"RTN","%ZVEMO",1,0)
%ZVEMO ;DJB,VRROLD**VRoutine Reader [12/31/94]
"RTN","%ZVEMO",2,0)
 ;;7.0;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMO",3,0)
 ;
"RTN","%ZVEMO",4,0)
EN ;Entry Point
"RTN","%ZVEMO",5,0)
 I $G(DUZ)'>0 D ID^%ZVEMKU Q:$G(DUZ)=""
"RTN","%ZVEMO",6,0)
 NEW X S X="ERROR^%ZVEMOY",@($$TRAP^%ZVEMKU1) KILL X
"RTN","%ZVEMO",7,0)
START ;
"RTN","%ZVEMO",8,0)
 NEW BOTTOM,CODE,CODELN,CODETG,DX,DY,END,END1,I,LNUM,PGTOP,START,STNG,TAG
"RTN","%ZVEMO",9,0)
 NEW FLAGBLNK,FLAGDEL,FLAGL,FLAGQ,FLAGTAG
"RTN","%ZVEMO",10,0)
 NEW VRRACT,VRRCRSR,VRRHIGH,VRRLINE,VRRLN,VRRMARK,VRRPGM,VRRSP
"RTN","%ZVEMO",11,0)
 I $G(VEELINE)="" NEW VEEIOST,VEELINE,VEELINE1,VEELINE2,VEESIZE,VEEX,VEEY
"RTN","%ZVEMO",12,0)
 ;FLAGVPE="VEDD^VGL^VRR^EDIT"
"RTN","%ZVEMO",13,0)
 I '$D(FLAGVPE) NEW FLAGVPE
"RTN","%ZVEMO",14,0)
 I $G(FLAGVPE)'["VRR" NEW VEES,VRRS,FLAGCOL
"RTN","%ZVEMO",15,0)
 I $G(FLAGVPE)'["EDIT",$D(VEE("OS"))#2=0 NEW VEE ;Mumps system
"RTN","%ZVEMO",16,0)
 ;
"RTN","%ZVEMO",17,0)
 S FLAGQ=0 D INIT^%ZVEMOY G:FLAGQ EX
"RTN","%ZVEMO",18,0)
 X VEES("RM0")
"RTN","%ZVEMO",19,0)
 S $P(FLAGVPE,"^",3)="VRR" ;Marks VRR as running
"RTN","%ZVEMO",20,0)
 D EN^%ZVEMOS G:FLAGQ EX ;Get Program
"RTN","%ZVEMO",21,0)
 S FLAGCOL=0 ;Used by Collapse option
"RTN","%ZVEMO",22,0)
 ;FLAGBLNK: Marks when last screen is blank
"RTN","%ZVEMO",23,0)
 ;FLAGTAG: Used by FIND TAG and LOCATE STRING
"RTN","%ZVEMO",24,0)
 ;FLAGDEL: Allows blanket DELETE with <ESCT> & <ESCD>
"RTN","%ZVEMO",25,0)
TOP ;
"RTN","%ZVEMO",26,0)
 X VEES("RM0")
"RTN","%ZVEMO",27,0)
 S FLAGL=0 ;Marks last screen
"RTN","%ZVEMO",28,0)
 D FF^%ZVEMOU
"RTN","%ZVEMO",29,0)
 F LNUM=START:1 S FLAGQ=0 Q:'$D(^TMP("VEE","VRR",$J,VRRS,"TXT",LNUM))  S CODE=^(LNUM) D PRINT Q:FLAGQ=1
"RTN","%ZVEMO",30,0)
 S FLAGL=1 I FLAGQ'=1 D PAGE^%ZVEMOM I FLAGQ'=1 S START=LNUM+1 G TOP
"RTN","%ZVEMO",31,0)
EX ;
"RTN","%ZVEMO",32,0)
 S VRRS=VRRS-1 Q:VRRS  X VEES("RM80")
"RTN","%ZVEMO",33,0)
 KILL:$G(FLAGVPE)'["EDIT" ^TMP("VEE","VRR",$J)
"RTN","%ZVEMO",34,0)
 Q
"RTN","%ZVEMO",35,0)
PRINT ;Print routine lines
"RTN","%ZVEMO",36,0)
 S CODETG=$P(CODE,$C(9)),CODELN=$P(CODE,$C(9),2,999)
"RTN","%ZVEMO",37,0)
 I $G(FLAGTAG)?1"F".E S PGTOP=LNUM D  Q:FLAGTAG'=0  ;Find Tag,Strng
"RTN","%ZVEMO",38,0)
 . I FLAGTAG="FT" Q:$E(CODETG,1,$L(TAG))'=TAG
"RTN","%ZVEMO",39,0)
 . I FLAGTAG="FS" Q:CODE'[STNG
"RTN","%ZVEMO",40,0)
 . S FLAGTAG=0
"RTN","%ZVEMO",41,0)
 S FLAGBLNK=0 ;Surpress highlight on blank page
"RTN","%ZVEMO",42,0)
 S (END,END1)=VEE("IOM")-10 I $L(CODETG)>8 S END1=END1-($L(CODETG)-9)
"RTN","%ZVEMO",43,0)
 W !,@$S(CODETG]"":"$J(CODETG,8)",1:"LNUM"),?9,$E(CODELN,1,END1)
"RTN","%ZVEMO",44,0)
 S $P(VRRLOC,"^",LNUM)=$Y_"*"_$S($L(CODETG)>8:$E(CODETG,9),1:" ")
"RTN","%ZVEMO",45,0)
 D:$Y>VEESIZE PAGE^%ZVEMOM Q:FLAGQ  S CODELN=$E(CODELN,(END1+1),999) D PRINT1
"RTN","%ZVEMO",46,0)
 I $G(VRRSP)=2 W ! D:$Y>VEESIZE PAGE^%ZVEMOM Q:FLAGQ  ;Double space
"RTN","%ZVEMO",47,0)
 Q
"RTN","%ZVEMO",48,0)
PRINT1 ;Use GOTO to conserve stack levels
"RTN","%ZVEMO",49,0)
 Q:CODELN=""
"RTN","%ZVEMO",50,0)
 W !?9,$E(CODELN,1,END) D:$Y>VEESIZE PAGE^%ZVEMOM Q:FLAGQ  S CODELN=$E(CODELN,(END+1),999)
"RTN","%ZVEMO",51,0)
 G PRINT1
"RTN","%ZVEMO",52,0)
PARAM(X) ;Parameter Passing....X=Routine Name
"RTN","%ZVEMO",53,0)
 S ^TMP("VEE",$J)=$G(X)
"RTN","%ZVEMO",54,0)
 I $G(DUZ)'>0 D ID^%ZVEMKU I $G(DUZ)="" KILL ^TMP("VEE",$J) Q
"RTN","%ZVEMO",55,0)
 I ^TMP("VEE",$J)]"" NEW FLAGPRM,%1 S FLAGPRM=1,%1=^($J)
"RTN","%ZVEMO",56,0)
 KILL ^TMP("VEE",$J)
"RTN","%ZVEMO",57,0)
 G EN
"RTN","%ZVEMOC")
0^75^B7936734
"RTN","%ZVEMOC",1,0)
%ZVEMOC ;DJB,VRROLD**Saves editing changes ; 12/16/00 10:45pm
"RTN","%ZVEMOC",2,0)
 ;;7.0;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMOC",3,0)
 ;
"RTN","%ZVEMOC",4,0)
SAVE ;Sets up ^UTILITY so rtn editor can save changes.
"RTN","%ZVEMOC",5,0)
 ;If VRRPGM is defined, Editor will save edited routine to @VRRPGM.
"RTN","%ZVEMOC",6,0)
 ;If VRRPGM="" changes aren't saved.
"RTN","%ZVEMOC",7,0)
 ;
"RTN","%ZVEMOC",8,0)
 NEW CD,FLAGQ,XX
"RTN","%ZVEMOC",9,0)
 S VRRPGM=$G(^TMP("VEE","VRR",$J,1,"NAME")) G:VRRPGM']"" EX1
"RTN","%ZVEMOC",10,0)
 I '$D(^TMP("VEE","VRR",$J,1,"TXT")) S VRRPGM="" G EX1
"RTN","%ZVEMOC",11,0)
 S FLAGQ=0
"RTN","%ZVEMOC",12,0)
 D INIT I FLAGQ S VRRPGM="" G EX1
"RTN","%ZVEMOC",13,0)
 X VEES("RM0")
"RTN","%ZVEMOC",14,0)
 D @$S($G(FLAGSAVE):"ASK",1:"ASK1")
"RTN","%ZVEMOC",15,0)
 G:VRRPGM="" EX
"RTN","%ZVEMOC",16,0)
 D DATE,LOAD
"RTN","%ZVEMOC",17,0)
EX ;
"RTN","%ZVEMOC",18,0)
 X VEES("RM80")
"RTN","%ZVEMOC",19,0)
EX1 KILL ^TMP("VEE","VRR",$J)
"RTN","%ZVEMOC",20,0)
 I VRRPGM="" W !?3,"Changes not saved..",!
"RTN","%ZVEMOC",21,0)
 E  W !?3,"^",VRRPGM," saved to disk..",!
"RTN","%ZVEMOC",22,0)
 Q
"RTN","%ZVEMOC",23,0)
 ;
"RTN","%ZVEMOC",24,0)
ASK ;Ask to save changes
"RTN","%ZVEMOC",25,0)
 W !?3,"Routine: ^",VRRPGM,!?3,"Save your changes?"
"RTN","%ZVEMOC",26,0)
 S XX=$$CHOICE^%ZVEMKC("YES^NO^SAVE_AS",1)
"RTN","%ZVEMOC",27,0)
 I XX=0!(XX=2) S VRRPGM="" Q
"RTN","%ZVEMOC",28,0)
 I XX=3 D SAVEAS
"RTN","%ZVEMOC",29,0)
 Q
"RTN","%ZVEMOC",30,0)
 ;
"RTN","%ZVEMOC",31,0)
ASK1 ;No changes made. Ask to save to new rtn.
"RTN","%ZVEMOC",32,0)
 W !?3,"Routine: ^",VRRPGM,!?3,"Select OPTION:"
"RTN","%ZVEMOC",33,0)
 S XX=$$CHOICE^%ZVEMKC("QUIT^SAVE_AS",1)
"RTN","%ZVEMOC",34,0)
 I XX'=2 S VRRPGM="" Q
"RTN","%ZVEMOC",35,0)
 D SAVEAS
"RTN","%ZVEMOC",36,0)
 Q
"RTN","%ZVEMOC",37,0)
 ;
"RTN","%ZVEMOC",38,0)
SAVEAS ;Save routine to a new name
"RTN","%ZVEMOC",39,0)
 NEW TMP
"RTN","%ZVEMOC",40,0)
 W !?3,"Save as routine: ^"
"RTN","%ZVEMOC",41,0)
 R VRRPGM:600 S:'$T VRRPGM="^" I "^"[VRRPGM S VRRPGM="" Q
"RTN","%ZVEMOC",42,0)
 I $E(VRRPGM)="?" W "   Enter new name for this edited routine" G SAVEAS
"RTN","%ZVEMOC",43,0)
 I $E(VRRPGM)="^" S VRRPGM=$E(VRRPGM,2,99)
"RTN","%ZVEMOC",44,0)
 I VRRPGM'?1A.7AN,VRRPGM'?1"%"1A.6AN W $C(7),"   Invalid routine name" G SAVEAS
"RTN","%ZVEMOC",45,0)
 I $$EXIST^%ZVEMKU(VRRPGM) D EXISTS I VRRPGM']"" W ! G SAVEAS
"RTN","%ZVEMOC",46,0)
 S TMP=$P(^TMP("VEE","VRR",$J,1,"TXT",1),$C(9))
"RTN","%ZVEMOC",47,0)
 S TMP=$S(TMP'["(":"",1:"("_$P(TMP,"(",2,99))
"RTN","%ZVEMOC",48,0)
 S $P(^TMP("VEE","VRR",$J,1,"TXT",1),$C(9))=VRRPGM_TMP
"RTN","%ZVEMOC",49,0)
 Q
"RTN","%ZVEMOC",50,0)
 ;
"RTN","%ZVEMOC",51,0)
EXISTS ;Routine already exists
"RTN","%ZVEMOC",52,0)
 W $C(7),!!?3,"WARNING...Routine ^",VRRPGM," already exists."
"RTN","%ZVEMOC",53,0)
 W !?3,"Shall I overwrite?"
"RTN","%ZVEMOC",54,0)
 S XX=$$CHOICE^%ZVEMKC("YES^NO",1)
"RTN","%ZVEMOC",55,0)
 I XX'=1 S VRRPGM=""
"RTN","%ZVEMOC",56,0)
 Q
"RTN","%ZVEMOC",57,0)
 ;
"RTN","%ZVEMOC",58,0)
LOAD ;Load routine into ^UTILITY
"RTN","%ZVEMOC",59,0)
 KILL ^UTILITY($J)
"RTN","%ZVEMOC",60,0)
 F XX=1:1 Q:'$D(^TMP("VEE","VRR",$J,1,"TXT",XX))  S CD=^(XX),CD=$P(CD,$C(9))_" "_$P(CD,$C(9),2,999),^UTILITY($J,0,XX)=CD
"RTN","%ZVEMOC",61,0)
 Q
"RTN","%ZVEMOC",62,0)
 ;
"RTN","%ZVEMOC",63,0)
DATE ;Attach date to top line
"RTN","%ZVEMOC",64,0)
 NEW DATE,LN,PIECE,TIME
"RTN","%ZVEMOC",65,0)
 Q:'$D(^TMP("VEE","VRR",$J,1,"TXT",1))  S LN=^(1),PIECE=$L(^(1)," [")
"RTN","%ZVEMOC",66,0)
 S:$P(LN," [",PIECE)?1.2N1"/"2N1"/"2N.E1"]" LN=$P(LN," [",1,PIECE-1)
"RTN","%ZVEMOC",67,0)
 S DATE=$$DATE^%ZVEMKDT(2),TIME=$$TIME^%ZVEMKDT(2)
"RTN","%ZVEMOC",68,0)
 S ^(1)=LN_" ["_DATE_" "_TIME_"]"
"RTN","%ZVEMOC",69,0)
 Q
"RTN","%ZVEMOC",70,0)
 ;
"RTN","%ZVEMOC",71,0)
INIT ;
"RTN","%ZVEMOC",72,0)
 I '$D(VEE("OS")) D OS^%ZVEMKY Q:FLAGQ
"RTN","%ZVEMOC",73,0)
 D ZSAVE^%ZVEMKY3 Q:FLAGQ  D SCRNVAR^%ZVEMKY2,REVVID^%ZVEMKY2
"RTN","%ZVEMOC",74,0)
 Q
"RTN","%ZVEMOE")
0^76^B6408025
"RTN","%ZVEMOE",1,0)
%ZVEMOE ;DJB,VRROLD**INSERT,DELETE,CHANGE [12/31/94]
"RTN","%ZVEMOE",2,0)
 ;;7.0;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMOE",3,0)
 ;
"RTN","%ZVEMOE",4,0)
DELETE ;Delete a line
"RTN","%ZVEMOE",5,0)
 NEW VRRLN,I,II,X1,X2 D BOTTOM^%ZVEMOU
"RTN","%ZVEMOE",6,0)
DELETEA S VRRLN=$$GETLINE^%ZVEMOU("DELETE WHICH LINE NUMBER(S): ") Q:VRRLN="^"
"RTN","%ZVEMOE",7,0)
DELETEB I VRRLN=1 W $C(7) Q
"RTN","%ZVEMOE",8,0)
 I VRRLN="?"!(VRRLN="INVALID") D MSG2^%ZVEMOUM(12) G DELETEA
"RTN","%ZVEMOE",9,0)
 I VRRLN="INVALID RNG" D MSG2^%ZVEMOUM(13) G DELETEA
"RTN","%ZVEMOE",10,0)
 S (X1,X2)=VRRLN I VRRLN["-" S X1=$P(VRRLN,"-"),X2=$P(VRRLN,"-",2),VRRLN=X1
"RTN","%ZVEMOE",11,0)
 F I=X1:1:X2 D
"RTN","%ZVEMOE",12,0)
 . F II=VRRLN:1:(VRRHIGH-1) S ^TMP("VEE","VRR",$J,VRRS,"TXT",II)=^TMP("VEE","VRR",$J,VRRS,"TXT",(II+1))
"RTN","%ZVEMOE",13,0)
 . KILL ^TMP("VEE","VRR",$J,VRRS,"TXT",VRRHIGH) S VRRHIGH=VRRHIGH-1,FLAGSAVE=1
"RTN","%ZVEMOE",14,0)
 . S $P(^TMP("VEE","VRR",$J,VRRS,"HOT"),"^",1)=VRRHIGH
"RTN","%ZVEMOE",15,0)
 Q
"RTN","%ZVEMOE",16,0)
 ;====================================================================
"RTN","%ZVEMOE",17,0)
INSERT ;Insert line of code
"RTN","%ZVEMOE",18,0)
 NEW VRRLN,CD
"RTN","%ZVEMOE",19,0)
 D BOTTOM^%ZVEMOU
"RTN","%ZVEMOE",20,0)
INSERTA S VRRLN=$$GETLINE^%ZVEMOU("INSERT AFTER LINE NUMBER: ") Q:VRRLN="^"
"RTN","%ZVEMOE",21,0)
 I VRRLN'?1.N D MSG2^%ZVEMOUM(14) G INSERTA
"RTN","%ZVEMOE",22,0)
 D BOTTOM^%ZVEMOU W ?1,"ENTER CODE:"
"RTN","%ZVEMOE",23,0)
INSERT1 D BOTTOM1^%ZVEMOU
"RTN","%ZVEMOE",24,0)
INSERT2 R ?1,"*",CD:VEE("TIME") S:'$T CD="^" I "^"[CD Q
"RTN","%ZVEMOE",25,0)
 I "??"[CD D MSGS^%ZVEMOUM(15,1) G INSERT1
"RTN","%ZVEMOE",26,0)
 I $$TAGCHK^%ZVEMOEU(CD) Q
"RTN","%ZVEMOE",27,0)
 I $$LINECHK^%ZVEMOEU(CD) Q
"RTN","%ZVEMOE",28,0)
 S VRRHIGH=VRRHIGH+1
"RTN","%ZVEMOE",29,0)
 S $P(^TMP("VEE","VRR",$J,VRRS,"HOT"),"^",1)=VRRHIGH
"RTN","%ZVEMOE",30,0)
 F I=VRRHIGH:-1:(VRRLN+2) S ^TMP("VEE","VRR",$J,VRRS,"TXT",I)=^TMP("VEE","VRR",$J,VRRS,"TXT",(I-1))
"RTN","%ZVEMOE",31,0)
 S VRRLN=VRRLN+1 D SAVE^%ZVEMOEU,KILLCHK^%ZVEMKU(CD)
"RTN","%ZVEMOE",32,0)
 W ! G INSERT2
"RTN","%ZVEMOE",33,0)
 ;====================================================================
"RTN","%ZVEMOE",34,0)
CHANGE ;Change a line
"RTN","%ZVEMOE",35,0)
 NEW VRRLN D BOTTOM^%ZVEMOU
"RTN","%ZVEMOE",36,0)
CHANGE1 S VRRLN=$$GETLINE^%ZVEMOU("CHANGE LINE NUMBER: ") G:VRRLN="^" EX
"RTN","%ZVEMOE",37,0)
 I VRRLN'?1.N D MSGS^%ZVEMOUM(3) G CHANGE1
"RTN","%ZVEMOE",38,0)
CHANGE2 ;Entry point for ^%ZVEMOM
"RTN","%ZVEMOE",39,0)
 NEW CD,CDHLD,CHK,NEW,OLD,TAB,TEMP,TEMP1,VALID
"RTN","%ZVEMOE",40,0)
 S (CD,CDHLD)=$G(^TMP("VEE","VRR",$J,VRRS,"TXT",VRRLN)) G:CD']"" EX
"RTN","%ZVEMOE",41,0)
 I $G(^%ZVEMS("E","EDIT",DUZ))'="LINE" D ^%ZVEMOEA G EX ;Screen mode editor.
"RTN","%ZVEMOE",42,0)
CHANGE3 D LINE^%ZVEMKE("") G:CD=CDHLD EX
"RTN","%ZVEMOE",43,0)
 S TEMP=$$TAGCHK^%ZVEMOEU(CD) I TEMP S CD=CDHLD G CHANGE3
"RTN","%ZVEMOE",44,0)
 S TEMP=$$LINECHK^%ZVEMOEU(CD) I TEMP D:TEMP=2 DELLINE^%ZVEMOEA G:TEMP=2 EX S CD=CDHLD G CHANGE3
"RTN","%ZVEMOE",45,0)
 D SAVE^%ZVEMOEU
"RTN","%ZVEMOE",46,0)
EX ;Exit
"RTN","%ZVEMOE",47,0)
 D KILLCHK^%ZVEMKU(CD)
"RTN","%ZVEMOE",48,0)
 Q
"RTN","%ZVEMOE1")
0^77^B7353628
"RTN","%ZVEMOE1",1,0)
%ZVEMOE1 ;DJB,VRROLD**SAVE,UNSAVE,LC,BREAK,JOIN [12/31/94]
"RTN","%ZVEMOE1",2,0)
 ;;7.0;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMOE1",3,0)
 ;
"RTN","%ZVEMOE1",4,0)
SAVE ;Save a line
"RTN","%ZVEMOE1",5,0)
 NEW CNT,VRRLN,X1,X2
"RTN","%ZVEMOE1",6,0)
 D BOTTOM^%ZVEMOU
"RTN","%ZVEMOE1",7,0)
SAVEA S VRRLN=$$GETLINE^%ZVEMOU("SAVE WHICH LINE NUMBER(S): ") Q:VRRLN="^"
"RTN","%ZVEMOE1",8,0)
 I VRRLN="?"!(VRRLN="INVALID") D MSG2^%ZVEMOUM(12) G SAVEA
"RTN","%ZVEMOE1",9,0)
 I VRRLN="INVALID RNG" D MSG2^%ZVEMOUM(13) G SAVEA
"RTN","%ZVEMOE1",10,0)
 S CNT=1,(X1,X2)=VRRLN I VRRLN["-" S X1=$P(VRRLN,"-"),X2=$P(VRRLN,"-",2)
"RTN","%ZVEMOE1",11,0)
 F VRRLN=X1:1:X2 S ^%ZVEMS("E","SAVE",$J,CNT)=^TMP("VEE","VRR",$J,VRRS,"TXT",VRRLN),CNT=CNT+1
"RTN","%ZVEMOE1",12,0)
 S ^%ZVEMS("E","SAVE",$J,CNT)="" W "   Save Complete"
"RTN","%ZVEMOE1",13,0)
 Q
"RTN","%ZVEMOE1",14,0)
UNSAVE ;Unsave code
"RTN","%ZVEMOE1",15,0)
 I '$D(^%ZVEMS("E","SAVE",$J)) D  D PAUSE^%ZVEMKC(1) Q
"RTN","%ZVEMOE1",16,0)
 . W $C(7),"   No code saved. Select SA option."
"RTN","%ZVEMOE1",17,0)
 NEW CD,I,II,VRRLN
"RTN","%ZVEMOE1",18,0)
 D BOTTOM^%ZVEMOU
"RTN","%ZVEMOE1",19,0)
UNSAVEA S VRRLN=$$GETLINE^%ZVEMOU("UNSAVE AFTER LINE NUMBER: ") Q:VRRLN="^"
"RTN","%ZVEMOE1",20,0)
 I VRRLN="?"!(VRRLN["INVALID")!(VRRLN["-") D MSG2^%ZVEMOUM(14) G UNSAVEA
"RTN","%ZVEMOE1",21,0)
 F I=1:1 Q:'$D(^%ZVEMS("E","SAVE",$J,I))  Q:^(I)=""  S CD=^(I) D  S FLAGSAVE=1
"RTN","%ZVEMOE1",22,0)
 . S VRRHIGH=VRRHIGH+1
"RTN","%ZVEMOE1",23,0)
 . S $P(^TMP("VEE","VRR",$J,VRRS,"HOT"),"^",1)=VRRHIGH
"RTN","%ZVEMOE1",24,0)
 . F II=VRRHIGH:-1:(VRRLN+2) S ^TMP("VEE","VRR",$J,VRRS,"TXT",II)=^TMP("VEE","VRR",$J,VRRS,"TXT",(II-1))
"RTN","%ZVEMOE1",25,0)
 . S ^TMP("VEE","VRR",$J,VRRS,"TXT",(VRRLN+1))=CD,VRRLN=VRRLN+1
"RTN","%ZVEMOE1",26,0)
 Q
"RTN","%ZVEMOE1",27,0)
LC ;Locate and Change
"RTN","%ZVEMOE1",28,0)
 NEW ADJ,CD,DX,DY,FD,I,NEW,OLD,START,VRRLN,X1,X2
"RTN","%ZVEMOE1",29,0)
 D BOTTOM^%ZVEMOU
"RTN","%ZVEMOE1",30,0)
LCA S VRRLN=$$GETLINE^%ZVEMOU("CHANGE WHICH LINE NUMBER(S): ") Q:VRRLN="^"
"RTN","%ZVEMOE1",31,0)
 I VRRLN="?"!(VRRLN="INVALID") D MSG2^%ZVEMOUM(12) G LCA
"RTN","%ZVEMOE1",32,0)
 I VRRLN="INVALID RNG" D MSGS^%ZVEMOUM(13) G LCA
"RTN","%ZVEMOE1",33,0)
 D BOTTOM^%ZVEMOU S DX=0,DY=0 X VEES("XY")
"RTN","%ZVEMOE1",34,0)
 R "REPLACE: ",OLD:VEE("TIME") Q:OLD=""
"RTN","%ZVEMOE1",35,0)
 R !,"WITH: ",NEW:VEE("TIME")
"RTN","%ZVEMOE1",36,0)
 S (X1,X2)=VRRLN I VRRLN["-" S X1=$P(VRRLN,"-"),X2=$P(VRRLN,"-",2)
"RTN","%ZVEMOE1",37,0)
 F VRRLN=X1:1:X2 D LCRPLC
"RTN","%ZVEMOE1",38,0)
 Q
"RTN","%ZVEMOE1",39,0)
LCRPLC ;Replace OLD with NEW
"RTN","%ZVEMOE1",40,0)
 S CD=$G(^TMP("VEE","VRR",$J,VRRS,"TXT",VRRLN)) I CD'[OLD Q
"RTN","%ZVEMOE1",41,0)
 S START=0,ADJ=$L(NEW)-$L(OLD) ;ADJ will adjust START if NEW is different length than OLD
"RTN","%ZVEMOE1",42,0)
 F I=1:1:($L(CD,OLD)-1) S FD=$F(CD,OLD,START),START=FD+ADJ,CD=$E(CD,1,(FD-$L(OLD)-1))_NEW_$E(CD,FD,999)
"RTN","%ZVEMOE1",43,0)
 I $L(CD,$C(9))'=2!($L(CD)>245) W $C(7) Q  ;No TAB or line too long
"RTN","%ZVEMOE1",44,0)
 I $L($P($P(CD,$C(9)),"("))>8 W $C(7) Q  ;Line Tag too long
"RTN","%ZVEMOE1",45,0)
 I CD']"" Q
"RTN","%ZVEMOE1",46,0)
 S ^TMP("VEE","VRR",$J,VRRS,"TXT",VRRLN)=CD,FLAGSAVE=1
"RTN","%ZVEMOE1",47,0)
 Q
"RTN","%ZVEMOE2")
0^78^B7354249
"RTN","%ZVEMOE2",1,0)
%ZVEMOE2 ;DJB,VRROLD**BREAK,JOIN [12/31/94]
"RTN","%ZVEMOE2",2,0)
 ;;7.0;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMOE2",3,0)
 ;
"RTN","%ZVEMOE2",4,0)
BREAK ;Break a line
"RTN","%ZVEMOE2",5,0)
 NEW BRK,CD,DX,DY,FLAGQ,VRRLN,X1,X2
"RTN","%ZVEMOE2",6,0)
 S FLAGQ=0 D BOTTOM^%ZVEMOU,BRKLINE G:FLAGQ BRKEX D BRKTOP
"RTN","%ZVEMOE2",7,0)
BRKEX ;Exit
"RTN","%ZVEMOE2",8,0)
 Q
"RTN","%ZVEMOE2",9,0)
BRKLINE ;Get line
"RTN","%ZVEMOE2",10,0)
 S VRRLN=$$GETLINE^%ZVEMOU("BREAK WHICH LINE NUMBER: ")
"RTN","%ZVEMOE2",11,0)
 I VRRLN="^" S FLAGQ=1 Q
"RTN","%ZVEMOE2",12,0)
 I VRRLN'?1.N D MSG2^%ZVEMOUM(14) G BRKLINE
"RTN","%ZVEMOE2",13,0)
 S CD=^TMP("VEE","VRR",$J,VRRS,"TXT",VRRLN)
"RTN","%ZVEMOE2",14,0)
 Q
"RTN","%ZVEMOE2",15,0)
BRKTOP ;Process break
"RTN","%ZVEMOE2",16,0)
 D BOTTOM^%ZVEMOU S DX=0,DY=0 X VEES("XY")
"RTN","%ZVEMOE2",17,0)
 W "*",CD
"RTN","%ZVEMOE2",18,0)
BRKTOP1 ;
"RTN","%ZVEMOE2",19,0)
 W !?1,"BREAK AFTER WHAT CODE: "
"RTN","%ZVEMOE2",20,0)
 R BRK:VEE("TIME") S:'$T BRK="^" I "^"[BRK Q
"RTN","%ZVEMOE2",21,0)
 I "??"[BRK D  G BRKTOP1
"RTN","%ZVEMOE2",22,0)
 . W !?1,"The line will be broken AFTER the code you enter"
"RTN","%ZVEMOE2",23,0)
 I CD'[BRK D  G BRKTOP1
"RTN","%ZVEMOE2",24,0)
 . W $C(7),"   No match"
"RTN","%ZVEMOE2",25,0)
 S X1=$E(CD,1,($F(CD,BRK)-1)),X2=$E(CD,$F(CD,BRK),999)
"RTN","%ZVEMOE2",26,0)
 I $L(X1,$C(9))'=2 D  G BRKTOP1
"RTN","%ZVEMOE2",27,0)
 . W $C(7),"   You may not break at a line tag"
"RTN","%ZVEMOE2",28,0)
 I X2']"" W $C(7),"   Invalid entry" G BRKTOP1
"RTN","%ZVEMOE2",29,0)
 F  Q:$E(X1,$L(X1))'=" "  S X1=$E(X1,1,($L(X1)-1))
"RTN","%ZVEMOE2",30,0)
 F  Q:$E(X2)=""!($E(X2)'=" ")  S X2=$E(X2,2,999)
"RTN","%ZVEMOE2",31,0)
 S X2=$C(9)_X2
"RTN","%ZVEMOE2",32,0)
 S ^TMP("VEE","VRR",$J,VRRS,"TXT",VRRLN)=X1
"RTN","%ZVEMOE2",33,0)
 S VRRHIGH=VRRHIGH+1
"RTN","%ZVEMOE2",34,0)
 S $P(^TMP("VEE","VRR",$J,VRRS,"HOT"),"^",1)=VRRHIGH
"RTN","%ZVEMOE2",35,0)
 F I=VRRHIGH:-1:(VRRLN+2) S ^TMP("VEE","VRR",$J,VRRS,"TXT",I)=^TMP("VEE","VRR",$J,VRRS,"TXT",(I-1))
"RTN","%ZVEMOE2",36,0)
 S ^TMP("VEE","VRR",$J,VRRS,"TXT",(VRRLN+1))=X2,VRRLN=VRRLN+1,FLAGSAVE=1
"RTN","%ZVEMOE2",37,0)
 Q
"RTN","%ZVEMOE2",38,0)
JOIN ;Join 2 lines
"RTN","%ZVEMOE2",39,0)
 NEW I,LN1,LN1CD,LN2,LN2CD
"RTN","%ZVEMOE2",40,0)
 D BOTTOM^%ZVEMOU
"RTN","%ZVEMOE2",41,0)
JOINA S LN1=$$GETLINE^%ZVEMOU("1ST LINE NUMBER: ") Q:LN1="^"
"RTN","%ZVEMOE2",42,0)
 I LN1'?1.N D MSG2^%ZVEMOUM(14) G JOINA
"RTN","%ZVEMOE2",43,0)
JOIN1 D BOTTOM1^%ZVEMOU
"RTN","%ZVEMOE2",44,0)
 S LN2=$$GETLINE^%ZVEMOU("2ND LINE NUMBER: ") Q:LN2="^"
"RTN","%ZVEMOE2",45,0)
 I LN2'?1.N D MSGS^%ZVEMOUM(14,1) G JOIN1
"RTN","%ZVEMOE2",46,0)
 I LN1=LN2 D MSGS^%ZVEMOUM(18,1) G JOIN1
"RTN","%ZVEMOE2",47,0)
 S LN1CD=^TMP("VEE","VRR",$J,VRRS,"TXT",LN1)
"RTN","%ZVEMOE2",48,0)
 S LN2CD=$P(^TMP("VEE","VRR",$J,VRRS,"TXT",LN2),$C(9),2,999) ;Strip off any line tag
"RTN","%ZVEMOE2",49,0)
 I ($L(LN1CD)+$L(LN2CD))>245 D MSGS^%ZVEMOUM(19,1) G JOIN1
"RTN","%ZVEMOE2",50,0)
 S ^TMP("VEE","VRR",$J,VRRS,"TXT",LN1)=LN1CD_" "_LN2CD ;Insert a space
"RTN","%ZVEMOE2",51,0)
 ;Delete 2nd line
"RTN","%ZVEMOE2",52,0)
 F I=LN2:1:(VRRHIGH-1) S ^TMP("VEE","VRR",$J,VRRS,"TXT",I)=^TMP("VEE","VRR",$J,VRRS,"TXT",(I+1))
"RTN","%ZVEMOE2",53,0)
 KILL ^TMP("VEE","VRR",$J,VRRS,"TXT",VRRHIGH)
"RTN","%ZVEMOE2",54,0)
 S VRRHIGH=VRRHIGH-1,FLAGSAVE=1
"RTN","%ZVEMOE2",55,0)
 S $P(^TMP("VEE","VRR",$J,VRRS,"HOT"),"^",1)=VRRHIGH
"RTN","%ZVEMOE2",56,0)
 Q
"RTN","%ZVEMOEA")
0^79^B14759941
"RTN","%ZVEMOEA",1,0)
%ZVEMOEA ;DJB,VRROLD**CHANGE - READ,HELP ; 12/15/00 8:31pm
"RTN","%ZVEMOEA",2,0)
 ;;7.0;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMOEA",3,0)
 ;
"RTN","%ZVEMOEA",4,0)
 NEW CDHLD,FLAGQ,START,TAB1,TAB2,TEMP,TOP,VK,WIDTH,X,VEES
"RTN","%ZVEMOEA",5,0)
 NEW XCHAR,XCUR,YCNT,YCNTHLD,YCUR
"RTN","%ZVEMOEA",6,0)
 S FLAGQ=0 D INIT Q:FLAGQ
"RTN","%ZVEMOEA",7,0)
 X VEES("RM0")
"RTN","%ZVEMOEA",8,0)
 D BOTTOM^%ZVEMOU,PRINTA^%ZVEMOEP
"RTN","%ZVEMOEA",9,0)
 S CDHLD=CD ;Save original code. Restore old tag if new is illegal
"RTN","%ZVEMOEA",10,0)
 F  D READ Q:FLAGQ
"RTN","%ZVEMOEA",11,0)
EX ;
"RTN","%ZVEMOEA",12,0)
 I YCUR<YCNT F I=1:1:(YCNT-YCUR) W ! ;Reposition cursor to bottom line
"RTN","%ZVEMOEA",13,0)
 I $$TAGCHK^%ZVEMOEU(CD) D DELTAG
"RTN","%ZVEMOEA",14,0)
 I $$LINECHK^%ZVEMOEU(CD) D DELLINE 
"RTN","%ZVEMOEA",15,0)
 X VEES("RM80")
"RTN","%ZVEMOEA",16,0)
 Q
"RTN","%ZVEMOEA",17,0)
READ ;
"RTN","%ZVEMOEA",18,0)
 S X=$$READ^%ZVEMKR("",1),VK=$G(VEE("K"))
"RTN","%ZVEMOEA",19,0)
 I VK="<RET>"!(VK="<ESC>") S FLAGQ=1 Q
"RTN","%ZVEMOEA",20,0)
 I +TAB1>0,",<F1>,<F2>,<F3>,<F4>,<AU>,<AD>,<AL>,<AR>,<ESCD>,<ESCT>,"'[(","_VK_",") S (TAB1,TAB2)=0 D PRINTA^%ZVEMOEP Q  ;Clear Bulk Delete
"RTN","%ZVEMOEA",21,0)
 I VK="<ESCT>" D BULKDEL^%ZVEMOEB Q
"RTN","%ZVEMOEA",22,0)
 I VK="<ESCD>" D BULKDEL1^%ZVEMOEB Q
"RTN","%ZVEMOEA",23,0)
 I VK="<ESCH>" D HELP,PRINTA^%ZVEMOEP Q
"RTN","%ZVEMOEA",24,0)
 I ",<AR>,<AL>,<AU>,<AD>,"[(","_VK_",") D ARROW^%ZVEMOEB,CLRSCRN1^%ZVEMOEU Q
"RTN","%ZVEMOEA",25,0)
 I VK?1"<F".E1">" D OTHER^%ZVEMOEB,CLRSCRN1^%ZVEMOEU Q
"RTN","%ZVEMOEA",26,0)
 I ",<BS>,<DEL>,"[(","_VK_",") D  D DELETE^%ZVEMOEB Q
"RTN","%ZVEMOEA",27,0)
 . S:$G(VEE("BS"))="SAME" VK="<BS>"
"RTN","%ZVEMOEA",28,0)
 I VK?1"<".E1">".E Q
"RTN","%ZVEMOEA",29,0)
 D INSERT^%ZVEMOEB
"RTN","%ZVEMOEA",30,0)
 Q
"RTN","%ZVEMOEA",31,0)
DELLINE ;Delete line if all the code has been deleted out.
"RTN","%ZVEMOEA",32,0)
 F I=VRRLN:1:(VRRHIGH-1) S ^TMP("VEE","VRR",$J,VRRS,"TXT",I)=^TMP("VEE","VRR",$J,VRRS,"TXT",(I+1))
"RTN","%ZVEMOEA",33,0)
 KILL ^TMP("VEE","VRR",$J,VRRS,"TXT",VRRHIGH) S VRRHIGH=VRRHIGH-1
"RTN","%ZVEMOEA",34,0)
 Q
"RTN","%ZVEMOEA",35,0)
DELTAG ;Delete invalid TAG
"RTN","%ZVEMOEA",36,0)
 S $P(CD,$C(9),1)=$P(CDHLD,$C(9),1)
"RTN","%ZVEMOEA",37,0)
 S ^TMP("VEE","VRR",$J,VRRS,"TXT",VRRLN)=CD
"RTN","%ZVEMOEA",38,0)
 Q
"RTN","%ZVEMOEA",39,0)
HELP ;
"RTN","%ZVEMOEA",40,0)
 S DX=0,DY=TOP X VEES("CRSR") W @VEES("BLANK_TOS_C")
"RTN","%ZVEMOEA",41,0)
 S DY=0 X VEES("CRSR")
"RTN","%ZVEMOEA",42,0)
 W !?1,@VEE("RON"),"QUIT",@VEE("ROFF")
"RTN","%ZVEMOEA",43,0)
 S DX=0,DY=$Y X VEES("XY")
"RTN","%ZVEMOEA",44,0)
 W " Press <RETURN> to quit EDIT session and return  to the routine."
"RTN","%ZVEMOEA",45,0)
 W !!?1,@VEE("RON"),"INSERT/DELETE",@VEE("ROFF")
"RTN","%ZVEMOEA",46,0)
 S DX=0,DY=$Y X VEES("XY")
"RTN","%ZVEMOEA",47,0)
 W " Type any character to insert that character to the left of the"
"RTN","%ZVEMOEA",48,0)
 W !?1,"cursor. <BACKSPACE>/<DELETE> deletes the character to the left of the cursor."
"RTN","%ZVEMOEA",49,0)
 W !!?1,@VEE("RON"),"ARROW KEYS",@VEE("ROFF")
"RTN","%ZVEMOEA",50,0)
 S DX=0,DY=$Y X VEES("XY")
"RTN","%ZVEMOEA",51,0)
 W " Use the <ARROW> keys to position the curser. To edit the TAG, use"
"RTN","%ZVEMOEA",52,0)
 W !?1,"<UP ARROW> to move cursor to the TAG area, then make desired changes."
"RTN","%ZVEMOEA",53,0)
 W !!?1,@VEE("RON"),"PF KEYS",@VEE("ROFF")
"RTN","%ZVEMOEA",54,0)
 S DX=0,DY=$Y X VEES("XY")
"RTN","%ZVEMOEA",55,0)
 W " Use F/PF keys to rapidly position the cursor when Inserting & Deleting."
"RTN","%ZVEMOEA",56,0)
 W !?3,"<F1><AL> = Cursor to line begin      <F1><AR> = Cursor to line end"
"RTN","%ZVEMOEA",57,0)
 W !?3,"<F2><AL> = Cursor left 15 spaces     <F2><AR> = Cursor right 15 spaces"
"RTN","%ZVEMOEA",58,0)
 W !!?1,@VEE("RON"),"BULK DELETE",@VEE("ROFF")
"RTN","%ZVEMOEA",59,0)
 S DX=0,DY=$Y X VEES("XY")
"RTN","%ZVEMOEA",60,0)
 W " Position cursor and press <ESC>T. Reposition cursor and press"
"RTN","%ZVEMOEA",61,0)
 W !?1,"<ESC>T again. Press <ESC>D to delete from the 1st highlighted character to"
"RTN","%ZVEMOEA",62,0)
 W !?1,"the 2nd, or press any alpha key to terminate the delete."
"RTN","%ZVEMOEA",63,0)
 Q
"RTN","%ZVEMOEA",64,0)
INIT ;
"RTN","%ZVEMOEA",65,0)
 D:'$D(VEE("OS")) OS^%ZVEMKY Q:FLAGQ
"RTN","%ZVEMOEA",66,0)
 D SCRNVAR^%ZVEMKY2,CRSRMOVE^%ZVEMKY2,BLANK^%ZVEMKY3
"RTN","%ZVEMOEA",67,0)
 S (TAB1,TAB2)=0,(XCHAR,YCUR)=1,(START,XCUR)=9,WIDTH=69
"RTN","%ZVEMOEA",68,0)
 S CODELN=$P(CD,$C(9),2,999)
"RTN","%ZVEMOEA",69,0)
 F YCNTHLD=1:1 Q:$L(CODELN)'>(WIDTH*YCNTHLD)  ;If YCNT becomes greater than YCNTHLD, then handle the scrolling.
"RTN","%ZVEMOEA",70,0)
 S TOP=19 I YCNTHLD>2 S TOP=TOP-(YCNTHLD-2)
"RTN","%ZVEMOEA",71,0)
 Q
"RTN","%ZVEMOEB")
0^80^B12992560
"RTN","%ZVEMOEB",1,0)
%ZVEMOEB ;DJB,VRROLD**CHANGE - INSERT,DELETE,ARROW,OTHER [02/17/95]
"RTN","%ZVEMOEB",2,0)
 ;;7.0;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMOEB",3,0)
 ;
"RTN","%ZVEMOEB",4,0)
INSERT ;Insert a character
"RTN","%ZVEMOEB",5,0)
 I $L(CD)>244 S FLAGQ=1 Q
"RTN","%ZVEMOEB",6,0)
 ;---Tag---
"RTN","%ZVEMOEB",7,0)
 I YCUR=0 D  S XCHAR=XCHAR+1,XCUR=XCUR+1 D SAVE^%ZVEMOEU,PRINTT^%ZVEMOEP Q
"RTN","%ZVEMOEB",8,0)
 . I XCHAR=1 S CD=X_CODETG_$C(9)_CODELN Q
"RTN","%ZVEMOEB",9,0)
 . S CD=$E(CODETG,1,XCHAR-1)_X_$E(CODETG,XCHAR,999)_$C(9)_CODELN
"RTN","%ZVEMOEB",10,0)
 . Q
"RTN","%ZVEMOEB",11,0)
 ;---Line---
"RTN","%ZVEMOEB",12,0)
 I XCHAR=1 S CD=CODETG_$C(9)_X_CODELN
"RTN","%ZVEMOEB",13,0)
 E  S CD=CODETG_$C(9)_$E(CODELN,1,XCHAR-1)_X_$E(CODELN,XCHAR,999)
"RTN","%ZVEMOEB",14,0)
 I XCHAR#WIDTH=0 S XCUR=START,YCUR=YCUR+1
"RTN","%ZVEMOEB",15,0)
 E  S XCUR=XCUR+1
"RTN","%ZVEMOEB",16,0)
 S XCHAR=XCHAR+1 D SAVE^%ZVEMOEU,PRINTL^%ZVEMOEP
"RTN","%ZVEMOEB",17,0)
 Q
"RTN","%ZVEMOEB",18,0)
DELETE ;Delete a character
"RTN","%ZVEMOEB",19,0)
 ;---<DEL> key struck---
"RTN","%ZVEMOEB",20,0)
 I VK="<DEL>" D  Q
"RTN","%ZVEMOEB",21,0)
 . ;Edit tag
"RTN","%ZVEMOEB",22,0)
 . I YCUR=0 D   D SAVE^%ZVEMOEU,PRINTT^%ZVEMOEP Q
"RTN","%ZVEMOEB",23,0)
 . . S CD=$E(CODETG,1,XCHAR-1)_$E(CODETG,XCHAR+1,999)_$C(9)_CODELN
"RTN","%ZVEMOEB",24,0)
 . ;Edit line
"RTN","%ZVEMOEB",25,0)
 . S CD=CODETG_$C(9)_$E(CODELN,1,XCHAR-1)_$E(CODELN,XCHAR+1,999)
"RTN","%ZVEMOEB",26,0)
 . D SAVE^%ZVEMOEU,PRINTL^%ZVEMOEP
"RTN","%ZVEMOEB",27,0)
 . Q
"RTN","%ZVEMOEB",28,0)
 ;---<BS> key struck---
"RTN","%ZVEMOEB",29,0)
 Q:XCHAR'>1
"RTN","%ZVEMOEB",30,0)
 ;Edit tag
"RTN","%ZVEMOEB",31,0)
 I YCUR=0 D  D SAVE^%ZVEMOEU,PRINTT^%ZVEMOEP Q
"RTN","%ZVEMOEB",32,0)
 . S XCUR=XCUR-1,XCHAR=XCHAR-1
"RTN","%ZVEMOEB",33,0)
 . S CD=$E(CODETG,1,XCHAR-1)_$E(CODETG,XCHAR+1,999)_$C(9)_CODELN
"RTN","%ZVEMOEB",34,0)
 ;Edit line
"RTN","%ZVEMOEB",35,0)
 I XCHAR=2 D  D SAVE^%ZVEMOEU,PRINTL^%ZVEMOEP Q
"RTN","%ZVEMOEB",36,0)
 . S XCUR=XCUR-1,XCHAR=XCHAR-1
"RTN","%ZVEMOEB",37,0)
 . S CD=CODETG_$C(9)_$E(CODELN,2,999) D SAVE^%ZVEMOEU,PRINTL^%ZVEMOEP
"RTN","%ZVEMOEB",38,0)
 I XCUR=START,YCUR>1 S XCUR=WIDTH+START-1,YCUR=YCUR-1
"RTN","%ZVEMOEB",39,0)
 E  S XCUR=XCUR-1
"RTN","%ZVEMOEB",40,0)
 S XCHAR=XCHAR-1
"RTN","%ZVEMOEB",41,0)
 S CD=CODETG_$C(9)_$E(CODELN,1,XCHAR-1)_$E(CODELN,XCHAR+1,999)
"RTN","%ZVEMOEB",42,0)
 D SAVE^%ZVEMOEU,PRINTL^%ZVEMOEP
"RTN","%ZVEMOEB",43,0)
 Q
"RTN","%ZVEMOEB",44,0)
BULKDEL ;Delete a range of characters.
"RTN","%ZVEMOEB",45,0)
 Q:YCUR=0  NEW TEMP
"RTN","%ZVEMOEB",46,0)
 I TAB1>0,TAB2>0 S (TAB1,TAB2)=0 D PRINTA^%ZVEMOEP Q
"RTN","%ZVEMOEB",47,0)
 I TAB1'>0 D  Q
"RTN","%ZVEMOEB",48,0)
 . W @VEE("RON"),$S(XCHAR'>$L(CODELN):$E(CODELN,XCHAR),1:" ")
"RTN","%ZVEMOEB",49,0)
 . W @VEE("ROFF"),$C(8) S TAB1=XCHAR_","_YCUR
"RTN","%ZVEMOEB",50,0)
 W @VEE("RON"),$S(XCHAR'>$L(CODELN):$E(CODELN,XCHAR),1:" ")
"RTN","%ZVEMOEB",51,0)
 W @VEE("ROFF"),$C(8) S TAB2=XCHAR_","_YCUR
"RTN","%ZVEMOEB",52,0)
 I +TAB1>+TAB2 S TEMP=TAB1,TAB1=TAB2,TAB2=TEMP
"RTN","%ZVEMOEB",53,0)
 Q
"RTN","%ZVEMOEB",54,0)
BULKDEL1 ;Make the deletion.
"RTN","%ZVEMOEB",55,0)
 Q:YCUR=0  I TAB1'>0!(TAB2'>0) Q
"RTN","%ZVEMOEB",56,0)
 S CD=CODETG_$C(9)_$E(CODELN,1,+TAB1-1)_$E(CODELN,+TAB2+1,999)
"RTN","%ZVEMOEB",57,0)
 S XCHAR=+TAB1,XCUR=XCHAR#WIDTH+(START-1)
"RTN","%ZVEMOEB",58,0)
 S YCUR=$P(TAB1,",",2),(TAB1,TAB2)=0
"RTN","%ZVEMOEB",59,0)
 D SAVE^%ZVEMOEU,PRINTL^%ZVEMOEP
"RTN","%ZVEMOEB",60,0)
 Q
"RTN","%ZVEMOEB",61,0)
ARROW ;Process arrow keys
"RTN","%ZVEMOEB",62,0)
 D @$E(VK,2,$L(VK)-1)
"RTN","%ZVEMOEB",63,0)
 Q
"RTN","%ZVEMOEB",64,0)
AR ;Arrow Right
"RTN","%ZVEMOEB",65,0)
 I YCUR=0,XCHAR'<($L(CODETG)+1) Q
"RTN","%ZVEMOEB",66,0)
 I YCUR>0,XCHAR'<($L(CODELN)+1) Q
"RTN","%ZVEMOEB",67,0)
 I XCHAR#WIDTH=0 S XCUR=START,YCUR=YCUR+1,XCHAR=XCHAR+1 Q
"RTN","%ZVEMOEB",68,0)
 S XCUR=XCUR+1,XCHAR=XCHAR+1
"RTN","%ZVEMOEB",69,0)
 Q
"RTN","%ZVEMOEB",70,0)
AL ;Arrow Left
"RTN","%ZVEMOEB",71,0)
 I XCUR>START S XCUR=XCUR-1,XCHAR=XCHAR-1 Q
"RTN","%ZVEMOEB",72,0)
 I XCUR=START,YCUR>1 S XCUR=WIDTH+START-1,YCUR=YCUR-1,XCHAR=XCHAR-1 Q
"RTN","%ZVEMOEB",73,0)
 Q
"RTN","%ZVEMOEB",74,0)
AU ;Arrow Up
"RTN","%ZVEMOEB",75,0)
 I YCUR=1 S YCUR=0 D  Q
"RTN","%ZVEMOEB",76,0)
 . I XCHAR>($L(CODETG)+1) F  Q:XCHAR=1!(XCHAR=($L(CODETG)+1))  S XCHAR=XCHAR-1,XCUR=XCUR-1
"RTN","%ZVEMOEB",77,0)
 I YCUR>1 S YCUR=YCUR-1,XCHAR=XCHAR-WIDTH
"RTN","%ZVEMOEB",78,0)
 Q
"RTN","%ZVEMOEB",79,0)
AD ;Arrow Down
"RTN","%ZVEMOEB",80,0)
 I YCUR=0 S YCUR=1 Q
"RTN","%ZVEMOEB",81,0)
 I YCUR<YCNT S YCUR=YCUR+1,XCHAR=XCHAR+WIDTH
"RTN","%ZVEMOEB",82,0)
 I XCHAR>($L(CODELN)+1) F  Q:XCHAR=1!(XCHAR=($L(CODELN)+1))  S XCHAR=XCHAR-1,XCUR=XCUR-1
"RTN","%ZVEMOEB",83,0)
 Q
"RTN","%ZVEMOEB",84,0)
OTHER ;<F1AL>,<F1AR>,<F2AL>,<F2AR>
"RTN","%ZVEMOEB",85,0)
 I VK="<F2AL>",XCUR>23 S XCUR=XCUR-15,XCHAR=XCHAR-15 Q
"RTN","%ZVEMOEB",86,0)
 I VK="<F2AR>",XCUR<(WIDTH+START-15),($L(CODELN)-XCHAR)>14 D  Q
"RTN","%ZVEMOEB",87,0)
 . S XCUR=XCUR+15,XCHAR=XCHAR+15
"RTN","%ZVEMOEB",88,0)
 I VK="<F1AL>" S XCUR=START,XCHAR=1,YCUR=1 Q
"RTN","%ZVEMOEB",89,0)
 I VK="<F1AR>" D  Q
"RTN","%ZVEMOEB",90,0)
 . S XCHAR=$L(CODELN)+1
"RTN","%ZVEMOEB",91,0)
 . S XCUR=$S(XCHAR#WIDTH=0:WIDTH+START-1,1:XCHAR#WIDTH+(START-1))
"RTN","%ZVEMOEB",92,0)
 . S YCUR=$S((XCHAR-1)#WIDTH=0:YCNT+1,1:YCNT)
"RTN","%ZVEMOEB",93,0)
 Q
"RTN","%ZVEMOEP")
0^81^B6447347
"RTN","%ZVEMOEP",1,0)
%ZVEMOEP ;DJB,VRROLD**CHANGE - Print [12/31/94]
"RTN","%ZVEMOEP",2,0)
 ;;7.0;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMOEP",3,0)
 ;
"RTN","%ZVEMOEP",4,0)
PRINTA ;Print All - Heading,Tag,Line
"RTN","%ZVEMOEP",5,0)
 S CODETG=$P(CD,$C(9)),(CODELN,TEMP)=$P(CD,$C(9),2,999)
"RTN","%ZVEMOEP",6,0)
 F YCNT=1:1 Q:$L(CODELN)<(YCNT*WIDTH+1)
"RTN","%ZVEMOEP",7,0)
 D CLRSCRN^%ZVEMOEU
"RTN","%ZVEMOEP",8,0)
 S DX=14 X VEES("CRSR")
"RTN","%ZVEMOEP",9,0)
 W @VEE("RON") X VEES("XY") W "LINE:",$J(VRRLN,3),@VEE("ROFF")
"RTN","%ZVEMOEP",10,0)
 S DX=27 X VEES("CRSR")
"RTN","%ZVEMOEP",11,0)
 W @VEE("RON") X VEES("XY") W "LENGTH:",$J($L(CD),4),@VEE("ROFF")
"RTN","%ZVEMOEP",12,0)
 S DX=43 X VEES("CRSR")
"RTN","%ZVEMOEP",13,0)
 W @VEE("RON") X VEES("XY") W "<ESC>H=Help",@VEE("ROFF")
"RTN","%ZVEMOEP",14,0)
 S DX=58 X VEES("CRSR")
"RTN","%ZVEMOEP",15,0)
 W @VEE("RON") X VEES("XY") W "<RET>=Quit",@VEE("ROFF")
"RTN","%ZVEMOEP",16,0)
 S DX=0,DY=DY+1 X VEES("CRSR")
"RTN","%ZVEMOEP",17,0)
 W @VEE("RON") X VEES("XY") W "  TAG-->" S DX=$X W @VEE("ROFF") X VEES("XY")
"RTN","%ZVEMOEP",18,0)
 W " ",CODETG
"RTN","%ZVEMOEP",19,0)
 S DX=0,DY=DY+1 X VEES("CRSR")
"RTN","%ZVEMOEP",20,0)
 W @VEE("RON") X VEES("XY") W " LINE-->" S DX=$X W @VEE("ROFF") X VEES("XY")
"RTN","%ZVEMOEP",21,0)
 W " ",$E(CODELN,1,WIDTH) S TEMP=$E(CODELN,WIDTH+1,999)
"RTN","%ZVEMOEP",22,0)
PRINTA1 ;Print remainder of line
"RTN","%ZVEMOEP",23,0)
 I TEMP="" D CLRSCRN1^%ZVEMOEU Q
"RTN","%ZVEMOEP",24,0)
 W !?9,$E(TEMP,1,WIDTH) S TEMP=$E(TEMP,WIDTH+1,999)
"RTN","%ZVEMOEP",25,0)
 G PRINTA1
"RTN","%ZVEMOEP",26,0)
PRINTL ;Print Line
"RTN","%ZVEMOEP",27,0)
 S CODETG=$P(CD,$C(9)),CODELN=$P(CD,$C(9),2,999)
"RTN","%ZVEMOEP",28,0)
 S TEMP=$E(CODELN,XCHAR,999)
"RTN","%ZVEMOEP",29,0)
 F YCNT=1:1 Q:$L(CODELN)<(YCNT*WIDTH+1)
"RTN","%ZVEMOEP",30,0)
 I YCNT>YCNTHLD S TOP=TOP-1,YCNTHLD=YCNTHLD+1 D PRINTA Q  ;When lines scroll up.
"RTN","%ZVEMOEP",31,0)
 S DX=34,DY=TOP X VEES("CRSR")
"RTN","%ZVEMOEP",32,0)
 W @VEE("RON") X VEES("XY") W $J($L(CD),4),@VEE("ROFF")
"RTN","%ZVEMOEP",33,0)
 I XCUR>START S DX=XCUR,DY=TOP+1+YCUR X VEES("CRSR") W @VEES("BLANK_C_EOS")
"RTN","%ZVEMOEP",34,0)
 I XCUR=START,YCUR=1 S DX=XCUR,DY=TOP+1+YCUR X VEES("CRSR") W @VEES("BLANK_C_EOS")
"RTN","%ZVEMOEP",35,0)
 I XCUR=START,YCUR>1 S DX=WIDTH+START,DY=TOP+1+YCUR-1 X VEES("CRSR") W @VEES("BLANK_C_EOS") S DX=XCUR,DY=TOP+1+YCUR
"RTN","%ZVEMOEP",36,0)
 X VEES("CRSR")
"RTN","%ZVEMOEP",37,0)
 W $E(TEMP,1,WIDTH+START-XCUR) S TEMP=$E(TEMP,WIDTH+START+1-XCUR,999)
"RTN","%ZVEMOEP",38,0)
PRINTL1 ;Print remainder of line
"RTN","%ZVEMOEP",39,0)
 I TEMP="" X VEES("CRSR") Q
"RTN","%ZVEMOEP",40,0)
 W !?START,$E(TEMP,1,WIDTH) S TEMP=$E(TEMP,WIDTH+1,999)
"RTN","%ZVEMOEP",41,0)
 G PRINTL1
"RTN","%ZVEMOEP",42,0)
 Q
"RTN","%ZVEMOEP",43,0)
PRINTT ;Print Tag
"RTN","%ZVEMOEP",44,0)
 S CODETG=$P(CD,$C(9)),CODELN=$P(CD,$C(9),2,999)
"RTN","%ZVEMOEP",45,0)
 S DX=34,DY=TOP X VEES("CRSR") W @VEE("RON"),$J($L(CD),4),@VEE("ROFF")
"RTN","%ZVEMOEP",46,0)
 S DX=XCUR,DY=TOP+1 X VEES("CRSR") W @VEES("BLANK_C_EOL") X VEES("XY")
"RTN","%ZVEMOEP",47,0)
 W $E(CODETG,XCHAR,999)
"RTN","%ZVEMOEP",48,0)
 S DX=XCUR,DY=TOP+1 X VEES("CRSR")
"RTN","%ZVEMOEP",49,0)
 Q
"RTN","%ZVEMOEU")
0^82^B2466878
"RTN","%ZVEMOEU",1,0)
%ZVEMOEU ;DJB,VRROLD**CHANGE - Utilities [12/31/94]
"RTN","%ZVEMOEU",2,0)
 ;;7.0;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMOEU",3,0)
 ;
"RTN","%ZVEMOEU",4,0)
LINECHK(CODE) ;Check Line. 1=Line bad,2=Line null
"RTN","%ZVEMOEU",5,0)
 I $G(CODE)']"" Q 0
"RTN","%ZVEMOEU",6,0)
 NEW LINE
"RTN","%ZVEMOEU",7,0)
 S LINE=$P(CODE,$C(9),2,999)
"RTN","%ZVEMOEU",8,0)
 I $L(CODE,$C(9))'>1 D MSG2^%ZVEMOUM(10,1) Q 1
"RTN","%ZVEMOEU",9,0)
 I LINE="" Q 2
"RTN","%ZVEMOEU",10,0)
 I $L(CODE)>244 D MSG2^%ZVEMOUM(11,1)
"RTN","%ZVEMOEU",11,0)
 Q 0
"RTN","%ZVEMOEU",12,0)
TAGCHK(CODE) ;Check Tag. 1=Tag bad
"RTN","%ZVEMOEU",13,0)
 I $G(CODE)']"" Q 0
"RTN","%ZVEMOEU",14,0)
 NEW TAG,TAG1,TAG2,TEST
"RTN","%ZVEMOEU",15,0)
 S TAG=$P(CODE,$C(9),1),TAG1=$P(TAG,"(")
"RTN","%ZVEMOEU",16,0)
 I TAG']"" Q 0
"RTN","%ZVEMOEU",17,0)
 I $L(TAG1)>8 D MSG2^%ZVEMOUM(8,1) Q 1
"RTN","%ZVEMOEU",18,0)
 I $E(TAG1)'?1AN,$E(TAG1)'="%" D MSG2^%ZVEMOUM(8,1) Q 1
"RTN","%ZVEMOEU",19,0)
 I $L(TAG1)>1,$E(TAG1)'?1N,$E(TAG1,2,999)'?1.AN D MSG2^%ZVEMOUM(8,1) Q 1
"RTN","%ZVEMOEU",20,0)
 I $E(TAG1)?1N,TAG1'?1.N D MSG2^%ZVEMOUM(8,1) Q 1
"RTN","%ZVEMOEU",21,0)
 I TAG'?.E1"(".E Q 0
"RTN","%ZVEMOEU",22,0)
 I $E(TAG,$L(TAG))'=")" D MSG2^%ZVEMOUM(9,1) Q 1
"RTN","%ZVEMOEU",23,0)
 S TAG2=$P(TAG,"(",2,99),TAG2=$E(TAG2,1,$L(TAG2)-1) I TAG2="" Q 0
"RTN","%ZVEMOEU",24,0)
 S TEST=0 F I=1:1:$L(TAG2,",") I $P(TAG2,",",I)'?1A.AN&($P(TAG2,",",I)'?1"%".AN) S TEST=1 Q
"RTN","%ZVEMOEU",25,0)
 I TEST D MSG2^%ZVEMOUM(9,1) Q 1
"RTN","%ZVEMOEU",26,0)
 Q 0
"RTN","%ZVEMOEU",27,0)
SAVE ;Save changes
"RTN","%ZVEMOEU",28,0)
 S ^TMP("VEE","VRR",$J,VRRS,"TXT",VRRLN)=CD,FLAGSAVE=1
"RTN","%ZVEMOEU",29,0)
 Q
"RTN","%ZVEMOEU",30,0)
CLRSCRN ;Clear the editing portion of the screen
"RTN","%ZVEMOEU",31,0)
 S DX=0,DY=TOP X VEES("CRSR")
"RTN","%ZVEMOEU",32,0)
 W @VEES("BLANK_C_EOS") X VEES("XY")
"RTN","%ZVEMOEU",33,0)
 W VRRLINE X VEES("CRSR")
"RTN","%ZVEMOEU",34,0)
 Q
"RTN","%ZVEMOEU",35,0)
CLRSCRN1 ;
"RTN","%ZVEMOEU",36,0)
 S DX=XCUR,DY=(TOP+YCUR+1) X VEES("CRSR")
"RTN","%ZVEMOEU",37,0)
 Q
"RTN","%ZVEMOM")
0^83^B16386258
"RTN","%ZVEMOM",1,0)
%ZVEMOM ;DJB,VRROLD**Main Menu ; 12/15/00 8:31pm
"RTN","%ZVEMOM",2,0)
 ;;7.0;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMOM",3,0)
 ;
"RTN","%ZVEMOM",4,0)
PAGE ;Prepare bottom of screen
"RTN","%ZVEMOM",5,0)
 NEW VK
"RTN","%ZVEMOM",6,0)
 S FLAGTAG=0
"RTN","%ZVEMOM",7,0)
 I FLAGCOL,VRRS>FLAGCOL S FLAGQ=1 G EX ;Collapse
"RTN","%ZVEMOM",8,0)
 F I=$Y:1:VEESIZE W ! I $G(FLAGBLNK),I=9,$D(^TMP("VEE","VRR",$J,VRRS,"TXT")) D
"RTN","%ZVEMOM",9,0)
 . W ?13,"T=Top   U=UpPg   <AU>=LnUp   G=Goto   <RETURN>=Quit"
"RTN","%ZVEMOM",10,0)
 W !,$E(VRRLINE,1,VEE("IOM"))
"RTN","%ZVEMOM",11,0)
 S:$G(VRRCRSR)="PGTOP" VRRCRSR=PGTOP
"RTN","%ZVEMOM",12,0)
 S:$G(VRRCRSR)="BOTTOM" VRRCRSR=LNUM
"RTN","%ZVEMOM",13,0)
 S:$G(VRRCRSR)']"" VRRCRSR=LNUM
"RTN","%ZVEMOM",14,0)
 D INIT^%ZVEMOM2 ;Used to locate cursor
"RTN","%ZVEMOM",15,0)
 ;
"RTN","%ZVEMOM",16,0)
PAGE1 ;Position highlight and display line menu.
"RTN","%ZVEMOM",17,0)
 D:'FLAGBLNK NEWHIGH^%ZVEMOM2
"RTN","%ZVEMOM",18,0)
 D BOTTOM^%ZVEMOU
"RTN","%ZVEMOM",19,0)
 W ?1,"^,"" ""=Quit  N=Navigate  BR=Branch  M=More  ?=Help"
"RTN","%ZVEMOM",20,0)
 I $G(FLAGVPE)["EDIT" D
"RTN","%ZVEMOM",21,0)
 . W $S(VRRS=1&($G(FLAGHOT)'="YES"):"  ED=Edit",1:"  SA=Save")
"RTN","%ZVEMOM",22,0)
 I $G(FLAGDEL)]"" W ?69,"[",FLAGDEL,$S(FLAGDEL?.E1"-":" ",1:""),"]"
"RTN","%ZVEMOM",23,0)
 W !?1,"Select: "
"RTN","%ZVEMOM",24,0)
PAGE2 ;Get users response
"RTN","%ZVEMOM",25,0)
 S VRRACT=$$READ^%ZVEMKR(),VK=$G(VEE("K"))
"RTN","%ZVEMOM",26,0)
 I ",^, ,"[(","_VRRACT_",") S VRRACT="^" S FLAGQ=1 G EX
"RTN","%ZVEMOM",27,0)
 I ",<TO>,<ESC>,"[(","_VK_",") S FLAGQ=1 G EX
"RTN","%ZVEMOM",28,0)
 S VRRACT=$$ALLCAPS^%ZVEMKU(VRRACT)
"RTN","%ZVEMOM",29,0)
TAB I VK="<TAB>" S VRRACT=$G(VRRCRSR)
"RTN","%ZVEMOM",30,0)
PGKEYS I VK?1"<PG"2U1">" D PGKEYS^%ZVEMOM2 G PAGE2
"RTN","%ZVEMOM",31,0)
ARROW I VK?1"<A"1U1">" NEW CHK S CHK=0 D  Q:FLAGQ  G:CHK PAGE2 G PAGE1
"RTN","%ZVEMOM",32,0)
 . D ARROW^%ZVEMOM2 D:FLAGQ RESET
"RTN","%ZVEMOM",33,0)
 I VK="<RET>" KILL VRRCRSR D  G EX
"RTN","%ZVEMOM",34,0)
 . I FLAGL S FLAGQ=1 Q
"RTN","%ZVEMOM",35,0)
 . S PGTOP=LNUM+1 D FF^%ZVEMOU
"RTN","%ZVEMOM",36,0)
NUMBER I VRRACT?1.N,+VRRACT=VRRACT,VRRACT>0,VRRACT'>VRRHIGH D  D RESET G EX
"RTN","%ZVEMOM",37,0)
 . I $G(FLAGVPE)'["EDIT"!(VRRS>1)!($G(FLAGHOT)="YES") D MSG1^%ZVEMOUM(5,1) Q
"RTN","%ZVEMOM",38,0)
 . S VRRLN=VRRACT D RUN^%ZVEMOU("CHANGE2^%ZVEMOE")
"RTN","%ZVEMOM",39,0)
 I $E(VRRACT,1,3)="COL" S FLAGCOL=$E(VRRACT,4,99) S:FLAGCOL'?1.N!(FLAGCOL<1)!(FLAGCOL>VRRS) FLAGCOL=0 D RESET G EX
"RTN","%ZVEMOM",40,0)
 I ",<ESCT>,<ESCD>,"'[(","_VK_","),",?,ASC,B,BK,BR,D,ED,F,FMC,G,H,I,J,L,LC,M,MK,MD,N,PUR,R,RS,SA,SP,T,U,UN,VEDD,VGL,"'[(","_VRRACT_",") W $C(7) G PAGE1
"RTN","%ZVEMOM",41,0)
EDIT I ",<ESCT>,<ESCD>,"'[(","_VK_","),",BK,D,ED,I,J,LC,MD,PUR,UN,"[(","_VRRACT_",") I $G(FLAGVPE)'["EDIT"!(VRRS>1)!($G(FLAGHOT)="YES") D MSG1^%ZVEMOUM(5,1) G PAGE1
"RTN","%ZVEMOM",42,0)
DELETE I VK="<ESCT>" D CRSRDEL1^%ZVEMOM1 G PAGE1 ;Cursor DELETE
"RTN","%ZVEMOM",43,0)
 I VK="<ESCD>" D CRSRDEL2^%ZVEMOM1,RESET G EX
"RTN","%ZVEMOM",44,0)
MENUS I ",BR,ED,M,N,"[(","_VRRACT_",") D MENUS^%ZVEMOM1 G PAGE1
"RTN","%ZVEMOM",45,0)
 I VRRACT="MK" S VRRMARK=PGTOP D BOTTOM^%ZVEMOU D  G PAGE1
"RTN","%ZVEMOM",46,0)
 . W !?1,"Line ",PGTOP," marked" D PAUSE^%ZVEMKC(1)
"RTN","%ZVEMOM",47,0)
FIND I VRRACT="F" R !,"TAG: ",TAG:VEE("TIME") S:'$T TAG="^" D  S FLAGQ=2 D FF^%ZVEMOU G EX
"RTN","%ZVEMOM",48,0)
 . I "^"[TAG S LNUM=PGTOP-1 Q
"RTN","%ZVEMOM",49,0)
 . KILL VRRCRSR S FLAGTAG="FT",LNUM=PGTOP
"RTN","%ZVEMOM",50,0)
LOCATE I VRRACT="L" R !,"STRING: ",STNG:VEE("TIME") S:'$T STNG="^" D  S FLAGQ=2 D FF^%ZVEMOU G EX
"RTN","%ZVEMOM",51,0)
 . I "^"[STNG S LNUM=PGTOP-1 Q
"RTN","%ZVEMOM",52,0)
 . KILL VRRCRSR S FLAGTAG="FS",LNUM=PGTOP
"RTN","%ZVEMOM",53,0)
 I VRRACT="MD" D  G PAGE1
"RTN","%ZVEMOM",54,0)
 . S ^%ZVEMS("E","EDIT",DUZ)=$S($G(^%ZVEMS("E","EDIT",DUZ))="SCREEN":"LINE",$G(^%ZVEMS("E","EDIT",DUZ))="LINE":"SCREEN",1:"LINE")
"RTN","%ZVEMOM",55,0)
 . W "   ",$S(^%ZVEMS("E","EDIT",DUZ)="LINE":"LINE",1:"SCREEN")," EDITOR NOW ACTIVE"
"RTN","%ZVEMOM",56,0)
 . D PAUSE^%ZVEMKC(1)
"RTN","%ZVEMOM",57,0)
 I VRRACT="PUR" D  G PAGE1
"RTN","%ZVEMOM",58,0)
 . KILL ^%ZVEMS("E","SAVE") W "   PURGE Complete" D PAUSE^%ZVEMKC(1)
"RTN","%ZVEMOM",59,0)
RTN I VRRACT="R",VRRS>3 D MSG1^%ZVEMOUM(7,1) G PAGE1
"RTN","%ZVEMOM",60,0)
 I VRRACT="R" D SYMTAB^%ZVEMKST("C","VRR",VRRS),START^%ZVEMO,SYMTAB^%ZVEMKST("R","VRR",VRRS),RESET G EX
"RTN","%ZVEMOM",61,0)
 I VRRACT="SA",$G(FLAGVPE)'["EDIT" D MSG1^%ZVEMOUM(5,1) G PAGE1
"RTN","%ZVEMOM",62,0)
 I VRRACT="H",$G(FLAGHOT)="YES" S FLAGQ=1 Q  ;Hot key back to other rtn
"RTN","%ZVEMOM",63,0)
 I ",?,ASC,B,BK,D,FMC,H,I,J,LC,RS,SA,SP,T,U,UN,VEDD,VGL,"[(","_VRRACT_",") D ^%ZVEMOM1,RESET G EX
"RTN","%ZVEMOM",64,0)
GOTO I VRRACT="G" D GOTO^%ZVEMOM1 G:VRRLN="NO" GOTO Q:VRRLN="^"  S PGTOP=$S(VRRLN>1:VRRLN,1:1) KILL VRRCRSR D RESET G EX
"RTN","%ZVEMOM",65,0)
 W $C(7) G PAGE1
"RTN","%ZVEMOM",66,0)
EX ;Exit
"RTN","%ZVEMOM",67,0)
 KILL VRRLOC
"RTN","%ZVEMOM",68,0)
 Q
"RTN","%ZVEMOM",69,0)
 ;
"RTN","%ZVEMOM",70,0)
RESET ;
"RTN","%ZVEMOM",71,0)
 S FLAGQ=2,LNUM=PGTOP-1 D FF^%ZVEMOU
"RTN","%ZVEMOM",72,0)
 Q
"RTN","%ZVEMOM1")
0^84^B7627930
"RTN","%ZVEMOM1",1,0)
%ZVEMOM1 ;DJB,VRROLD**Main Menu cont.. [9/20/96 8:08am]
"RTN","%ZVEMOM1",2,0)
 ;;7.0;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMOM1",3,0)
 ;
"RTN","%ZVEMOM1",4,0)
 I $E(VRRACT)="?" D HELP^%ZVEMKT("VRROLD") Q
"RTN","%ZVEMOM1",5,0)
 I VRRACT="ASC",$G(VEESHL)="RUN" D ASCII^%ZVEMST,PAUSE^%ZVEMKC(1) Q
"RTN","%ZVEMOM1",6,0)
 I VRRACT="B" KILL VRRCRSR W:LNUM>VRRHIGH $C(7) S PGTOP=$S(PGTOP<(VRRHIGH-5):(VRRHIGH-5),1:PGTOP) Q
"RTN","%ZVEMOM1",7,0)
 I VRRACT="BK" D RUN^%ZVEMOU("BREAK^%ZVEMOE2") Q
"RTN","%ZVEMOM1",8,0)
 I VRRACT="D" D DELETE^%ZVEMOE Q
"RTN","%ZVEMOM1",9,0)
 I VRRACT="FMC",$G(VEESHL)="RUN" D RUN^%ZVEMOU("^%ZVEMSF") Q
"RTN","%ZVEMOM1",10,0)
 I VRRACT="H" D HOT^%ZVEMOU Q
"RTN","%ZVEMOM1",11,0)
 I VRRACT="I" D RUN^%ZVEMOU("INSERT^%ZVEMOE") Q
"RTN","%ZVEMOM1",12,0)
 I VRRACT="J" D JOIN^%ZVEMOE2 Q
"RTN","%ZVEMOM1",13,0)
 I VRRACT="LC" D LC^%ZVEMOE1 Q
"RTN","%ZVEMOM1",14,0)
 I VRRACT="RS" D RUN^%ZVEMOU("RSE^%ZVEMOY") Q
"RTN","%ZVEMOM1",15,0)
 I VRRACT="SA" D SAVE^%ZVEMOE1 Q
"RTN","%ZVEMOM1",16,0)
 I VRRACT="SP" S VRRSP=$S(VRRSP=2:1,1:2) KILL VRRCRSR Q
"RTN","%ZVEMOM1",17,0)
 I VRRACT="T" KILL VRRCRSR W:PGTOP=1 $C(7) S PGTOP=1 Q
"RTN","%ZVEMOM1",18,0)
 I VRRACT="U" KILL VRRCRSR W:PGTOP=1 $C(7) S PGTOP=$S(PGTOP>$S(VRRSP=1:12,1:6):PGTOP-$S(VRRSP=1:12,1:6),1:1) Q
"RTN","%ZVEMOM1",19,0)
 I VRRACT="UN" D UNSAVE^%ZVEMOE1 Q
"RTN","%ZVEMOM1",20,0)
 I VRRACT="VEDD" D VEDD^%ZVEMOY Q
"RTN","%ZVEMOM1",21,0)
 I VRRACT="VGL" D VGL^%ZVEMOY Q
"RTN","%ZVEMOM1",22,0)
 Q
"RTN","%ZVEMOM1",23,0)
 ;====================================================================
"RTN","%ZVEMOM1",24,0)
MENUS ;List selected sub-menu
"RTN","%ZVEMOM1",25,0)
 D BOTTOM^%ZVEMOU ;Blank bottom of screen
"RTN","%ZVEMOM1",26,0)
 I VRRACT="ED" W " 'n',<TAB>=EditLn  I=Insert  D=Del  LC=LctChng  SA=Save  UN=Unsave",!," BK=Break  J=Join  MD=ChangeMode  PUR=Purge"
"RTN","%ZVEMOM1",27,0)
 I VRRACT="N" W " <RET>=DwnPg  U=UpPg  T=Top  B=Bottom  G=Goto  F=FndTag  L=LctStrng",!," <AU>=LnUp  <AD>=LnDn  <AL>=PgTop  <AR>=PgBottom"
"RTN","%ZVEMOM1",28,0)
 I VRRACT="BR" W " R=Rtn  H=Hot  RS=RtnSrch  VEDD=VEDD  VGL=VGL"
"RTN","%ZVEMOM1",29,0)
 I VRRACT="M" W " SP=DblSpace  MK=Mark  COL'n'=Collapse  FMC=FM Calls  ASC=ASCII"
"RTN","%ZVEMOM1",30,0)
 D PAUSE^%ZVEMKC(1)
"RTN","%ZVEMOM1",31,0)
 Q
"RTN","%ZVEMOM1",32,0)
GOTO ;Go to a line
"RTN","%ZVEMOM1",33,0)
 D BOTTOM^%ZVEMOU ;Blank bottom of screen
"RTN","%ZVEMOM1",34,0)
GOTO1 S VRRLN=$$GETLINE^%ZVEMOU("LINE NUMBER: ")
"RTN","%ZVEMOM1",35,0)
 I VRRLN="^" D RESET^%ZVEMOM Q
"RTN","%ZVEMOM1",36,0)
 I VRRLN="?" D MSG2^%ZVEMOUM(4) G GOTO1
"RTN","%ZVEMOM1",37,0)
 I VRRLN="MK" S VRRLN=$G(VRRMARK) I VRRLN'>0 D MSG2^%ZVEMOUM(6) G GOTO1
"RTN","%ZVEMOM1",38,0)
 I VRRLN?1.N Q
"RTN","%ZVEMOM1",39,0)
 D MSG2^%ZVEMOUM(3) G GOTO1
"RTN","%ZVEMOM1",40,0)
 Q
"RTN","%ZVEMOM1",41,0)
CRSRDEL1 ;Set FLAGDEL with range of lines for deleting
"RTN","%ZVEMOM1",42,0)
 I $G(FLAGDEL)?1.N1"-"1.N KILL FLAGDEL Q
"RTN","%ZVEMOM1",43,0)
 I VRRCRSR=1 W $C(7) Q
"RTN","%ZVEMOM1",44,0)
 I $G(FLAGDEL)']"" S FLAGDEL=VRRCRSR_"-" Q
"RTN","%ZVEMOM1",45,0)
 I VRRCRSR<+FLAGDEL S FLAGDEL=VRRCRSR_"-"_+FLAGDEL Q
"RTN","%ZVEMOM1",46,0)
 S FLAGDEL=FLAGDEL_VRRCRSR
"RTN","%ZVEMOM1",47,0)
 Q
"RTN","%ZVEMOM1",48,0)
CRSRDEL2 ;Delete range of lines using cursor
"RTN","%ZVEMOM1",49,0)
 I $G(FLAGDEL)'?1.N1"-"1.N W $C(7) KILL FLAGDEL Q
"RTN","%ZVEMOM1",50,0)
 S VRRLN=FLAGDEL D DELETEB^%ZVEMOE KILL FLAGDEL
"RTN","%ZVEMOM1",51,0)
 Q
"RTN","%ZVEMOM2")
0^85^B3829163
"RTN","%ZVEMOM2",1,0)
%ZVEMOM2 ;DJB,VRROLD**Main Menu-Cursor Highlight [02/16/95]
"RTN","%ZVEMOM2",2,0)
 ;;7.0;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMOM2",3,0)
 ;
"RTN","%ZVEMOM2",4,0)
ARROW ;Arrow keys
"RTN","%ZVEMOM2",5,0)
 ;;FLAGQ=2 when screen needs to be redrawn
"RTN","%ZVEMOM2",6,0)
 ;;CHK=1 will stop bottom menu from being redrawn
"RTN","%ZVEMOM2",7,0)
 I $G(FLAGBLNK)&(VK'="<AU>") W $C(7) Q  ;When last screen is blank
"RTN","%ZVEMOM2",8,0)
 D OLDHIGH ;Erase current highlight
"RTN","%ZVEMOM2",9,0)
 I VK="<AU>" D
"RTN","%ZVEMOM2",10,0)
 . I $G(FLAGBLNK),VRRCRSR=PGTOP S FLAGQ=2 Q
"RTN","%ZVEMOM2",11,0)
 . I VRRCRSR>PGTOP S VRRCRSR=VRRCRSR-1,CHK=1 Q
"RTN","%ZVEMOM2",12,0)
 . I PGTOP=1 W $C(7) Q
"RTN","%ZVEMOM2",13,0)
 . S VRRCRSR="PGTOP",PGTOP=PGTOP-1,FLAGQ=2
"RTN","%ZVEMOM2",14,0)
 I VK="<AD>" D
"RTN","%ZVEMOM2",15,0)
 . I VRRCRSR<BOTTOM S VRRCRSR=VRRCRSR+1,CHK=1 Q
"RTN","%ZVEMOM2",16,0)
 . I BOTTOM=VRRHIGH W $C(7) Q
"RTN","%ZVEMOM2",17,0)
 . S VRRCRSR="BOTTOM",PGTOP=PGTOP+1,FLAGQ=2
"RTN","%ZVEMOM2",18,0)
 I VK="<AL>" W:VRRCRSR=PGTOP $C(7) S VRRCRSR=PGTOP,CHK=1
"RTN","%ZVEMOM2",19,0)
 I VK="<AR>" W:VRRCRSR=BOTTOM $C(7) S VRRCRSR=BOTTOM,CHK=1
"RTN","%ZVEMOM2",20,0)
 Q:FLAGQ  D NEWHIGH,@$S(CHK:"BOTTOM2^%ZVEMOU",1:"BOTTOM^%ZVEMOU")
"RTN","%ZVEMOM2",21,0)
 Q
"RTN","%ZVEMOM2",22,0)
NEWHIGH ;Setup new highlight
"RTN","%ZVEMOM2",23,0)
 Q:$$CHECK  W @VEE("RON"),$$CHAR,@VEE("ROFF")
"RTN","%ZVEMOM2",24,0)
 Q
"RTN","%ZVEMOM2",25,0)
OLDHIGH ;Erase old highlight
"RTN","%ZVEMOM2",26,0)
 Q:$$CHECK  W $$CHAR
"RTN","%ZVEMOM2",27,0)
 Q
"RTN","%ZVEMOM2",28,0)
CHAR() ;Position cursor and return character to be printed
"RTN","%ZVEMOM2",29,0)
 NEW NODE S NODE=$P(VRRLOC,"^",VRRCRSR)
"RTN","%ZVEMOM2",30,0)
 S DX=8,DY=$P(NODE,"*",1) X VEES("CRSR")
"RTN","%ZVEMOM2",31,0)
 Q $P(NODE,"*",2)
"RTN","%ZVEMOM2",32,0)
CHECK() ;Returns 1 if highlight should not be drawn
"RTN","%ZVEMOM2",33,0)
 I $G(FLAGBLNK)!($G(VRRLOC)']"")!($G(VRRCRSR)']"") Q 1
"RTN","%ZVEMOM2",34,0)
 Q 0
"RTN","%ZVEMOM2",35,0)
PGKEYS ;<PGUP> & <PGDN>
"RTN","%ZVEMOM2",36,0)
 D OLDHIGH ;Erase current highlight
"RTN","%ZVEMOM2",37,0)
 I VK="<PGUP>" W:VRRCRSR=PGTOP $C(7) S VRRCRSR=PGTOP
"RTN","%ZVEMOM2",38,0)
 I VK="<PGDN>" W:VRRCRSR=BOTTOM $C(7) S VRRCRSR=BOTTOM
"RTN","%ZVEMOM2",39,0)
 D NEWHIGH,BOTTOM2^%ZVEMOU
"RTN","%ZVEMOM2",40,0)
 Q
"RTN","%ZVEMOM2",41,0)
INIT ;
"RTN","%ZVEMOM2",42,0)
 S BOTTOM=$S(LNUM<VRRHIGH:LNUM,1:VRRHIGH)
"RTN","%ZVEMOM2",43,0)
 S VRRCRSR=$G(VRRCRSR)
"RTN","%ZVEMOM2",44,0)
 S VRRCRSR=$S(VRRCRSR>0&(VRRCRSR'>BOTTOM):VRRCRSR,1:BOTTOM)
"RTN","%ZVEMOS")
0^86^B14540313
"RTN","%ZVEMOS",1,0)
%ZVEMOS ;DJB,VRROLD**Get Program [12/31/94]
"RTN","%ZVEMOS",2,0)
 ;;7.0;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMOS",3,0)
 ;
"RTN","%ZVEMOS",4,0)
EN ;Enter here from ^%ZVEMO
"RTN","%ZVEMOS",5,0)
 D HD,GETPGM G:FLAGQ EX D SETGLB
"RTN","%ZVEMOS",6,0)
EX ;
"RTN","%ZVEMOS",7,0)
 Q
"RTN","%ZVEMOS",8,0)
GETPGM ;
"RTN","%ZVEMOS",9,0)
 I $G(FLAGPRM)=1 S FLAGPRM="VRR",VRRPGM=%1 G GETPGM1
"RTN","%ZVEMOS",10,0)
 NEW RTN
"RTN","%ZVEMOS",11,0)
 S RTN=$G(^%ZVEMS("E","VRR",DUZ))
"RTN","%ZVEMOS",12,0)
 ; Next: If RTN doesn't exist it shouldn't be the default routine
"RTN","%ZVEMOS",13,0)
 I RTN]"",'$$EXIST^%ZVEMKU(RTN) S RTN="" KILL ^%ZVEMS("E","VRR",DUZ)
"RTN","%ZVEMOS",14,0)
 I $G(VEESHL)="RUN" D  G:VRRPGM?1"<".E1">" GETPGM G GETPGM1
"RTN","%ZVEMOS",15,0)
 . S VRRPGM=$$CLHEDIT^%ZVEMSCL("VRR","Select ROUTINE: "_$S(RTN]"":RTN_"//",1:"")) S:VRRPGM="" VRRPGM=RTN S:VRRPGM=" " VRRPGM="^"
"RTN","%ZVEMOS",16,0)
 W !?1,"Select ROUTINE: ",$S(RTN]"":RTN_"//",1:"")
"RTN","%ZVEMOS",17,0)
 R VRRPGM:VEE("TIME") S:'$T!(VRRPGM=" ") VRRPGM="^" S:VRRPGM="" VRRPGM=RTN
"RTN","%ZVEMOS",18,0)
GETPGM1 ;Come here when passing a parameter
"RTN","%ZVEMOS",19,0)
 I "^"[VRRPGM S FLAGQ=1 Q
"RTN","%ZVEMOS",20,0)
 S:VRRPGM["^" VRRPGM=$P(VRRPGM,"^",2) S:VRRPGM["(" VRRPGM=$P(VRRPGM,"(")
"RTN","%ZVEMOS",21,0)
 I VRRPGM="?" D HELP G GETPGM
"RTN","%ZVEMOS",22,0)
 I VRRPGM="??" D LIST KILL ^UTILITY($J) W ! G GETPGM
"RTN","%ZVEMOS",23,0)
 I VRRPGM'?.1"%"1A.7AN D MSG1 G GETPGM
"RTN","%ZVEMOS",24,0)
 I $D(^%ZVEMS("E")) S ^%ZVEMS("E","VRR",DUZ)=VRRPGM
"RTN","%ZVEMOS",25,0)
 ;Next line checks to see if anyone else is editing this routine.
"RTN","%ZVEMOS",26,0)
 I $G(FLAGVPE)["EDIT",VRRS=1 L ^%ZVEMS("E","LOCK",VRRPGM):0 I '$T D  S FLAGQ=1
"RTN","%ZVEMOS",27,0)
 . W $C(7),!!?5,"This program is currently being edited. Try later.",!
"RTN","%ZVEMOS",28,0)
 Q
"RTN","%ZVEMOS",29,0)
LIST ;List routines
"RTN","%ZVEMOS",30,0)
 KILL ^UTILITY($J)
"RTN","%ZVEMOS",31,0)
 D @$S($D(^%ZOSF("RSEL")):"ZOSF^%ZVEMOSS",1:VEE("OS")_"^%ZVEMOSS") Q:$O(^UTILITY($J,""))=""
"RTN","%ZVEMOS",32,0)
LIST1 R !!?1,"Select [B]lock or [L]ist: L// ",VEEX:VEE("TIME") S:'$T VEEX="^" S:VEEX="" VEEX="L" I VEEX="^" Q
"RTN","%ZVEMOS",33,0)
 I VEEX="?" W "   Enter 'B' or 'L'" G LIST1
"RTN","%ZVEMOS",34,0)
 I ",B,b,L,l,"'[(","_VEEX_",") W $C(7),"   ??" G LIST1
"RTN","%ZVEMOS",35,0)
 S VEEX=$S(VEEX="b":"B",VEEX="l":"L",1:VEEX)
"RTN","%ZVEMOS",36,0)
 D @$S(VEEX="B":"LISTB",VEEX="L":"LISTL",1:"")
"RTN","%ZVEMOS",37,0)
 Q
"RTN","%ZVEMOS",38,0)
LISTB ;Block list of programs, 8 to a line, 5 lines at a time
"RTN","%ZVEMOS",39,0)
 NEW CNT,COL,FLAGQ,I,X
"RTN","%ZVEMOS",40,0)
 S (CNT,FLAGQ,X,XX)=0,COL=1 W !
"RTN","%ZVEMOS",41,0)
 F I=1:1 S X=$O(^UTILITY($J,X)) Q:X=""  W:COL=1 ! W ?COL,X S COL=COL+10 I COL>75 D  Q:FLAGQ
"RTN","%ZVEMOS",42,0)
 . S COL=1,CNT=CNT+1 I CNT#5=0 D PAUSEQ^%ZVEMKC(2) W !
"RTN","%ZVEMOS",43,0)
 D:I=1 MSG1 W:I>1 !
"RTN","%ZVEMOS",44,0)
 Q
"RTN","%ZVEMOS",45,0)
LISTL ;List top line of selected programs
"RTN","%ZVEMOS",46,0)
 NEW CNT,FLAGQ,RTN
"RTN","%ZVEMOS",47,0)
 S (FLAGQ,RTN)=0 W @VEE("IOF")
"RTN","%ZVEMOS",48,0)
 F CNT=1:1 S RTN=$O(^UTILITY($J,RTN)) Q:RTN=""  D  Q:FLAGQ
"RTN","%ZVEMOS",49,0)
 . W !,$J(CNT,3),". ",RTN,?14,$E($P($T(^@RTN)," ",2,99),1,65)
"RTN","%ZVEMOS",50,0)
 . I $Y>VEESIZE D PAUSEQ^%ZVEMKC(2) Q:FLAGQ  W @VEE("IOF"),!
"RTN","%ZVEMOS",51,0)
 Q
"RTN","%ZVEMOS",52,0)
SETGLB ;Put routine into global
"RTN","%ZVEMOS",53,0)
 NEW I,TXT,X KILL ^TMP("VEE","VRR",$J,VRRS)
"RTN","%ZVEMOS",54,0)
 I $G(VEESHL)="RUN" D CLHSET^%ZVEMSCL("VRR",VRRPGM) ;Cmnd Line History
"RTN","%ZVEMOS",55,0)
 S X=VRRPGM,^TMP("VEE","VRR",$J,VRRS,"NAME")=VRRPGM
"RTN","%ZVEMOS",56,0)
 I '$$EXIST^%ZVEMKU(X) S VRRHIGH=0 Q
"RTN","%ZVEMOS",57,0)
 X "ZL @VRRPGM F I=1:1 S TXT=$T(+I) Q:TXT=""""  S TXT=$P(TXT,"" "")_$C(9)_$P(TXT,"" "",2,999),^TMP(""VEE"",""VRR"",$J,VRRS,""TXT"",I)=TXT"
"RTN","%ZVEMOS",58,0)
 S VRRHIGH=I-1
"RTN","%ZVEMOS",59,0)
 S ^TMP("VEE","VRR",$J,VRRS,"HOT")=VRRHIGH
"RTN","%ZVEMOS",60,0)
 Q
"RTN","%ZVEMOS",61,0)
MSG ;Messages
"RTN","%ZVEMOS",62,0)
MSG1 W $C(7),!?1,"Invalid Program" Q
"RTN","%ZVEMOS",63,0)
HELP ;Help text
"RTN","%ZVEMOS",64,0)
 W !!?5,"Enter a routine name, or <RETURN> to select default routine."
"RTN","%ZVEMOS",65,0)
 W !?5,"Enter '??' to display routine names in one of the following forms:"
"RTN","%ZVEMOS",66,0)
 W !!?10,"BLOCK.....Routines listed 8 to a line, 5 lines at a time."
"RTN","%ZVEMOS",67,0)
 W !?10,"LIST......Lists top line of each selected routine.",!
"RTN","%ZVEMOS",68,0)
 Q
"RTN","%ZVEMOS",69,0)
HD ;Heading
"RTN","%ZVEMOS",70,0)
 Q:$G(%1)]""  ;Don't display heading when parameter passing
"RTN","%ZVEMOS",71,0)
 Q:VRRS>1  ;Don't display heading when branching to another program
"RTN","%ZVEMOS",72,0)
 W !?1,"Victory Routine ",$S($G(FLAGVPE)["EDIT":"Editor",1:"Reader")," . . . . . . . . . . . . . . . . . . . . . David Bolduc"
"RTN","%ZVEMOS",73,0)
 W !?1,"^=Quit   <RETURN>=DefaultRtn   ?=Help   ??=RtnList",!
"RTN","%ZVEMOS",74,0)
 Q
"RTN","%ZVEMOSS")
0^87^B13672112
"RTN","%ZVEMOSS",1,0)
%ZVEMOSS ;DJB,VRROLD**Routine String Search [5/17/97 7:09am]
"RTN","%ZVEMOSS",2,0)
 ;;7.0;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMOSS",3,0)
 ;
"RTN","%ZVEMOSS",4,0)
 NEW ASK,CHK,CNT,CODE1,CODE2,CODE3,FLAGA,FLAGQ,I,I1,I2,NUMR,NUMS,QUIT,RTN,STRING,TIC,TXT
"RTN","%ZVEMOSS",5,0)
 D INIT
"RTN","%ZVEMOSS",6,0)
 I '$D(^%ZOSF("RSEL")),$G(VEE("OS"))="" D OS^%ZVEMKY G:FLAGQ EX
"RTN","%ZVEMOSS",7,0)
TOP ;
"RTN","%ZVEMOSS",8,0)
 KILL ^UTILITY($J)
"RTN","%ZVEMOSS",9,0)
 S FLAGQ=0
"RTN","%ZVEMOSS",10,0)
 D @$S($D(^%ZOSF("RSEL")):"ZOSF",1:VEE("OS"))
"RTN","%ZVEMOSS",11,0)
 I $O(^UTILITY($J,""))="" G EX
"RTN","%ZVEMOSS",12,0)
 D STRG G:'$D(STRING(1))!FLAGQ TOP
"RTN","%ZVEMOSS",13,0)
 D LIST
"RTN","%ZVEMOSS",14,0)
 G TOP
"RTN","%ZVEMOSS",15,0)
EX ;
"RTN","%ZVEMOSS",16,0)
 KILL ^UTILITY($J)
"RTN","%ZVEMOSS",17,0)
 Q
"RTN","%ZVEMOSS",18,0)
ZOSF ;Use ^%ZOSF("RSEL")
"RTN","%ZVEMOSS",19,0)
 NEW %,X
"RTN","%ZVEMOSS",20,0)
 X ^%ZOSF("RSEL")
"RTN","%ZVEMOSS",21,0)
 Q
"RTN","%ZVEMOSS",22,0)
2 ;Routine Select for DSM Mumps
"RTN","%ZVEMOSS",23,0)
 D ^%RSEL
"RTN","%ZVEMOSS",24,0)
 Q
"RTN","%ZVEMOSS",25,0)
8 ;Routine Select for MSM Mumps
"RTN","%ZVEMOSS",26,0)
 D INT^%RSEL
"RTN","%ZVEMOSS",27,0)
 Q
"RTN","%ZVEMOSS",28,0)
9 ;Routine Select for DataTree Mumps
"RTN","%ZVEMOSS",29,0)
 NEW RTN
"RTN","%ZVEMOSS",30,0)
 KILL ^%RSET($J)
"RTN","%ZVEMOSS",31,0)
 W $$^%rselect
"RTN","%ZVEMOSS",32,0)
 I $O(^%RSET($J,""))="" Q
"RTN","%ZVEMOSS",33,0)
 S RTN=""
"RTN","%ZVEMOSS",34,0)
 F  S RTN=$O(^%RSET($J,RTN)) Q:RTN=""  S ^UTILITY($J,RTN)=""
"RTN","%ZVEMOSS",35,0)
 KILL ^%RSET($J)
"RTN","%ZVEMOSS",36,0)
 Q
"RTN","%ZVEMOSS",37,0)
16 ;Routine Select for VAX DSM Mumps
"RTN","%ZVEMOSS",38,0)
 NEW %UTILITY
"RTN","%ZVEMOSS",39,0)
 D ^%RSEL Q:$O(%UTILITY(""))=""
"RTN","%ZVEMOSS",40,0)
 S RTN=""
"RTN","%ZVEMOSS",41,0)
 F  S RTN=$O(%UTILITY(RTN)) Q:RTN=""  S ^UTILITY($J,RTN)=""
"RTN","%ZVEMOSS",42,0)
 Q
"RTN","%ZVEMOSS",43,0)
18 ;Rtn Select for OpenM
"RTN","%ZVEMOSS",44,0)
 KILL ^UTILITY($J)
"RTN","%ZVEMOSS",45,0)
 I $L($T(KERNEL^%RSET)) D KERNEL^%RSET KILL %ST Q  ;VA Kernel rtn
"RTN","%ZVEMOSS",46,0)
 NEW %JO,%UR,%R
"RTN","%ZVEMOSS",47,0)
 S %JO=$J,%UR="^ROUTINE",%R=0 D ROU^%RSET
"RTN","%ZVEMOSS",48,0)
 Q
"RTN","%ZVEMOSS",49,0)
STRG ;Get String
"RTN","%ZVEMOSS",50,0)
 KILL STRING
"RTN","%ZVEMOSS",51,0)
 S CNT=0 W !
"RTN","%ZVEMOSS",52,0)
STRG1 W !,"Enter search string: "
"RTN","%ZVEMOSS",53,0)
 R STRING:300 I "^"[STRING S:STRING="^" FLAGQ=1 Q
"RTN","%ZVEMOSS",54,0)
 I "??"[STRING D HELP G:ASK'="S" STRG1
"RTN","%ZVEMOSS",55,0)
 S CNT=CNT+1,STRING(CNT)=STRING
"RTN","%ZVEMOSS",56,0)
 G STRG1
"RTN","%ZVEMOSS",57,0)
LIST ;List routines
"RTN","%ZVEMOSS",58,0)
 S RTN="",(FLAGA,FLAGQ,NUMR,NUMS,TIC)=0,CHK=1 W !
"RTN","%ZVEMOSS",59,0)
 F I=1:1 S RTN=$O(^UTILITY($J,RTN)) Q:RTN=""!FLAGQ  D  ;
"RTN","%ZVEMOSS",60,0)
 . X "ZL @RTN X CODE1,CODE2"
"RTN","%ZVEMOSS",61,0)
 . S NUMR=NUMR+1 S:TIC NUMS=NUMS+1 W:TIC ! S TIC=0
"RTN","%ZVEMOSS",62,0)
 W !!?1,$J(NUMR,4)," Routine",$S(NUMR=1:" ",1:"s "),"searched."
"RTN","%ZVEMOSS",63,0)
 W !?1,$J(NUMS,4)," Routine",$S(NUMS=1:" ",1:"s "),"contained search string(s)."
"RTN","%ZVEMOSS",64,0)
 Q
"RTN","%ZVEMOSS",65,0)
HELP ;User entered '?' at STRING prompt
"RTN","%ZVEMOSS",66,0)
 W ?25,"Do you want Help, or to search for "
"RTN","%ZVEMOSS",67,0)
 W $S(STRING="?":"'?'",1:"'??'"),!?25,"Select [H]elp or [S]earch: "
"RTN","%ZVEMOSS",68,0)
 R ASK:300 Q:"^"[ASK  I "Ss"[$E(ASK) S ASK="S" Q
"RTN","%ZVEMOSS",69,0)
 W !!?3,"Enter any character string. The selected routines will be searched"
"RTN","%ZVEMOSS",70,0)
 W !?3,"and any line containing the string will be displayed. You may"
"RTN","%ZVEMOSS",71,0)
 W !?3,"enter more than 1 search string.",!
"RTN","%ZVEMOSS",72,0)
 W !?3,"Whenever the display stops at a program line that contains a"
"RTN","%ZVEMOSS",73,0)
 W !?3,"string, you may enter <RETURN> to contine, '^' to quit, '?' for"
"RTN","%ZVEMOSS",74,0)
 W !?3,"Help, or 'A' for Autoprint. When Autoprint is active the display"
"RTN","%ZVEMOSS",75,0)
 W !?3,"will not stop at each line containing a string.",!
"RTN","%ZVEMOSS",76,0)
 Q
"RTN","%ZVEMOSS",77,0)
INIT ;
"RTN","%ZVEMOSS",78,0)
 S CODE1="W !,RTN,""  """
"RTN","%ZVEMOSS",79,0)
 S CODE2="F I1=1:1 S TXT=$T(+I1) Q:TXT=""""!FLAGQ  F I2=1:1:CNT I TXT[STRING(I2) W !!,RTN,""+"",I1-1,"" -->"",TXT S TIC=1 X:'FLAGA CODE3 Q"
"RTN","%ZVEMOSS",80,0)
 S CODE3="R ASK:300 S:ASK=""a"" ASK=""A"" R:""^,A""'[ASK !!?2,""<RETURN>=Continue  ^=Quit  A=AutoPrint"",!?2,""Select: "",ASK:300 S:ASK[""^"" FLAGQ=1 S:ASK=""A"" FLAGA=1"
"RTN","%ZVEMOSS",81,0)
 Q
"RTN","%ZVEMOU")
0^88^B12442978
"RTN","%ZVEMOU",1,0)
%ZVEMOU ;DJB,VRROLD**GETLINE,SCREEN,FF,HOT ; 12/15/00 8:31pm
"RTN","%ZVEMOU",2,0)
 ;;7.0;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMOU",3,0)
 ;
"RTN","%ZVEMOU",4,0)
GETLINE(PROMPT) ;;Extrinsic Function to return line number
"RTN","%ZVEMOU",5,0)
 ;;Returns: ^,?,M,"INVALID","INVALID RNG",Line number or range.
"RTN","%ZVEMOU",6,0)
 NEW LN,X1,X2
"RTN","%ZVEMOU",7,0)
 W ?1,PROMPT
"RTN","%ZVEMOU",8,0)
 S LN=$$READ^%ZVEMKR()
"RTN","%ZVEMOU",9,0)
 S:LN']"" LN=$G(VEE("K"))
"RTN","%ZVEMOU",10,0)
 S:",<TO>,<RET>,<ESC>,^,"[(","_LN_",") LN="^"
"RTN","%ZVEMOU",11,0)
 I "^"[LN Q LN
"RTN","%ZVEMOU",12,0)
 I LN="<TAB>" S LN=$G(VRRCRSR) I LN']"" S LN="^" Q LN
"RTN","%ZVEMOU",13,0)
 I $E(LN)="?" S LN="?" Q LN
"RTN","%ZVEMOU",14,0)
 I "mk,MK"[LN S LN="MK" Q LN
"RTN","%ZVEMOU",15,0)
 I LN="ALL"!(LN="all") S LN="2-"_VRRHIGH
"RTN","%ZVEMOU",16,0)
 I LN["-" D  Q LN
"RTN","%ZVEMOU",17,0)
 . I LN'?1.N1"-"1.N S LN="INVALID RNG" Q
"RTN","%ZVEMOU",18,0)
 . S X1=$P(LN,"-")
"RTN","%ZVEMOU",19,0)
 . S X2=$P(LN,"-",2)
"RTN","%ZVEMOU",20,0)
 . S:X2>VRRHIGH X2=VRRHIGH
"RTN","%ZVEMOU",21,0)
 . I X1'?1.N!(X1<1)!(X1>X2)!(X2'?1.N) S LN="INVALID RNG" Q
"RTN","%ZVEMOU",22,0)
 . S LN=X1_"-"_X2
"RTN","%ZVEMOU",23,0)
 ;
"RTN","%ZVEMOU",24,0)
 I PROMPT["INSERT AFTER LINE NUMBER"!(PROMPT["UNSAVE AFTER LINE NUMBER"),LN=0 Q LN
"RTN","%ZVEMOU",25,0)
 I LN'?1.N!(LN<1)!(LN>VRRHIGH) S LN="INVALID"
"RTN","%ZVEMOU",26,0)
 Q LN
"RTN","%ZVEMOU",27,0)
 ;====================================================================
"RTN","%ZVEMOU",28,0)
RUN(RTN) ;Run RTN, reset RM0
"RTN","%ZVEMOU",29,0)
 Q:$G(RTN)']""
"RTN","%ZVEMOU",30,0)
 X VEES("RM80") D @RTN X VEES("RM0")
"RTN","%ZVEMOU",31,0)
 Q
"RTN","%ZVEMOU",32,0)
 ;====================================================================
"RTN","%ZVEMOU",33,0)
FF ;Set up top part of display
"RTN","%ZVEMOU",34,0)
 Q:FLAGL
"RTN","%ZVEMOU",35,0)
 S FLAGBLNK=1 ;FLAGBLNK=Surpress highlight on blank screen
"RTN","%ZVEMOU",36,0)
 NEW DX,DY
"RTN","%ZVEMOU",37,0)
 W @VEE("IOF")
"RTN","%ZVEMOU",38,0)
 S DX=9,DY=0 X VEES("CRSR")
"RTN","%ZVEMOU",39,0)
 W "Routine "_VRRS_" of 4: ^"_VRRPGM_"    Lines: "_VRRHIGH
"RTN","%ZVEMOU",40,0)
 I $G(FLAGHOT)="YES" D  W "HOT KEY ACTIVE",@VEE("ROFF")
"RTN","%ZVEMOU",41,0)
 . S DX=64 X VEES("CRSR")
"RTN","%ZVEMOU",42,0)
 . W @VEE("RON") X VEES("XY")
"RTN","%ZVEMOU",43,0)
 W !,$E(VRRLINE,1,VEE("IOM"))
"RTN","%ZVEMOU",44,0)
 Q
"RTN","%ZVEMOU",45,0)
 ;====================================================================
"RTN","%ZVEMOU",46,0)
BOTTOM ;Set up bottom part of display
"RTN","%ZVEMOU",47,0)
 S DX=0,DY=21 X VEES("CRSR")
"RTN","%ZVEMOU",48,0)
 W @VEES("BLANK_C_EOS")
"RTN","%ZVEMOU",49,0)
 X VEES("XY")
"RTN","%ZVEMOU",50,0)
 Q
"RTN","%ZVEMOU",51,0)
 ;
"RTN","%ZVEMOU",52,0)
BOTTOM1 ;Set up bottom part of display, preserving one line of text
"RTN","%ZVEMOU",53,0)
 S DX=0,DY=22 X VEES("CRSR")
"RTN","%ZVEMOU",54,0)
 W @VEES("BLANK_C_EOS")
"RTN","%ZVEMOU",55,0)
 X VEES("XY")
"RTN","%ZVEMOU",56,0)
 Q
"RTN","%ZVEMOU",57,0)
 ;
"RTN","%ZVEMOU",58,0)
BOTTOM2 ;Don't redraw menu line at bottom of screen
"RTN","%ZVEMOU",59,0)
 S DX=0,DY=22 X VEES("CRSR")
"RTN","%ZVEMOU",60,0)
 W ?1,"Select: "
"RTN","%ZVEMOU",61,0)
 Q
"RTN","%ZVEMOU",62,0)
 ;====================================================================
"RTN","%ZVEMOU",63,0)
HOT ;Hot key to switch between routines
"RTN","%ZVEMOU",64,0)
 NEW TEMP S TEMP=VRRS
"RTN","%ZVEMOU",65,0)
 NEW FLAGBLNK,FLAGCOL,FLAGHOT,FLAGL,FLAGQ,FLAGTAG
"RTN","%ZVEMOU",66,0)
 NEW BOTTOM,END,END1,I,LNUM,PGTOP,START,STNG,TAG
"RTN","%ZVEMOU",67,0)
 NEW CODE,CODELN,CODETG,DX,DY
"RTN","%ZVEMOU",68,0)
 NEW VRRACT,VRRCRSR,VRRHIGH,VRRLN,VRRMARK,VRRPGM,VRRS
"RTN","%ZVEMOU",69,0)
 S FLAGHOT="YES"
"RTN","%ZVEMOU",70,0)
 S (FLAGCOL,FLAGQ)=0
"RTN","%ZVEMOU",71,0)
 S VRRSP=1
"RTN","%ZVEMOU",72,0)
 D HOTRTN Q:FLAGQ
"RTN","%ZVEMOU",73,0)
 S VRRHIGH=$P(^TMP("VEE","VRR",$J,VRRS,"HOT"),"^",1)
"RTN","%ZVEMOU",74,0)
 S VRRPGM=^("NAME")
"RTN","%ZVEMOU",75,0)
 S (PGTOP,START)=$S($P(^("HOT"),"^",2)]"":$P(^("HOT"),"^",2),1:1)
"RTN","%ZVEMOU",76,0)
 S TEMP=VRRS
"RTN","%ZVEMOU",77,0)
 D TOP^%ZVEMO
"RTN","%ZVEMOU",78,0)
 Q:'$D(^TMP("VEE","VRR",$J,TEMP,"HOT"))
"RTN","%ZVEMOU",79,0)
 S $P(^("HOT"),"^",2)=$G(PGTOP)
"RTN","%ZVEMOU",80,0)
 Q
"RTN","%ZVEMOU",81,0)
 ;
"RTN","%ZVEMOU",82,0)
HOTRTN ;Get Routine
"RTN","%ZVEMOU",83,0)
 NEW I,X
"RTN","%ZVEMOU",84,0)
 I '$D(^TMP("VEE","VRR",$J,2,"HOT")) D  Q  ;Hasn't branched yet
"RTN","%ZVEMOU",85,0)
 . W $C(7),"   You haven't branched to any routines yet.."
"RTN","%ZVEMOU",86,0)
 . S FLAGQ=1
"RTN","%ZVEMOU",87,0)
 . D PAUSE^%ZVEMKU(1)
"RTN","%ZVEMOU",88,0)
 S X=""
"RTN","%ZVEMOU",89,0)
 F  S X=$O(^TMP("VEE","VRR",$J,X)) Q:X=""  D
"RTN","%ZVEMOU",90,0)
 . Q:X=TEMP
"RTN","%ZVEMOU",91,0)
 . Q:'$D(^TMP("VEE","VRR",$J,X,"HOT"))
"RTN","%ZVEMOU",92,0)
 . S TEMP(X)=""
"RTN","%ZVEMOU",93,0)
 S X=""
"RTN","%ZVEMOU",94,0)
 F I=1:1 S X=$O(TEMP(X)) Q:X=""
"RTN","%ZVEMOU",95,0)
 I I=1 S FLAGQ=1 Q
"RTN","%ZVEMOU",96,0)
 I I=2 S VRRS=$O(TEMP("")) Q
"RTN","%ZVEMOU",97,0)
 W !!?2,"HOT KEY"
"RTN","%ZVEMOU",98,0)
 W !?2,"Routine Select:"
"RTN","%ZVEMOU",99,0)
 S X=""
"RTN","%ZVEMOU",100,0)
 F I=1:1 S X=$O(TEMP(X)) Q:X=""  D
"RTN","%ZVEMOU",101,0)
 . W ?19,X,". ",^TMP("VEE","VRR",$J,X,"NAME"),!
"RTN","%ZVEMOU",102,0)
HOTRTN1 R !?2,"Select NUMBER: ",VRRS:300 S:'$T VRRS="^"
"RTN","%ZVEMOU",103,0)
 I "^"[VRRS S FLAGQ=1 Q
"RTN","%ZVEMOU",104,0)
 I '$D(TEMP(VRRS)) W "   Enter number of your choice." G HOTRTN1
"RTN","%ZVEMOU",105,0)
 I VRRS=TEMP W $C(7),"   You're already in this routine.." G HOTRTN1
"RTN","%ZVEMOU",106,0)
 Q
"RTN","%ZVEMOUM")
0^89^B6468509
"RTN","%ZVEMOUM",1,0)
%ZVEMOUM ;DJB,VRROLD**Messages [12/31/94]
"RTN","%ZVEMOUM",2,0)
 ;;7.0;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMOUM",3,0)
 ;
"RTN","%ZVEMOUM",4,0)
MSG1(NUM,PAUSE) ;Clear 21 to bottom. Write msg on 21. Leave cursor on 21
"RTN","%ZVEMOUM",5,0)
 ;NUM=Subroutine number  PAUSE=Pause screen
"RTN","%ZVEMOUM",6,0)
 Q:$G(NUM)'>0  D BOTTOM^%ZVEMOU
"RTN","%ZVEMOUM",7,0)
 S DX=0,DY=21 X VEES("CRSR") D @NUM
"RTN","%ZVEMOUM",8,0)
 I $G(PAUSE) S DY=DY+1 X VEES("CRSR") D PAUSE^%ZVEMKU(0)
"RTN","%ZVEMOUM",9,0)
 S DY=21 X VEES("CRSR")
"RTN","%ZVEMOUM",10,0)
 Q
"RTN","%ZVEMOUM",11,0)
MSG2(NUM,PAUSE) ;Clear 21 to bottom. Write msg on 22. Leave cursor on 21
"RTN","%ZVEMOUM",12,0)
 ;NUM=Subroutine number  PAUSE=Pause screen
"RTN","%ZVEMOUM",13,0)
 Q:$G(NUM)'>0  D BOTTOM^%ZVEMOU
"RTN","%ZVEMOUM",14,0)
 S DX=0,DY=22 X VEES("CRSR") D @NUM
"RTN","%ZVEMOUM",15,0)
 I $G(PAUSE) S DY=DY+1 X VEES("CRSR") D PAUSE^%ZVEMKU(0)
"RTN","%ZVEMOUM",16,0)
 S DY=21 X VEES("CRSR")
"RTN","%ZVEMOUM",17,0)
 Q
"RTN","%ZVEMOUM",18,0)
MSGS(NUM,PAUSE) ;Clear 22 to bottom. Write msg on 22. Leave cursor on 22.
"RTN","%ZVEMOUM",19,0)
 ;NUM=Subroutine #
"RTN","%ZVEMOUM",20,0)
 Q:$G(NUM)'>0  D BOTTOM1^%ZVEMOU D @NUM
"RTN","%ZVEMOUM",21,0)
 I $G(PAUSE) S DY=DY+1 X VEES("CRSR") D PAUSE^%ZVEMKU(0)
"RTN","%ZVEMOUM",22,0)
 S DX=0,DY=22 X VEES("CRSR")
"RTN","%ZVEMOUM",23,0)
 Q
"RTN","%ZVEMOUM",24,0)
 ;====================================================================
"RTN","%ZVEMOUM",25,0)
1 W ?1,"Select from menu bar above." Q
"RTN","%ZVEMOUM",26,0)
2 W $C(7),?1,"Invalid line number" Q
"RTN","%ZVEMOUM",27,0)
3 W $C(7),?1,"Invalid selection" Q
"RTN","%ZVEMOUM",28,0)
4 W ?1,"GOTO: 'n'=Line number  MK=Mark  <TAB>=Cursor" Q
"RTN","%ZVEMOUM",29,0)
5 W $C(7),?1,"No editing. " D  Q
"RTN","%ZVEMOUM",30,0)
 . I $G(VRRS)>1 W "You've branched to another Program." Q
"RTN","%ZVEMOUM",31,0)
 . I $G(FLAGVPE)'["EDIT" W "You're using the Routine Reader." Q
"RTN","%ZVEMOUM",32,0)
 . I $G(FLAGHOT)="YES" W "HOT KEY is active." Q
"RTN","%ZVEMOUM",33,0)
6 W $C(7),?1,"You haven't Marked any lines" Q
"RTN","%ZVEMOUM",34,0)
7 W $C(7),?1,"You can't Branch to more than 4 programs" Q
"RTN","%ZVEMOUM",35,0)
8 W $C(7),?1,"Invalid Line Tag" Q
"RTN","%ZVEMOUM",36,0)
9 W $C(7),?1,"Line Tag has an invalid subscript" Q
"RTN","%ZVEMOUM",37,0)
10 W $C(7),?1,"Illegal Line" Q
"RTN","%ZVEMOUM",38,0)
11 W $C(7),?1,"Code length may not exceed 245 characters" Q
"RTN","%ZVEMOUM",39,0)
 ;
"RTN","%ZVEMOUM",40,0)
12 W ?1,"Enter line number (1 to ",VRRHIGH,"), a range (2-6), or <TAB> for HIGHLIGHT line." Q
"RTN","%ZVEMOUM",41,0)
13 W $C(7),?1,"Invalid RANGE" Q
"RTN","%ZVEMOUM",42,0)
14 W ?1,"Enter line number from 1 to ",VRRHIGH,", or <TAB> to select CURSOR line." Q
"RTN","%ZVEMOUM",43,0)
15 W ?1,"Enter code you wish inserted. Use <TAB> as a line start character." Q
"RTN","%ZVEMOUM",44,0)
16 W $C(7),?1,"No match" Q
"RTN","%ZVEMOUM",45,0)
17 W ?1,"The line will be broken AFTER the code you enter" Q
"RTN","%ZVEMOUM",46,0)
18 W $C(7),?1,"Line numbers can't match" Q
"RTN","%ZVEMOUM",47,0)
19 W $C(7),?1,"Joined line would be too long" Q
"RTN","%ZVEMOY")
0^90^B6885681
"RTN","%ZVEMOY",1,0)
%ZVEMOY ;DJB,VRROLD**Init,Branching,Error ; 9/6/02 8:15am
"RTN","%ZVEMOY",2,0)
 ;;7.0;VPE;COPYRIGHT David Bolduc @1993;;Build 8
"RTN","%ZVEMOY",3,0)
 ;
"RTN","%ZVEMOY",4,0)
INIT ;Initialize variables
"RTN","%ZVEMOY",5,0)
 S VRRS=$S($G(VRRS)="":1,1:(VRRS+1)) ;VRRS=# of prgrms you are viewing
"RTN","%ZVEMOY",6,0)
 S (PGTOP,START,VRRSP)=1 ;VRRSP sets single spacing as default
"RTN","%ZVEMOY",7,0)
 D INIT^%ZVEMKY
"RTN","%ZVEMOY",8,0)
 S $P(VRRLINE,"=",212)="",VRRLINE="|"_$E(VRRLINE,2,8)_"|"_$E(VRRLINE,10,(VEE("IOM")-1))_"|"
"RTN","%ZVEMOY",9,0)
 Q:$G(FLAGVPE)["VRR"
"RTN","%ZVEMOY",10,0)
 I $D(VEE("OS"))#2=0 D OS^%ZVEMKY Q:FLAGQ
"RTN","%ZVEMOY",11,0)
 I $D(VEE("TRMON"))#2=0 D TRMREAD^%ZVEMKY1
"RTN","%ZVEMOY",12,0)
 D REVVID^%ZVEMKY2
"RTN","%ZVEMOY",13,0)
 D BS^%ZVEMKY1
"RTN","%ZVEMOY",14,0)
 D SCRNVAR^%ZVEMKY2
"RTN","%ZVEMOY",15,0)
 D BLANK^%ZVEMKY3
"RTN","%ZVEMOY",16,0)
 Q
"RTN","%ZVEMOY",17,0)
VGL ;Run the VGlobal Lister
"RTN","%ZVEMOY",18,0)
 I $G(VRRS)>2 D  D PAUSE^%ZVEMKC(1) Q
"RTN","%ZVEMOY",19,0)
 . W $C(7),!?1,"You can't call VGL if you've branched to more than 2 programs."
"RTN","%ZVEMOY",20,0)
 I $G(DUZ(0))'["@",$G(DUZ(0))'["#" D  D PAUSE^%ZVEMKC(1) Q
"RTN","%ZVEMOY",21,0)
 . W $C(7),!?1,"You don't have access. See Help option."
"RTN","%ZVEMOY",22,0)
 I '$$EXIST^%ZVEMKU("%ZVEMG") D  D PAUSE^%ZVEMKC(1) Q
"RTN","%ZVEMOY",23,0)
 . W $C(7),!?1,"You don't have the 'VGlobal Lister' Routines."
"RTN","%ZVEMOY",24,0)
 D SYMTAB^%ZVEMKST("C","VRR",VRRS) ;Clear symbol table
"RTN","%ZVEMOY",25,0)
 D RUN^%ZVEMOU("^%ZVEMG")
"RTN","%ZVEMOY",26,0)
 D SYMTAB^%ZVEMKST("R","VRR",VRRS) ;Restore symbol table
"RTN","%ZVEMOY",27,0)
 Q
"RTN","%ZVEMOY",28,0)
VEDD ;Call VEDD, VElectronic Data Dictionary
"RTN","%ZVEMOY",29,0)
 I $G(VRRS)>2 D  D PAUSE^%ZVEMKC(1) Q
"RTN","%ZVEMOY",30,0)
 . W $C(7),!?1,"You can't call VEDD if you've branched to more than 2 programs."
"RTN","%ZVEMOY",31,0)
 I '$$EXIST^%ZVEMKU("%ZVEMD") D  D PAUSE^%ZVEMKC(1) Q
"RTN","%ZVEMOY",32,0)
 . W $C(7),!?1,"You don't have the 'VElectronic Data Dictionary' Routines."
"RTN","%ZVEMOY",33,0)
 D SYMTAB^%ZVEMKST("C","VRR",VRRS) ;Clear symbol table
"RTN","%ZVEMOY",34,0)
 D RUN^%ZVEMOU("DIR^%ZVEMD")
"RTN","%ZVEMOY",35,0)
 D SYMTAB^%ZVEMKST("R","VRR",VRRS) ;Restore symbol table
"RTN","%ZVEMOY",36,0)
 Q
"RTN","%ZVEMOY",37,0)
RSE ;Search Routine for string(s)
"RTN","%ZVEMOY",38,0)
 I $G(VRRS)>2 D  D PAUSE^%ZVEMKC(1) Q
"RTN","%ZVEMOY",39,0)
 . W $C(7),!?1,"You can't do Routine Search if you've branched to more than 2 programs."
"RTN","%ZVEMOY",40,0)
 D ^%ZVEMOSS
"RTN","%ZVEMOY",41,0)
 Q
"RTN","%ZVEMOY",42,0)
ERROR ;Error trap.
"RTN","%ZVEMOY",43,0)
 NEW ZE
"RTN","%ZVEMOY",44,0)
 S @("ZE="_VEE("$ZE"))
"RTN","%ZVEMOY",45,0)
 I $G(VRRS)>0 D
"RTN","%ZVEMOY",46,0)
 . I $G(FLAGVPE)'["EDIT"!(VRRS>1) KILL ^TMP("VEE","VRR",$J,VRRS)
"RTN","%ZVEMOY",47,0)
 S FLAGQ=1 I ZE["<INRPT>" W !!?1,"....Interrupted.",!! Q
"RTN","%ZVEMOY",48,0)
 D ERRMSG^%ZVEMKU1("VRR"),PAUSE^%ZVEMKU(2)
"RTN","%ZVEMOY",49,0)
 S VRRS=VRRS-1 Q:VRRS  X VEES("RM80")
"RTN","%ZVEMOY",50,0)
 KILL:$G(FLAGVPE)'["EDIT" ^TMP("VEE","VRR",$J)
"RTN","%ZVEMOY",51,0)
 Q
"RTN","%ZVEMR")
0^91^B16523829
"RTN","%ZVEMR",1,0)
%ZVEMR ;DJB,VRR**SCROLL VRoutine Reader ; 9/4/02 1:10pm
"RTN","%ZVEMR",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMR",3,0)
 ;
"RTN","%ZVEMR",4,0)
EN ;Entry Point
"RTN","%ZVEMR",5,0)
 I $G(DUZ)'>0 D ID^%ZVEMKU Q:$G(DUZ)=""
"RTN","%ZVEMR",6,0)
 NEW X S X="ERROR^%ZVEMRY",@($$TRAP^%ZVEMKU1) KILL X
"RTN","%ZVEMR",7,0)
START ;
"RTN","%ZVEMR",8,0)
 NEW CD,CDHLD,DX,DY,XCHAR,XCUR,YCUR,YND
"RTN","%ZVEMR",9,0)
 NEW FLAGGLB,FLAGMODE,FLAGQ,I,VEET,VRRFIND,VRRHIGH,VRRPGM
"RTN","%ZVEMR",10,0)
 I $G(VEELINE)="" NEW VEEIOST,VEELINE,VEELINE1,VEELINE2,VEESIZE,VEEX,VEEY
"RTN","%ZVEMR",11,0)
 ;
"RTN","%ZVEMR",12,0)
 ;FLAGVPE="VEDD^VGL^VRR^EDIT"
"RTN","%ZVEMR",13,0)
 I '$D(FLAGVPE) NEW FLAGVPE
"RTN","%ZVEMR",14,0)
 I $G(FLAGVPE)'["VRR" NEW VEES,VRRS
"RTN","%ZVEMR",15,0)
 I $G(FLAGVPE)'["EDIT",$D(VEE("OS"))#2=0 NEW VEE ;...Mumps system
"RTN","%ZVEMR",16,0)
 ;
"RTN","%ZVEMR",17,0)
 S FLAGQ=0
"RTN","%ZVEMR",18,0)
 D INIT^%ZVEMRY G:FLAGQ EX
"RTN","%ZVEMR",19,0)
 I $G(FLAGVPE)'["EDIT"!(VRRS>1) NEW FLAGSAVE
"RTN","%ZVEMR",20,0)
 X VEES("RM0")
"RTN","%ZVEMR",21,0)
 S $P(FLAGVPE,"^",3)="VRR" ;...Marks VRR as running
"RTN","%ZVEMR",22,0)
 S FLAGMODE="" ;...............BLOCK,WEB modes
"RTN","%ZVEMR",23,0)
 D EN^%ZVEMRS G:FLAGQ EX ;.....Get Program
"RTN","%ZVEMR",24,0)
 D LIBRARY^%ZVEMRLU(VRRPGM) ;..Is it signed out of Rtn Library?
"RTN","%ZVEMR",25,0)
 ;FLAGGLB: Used to select global from screen
"RTN","%ZVEMR",26,0)
TOP ;
"RTN","%ZVEMR",27,0)
 X VEES("RM0")
"RTN","%ZVEMR",28,0)
 D IMPORT
"RTN","%ZVEMR",29,0)
 D SCROLL^%ZVEMKT2(1)
"RTN","%ZVEMR",30,0)
 D LIST
"RTN","%ZVEMR",31,0)
 D ENDSCR^%ZVEMKT2
"RTN","%ZVEMR",32,0)
EX ;
"RTN","%ZVEMR",33,0)
 I $G(FLAGVPE)'["EDIT" D  Q
"RTN","%ZVEMR",34,0)
 . KILL ^TMP("VEE","VRR",$J,VRRS),^TMP("VEE","IR"_VRRS,$J)
"RTN","%ZVEMR",35,0)
 . S VRRS=VRRS-1 Q:VRRS>1
"RTN","%ZVEMR",36,0)
 . X $G(VEES("RM80"))
"RTN","%ZVEMR",37,0)
 . W @(VEES("WRAP"))
"RTN","%ZVEMR",38,0)
 ;Editing
"RTN","%ZVEMR",39,0)
 I VRRS>1 D  ;Unlock rtn if not a duplicate
"RTN","%ZVEMR",40,0)
 . NEW CHK,I,PGM
"RTN","%ZVEMR",41,0)
 . S PGM=$G(^TMP("VEE","VRR",$J,VRRS,"NAME"))
"RTN","%ZVEMR",42,0)
 . S CHK=0
"RTN","%ZVEMR",43,0)
 . F I=1:1 Q:'$D(^TMP("VEE","VRR",$J,I,"NAME"))  D  ;
"RTN","%ZVEMR",44,0)
 .. I I'=VRRS,^("NAME")=PGM S CHK=1
"RTN","%ZVEMR",45,0)
 . I 'CHK,PGM]"" L -VRRLOCK(PGM)
"RTN","%ZVEMR",46,0)
 . KILL ^TMP("VEE","VRR",$J,VRRS)
"RTN","%ZVEMR",47,0)
 . KILL ^TMP("VEE","IR"_VRRS,$J)
"RTN","%ZVEMR",48,0)
 S VRRS=VRRS-1
"RTN","%ZVEMR",49,0)
 Q:VRRS>0
"RTN","%ZVEMR",50,0)
 W @(VEES("WRAP"))
"RTN","%ZVEMR",51,0)
 X $G(VEES("RM80"))
"RTN","%ZVEMR",52,0)
 Q
"RTN","%ZVEMR",53,0)
 ;
"RTN","%ZVEMR",54,0)
GETVEET ;Set VEET=Display text
"RTN","%ZVEMR",55,0)
 I $D(^TMP("VEE","IR"_VRRS,$J,VEET("BOT"))) S VEET=^(VEET("BOT")) Q
"RTN","%ZVEMR",56,0)
 S (VEET,^TMP("VEE","IR"_VRRS,$J,VEET("BOT")))=" <> <> <>"
"RTN","%ZVEMR",57,0)
 Q
"RTN","%ZVEMR",58,0)
 ;
"RTN","%ZVEMR",59,0)
LIST ;Display text
"RTN","%ZVEMR",60,0)
 D GETVEET
"RTN","%ZVEMR",61,0)
 W !,$P(VEET,$C(30),1)
"RTN","%ZVEMR",62,0)
 W $P(VEET,$C(30),2,99)
"RTN","%ZVEMR",63,0)
 S VEET("BOT")=VEET("BOT")+1 ;Bottom line #
"RTN","%ZVEMR",64,0)
 S:VEET("GAP") VEET("GAP")=VEET("GAP")-1 ;Empty lines left on page
"RTN","%ZVEMR",65,0)
 I VEET=" <> <> <>"!'VEET("GAP") D READ^%ZVEMRE Q:FLAGQ
"RTN","%ZVEMR",66,0)
 G LIST
"RTN","%ZVEMR",67,0)
 ;
"RTN","%ZVEMR",68,0)
IMPORT ;Set up for scroller
"RTN","%ZVEMR",69,0)
 NEW LINE,MAR,NAME,SPACE,TMP
"RTN","%ZVEMR",70,0)
 S VRRHIGH=+$G(VRRHIGH)
"RTN","%ZVEMR",71,0)
 S MAR=$G(VEE("IOM")) S:MAR'>0 MAR=80
"RTN","%ZVEMR",72,0)
 S $P(LINE,"=",MAR)=""
"RTN","%ZVEMR",73,0)
 S SPACE="          "
"RTN","%ZVEMR",74,0)
 S NAME=$E($G(^TMP("VEE","VRR",$J,VRRS,"NAME")),1,8)
"RTN","%ZVEMR",75,0)
 S NAME=NAME_$E(SPACE,1,8-$L(NAME))
"RTN","%ZVEMR",76,0)
 S VEET("HD")=1
"RTN","%ZVEMR",77,0)
 S VEET("FT")=2
"RTN","%ZVEMR",78,0)
 S VEET("HD",1)="|=======|"_$E(LINE,1,11)_"[^"_NAME_"]======["_VRRS_" of 4]======[Lines: "_VRRHIGH_$E("    ",1,3-$L(VRRHIGH))_"]"_$E(LINE,1,MAR-65)_"|"
"RTN","%ZVEMR",79,0)
 S VEET("FT",1)="|=======|"_$E(LINE,1,MAR-11)_"|"
"RTN","%ZVEMR",80,0)
 S VEET("FT",2)="<>  <TAB>=MenuBar  <F3>=Block  <RET>=Insert  <ESC>K=Keybrd  <ESC><ESC>=Quit"
"RTN","%ZVEMR",81,0)
 S VEET("GET")=1
"RTN","%ZVEMR",82,0)
 D INIT^%ZVEMKT
"RTN","%ZVEMR",83,0)
 D INIT1^%ZVEMKT
"RTN","%ZVEMR",84,0)
 D INIT2^%ZVEMKT
"RTN","%ZVEMR",85,0)
 S TMP=$G(^TMP("VEE","IR"_VRRS,$J,1))
"RTN","%ZVEMR",86,0)
 S XCUR=9,(YCUR,YND)=1
"RTN","%ZVEMR",87,0)
 I $G(%2)]"" D MOVETO
"RTN","%ZVEMR",88,0)
 ;--> Adj for $C(30)
"RTN","%ZVEMR",89,0)
 I TMP[$C(30) S XCUR=$F(TMP,$C(30))-2
"RTN","%ZVEMR",90,0)
 Q
"RTN","%ZVEMR",91,0)
 ;
"RTN","%ZVEMR",92,0)
MOVETO ;Adjust YND/YCUR to move to a passed in line tag.
"RTN","%ZVEMR",93,0)
 NEW CHK,CNT,LINE,NUM,TAG
"RTN","%ZVEMR",94,0)
 S (CHK,CNT,NUM)=0
"RTN","%ZVEMR",95,0)
 F  S CNT=$O(^TMP("VEE","IR"_VRRS,$J,CNT)) Q:'CNT!CHK  D  ;
"RTN","%ZVEMR",96,0)
 . S NUM=NUM+1
"RTN","%ZVEMR",97,0)
 . S LINE=^(CNT)
"RTN","%ZVEMR",98,0)
 . Q:(LINE'[$C(30))
"RTN","%ZVEMR",99,0)
 . S TAG=$P(LINE,$C(30),1)
"RTN","%ZVEMR",100,0)
 . Q:$E(TAG)?1N
"RTN","%ZVEMR",101,0)
 . S TAG=$P(TAG,"(",1)
"RTN","%ZVEMR",102,0)
 . ;Strip leading spaces
"RTN","%ZVEMR",103,0)
 . F  Q:$E(TAG)'=" "  S TAG=$E(TAG,2,$L(TAG))
"RTN","%ZVEMR",104,0)
 . ;Strip trailing spaces
"RTN","%ZVEMR",105,0)
 . F  Q:$E(TAG,$L(TAG))'=" "  S TAG=$E(TAG,1,$L(TAG)-1)
"RTN","%ZVEMR",106,0)
 . S:TAG=$G(%2) CHK=1
"RTN","%ZVEMR",107,0)
 I CHK S (VEET("BOT"),VEET("TOP"),YND)=NUM
"RTN","%ZVEMR",108,0)
 Q
"RTN","%ZVEMR",109,0)
 ;
"RTN","%ZVEMR",110,0)
PARAM(RTN,TAG) ;Parameter Passing....X=Routine Name
"RTN","%ZVEMR",111,0)
 S RTN=$G(RTN),TAG=$G(TAG)
"RTN","%ZVEMR",112,0)
 G:RTN="" EN
"RTN","%ZVEMR",113,0)
 S ^TMP("VEE",$J)=RTN_"^"_TAG
"RTN","%ZVEMR",114,0)
 I $G(DUZ)'>0 D ID^%ZVEMKU I $G(DUZ)="" KILL ^TMP("VEE",$J) Q
"RTN","%ZVEMR",115,0)
 ;
"RTN","%ZVEMR",116,0)
 NEW FLAGPRM,%1,%2
"RTN","%ZVEMR",117,0)
 S FLAGPRM=1
"RTN","%ZVEMR",118,0)
 S %1=$P(^TMP("VEE",$J),"^",1) ;Routine
"RTN","%ZVEMR",119,0)
 S %2=$P(^TMP("VEE",$J),"^",2) ;Tag
"RTN","%ZVEMR",120,0)
 KILL ^TMP("VEE",$J)
"RTN","%ZVEMR",121,0)
 G EN
"RTN","%ZVEMRC")
0^92^B11499880
"RTN","%ZVEMRC",1,0)
%ZVEMRC ;DJB,VRR**Saves editing changes ; 9/5/02 12:14pm
"RTN","%ZVEMRC",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMRC",3,0)
 ;
"RTN","%ZVEMRC",4,0)
SAVE(ND) ;Sets up ^UTILITY so rtn editor can save changes.
"RTN","%ZVEMRC",5,0)
 ;ND=Rtn Session # (VRRS)
"RTN","%ZVEMRC",6,0)
 ;If VRRPGM is defined, Editor will save edited routine to @VRRPGM.
"RTN","%ZVEMRC",7,0)
 ;If VRRPGM="" changes aren't saved.
"RTN","%ZVEMRC",8,0)
 ;If VRRLBRY=1, Editor will run Library & Versioning.
"RTN","%ZVEMRC",9,0)
 ;If VRRNODT=1, Editor will bypass adjusting date on top line.
"RTN","%ZVEMRC",10,0)
 ;
"RTN","%ZVEMRC",11,0)
 NEW CD,FLAGQ,LN,TG,TMP,XX
"RTN","%ZVEMRC",12,0)
 NEW VRRLBRY,VRRNODT
"RTN","%ZVEMRC",13,0)
 ;
"RTN","%ZVEMRC",14,0)
 S (FLAGQ,VRRLBRY,VRRNODT)=0
"RTN","%ZVEMRC",15,0)
 D INIT
"RTN","%ZVEMRC",16,0)
 I FLAGQ D MSG1 G EX
"RTN","%ZVEMRC",17,0)
 S:$G(ND)'>0 ND=1
"RTN","%ZVEMRC",18,0)
 S VRRPGM=$G(^TMP("VEE","VRR",$J,ND,"NAME"))
"RTN","%ZVEMRC",19,0)
 I VRRPGM']"" D MSG1 G EX
"RTN","%ZVEMRC",20,0)
 X VEES("RM0")
"RTN","%ZVEMRC",21,0)
 D CONVERT^%ZVEMRV(ND)
"RTN","%ZVEMRC",22,0)
 S TMP=$G(^UTILITY($J,0,1))
"RTN","%ZVEMRC",23,0)
 I TMP']""!(TMP=" <> <> <>") D MSG1 G EX
"RTN","%ZVEMRC",24,0)
 S TG=$P(TMP," ",1)
"RTN","%ZVEMRC",25,0)
 S LN=$P(TMP," ",2,99)
"RTN","%ZVEMRC",26,0)
 ;
"RTN","%ZVEMRC",27,0)
 D ASK I VRRPGM="" D MSG1 G EX
"RTN","%ZVEMRC",28,0)
 D DATE ;Update date on top line
"RTN","%ZVEMRC",29,0)
 D MSG ;Display message
"RTN","%ZVEMRC",30,0)
 ;
"RTN","%ZVEMRC",31,0)
 I VRRLBRY=1 D  ;
"RTN","%ZVEMRC",32,0)
 . D ADD^%ZVEMRLU(VRRPGM) ;Routine Library
"RTN","%ZVEMRC",33,0)
 . D ADD^%ZVEMRLV(VRRPGM) ;Routine Versioning
"RTN","%ZVEMRC",34,0)
 ;
"RTN","%ZVEMRC",35,0)
EX ;
"RTN","%ZVEMRC",36,0)
 KILL ^TMP("VEE","VRR",$J)
"RTN","%ZVEMRC",37,0)
 KILL ^TMP("VEE","IR1",$J)
"RTN","%ZVEMRC",38,0)
 X VEES("RM80")
"RTN","%ZVEMRC",39,0)
 Q
"RTN","%ZVEMRC",40,0)
 ;
"RTN","%ZVEMRC",41,0)
MSG ;Routine saved
"RTN","%ZVEMRC",42,0)
 W !!,"^",VRRPGM," saved to disk."
"RTN","%ZVEMRC",43,0)
 W:$G(VRRNODT) !,"Date on top line not updated."
"RTN","%ZVEMRC",44,0)
 W !
"RTN","%ZVEMRC",45,0)
 Q
"RTN","%ZVEMRC",46,0)
 ;
"RTN","%ZVEMRC",47,0)
MSG1 ;Routine not saved
"RTN","%ZVEMRC",48,0)
 S VRRPGM=""
"RTN","%ZVEMRC",49,0)
 W !!,"Changes not saved.",!
"RTN","%ZVEMRC",50,0)
 Q
"RTN","%ZVEMRC",51,0)
 ;
"RTN","%ZVEMRC",52,0)
ASK ;Ask to save changes
"RTN","%ZVEMRC",53,0)
 NEW DEFAULT
"RTN","%ZVEMRC",54,0)
 S DEFAULT=$S($G(FLAGSAVE)>0:2,1:1)
"RTN","%ZVEMRC",55,0)
 W !,"Routine: ^",VRRPGM,!,"Save your changes?",!!
"RTN","%ZVEMRC",56,0)
 S XX=$$CHOICE^%ZVEMKC("QUIT^SAVE^SAVE_AS^SAVE_NODT",DEFAULT)
"RTN","%ZVEMRC",57,0)
 I XX<2 S VRRPGM="" Q
"RTN","%ZVEMRC",58,0)
 D:XX=3 SAVEAS
"RTN","%ZVEMRC",59,0)
 S:XX=4 VRRNODT=1
"RTN","%ZVEMRC",60,0)
 S VRRLBRY=1 ;Library & Versioning
"RTN","%ZVEMRC",61,0)
 Q
"RTN","%ZVEMRC",62,0)
 ;
"RTN","%ZVEMRC",63,0)
SAVEAS ;Save routine to a new name
"RTN","%ZVEMRC",64,0)
 NEW SUBSCRIP W !
"RTN","%ZVEMRC",65,0)
SAVEAS1 W !,"Save as routine: ^"
"RTN","%ZVEMRC",66,0)
 R VRRPGM:300 S:'$T VRRPGM="^" I "^"[VRRPGM S VRRPGM="" Q
"RTN","%ZVEMRC",67,0)
 I $E(VRRPGM)="?" D  G SAVEAS1
"RTN","%ZVEMRC",68,0)
 . W "   Enter new name for this edited routine"
"RTN","%ZVEMRC",69,0)
 I $E(VRRPGM)="^" S VRRPGM=$E(VRRPGM,2,99)
"RTN","%ZVEMRC",70,0)
 I VRRPGM'?1A.7AN,VRRPGM'?1"%"1A.6AN D  G SAVEAS1
"RTN","%ZVEMRC",71,0)
 . W $C(7),"   Invalid routine name."
"RTN","%ZVEMRC",72,0)
 I $$EXIST^%ZVEMKU(VRRPGM) D EXISTS I VRRPGM']"" W ! G SAVEAS1
"RTN","%ZVEMRC",73,0)
 S SUBSCRIP=$S(TG'["(":"",1:"("_$P(TG,"(",2,99))
"RTN","%ZVEMRC",74,0)
 S TG=VRRPGM_SUBSCRIP
"RTN","%ZVEMRC",75,0)
 S ^UTILITY($J,0,1)=TG_" "_LN
"RTN","%ZVEMRC",76,0)
 Q
"RTN","%ZVEMRC",77,0)
 ;
"RTN","%ZVEMRC",78,0)
EXISTS ;Routine already exists
"RTN","%ZVEMRC",79,0)
 W $C(7),!!?3,"WARNING...Routine ^",VRRPGM," already exists."
"RTN","%ZVEMRC",80,0)
 W !?3,"Shall I overwrite?"
"RTN","%ZVEMRC",81,0)
 S XX=$$CHOICE^%ZVEMKC("YES^NO",1)
"RTN","%ZVEMRC",82,0)
 I XX'=1 S VRRPGM=""
"RTN","%ZVEMRC",83,0)
 Q
"RTN","%ZVEMRC",84,0)
 ;
"RTN","%ZVEMRC",85,0)
DATE ;Attach date to top line
"RTN","%ZVEMRC",86,0)
 ;
"RTN","%ZVEMRC",87,0)
 ;Don't update date on routine's top line.
"RTN","%ZVEMRC",88,0)
 I $G(VEENODT)!$G(VRRNODT) Q
"RTN","%ZVEMRC",89,0)
 ;
"RTN","%ZVEMRC",90,0)
 NEW DATE,PIECE,TIME,TMP
"RTN","%ZVEMRC",91,0)
 Q:'$D(^UTILITY($J,0,1))  S TMP=^(1)
"RTN","%ZVEMRC",92,0)
 ;
"RTN","%ZVEMRC",93,0)
 ;Don't attach date if top line doesn't start with ";"
"RTN","%ZVEMRC",94,0)
 I $E($P(TMP," ",2),1)'=";" Q
"RTN","%ZVEMRC",95,0)
 ;
"RTN","%ZVEMRC",96,0)
 S DATE=$$DATE^%ZVEMKDT(2)
"RTN","%ZVEMRC",97,0)
 S TIME=$$TIME^%ZVEMKDT(2)
"RTN","%ZVEMRC",98,0)
 I $E(TIME)=" " S TIME=$E(TIME,2,99)
"RTN","%ZVEMRC",99,0)
 ;
"RTN","%ZVEMRC",100,0)
 ;New date format - ; 3/2/98 1:40pm
"RTN","%ZVEMRC",101,0)
 S PIECE=$L(LN," ;")
"RTN","%ZVEMRC",102,0)
 I PIECE>1 S LN=$P(LN," ;",1,PIECE-1)
"RTN","%ZVEMRC",103,0)
 ;
"RTN","%ZVEMRC",104,0)
 ;Old date format - [3/2/98 1:40pm]
"RTN","%ZVEMRC",105,0)
 E  S PIECE=$L(LN," [") I PIECE>1 D  ;
"RTN","%ZVEMRC",106,0)
 . Q:$P(LN," [",PIECE)'?1.2N1"/"1.2N1"/"2N.E1."]"
"RTN","%ZVEMRC",107,0)
 . S LN=$P(LN," [",1,PIECE-1)
"RTN","%ZVEMRC",108,0)
 ;
"RTN","%ZVEMRC",109,0)
 S LN=LN_" ; "_DATE_" "_TIME
"RTN","%ZVEMRC",110,0)
 S ^UTILITY($J,0,1)=TG_" "_LN
"RTN","%ZVEMRC",111,0)
 Q
"RTN","%ZVEMRC",112,0)
 ;
"RTN","%ZVEMRC",113,0)
INIT ;
"RTN","%ZVEMRC",114,0)
 I '$D(VEE("OS")) D OS^%ZVEMKY Q:FLAGQ
"RTN","%ZVEMRC",115,0)
 D ZSAVE^%ZVEMKY3 Q:FLAGQ
"RTN","%ZVEMRC",116,0)
 D SCRNVAR^%ZVEMKY2
"RTN","%ZVEMRC",117,0)
 D REVVID^%ZVEMKY2
"RTN","%ZVEMRC",118,0)
 Q
"RTN","%ZVEMRE")
0^93^B20271610
"RTN","%ZVEMRE",1,0)
%ZVEMRE ;DJB,VRR**EDIT - READ,UP,DOWN,LEFT,RIGHT ; 9/24/02 7:55am
"RTN","%ZVEMRE",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMRE",3,0)
 ;
"RTN","%ZVEMRE",4,0)
READ ;Get input
"RTN","%ZVEMRE",5,0)
 NEW X S X="ERROR1^%ZVEMRY",@($$TRAP^%ZVEMKU1) KILL X
"RTN","%ZVEMRE",6,0)
 NEW DIRHLD,KEY,QUIT,TMP,VK
"RTN","%ZVEMRE",7,0)
 I VEET("GAP"),YCUR>(VEET("BOT")-VEET("TOP")) D  ;
"RTN","%ZVEMRE",8,0)
 . S YCUR=VEET("BOT")-VEET("TOP"),YND=VEET("TOP")+YCUR-1
"RTN","%ZVEMRE",9,0)
 D HIGHON
"RTN","%ZVEMRE",10,0)
READ1 ;
"RTN","%ZVEMRE",11,0)
 S QUIT=0
"RTN","%ZVEMRE",12,0)
 S KEY=$$READ^%ZVEMKRN("",1),VK=$G(VEE("K"))
"RTN","%ZVEMRE",13,0)
 ;
"RTN","%ZVEMRE",14,0)
WEB I FLAGMODE["WEB",VK="<F3>" D WEB^%ZVEMREW G READ1 ;Insert HTML tags
"RTN","%ZVEMRE",15,0)
 ;
"RTN","%ZVEMRE",16,0)
 ;===================================================================
"RTN","%ZVEMRE",17,0)
BLOCK I FLAGMODE["BLOCK" D  Q:QUIT  G READ1
"RTN","%ZVEMRE",18,0)
 . I $G(FLAGVPE)'["EDIT",$G(FLAGVPE)'["LBRY" D MSG^%ZVEMRUM(5) Q
"RTN","%ZVEMRE",19,0)
 . I VK="<AU>" D UP^%ZVEMRP Q
"RTN","%ZVEMRE",20,0)
 . I VK="<AD>" D DOWN^%ZVEMRP Q
"RTN","%ZVEMRE",21,0)
 . I VK="<AR>" D RIGHT^%ZVEMRP2 Q
"RTN","%ZVEMRE",22,0)
 . I VK="<AL>" D LEFT^%ZVEMRP2 Q
"RTN","%ZVEMRE",23,0)
 . I VK="<HOME>" D BULKUP^%ZVEMRP Q
"RTN","%ZVEMRE",24,0)
 . I VK="<END>" D BULKDN^%ZVEMRP Q
"RTN","%ZVEMRE",25,0)
 . I VK="<F3>" D BLOCK^%ZVEMRE2 Q
"RTN","%ZVEMRE",26,0)
 . I VK="<ESCC>" D BLOCK^%ZVEMRE2 Q
"RTN","%ZVEMRE",27,0)
 . I $G(FLAGVPE)["LBRY" Q  ;Reviewing a version
"RTN","%ZVEMRE",28,0)
 . I VK="<ESCD>" D BLOCK^%ZVEMRE2 Q
"RTN","%ZVEMRE",29,0)
 . I VK="<ESCV>" D BLOCK^%ZVEMRE2 Q
"RTN","%ZVEMRE",30,0)
 . I VK="<ESCX>" D BLOCK^%ZVEMRE2 Q
"RTN","%ZVEMRE",31,0)
 . I VK="<DEL>" D BLOCK^%ZVEMRE2 Q
"RTN","%ZVEMRE",32,0)
 . ;Any other key: Clear highlight lines and turn off Block mode.
"RTN","%ZVEMRE",33,0)
 . D CLEARALL^%ZVEMRP,BLOCK^%ZVEMRER()
"RTN","%ZVEMRE",34,0)
 I ",<F3>,<ESCD>,<ESCV>,"[(","_VK_",") D  Q:QUIT  G READ1
"RTN","%ZVEMRE",35,0)
 . I $G(FLAGVPE)["LBRY",VK="<F3>" D BLOCK^%ZVEMRE2 Q
"RTN","%ZVEMRE",36,0)
 . I $G(FLAGVPE)'["EDIT" D MSG^%ZVEMRUM(5) Q
"RTN","%ZVEMRE",37,0)
 . D BLOCK^%ZVEMRE2
"RTN","%ZVEMRE",38,0)
 ;===================================================================
"RTN","%ZVEMRE",39,0)
 I VK="<AU>" D UP(1) G READ1
"RTN","%ZVEMRE",40,0)
 I VK="<AD>" D DOWN(1) G READ1
"RTN","%ZVEMRE",41,0)
 I VK="<AL>" D LEFT G READ1
"RTN","%ZVEMRE",42,0)
 I VK="<AR>" D RIGHT G READ1
"RTN","%ZVEMRE",43,0)
 ;
"RTN","%ZVEMRE",44,0)
 D DO^%ZVEMRE1 Q:QUIT
"RTN","%ZVEMRE",45,0)
 G READ1
"RTN","%ZVEMRE",46,0)
 ;====================================================================
"RTN","%ZVEMRE",47,0)
ENDFILE() ;1=End-of-file  0=Ok
"RTN","%ZVEMRE",48,0)
 I VEET("GAP") W $C(7) Q 1
"RTN","%ZVEMRE",49,0)
 I ^TMP("VEE","IR"_VRRS,$J,VEET("BOT")-1)=" <> <> <>" W $C(7) Q 1
"RTN","%ZVEMRE",50,0)
 Q 0
"RTN","%ZVEMRE",51,0)
 ;
"RTN","%ZVEMRE",52,0)
TOPFILE() ;1=Top-of-file  0=Ok
"RTN","%ZVEMRE",53,0)
 I VEET("TOP")'>1 W $C(7) Q 1
"RTN","%ZVEMRE",54,0)
 Q 0
"RTN","%ZVEMRE",55,0)
 ;====================================================================
"RTN","%ZVEMRE",56,0)
UP(NUM) ;Scroll up NUM lines. Insert line at top.
"RTN","%ZVEMRE",57,0)
 NEW I,ND,TMP
"RTN","%ZVEMRE",58,0)
 I YCUR=1 Q:$$TOPFILE()
"RTN","%ZVEMRE",59,0)
 S NUM=$G(NUM) D HIGHOFF
"RTN","%ZVEMRE",60,0)
 I NUM=1 S YND=YND-1 D  D CURSOR("U"),HIGHON Q
"RTN","%ZVEMRE",61,0)
 . I YCUR>1 S YCUR=YCUR-1 Q
"RTN","%ZVEMRE",62,0)
 . D INSERT^%ZVEMRU(0,(VEET("S1")-2))
"RTN","%ZVEMRE",63,0)
 . S DX=0,DY=(VEET("S1")-1) X VEES("CRSR")
"RTN","%ZVEMRE",64,0)
 . S VEET("TOP")=VEET("TOP")-1
"RTN","%ZVEMRE",65,0)
 . S TMP=$G(^TMP("VEE","IR"_VRRS,$J,VEET("TOP")))
"RTN","%ZVEMRE",66,0)
 . W $P(TMP,$C(30),1),$P(TMP,$C(30),2,99)
"RTN","%ZVEMRE",67,0)
 I YCUR=1 W $C(7) Q
"RTN","%ZVEMRE",68,0)
 F I=1:1:NUM I YCUR>1 S YCUR=YCUR-1,YND=YND-1
"RTN","%ZVEMRE",69,0)
 D CURSOR("U"),HIGHON
"RTN","%ZVEMRE",70,0)
 Q
"RTN","%ZVEMRE",71,0)
 ;
"RTN","%ZVEMRE",72,0)
DOWN(NUM) ;Scroll down NUM lines. Insert line at bottom.
"RTN","%ZVEMRE",73,0)
 NEW I,TMP
"RTN","%ZVEMRE",74,0)
 I $G(^TMP("VEE","IR"_VRRS,$J,YND))=" <> <> <>" W $C(7) Q
"RTN","%ZVEMRE",75,0)
 S NUM=$G(NUM) D HIGHOFF
"RTN","%ZVEMRE",76,0)
 ;--> When cursor's at screen bottom:
"RTN","%ZVEMRE",77,0)
 I YCUR'<(VEET("BOT")-VEET("TOP")) D  D CURSOR("D"),HIGHON Q
"RTN","%ZVEMRE",78,0)
 . I NUM>1 W $C(7) Q  ;Don't allow cursor jump
"RTN","%ZVEMRE",79,0)
 . S YND=YND+1,VEET("BOT")=VEET("BOT")+1,VEET("TOP")=VEET("TOP")+1
"RTN","%ZVEMRE",80,0)
 . S TMP=$G(^TMP("VEE","IR"_VRRS,$J,YND))
"RTN","%ZVEMRE",81,0)
 . W !,$P(TMP,$C(30),1),$P(TMP,$C(30),2,99)
"RTN","%ZVEMRE",82,0)
 ;--> Move cursor down
"RTN","%ZVEMRE",83,0)
 F I=1:1:NUM Q:YCUR'<(VEET("BOT")-VEET("TOP"))  D  ;
"RTN","%ZVEMRE",84,0)
 . S YCUR=YCUR+1,YND=YND+1
"RTN","%ZVEMRE",85,0)
 D CURSOR("D"),HIGHON
"RTN","%ZVEMRE",86,0)
 Q
"RTN","%ZVEMRE",87,0)
 ;
"RTN","%ZVEMRE",88,0)
LEFT ;Cursor left/up
"RTN","%ZVEMRE",89,0)
 NEW ND KILL DIRHLD
"RTN","%ZVEMRE",90,0)
 Q:XCUR'>0
"RTN","%ZVEMRE",91,0)
 S ND=$G(^TMP("VEE","IR"_VRRS,$J,YND)) Q:ND=" <> <> <>"
"RTN","%ZVEMRE",92,0)
 I ND'[$C(30),XCUR<10 D  ;
"RTN","%ZVEMRE",93,0)
 . D UP(1) S XCUR=VEE("IOM")-2 ;.....................Move up a line
"RTN","%ZVEMRE",94,0)
 . S ND=$G(^TMP("VEE","IR"_VRRS,$J,YND)) ;...........Reset ND
"RTN","%ZVEMRE",95,0)
 I ND[$C(30) D  ;
"RTN","%ZVEMRE",96,0)
 . I XCUR<10,$P(ND,$C(30),1)?1.N1." " S XCUR=1 Q  ;..Jump over tag
"RTN","%ZVEMRE",97,0)
 S XCUR=XCUR-1,DX=XCUR X VEES("CRSR")
"RTN","%ZVEMRE",98,0)
 Q
"RTN","%ZVEMRE",99,0)
 ;
"RTN","%ZVEMRE",100,0)
RIGHT ;Cursor right/down
"RTN","%ZVEMRE",101,0)
 NEW ND,ND1 KILL DIRHLD
"RTN","%ZVEMRE",102,0)
 S ND=$G(^TMP("VEE","IR"_VRRS,$J,YND)),ND1=$G(^(YND+1))
"RTN","%ZVEMRE",103,0)
 Q:ND=" <> <> <>"
"RTN","%ZVEMRE",104,0)
 D  ;
"RTN","%ZVEMRE",105,0)
 . ;-->End of main line
"RTN","%ZVEMRE",106,0)
 . Q:(XCUR+2-(ND1[$C(30)))'>($L(ND)-(ND[$C(30)))
"RTN","%ZVEMRE",107,0)
 . ;-->End of rtn
"RTN","%ZVEMRE",108,0)
 . Q:(XCUR+2-(ND1=" <> <> <>"))'>($L(ND)-(ND[$C(30)))
"RTN","%ZVEMRE",109,0)
 . I ND1=" <> <> <>"!(ND1[$C(30)) S XCUR=XCUR-1 Q
"RTN","%ZVEMRE",110,0)
 . D DOWN(1) S XCUR=8 ;..............................Open new line
"RTN","%ZVEMRE",111,0)
 . S ND=$G(^TMP("VEE","IR"_VRRS,$J,YND)) ;...........Reset ND
"RTN","%ZVEMRE",112,0)
 I ND[$C(30) D  ;
"RTN","%ZVEMRE",113,0)
 . I XCUR<1,$P(ND,$C(30),1)?1.N1." " S XCUR=8 ;......Jump over tag
"RTN","%ZVEMRE",114,0)
 S XCUR=XCUR+1,DX=XCUR X VEES("CRSR")
"RTN","%ZVEMRE",115,0)
 Q
"RTN","%ZVEMRE",116,0)
 ;===================================================================
"RTN","%ZVEMRE",117,0)
HIGHON ;Draw highlite on right side of screen
"RTN","%ZVEMRE",118,0)
 S DX=VEE("IOM")-1,DY=YCUR X VEES("CRSR")
"RTN","%ZVEMRE",119,0)
 W @VEE("RON")
"RTN","%ZVEMRE",120,0)
 X VEES("XY") W " "
"RTN","%ZVEMRE",121,0)
 W @VEE("ROFF")
"RTN","%ZVEMRE",122,0)
 S DX=XCUR,DY=YCUR X VEES("CRSR")
"RTN","%ZVEMRE",123,0)
 Q
"RTN","%ZVEMRE",124,0)
 ;
"RTN","%ZVEMRE",125,0)
HIGHOFF ;Remove highlite from right side of screen
"RTN","%ZVEMRE",126,0)
 S DX=VEE("IOM")-1,DY=YCUR X VEES("CRSR")
"RTN","%ZVEMRE",127,0)
 W " "
"RTN","%ZVEMRE",128,0)
 Q
"RTN","%ZVEMRE",129,0)
 ;
"RTN","%ZVEMRE",130,0)
CURSOR(DIR) ;Position cursor when moving up & down
"RTN","%ZVEMRE",131,0)
 ;DIR=Cursor Direction (U=Up D=Down)
"RTN","%ZVEMRE",132,0)
 ;DIRHLD stores the starting column when moving UP or DOWN.
"RTN","%ZVEMRE",133,0)
 NEW ND
"RTN","%ZVEMRE",134,0)
 KILL:DIR="U" DIRHLD("D") KILL:DIR="D" DIRHLD("U")
"RTN","%ZVEMRE",135,0)
 I '$D(DIRHLD(DIR)) S DIRHLD(DIR)=XCUR
"RTN","%ZVEMRE",136,0)
 S ND=$G(^TMP("VEE","IR"_VRRS,$J,YND))
"RTN","%ZVEMRE",137,0)
 I $L(ND)>DIRHLD(DIR) S XCUR=DIRHLD(DIR) Q
"RTN","%ZVEMRE",138,0)
 S XCUR=$L(ND)-$S(ND[$C(30):1,1:"")
"RTN","%ZVEMRE",139,0)
 Q
"RTN","%ZVEMRE1")
0^94^B7818414
"RTN","%ZVEMRE1",1,0)
%ZVEMRE1 ;DJB,VRR**EDIT - DO Menu Options ; 9/24/02 1:28pm
"RTN","%ZVEMRE1",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMRE1",3,0)
 ;
"RTN","%ZVEMRE1",4,0)
QUIT ;Call here if you should Quit after returning to ^%ZVEMRE
"RTN","%ZVEMRE1",5,0)
 S QUIT=1
"RTN","%ZVEMRE1",6,0)
 ;
"RTN","%ZVEMRE1",7,0)
 ;If in WEB mode, redraw WEB in upper right of screen
"RTN","%ZVEMRE1",8,0)
 I FLAGMODE["WEB" D MODEON^%ZVEMRU("WEB",1)
"RTN","%ZVEMRE1",9,0)
 Q
"RTN","%ZVEMRE1",10,0)
 ;
"RTN","%ZVEMRE1",11,0)
DO ;Run menu options from ^%ZVEMRE
"RTN","%ZVEMRE1",12,0)
 I $G(FLAGVPE)'["EDIT",",<ESCW>,<BS>,<DEL>,<ESCB>,<ESCD>,<ESCJ>,<RET>,"[(","_VK_",") D MSG^%ZVEMRUM(5) Q
"RTN","%ZVEMRE1",13,0)
 I $G(FLAGVPE)["LBRY",",<TAB>,<ESCR>,<ESCG>,<ESCH>,<ESCK>,"[(","_VK_",") D MSG^%ZVEMRUM(5) Q
"RTN","%ZVEMRE1",14,0)
 ;
"RTN","%ZVEMRE1",15,0)
WEB I VK="<ESCW>" D WEB^%ZVEMREP Q
"RTN","%ZVEMRE1",16,0)
 ;
"RTN","%ZVEMRE1",17,0)
 I VK="<TAB>" D ^%ZVEMRM,REDRAW1^%ZVEMRU G QUIT
"RTN","%ZVEMRE1",18,0)
 I VK="<ESCN>" D LOCATE1^%ZVEMRM,REDRAW1^%ZVEMRU G QUIT
"RTN","%ZVEMRE1",19,0)
 I VK="<ESCB>" D BREAK^%ZVEMREJ,REDRAW^%ZVEMRU(YND) Q
"RTN","%ZVEMRE1",20,0)
 I VK="<ESCR>" D PARSE^%ZVEMREP,REDRAW1^%ZVEMRU G QUIT
"RTN","%ZVEMRE1",21,0)
 I VK="<ESCG>" D GLB^%ZVEMREP Q:KEY="S"  G QUIT
"RTN","%ZVEMRE1",22,0)
 I VK="<ESCL>" D LNDOWN^%ZVEMREM Q
"RTN","%ZVEMRE1",23,0)
 I ",<ESC=>,<ESC->,<ESC_>,<ESC.>,<ESC;>,"[(","_VK_",") D INSERT Q
"RTN","%ZVEMRE1",24,0)
 ;
"RTN","%ZVEMRE1",25,0)
 ;Exit. Verify tags/lines are legal.
"RTN","%ZVEMRE1",26,0)
 I ",<ESC>,<F1E>,<F1Q>,<TO>,"[(","_VK_",") D VERIFY G QUIT
"RTN","%ZVEMRE1",27,0)
 ;
"RTN","%ZVEMRE1",28,0)
 I ",<HOME>,<END>,<F4AL>,<F4AR>,"[(","_VK_",") D RUN3^%ZVEMRER G QUIT
"RTN","%ZVEMRE1",29,0)
 I ",<PGDN>,<F4AD>,"[(","_VK_",") Q:$$ENDFILE^%ZVEMRE()  D FORWARD^%ZVEMRER G QUIT ;Page down
"RTN","%ZVEMRE1",30,0)
 I ",<PGUP>,<F4AU>,"[(","_VK_",") Q:$$TOPFILE^%ZVEMRE()  D BACKUP^%ZVEMRER G QUIT  ;Page up
"RTN","%ZVEMRE1",31,0)
 ;
"RTN","%ZVEMRE1",32,0)
 I ",<ESCH>,<ESCK>,"[(","_VK_",") D RUN2^%ZVEMRER G QUIT
"RTN","%ZVEMRE1",33,0)
 I ",<BS>,<DEL>,"[(","_VK_",") D HIGHOFF^%ZVEMRE,RUN^%ZVEMRER,HIGHON^%ZVEMRE Q
"RTN","%ZVEMRE1",34,0)
 I VK?1"<F".E1">" D HIGHOFF^%ZVEMRE,RUN^%ZVEMRER,HIGHON^%ZVEMRE Q
"RTN","%ZVEMRE1",35,0)
 I VK="<RET>" D HIGHOFF^%ZVEMRE,RETURN^%ZVEMREP,HIGHON^%ZVEMRE Q
"RTN","%ZVEMRE1",36,0)
 ;
"RTN","%ZVEMRE1",37,0)
 Q:VK?1"<".E1">".E  S FLAGSAVE=1
"RTN","%ZVEMRE1",38,0)
 D HIGHOFF^%ZVEMRE ;...Highlight off
"RTN","%ZVEMRE1",39,0)
 D ^%ZVEMREA ;.........Insert text
"RTN","%ZVEMRE1",40,0)
 D HIGHON^%ZVEMRE ;....Highlight on
"RTN","%ZVEMRE1",41,0)
 Q
"RTN","%ZVEMRE1",42,0)
 ;
"RTN","%ZVEMRE1",43,0)
VERIFY ;Verify tags/lines are legal.
"RTN","%ZVEMRE1",44,0)
 ;If FLAGQ is set to 0 by VERIFY^%ZVEMRV, user will be returned to
"RTN","%ZVEMRE1",45,0)
 ;current rtn to continue editing.
"RTN","%ZVEMRE1",46,0)
 S FLAGQ=1
"RTN","%ZVEMRE1",47,0)
 Q:$G(FLAGVPE)'["EDIT"
"RTN","%ZVEMRE1",48,0)
 I VRRS>1 D  Q
"RTN","%ZVEMRE1",49,0)
 . I $G(FLAGSAVE) D ENDSCR^%ZVEMKT2,SAVE^%ZVEMRMS
"RTN","%ZVEMRE1",50,0)
 D VERIFY^%ZVEMRV(VRRS)
"RTN","%ZVEMRE1",51,0)
 Q
"RTN","%ZVEMRE1",52,0)
 ;
"RTN","%ZVEMRE1",53,0)
INSERT ;Speed insert a line of characters (=._-), or a single ';'.
"RTN","%ZVEMRE1",54,0)
 ;Use when documenting your routine.
"RTN","%ZVEMRE1",55,0)
 NEW CD,NUM,X
"RTN","%ZVEMRE1",56,0)
 S X=$E(VK,5) ;.......Get character
"RTN","%ZVEMRE1",57,0)
 S $P(CD,X,67)="" ;...Set CD=line of character's
"RTN","%ZVEMRE1",58,0)
 I X=";" S CD="" ;....Only insert a single ';'.
"RTN","%ZVEMRE1",59,0)
 S CD=";"_CD
"RTN","%ZVEMRE1",60,0)
 S NUM=$$LINENUM^%ZVEMRU(YCUR)+1
"RTN","%ZVEMRE1",61,0)
 ;Put line into clipboard
"RTN","%ZVEMRE1",62,0)
 S ^%ZVEMS("E","SAVEVRR",$J,1)=NUM_$J("",9-$L(NUM))_$C(30)_CD
"RTN","%ZVEMRE1",63,0)
 S ^%ZVEMS("E","SAVEVRR",$J,2)="" ;Mark clipboard ending point
"RTN","%ZVEMRE1",64,0)
 D PREPASTE^%ZVEMRP1
"RTN","%ZVEMRE1",65,0)
 D REDRAW^%ZVEMRU(YND)
"RTN","%ZVEMRE1",66,0)
 Q
"RTN","%ZVEMRE2")
0^95^B12026766
"RTN","%ZVEMRE2",1,0)
%ZVEMRE2 ;DJB,VRR**EDIT - Block Mode ; 1/8/01 8:31am
"RTN","%ZVEMRE2",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMRE2",3,0)
 ;
"RTN","%ZVEMRE2",4,0)
BLOCK ;Block Mode
"RTN","%ZVEMRE2",5,0)
 ;<AU>/<AD>: Highlight lines of code.
"RTN","%ZVEMRE2",6,0)
 ;           Clipboard marked: ^%ZVEMS("E","SAVEVRR",$J)="LINE"
"RTN","%ZVEMRE2",7,0)
 ;<AL>/<AR>: Highlight characters of code on a single line.
"RTN","%ZVEMRE2",8,0)
 ;           Clipboard marked: ^%ZVEMS("E","SAVEVRR",$J)="CHAR"
"RTN","%ZVEMRE2",9,0)
 ;
"RTN","%ZVEMRE2",10,0)
 I VK="<DEL>" D DEL Q  ;.....Delete code
"RTN","%ZVEMRE2",11,0)
 I VK="<ESCC>" D ESCC Q  ;...Copy code to clipboard
"RTN","%ZVEMRE2",12,0)
 I VK="<ESCD>" D ESCD Q  ;...Delete code
"RTN","%ZVEMRE2",13,0)
 I VK="<ESCV>" D ESCV Q  ;...Paste code
"RTN","%ZVEMRE2",14,0)
 I VK="<ESCX>" D ESCX Q  ;...Cut code to clipboard
"RTN","%ZVEMRE2",15,0)
 I VK="<F3>" D F3 Q  ;.......Turn Block mode ON/OFF
"RTN","%ZVEMRE2",16,0)
 Q
"RTN","%ZVEMRE2",17,0)
 ;
"RTN","%ZVEMRE2",18,0)
DEL ;Delete code
"RTN","%ZVEMRE2",19,0)
 D ESCD
"RTN","%ZVEMRE2",20,0)
 Q
"RTN","%ZVEMRE2",21,0)
 ;
"RTN","%ZVEMRE2",22,0)
ESCC ;Copy code to clipboard
"RTN","%ZVEMRE2",23,0)
 D COPY^%ZVEMRP1
"RTN","%ZVEMRE2",24,0)
 D BLOCK^%ZVEMRER()
"RTN","%ZVEMRE2",25,0)
 Q
"RTN","%ZVEMRE2",26,0)
 ;
"RTN","%ZVEMRE2",27,0)
ESCD ;Delete code
"RTN","%ZVEMRE2",28,0)
 ;
"RTN","%ZVEMRE2",29,0)
 ;Block mode ON
"RTN","%ZVEMRE2",30,0)
 I FLAGMODE["BLOCK" D  Q
"RTN","%ZVEMRE2",31,0)
 . I $D(^TMP("VEE","SAVECHAR",$J)) D ESCDC Q  ;Delete characters
"RTN","%ZVEMRE2",32,0)
 . D ESCDL1 ;..................................Delete lines
"RTN","%ZVEMRE2",33,0)
 ;
"RTN","%ZVEMRE2",34,0)
 ;Block mode OFF
"RTN","%ZVEMRE2",35,0)
 D ESCDL2 ;....................................Delete lines
"RTN","%ZVEMRE2",36,0)
 Q
"RTN","%ZVEMRE2",37,0)
 ;
"RTN","%ZVEMRE2",38,0)
ESCDC ;Delete characters - Block mode must be ON.
"RTN","%ZVEMRE2",39,0)
 D DELETE^%ZVEMRP2
"RTN","%ZVEMRE2",40,0)
 D BLOCK^%ZVEMRER()
"RTN","%ZVEMRE2",41,0)
 Q
"RTN","%ZVEMRE2",42,0)
 ;
"RTN","%ZVEMRE2",43,0)
ESCDL1 ;Delete lines - Block mode ON
"RTN","%ZVEMRE2",44,0)
 D DELETE^%ZVEMRP1()
"RTN","%ZVEMRE2",45,0)
 D REDRAW1^%ZVEMRU
"RTN","%ZVEMRE2",46,0)
 D BLOCK^%ZVEMRER(1)
"RTN","%ZVEMRE2",47,0)
 S QUIT=1
"RTN","%ZVEMRE2",48,0)
 Q
"RTN","%ZVEMRE2",49,0)
 ;
"RTN","%ZVEMRE2",50,0)
ESCDL2 ;Delete lines - Block mode OFF
"RTN","%ZVEMRE2",51,0)
 D ESCD^%ZVEMRP1
"RTN","%ZVEMRE2",52,0)
 D REDRAW1^%ZVEMRU
"RTN","%ZVEMRE2",53,0)
 S QUIT=1
"RTN","%ZVEMRE2",54,0)
 Q
"RTN","%ZVEMRE2",55,0)
 ;
"RTN","%ZVEMRE2",56,0)
ESCV ;Paste characters/lines
"RTN","%ZVEMRE2",57,0)
 NEW CHAR,CLIPTYPE,LINE
"RTN","%ZVEMRE2",58,0)
 ;
"RTN","%ZVEMRE2",59,0)
 ;Block Mode OFF
"RTN","%ZVEMRE2",60,0)
 I FLAGMODE'["BLOCK" D  D REDRAW^%ZVEMRU(YND) Q
"RTN","%ZVEMRE2",61,0)
 . I $G(^%ZVEMS("E","SAVEVRR",$J))="CHAR" D INSERT^%ZVEMRP2 Q  ;Chars
"RTN","%ZVEMRE2",62,0)
 . D PREPASTE^%ZVEMRP1 ;Lines
"RTN","%ZVEMRE2",63,0)
 ;
"RTN","%ZVEMRE2",64,0)
 ;Block Mode ON
"RTN","%ZVEMRE2",65,0)
 S CLIPTYPE=$G(^%ZVEMS("E","SAVEVRR",$J))
"RTN","%ZVEMRE2",66,0)
 S CHAR=$D(^TMP("VEE","SAVECHAR",$J))
"RTN","%ZVEMRE2",67,0)
 S LINE=$D(^TMP("VEE","SAVE",$J))
"RTN","%ZVEMRE2",68,0)
 ;
"RTN","%ZVEMRE2",69,0)
 I CLIPTYPE="LINE" D  ;...Replace lines
"RTN","%ZVEMRE2",70,0)
 . I CHAR D  Q  ;.........Can't replace lines with chars
"RTN","%ZVEMRE2",71,0)
 .. D MSG^%ZVEMRUM(23)
"RTN","%ZVEMRE2",72,0)
 .. D CLEARALL^%ZVEMRP
"RTN","%ZVEMRE2",73,0)
 . D ESCV1
"RTN","%ZVEMRE2",74,0)
 ;
"RTN","%ZVEMRE2",75,0)
 I CLIPTYPE="CHAR" D  ;...Replace characters
"RTN","%ZVEMRE2",76,0)
 . I LINE D  Q  ;.........Can't replace chars with lines
"RTN","%ZVEMRE2",77,0)
 .. D MSG^%ZVEMRUM(22)
"RTN","%ZVEMRE2",78,0)
 .. D CLEARALL^%ZVEMRP
"RTN","%ZVEMRE2",79,0)
 . D ESCV2
"RTN","%ZVEMRE2",80,0)
 ;
"RTN","%ZVEMRE2",81,0)
 ;Turn off Block Mode
"RTN","%ZVEMRE2",82,0)
 D BLOCK^%ZVEMRER()
"RTN","%ZVEMRE2",83,0)
 Q
"RTN","%ZVEMRE2",84,0)
 ;
"RTN","%ZVEMRE2",85,0)
ESCV1 ;Replace lines
"RTN","%ZVEMRE2",86,0)
 ;Set YND=Highest line number of highlighted code. Insert saved lines
"RTN","%ZVEMRE2",87,0)
 ;after this number, and then delete highlighted lines.
"RTN","%ZVEMRE2",88,0)
 ;
"RTN","%ZVEMRE2",89,0)
 Q:'$D(^TMP("VEE","SAVE",$J))
"RTN","%ZVEMRE2",90,0)
 S YND=$O(^TMP("VEE","SAVE",$J,""),-1) ;Highest line number
"RTN","%ZVEMRE2",91,0)
 D PREPASTE^%ZVEMRP1 ;..................Insert saved lines
"RTN","%ZVEMRE2",92,0)
 D DELETE^%ZVEMRP1("") ;................Delete highlighted lines
"RTN","%ZVEMRE2",93,0)
 D REDRAW2^%ZVEMRU ;....................Redraw screen
"RTN","%ZVEMRE2",94,0)
 Q
"RTN","%ZVEMRE2",95,0)
 ;
"RTN","%ZVEMRE2",96,0)
ESCV2 ;Replace characters
"RTN","%ZVEMRE2",97,0)
 D DELETE^%ZVEMRP2 ;...Cut characters
"RTN","%ZVEMRE2",98,0)
 D INSERT^%ZVEMRP2 ;...Insert new characters
"RTN","%ZVEMRE2",99,0)
 D REDRAW^%ZVEMRU(YND)
"RTN","%ZVEMRE2",100,0)
 Q
"RTN","%ZVEMRE2",101,0)
 ;
"RTN","%ZVEMRE2",102,0)
ESCX ;Cut characters/lines
"RTN","%ZVEMRE2",103,0)
 ;
"RTN","%ZVEMRE2",104,0)
 ;Cut characters
"RTN","%ZVEMRE2",105,0)
 I $D(^TMP("VEE","SAVECHAR",$J)) D  Q
"RTN","%ZVEMRE2",106,0)
 . D SAVE1^%ZVEMRP1
"RTN","%ZVEMRE2",107,0)
 . D DELETE^%ZVEMRP2
"RTN","%ZVEMRE2",108,0)
 . D BLOCK^%ZVEMRER()
"RTN","%ZVEMRE2",109,0)
 ;
"RTN","%ZVEMRE2",110,0)
 ;Cut lines
"RTN","%ZVEMRE2",111,0)
 D CUT^%ZVEMRP1
"RTN","%ZVEMRE2",112,0)
 D BLOCK^%ZVEMRER(1)
"RTN","%ZVEMRE2",113,0)
 D REDRAW2^%ZVEMRU
"RTN","%ZVEMRE2",114,0)
 Q
"RTN","%ZVEMRE2",115,0)
 ;
"RTN","%ZVEMRE2",116,0)
F3 ;Block mode ON/OFF
"RTN","%ZVEMRE2",117,0)
 ;
"RTN","%ZVEMRE2",118,0)
 ;Turn Block mode OFF
"RTN","%ZVEMRE2",119,0)
 I $G(FLAGMODE)["BLOCK" D  Q
"RTN","%ZVEMRE2",120,0)
 . D CLEARALL^%ZVEMRP
"RTN","%ZVEMRE2",121,0)
 . D BLOCK^%ZVEMRER()
"RTN","%ZVEMRE2",122,0)
 ;
"RTN","%ZVEMRE2",123,0)
 ;Turn Block mode ON
"RTN","%ZVEMRE2",124,0)
 S $P(FLAGMODE,"^",1)="BLOCK"
"RTN","%ZVEMRE2",125,0)
 D MODEON^%ZVEMRU("BLOCK")
"RTN","%ZVEMRE2",126,0)
 KILL ^TMP("VEE","SAVE",$J)
"RTN","%ZVEMRE2",127,0)
 KILL ^TMP("VEE","SAVECHAR",$J)
"RTN","%ZVEMRE2",128,0)
 Q
"RTN","%ZVEMREA")
0^96^B12718966
"RTN","%ZVEMREA",1,0)
%ZVEMREA ;DJB,VRR**EDIT - Add Character ; 12/25/00 5:09pm
"RTN","%ZVEMREA",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMREA",3,0)
 ;
"RTN","%ZVEMREA",4,0)
TOP ;Add a character to CD string
"RTN","%ZVEMREA",5,0)
 NEW CD,FLAGNEW,HLD,HLDX,HLDY1,HLDY2,I,NUM,WHERE,XSAVE,YSAVE,YNDSAVE
"RTN","%ZVEMREA",6,0)
 S NUM=YND
"RTN","%ZVEMREA",7,0)
 S CD(NUM)=$G(^TMP("VEE","IR"_VRRS,$J,NUM))
"RTN","%ZVEMREA",8,0)
 S WHERE=$$CHKADD^%ZVEMREL() Q:WHERE="Q"
"RTN","%ZVEMREA",9,0)
 D SET
"RTN","%ZVEMREA",10,0)
 I $L(CD(NUM))<(VEE("IOM")-(CD(NUM)'[$C(30))) D SIMPLE G EX
"RTN","%ZVEMREA",11,0)
 S HLDX=XCUR,HLDY1=YCUR ;Save cursor X&Y values. Used by SCROLL.
"RTN","%ZVEMREA",12,0)
 D ADJARRAY
"RTN","%ZVEMREA",13,0)
 D REDRAW
"RTN","%ZVEMREA",14,0)
 D COMPLEX
"RTN","%ZVEMREA",15,0)
EX ;Exit
"RTN","%ZVEMREA",16,0)
 S XCUR=XSAVE,YCUR=YSAVE,YND=YNDSAVE
"RTN","%ZVEMREA",17,0)
 S DX=XCUR,DY=YCUR X VEES("CRSR")
"RTN","%ZVEMREA",18,0)
 D ADJOPEN1
"RTN","%ZVEMREA",19,0)
 Q
"RTN","%ZVEMREA",20,0)
 ;
"RTN","%ZVEMREA",21,0)
SET ;Adjust variables
"RTN","%ZVEMREA",22,0)
 ;KEY=Character user typed. Set in ^%ZVEMRE
"RTN","%ZVEMREA",23,0)
 S FLAGNEW=0
"RTN","%ZVEMREA",24,0)
 S YSAVE=YCUR
"RTN","%ZVEMREA",25,0)
 S YNDSAVE=YND
"RTN","%ZVEMREA",26,0)
 S (XCUR,XSAVE)=XCUR+1
"RTN","%ZVEMREA",27,0)
 S XCHAR=$$XCHARADD^%ZVEMRU(CD(NUM))
"RTN","%ZVEMREA",28,0)
 I XCUR>$L(CD(NUM)) S KEY=$J("",XCUR-$L(CD(NUM))-(CD(NUM)'[$C(30)))_KEY
"RTN","%ZVEMREA",29,0)
 S CD(NUM)=$E(CD(NUM),1,XCHAR-2)_KEY_$E(CD(NUM),XCHAR-1,9999)
"RTN","%ZVEMREA",30,0)
 Q
"RTN","%ZVEMREA",31,0)
 ;
"RTN","%ZVEMREA",32,0)
SIMPLE ;Process a line that hasn't reached end yet
"RTN","%ZVEMREA",33,0)
 S DX=XCUR,DY=YCUR X VEES("CRSR")
"RTN","%ZVEMREA",34,0)
 W @VEES("BLANK_C_EOL")
"RTN","%ZVEMREA",35,0)
 X VEES("XY")
"RTN","%ZVEMREA",36,0)
 W $E(CD(NUM),XCHAR,9999)
"RTN","%ZVEMREA",37,0)
 Q
"RTN","%ZVEMREA",38,0)
 ;
"RTN","%ZVEMREA",39,0)
ADJARRAY ;Adjust CD() array for new character. FLAGNEW=1 Open new line
"RTN","%ZVEMREA",40,0)
 NEW FLAGQ S FLAGQ=0
"RTN","%ZVEMREA",41,0)
 F I=NUM+1:1 D  Q:FLAGQ  Q:$L(CD(I))<(VEE("IOM")-1)
"RTN","%ZVEMREA",42,0)
 . S CD(I)=$G(^TMP("VEE","IR"_VRRS,$J,I))
"RTN","%ZVEMREA",43,0)
 . I CD(I)[$C(30)!(CD(I)=" <> <> <>") D  ;Open new line
"RTN","%ZVEMREA",44,0)
 . . S CD(I)=$J("",9),FLAGNEW=I,FLAGQ=1
"RTN","%ZVEMREA",45,0)
 . S HLD=$E(CD(I-1),$L(CD(I-1))) ;Get last char of previous line
"RTN","%ZVEMREA",46,0)
 . S CD(I-1)=$E(CD(I-1),1,$L(CD(I-1))-1) ;Remove it from previous line
"RTN","%ZVEMREA",47,0)
 . S CD(I)=$E(CD(I),1,9)_HLD_$E(CD(I),10,9999) ;Add it to current line
"RTN","%ZVEMREA",48,0)
 Q
"RTN","%ZVEMREA",49,0)
 ;
"RTN","%ZVEMREA",50,0)
REDRAW ;Redraw rest of adjusted current line
"RTN","%ZVEMREA",51,0)
 I XCUR<(VEE("IOM")-2) D SIMPLE Q
"RTN","%ZVEMREA",52,0)
 ;If cursor at line end, move cursor down
"RTN","%ZVEMREA",53,0)
 S DX=VEE("IOM")-2,DY=YCUR X VEES("CRSR")
"RTN","%ZVEMREA",54,0)
 W " "
"RTN","%ZVEMREA",55,0)
 S (XCUR,XSAVE)=$S(XCUR=(VEE("IOM")-2):9,1:10)
"RTN","%ZVEMREA",56,0)
 S YNDSAVE=YND+1
"RTN","%ZVEMREA",57,0)
 I YND<(VEET("BOT")-1) S YSAVE=YCUR+1 Q
"RTN","%ZVEMREA",58,0)
 Q:$G(^TMP("VEE","IR"_VRRS,$J,YND+1))[$C(30)
"RTN","%ZVEMREA",59,0)
 Q:$G(^(YND+1))=" <> <> <>"
"RTN","%ZVEMREA",60,0)
 D DOWN^%ZVEMRE(1)
"RTN","%ZVEMREA",61,0)
 S YCUR=YCUR-1
"RTN","%ZVEMREA",62,0)
 Q
"RTN","%ZVEMREA",63,0)
 ;
"RTN","%ZVEMREA",64,0)
COMPLEX ;Multiple lines and cursor position, need to be adjusted.
"RTN","%ZVEMREA",65,0)
 S DY=YCUR
"RTN","%ZVEMREA",66,0)
 F I=NUM+1:1 Q:'$D(CD(I))  D  Q:FLAGQ
"RTN","%ZVEMREA",67,0)
 . I I=FLAGNEW D OPEN W $P(CD(I),$C(30),1),$P(CD(I),$C(30),2,99) Q
"RTN","%ZVEMREA",68,0)
 . S DX=9,DY=DY+1
"RTN","%ZVEMREA",69,0)
 . I DY>(VEET("BOT")-VEET("TOP")) S FLAGQ=1 Q  ;Quit at screen bottom
"RTN","%ZVEMREA",70,0)
 . X VEES("CRSR")
"RTN","%ZVEMREA",71,0)
 . W @VEES("BLANK_C_EOL")
"RTN","%ZVEMREA",72,0)
 . X VEES("XY")
"RTN","%ZVEMREA",73,0)
 . W $E(CD(I),10,9999)
"RTN","%ZVEMREA",74,0)
 Q
"RTN","%ZVEMREA",75,0)
 ;
"RTN","%ZVEMREA",76,0)
OPEN ;Open new next line.
"RTN","%ZVEMREA",77,0)
 NEW BOT
"RTN","%ZVEMREA",78,0)
 S BOT=$O(CD(""),-1)-1 I YND<BOT D  ;
"RTN","%ZVEMREA",79,0)
 . S YCUR=YCUR+BOT-YND,YND=YND+BOT-YND
"RTN","%ZVEMREA",80,0)
 . S DX=XCUR,DY=YCUR X VEES("CRSR")
"RTN","%ZVEMREA",81,0)
 S HLDY2=YCUR ;Save cursor Y value. Used by SCROLL.
"RTN","%ZVEMREA",82,0)
 D OPEN^%ZVEMREO
"RTN","%ZVEMREA",83,0)
 D ADJOPEN
"RTN","%ZVEMREA",84,0)
SCROLL ;When new line is opened and character is drawn, move cursor back to previous location. Determine if it needs to scroll up 1 line.
"RTN","%ZVEMREA",85,0)
 Q:HLDY2<(VEET("BOT")-VEET("TOP"))  ;Opened line not at screen bottom.
"RTN","%ZVEMREA",86,0)
 I HLDX<(VEE("IOM")-2) S YSAVE=YSAVE-1 Q  ;Cursor not at line end. Always scroll up 1 line.
"RTN","%ZVEMREA",87,0)
 Q:HLDY1=(VEET("BOT")-VEET("TOP"))  ;Cursor at screen bottom. Don't scroll up 1 line.
"RTN","%ZVEMREA",88,0)
 S YSAVE=YSAVE-1 ;Scroll cursor up 1 line.
"RTN","%ZVEMREA",89,0)
 Q
"RTN","%ZVEMREA",90,0)
 ;
"RTN","%ZVEMREA",91,0)
ADJOPEN ;Adjust scroll array - Open a line
"RTN","%ZVEMREA",92,0)
 NEW END,I
"RTN","%ZVEMREA",93,0)
 S END=$O(^TMP("VEE","IR"_VRRS,$J,""),-1)
"RTN","%ZVEMREA",94,0)
 F I=(END+1):-1:YND D  ;
"RTN","%ZVEMREA",95,0)
 . S ^TMP("VEE","IR"_VRRS,$J,I)=^TMP("VEE","IR"_VRRS,$J,I-1)
"RTN","%ZVEMREA",96,0)
ADJOPEN1 F I=NUM:1 Q:'$D(CD(I))  S ^TMP("VEE","IR"_VRRS,$J,I)=CD(I)
"RTN","%ZVEMREA",97,0)
 Q
"RTN","%ZVEMREB")
0^97^B11045143
"RTN","%ZVEMREB",1,0)
%ZVEMREB ;DJB,VRR**EDIT - Remove Character ; 1/6/01 1:19pm
"RTN","%ZVEMREB",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMREB",3,0)
 ;
"RTN","%ZVEMREB",4,0)
TOP ;
"RTN","%ZVEMREB",5,0)
 NEW CD,HLD,I,NUM,WHERE,XSAVE,YSAVE,YNDSAVE
"RTN","%ZVEMREB",6,0)
 S NUM=YND
"RTN","%ZVEMREB",7,0)
 S CD(NUM)=$G(^TMP("VEE","IR"_VRRS,$J,NUM))
"RTN","%ZVEMREB",8,0)
 S WHERE=$$CHKDEL^%ZVEMREL() Q:WHERE="Q"
"RTN","%ZVEMREB",9,0)
 D SET,ADJARRAY
"RTN","%ZVEMREB",10,0)
 I CD(NUM)[$C(30),'$D(CD(NUM+1)) D SIMPLE G EX
"RTN","%ZVEMREB",11,0)
 D REDRAW
"RTN","%ZVEMREB",12,0)
 D COMPLEX
"RTN","%ZVEMREB",13,0)
EX ;Exit
"RTN","%ZVEMREB",14,0)
 ;Strip ending spaces
"RTN","%ZVEMREB",15,0)
 I $E(CD(NUM),$L(CD(NUM)))=" ",'$D(CD(NUM+1)) D SPACES
"RTN","%ZVEMREB",16,0)
 S XCUR=XSAVE
"RTN","%ZVEMREB",17,0)
 S YCUR=YSAVE
"RTN","%ZVEMREB",18,0)
 S YND=YNDSAVE
"RTN","%ZVEMREB",19,0)
 S DX=XCUR,DY=YCUR X VEES("CRSR")
"RTN","%ZVEMREB",20,0)
 D ADJCLOS1 ;Adjust scroll array
"RTN","%ZVEMREB",21,0)
 Q
"RTN","%ZVEMREB",22,0)
 ;
"RTN","%ZVEMREB",23,0)
SET ;Adjust variables
"RTN","%ZVEMREB",24,0)
 S YSAVE=YCUR
"RTN","%ZVEMREB",25,0)
 S YNDSAVE=YND
"RTN","%ZVEMREB",26,0)
 S XCUR=$S($G(VK)="<DEL>":XCUR,1:XCUR-1)
"RTN","%ZVEMREB",27,0)
 S XSAVE=XCUR
"RTN","%ZVEMREB",28,0)
 S XCHAR=$$XCHARDEL^%ZVEMRU(CD(NUM))
"RTN","%ZVEMREB",29,0)
 Q
"RTN","%ZVEMREB",30,0)
 ;
"RTN","%ZVEMREB",31,0)
SPACES ;Strip ending spaces from line
"RTN","%ZVEMREB",32,0)
 F  Q:$E(CD(NUM),$L(CD(NUM)))'=" "  D  ;
"RTN","%ZVEMREB",33,0)
 . S CD(NUM)=$E(CD(NUM),1,$L(CD(NUM))-1)
"RTN","%ZVEMREB",34,0)
 Q
"RTN","%ZVEMREB",35,0)
 ;
"RTN","%ZVEMREB",36,0)
SIMPLE ;Process a line that hasn't reached end yet
"RTN","%ZVEMREB",37,0)
 S CD(NUM)=$E(CD(NUM),1,XCHAR-1)_$E(CD(NUM),XCHAR+1,9999)
"RTN","%ZVEMREB",38,0)
SIMPLE1 S DX=XCUR,DY=YCUR X VEES("CRSR")
"RTN","%ZVEMREB",39,0)
 W @VEES("BLANK_C_EOL")
"RTN","%ZVEMREB",40,0)
 W $E(CD(NUM),XCHAR,9999)
"RTN","%ZVEMREB",41,0)
 Q
"RTN","%ZVEMREB",42,0)
 ;
"RTN","%ZVEMREB",43,0)
COMPLEX ;Multiple lines and cursor position need to be adjusted.
"RTN","%ZVEMREB",44,0)
 F I=NUM+1:1 Q:'$D(CD(I))  D  ;
"RTN","%ZVEMREB",45,0)
 . I CD(I)?1." " KILL CD(I) D CLOSE Q
"RTN","%ZVEMREB",46,0)
 . Q:NUM'<(VEET("BOT")-1)  ;.........Ignore lines below screen bottom
"RTN","%ZVEMREB",47,0)
 . S DX=9,DY=DY+1 X VEES("CRSR")
"RTN","%ZVEMREB",48,0)
 . W @VEES("BLANK_C_EOL")
"RTN","%ZVEMREB",49,0)
 . X VEES("XY")
"RTN","%ZVEMREB",50,0)
 . W $E(CD(I),10,9999)
"RTN","%ZVEMREB",51,0)
 Q
"RTN","%ZVEMREB",52,0)
 ;
"RTN","%ZVEMREB",53,0)
REDRAW ;Redraw rest of adjusted line
"RTN","%ZVEMREB",54,0)
 I CD(NUM)'[$C(30),XCUR<9 D  Q  ;If cursor at line begin, move it up
"RTN","%ZVEMREB",55,0)
 . S HLD=$E(CD(NUM),10)
"RTN","%ZVEMREB",56,0)
 . S CD(NUM)=$E(CD(NUM),1,9)_$E(CD(NUM),11,9999)
"RTN","%ZVEMREB",57,0)
 . D REDRAW1(77)
"RTN","%ZVEMREB",58,0)
 . S CD(NUM)=$E(CD(NUM),1,$L(CD(NUM))-1)_HLD
"RTN","%ZVEMREB",59,0)
 . S ^TMP("VEE","IR"_VRRS,$J,NUM)=CD(NUM)
"RTN","%ZVEMREB",60,0)
 . D SIMPLE1
"RTN","%ZVEMREB",61,0)
 D SIMPLE
"RTN","%ZVEMREB",62,0)
 D:CD(NUM)?1." " REDRAW1(VEE("IOM")-2)
"RTN","%ZVEMREB",63,0)
 Q
"RTN","%ZVEMREB",64,0)
 ;
"RTN","%ZVEMREB",65,0)
REDRAW1(XPOS) ;When cursor is on bottom line and it deletes last char, close
"RTN","%ZVEMREB",66,0)
 ;line and move cursor up.
"RTN","%ZVEMREB",67,0)
 S NUM=NUM-1
"RTN","%ZVEMREB",68,0)
 S CD(NUM)=$G(^TMP("VEE","IR"_VRRS,$J,NUM))
"RTN","%ZVEMREB",69,0)
 S (XCUR,XSAVE)=XPOS
"RTN","%ZVEMREB",70,0)
 S (YCUR,YSAVE)=YCUR-1
"RTN","%ZVEMREB",71,0)
 S (YND,YNDSAVE)=YND-1
"RTN","%ZVEMREB",72,0)
 S XCHAR=$$XCHARDEL^%ZVEMRU(CD(NUM))
"RTN","%ZVEMREB",73,0)
 Q
"RTN","%ZVEMREB",74,0)
 ;
"RTN","%ZVEMREB",75,0)
ADJARRAY ;Adjust CD() array to remove a character.
"RTN","%ZVEMREB",76,0)
 NEW I,FLAGQ S FLAGQ=0
"RTN","%ZVEMREB",77,0)
 F I=NUM+1:1 D  Q:FLAGQ
"RTN","%ZVEMREB",78,0)
 . S CD(I)=$G(^TMP("VEE","IR"_VRRS,$J,I))
"RTN","%ZVEMREB",79,0)
 . I CD(I)[$C(30)!(CD(I)=" <> <> <>") KILL CD(I) S FLAGQ=1 Q
"RTN","%ZVEMREB",80,0)
 . S HLD=$E(CD(I),10) ;.....................Get 1st char of next line
"RTN","%ZVEMREB",81,0)
 . S CD(I-1)=CD(I-1)_HLD ;..................Add it to current line
"RTN","%ZVEMREB",82,0)
 . S CD(I)=$E(CD(I),1,9)_$E(CD(I),11,9999) ;Remove it from line
"RTN","%ZVEMREB",83,0)
 Q
"RTN","%ZVEMREB",84,0)
 ;
"RTN","%ZVEMREB",85,0)
ADJCLOS ;Adjust scroll array - Close a line
"RTN","%ZVEMREB",86,0)
 NEW END,I
"RTN","%ZVEMREB",87,0)
 S END=$O(^TMP("VEE","IR"_VRRS,$J,""),-1)
"RTN","%ZVEMREB",88,0)
 F I=YND+1:1:END-1 D  ;
"RTN","%ZVEMREB",89,0)
 . S ^TMP("VEE","IR"_VRRS,$J,I)=^TMP("VEE","IR"_VRRS,$J,I+1)
"RTN","%ZVEMREB",90,0)
 KILL ^TMP("VEE","IR"_VRRS,$J,END)
"RTN","%ZVEMREB",91,0)
ADJCLOS1 F I=NUM:1 Q:'$D(CD(I))  S ^TMP("VEE","IR"_VRRS,$J,I)=CD(I)
"RTN","%ZVEMREB",92,0)
 Q
"RTN","%ZVEMREB",93,0)
 ;
"RTN","%ZVEMREB",94,0)
CLOSE ;Close a line that's been deleted
"RTN","%ZVEMREB",95,0)
 NEW BOT
"RTN","%ZVEMREB",96,0)
 S BOT=$O(CD(""),-1)
"RTN","%ZVEMREB",97,0)
 I YND<BOT D  ;Move to bottom of line
"RTN","%ZVEMREB",98,0)
 . S YCUR=YCUR+BOT-YND
"RTN","%ZVEMREB",99,0)
 . S YND=YND+BOT-YND
"RTN","%ZVEMREB",100,0)
 . S DX=XCUR,DY=YCUR X VEES("CRSR")
"RTN","%ZVEMREB",101,0)
 ;--> Quit if line to be closed is below scrn bottom
"RTN","%ZVEMREB",102,0)
 D ADJCLOS
"RTN","%ZVEMREB",103,0)
 Q:YND'<(VEET("BOT")-1)
"RTN","%ZVEMREB",104,0)
 D CLOSE^%ZVEMREO
"RTN","%ZVEMREB",105,0)
 Q
"RTN","%ZVEMREJ")
0^98^B18152564
"RTN","%ZVEMREJ",1,0)
%ZVEMREJ ;DJB,VRR**EDIT - JOIN,BREAK [10/22/96 12:11pm]
"RTN","%ZVEMREJ",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMREJ",3,0)
 ;
"RTN","%ZVEMREJ",4,0)
BREAK ;Break a line
"RTN","%ZVEMREJ",5,0)
 NEW CD,CD1,CD2,XVAL
"RTN","%ZVEMREJ",6,0)
 S CD=^TMP("VEE","IR"_VRRS,$J,YND),XVAL=$$XCHARDEL^%ZVEMRU(CD)
"RTN","%ZVEMREJ",7,0)
 I CD[$C(30),XVAL-XCUR'>1 W $C(7) Q
"RTN","%ZVEMREJ",8,0)
 I CD'[$C(30),XVAL'>9 W $C(7) Q
"RTN","%ZVEMREJ",9,0)
 S CD1=$E(CD,1,XVAL-1),CD2=$E(CD,XVAL,9999)
"RTN","%ZVEMREJ",10,0)
 ;-> Strip starting/trailing spaces
"RTN","%ZVEMREJ",11,0)
 F  Q:$E(CD1,$L(CD1))'=" "  D  Q:CD1']""
"RTN","%ZVEMREJ",12,0)
 . S CD1=$E(CD1,1,$L(CD1)-1)
"RTN","%ZVEMREJ",13,0)
 . S XCUR=XCUR-1
"RTN","%ZVEMREJ",14,0)
 F  Q:$E(CD2,1)'=" "  S CD2=$E(CD2,2,999) Q:CD2']""
"RTN","%ZVEMREJ",15,0)
 I CD1[$C(30),$P(CD1,$C(30),2)']"" W $C(7) Q
"RTN","%ZVEMREJ",16,0)
 I CD2']"" W $C(7) Q
"RTN","%ZVEMREJ",17,0)
 S FLAGSAVE=1,^TMP("VEE","IR"_VRRS,$J,YND)=CD1
"RTN","%ZVEMREJ",18,0)
 I CD1']"" D  ;.................................Delete this node
"RTN","%ZVEMREJ",19,0)
 . KILL ^TMP("VEE","SAVE",$J) S ^($J,YND)=""
"RTN","%ZVEMREJ",20,0)
 . D DELETE^%ZVEMRP1(1)
"RTN","%ZVEMREJ",21,0)
 . S YCUR=YCUR-1,YND=YND-1
"RTN","%ZVEMREJ",22,0)
 D BALANCE
"RTN","%ZVEMREJ",23,0)
 Q
"RTN","%ZVEMREJ",24,0)
BALANCE ;Rebuild balance of line plus any additional scrolled lines.
"RTN","%ZVEMREJ",25,0)
 NEW I,NUM
"RTN","%ZVEMREJ",26,0)
 KILL ^TMP("VEE","SAVE",$J)
"RTN","%ZVEMREJ",27,0)
 S NUM=$$LINENUM^%ZVEMRU(YND)+1
"RTN","%ZVEMREJ",28,0)
 F I=YND+1:1 Q:^TMP("VEE","IR"_VRRS,$J,I)[$C(30)  Q:^(I)=" <> <> <>"  S CD2=CD2_$E(^(I),10,9999) S ^TMP("VEE","SAVE",$J,I)=""
"RTN","%ZVEMREJ",29,0)
 S ^%ZVEMS("E","SAVEVRR",$J,1)=NUM_$J("",9-$L(NUM))_$C(30)_$E(CD2,1,VEE("IOM")-11)
"RTN","%ZVEMREJ",30,0)
 S CD2=$E(CD2,VEE("IOM")-10,9999)
"RTN","%ZVEMREJ",31,0)
 F I=2:1 Q:CD2']""  D  ;
"RTN","%ZVEMREJ",32,0)
 . S ^%ZVEMS("E","SAVEVRR",$J,I)=$J("",9)_$E(CD2,1,VEE("IOM")-11)
"RTN","%ZVEMREJ",33,0)
 . S CD2=$E(CD2,VEE("IOM")-10,9999)
"RTN","%ZVEMREJ",34,0)
 S ^%ZVEMS("E","SAVEVRR",$J,I)=""
"RTN","%ZVEMREJ",35,0)
 I $D(^TMP("VEE","SAVE",$J)) D DELETE^%ZVEMRP1(1)
"RTN","%ZVEMREJ",36,0)
 D PASTE^%ZVEMRP1
"RTN","%ZVEMREJ",37,0)
 Q
"RTN","%ZVEMREJ",38,0)
 ;====================================================================
"RTN","%ZVEMREJ",39,0)
JOINMSG ;You may not use Line 1 in a join.
"RTN","%ZVEMREJ",40,0)
 W $C(7)
"RTN","%ZVEMREJ",41,0)
 S DX=$X X VEES("CRSR") W @VEES("BLANK_C_EOL")
"RTN","%ZVEMREJ",42,0)
 X VEES("CRSR") W "  Line 1 may not be used in a JOIN"
"RTN","%ZVEMREJ",43,0)
 D PAUSE^%ZVEMKC(0)
"RTN","%ZVEMREJ",44,0)
 Q
"RTN","%ZVEMREJ",45,0)
JOINA ;Join current line to next line
"RTN","%ZVEMREJ",46,0)
 NEW CD,CD1,CD2,HELP,LN1,LN2,ND1,ND2,X,YNDSAVE
"RTN","%ZVEMREJ",47,0)
 S LN1=$$LINENUM^%ZVEMRU($P(FLAGMENU,"^",1))-1
"RTN","%ZVEMREJ",48,0)
 I LN1=1 D JOINMSG Q  ;.................Can't use title line in Join
"RTN","%ZVEMREJ",49,0)
 I LN1'>0!(LN1=VRRHIGH) W $C(7) Q
"RTN","%ZVEMREJ",50,0)
 S ND1=$$GETNODE^%ZVEMRU(LN1) I ND1=0 W $C(7) Q
"RTN","%ZVEMREJ",51,0)
 S LN2=LN1+1
"RTN","%ZVEMREJ",52,0)
 S ND2=$$GETNODE^%ZVEMRU(LN2) I ND2=0 W $C(7) Q
"RTN","%ZVEMREJ",53,0)
 S FLAGSAVE=1 D JOIN2
"RTN","%ZVEMREJ",54,0)
 Q
"RTN","%ZVEMREJ",55,0)
JOIN ;Join 2 lines selected by user
"RTN","%ZVEMREJ",56,0)
 NEW CD,CD1,CD2,HELP,LN1,LN2,ND1,ND2,X,YNDSAVE
"RTN","%ZVEMREJ",57,0)
 S HELP="  Enter a #. Line 2 will be joined to Line 1."
"RTN","%ZVEMREJ",58,0)
JOIN1 S LN1=$$GETLINE("1ST LINE NUMBER",HELP) Q:LN1'>0
"RTN","%ZVEMREJ",59,0)
 I LN1=1 D JOINMSG G JOIN1
"RTN","%ZVEMREJ",60,0)
 S ND1=$$GETNODE^%ZVEMRU(LN1) I ND1=0 W $C(7) G JOIN1
"RTN","%ZVEMREJ",61,0)
 S LN2=$$GETLINE("2ND LINE NUMBER",HELP) G:LN2'>0 JOIN1
"RTN","%ZVEMREJ",62,0)
 I LN2=1 D JOINMSG G JOIN1
"RTN","%ZVEMREJ",63,0)
 S ND2=$$GETNODE^%ZVEMRU(LN2) I ND2=0 W $C(7) G JOIN1
"RTN","%ZVEMREJ",64,0)
 I ND1=ND2 W $C(7) G JOIN1
"RTN","%ZVEMREJ",65,0)
 S FLAGSAVE=1 D JOIN2
"RTN","%ZVEMREJ",66,0)
 Q
"RTN","%ZVEMREJ",67,0)
JOIN2 ;Join line 2 to the end of line 1
"RTN","%ZVEMREJ",68,0)
 ;DELETE^%ZVEMRP1 deletes nodes in ^TMP("VEE","SAVE",$J,NODE) array
"RTN","%ZVEMREJ",69,0)
 ;-> Collapse 1st line
"RTN","%ZVEMREJ",70,0)
 S CD1=^TMP("VEE","IR"_VRRS,$J,ND1)
"RTN","%ZVEMREJ",71,0)
 S ^TMP("VEE","SAVE",$J,ND1)=""
"RTN","%ZVEMREJ",72,0)
 F I=ND1+1:1 Q:^TMP("VEE","IR"_VRRS,$J,I)[$C(30)  Q:^(I)=" <> <> <>"  D  ;
"RTN","%ZVEMREJ",73,0)
 . S CD1=CD1_$E(^TMP("VEE","IR"_VRRS,$J,I),10,9999)
"RTN","%ZVEMREJ",74,0)
 . S ^TMP("VEE","SAVE",$J,I)=""
"RTN","%ZVEMREJ",75,0)
 ;-> Delete 1st line and adjust line numbers
"RTN","%ZVEMREJ",76,0)
 S X=0
"RTN","%ZVEMREJ",77,0)
 I ND2>ND1 F  S X=$O(^TMP("VEE","SAVE",$J,X)) Q:X'>0  S ND2=ND2-1
"RTN","%ZVEMREJ",78,0)
 D DELETE^%ZVEMRP1(1)
"RTN","%ZVEMREJ",79,0)
 ;-> Collapse 2nd line
"RTN","%ZVEMREJ",80,0)
 S CD2=$P(^TMP("VEE","IR"_VRRS,$J,ND2),$C(30),2,999)
"RTN","%ZVEMREJ",81,0)
 S ^TMP("VEE","SAVE",$J,ND2)=""
"RTN","%ZVEMREJ",82,0)
 F I=ND2+1:1 Q:^TMP("VEE","IR"_VRRS,$J,I)[$C(30)  Q:^(I)=" <> <> <>"  D  ;
"RTN","%ZVEMREJ",83,0)
 . S CD2=CD2_$E(^(I),10,9999)
"RTN","%ZVEMREJ",84,0)
 . S ^TMP("VEE","SAVE",$J,I)=""
"RTN","%ZVEMREJ",85,0)
 ;-> Delete 2nd line and adjust line numbers
"RTN","%ZVEMREJ",86,0)
 S X=0
"RTN","%ZVEMREJ",87,0)
 I ND1>ND2 F  S X=$O(^TMP("VEE","SAVE",$J,X)) Q:X'>0  S ND1=ND1-1
"RTN","%ZVEMREJ",88,0)
 D DELETE^%ZVEMRP1(1)
"RTN","%ZVEMREJ",89,0)
 ;-> Join lines, re-insert, and adjust line numbers.
"RTN","%ZVEMREJ",90,0)
 S CD=CD1_" "_CD2
"RTN","%ZVEMREJ",91,0)
 S ^%ZVEMS("E","SAVEVRR",$J,1)=$E(CD,1,VEE("IOM")-1)
"RTN","%ZVEMREJ",92,0)
 S CD=$E(CD,VEE("IOM"),9999)
"RTN","%ZVEMREJ",93,0)
 F I=2:1 Q:CD']""  D  ;
"RTN","%ZVEMREJ",94,0)
 . S ^%ZVEMS("E","SAVEVRR",$J,I)=$J("",9)_$E(CD,1,VEE("IOM")-11)
"RTN","%ZVEMREJ",95,0)
 . S CD=$E(CD,VEE("IOM")-10,9999)
"RTN","%ZVEMREJ",96,0)
 S ^%ZVEMS("E","SAVEVRR",$J,I)=""
"RTN","%ZVEMREJ",97,0)
 S YND=ND1-1 S:YND<1 YND=1
"RTN","%ZVEMREJ",98,0)
 D PASTE^%ZVEMRP1
"RTN","%ZVEMREJ",99,0)
 Q
"RTN","%ZVEMREJ",100,0)
GETLINE(PROMPT,HELP,OFFSET) ;Return line number or zero to quit
"RTN","%ZVEMREJ",101,0)
 ;OFFSET=1 Allow TAG+OFFSET
"RTN","%ZVEMREJ",102,0)
 NEW LN
"RTN","%ZVEMREJ",103,0)
 S PROMPT=$G(PROMPT),HELP=$G(HELP)
"RTN","%ZVEMREJ",104,0)
 S DX=0,DY=VEET("S2")+1 X VEES("CRSR") W @VEES("BLANK_C_EOL")
"RTN","%ZVEMREJ",105,0)
 X VEES("CRSR") W @VEE("RON")," "_PROMPT_":",@VEE("ROFF")
"RTN","%ZVEMREJ",106,0)
GETLINE1 S DX=$L(PROMPT)+3 X VEES("CRSR") W @VEES("BLANK_C_EOL")
"RTN","%ZVEMREJ",107,0)
 X VEES("CRSR") F I=1:1:4 W "_"
"RTN","%ZVEMREJ",108,0)
 X VEES("CRSR") S LN=$$READ^%ZVEMKRN()
"RTN","%ZVEMREJ",109,0)
 I LN="^" Q 0
"RTN","%ZVEMREJ",110,0)
 I LN?1.E1"+"1.N,$G(OFFSET)=1 Q LN ;Goto Tag+Offset
"RTN","%ZVEMREJ",111,0)
 I ",<ESC>,<F1E>,<F1Q>,<RET>,<TO>,"[(","_VEE("K")_",") Q 0
"RTN","%ZVEMREJ",112,0)
 I LN'?1.N!(LN<0) D  G GETLINE1
"RTN","%ZVEMREJ",113,0)
 . W:"??"'[LN $C(7)
"RTN","%ZVEMREJ",114,0)
 . S DX=$L(PROMPT)+2 X VEES("CRSR") W @VEES("BLANK_C_EOL")
"RTN","%ZVEMREJ",115,0)
 . X VEES("CRSR") W HELP D PAUSE^%ZVEMKC(0)
"RTN","%ZVEMREJ",116,0)
 Q LN
"RTN","%ZVEMREL")
0^99^B8434496
"RTN","%ZVEMREL",1,0)
%ZVEMREL ;DJB,VRR**EDIT - Process Line Tags ; 12/25/00 4:58pm
"RTN","%ZVEMREL",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMREL",3,0)
 ;
"RTN","%ZVEMREL",4,0)
 ;Determine location of cursor in relation to the line of code, and
"RTN","%ZVEMREL",5,0)
 ;allow the editing of line tags.
"RTN","%ZVEMREL",6,0)
 ;Return: "Q"=Quit  "C"=Continue
"RTN","%ZVEMREL",7,0)
 ;$$LNSTART returns format "6^11"
"RTN","%ZVEMREL",8,0)
 ;             Where: 6=Location of character where Tag starts
"RTN","%ZVEMREL",9,0)
 ;                   11=Location of character where Line starts
"RTN","%ZVEMREL",10,0)
 ;===================================================================
"RTN","%ZVEMREL",11,0)
CHKADD() ;Check for valid addition. Process certain additions.
"RTN","%ZVEMREL",12,0)
 ;KEY=String entered (^%ZVEMRE)
"RTN","%ZVEMREL",13,0)
 NEW PART,TG
"RTN","%ZVEMREL",14,0)
 I $G(FLAGVPE)'["EDIT"!(CD(NUM)=" <> <> <>") S PART="Q"
"RTN","%ZVEMREL",15,0)
 E  S PART=$$LNSTART^%ZVEMRU(CD(NUM)) D  ;..TagStart^LineStart
"RTN","%ZVEMREL",16,0)
 . I XCUR+3>$P(PART,"^",2) S PART="C" Q  ;..Cursor's on Line side
"RTN","%ZVEMREL",17,0)
 . I XCUR+3>$P(PART,"^",1) Q  ;.............Cursor's on Tag side
"RTN","%ZVEMREL",18,0)
 . I PART="11^11",XCUR<9 S PART="ADD" Q  ;..Start a new tag
"RTN","%ZVEMREL",19,0)
 . S PART="Q" ;.........Cursor's in area where no adding should occur
"RTN","%ZVEMREL",20,0)
 I PART="Q" D  ;........Redraw area where user's input printed
"RTN","%ZVEMREL",21,0)
 . W $C(7) NEW X S X=1
"RTN","%ZVEMREL",22,0)
 . I CD(NUM)[$C(30) S X=$S((XCUR+3)>$F(CD(NUM),$C(30)):2,1:1)
"RTN","%ZVEMREL",23,0)
 . S DX=XCUR,DY=YCUR X VEES("CRSR")
"RTN","%ZVEMREL",24,0)
 . I $E(CD(NUM),XCUR+X)']"" W " "
"RTN","%ZVEMREL",25,0)
 . E  W $E(CD(NUM),XCUR+X)
"RTN","%ZVEMREL",26,0)
 I "C,Q"[PART Q PART ;..................Quit if [Q]uit or [C]ontinue
"RTN","%ZVEMREL",27,0)
 I $P(PART,"^",1)=1 Q "C" ;.............Tag flush with left side
"RTN","%ZVEMREL",28,0)
 S TG=$P(CD(NUM),$C(30),1) ;............Set TG=Line Tag
"RTN","%ZVEMREL",29,0)
 ;-> Add new tag
"RTN","%ZVEMREL",30,0)
 I PART="ADD" S XCUR=8,TG="       "_KEY_" " D WRITE Q "Q"
"RTN","%ZVEMREL",31,0)
 ;-> Tag is less than 8 char & should expand into space on left side
"RTN","%ZVEMREL",32,0)
 S TG=$E(TG,2,999) ;....................Remove space on left
"RTN","%ZVEMREL",33,0)
 ;-> If input is at immediate left side of tag, handle differently
"RTN","%ZVEMREL",34,0)
 I (XCUR+1)<$P(PART,"^",1) D  D WRITE Q "Q"
"RTN","%ZVEMREL",35,0)
 . S TG=$E(TG,1,XCUR)_KEY_$E(TG,XCUR+1,999)
"RTN","%ZVEMREL",36,0)
 S TG=$E(TG,1,XCUR-1)_KEY_$E(TG,XCUR,999)
"RTN","%ZVEMREL",37,0)
 D WRITE
"RTN","%ZVEMREL",38,0)
 Q "Q"
"RTN","%ZVEMREL",39,0)
 ;
"RTN","%ZVEMREL",40,0)
CHKDEL() ;Check for valid deletion. Process certain deletions.
"RTN","%ZVEMREL",41,0)
 ;VK=Key struck (^%ZVEMRE)
"RTN","%ZVEMREL",42,0)
 NEW L,PART,TG,XPOS
"RTN","%ZVEMREL",43,0)
 S XPOS=$S($G(VK)="<DEL>":XCUR,1:XCUR-1)
"RTN","%ZVEMREL",44,0)
 I $G(FLAGVPE)'["EDIT"!(CD(NUM)=" <> <> <>") W $C(7) Q "Q"
"RTN","%ZVEMREL",45,0)
 S PART=$$LNSTART^%ZVEMRU(CD(NUM))
"RTN","%ZVEMREL",46,0)
 D  ;
"RTN","%ZVEMREL",47,0)
 . I XCUR+2>$P(PART,"^",2) S PART="C" Q  ;..Cursor's on Line side
"RTN","%ZVEMREL",48,0)
 . I XCUR+2=$P(PART,"^",2) D  Q  ;..........Cursor's at start of line
"RTN","%ZVEMREL",49,0)
 . . S PART=$S($G(VK)="<DEL>":"C",1:"Q")
"RTN","%ZVEMREL",50,0)
 . I XCUR+1>$P(PART,"^",1) D  Q  ;..........Cursor's on Tag side
"RTN","%ZVEMREL",51,0)
 . . Q:$G(VK)'="<DEL>"  I XCUR=($P(PART,"^",2)-3) S PART="Q"
"RTN","%ZVEMREL",52,0)
 . I XCUR+1=$P(PART,"^",1),$G(VK)="<DEL>" Q  ;Delete 1st char of Tag
"RTN","%ZVEMREL",53,0)
 . S PART="Q"
"RTN","%ZVEMREL",54,0)
 I "C,Q"[PART W:PART="Q" $C(7) Q PART
"RTN","%ZVEMREL",55,0)
 S TG=$P(CD(NUM),$C(30),1) ;................Set TG=Line Tag
"RTN","%ZVEMREL",56,0)
 ;-> If Tag>9 it should collapse from the right side
"RTN","%ZVEMREL",57,0)
 I $L(TG)>9 Q "C"
"RTN","%ZVEMREL",58,0)
 ;-> If Tag'>9 it should collapse from the left side
"RTN","%ZVEMREL",59,0)
 S TG=" "_$E(TG,1,XPOS)_$E(TG,XPOS+2,999)
"RTN","%ZVEMREL",60,0)
 ;-> See if tag is deleted. If so, add line number
"RTN","%ZVEMREL",61,0)
 I TG?1." " S L=$$LINENUM^%ZVEMRU(YND),TG=L-1_$J("",9-$L(L-1))
"RTN","%ZVEMREL",62,0)
 D WRITE
"RTN","%ZVEMREL",63,0)
 Q "Q"
"RTN","%ZVEMREL",64,0)
 ;
"RTN","%ZVEMREL",65,0)
WRITE ;Display adjusted tag
"RTN","%ZVEMREL",66,0)
 S CD(NUM)=TG_$C(30)_$P(CD(NUM),$C(30),2)
"RTN","%ZVEMREL",67,0)
 S DX=0,DY=YCUR X VEES("CRSR")
"RTN","%ZVEMREL",68,0)
 W @VEES("BLANK_C_EOL") X VEES("XY")
"RTN","%ZVEMREL",69,0)
 W $P(CD(NUM),$C(30),1)
"RTN","%ZVEMREL",70,0)
 W $P(CD(NUM),$C(30),2)
"RTN","%ZVEMREL",71,0)
 D ADJOPEN1^%ZVEMREA
"RTN","%ZVEMREL",72,0)
 Q
"RTN","%ZVEMREM")
0^100^B6609745
"RTN","%ZVEMREM",1,0)
%ZVEMREM ;DJB,VRR**EDIT - Move to different parts of a line ; 12/26/00 7:56am
"RTN","%ZVEMREM",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMREM",3,0)
 ;
"RTN","%ZVEMREM",4,0)
LNBEG ;Go to beginning of line
"RTN","%ZVEMREM",5,0)
 NEW TMP
"RTN","%ZVEMREM",6,0)
 S TMP=$G(^TMP("VEE","IR"_VRRS,$J,YND)) Q:TMP=" <> <> <>"!(TMP']"")
"RTN","%ZVEMREM",7,0)
 I TMP'[$C(30) S TMP=YND D  ;
"RTN","%ZVEMREM",8,0)
 . F  S TMP=$O(^TMP("VEE","IR"_VRRS,$J,TMP),-1) D  Q:$G(^(TMP))[$C(30)!(YND=1)
"RTN","%ZVEMREM",9,0)
 . . I YND=VEET("TOP") D UP^%ZVEMRE(1) Q
"RTN","%ZVEMREM",10,0)
 . . S:YCUR>1 YCUR=YCUR-1 S:YND>1 YND=YND-1
"RTN","%ZVEMREM",11,0)
 S (DX,XCUR)=$$LNBEG1() X VEES("CRSR")
"RTN","%ZVEMREM",12,0)
 Q
"RTN","%ZVEMREM",13,0)
LNBEG1() ;Return beginning of line.
"RTN","%ZVEMREM",14,0)
 NEW I,START,TMP,TMP1
"RTN","%ZVEMREM",15,0)
 S TMP=$G(^TMP("VEE","IR"_VRRS,$J,YND)) I TMP']"" Q 0
"RTN","%ZVEMREM",16,0)
 S DY=YCUR,START=0
"RTN","%ZVEMREM",17,0)
 F I=1:1 S TMP1=$E(TMP,I) Q:TMP1?1ACP&(TMP1'=" ")  S START=START+1
"RTN","%ZVEMREM",18,0)
 Q START
"RTN","%ZVEMREM",19,0)
LNEND ;Go to end of line
"RTN","%ZVEMREM",20,0)
 Q:$G(^TMP("VEE","IR"_VRRS,$J,YND))=" <> <> <>"
"RTN","%ZVEMREM",21,0)
 NEW TMP,X S X=YND
"RTN","%ZVEMREM",22,0)
 F  S X=$O(^TMP("VEE","IR"_VRRS,$J,X)) Q:^(X)[$C(30)!(^(X)=" <> <> <>")  D  ;
"RTN","%ZVEMREM",23,0)
 . I YND=(VEET("BOT")-1) D DOWN^%ZVEMRE(1) Q
"RTN","%ZVEMREM",24,0)
 . S YCUR=YCUR+1,YND=YND+1
"RTN","%ZVEMREM",25,0)
 S TMP=$G(^TMP("VEE","IR"_VRRS,$J,YND))
"RTN","%ZVEMREM",26,0)
 S DY=YCUR,(DX,XCUR)=$L(TMP)-(TMP[$C(30)) X VEES("CRSR")
"RTN","%ZVEMREM",27,0)
 Q
"RTN","%ZVEMREM",28,0)
LNLEFT ;Go left 15 spaces
"RTN","%ZVEMREM",29,0)
 NEW START
"RTN","%ZVEMREM",30,0)
 S START=$$LNBEG1(),DY=YCUR
"RTN","%ZVEMREM",31,0)
 I XCUR-15>START S (DX,XCUR)=XCUR-15 X VEES("CRSR") Q
"RTN","%ZVEMREM",32,0)
 S (DX,XCUR)=XCUR-(XCUR-START) X VEES("CRSR")
"RTN","%ZVEMREM",33,0)
 Q
"RTN","%ZVEMREM",34,0)
LNRIGHT ;Go right 15 spaces
"RTN","%ZVEMREM",35,0)
 NEW L,TMP
"RTN","%ZVEMREM",36,0)
 S TMP=$G(^TMP("VEE","IR"_VRRS,$J,YND)) Q:TMP']""  Q:TMP=" <> <> <>"
"RTN","%ZVEMREM",37,0)
 S L=$L(TMP)-(TMP[$C(30)) Q:XCUR=L  S DY=YCUR
"RTN","%ZVEMREM",38,0)
 I XCUR+15'>L S (DX,XCUR)=XCUR+15 X VEES("CRSR") Q
"RTN","%ZVEMREM",39,0)
 S (DX,XCUR)=XCUR+(L-XCUR) X VEES("CRSR")
"RTN","%ZVEMREM",40,0)
 Q
"RTN","%ZVEMREM",41,0)
LNLMAR ;Left margin of current line
"RTN","%ZVEMREM",42,0)
 NEW L,TMP
"RTN","%ZVEMREM",43,0)
 S TMP=$G(^TMP("VEE","IR"_VRRS,$J,YND)) Q:TMP']""  Q:TMP=" <> <> <>"
"RTN","%ZVEMREM",44,0)
 I TMP'[$C(30) S L=9
"RTN","%ZVEMREM",45,0)
 E  S L=$L($P(TMP,$C(30),1))
"RTN","%ZVEMREM",46,0)
 S DY=YCUR,(DX,XCUR)=L X VEES("CRSR")
"RTN","%ZVEMREM",47,0)
 Q
"RTN","%ZVEMREM",48,0)
LNRMAR ;Right margin of current line
"RTN","%ZVEMREM",49,0)
 NEW L,TMP
"RTN","%ZVEMREM",50,0)
 S TMP=$G(^TMP("VEE","IR"_VRRS,$J,YND)) Q:TMP']""  Q:TMP=" <> <> <>"
"RTN","%ZVEMREM",51,0)
 S L=$L(TMP)-(TMP[$C(30)) Q:XCUR=L
"RTN","%ZVEMREM",52,0)
 S DY=YCUR,(DX,XCUR)=L X VEES("CRSR")
"RTN","%ZVEMREM",53,0)
 Q
"RTN","%ZVEMREM",54,0)
LNDOWN ;Scroll down 1 routine line (<ESC>L).
"RTN","%ZVEMREM",55,0)
 KILL DIRHLD ;Tracks cursor for <AU> & <AD>
"RTN","%ZVEMREM",56,0)
 NEW ND
"RTN","%ZVEMREM",57,0)
 Q:$G(^TMP("VEE","IR"_VRRS,$J,YND))=" <> <> <>"
"RTN","%ZVEMREM",58,0)
 D HIGHOFF^%ZVEMRE
"RTN","%ZVEMREM",59,0)
 F  D  Q:ND=" <> <> <>"!(ND[$C(30))
"RTN","%ZVEMREM",60,0)
 . S YND=YND+1,ND=$G(^TMP("VEE","IR"_VRRS,$J,YND))
"RTN","%ZVEMREM",61,0)
 . I YCUR'<(VEET("BOT")-VEET("TOP")) D  Q
"RTN","%ZVEMREM",62,0)
 . . S VEET("BOT")=VEET("BOT")+1,VEET("TOP")=VEET("TOP")+1
"RTN","%ZVEMREM",63,0)
 . . W !,$P(ND,$C(30),1),$P(ND,$C(30),2,99)
"RTN","%ZVEMREM",64,0)
 . S YCUR=YCUR+1
"RTN","%ZVEMREM",65,0)
 D HIGHON^%ZVEMRE
"RTN","%ZVEMREM",66,0)
 Q
"RTN","%ZVEMREO")
0^101^B12508668
"RTN","%ZVEMREO",1,0)
%ZVEMREO ;DJB,VRR**EDIT - Open/Close/Blank/Unblank lines ; 12/25/00 5:02pm
"RTN","%ZVEMREO",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMREO",3,0)
 ;
"RTN","%ZVEMREO",4,0)
OPEN ;Open a new line.
"RTN","%ZVEMREO",5,0)
 S XCUR=0
"RTN","%ZVEMREO",6,0)
 I YND<(VEET("BOT")-1) D  Q
"RTN","%ZVEMREO",7,0)
 . S YCUR=YCUR+1,YND=YND+1
"RTN","%ZVEMREO",8,0)
 . D INSERT(XCUR,YCUR-1)
"RTN","%ZVEMREO",9,0)
 . S DX=XCUR,DY=YCUR X VEES("CRSR")
"RTN","%ZVEMREO",10,0)
 ;Cursor is at bottom of screen
"RTN","%ZVEMREO",11,0)
 S YND=YND+1,VEET("BOT")=VEET("BOT")+1,VEET("TOP")=VEET("TOP")+1
"RTN","%ZVEMREO",12,0)
 S DX=XCUR,DY=YCUR X VEES("CRSR")
"RTN","%ZVEMREO",13,0)
 W !
"RTN","%ZVEMREO",14,0)
 Q
"RTN","%ZVEMREO",15,0)
CLOSE ;Close opened line
"RTN","%ZVEMREO",16,0)
 NEW GAP,I
"RTN","%ZVEMREO",17,0)
 ;Adjust when end of rtn is on screen
"RTN","%ZVEMREO",18,0)
 S GAP=VEET("TOP")+20>$O(^TMP("VEE","IR"_VRRS,$J,""),-1)
"RTN","%ZVEMREO",19,0)
 I GAP S VEET("GAP")=VEET("GAP")+1,VEET("BOT")=VEET("BOT")-1
"RTN","%ZVEMREO",20,0)
 S YND=YND-1,YCUR=YCUR-1
"RTN","%ZVEMREO",21,0)
 S DX=0,DY=YCUR
"RTN","%ZVEMREO",22,0)
 D REDRAW(YND+1,VEET("BOT"))
"RTN","%ZVEMREO",23,0)
 I GAP D ERASEBOT ;Clear lines leftover after " <> <> <>"
"RTN","%ZVEMREO",24,0)
 S DX=0,DY=YCUR X VEES("CRSR")
"RTN","%ZVEMREO",25,0)
 Q
"RTN","%ZVEMREO",26,0)
 ;=================================================================
"RTN","%ZVEMREO",27,0)
INSERT(DX,DY) ;Insert a line. Uses escape sequences not supported by MSM NT.
"RTN","%ZVEMREO",28,0)
 S DX=+$G(DX),DY=+$G(DY)
"RTN","%ZVEMREO",29,0)
 I $G(^%ZOSF("OS"))["MSM for Windows NT" D ZINSERT(DX,DY) Q
"RTN","%ZVEMREO",30,0)
 X VEES("CRSR")
"RTN","%ZVEMREO",31,0)
 W @VEES("INDEX"),@VEES("INSRT")
"RTN","%ZVEMREO",32,0)
 ;-> Inserting when end-of-file and there's space left on screen.
"RTN","%ZVEMREO",33,0)
 I VEET("GAP") S VEET("GAP")=VEET("GAP")-1,VEET("BOT")=VEET("BOT")+1
"RTN","%ZVEMREO",34,0)
 Q
"RTN","%ZVEMREO",35,0)
 ;
"RTN","%ZVEMREO",36,0)
ZINSERT(DX,DY) ;Insert a line. Don't use above escape sequences.
"RTN","%ZVEMREO",37,0)
 S DX=+$G(DX),DY=+$G(DY)+1 X VEES("CRSR")
"RTN","%ZVEMREO",38,0)
 W @VEES("BLANK_C_EOL") X VEES("XY")
"RTN","%ZVEMREO",39,0)
 ;-> Inserting when end-of-file and there's space left on screen.
"RTN","%ZVEMREO",40,0)
 I VEET("GAP") S VEET("GAP")=VEET("GAP")-1,VEET("BOT")=VEET("BOT")+1
"RTN","%ZVEMREO",41,0)
 D REDRAW(YND,VEET("BOT")-1)
"RTN","%ZVEMREO",42,0)
 S DX=0,DY=YCUR X VEES("CRSR")
"RTN","%ZVEMREO",43,0)
 Q
"RTN","%ZVEMREO",44,0)
 ;=================================================================
"RTN","%ZVEMREO",45,0)
ERASEBOT ;Erase lines leftover after "<> <> <>"
"RTN","%ZVEMREO",46,0)
 S DX=0,DY=VEET("BOT")-VEET("TOP")+1
"RTN","%ZVEMREO",47,0)
 Q:DY'<VEET("S2")
"RTN","%ZVEMREO",48,0)
 X VEES("CRSR")
"RTN","%ZVEMREO",49,0)
 W @VEES("BLANK_C_EOL")
"RTN","%ZVEMREO",50,0)
 X VEES("XY")
"RTN","%ZVEMREO",51,0)
 Q
"RTN","%ZVEMREO",52,0)
 ;
"RTN","%ZVEMREO",53,0)
PUSHDWN ;This would push all lines down when a line was closed, rather than
"RTN","%ZVEMREO",54,0)
 ;moving the next line up. I no longer do this.
"RTN","%ZVEMREO",55,0)
 NEW TMP
"RTN","%ZVEMREO",56,0)
 I YND'<(VEET("BOT")-1) D  Q
"RTN","%ZVEMREO",57,0)
 . S VEET("TOP")=VEET("TOP")-1
"RTN","%ZVEMREO",58,0)
 . S VEET("BOT")=VEET("BOT")-1
"RTN","%ZVEMREO",59,0)
 . D INSERT(0,(VEET("S1")-2))
"RTN","%ZVEMREO",60,0)
 . S YND=YND-1
"RTN","%ZVEMREO",61,0)
 . S DX=0,DY=(VEET("S1")-1) X VEES("CRSR")
"RTN","%ZVEMREO",62,0)
 . W @VEES("BLANK_C_EOL")
"RTN","%ZVEMREO",63,0)
 . X VEES("XY")
"RTN","%ZVEMREO",64,0)
 . S TMP=$G(^TMP("VEE","IR"_VRRS,$J,VEET("TOP")))
"RTN","%ZVEMREO",65,0)
 . W $P(TMP,$C(30),1)
"RTN","%ZVEMREO",66,0)
 . W $P(TMP,$C(30),2,99)
"RTN","%ZVEMREO",67,0)
 . S DX=XCUR,DY=YCUR X VEES("CRSR")
"RTN","%ZVEMREO",68,0)
 Q
"RTN","%ZVEMREO",69,0)
 ;====================================================================
"RTN","%ZVEMREO",70,0)
BLANK(NUM) ;Blank NUM lines for inserting messages
"RTN","%ZVEMREO",71,0)
 NEW I
"RTN","%ZVEMREO",72,0)
 S:$G(NUM)'>0 NUM=1
"RTN","%ZVEMREO",73,0)
 D @$S(YCUR<(VEET("BOT")-VEET("TOP")-NUM):"BLANKB",1:"BLANKA")
"RTN","%ZVEMREO",74,0)
 Q
"RTN","%ZVEMREO",75,0)
 ;
"RTN","%ZVEMREO",76,0)
BLANKA ;Blank lines ABOVE current line
"RTN","%ZVEMREO",77,0)
 F I=1:1:NUM D  ;
"RTN","%ZVEMREO",78,0)
 . S DX=0,DY=YCUR-I X VEES("CRSR")
"RTN","%ZVEMREO",79,0)
 . W @VEES("BLANK_C_EOL")
"RTN","%ZVEMREO",80,0)
 S DX=0,DY=YCUR-NUM X VEES("CRSR")
"RTN","%ZVEMREO",81,0)
 Q
"RTN","%ZVEMREO",82,0)
 ;
"RTN","%ZVEMREO",83,0)
BLANKB ;Blank lines BELOW current line
"RTN","%ZVEMREO",84,0)
 F I=1:1:NUM D  ;
"RTN","%ZVEMREO",85,0)
 . S DX=0,DY=YCUR+I X VEES("CRSR")
"RTN","%ZVEMREO",86,0)
 . W @VEES("BLANK_C_EOL")
"RTN","%ZVEMREO",87,0)
 S DX=0,DY=YCUR+1 X VEES("CRSR")
"RTN","%ZVEMREO",88,0)
 Q
"RTN","%ZVEMREO",89,0)
 ;
"RTN","%ZVEMREO",90,0)
REDRAW(START,END) ;Redraw rest of screen
"RTN","%ZVEMREO",91,0)
 ;START: YND+1        -or-   YND
"RTN","%ZVEMREO",92,0)
 ;END..: VEET("BOT")  -or-   VEET("BOT")-1
"RTN","%ZVEMREO",93,0)
 NEW I,TMP
"RTN","%ZVEMREO",94,0)
 F I=START:1 Q:I'<END  D  Q:$G(^(I))=" <> <> <>"
"RTN","%ZVEMREO",95,0)
 . S DY=DY+1 X VEES("CRSR")
"RTN","%ZVEMREO",96,0)
 . W @VEES("BLANK_C_EOL") X VEES("XY")
"RTN","%ZVEMREO",97,0)
 . S TMP=$G(^TMP("VEE","IR"_VRRS,$J,I))
"RTN","%ZVEMREO",98,0)
 . W $P(TMP,$C(30),1)
"RTN","%ZVEMREO",99,0)
 . W $P(TMP,$C(30),2,99)
"RTN","%ZVEMREO",100,0)
 Q
"RTN","%ZVEMREO",101,0)
 ;==================================================================
"RTN","%ZVEMREO",102,0)
 ;I don't remember why this code is here. Thought I'd keep it anyway.
"RTN","%ZVEMREO",103,0)
REDRAWX(NUM) ;
"RTN","%ZVEMREO",104,0)
 NEW I,TMP
"RTN","%ZVEMREO",105,0)
 D @$S(YCUR<(VEET("BOT")-VEET("TOP")-NUM):"REDRAWB",1:"REDRAWA")
"RTN","%ZVEMREO",106,0)
 S DX=XCUR,DY=YCUR X VEES("CRSR")
"RTN","%ZVEMREO",107,0)
 Q
"RTN","%ZVEMREO",108,0)
REDRAWA ;Redraw lines above current line
"RTN","%ZVEMREO",109,0)
 F I=1:1:NUM D  ;
"RTN","%ZVEMREO",110,0)
 . S DX=0,DY=YCUR-I X VEES("CRSR") W @VEES("BLANK_C_EOL") X VEES("XY")
"RTN","%ZVEMREO",111,0)
 . S TMP=$G(^TMP("VEE","IR"_VRRS,$J,YND-I)) Q:TMP']""
"RTN","%ZVEMREO",112,0)
 . W $P(TMP,$C(30),1),$P(TMP,$C(30),2,99)
"RTN","%ZVEMREO",113,0)
 Q
"RTN","%ZVEMREO",114,0)
REDRAWB ;Redraw lines below current line
"RTN","%ZVEMREO",115,0)
 F I=1:1:NUM D  ;
"RTN","%ZVEMREO",116,0)
 . S DX=0,DY=YCUR+I X VEES("CRSR") W @VEES("BLANK_C_EOL") X VEES("XY")
"RTN","%ZVEMREO",117,0)
 . S TMP=$G(^TMP("VEE","IR"_VRRS,$J,YND+I-1)) Q:TMP']""
"RTN","%ZVEMREO",118,0)
 . W $P(TMP,$C(30),1),$P(TMP,$C(30),2,99)
"RTN","%ZVEMREO",119,0)
 Q
"RTN","%ZVEMREP")
0^102^B14865653
"RTN","%ZVEMREP",1,0)
%ZVEMREP ;DJB,VRR**EDIT - Web,Html,Parse Rtn/Global,RETURN ; 1/6/01 8:38am
"RTN","%ZVEMREP",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMREP",3,0)
 ;
"RTN","%ZVEMREP",4,0)
WEB ;Web Mode
"RTN","%ZVEMREP",5,0)
 I FLAGMODE["WEB" D WEB^%ZVEMRER Q
"RTN","%ZVEMREP",6,0)
 S $P(FLAGMODE,"^",2)="WEB" D MODEON^%ZVEMRU("WEB")
"RTN","%ZVEMREP",7,0)
 Q
"RTN","%ZVEMREP",8,0)
 ;
"RTN","%ZVEMREP",9,0)
HTML ;HTML Code insertion
"RTN","%ZVEMREP",10,0)
 I FLAGMODE["HTML" D HTML^%ZVEMRER Q
"RTN","%ZVEMREP",11,0)
 S $P(FLAGMODE,"^",3)="HTML" D MODEON^%ZVEMRU("HTML")
"RTN","%ZVEMREP",12,0)
 Q
"RTN","%ZVEMREP",13,0)
 ;===================================================================
"RTN","%ZVEMREP",14,0)
PARSE ;Run rtn name from code at cursor position
"RTN","%ZVEMREP",15,0)
 NEW FLAG,I,LINE,RTN,TAG,TMP
"RTN","%ZVEMREP",16,0)
 ;
"RTN","%ZVEMREP",17,0)
 S LINE=$G(^TMP("VEE","IR"_VRRS,$J,YND))
"RTN","%ZVEMREP",18,0)
 ;
"RTN","%ZVEMREP",19,0)
 ;Find TAG^RTN
"RTN","%ZVEMREP",20,0)
 I LINE[$C(30) D  ;
"RTN","%ZVEMREP",21,0)
 . S TAG=$E(LINE,(XCUR-7),(XCUR+1)) ;Go left for TAG
"RTN","%ZVEMREP",22,0)
 . S RTN=$E(LINE,XCUR+3,XCUR+10) ;..Go right for LINE
"RTN","%ZVEMREP",23,0)
 E  D  ;
"RTN","%ZVEMREP",24,0)
 . S TAG=$E(LINE,10,XCUR)
"RTN","%ZVEMREP",25,0)
 . I $L(TAG)>8 S TAG=$E(TAG,$L(TAG)-7,$L(TAG))
"RTN","%ZVEMREP",26,0)
 . E  D
"RTN","%ZVEMREP",27,0)
 . . S TMP=$G(^TMP("VEE","IR"_VRRS,$J,YND-1))
"RTN","%ZVEMREP",28,0)
 . . S TAG=$E(TMP,$L(TMP)-(8-$L(TAG)+1),$L(TMP))_TAG
"RTN","%ZVEMREP",29,0)
 . S RTN=$E(LINE,XCUR+2,XCUR+9)
"RTN","%ZVEMREP",30,0)
 ;
"RTN","%ZVEMREP",31,0)
 ;Find starting point of TAG
"RTN","%ZVEMREP",32,0)
 F I=$L(TAG):-1:1 I $E(TAG,I)'?1AN,$E(TAG,I)'?1"%" D  Q
"RTN","%ZVEMREP",33,0)
 . S TAG=$E(TAG,(I+1),$L(TAG))
"RTN","%ZVEMREP",34,0)
 ;
"RTN","%ZVEMREP",35,0)
 ;If rtn name has scrolled to a 2nd line
"RTN","%ZVEMREP",36,0)
 I $L(RTN)'>7 D  ;
"RTN","%ZVEMREP",37,0)
 . S TMP=$G(^TMP("VEE","IR"_VRRS,$J,(YND+1)))
"RTN","%ZVEMREP",38,0)
 . Q:TMP[$C(30)  Q:TMP=" <> <> <>"
"RTN","%ZVEMREP",39,0)
 . S RTN=RTN_$E(TMP,10,9+8-$L(RTN))
"RTN","%ZVEMREP",40,0)
 ;
"RTN","%ZVEMREP",41,0)
 ;Save RTN & TAG before clearing symbol table.
"RTN","%ZVEMREP",42,0)
 S ^TMP("VEE",$J)=RTN_"^"_TAG
"RTN","%ZVEMREP",43,0)
 D SYMTAB^%ZVEMKST("C","VRR",VRRS) ;Save symbol table
"RTN","%ZVEMREP",44,0)
 ;
"RTN","%ZVEMREP",45,0)
 ;FLAG("<ESC>R")=If user hits <ESC>R to branch to rtn, and the rtn is
"RTN","%ZVEMREP",46,0)
 ;               locked, clear screen before displaying msg.
"RTN","%ZVEMREP",47,0)
 S FLAG("<ESC>R")=1
"RTN","%ZVEMREP",48,0)
 ;
"RTN","%ZVEMREP",49,0)
 S RTN=$$GETRTN()
"RTN","%ZVEMREP",50,0)
 S TAG=$P(^TMP("VEE",$J),"^",2)
"RTN","%ZVEMREP",51,0)
 I RTN'=0 D PARAM^%ZVEMR(RTN,TAG)
"RTN","%ZVEMREP",52,0)
 D SYMTAB^%ZVEMKST("R","VRR",VRRS) ;Restore symbol table
"RTN","%ZVEMREP",53,0)
 KILL ^TMP("VEE",$J)
"RTN","%ZVEMREP",54,0)
 Q
"RTN","%ZVEMREP",55,0)
 ;
"RTN","%ZVEMREP",56,0)
GETRTN() ;Parse routine name
"RTN","%ZVEMREP",57,0)
 NEW CODE,I,RTN
"RTN","%ZVEMREP",58,0)
 I VRRS>3 W $C(7) Q 0
"RTN","%ZVEMREP",59,0)
 S CODE=$P(^TMP("VEE",$J),"^",1)
"RTN","%ZVEMREP",60,0)
 S RTN=$E(CODE,1)
"RTN","%ZVEMREP",61,0)
 I RTN'="%",RTN'?1A W $C(7) Q 0
"RTN","%ZVEMREP",62,0)
 F I=2:1:8 Q:$E(CODE,I)'?1AN  S RTN=RTN_$E(CODE,I)
"RTN","%ZVEMREP",63,0)
 I '$$EXIST^%ZVEMKU(RTN) W $C(7) Q 0
"RTN","%ZVEMREP",64,0)
 Q RTN
"RTN","%ZVEMREP",65,0)
 ;===================================================================
"RTN","%ZVEMREP",66,0)
GLB ;Select global for viewing by hitting <ESCG>
"RTN","%ZVEMREP",67,0)
 NEW DIFF,TMP,TMP1,ZX,ZY,ZZ
"RTN","%ZVEMREP",68,0)
 I $G(FLAGGLB)']"" D  S KEY="S" Q
"RTN","%ZVEMREP",69,0)
 . S TMP=$G(^TMP("VEE","IR"_VRRS,$J,YND))
"RTN","%ZVEMREP",70,0)
 . I TMP[$C(30) S TMP=XCUR+2_"^"_$E(TMP,XCUR+2,XCUR+32)
"RTN","%ZVEMREP",71,0)
 . E  S TMP=XCUR+1_"^"_$E(TMP,XCUR+1,XCUR+31)
"RTN","%ZVEMREP",72,0)
 . S FLAGGLB=$P(TMP,"^",1)_"^"_YND_"^"_$P(TMP,"^",2,999)
"RTN","%ZVEMREP",73,0)
 . S TMP=$P(FLAGGLB,"^",3,999)  Q:$L(TMP)>29
"RTN","%ZVEMREP",74,0)
 . S TMP1=$G(^(YND+1))  Q:TMP1[$C(30)  Q:TMP1=" <> <> <>"
"RTN","%ZVEMREP",75,0)
 . S FLAGGLB=FLAGGLB_$E(TMP1,10,10+30-$L(TMP))
"RTN","%ZVEMREP",76,0)
 ;
"RTN","%ZVEMREP",77,0)
 S ZX=$P(FLAGGLB,"^",1),ZY=$P(FLAGGLB,"^",2),ZZ=$P(FLAGGLB,"^",3,999)
"RTN","%ZVEMREP",78,0)
 S DIFF=$S($G(^TMP("VEE","IR"_VRRS,$J,YND))[$C(30):XCUR+2,1:XCUR+1)
"RTN","%ZVEMREP",79,0)
 I (YND-ZY)>1 KILL FLAGGLB Q  ;Moved cursor too far
"RTN","%ZVEMREP",80,0)
 I (ZY>YND) KILL FLAGGLB Q  ;Moved cursor up
"RTN","%ZVEMREP",81,0)
 I YND>ZY S DIFF=ZX+(VEE("IOM")-ZX)+DIFF-10 I ZX>DIFF KILL FLAGGLB Q
"RTN","%ZVEMREP",82,0)
 S DIFF=DIFF-ZX+1,FLAGGLB=$E(ZZ,1,DIFF)
"RTN","%ZVEMREP",83,0)
 S ^TMP("VEE",$J)=FLAGGLB KILL FLAGGLB
"RTN","%ZVEMREP",84,0)
 D ENDSCR^%ZVEMKT2
"RTN","%ZVEMREP",85,0)
 D SYMTAB^%ZVEMKST("C","VRR",VRRS) ;Save symbol table
"RTN","%ZVEMREP",86,0)
 D PARAM^%ZVEMG(^TMP("VEE",$J))
"RTN","%ZVEMREP",87,0)
 KILL ^TMP("VEE",$J)
"RTN","%ZVEMREP",88,0)
 D SYMTAB^%ZVEMKST("R","VRR",VRRS) ;Restore symbol table
"RTN","%ZVEMREP",89,0)
 D REDRAW1^%ZVEMRU
"RTN","%ZVEMREP",90,0)
 Q
"RTN","%ZVEMREP",91,0)
 ;===================================================================
"RTN","%ZVEMREP",92,0)
RETURN ;Process <RET> key
"RTN","%ZVEMREP",93,0)
 ;If new rtn, open new line regardless of parameter setting.
"RTN","%ZVEMREP",94,0)
 I $G(^TMP("VEE","IR"_VRRS,$J,1))=" <> <> <>" D INSERT^%ZVEMRI(2) Q
"RTN","%ZVEMREP",95,0)
 NEW MD,X,Y
"RTN","%ZVEMREP",96,0)
 S MD="",FLAGSAVE=1
"RTN","%ZVEMREP",97,0)
 S:$G(VEE("ID"))>0 MD=$G(^%ZVEMS("E","PARAM",VEE("ID"),"RETURN"))
"RTN","%ZVEMREP",98,0)
 I MD'=2 D INSERT^%ZVEMRI(2) Q  ;Open line below
"RTN","%ZVEMREP",99,0)
 S X=$G(^TMP("VEE","IR"_VRRS,$J,YND))
"RTN","%ZVEMREP",100,0)
 I X=" <> <> <>"!(X']"") W $C(7) Q
"RTN","%ZVEMREP",101,0)
 ;--> If cursor is at beginning of line, open line above
"RTN","%ZVEMREP",102,0)
 I X[$C(30),XCUR'>($F(X,$C(30))-2) D INSERT^%ZVEMRI(1) Q
"RTN","%ZVEMREP",103,0)
 ;--> If cursor is at end of line, open line below
"RTN","%ZVEMREP",104,0)
 S Y=$G(^TMP("VEE","IR"_VRRS,$J,YND+1))
"RTN","%ZVEMREP",105,0)
 I Y[$C(30)!(Y=" <> <> <>"),XCUR>($L(X)-$S(X[$C(30):2,1:1)) D INSERT^%ZVEMRI(2) Q
"RTN","%ZVEMREP",106,0)
 ;--> Break line
"RTN","%ZVEMREP",107,0)
 D BREAK^%ZVEMREJ
"RTN","%ZVEMREP",108,0)
 D REDRAW^%ZVEMRU(YND)
"RTN","%ZVEMREP",109,0)
 Q
"RTN","%ZVEMRER")
0^103^B7317936
"RTN","%ZVEMRER",1,0)
%ZVEMRER ;DJB,VRR**EDIT - RUN menu choices ; 12/27/00 11:24pm
"RTN","%ZVEMRER",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMRER",3,0)
 ;
"RTN","%ZVEMRER",4,0)
RUN ;
"RTN","%ZVEMRER",5,0)
 KILL DIRHLD ;Tracks cursor for <AU> & <AD>
"RTN","%ZVEMRER",6,0)
 I VK="<F1AU>" D SCRNTOP Q  ;Cursor to top of scrn
"RTN","%ZVEMRER",7,0)
 I VK="<F2AU>" D UP^%ZVEMRE(5) Q  ;Cursor up 5 lines
"RTN","%ZVEMRER",8,0)
 I $G(^TMP("VEE","IR"_VRRS,$J,YND))=" <> <> <>" W $C(7) Q
"RTN","%ZVEMRER",9,0)
 I VK="<F1AL>" D LNBEG^%ZVEMREM Q  ;Cursor left
"RTN","%ZVEMRER",10,0)
 I VK="<F1AR>" D LNEND^%ZVEMREM Q  ;Cursor right
"RTN","%ZVEMRER",11,0)
 I VK="<F1AD>" D SCRNBOT Q  ;Cursor to bottom of scrn
"RTN","%ZVEMRER",12,0)
 I VK="<F2AL>" D LNLEFT^%ZVEMREM Q  ;Cursor left 15
"RTN","%ZVEMRER",13,0)
 I VK="<F2AR>" D LNRIGHT^%ZVEMREM Q  ;Cursor right 15
"RTN","%ZVEMRER",14,0)
 I VK="<F2AD>" D DOWN^%ZVEMRE(5) Q  ;Cursor down 5 lines
"RTN","%ZVEMRER",15,0)
 I VK="<F1F1>" D LNLMAR^%ZVEMREM Q  ;Cursor to left margin
"RTN","%ZVEMRER",16,0)
 I VK="<F2F2>" D LNRMAR^%ZVEMREM Q  ;Cursor to right margin
"RTN","%ZVEMRER",17,0)
 I VK="<F1L>" D LNDOWN^%ZVEMREM Q  ;Cursor down 1 rtn line
"RTN","%ZVEMRER",18,0)
 I ",<BS>,<DEL>,"[(","_VK_",") D  D ^%ZVEMREB Q  ;Delete
"RTN","%ZVEMRER",19,0)
 . S:$G(VEE("BS"))="SAME" VK="<BS>" S FLAGSAVE=1
"RTN","%ZVEMRER",20,0)
 Q
"RTN","%ZVEMRER",21,0)
 ;
"RTN","%ZVEMRER",22,0)
RUN2 ;Help Text
"RTN","%ZVEMRER",23,0)
 D ENDSCR^%ZVEMKT2
"RTN","%ZVEMRER",24,0)
 I VK="<ESCH>" D HELP^%ZVEMKT("VRR1") ;Help text
"RTN","%ZVEMRER",25,0)
 I VK="<ESCK>" D HELP^%ZVEMKT("VRR2") ;Keyboard help
"RTN","%ZVEMRER",26,0)
 D REDRAW1^%ZVEMRU
"RTN","%ZVEMRER",27,0)
 Q
"RTN","%ZVEMRER",28,0)
RUN3 ;Goto Top/Bottom of Rtn
"RTN","%ZVEMRER",29,0)
 KILL DIRHLD ;Tracks cursor for <AU> & <AD>
"RTN","%ZVEMRER",30,0)
 I ",<F4AR>,<END>,"[(","_VK_",") D  Q  ;Goto bottom of rtn
"RTN","%ZVEMRER",31,0)
 . D BOTTOM^%ZVEMKT2("IR"_VRRS,1)
"RTN","%ZVEMRER",32,0)
 . S YND=VEET("TOP")
"RTN","%ZVEMRER",33,0)
 . S YCUR=$O(^TMP("VEE","IR"_VRRS,$J,""),-1)-YND
"RTN","%ZVEMRER",34,0)
 . S:YCUR<1 YCUR=1
"RTN","%ZVEMRER",35,0)
 I ",<F4AL>,<HOME>,"[(","_VK_",") D  Q  ;Goto top of rtn
"RTN","%ZVEMRER",36,0)
 . S (YCUR,YND,VEET("TOP"))=1 D REDRAW1^%ZVEMRU
"RTN","%ZVEMRER",37,0)
 Q
"RTN","%ZVEMRER",38,0)
BLOCK(QUIT) ;Turn off Block mode
"RTN","%ZVEMRER",39,0)
 S $P(FLAGMODE,"^",1)="" D MODEOFF^%ZVEMRU("BLOCK",$G(QUIT))
"RTN","%ZVEMRER",40,0)
 Q
"RTN","%ZVEMRER",41,0)
WEB ;Turn off Web mode
"RTN","%ZVEMRER",42,0)
 S $P(FLAGMODE,"^",2)="" D MODEOFF^%ZVEMRU("WEB")
"RTN","%ZVEMRER",43,0)
 Q
"RTN","%ZVEMRER",44,0)
HTML ;Turn off HTML mode
"RTN","%ZVEMRER",45,0)
 S $P(FLAGMODE,"^",3)="" D MODEOFF^%ZVEMRU("HTML")
"RTN","%ZVEMRER",46,0)
 Q
"RTN","%ZVEMRER",47,0)
BACKUP ;Backup a page
"RTN","%ZVEMRER",48,0)
 S (VEET("BOT"),VEET("TOP"))=$S(VEET("TOP")'>VEET("SL"):1,1:VEET("TOP")-VEET("SL"))
"RTN","%ZVEMRER",49,0)
 S YND=VEET("TOP")+YCUR-1,VEET("GAP")=VEET("SL")
"RTN","%ZVEMRER",50,0)
 D SCROLL^%ZVEMKT2(1)
"RTN","%ZVEMRER",51,0)
 Q
"RTN","%ZVEMRER",52,0)
FORWARD ;Go forward a page
"RTN","%ZVEMRER",53,0)
 S VEET("TOP")=VEET("BOT"),VEET("GAP")=VEET("SL")
"RTN","%ZVEMRER",54,0)
 S YND=VEET("TOP")+YCUR-1
"RTN","%ZVEMRER",55,0)
 D SCROLL^%ZVEMKT2(1)
"RTN","%ZVEMRER",56,0)
 Q
"RTN","%ZVEMRER",57,0)
SCRNTOP ;Go to top of screen
"RTN","%ZVEMRER",58,0)
 S YND=VEET("TOP"),DX=XCUR,(DY,YCUR)=1 X VEES("CRSR")
"RTN","%ZVEMRER",59,0)
 Q
"RTN","%ZVEMRER",60,0)
SCRNBOT ;Go to bottom of screen
"RTN","%ZVEMRER",61,0)
 S DX=XCUR,(DY,YCUR)=VEET("BOT")-VEET("TOP") X VEES("CRSR")
"RTN","%ZVEMRER",62,0)
 S YND=VEET("BOT")-1
"RTN","%ZVEMRER",63,0)
 Q:$G(^TMP("VEE","IR"_VRRS,$J,YND))'=" <> <> <>"
"RTN","%ZVEMRER",64,0)
 S YND=YND-1,YCUR=YCUR-1
"RTN","%ZVEMRER",65,0)
 S DX=XCUR,DY=YCUR X VEES("CRSR")
"RTN","%ZVEMRER",66,0)
 Q
"RTN","%ZVEMREW")
0^104^B19826459
"RTN","%ZVEMREW",1,0)
%ZVEMREW ;DJB,VRR**EDIT - WEB..Insert HTML Codes ; 8/25/02 10:08am
"RTN","%ZVEMREW",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMREW",3,0)
 ;
"RTN","%ZVEMREW",4,0)
WEB ;Insert HTML tags:
"RTN","%ZVEMREW",5,0)
 NEW CD,I
"RTN","%ZVEMREW",6,0)
 D HTML^%ZVEMREP ;...Display HTML in upper right of screen
"RTN","%ZVEMREW",7,0)
 S CD="" D INSERT
"RTN","%ZVEMREW",8,0)
 D HTML^%ZVEMREP ;...Remove HTML from upper right of screen
"RTN","%ZVEMREW",9,0)
 Q
"RTN","%ZVEMREW",10,0)
INSERT ;Insert HTML code
"RTN","%ZVEMREW",11,0)
 D ASK
"RTN","%ZVEMREW",12,0)
 S CD=$$ALLCAPS^%ZVEMKU(CD)
"RTN","%ZVEMREW",13,0)
 Q:CD=""!(CD=".")!(CD="..")
"RTN","%ZVEMREW",14,0)
 I CD="?"!(CD="??") D HELP Q
"RTN","%ZVEMREW",15,0)
 I $E(CD)="." D  Q
"RTN","%ZVEMREW",16,0)
 . S CD=$E(CD,2,99)
"RTN","%ZVEMREW",17,0)
 . I CD="AQUA" D CLINE("#238E68","","") Q
"RTN","%ZVEMREW",18,0)
 . I CD="BLACK" D CLINE("#000000","","") Q
"RTN","%ZVEMREW",19,0)
 . I CD="BLUE" D CLINE("#0000FF","","") Q
"RTN","%ZVEMREW",20,0)
 . I CD="FUCHSIA" D CLINE("#FF00FF","","") Q
"RTN","%ZVEMREW",21,0)
 . I CD="GRAY" D CLINE("#C0C0C0","","") Q
"RTN","%ZVEMREW",22,0)
 . I CD="GREEN" D CLINE("#00FF00","","") Q
"RTN","%ZVEMREW",23,0)
 . I CD="LIME" D CLINE("#32CD32","","") Q
"RTN","%ZVEMREW",24,0)
 . I CD="MAROON" D CLINE("#8E236B","","") Q
"RTN","%ZVEMREW",25,0)
 . I CD="NAVY" D CLINE("#23238E","","") Q
"RTN","%ZVEMREW",26,0)
 . I CD="OLIVE" D CLINE("#238E23","","") Q
"RTN","%ZVEMREW",27,0)
 . I CD="PURPLE" D CLINE("#871F78","","") Q
"RTN","%ZVEMREW",28,0)
 . I CD="RED" D CLINE("#FF0000","","") Q
"RTN","%ZVEMREW",29,0)
 . I CD="SILVER" D CLINE("#545454","","") Q
"RTN","%ZVEMREW",30,0)
 . I CD="TEAL" D CLINE("#00FFFF","","") Q
"RTN","%ZVEMREW",31,0)
 . I CD="WHITE" D CLINE("#FFFFFF","","") Q
"RTN","%ZVEMREW",32,0)
 . I CD="YELLOW" D CLINE("#FFFF00","","") Q
"RTN","%ZVEMREW",33,0)
 . D CLINE(CD,"<",">")
"RTN","%ZVEMREW",34,0)
 I CD="C" D COMMENT Q
"RTN","%ZVEMREW",35,0)
 I CD="I" D IMAGE Q
"RTN","%ZVEMREW",36,0)
 I CD="L" D LIST Q
"RTN","%ZVEMREW",37,0)
 I CD="LK" D LINK Q
"RTN","%ZVEMREW",38,0)
 I CD="R" D REQUIRED Q
"RTN","%ZVEMREW",39,0)
 I CD="T" D TABLE Q
"RTN","%ZVEMREW",40,0)
 D GENERIC
"RTN","%ZVEMREW",41,0)
 Q
"RTN","%ZVEMREW",42,0)
ASK ;Get user's input
"RTN","%ZVEMREW",43,0)
 ;<SPACEBAR>=LastTag  /=/LastTag
"RTN","%ZVEMREW",44,0)
 ;LastTag is always stored in CDHLD without the /.
"RTN","%ZVEMREW",45,0)
 NEW DX,DY,I,PROMPT
"RTN","%ZVEMREW",46,0)
 S PROMPT="HTML Tag" I $G(CDHLD)]"" S PROMPT=PROMPT_" | "_CDHLD
"RTN","%ZVEMREW",47,0)
ASK1 S CD=$$GETTEXT^%ZVEMRM2(PROMPT)
"RTN","%ZVEMREW",48,0)
 I CD=" "!(CD="/") D  G:CD']"" ASK1 I 1
"RTN","%ZVEMREW",49,0)
 . I $G(CDHLD)']"" W $C(7) S CD="" Q
"RTN","%ZVEMREW",50,0)
 . I CD=" " D  Q
"RTN","%ZVEMREW",51,0)
 . . I $E(CDHLD)="/" S CD=$E(CDHLD,2,99) Q
"RTN","%ZVEMREW",52,0)
 . . I $E(CDHLD)="./" S CD="."_$E(CDHLD,3,99) Q
"RTN","%ZVEMREW",53,0)
 . . S CD=CDHLD
"RTN","%ZVEMREW",54,0)
 . I $E(CDHLD,1,2)="./" S CD=CDHLD Q
"RTN","%ZVEMREW",55,0)
 . I $E(CDHLD)="/" S CD=CDHLD Q
"RTN","%ZVEMREW",56,0)
 . I $E(CDHLD)="." S CD="./"_$E(CDHLD,2,99) Q
"RTN","%ZVEMREW",57,0)
 . S CD="/"_CDHLD Q
"RTN","%ZVEMREW",58,0)
 E  D  ;........................................Preserve CD in CDHLD
"RTN","%ZVEMREW",59,0)
 . Q:",,?,??,"[(","_CD_",")
"RTN","%ZVEMREW",60,0)
 . I $E(CD)="/" S CDHLD=$E(CD,2,99) Q
"RTN","%ZVEMREW",61,0)
 . I $E(CD,1,2)="./" S CDHLD="."_$E(CD,3,99) Q
"RTN","%ZVEMREW",62,0)
 . S CDHLD=CD
"RTN","%ZVEMREW",63,0)
 ;--> Redraw bottom line and return cursor to routine.
"RTN","%ZVEMREW",64,0)
 S DX=0,DY=VEET("S2")
"RTN","%ZVEMREW",65,0)
 F I=1:1:VEET("FT") X VEES("CRSR") W VEET("FT",I) S DY=DY+1
"RTN","%ZVEMREW",66,0)
 S DX=XCUR,DY=YCUR X VEES("CRSR")
"RTN","%ZVEMREW",67,0)
 Q
"RTN","%ZVEMREW",68,0)
 ;=================================================================
"RTN","%ZVEMREW",69,0)
COMMENT ;HTML comment tag.
"RTN","%ZVEMREW",70,0)
 NEW VAR
"RTN","%ZVEMREW",71,0)
 S VAR="<!-- "_" -->"
"RTN","%ZVEMREW",72,0)
 D NLINE(VAR)
"RTN","%ZVEMREW",73,0)
 Q
"RTN","%ZVEMREW",74,0)
GENERIC ;HTML generic tag. All tags except <TR>,<P>,<BR> get closing tag.
"RTN","%ZVEMREW",75,0)
 NEW VAR
"RTN","%ZVEMREW",76,0)
 S VAR="<"_CD_">"
"RTN","%ZVEMREW",77,0)
 D NLINE(VAR)
"RTN","%ZVEMREW",78,0)
 Q
"RTN","%ZVEMREW",79,0)
IMAGE ;HTML image tag.
"RTN","%ZVEMREW",80,0)
 NEW VAR
"RTN","%ZVEMREW",81,0)
 S VAR="<IMG SRC=""""X.GIF"""" ALT=""""txt"""" ALIGN=LEFT WIDTH=64 HEIGHT=64>"
"RTN","%ZVEMREW",82,0)
 D NLINE(VAR)
"RTN","%ZVEMREW",83,0)
 Q
"RTN","%ZVEMREW",84,0)
LINK ;HTML Link tag.
"RTN","%ZVEMREW",85,0)
 NEW VAR
"RTN","%ZVEMREW",86,0)
 S VAR="<A HREF=""""X.HTM"""">Click Here</A>"
"RTN","%ZVEMREW",87,0)
 D NLINE(VAR)
"RTN","%ZVEMREW",88,0)
 Q
"RTN","%ZVEMREW",89,0)
LIST ;HTML List tag.
"RTN","%ZVEMREW",90,0)
 NEW VAR
"RTN","%ZVEMREW",91,0)
 S VAR="<UL TYPE=DISK>,  <LI></LI>,  <LI></LI>,</UL>"
"RTN","%ZVEMREW",92,0)
 D NLINE(VAR)
"RTN","%ZVEMREW",93,0)
 Q
"RTN","%ZVEMREW",94,0)
REQUIRED ;HTML required tag.
"RTN","%ZVEMREW",95,0)
 NEW VAR
"RTN","%ZVEMREW",96,0)
 S VAR="<HTML>,<HEAD>,<TITLE></TITLE>,</HEAD>,<BODY BGCOLOR=""""white"""" TEXT=""""black"""">,</BODY>,</HTML>"
"RTN","%ZVEMREW",97,0)
 D NLINE(VAR)
"RTN","%ZVEMREW",98,0)
 Q
"RTN","%ZVEMREW",99,0)
TABLE ;HTML Table tag.
"RTN","%ZVEMREW",100,0)
 NEW VAR
"RTN","%ZVEMREW",101,0)
 S VAR="<TABLE BORDER=0 WIDTH=100% CELLPADDING=0 CELLSPACING=0>,  <TR>,    <TD></TD>,  </TR>,</TABLE>"
"RTN","%ZVEMREW",102,0)
 D NLINE(VAR)
"RTN","%ZVEMREW",103,0)
 Q
"RTN","%ZVEMREW",104,0)
 ;=================================================================
"RTN","%ZVEMREW",105,0)
NLINE(VAR) ;Insert HTML into new lines
"RTN","%ZVEMREW",106,0)
 NEW I,NUM,SUB,TAG
"RTN","%ZVEMREW",107,0)
 S (NUM,SUB)=1 ;...NUM=Rtn line #, SUB=Subscript #
"RTN","%ZVEMREW",108,0)
 F I=1:1 S TAG=$P(VAR,",",I) Q:TAG']""  D NLINE1
"RTN","%ZVEMREW",109,0)
 D PREPASTE^%ZVEMRP1,REDRAW^%ZVEMRU(YND) ;...Inserts code into rtn
"RTN","%ZVEMREW",110,0)
 S FLAGSAVE=1
"RTN","%ZVEMREW",111,0)
 Q
"RTN","%ZVEMREW",112,0)
NLINE1 ;Build Save array
"RTN","%ZVEMREW",113,0)
 S TAG="W !,"""_TAG_""""
"RTN","%ZVEMREW",114,0)
 S ^%ZVEMS("E","SAVEVRR",$J,SUB)=NUM_$J("",9-$L(NUM))_$C(30)_$E(TAG,1,VEE("IOM")-11)
"RTN","%ZVEMREW",115,0)
 S NUM=NUM+1,SUB=SUB+1,TAG=$E(TAG,VEE("IOM")-10,9999)
"RTN","%ZVEMREW",116,0)
 F  Q:TAG']""  D  ;
"RTN","%ZVEMREW",117,0)
 . S ^%ZVEMS("E","SAVEVRR",$J,SUB)=$J("",9)_$E(TAG,1,VEE("IOM")-11)
"RTN","%ZVEMREW",118,0)
 . S SUB=SUB+1,TAG=$E(TAG,VEE("IOM")-10,9999)
"RTN","%ZVEMREW",119,0)
 S ^%ZVEMS("E","SAVEVRR",$J,SUB)=""
"RTN","%ZVEMREW",120,0)
 Q
"RTN","%ZVEMREW",121,0)
CLINE(TXT,LEFT,RIGHT) ;Insert HTML into current line
"RTN","%ZVEMREW",122,0)
 ;TXT=Code to be inserted
"RTN","%ZVEMREW",123,0)
 ;LEFT=Attach to left side of TXT (<,",etc.)
"RTN","%ZVEMREW",124,0)
 ;RIGHT=Attach to right side of TXT (>,",etc.)
"RTN","%ZVEMREW",125,0)
 NEW I,KEY
"RTN","%ZVEMREW",126,0)
 D HIGHOFF^%ZVEMRE S DX=XCUR,DY=YCUR X VEES("CRSR") ;...Highlite off
"RTN","%ZVEMREW",127,0)
 F I=1:1 S KEY=$E($G(LEFT),I) Q:KEY']""  W KEY D ^%ZVEMREA
"RTN","%ZVEMREW",128,0)
 F I=1:1 S KEY=$E(TXT,I) Q:KEY']""  W KEY D ^%ZVEMREA
"RTN","%ZVEMREW",129,0)
 F I=1:1 S KEY=$E($G(RIGHT),I) Q:KEY']""  W KEY D ^%ZVEMREA
"RTN","%ZVEMREW",130,0)
 D HIGHON^%ZVEMRE ;...Highlite on
"RTN","%ZVEMREW",131,0)
 S FLAGSAVE=1
"RTN","%ZVEMREW",132,0)
 Q
"RTN","%ZVEMREW",133,0)
 ;=================================================================
"RTN","%ZVEMREW",134,0)
HELP ;Help text
"RTN","%ZVEMREW",135,0)
 D HELP^%ZVEMKT("WEB")
"RTN","%ZVEMREW",136,0)
 D REDRAW2^%ZVEMRU
"RTN","%ZVEMREW",137,0)
 D MODEON^%ZVEMRU("WEB",1) ;Redraw WEB in upper right of screen
"RTN","%ZVEMREW",138,0)
 Q
"RTN","%ZVEMRI")
0^105^B8753383
"RTN","%ZVEMRI",1,0)
%ZVEMRI ;DJB,VRR**INSERT - READ,HELP,ADD,DELETE ; 12/25/00 5:14pm
"RTN","%ZVEMRI",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMRI",3,0)
 ;
"RTN","%ZVEMRI",4,0)
INSERT(MODE) ;Processes the line tag portion of a new line. When user
"RTN","%ZVEMRI",5,0)
 ;hits <TAB>, return to EDIT mode.
"RTN","%ZVEMRI",6,0)
 ;MODE: 1 = Open line above
"RTN","%ZVEMRI",7,0)
 ;      2 = Open line below
"RTN","%ZVEMRI",8,0)
 ;
"RTN","%ZVEMRI",9,0)
 I $G(MODE)'>0 S MODE=1
"RTN","%ZVEMRI",10,0)
 NEW CD,FLAGQ,LNNUM,X
"RTN","%ZVEMRI",11,0)
 S FLAGQ=0
"RTN","%ZVEMRI",12,0)
 S CD=""
"RTN","%ZVEMRI",13,0)
 D @$S(MODE=2:"BELOW(YND)",1:"ABOVE(YND)") Q:FLAGQ
"RTN","%ZVEMRI",14,0)
 S LNNUM=$$LINENUM^%ZVEMRU(YND)
"RTN","%ZVEMRI",15,0)
 D OPEN^%ZVEMRI1
"RTN","%ZVEMRI",16,0)
 F  D READ Q:FLAGQ
"RTN","%ZVEMRI",17,0)
EX ;
"RTN","%ZVEMRI",18,0)
 D LINECNT^%ZVEMRU
"RTN","%ZVEMRI",19,0)
 KILL ^TMP("VEE",$J)
"RTN","%ZVEMRI",20,0)
 Q
"RTN","%ZVEMRI",21,0)
 ;
"RTN","%ZVEMRI",22,0)
READ ;
"RTN","%ZVEMRI",23,0)
 S X=$$READ^%ZVEMKRN("",1)
"RTN","%ZVEMRI",24,0)
 I VEE("K")="<TAB>" D TAB^%ZVEMRI1 Q
"RTN","%ZVEMRI",25,0)
 I ",<ESC>,<F1E>,<F1Q>,<RET>,"[(","_VEE("K")_",") D RETURN^%ZVEMRI1 Q
"RTN","%ZVEMRI",26,0)
 I ",<AR>,<AL>,<AU>,<AD>,"[(","_VEE("K")_",") D ARROW Q
"RTN","%ZVEMRI",27,0)
 I VEE("K")?1"<F1".E1">"!(VEE("K")?1"<F2".E1">") D OTHER Q
"RTN","%ZVEMRI",28,0)
 I ",<BS>,<DEL>,"[(","_VEE("K")_",") D  D DELETE Q  ;Delete
"RTN","%ZVEMRI",29,0)
 . S:$G(VEE("BS"))="SAME" VEE("K")="<BS>"
"RTN","%ZVEMRI",30,0)
 Q:X']""
"RTN","%ZVEMRI",31,0)
 D ADD ;Add character
"RTN","%ZVEMRI",32,0)
 Q
"RTN","%ZVEMRI",33,0)
 ;====================================================================
"RTN","%ZVEMRI",34,0)
BELOW(ND) ;Open new line BELOW current line.
"RTN","%ZVEMRI",35,0)
 ;ND = YND (Scroll array node)
"RTN","%ZVEMRI",36,0)
 I $G(^TMP("VEE","IR"_VRRS,$J,ND))=" <> <> <>" D  Q
"RTN","%ZVEMRI",37,0)
 . I ND'=1 S FLAGQ=1 W $C(7)
"RTN","%ZVEMRI",38,0)
 NEW I,TMP
"RTN","%ZVEMRI",39,0)
 F I=ND+1:1 S TMP=$G(^TMP("VEE","IR"_VRRS,$J,I)) Q:TMP[$C(30)!(TMP=" <> <> <>")  D DOWN^%ZVEMRE(1)
"RTN","%ZVEMRI",40,0)
 Q
"RTN","%ZVEMRI",41,0)
 ;
"RTN","%ZVEMRI",42,0)
ABOVE(ND) ;Open new line ABOVE current line.
"RTN","%ZVEMRI",43,0)
 ;ND=YND (Scroll array node)
"RTN","%ZVEMRI",44,0)
 NEW I,TMP
"RTN","%ZVEMRI",45,0)
 F I=ND:-1 S TMP=$G(^TMP("VEE","IR"_VRRS,$J,I)) Q:TMP[$C(30)!(I<1)!(^(I)=" <> <> <>")  D UP^%ZVEMRE(1)
"RTN","%ZVEMRI",46,0)
 I ND=1 D  Q
"RTN","%ZVEMRI",47,0)
 . I $G(^TMP("VEE","IR"_VRRS,$J,ND))'=" <> <> <>" S (YCUR,YND)=0
"RTN","%ZVEMRI",48,0)
 D UP^%ZVEMRE(1)
"RTN","%ZVEMRI",49,0)
 Q
"RTN","%ZVEMRI",50,0)
 ;====================================================================
"RTN","%ZVEMRI",51,0)
ADD ;Add character
"RTN","%ZVEMRI",52,0)
 S CD=$E(CD,1,XCUR)_X_$E(CD,XCUR+1,9999)
"RTN","%ZVEMRI",53,0)
 S XCUR=XCUR+1
"RTN","%ZVEMRI",54,0)
 S DX=XCUR,DY=YCUR X VEES("CRSR")
"RTN","%ZVEMRI",55,0)
 W @VEES("BLANK_C_EOL")
"RTN","%ZVEMRI",56,0)
 X VEES("XY")
"RTN","%ZVEMRI",57,0)
 W $E(CD,XCUR+1,9999)
"RTN","%ZVEMRI",58,0)
 S DX=XCUR,DY=YCUR X VEES("CRSR")
"RTN","%ZVEMRI",59,0)
 Q
"RTN","%ZVEMRI",60,0)
 ;
"RTN","%ZVEMRI",61,0)
DELETE ;Delete character
"RTN","%ZVEMRI",62,0)
 I XCUR'>0,CD']""!(VEE("K")'="<DEL>") D  Q
"RTN","%ZVEMRI",63,0)
 . D CLOSE^%ZVEMRI1
"RTN","%ZVEMRI",64,0)
 . S FLAGQ=1
"RTN","%ZVEMRI",65,0)
 I $G(VEE("K"))="<DEL>" S CD=$E(CD,1,XCUR)_$E(CD,XCUR+2,9999)
"RTN","%ZVEMRI",66,0)
 E  S XCUR=XCUR-1,CD=$E(CD,1,XCUR)_$E(CD,XCUR+2,9999)
"RTN","%ZVEMRI",67,0)
 S DX=XCUR,DY=YCUR X VEES("CRSR")
"RTN","%ZVEMRI",68,0)
 W @VEES("BLANK_C_EOL")
"RTN","%ZVEMRI",69,0)
 X VEES("XY") W $E(CD,XCUR+1,9999)
"RTN","%ZVEMRI",70,0)
 S DX=XCUR,DY=YCUR X VEES("CRSR")
"RTN","%ZVEMRI",71,0)
 Q
"RTN","%ZVEMRI",72,0)
 ;====================================================================
"RTN","%ZVEMRI",73,0)
ARROW ;Arrow Keys
"RTN","%ZVEMRI",74,0)
 D @($E(VEE("K"),2,3))
"RTN","%ZVEMRI",75,0)
 S DX=XCUR,DY=YCUR X VEES("CRSR")
"RTN","%ZVEMRI",76,0)
 Q
"RTN","%ZVEMRI",77,0)
 ;
"RTN","%ZVEMRI",78,0)
AL ;Arrow Left
"RTN","%ZVEMRI",79,0)
 I XCUR<1 W $C(7) Q
"RTN","%ZVEMRI",80,0)
 S XCUR=XCUR-1
"RTN","%ZVEMRI",81,0)
 Q
"RTN","%ZVEMRI",82,0)
 ;
"RTN","%ZVEMRI",83,0)
AR ;Arrow Right
"RTN","%ZVEMRI",84,0)
 Q:XCUR'<$L(CD)
"RTN","%ZVEMRI",85,0)
 S XCUR=XCUR+1
"RTN","%ZVEMRI",86,0)
 Q
"RTN","%ZVEMRI",87,0)
 ;
"RTN","%ZVEMRI",88,0)
AU ;Arrow Up
"RTN","%ZVEMRI",89,0)
 W $C(7)
"RTN","%ZVEMRI",90,0)
 Q
"RTN","%ZVEMRI",91,0)
 ;
"RTN","%ZVEMRI",92,0)
AD ;Arrow Down
"RTN","%ZVEMRI",93,0)
 W $C(7)
"RTN","%ZVEMRI",94,0)
 Q
"RTN","%ZVEMRI",95,0)
 ;
"RTN","%ZVEMRI",96,0)
OTHER ;F1 & F2 key combinations
"RTN","%ZVEMRI",97,0)
 Q:",<F1AL>,<F1AR>,<F2AL>,<F2AR>,"'[(","_VEE("K")_",")
"RTN","%ZVEMRI",98,0)
 D @($E(VEE("K"),2,5))
"RTN","%ZVEMRI",99,0)
 S DX=XCUR,DY=YCUR X VEES("CRSR")
"RTN","%ZVEMRI",100,0)
 Q
"RTN","%ZVEMRI",101,0)
 ;
"RTN","%ZVEMRI",102,0)
F1AL ;Beginning of line
"RTN","%ZVEMRI",103,0)
 S XCUR=0
"RTN","%ZVEMRI",104,0)
 Q
"RTN","%ZVEMRI",105,0)
 ;
"RTN","%ZVEMRI",106,0)
F1AR ;End of line
"RTN","%ZVEMRI",107,0)
 S XCUR=$L(CD)
"RTN","%ZVEMRI",108,0)
 Q
"RTN","%ZVEMRI",109,0)
 ;
"RTN","%ZVEMRI",110,0)
F2AL ;Left 15
"RTN","%ZVEMRI",111,0)
 S XCUR=XCUR-$S(XCUR-15>0:15,1:XCUR-0)
"RTN","%ZVEMRI",112,0)
 Q
"RTN","%ZVEMRI",113,0)
 ;
"RTN","%ZVEMRI",114,0)
F2AR ;Right 15
"RTN","%ZVEMRI",115,0)
 NEW L
"RTN","%ZVEMRI",116,0)
 S L=$L(CD) Q:XCUR=L
"RTN","%ZVEMRI",117,0)
 S XCUR=XCUR+$S(XCUR+15'>L:15,1:L-XCUR)
"RTN","%ZVEMRI",118,0)
 Q
"RTN","%ZVEMRI1")
0^106^B5168975
"RTN","%ZVEMRI1",1,0)
%ZVEMRI1 ;DJB,VRR**INSERT - RETURN,TAB,OPEN,CLOSE ; 12/25/00 5:34pm
"RTN","%ZVEMRI1",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMRI1",3,0)
 ;
"RTN","%ZVEMRI1",4,0)
RETURN ;<RETURN> key hit
"RTN","%ZVEMRI1",5,0)
 ;
"RTN","%ZVEMRI1",6,0)
 ;If user hasn't hit <TAB>, go ahead and insert it for him.
"RTN","%ZVEMRI1",7,0)
 ;I $G(CD)]"" D MSG^%ZVEMRUM(20) Q  ;Stop giving msg.
"RTN","%ZVEMRI1",8,0)
 I $G(CD)]"" D TAB Q
"RTN","%ZVEMRI1",9,0)
 ;
"RTN","%ZVEMRI1",10,0)
 ;If no code has been added to CD, close the open line.
"RTN","%ZVEMRI1",11,0)
 D CLOSE S FLAGQ=1 Q
"RTN","%ZVEMRI1",12,0)
 Q
"RTN","%ZVEMRI1",13,0)
 ;
"RTN","%ZVEMRI1",14,0)
TAB ;<TAB> key hit
"RTN","%ZVEMRI1",15,0)
 ;Process line start character. Setup CD to match scroll nodes.
"RTN","%ZVEMRI1",16,0)
 NEW TXT
"RTN","%ZVEMRI1",17,0)
 I $$TAGCHK^%ZVEMRV(CD) Q  ;Bad line tag
"RTN","%ZVEMRI1",18,0)
 S FLAGQ=1
"RTN","%ZVEMRI1",19,0)
 I $G(CD)]"" D  I 1
"RTN","%ZVEMRI1",20,0)
 . S TXT=$J("",8-$L(CD))_CD_" "_$C(30)
"RTN","%ZVEMRI1",21,0)
 E  S TXT=LNNUM,TXT=TXT_$J("",9-$L(TXT))_$C(30)
"RTN","%ZVEMRI1",22,0)
 S ^TMP("VEE","IR"_VRRS,$J,YND)=TXT
"RTN","%ZVEMRI1",23,0)
 W @VEES("BLANK_SOL_C")
"RTN","%ZVEMRI1",24,0)
 S DX=0,DY=YCUR X VEES("CRSR")
"RTN","%ZVEMRI1",25,0)
 W $P(TXT,$C(30),1)
"RTN","%ZVEMRI1",26,0)
 S XCUR=$X
"RTN","%ZVEMRI1",27,0)
 D REDRAW^%ZVEMREO(YND+1,VEET("BOT"))
"RTN","%ZVEMRI1",28,0)
 S DX=0,DY=YCUR X VEES("CRSR")
"RTN","%ZVEMRI1",29,0)
 Q
"RTN","%ZVEMRI1",30,0)
 ;
"RTN","%ZVEMRI1",31,0)
OPEN ;Open new line for inserting code
"RTN","%ZVEMRI1",32,0)
 ;Adj if no code exists in rtn
"RTN","%ZVEMRI1",33,0)
 I YND=1,$G(^TMP("VEE","IR"_VRRS,$J,YND))=" <> <> <>" D  ;
"RTN","%ZVEMRI1",34,0)
 . S (YCUR,YND)=0
"RTN","%ZVEMRI1",35,0)
 D OPEN^%ZVEMREO,ADJOPEN
"RTN","%ZVEMRI1",36,0)
 S VRRHIGH=VRRHIGH+1
"RTN","%ZVEMRI1",37,0)
 Q
"RTN","%ZVEMRI1",38,0)
 ;
"RTN","%ZVEMRI1",39,0)
CLOSE ;Close a line that's been deleted
"RTN","%ZVEMRI1",40,0)
 D ADJCLOS,CLOSE^%ZVEMREO
"RTN","%ZVEMRI1",41,0)
 S VRRHIGH=VRRHIGH-1
"RTN","%ZVEMRI1",42,0)
 ;Adj if line is closed leaving only " <> <> <>".
"RTN","%ZVEMRI1",43,0)
 I $G(^TMP("VEE","IR"_VRRS,$J,1))=" <> <> <>"!(YCUR<1)!(YND<1) D  ;
"RTN","%ZVEMRI1",44,0)
 . S (YCUR,YND)=1
"RTN","%ZVEMRI1",45,0)
 . S DX=0,DY=YCUR X VEES("CRSR")
"RTN","%ZVEMRI1",46,0)
 Q
"RTN","%ZVEMRI1",47,0)
 ;
"RTN","%ZVEMRI1",48,0)
ADJOPEN ;Adjust scroll array when opening a new line
"RTN","%ZVEMRI1",49,0)
 NEW END,I,NUM,NUM1
"RTN","%ZVEMRI1",50,0)
 S END=$O(^TMP("VEE","IR"_VRRS,$J,""),-1)
"RTN","%ZVEMRI1",51,0)
 F I=END+1:-1:YND+1 D  ;
"RTN","%ZVEMRI1",52,0)
 . S TMP=^TMP("VEE","IR"_VRRS,$J,I-1)
"RTN","%ZVEMRI1",53,0)
 . I TMP[$C(30) D  ;Adjust line number
"RTN","%ZVEMRI1",54,0)
 . . S NUM=+TMP Q:NUM'>0  S NUM1=NUM+1
"RTN","%ZVEMRI1",55,0)
 . . S TMP=NUM1_$E(TMP,$L(NUM1)+1,999)
"RTN","%ZVEMRI1",56,0)
 . S ^TMP("VEE","IR"_VRRS,$J,I)=TMP
"RTN","%ZVEMRI1",57,0)
 S ^TMP("VEE","IR"_VRRS,$J,YND)=""
"RTN","%ZVEMRI1",58,0)
 Q
"RTN","%ZVEMRI1",59,0)
 ;
"RTN","%ZVEMRI1",60,0)
ADJCLOS ;Adjust scroll array when closing a line
"RTN","%ZVEMRI1",61,0)
 NEW END,I,NUM,NUM1,TMP
"RTN","%ZVEMRI1",62,0)
 S END=$O(^TMP("VEE","IR"_VRRS,$J,""),-1)
"RTN","%ZVEMRI1",63,0)
 F I=YND:1:END-1 D  ;
"RTN","%ZVEMRI1",64,0)
 . S TMP=^TMP("VEE","IR"_VRRS,$J,I+1)
"RTN","%ZVEMRI1",65,0)
 . I TMP[$C(30) D  ;Adjust line number
"RTN","%ZVEMRI1",66,0)
 . . S NUM=+TMP Q:NUM'>0  S NUM1=NUM-1
"RTN","%ZVEMRI1",67,0)
 . . S TMP=NUM1_$J("",$L(NUM)-$L(NUM1))_$E(TMP,$L(NUM)+1,999)
"RTN","%ZVEMRI1",68,0)
 . S ^TMP("VEE","IR"_VRRS,$J,I)=TMP
"RTN","%ZVEMRI1",69,0)
 KILL ^TMP("VEE","IR"_VRRS,$J,END)
"RTN","%ZVEMRI1",70,0)
 Q
"RTN","%ZVEMRID")
0^107^B14750257
"RTN","%ZVEMRID",1,0)
%ZVEMRID ;DJB,VRR**INSERT - Programmer Call ; 9/6/02 8:15am
"RTN","%ZVEMRID",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMRID",3,0)
 ;
"RTN","%ZVEMRID",4,0)
EN ;Insert programmer call into current program
"RTN","%ZVEMRID",5,0)
 S ^TMP("VPE",$J)=$P(FLAGMENU,"^",1) ;...YND
"RTN","%ZVEMRID",6,0)
 D SYMTAB^%ZVEMKST("C","VRR",VRRS) ;...Save/Clear symbol table
"RTN","%ZVEMRID",7,0)
 D ENDSCR^%ZVEMKT2
"RTN","%ZVEMRID",8,0)
 I '$D(^VEE(19200.113)) D  G EX ;...Quit if FM isn't in this UCI
"RTN","%ZVEMRID",9,0)
 . W !,"I can't find the VPE files that support CALL..."
"RTN","%ZVEMRID",10,0)
 . D PAUSE^%ZVEMKU(2,"P")
"RTN","%ZVEMRID",11,0)
 I $G(^TMP("VEE","IR"_VRRS,$J,^TMP("VPE",$J)))=" <> <> <>" D  G EX
"RTN","%ZVEMRID",12,0)
 . W !,"You may not insert a CALL while you are on the ' <> <> <>' line."
"RTN","%ZVEMRID",13,0)
 . W !,"Move up one line."
"RTN","%ZVEMRID",14,0)
 . D PAUSE^%ZVEMKU(2,"P")
"RTN","%ZVEMRID",15,0)
 ;
"RTN","%ZVEMRID",16,0)
 NEW %,CALL,CD
"RTN","%ZVEMRID",17,0)
 S X="ERROR^%ZVEMRID",@($$TRAP^%ZVEMKU1) KILL X
"RTN","%ZVEMRID",18,0)
 W !,"***INSERT PROGRAMMER CALL***"
"RTN","%ZVEMRID",19,0)
 S FLAGQ=0
"RTN","%ZVEMRID",20,0)
 D GETCALL G:FLAGQ EX
"RTN","%ZVEMRID",21,0)
 D DELETE^%ZVEMRIE G:FLAGQ EX
"RTN","%ZVEMRID",22,0)
 D DDS G:FLAGQ EX
"RTN","%ZVEMRID",23,0)
 D CODE^%ZVEMRIE G:FLAGQ EX
"RTN","%ZVEMRID",24,0)
 W @VEE("IOF")
"RTN","%ZVEMRID",25,0)
 G:$$ASK^%ZVEMKU(" Insert this Call into your routine",1)'="Y" EX
"RTN","%ZVEMRID",26,0)
 D INSERT
"RTN","%ZVEMRID",27,0)
EX ;
"RTN","%ZVEMRID",28,0)
 KILL ^TMP("VPE",$J)
"RTN","%ZVEMRID",29,0)
 D SYMTAB^%ZVEMKST("R","VRR",VRRS) ;Restore symbol table
"RTN","%ZVEMRID",30,0)
 X VEES("RM0")
"RTN","%ZVEMRID",31,0)
 Q
"RTN","%ZVEMRID",32,0)
 ;====================================================================
"RTN","%ZVEMRID",33,0)
GETCALL ;Get programmer call
"RTN","%ZVEMRID",34,0)
 NEW DA,DIC,X,Y
"RTN","%ZVEMRID",35,0)
 S DIC="^VEE(19200.113,",DIC(0)="QEAM",DIC("A")="Select CALL: "
"RTN","%ZVEMRID",36,0)
 S DIC("S")="I $P($G(^(0)),U,2)'=""n"""
"RTN","%ZVEMRID",37,0)
 W ! D ^DIC I Y<0 S FLAGQ=1 Q
"RTN","%ZVEMRID",38,0)
 S CALL=+Y
"RTN","%ZVEMRID",39,0)
 Q
"RTN","%ZVEMRID",40,0)
DDS ;Call ScreenMan
"RTN","%ZVEMRID",41,0)
 NEW DA,DDSFILE,DDSPARM,DR,I
"RTN","%ZVEMRID",42,0)
 S DDSFILE=19200.113,DR="[VEEM PGM CALL]",DA=CALL
"RTN","%ZVEMRID",43,0)
 S DDSPARM="E" D ^DDS Q:'$G(DIERR)  S FLAGQ=1
"RTN","%ZVEMRID",44,0)
 W !!,"Screenman couldn't load this form."
"RTN","%ZVEMRID",45,0)
 S I=0
"RTN","%ZVEMRID",46,0)
 F  S I=$O(^TMP("DIERR",$J,1,"TEXT",I)) Q:I'>0  W !,^(I)
"RTN","%ZVEMRID",47,0)
 KILL ^TMP("DIERR",$J) D PAUSE^%ZVEMKU(2,"P")
"RTN","%ZVEMRID",48,0)
 Q
"RTN","%ZVEMRID",49,0)
INSERT ;Insert Call code into rtn
"RTN","%ZVEMRID",50,0)
 NEW CNT,I,NUM,SUB,YND
"RTN","%ZVEMRID",51,0)
 S YND=$G(^TMP("VPE",$J)) Q:YND'>0
"RTN","%ZVEMRID",52,0)
 ;--> Get line number
"RTN","%ZVEMRID",53,0)
 S NUM=$$LINENUM^%ZVEMRU(YND)+1
"RTN","%ZVEMRID",54,0)
 ;--> Set YND to line number after wrapped lines
"RTN","%ZVEMRID",55,0)
 F I=YND+1:1 Q:^TMP("VEE","IR"_VRRS,$J,I)[$C(30)  Q:^(I)=" <> <> <>"  S YND=YND+1
"RTN","%ZVEMRID",56,0)
 S SUB=1 F CNT=1:1 Q:'$D(CD(CNT))  S CD=CD(CNT) D INSERT1 S NUM=NUM+1
"RTN","%ZVEMRID",57,0)
 S ^%ZVEMS("E","SAVEVRR",$J,SUB)="" ;Mark clipboard ending point
"RTN","%ZVEMRID",58,0)
 D PASTE^%ZVEMRP1
"RTN","%ZVEMRID",59,0)
 Q
"RTN","%ZVEMRID",60,0)
INSERT1 ;Build array of code to be inserted
"RTN","%ZVEMRID",61,0)
 S ^%ZVEMS("E","SAVEVRR",$J,SUB)=NUM_$J("",9-$L(NUM))_$C(30)_$E(CD,1,VEE("IOM")-11)
"RTN","%ZVEMRID",62,0)
 S SUB=SUB+1
"RTN","%ZVEMRID",63,0)
 S CD=$E(CD,VEE("IOM")-10,9999)
"RTN","%ZVEMRID",64,0)
 F  Q:CD']""  D  ;
"RTN","%ZVEMRID",65,0)
 . S ^%ZVEMS("E","SAVEVRR",$J,SUB)=$J("",9)_$E(CD,1,VEE("IOM")-11)
"RTN","%ZVEMRID",66,0)
 . S SUB=SUB+1
"RTN","%ZVEMRID",67,0)
 . S CD=$E(CD,VEE("IOM")-10,9999)
"RTN","%ZVEMRID",68,0)
 Q
"RTN","%ZVEMRID",69,0)
 ;====================================================================
"RTN","%ZVEMRID",70,0)
ERROR ;Error trap
"RTN","%ZVEMRID",71,0)
 NEW ZE
"RTN","%ZVEMRID",72,0)
 S @("ZE="_VEE("$ZE"))
"RTN","%ZVEMRID",73,0)
 I ZE["<INRPT>" W !!?1,"....Interrupted.",!!
"RTN","%ZVEMRID",74,0)
 E  D ERRMSG^%ZVEMKU1("VRR")
"RTN","%ZVEMRID",75,0)
 D PAUSE^%ZVEMKU(2)
"RTN","%ZVEMRID",76,0)
 G EX
"RTN","%ZVEMRID",77,0)
 ;====================================================================
"RTN","%ZVEMRID",78,0)
HELP(PC) ;Print param/variable help text in ScreenMan.
"RTN","%ZVEMRID",79,0)
 ;PC=Global "Piece" where Parameter is located
"RTN","%ZVEMRID",80,0)
 NEW I,PARAM,STRING
"RTN","%ZVEMRID",81,0)
 Q:'$G(DDS)  Q:'$G(DA)  Q:'$G(PC)
"RTN","%ZVEMRID",82,0)
 S PARAM=$P($G(^VEE(19200.113,DA,"P")),U,PC) Q:'PARAM
"RTN","%ZVEMRID",83,0)
 F I=1:1 Q:'$D(^VEE(19200.114,PARAM,"WP",I,0))  S STRING(I)=^(0)
"RTN","%ZVEMRID",84,0)
 Q:($D(STRING)<10)  D HLP^DDSUTL(.STRING)
"RTN","%ZVEMRID",85,0)
 Q
"RTN","%ZVEMRID",86,0)
DEFAULT(PC) ;Default value in ScreenMan. Set variable Y.
"RTN","%ZVEMRID",87,0)
 ;PC=Global "Piece" where Parameter is located
"RTN","%ZVEMRID",88,0)
 NEW DEFAULT,PARAM
"RTN","%ZVEMRID",89,0)
 S Y=""
"RTN","%ZVEMRID",90,0)
 Q:'$G(DDS)  Q:'$G(DA)  Q:'$G(PC)
"RTN","%ZVEMRID",91,0)
 S PARAM=$P($G(^VEE(19200.113,DA,"P")),U,PC) Q:'PARAM
"RTN","%ZVEMRID",92,0)
 S DEFAULT=$G(^VEE(19200.114,PARAM,"D")) Q:DEFAULT']""
"RTN","%ZVEMRID",93,0)
 S Y=DEFAULT
"RTN","%ZVEMRID",94,0)
 Q
"RTN","%ZVEMRID",95,0)
 ;====================================================================
"RTN","%ZVEMRID",96,0)
EDIT ;Add/Edit a Call. External calling point to build database.
"RTN","%ZVEMRID",97,0)
 Q:'$D(^DD)!('$D(^DIC))  Q:'$D(^VEE(19200.113))
"RTN","%ZVEMRID",98,0)
 NEW DA,DDSFILE,DDSPARM,DIC,DR,FLAGQ,I,X,Y
"RTN","%ZVEMRID",99,0)
EDIT1 S FLAGQ=0 F  D  Q:FLAGQ
"RTN","%ZVEMRID",100,0)
 . W @VEE("IOF"),!,"***ADD/EDIT A VPE PROGRAMMER CALL***"
"RTN","%ZVEMRID",101,0)
 . S DIC="^VEE(19200.113,",DIC(0)="QEAML",DIC("A")="Select CALL: "
"RTN","%ZVEMRID",102,0)
 . W ! D ^DIC I Y<0 S FLAGQ=1 Q
"RTN","%ZVEMRID",103,0)
 . S DDSFILE=19200.113,DR="[VEEM PGM EDIT]",DA=+Y
"RTN","%ZVEMRID",104,0)
 . S DDSPARM="E" D ^DDS Q:'$G(DIERR)
"RTN","%ZVEMRID",105,0)
 . S FLAGQ=1
"RTN","%ZVEMRID",106,0)
 . W !!?1,"Screenman couldn't load this form."
"RTN","%ZVEMRID",107,0)
 . S I=0 F  S I=$O(^TMP("DIERR",$J,1,"TEXT",I)) Q:I'>0  W !?1,^(I)
"RTN","%ZVEMRID",108,0)
 . KILL ^TMP("DIERR",$J)
"RTN","%ZVEMRID",109,0)
 . D PAUSE^%ZVEMKU(2,"P")
"RTN","%ZVEMRID",110,0)
 Q
"RTN","%ZVEMRIE")
0^108^B8946116
"RTN","%ZVEMRIE",1,0)
%ZVEMRIE ;DJB,VRR**INSERT - Programmer Call cont.. [1/15/96 10:52pm]
"RTN","%ZVEMRIE",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMRIE",3,0)
 ;
"RTN","%ZVEMRIE",4,0)
CODE ;Set CD array to Call code
"RTN","%ZVEMRIE",5,0)
 NEW CHK,I,LIMIT,RTN,TMP
"RTN","%ZVEMRIE",6,0)
 ;LIMIT=How many params/vars are there?
"RTN","%ZVEMRIE",7,0)
 ;  CHK=Quit if none have data
"RTN","%ZVEMRIE",8,0)
 S (CHK,LIMIT)=0,CD=""
"RTN","%ZVEMRIE",9,0)
 ;--> Set TMP array with values
"RTN","%ZVEMRIE",10,0)
 F I=1:1 Q:$P($G(^VEE(19200.113,CALL,"P")),U,I)']""  D  ;
"RTN","%ZVEMRIE",11,0)
 . S TMP(I)=$G(^VEE(19200.113,CALL,"V"_I))
"RTN","%ZVEMRIE",12,0)
 . S:TMP(I)]"" CHK=1 S LIMIT=LIMIT+1
"RTN","%ZVEMRIE",13,0)
 I 'LIMIT!('CHK) S FLAGQ=1 Q
"RTN","%ZVEMRIE",14,0)
 S RTN=$G(^VEE(19200.113,CALL,"RTN")) I RTN']"" S FLAGQ=1 Q
"RTN","%ZVEMRIE",15,0)
 S:RTN'["^" RTN="^"_RTN
"RTN","%ZVEMRIE",16,0)
 I $P($G(^VEE(19200.113,CALL,0)),U,4)'="v" D CODEP Q
"RTN","%ZVEMRIE",17,0)
 D CODEV
"RTN","%ZVEMRIE",18,0)
 Q
"RTN","%ZVEMRIE",19,0)
CODEP ;A Call that uses parameters
"RTN","%ZVEMRIE",20,0)
 NEW I,PARAM
"RTN","%ZVEMRIE",21,0)
 ;--> Delete right most params that have no data
"RTN","%ZVEMRIE",22,0)
 F I=LIMIT:-1:1 Q:TMP(I)]""  KILL TMP(I)
"RTN","%ZVEMRIE",23,0)
 S PARAM="" F I=1:1:LIMIT Q:'$D(TMP(I))  D  ;
"RTN","%ZVEMRIE",24,0)
 . S:TMP(I)']"" TMP(I)=""""""
"RTN","%ZVEMRIE",25,0)
 . S PARAM=PARAM_TMP(I)_$S($D(TMP(I+1)):",",1:"")
"RTN","%ZVEMRIE",26,0)
 S CD(1)=$S($E(RTN)="$":"W ",1:"D ")_RTN_"("_PARAM_")"
"RTN","%ZVEMRIE",27,0)
 Q
"RTN","%ZVEMRIE",28,0)
CODEV ;A Call that uses variables
"RTN","%ZVEMRIE",29,0)
 NEW CNT,I,LN,VAR
"RTN","%ZVEMRIE",30,0)
 S CNT=1 F I=1:1:LIMIT D  ;
"RTN","%ZVEMRIE",31,0)
 . Q:TMP(I)']""
"RTN","%ZVEMRIE",32,0)
 . S VAR=$P($G(^VEE(19200.113,CALL,"P")),U,I) Q:VAR'>0
"RTN","%ZVEMRIE",33,0)
 . S VAR=$P($G(^VEE(19200.114,VAR,0)),U,1) Q:VAR']""
"RTN","%ZVEMRIE",34,0)
 . ;->FM doesn't allow ["^] in .01. Convert ['~].
"RTN","%ZVEMRIE",35,0)
 . S VAR=$TR(VAR,"'~","""^")
"RTN","%ZVEMRIE",36,0)
 . S LN(CNT)=VAR_"="_TMP(I),CNT=CNT+1
"RTN","%ZVEMRIE",37,0)
 S LN(CNT)=RTN,LIMIT=CNT
"RTN","%ZVEMRIE",38,0)
 S CNT=1,CD(CNT)="" F I=1:1 Q:'$D(LN(I))  D  ;
"RTN","%ZVEMRIE",39,0)
 . I I=1 S CD(CNT)="S "_LN(I) Q  ;..............SET VARIABLE
"RTN","%ZVEMRIE",40,0)
 . I I=LIMIT S CNT=CNT+1,CD(CNT)="D "_LN(I) Q  ;DO RTN
"RTN","%ZVEMRIE",41,0)
 . ;--> Next, either append next variable or start new line. Allow
"RTN","%ZVEMRIE",42,0)
 . ;    for 9 spaces in the line tag area.
"RTN","%ZVEMRIE",43,0)
 . I ($L(CD(CNT))+$L(LN(I))<66) S CD(CNT)=CD(CNT)_","_LN(I) Q
"RTN","%ZVEMRIE",44,0)
 . S CNT=CNT+1,CD(CNT)="S "_LN(I)
"RTN","%ZVEMRIE",45,0)
 Q
"RTN","%ZVEMRIE",46,0)
 ;====================================================================
"RTN","%ZVEMRIE",47,0)
DELETE ;Delete previous VALUEs for this Call.
"RTN","%ZVEMRIE",48,0)
 NEW ASK,DA,DDH,DIE,DQ,DR,X,Y
"RTN","%ZVEMRIE",49,0)
 W ! S ASK=$$ASK^%ZVEMKU("Delete previous values",1)
"RTN","%ZVEMRIE",50,0)
 S:ASK="^" FLAGQ=1 Q:ASK'="Y"
"RTN","%ZVEMRIE",51,0)
 S DIE="^VEE(19200.113,",DA=CALL
"RTN","%ZVEMRIE",52,0)
 S DR="61///@;62///@;63///@;64///@;65///@;66///@;67///@;68///@;69///@;70///@;71///@;72///@;73///@"
"RTN","%ZVEMRIE",53,0)
 D ^DIE
"RTN","%ZVEMRIE",54,0)
 Q
"RTN","%ZVEMRIE",55,0)
 ;====================================================================
"RTN","%ZVEMRIE",56,0)
EXTHELP(PC) ;Extended Help Text
"RTN","%ZVEMRIE",57,0)
 ;PC=Global piece that contains Parameter pointer.
"RTN","%ZVEMRIE",58,0)
 Q:'$G(DDS)  Q:$G(PC)'>0
"RTN","%ZVEMRIE",59,0)
 NEW CHK,FLAGQ,HD,I,INT,LINE,LN
"RTN","%ZVEMRIE",60,0)
 S DDSERROR=1
"RTN","%ZVEMRIE",61,0)
 S HD="E X T E N D E D   H E L P",$P(LINE,"=",79)=""
"RTN","%ZVEMRIE",62,0)
 W @IOF,!?(IOM-$L(HD)\2),HD,!,LINE
"RTN","%ZVEMRIE",63,0)
 S INT=+$P($G(^VEE(19200.113,DA,"P")),U,PC) ;Parameter
"RTN","%ZVEMRIE",64,0)
 S (CHK,FLAGQ,LN)=0
"RTN","%ZVEMRIE",65,0)
 F  S LN=$O(^VEE(19200.114,INT,"WP1",LN)) Q:LN'>0!FLAGQ  D  ;
"RTN","%ZVEMRIE",66,0)
 . W !?1,$G(^(LN,0)) S CHK=1
"RTN","%ZVEMRIE",67,0)
 . Q:$Y'>(IOSL-5)  Q:$O(^VEE(19200.114,INT,"WP1",LN))'>0
"RTN","%ZVEMRIE",68,0)
 . D PAUSE^%ZVEMKU(2,"Q") W:'FLAGQ @IOF
"RTN","%ZVEMRIE",69,0)
 I 'CHK D  ;
"RTN","%ZVEMRIE",70,0)
 . W !!?1,"There is no EXTENDED HELP for this field."
"RTN","%ZVEMRIE",71,0)
 . W !?1,"Fields with EXTENDED HELP will display '--> H=Help' in the Command Area."
"RTN","%ZVEMRIE",72,0)
 I 'FLAGQ D  ;
"RTN","%ZVEMRIE",73,0)
 . F I=$Y:1:(IOSL-5) W !
"RTN","%ZVEMRIE",74,0)
 . D PAUSE^%ZVEMKU(2,"P")
"RTN","%ZVEMRIE",75,0)
 D REFRESH^DDSUTL
"RTN","%ZVEMRIE",76,0)
 Q
"RTN","%ZVEMRLI")
0^109^B13102376
"RTN","%ZVEMRLI",1,0)
%ZVEMRLI ;DJB,VRR**RTN LBRY - Sign In Rtns,ALL,Edit IDENTIFIER ; 12/14/00 8:20pm
"RTN","%ZVEMRLI",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMRLI",3,0)
 ;
"RTN","%ZVEMRLI",4,0)
 ;--> ALL^%ZVEMRLI    = to sign in all routines
"RTN","%ZVEMRLI",5,0)
 ;    IDEDIT^%ZVEMRLI = to bulk edit IDENTIFIER field
"RTN","%ZVEMRLI",6,0)
 ;    IDDEL^%ZVEMRLI  = to bulk delete IDENTIFIER field
"RTN","%ZVEMRLI",7,0)
 ;
"RTN","%ZVEMRLI",8,0)
EN ;Use ALL^%ZVEMRLI if you need to sign in rtns other than your own.
"RTN","%ZVEMRLI",9,0)
 NEW FLAGQ,VEEUSERI,VEEUSERN,X
"RTN","%ZVEMRLI",10,0)
 S X="ERROR^%ZVEMRLU",@($$TRAP^%ZVEMKU1) KILL X
"RTN","%ZVEMRLI",11,0)
 Q:'$D(^VEE(19200.11))  ;...Library file doesn't exist
"RTN","%ZVEMRLI",12,0)
 S FLAGQ=0 D INIT^%ZVEMRLU G:FLAGQ EX
"RTN","%ZVEMRLI",13,0)
 D GETRTN G:FLAGQ EX
"RTN","%ZVEMRLI",14,0)
 G:'$D(^TMP("VPE","SELECT",$J)) EX ;No rtns selected
"RTN","%ZVEMRLI",15,0)
 I '$G(FLAGID) D SIGNIN G EX
"RTN","%ZVEMRLI",16,0)
 D EDIT
"RTN","%ZVEMRLI",17,0)
EX ;
"RTN","%ZVEMRLI",18,0)
 L -^VEE(19200.11)
"RTN","%ZVEMRLI",19,0)
 KILL ^TMP("VPE","SELECT",$J),^UTILITY($J)
"RTN","%ZVEMRLI",20,0)
 Q
"RTN","%ZVEMRLI",21,0)
 ;====================================================================
"RTN","%ZVEMRLI",22,0)
GETRTN ;Get rtns to sign in
"RTN","%ZVEMRLI",23,0)
 NEW CNT,DATA,ID,IEN,RTN,TMP,VEEBYI,VEEBYN
"RTN","%ZVEMRLI",24,0)
 W !,"Building routine list..."
"RTN","%ZVEMRLI",25,0)
 KILL ^TMP("VPE","SELECT",$J)
"RTN","%ZVEMRLI",26,0)
 KILL ^TMP("CE",$J)
"RTN","%ZVEMRLI",27,0)
 S CNT=1
"RTN","%ZVEMRLI",28,0)
 S RTN=""
"RTN","%ZVEMRLI",29,0)
 F  S RTN=$O(^VEE(19200.11,"B",RTN)) Q:RTN']""  D  ;
"RTN","%ZVEMRLI",30,0)
 . S IEN=$O(^VEE(19200.11,"B",RTN,"")) Q:IEN'>0
"RTN","%ZVEMRLI",31,0)
 . S DATA=$G(^VEE(19200.11,IEN,0)) Q:DATA']""
"RTN","%ZVEMRLI",32,0)
 . ;--> See if current user signed out this rtn. If not, quit unless
"RTN","%ZVEMRLI",33,0)
 . ;    tag ALL^%ZVEMRLI was used.
"RTN","%ZVEMRLI",34,0)
 . D GETBY^%ZVEMRLU(IEN)
"RTN","%ZVEMRLI",35,0)
 . I '$G(FLAGALL) Q:VEEBYI'=VEEUSERI
"RTN","%ZVEMRLI",36,0)
 . S ID=$P(DATA,U,4)
"RTN","%ZVEMRLI",37,0)
 . S TMP=IEN_$C(9)_RTN_$J("",15-$L(RTN))_"|"_VEEBYN_$J("",30-$L(VEEBYN))_"|"_$E(ID,1,22)
"RTN","%ZVEMRLI",38,0)
 . S ^TMP("CE",$J,CNT)=TMP
"RTN","%ZVEMRLI",39,0)
 . S CNT=CNT+1
"RTN","%ZVEMRLI",40,0)
 . W "."
"RTN","%ZVEMRLI",41,0)
 ;
"RTN","%ZVEMRLI",42,0)
 I '$D(^TMP("CE",$J)) D  Q
"RTN","%ZVEMRLI",43,0)
 . W !!,"You have no routines signed out."
"RTN","%ZVEMRLI",44,0)
 . D PAUSE^%ZVEMKU(2,"P")
"RTN","%ZVEMRLI",45,0)
 . S FLAGQ=1
"RTN","%ZVEMRLI",46,0)
 ;
"RTN","%ZVEMRLI",47,0)
 ;--> Set heading
"RTN","%ZVEMRLI",48,0)
 S ^TMP("CE",$J,"HD")="ROUTINE         SIGNED OUT BY                  IDENTIFIER"
"RTN","%ZVEMRLI",49,0)
 ;--> Run selector
"RTN","%ZVEMRLI",50,0)
 D SELECT^%ZVEMKT("^TMP(""CE"","_$J_")",1)
"RTN","%ZVEMRLI",51,0)
 KILL ^TMP("CE",$J)
"RTN","%ZVEMRLI",52,0)
 Q
"RTN","%ZVEMRLI",53,0)
 ;
"RTN","%ZVEMRLI",54,0)
SIGNIN ;Sign in selected rtns by deleting them from the file
"RTN","%ZVEMRLI",55,0)
 Q:$$ASK^%ZVEMKU("SIGN IN selected routine(s) now",1)'="Y"
"RTN","%ZVEMRLI",56,0)
 D LOCK^%ZVEMRLU Q:FLAGQ
"RTN","%ZVEMRLI",57,0)
 ;
"RTN","%ZVEMRLI",58,0)
 NEW %,%Y,CNT,DA,DATA,DDH,DIC,DIK,DZ,IEN,RTN,X,Y
"RTN","%ZVEMRLI",59,0)
 S CNT=1
"RTN","%ZVEMRLI",60,0)
 S IEN=0
"RTN","%ZVEMRLI",61,0)
 F  S IEN=$O(^TMP("VPE","SELECT",$J,IEN)) Q:IEN'>0  D  ;
"RTN","%ZVEMRLI",62,0)
 . S DATA=$G(^(IEN)) Q:DATA']""
"RTN","%ZVEMRLI",63,0)
 . S RTN=$E($P(DATA,$C(9),2),1,10)
"RTN","%ZVEMRLI",64,0)
 . S DA=$P(DATA,$C(9),1)
"RTN","%ZVEMRLI",65,0)
 . S DIK="^VEE(19200.11,"
"RTN","%ZVEMRLI",66,0)
 . D ^DIK
"RTN","%ZVEMRLI",67,0)
 . S CNT=CNT+1
"RTN","%ZVEMRLI",68,0)
 . W !?1,RTN,?15,"signed in..."
"RTN","%ZVEMRLI",69,0)
 W !!,(CNT-1)," routine(s) Signed In"
"RTN","%ZVEMRLI",70,0)
 D PAUSE^%ZVEMKU(2,"P")
"RTN","%ZVEMRLI",71,0)
 Q
"RTN","%ZVEMRLI",72,0)
 ;
"RTN","%ZVEMRLI",73,0)
EDIT ;Bulk edit IDENTIFIER field
"RTN","%ZVEMRLI",74,0)
 NEW %,%Y,CNT,D,D0,DA,DATA,DDH,DI,DIC,DIE,DQ,DR,IEN,RTN,VEEID,X,Y
"RTN","%ZVEMRLI",75,0)
 I FLAGID=1 D GETID Q:FLAGQ  S PROMPT="Update " ;Edit IDENTIFIER
"RTN","%ZVEMRLI",76,0)
 I FLAGID=2 S PROMPT="Delete " ;.................Delete IDENTIFIER
"RTN","%ZVEMRLI",77,0)
 W ! Q:$$ASK^%ZVEMKU(PROMPT_"IDENTIFIER field(s) now",1)'="Y"
"RTN","%ZVEMRLI",78,0)
 D LOCK^%ZVEMRLU Q:FLAGQ
"RTN","%ZVEMRLI",79,0)
 ;
"RTN","%ZVEMRLI",80,0)
 NEW %,%Y,CNT,DA,DATA,DDH,DIC,IEN,RTN,X,Y
"RTN","%ZVEMRLI",81,0)
 S CNT=1
"RTN","%ZVEMRLI",82,0)
 S IEN=0
"RTN","%ZVEMRLI",83,0)
 F  S IEN=$O(^TMP("VPE","SELECT",$J,IEN)) Q:IEN'>0  D  ;
"RTN","%ZVEMRLI",84,0)
 . S DATA=$G(^(IEN)) Q:DATA']""
"RTN","%ZVEMRLI",85,0)
 . S RTN=$E($P(DATA,$C(9),2),1,10)
"RTN","%ZVEMRLI",86,0)
 . S DA=$P(DATA,$C(9),1)
"RTN","%ZVEMRLI",87,0)
 . S DIE="^VEE(19200.11,"
"RTN","%ZVEMRLI",88,0)
 . I FLAGID=1 S DR="4///^S X=VEEID"
"RTN","%ZVEMRLI",89,0)
 . I FLAGID=2 S DR="4///@"
"RTN","%ZVEMRLI",90,0)
 . D ^DIE
"RTN","%ZVEMRLI",91,0)
 . S CNT=CNT+1 W !,RTN,?15,"updated..."
"RTN","%ZVEMRLI",92,0)
 W !!,(CNT-1)," routine(s) updated"
"RTN","%ZVEMRLI",93,0)
 D PAUSE^%ZVEMKU(2,"P")
"RTN","%ZVEMRLI",94,0)
 Q
"RTN","%ZVEMRLI",95,0)
 ;
"RTN","%ZVEMRLI",96,0)
GETID ;Get IDENTIFIER to stuff
"RTN","%ZVEMRLI",97,0)
 W !
"RTN","%ZVEMRLI",98,0)
GETID1 W !,"IDENTIFIER: "
"RTN","%ZVEMRLI",99,0)
 R VEEID:300 S:'$T VEEID="" I "^"[VEEID S VEEID="" Q
"RTN","%ZVEMRLI",100,0)
 I "??"[VEEID!($L(VEEID)>30) D  G GETID1
"RTN","%ZVEMRLI",101,0)
 . W !,"Enter an identifier word or phrase (1-30 characters)."
"RTN","%ZVEMRLI",102,0)
 Q
"RTN","%ZVEMRLI",103,0)
 ;====================================================================
"RTN","%ZVEMRLI",104,0)
ALL ;Allows signing in ALL rtns, not just your own
"RTN","%ZVEMRLI",105,0)
 NEW FLAGALL S FLAGALL=1
"RTN","%ZVEMRLI",106,0)
 G EN
"RTN","%ZVEMRLI",107,0)
 ;
"RTN","%ZVEMRLI",108,0)
IDEDIT ;Bulk edit IDENTIFIER field
"RTN","%ZVEMRLI",109,0)
 NEW FLAGID S FLAGID=1
"RTN","%ZVEMRLI",110,0)
 G EN
"RTN","%ZVEMRLI",111,0)
 ;
"RTN","%ZVEMRLI",112,0)
IDDEL ;Bulk delete IDENTIFIER field
"RTN","%ZVEMRLI",113,0)
 NEW FLAGID S FLAGID=2
"RTN","%ZVEMRLI",114,0)
 G EN
"RTN","%ZVEMRLM")
0^110^B14216997
"RTN","%ZVEMRLM",1,0)
%ZVEMRLM ;DJB,VRR**RTN LBRY - Menu ; 9/24/02 7:10am
"RTN","%ZVEMRLM",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMRLM",3,0)
 ;
"RTN","%ZVEMRLM",4,0)
EN ;Entry Point
"RTN","%ZVEMRLM",5,0)
 ;--> User can type ..LBRY ON/OFF to activate/deactivate Rtn Lbry.
"RTN","%ZVEMRLM",6,0)
 I ",ON,OFF,"[(","_$G(%1)_",") D ONOFF^%ZVEMRLU Q
"RTN","%ZVEMRLM",7,0)
 NEW CNT,COL,COLUMNS,COLCNT,HD,LAST,PROMPT,SET,SPACES,WIDTH,WRITE
"RTN","%ZVEMRLM",8,0)
 NEW CNTOLD,DX,DY,FLAGQ,I,OPT,TEST,TXT,VEES,X,Y
"RTN","%ZVEMRLM",9,0)
 I $G(DUZ)'>0 D ID^%ZVEMKU Q:$G(DUZ)=""
"RTN","%ZVEMRLM",10,0)
 I '$D(VEE("OS")) NEW VEE
"RTN","%ZVEMRLM",11,0)
 S FLAGQ=0 D INIT Q:FLAGQ
"RTN","%ZVEMRLM",12,0)
 X VEES("RM0")
"RTN","%ZVEMRLM",13,0)
TOP ;
"RTN","%ZVEMRLM",14,0)
 F  S FLAGQ=0 D HD^%ZVEMSHY,LIST,GETOPT Q:FLAGQ  D RUN Q:FLAGQ
"RTN","%ZVEMRLM",15,0)
EX ;
"RTN","%ZVEMRLM",16,0)
 X VEES("RM0") W @VEE("IOF")
"RTN","%ZVEMRLM",17,0)
 Q
"RTN","%ZVEMRLM",18,0)
 ;
"RTN","%ZVEMRLM",19,0)
GETOPT ;
"RTN","%ZVEMRLM",20,0)
 X PROMPT S OPT=$$READ^%ZVEMKRN()
"RTN","%ZVEMRLM",21,0)
 I OPT="^" S FLAGQ=1 Q
"RTN","%ZVEMRLM",22,0)
 I ",<ESC>,<F1E>,<F1Q>,<TAB>,<TO>,"[(","_VEE("K")_",") S FLAGQ=1 Q
"RTN","%ZVEMRLM",23,0)
 I VEE("K")="<RET>" S OPT=CNT Q
"RTN","%ZVEMRLM",24,0)
 I VEE("K")?1"<A"1A1">" S CNTOLD=CNT D ARROW S OPT=CNT D REDRAW G GETOPT
"RTN","%ZVEMRLM",25,0)
 S OPT=$$ALLCAPS^%ZVEMKU(OPT),TEST=0 D  I TEST Q
"RTN","%ZVEMRLM",26,0)
 . F I=1:1 S X=$P($T(MENU+I),";",5) Q:X=""  I $E(X,1,$L(OPT))=OPT S (CNT,OPT)=I,COL=$P($T(MENU+I),";",3),TEST=1 Q
"RTN","%ZVEMRLM",27,0)
 G GETOPT
"RTN","%ZVEMRLM",28,0)
 ;
"RTN","%ZVEMRLM",29,0)
ARROW ;Arrow Keys
"RTN","%ZVEMRLM",30,0)
 I "<AU>,<AD>"[VEE("K") D  S COL=$P($T(MENU+CNT),";",3) Q
"RTN","%ZVEMRLM",31,0)
 . I VEE("K")="<AU>" S CNT=CNT-1 S:CNT<1 CNT=LAST Q
"RTN","%ZVEMRLM",32,0)
 . I VEE("K")="<AD>" S CNT=CNT+1 S:CNT>LAST CNT=1
"RTN","%ZVEMRLM",33,0)
 I VEE("K")="<AR>" Q:COL=COLCNT  D  D ADJUST Q
"RTN","%ZVEMRLM",34,0)
 . S CNT=CNT+COL(COL),COL=COL+1 S:CNT>LAST CNT=LAST
"RTN","%ZVEMRLM",35,0)
 I VEE("K")="<AL>" Q:COL=1  D  D ADJUST Q
"RTN","%ZVEMRLM",36,0)
 . S COL=COL-1,CNT=CNT-COL(COL)
"RTN","%ZVEMRLM",37,0)
 Q
"RTN","%ZVEMRLM",38,0)
 ;
"RTN","%ZVEMRLM",39,0)
RUN ;Run selected routine
"RTN","%ZVEMRLM",40,0)
 S X=$P($T(MENU+OPT),";",6) I X="QUIT" S FLAGQ=1 Q
"RTN","%ZVEMRLM",41,0)
 NEW CNT,COL,COLUMNS,COLCNT,HD,LAST,PROMPT,SET,SPACES,WIDTH,WRITE
"RTN","%ZVEMRLM",42,0)
 I X]"" W @VEE("IOF") D @X X VEES("RM0")
"RTN","%ZVEMRLM",43,0)
 Q
"RTN","%ZVEMRLM",44,0)
 ;
"RTN","%ZVEMRLM",45,0)
LIST ;List Menu Options
"RTN","%ZVEMRLM",46,0)
 NEW HD
"RTN","%ZVEMRLM",47,0)
 F I=1:1 S TXT=$T(MENU+I) Q:TXT=""!(TXT[";***")  D  X SET,WRITE
"RTN","%ZVEMRLM",48,0)
 . ;
"RTN","%ZVEMRLM",49,0)
 . ;Display status of LIBRARY and VERSIONING
"RTN","%ZVEMRLM",50,0)
 . I $P(TXT,";",4)["L I B R A R Y" D  ;
"RTN","%ZVEMRLM",51,0)
 .. S X=$P(TXT,";",4)
"RTN","%ZVEMRLM",52,0)
 .. S X=X_$S($G(^VEE(19200.11,"A-STATUS"))="ON":" (Active)",1:" (Inactive)")
"RTN","%ZVEMRLM",53,0)
 .. S $P(TXT,";",4)=X
"RTN","%ZVEMRLM",54,0)
 . ;
"RTN","%ZVEMRLM",55,0)
 . I $P(TXT,";",4)["V E R S I O N I N G" D  ;
"RTN","%ZVEMRLM",56,0)
 .. S X=$P(TXT,";",4)
"RTN","%ZVEMRLM",57,0)
 .. S X=X_$S($G(^VEE(19200.112,"A-STATUS"))="ON":" (Active)",1:" (Inactive)")
"RTN","%ZVEMRLM",58,0)
 .. S $P(TXT,";",4)=X
"RTN","%ZVEMRLM",59,0)
 ;
"RTN","%ZVEMRLM",60,0)
 S TXT=$T(MENU+CNT) Q:TXT=""
"RTN","%ZVEMRLM",61,0)
 X SET W @VEE("RON") X WRITE W @VEE("ROFF")
"RTN","%ZVEMRLM",62,0)
 Q
"RTN","%ZVEMRLM",63,0)
 ;
"RTN","%ZVEMRLM",64,0)
REDRAW ;User moved cursor
"RTN","%ZVEMRLM",65,0)
 S TXT=$T(MENU+CNTOLD)
"RTN","%ZVEMRLM",66,0)
 X SET,WRITE
"RTN","%ZVEMRLM",67,0)
 S TXT=$T(MENU+CNT)
"RTN","%ZVEMRLM",68,0)
 X SET W @VEE("RON") X WRITE W @VEE("ROFF")
"RTN","%ZVEMRLM",69,0)
 Q
"RTN","%ZVEMRLM",70,0)
 ;
"RTN","%ZVEMRLM",71,0)
ADJUST ;Adjust CNT when you switch columns.
"RTN","%ZVEMRLM",72,0)
 F  Q:$P($T(MENU+CNT),";",3)=COL  S CNT=CNT-1
"RTN","%ZVEMRLM",73,0)
 Q
"RTN","%ZVEMRLM",74,0)
 ;
"RTN","%ZVEMRLM",75,0)
INIT ;Initialize variables
"RTN","%ZVEMRLM",76,0)
 S COLUMNS="7^6"
"RTN","%ZVEMRLM",77,0)
 S WIDTH=33
"RTN","%ZVEMRLM",78,0)
 S HD="ROUTINE LIBRARY/VERSIONING"
"RTN","%ZVEMRLM",79,0)
 D INIT^%ZVEMSHY
"RTN","%ZVEMRLM",80,0)
 S PROMPT="S DX=3,DY=22 X VEES(""CRSR"") W ""SELECT: "",@VEES(""BLANK_C_EOL"")"
"RTN","%ZVEMRLM",81,0)
 Q
"RTN","%ZVEMRLM",82,0)
 ;
"RTN","%ZVEMRLM",83,0)
MENU ;MENU OPTIONS
"RTN","%ZVEMRLM",84,0)
 ;;1;SO  Sign Out Routines;SO;^%ZVEMRLO;2;5
"RTN","%ZVEMRLM",85,0)
 ;;1;SI  Sign In Routines;SI;^%ZVEMRLI;2;6
"RTN","%ZVEMRLM",86,0)
 ;;1;LP  Print 'Signed Out' List;LP;^%ZVEMRLP;2;8
"RTN","%ZVEMRLM",87,0)
 ;;1;BE  Bulk Edit IDENTIFIER Field;BE;IDEDIT^%ZVEMRLI;2;9
"RTN","%ZVEMRLM",88,0)
 ;;1;BDL Bulk Delete IDENTIFIER Field;BDL;IDDEL^%ZVEMRLI;2;10
"RTN","%ZVEMRLM",89,0)
 ;;1;H   Help;H;HELP^%ZVEMKT("LIBRARY");2;12
"RTN","%ZVEMRLM",90,0)
 ;;1;Q   Quit;Q;QUIT;2;13
"RTN","%ZVEMRLM",91,0)
 ;;2;I   Inquire;I;INQ^%ZVEMRLY;42;5
"RTN","%ZVEMRLM",92,0)
 ;;2;U   Update Description Field;U;DESC^%ZVEMRLY;42;6
"RTN","%ZVEMRLM",93,0)
 ;;2;RV  Review a Version;RV;REVIEW^%ZVEMRLY;42;8
"RTN","%ZVEMRLM",94,0)
 ;;2;RS  Restore a Version;RS;RESTORE^%ZVEMRLY;42;9
"RTN","%ZVEMRLM",95,0)
 ;;2;D   Delete Version(s);D;DELETE^%ZVEMRLZ;42;11
"RTN","%ZVEMRLM",96,0)
 ;;2;BDV Bulk Delete Version(s);BDV;BULKDEL^%ZVEMRLZ;42;12
"RTN","%ZVEMRLM",97,0)
 ;;1;    L I B R A R Y;;;2;3
"RTN","%ZVEMRLM",98,0)
 ;;2;    V E R S I O N I N G;;;40;3
"RTN","%ZVEMRLM",99,0)
 ;;***
"RTN","%ZVEMRLO")
0^111^B7193083
"RTN","%ZVEMRLO",1,0)
%ZVEMRLO ;DJB,VRR**RTN LBRY - Sign Out Rtns,Rtn Save ; 11/24/00 8:24am
"RTN","%ZVEMRLO",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMRLO",3,0)
 ;
"RTN","%ZVEMRLO",4,0)
 NEW FLAGQ,VEEID,VEEUSERI,VEEUSERN
"RTN","%ZVEMRLO",5,0)
 NEW %,%Y,%DT,D,D0,DA,DDH,DI,DIC,DIE,DQ,DR,DZ,X,Y
"RTN","%ZVEMRLO",6,0)
 S X="ERROR^%ZVEMRLU",@($$TRAP^%ZVEMKU1) KILL X
"RTN","%ZVEMRLO",7,0)
 Q:'$D(^VEE(19200.11))  ;...Library file doesn't exist
"RTN","%ZVEMRLO",8,0)
 S FLAGQ=0
"RTN","%ZVEMRLO",9,0)
 D INIT^%ZVEMRLU Q:FLAGQ
"RTN","%ZVEMRLO",10,0)
TOP ;
"RTN","%ZVEMRLO",11,0)
 W @VEE("IOF"),!,"*** SIGN OUT ROUTINES ***"
"RTN","%ZVEMRLO",12,0)
 D SELECT^%ZVEMRUS G:'$D(^UTILITY($J)) EX
"RTN","%ZVEMRLO",13,0)
 D GETID^%ZVEMRLI
"RTN","%ZVEMRLO",14,0)
 W ! G:$$ASK^%ZVEMKU("SIGN OUT routine(s) now",1)'="Y" TOP
"RTN","%ZVEMRLO",15,0)
 D LOCK^%ZVEMRLU G:FLAGQ EX
"RTN","%ZVEMRLO",16,0)
 D LOOP
"RTN","%ZVEMRLO",17,0)
EX ;
"RTN","%ZVEMRLO",18,0)
 KILL ^UTILITY($J)
"RTN","%ZVEMRLO",19,0)
 L -^VEE(19200.11)
"RTN","%ZVEMRLO",20,0)
 Q
"RTN","%ZVEMRLO",21,0)
 ;====================================================================
"RTN","%ZVEMRLO",22,0)
LOOP ;Stuff data into VPE RTN LBRY
"RTN","%ZVEMRLO",23,0)
 NEW CNT,IEN,NAME,RTN,VEEBYI,VEEBYN,Y
"RTN","%ZVEMRLO",24,0)
 S CNT=1,RTN=0
"RTN","%ZVEMRLO",25,0)
 F  S RTN=$O(^UTILITY($J,RTN)) Q:RTN=""  D  ;
"RTN","%ZVEMRLO",26,0)
 . I $E(RTN)'?1A,$E(RTN)'?1"%" Q
"RTN","%ZVEMRLO",27,0)
 . I '$D(^VEE(19200.11,"B",RTN)) D CREATE(RTN) Q
"RTN","%ZVEMRLO",28,0)
 . W $C(7),!,RTN,?12,"--> Already signed out by "
"RTN","%ZVEMRLO",29,0)
 . S IEN=$O(^VEE(19200.11,"B",RTN,"")) Q:IEN'>0
"RTN","%ZVEMRLO",30,0)
 . D GETBY^%ZVEMRLU(IEN) Q:VEEBYN']""  W VEEBYN
"RTN","%ZVEMRLO",31,0)
 W !!?1,(CNT-1)," routine(s) Signed Out"
"RTN","%ZVEMRLO",32,0)
 D PAUSE^%ZVEMKU(2,"P")
"RTN","%ZVEMRLO",33,0)
 Q
"RTN","%ZVEMRLO",34,0)
CREATE(RTN) ;Create entry and 'stuff' data
"RTN","%ZVEMRLO",35,0)
 ;X=Routine name. Requires VEEID,VEEUSERI
"RTN","%ZVEMRLO",36,0)
 Q:$G(RTN)']""
"RTN","%ZVEMRLO",37,0)
 S X=RTN
"RTN","%ZVEMRLO",38,0)
 S DIC="^VEE(19200.11,"
"RTN","%ZVEMRLO",39,0)
 S DIC(0)="QL"
"RTN","%ZVEMRLO",40,0)
 KILL DD,DO D FILE^DICN Q:$P(Y,U,3)'=1
"RTN","%ZVEMRLO",41,0)
 S DIE=DIC
"RTN","%ZVEMRLO",42,0)
 S DA=+Y
"RTN","%ZVEMRLO",43,0)
 S DR="4///^S X=$G(VEEID);12///NOW;13////^S X=VEEUSERI"
"RTN","%ZVEMRLO",44,0)
 D ^DIE
"RTN","%ZVEMRLO",45,0)
 S CNT=$G(CNT)+1
"RTN","%ZVEMRLO",46,0)
 W !!,RTN," signed out."
"RTN","%ZVEMRLO",47,0)
 Q
"RTN","%ZVEMRLO",48,0)
 ;==================================================================
"RTN","%ZVEMRLO",49,0)
RS(JOB) ;Replace ^UTILITY($J,RTNS) routines with ..LBRY routines.
"RTN","%ZVEMRLO",50,0)
 ;JOB=Job#
"RTN","%ZVEMRLO",51,0)
 ;VEE("OS"): 8=MSM 18=OpenM
"RTN","%ZVEMRLO",52,0)
 ;
"RTN","%ZVEMRLO",53,0)
 Q:'$G(JOB)
"RTN","%ZVEMRLO",54,0)
 Q:'$G(VEE("OS"))
"RTN","%ZVEMRLO",55,0)
 Q:'$D(^VEE(19200.11,"B"))
"RTN","%ZVEMRLO",56,0)
 ;
"RTN","%ZVEMRLO",57,0)
 NEW CNT,ID,IEN,RTN
"RTN","%ZVEMRLO",58,0)
 S ID=$$RSID() Q:ID="^"
"RTN","%ZVEMRLO",59,0)
 I VEE("OS")=8,'$G(%RSN) KILL ^UTILITY(JOB)
"RTN","%ZVEMRLO",60,0)
 S CNT=0,RTN=""
"RTN","%ZVEMRLO",61,0)
 F  S RTN=$O(^VEE(19200.11,"B",RTN)) Q:RTN']""  D  ;
"RTN","%ZVEMRLO",62,0)
 . S IEN=$O(^VEE(19200.11,"B",RTN,"")) Q:IEN'>0
"RTN","%ZVEMRLO",63,0)
 . I ID]"",ID'=$P($G(^VEE(19200.11,IEN,0)),"^",4) Q
"RTN","%ZVEMRLO",64,0)
 . Q:$D(^UTILITY(JOB,RTN))
"RTN","%ZVEMRLO",65,0)
 . S ^UTILITY(JOB,RTN)=""
"RTN","%ZVEMRLO",66,0)
 . S CNT=CNT+1
"RTN","%ZVEMRLO",67,0)
 . I VEE("OS")=18 S %R=$G(%R)+1
"RTN","%ZVEMRLO",68,0)
 Q:'CNT
"RTN","%ZVEMRLO",69,0)
 I VEE("OS")=8 S %RSN=1
"RTN","%ZVEMRLO",70,0)
 W !!?10,CNT," routine",$S(CNT=1:"",1:"s")," added."
"RTN","%ZVEMRLO",71,0)
 Q
"RTN","%ZVEMRLO",72,0)
RSID() ;Restrict rtns selected based on IDENTIFIER field.
"RTN","%ZVEMRLO",73,0)
 NEW ID
"RTN","%ZVEMRLO",74,0)
RSID1 W !!,"Enter IDENTIFIER: "
"RTN","%ZVEMRLO",75,0)
 R ID:300 S:'$T ID="^" I "^"[ID Q ID
"RTN","%ZVEMRLO",76,0)
 I $E(ID)="?" D  G RSID1
"RTN","%ZVEMRLO",77,0)
 . W !!,"If you want only those routines with a certain IDENTIFIER, enter it now."
"RTN","%ZVEMRLO",78,0)
 . W !,"Hit <RETURN> for ALL routines, or ^ for NO routines."
"RTN","%ZVEMRLO",79,0)
 Q ID
"RTN","%ZVEMRLP")
0^112^B11509333
"RTN","%ZVEMRLP",1,0)
%ZVEMRLP ;DJB,VRR**RTN LBRY - Print ; 11/20/00 9:53pm
"RTN","%ZVEMRLP",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMRLP",3,0)
 ;
"RTN","%ZVEMRLP",4,0)
EN ;Entry Point
"RTN","%ZVEMRLP",5,0)
 NEW FLAGQ,PAGE,VEEANS,VEEUSERI,VEEUSERN
"RTN","%ZVEMRLP",6,0)
 S FLAGQ=0 D INIT G:FLAGQ EX
"RTN","%ZVEMRLP",7,0)
 W @VEE("IOF"),!?1,"***PRINT ROUTINE LIBRARY***"
"RTN","%ZVEMRLP",8,0)
 D ASK G:FLAGQ EX
"RTN","%ZVEMRLP",9,0)
 D DEVICE G:POP!FLAGQ EX U IO
"RTN","%ZVEMRLP",10,0)
START ;
"RTN","%ZVEMRLP",11,0)
 NEW FLAGQ
"RTN","%ZVEMRLP",12,0)
 S FLAGQ=0 D HD,HD1,PRINT
"RTN","%ZVEMRLP",13,0)
EX ;
"RTN","%ZVEMRLP",14,0)
 D ^%ZISC
"RTN","%ZVEMRLP",15,0)
 Q
"RTN","%ZVEMRLP",16,0)
DEVICE ;Get device
"RTN","%ZVEMRLP",17,0)
 NEW ZTDESC,ZTRTN,ZTSAVE
"RTN","%ZVEMRLP",18,0)
 S ZTRTN="START^%ZVEMRLP",ZTDESC="VPE - Print Routine Library"
"RTN","%ZVEMRLP",19,0)
 S ZTSAVE="VEE*"
"RTN","%ZVEMRLP",20,0)
 D TASK^%ZVEMKP()
"RTN","%ZVEMRLP",21,0)
 Q
"RTN","%ZVEMRLP",22,0)
ASK ;Print what?
"RTN","%ZVEMRLP",23,0)
 W !!?1,"1. List ALL routines signed out"
"RTN","%ZVEMRLP",24,0)
 W !?1,"2. List ONLY routines you've signed out"
"RTN","%ZVEMRLP",25,0)
 W !?1,"3. List all routines EXCEPT those you've signed out"
"RTN","%ZVEMRLP",26,0)
ASK1 W !!?1,"Select NUMBER: "
"RTN","%ZVEMRLP",27,0)
 R VEEANS:300 S:'$T VEEANS="^" I "^"[VEEANS S FLAGQ=1 Q
"RTN","%ZVEMRLP",28,0)
 I ",1,2,3,"'[(","_VEEANS_",") D  G ASK1
"RTN","%ZVEMRLP",29,0)
 . W "   Enter 1, 2, or 3"
"RTN","%ZVEMRLP",30,0)
 Q
"RTN","%ZVEMRLP",31,0)
PRINT ;
"RTN","%ZVEMRLP",32,0)
 NEW CNT,DATA,DATE,I,ID,IEN,PER,RTN,TMP,VEEBYI,VEEBYN,Y
"RTN","%ZVEMRLP",33,0)
 S CNT=1,RTN=""
"RTN","%ZVEMRLP",34,0)
 F  S RTN=$O(^VEE(19200.11,"B",RTN)) Q:RTN']""!FLAGQ  D  ;
"RTN","%ZVEMRLP",35,0)
 . S IEN=$O(^VEE(19200.11,"B",RTN,"")) Q:IEN'>0
"RTN","%ZVEMRLP",36,0)
 . S DATA=$G(^VEE(19200.11,IEN,0)) Q:DATA']""
"RTN","%ZVEMRLP",37,0)
 . D GETBY^%ZVEMRLU(IEN)
"RTN","%ZVEMRLP",38,0)
 . I VEEANS=2,VEEUSERI'=VEEBYI Q  ;............Current user only
"RTN","%ZVEMRLP",39,0)
 . I VEEANS=3,VEEUSERI=VEEBYI Q  ;.............All except current user
"RTN","%ZVEMRLP",40,0)
 . S ID=$P(DATA,U,4) ;.........................Package
"RTN","%ZVEMRLP",41,0)
 . S (TMP,Y)=$P(DATA,U,12) D DD^%DT ;..........Date signed out
"RTN","%ZVEMRLP",42,0)
 . S DATE=$$DATEDASH^%ZVEMKU1($P(TMP,"@",1))
"RTN","%ZVEMRLP",43,0)
 . I Y["@" S DATE=DATE_" "_$P(Y,"@",2)
"RTN","%ZVEMRLP",44,0)
 . S PER=$P(DATA,U,13) ;.......................Signed out by
"RTN","%ZVEMRLP",45,0)
 . I PER>0 S PER=$P($G(^VEE(19200.111,PER,0)),U,1)
"RTN","%ZVEMRLP",46,0)
 . W !,$J(CNT,3),". ",RTN,?15,$E(PER,1,23),?40,DATE,?57,$E(ID,1,22)
"RTN","%ZVEMRLP",47,0)
 . S CNT=CNT+1
"RTN","%ZVEMRLP",48,0)
 . I $Y>(IOSL-6) D PAGE
"RTN","%ZVEMRLP",49,0)
 . Q
"RTN","%ZVEMRLP",50,0)
 Q:FLAGQ
"RTN","%ZVEMRLP",51,0)
 F I=$Y:1:IOSL-6 W !
"RTN","%ZVEMRLP",52,0)
 W !!,?(IOM-($L(PAGE)+6)\2),"PAGE: ",PAGE
"RTN","%ZVEMRLP",53,0)
 I $E(IOST,1,2)="P-" Q
"RTN","%ZVEMRLP",54,0)
 D PAUSE^%ZVEMKU(1,"P")
"RTN","%ZVEMRLP",55,0)
 Q
"RTN","%ZVEMRLP",56,0)
PAGE ;
"RTN","%ZVEMRLP",57,0)
 I $O(^VEE(19200.11,"B",RTN))']"" Q
"RTN","%ZVEMRLP",58,0)
 W !!,?(IOM-($L(PAGE)+6)\2),"PAGE: ",PAGE S PAGE=PAGE+1
"RTN","%ZVEMRLP",59,0)
 I $E(IOST,1,2)="P-" W @IOF,! D HD1 Q
"RTN","%ZVEMRLP",60,0)
 D PAUSE^%ZVEMKU(1,"Q") Q:FLAGQ  W @IOF D HD1 Q
"RTN","%ZVEMRLP",61,0)
 Q
"RTN","%ZVEMRLP",62,0)
PAGE1 ;Write Page#
"RTN","%ZVEMRLP",63,0)
 I $E(IOST,1,2)="P-" W !
"RTN","%ZVEMRLP",64,0)
 W !,?(IOM-($L(PAGE)+6)\2),"PAGE: ",PAGE S PAGE=PAGE+1
"RTN","%ZVEMRLP",65,0)
 Q
"RTN","%ZVEMRLP",66,0)
HD ;Heading
"RTN","%ZVEMRLP",67,0)
 NEW HD
"RTN","%ZVEMRLP",68,0)
 I $E(IOST,1,2)="C-" W @IOF
"RTN","%ZVEMRLP",69,0)
 E  W !!
"RTN","%ZVEMRLP",70,0)
 S HD="R O U T I N E S   S I G N E D   O U T"
"RTN","%ZVEMRLP",71,0)
 W !?(IOM-$L(HD)\2),HD
"RTN","%ZVEMRLP",72,0)
 S HD="As of: "_$$DATE^%ZVEMKDT(1)_" "_$$TIME^%ZVEMKDT(2)
"RTN","%ZVEMRLP",73,0)
 W !?(IOM-24\2),HD
"RTN","%ZVEMRLP",74,0)
 I $E(IOST,1,2)="P-" W !
"RTN","%ZVEMRLP",75,0)
 Q
"RTN","%ZVEMRLP",76,0)
HD1 ;
"RTN","%ZVEMRLP",77,0)
 W !?5,"ROUTINE",?15,"SIGNED OUT BY",?40,"DATE SIGNED OUT",?57,"IDENTIFIER"
"RTN","%ZVEMRLP",78,0)
 W !?5,"--------",?15,"-----------------------",?40,"---------------",?57,"----------------------"
"RTN","%ZVEMRLP",79,0)
 Q
"RTN","%ZVEMRLP",80,0)
INIT ;
"RTN","%ZVEMRLP",81,0)
 I '$D(^VEE(19200.11)) S FLAGQ=1 Q  ;.........Invalid UCI
"RTN","%ZVEMRLP",82,0)
 I '$D(IOF)!('$D(IOST)),$D(^%ZIS) D HOME^%ZIS 
"RTN","%ZVEMRLP",83,0)
 I '$D(IOF) D MSG^%ZVEMRLU(6) Q  ;............IO variables not defined
"RTN","%ZVEMRLP",84,0)
 Q:'$$CHKLBRY^%ZVEMRLU()  ;...................Check environment
"RTN","%ZVEMRLP",85,0)
 D GETUSER^%ZVEMRLU() Q:FLAGQ  ;..............Identify current user
"RTN","%ZVEMRLP",86,0)
 S PAGE=1,U="^"
"RTN","%ZVEMRLP",87,0)
 Q
"RTN","%ZVEMRLU")
0^113^B20570634
"RTN","%ZVEMRLU",1,0)
%ZVEMRLU ;DJB,VRR**RTN LBRY - Utilities ; 9/6/02 8:16am
"RTN","%ZVEMRLU",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMRLU",3,0)
 ;
"RTN","%ZVEMRLU",4,0)
ADD(RTN) ;Does user want to sign out current rtn?
"RTN","%ZVEMRLU",5,0)
 Q:$G(RTN)']""
"RTN","%ZVEMRLU",6,0)
 Q:'$$CHKLBRY(1,"L")
"RTN","%ZVEMRLU",7,0)
 Q:$D(^VEE(19200.11,"B",RTN))  ;...Already signed out
"RTN","%ZVEMRLU",8,0)
 ;
"RTN","%ZVEMRLU",9,0)
 W !!,"--- LIBRARY ---",!
"RTN","%ZVEMRLU",10,0)
 Q:$$ASK^%ZVEMKU("Sign out this routine")'="Y"
"RTN","%ZVEMRLU",11,0)
 ;
"RTN","%ZVEMRLU",12,0)
 NEW %,%Y,%DT,D,D0,DA,DDH,DI,DIC,DIE,DQ,DR,DZ,X,Y
"RTN","%ZVEMRLU",13,0)
 NEW CNT,VEEPKGI,VEEUSERI,VEEUSERN
"RTN","%ZVEMRLU",14,0)
 ;
"RTN","%ZVEMRLU",15,0)
 D GETID^%ZVEMRLI
"RTN","%ZVEMRLU",16,0)
 D GETUSER() Q:VEEUSERI'>0
"RTN","%ZVEMRLU",17,0)
 D CREATE^%ZVEMRLO(RTN)
"RTN","%ZVEMRLU",18,0)
 Q
"RTN","%ZVEMRLU",19,0)
 ;
"RTN","%ZVEMRLU",20,0)
CHKLBRY(NOMSG,MOD) ;Check Library environment
"RTN","%ZVEMRLU",21,0)
 ;Return: 0=Not ok
"RTN","%ZVEMRLU",22,0)
 ;        1=Ok
"RTN","%ZVEMRLU",23,0)
 ;NOMSG=1 Don't display messages
"RTN","%ZVEMRLU",24,0)
 ;MOD: L=Library, V=Versioning
"RTN","%ZVEMRLU",25,0)
 ;
"RTN","%ZVEMRLU",26,0)
 S NOMSG=$G(NOMSG)
"RTN","%ZVEMRLU",27,0)
 S MOD=$G(MOD)
"RTN","%ZVEMRLU",28,0)
 ;
"RTN","%ZVEMRLU",29,0)
 I '$G(VEE("ID")) D  Q 0 ;.....................VPE ID not defined
"RTN","%ZVEMRLU",30,0)
 . I 'NOMSG D MSG(3)
"RTN","%ZVEMRLU",31,0)
 I '$D(DUZ)!('$D(DUZ(0))) D  Q 0 ;.............DUZ/DUZ(0) not defined
"RTN","%ZVEMRLU",32,0)
 . I 'NOMSG D MSG(8)
"RTN","%ZVEMRLU",33,0)
 ;
"RTN","%ZVEMRLU",34,0)
 I MOD="L",'$D(^VEE(19200.11)) D  Q 0 ;........No Lbry file
"RTN","%ZVEMRLU",35,0)
 . I 'NOMSG D MSG(2)
"RTN","%ZVEMRLU",36,0)
 I MOD="L",$G(^VEE(19200.11,"A-STATUS"))'="ON" D  Q 0 ;Lbry inactive
"RTN","%ZVEMRLU",37,0)
 . I 'NOMSG D MSG(1)
"RTN","%ZVEMRLU",38,0)
 I MOD="V",'$D(^VEE(19200.112)) D  Q 0 ;.......No Ver file
"RTN","%ZVEMRLU",39,0)
 . I 'NOMSG D MSG(10)
"RTN","%ZVEMRLU",40,0)
 I MOD="V",$G(^VEE(19200.112,"A-STATUS"))'="ON" D  Q 0 ;Ver inactive
"RTN","%ZVEMRLU",41,0)
 . I 'NOMSG D MSG(9)
"RTN","%ZVEMRLU",42,0)
 Q 1
"RTN","%ZVEMRLU",43,0)
 ;
"RTN","%ZVEMRLU",44,0)
GETUSER(NOMSG) ;Identify current user
"RTN","%ZVEMRLU",45,0)
 ;Return: VEEUSERI=IEN
"RTN","%ZVEMRLU",46,0)
 ;        VEEUSERN=Name
"RTN","%ZVEMRLU",47,0)
 ;NOMSG=1 Don't display messages
"RTN","%ZVEMRLU",48,0)
 NEW Y
"RTN","%ZVEMRLU",49,0)
 S (VEEUSERI,VEEUSERN)=""
"RTN","%ZVEMRLU",50,0)
 S VEEUSERI=$O(^VEE(19200.111,"ID",VEE("ID"),""))
"RTN","%ZVEMRLU",51,0)
 I 'VEEUSERI D  Q
"RTN","%ZVEMRLU",52,0)
 . I '$G(NOMSG) D MSG(5)
"RTN","%ZVEMRLU",53,0)
 S VEEUSERN=$P($G(^VEE(19200.111,VEEUSERI,0)),U,1)
"RTN","%ZVEMRLU",54,0)
 Q
"RTN","%ZVEMRLU",55,0)
 ;
"RTN","%ZVEMRLU",56,0)
GETBY(IEN) ;Identify who signed out rtn
"RTN","%ZVEMRLU",57,0)
 ;Return: VEEBYI: IEN
"RTN","%ZVEMRLU",58,0)
 ;        VEEBYN: Name
"RTN","%ZVEMRLU",59,0)
 ;IEN=Internal number of VPE RTN LBRY entry
"RTN","%ZVEMRLU",60,0)
 S (VEEBYI,VEEBYN)=""
"RTN","%ZVEMRLU",61,0)
 Q:'$G(IEN)
"RTN","%ZVEMRLU",62,0)
 S VEEBYI=$P($G(^VEE(19200.11,IEN,0)),U,13)
"RTN","%ZVEMRLU",63,0)
 I VEEBYI S VEEBYN=$P($G(^VEE(19200.111,VEEBYI,0)),"^",1)
"RTN","%ZVEMRLU",64,0)
 Q
"RTN","%ZVEMRLU",65,0)
 ;====================================================================
"RTN","%ZVEMRLU",66,0)
LIBRARY(RTN) ;Check if Routine is signed out
"RTN","%ZVEMRLU",67,0)
 Q:'$$CHKLBRY(1)  Q:$G(RTN)']""  Q:'$D(^VEE(19200.11,"B",RTN))
"RTN","%ZVEMRLU",68,0)
 NEW FLAGQ,IEN,VEEBYI,VEEBYN,VEEUSERI,VEEUSERN
"RTN","%ZVEMRLU",69,0)
 S FLAGQ=0
"RTN","%ZVEMRLU",70,0)
 S IEN=$O(^VEE(19200.11,"B",RTN,""))
"RTN","%ZVEMRLU",71,0)
 D GETBY(IEN) Q:VEEBYI=""
"RTN","%ZVEMRLU",72,0)
 D GETUSER(1)
"RTN","%ZVEMRLU",73,0)
 I VEEUSERI=VEEBYI Q  ;...If user signed out rtn, don't display msg
"RTN","%ZVEMRLU",74,0)
 W $C(7),@VEE("IOF"),!,"*** WARNING ***"
"RTN","%ZVEMRLU",75,0)
 W !!,"This routine is currently SIGNED OUT of the Routine Library."
"RTN","%ZVEMRLU",76,0)
 I VEEBYN]"" W !,"Signed out by: ",VEEBYN
"RTN","%ZVEMRLU",77,0)
 D PAUSE^%ZVEMKU(2,"P")
"RTN","%ZVEMRLU",78,0)
 Q
"RTN","%ZVEMRLU",79,0)
 ;
"RTN","%ZVEMRLU",80,0)
ONOFF ;Turn Rtn Lbry/Versioning ON/OFF
"RTN","%ZVEMRLU",81,0)
 ;
"RTN","%ZVEMRLU",82,0)
 I '$D(^VEE(19200.11)) D  Q  ;...No Lbry file
"RTN","%ZVEMRLU",83,0)
 . W !,"The ROUTINE LBRY files are not in this UCI.",!
"RTN","%ZVEMRLU",84,0)
 ;
"RTN","%ZVEMRLU",85,0)
 I %1="ON" D  Q
"RTN","%ZVEMRLU",86,0)
 . I %2=""!(%2["L")!(%2["l") D  ;........Turn ON Library
"RTN","%ZVEMRLU",87,0)
 .. S ^VEE(19200.11,"A-STATUS")="ON"
"RTN","%ZVEMRLU",88,0)
 .. W !,"Routine Library is now ACTIVE!",!
"RTN","%ZVEMRLU",89,0)
 . I %2=""!(%2["V")!(%2["v") D  ;........Turn ON Versioning
"RTN","%ZVEMRLU",90,0)
 .. S ^VEE(19200.112,"A-STATUS")="ON"
"RTN","%ZVEMRLU",91,0)
 .. W !,"Routine Versioning is now ACTIVE!",!
"RTN","%ZVEMRLU",92,0)
 ;
"RTN","%ZVEMRLU",93,0)
 I %1="OFF" D  Q  ;..............Turn OFF
"RTN","%ZVEMRLU",94,0)
 . S ^VEE(19200.11,"A-STATUS")="OFF"
"RTN","%ZVEMRLU",95,0)
 . S ^VEE(19200.112,"A-STATUS")="OFF"
"RTN","%ZVEMRLU",96,0)
 . W !,"Routine Library/Versioning are NO LONGER ACTIVE!",!
"RTN","%ZVEMRLU",97,0)
 Q
"RTN","%ZVEMRLU",98,0)
 ;
"RTN","%ZVEMRLU",99,0)
INIT ;Initialize. Return VEEUSERI & VEEUSERN or FLAGQ
"RTN","%ZVEMRLU",100,0)
 S U="^"
"RTN","%ZVEMRLU",101,0)
 Q:'$$CHKLBRY()
"RTN","%ZVEMRLU",102,0)
 D GETUSER() Q:FLAGQ
"RTN","%ZVEMRLU",103,0)
 I '$D(IOST) D MSG(6) Q
"RTN","%ZVEMRLU",104,0)
 S U="^" D IO^%ZVEMKY
"RTN","%ZVEMRLU",105,0)
 Q
"RTN","%ZVEMRLU",106,0)
 ;
"RTN","%ZVEMRLU",107,0)
LOCK ;Lock file
"RTN","%ZVEMRLU",108,0)
 L +^VEE(19200.11):1
"RTN","%ZVEMRLU",109,0)
 E  D MSG(7) Q
"RTN","%ZVEMRLU",110,0)
 Q
"RTN","%ZVEMRLU",111,0)
 ;
"RTN","%ZVEMRLU",112,0)
ERROR ;Error trap
"RTN","%ZVEMRLU",113,0)
 NEW ZE
"RTN","%ZVEMRLU",114,0)
 S @("ZE="_VEE("$ZE"))
"RTN","%ZVEMRLU",115,0)
 L -^VEE(19200.11)
"RTN","%ZVEMRLU",116,0)
 W !!,"An error has occurred"
"RTN","%ZVEMRLU",117,0)
 W !,"ERROR: ",ZE
"RTN","%ZVEMRLU",118,0)
 D PAUSE^%ZVEMKU(2,"P")
"RTN","%ZVEMRLU",119,0)
 Q
"RTN","%ZVEMRLU",120,0)
 ;===================================================================
"RTN","%ZVEMRLU",121,0)
MSG(NUM) ;Messages. NUM=Subrtn #
"RTN","%ZVEMRLU",122,0)
 Q:$G(NUM)'>0
"RTN","%ZVEMRLU",123,0)
 Q:$G(NOMSG)
"RTN","%ZVEMRLU",124,0)
 S FLAGQ=1
"RTN","%ZVEMRLU",125,0)
 W $C(7),!!
"RTN","%ZVEMRLU",126,0)
 D @NUM
"RTN","%ZVEMRLU",127,0)
 D PAUSE^%ZVEMKU(2,"P")
"RTN","%ZVEMRLU",128,0)
 Q
"RTN","%ZVEMRLU",129,0)
1 W "The Routine Library is currently INACTIVE. See 'Help' option." Q
"RTN","%ZVEMRLU",130,0)
2 W "The ROUTINE LBRY files are not in this UCI." Q
"RTN","%ZVEMRLU",131,0)
3 W "Your VPE ID is not defined." Q
"RTN","%ZVEMRLU",132,0)
5 W "You must be entered in VPE RTN LBRY PERSON file, with VPE ID filled in." Q
"RTN","%ZVEMRLU",133,0)
6 W "Your IO variables are not defined. D ^XUP." Q
"RTN","%ZVEMRLU",134,0)
7 W "Someone else is editing the Routine Library. Try later." Q
"RTN","%ZVEMRLU",135,0)
8 W "DUZ or DUZ(0) is not defined." Q
"RTN","%ZVEMRLU",136,0)
9 W "Routine Versioning is currently INACTIVE. See 'Help' option." Q
"RTN","%ZVEMRLU",137,0)
10 W "The ROUTINE VERSION file is not in this UCI." Q
"RTN","%ZVEMRLU",138,0)
 Q
"RTN","%ZVEMRLV")
0^114^B10522742
"RTN","%ZVEMRLV",1,0)
%ZVEMRLV ;DJB,VRR**RTN VER - Routine Editor Prompts ; 9/23/02 4:17pm
"RTN","%ZVEMRLV",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMRLV",3,0)
 ;
"RTN","%ZVEMRLV",4,0)
ADD(RTN) ;Create and store a version of the current rtn?
"RTN","%ZVEMRLV",5,0)
 ;
"RTN","%ZVEMRLV",6,0)
 NEW DEFAULT,DESC,IEN,PREV,PREVIOUS,PROMPT,VERSION
"RTN","%ZVEMRLV",7,0)
 NEW VEEUSERI,VEEUSERN
"RTN","%ZVEMRLV",8,0)
 ;
"RTN","%ZVEMRLV",9,0)
 Q:$G(RTN)']""
"RTN","%ZVEMRLV",10,0)
 Q:'$$CHKLBRY^%ZVEMRLU(1,"V")
"RTN","%ZVEMRLV",11,0)
 Q:'$D(^VEE(19200.112))  ;...Version file doesn't exist
"RTN","%ZVEMRLV",12,0)
 ;
"RTN","%ZVEMRLV",13,0)
 ;Does user want to be prompted for versioning
"RTN","%ZVEMRLV",14,0)
 S PROMPT="YES" ;...Offer prompts as the default
"RTN","%ZVEMRLV",15,0)
 D GETUSER^%ZVEMRLU(1)
"RTN","%ZVEMRLV",16,0)
 I VEEUSERI,$P($G(^VEE(19200.111,VEEUSERI,0)),"^",4)="n" S PROMPT="NO"
"RTN","%ZVEMRLV",17,0)
 I PROMPT="NO" D ADD2 Q
"RTN","%ZVEMRLV",18,0)
 ;
"RTN","%ZVEMRLV",19,0)
 W !!,"--- VERSIONING ---",!
"RTN","%ZVEMRLV",20,0)
 Q:$$ASK^%ZVEMKU("Store a version of this routine",1)'="Y"
"RTN","%ZVEMRLV",21,0)
 ;
"RTN","%ZVEMRLV",22,0)
 S DEFAULT=$$DEFAULT(RTN)
"RTN","%ZVEMRLV",23,0)
 S PREVIOUS=$$PREVIOUS(RTN)
"RTN","%ZVEMRLV",24,0)
 S PREV=$E(PREVIOUS,2,$L(PREVIOUS)-1) ;Strip beginning/ending commas.
"RTN","%ZVEMRLV",25,0)
 ;
"RTN","%ZVEMRLV",26,0)
 W !!,"Versions on file: "
"RTN","%ZVEMRLV",27,0)
 W $S(PREV:PREV,1:"None")
"RTN","%ZVEMRLV",28,0)
 ;
"RTN","%ZVEMRLV",29,0)
ADD1 W !,"VERSION: "_DEFAULT_"//"
"RTN","%ZVEMRLV",30,0)
 R VERSION:300 S:'$T VERSION="^" S:VERSION="" VERSION=DEFAULT
"RTN","%ZVEMRLV",31,0)
 I "^"[VERSION Q
"RTN","%ZVEMRLV",32,0)
 ;
"RTN","%ZVEMRLV",33,0)
 ;Allow user to type L to update last version number.
"RTN","%ZVEMRLV",34,0)
 I ",l,L,"[(","_VERSION_",") D  ;
"RTN","%ZVEMRLV",35,0)
 . S VERSION=DEFAULT-1
"RTN","%ZVEMRLV",36,0)
 . S:VERSION<1 VERSION=1
"RTN","%ZVEMRLV",37,0)
 . W "  ",VERSION
"RTN","%ZVEMRLV",38,0)
 ;
"RTN","%ZVEMRLV",39,0)
 ;Help
"RTN","%ZVEMRLV",40,0)
 I VERSION["?" D  G ADD1
"RTN","%ZVEMRLV",41,0)
 . W !,"Enter "_DEFAULT_" to create a new version."
"RTN","%ZVEMRLV",42,0)
 . W !,"Enter a previous version number to update that version."
"RTN","%ZVEMRLV",43,0)
 . W !,"Enter L as a shortcut to update the last previous version.",!
"RTN","%ZVEMRLV",44,0)
 ;
"RTN","%ZVEMRLV",45,0)
 ;Default entry
"RTN","%ZVEMRLV",46,0)
 I VERSION'=DEFAULT,PREVIOUS'[(","_VERSION_",") D  G ADD1
"RTN","%ZVEMRLV",47,0)
 . W "   Invalid entry"
"RTN","%ZVEMRLV",48,0)
 ;
"RTN","%ZVEMRLV",49,0)
 S DESC="" ;Initialize Description field value
"RTN","%ZVEMRLV",50,0)
 I VERSION=DEFAULT S IEN=$$CREATE(RTN,VERSION) I 1
"RTN","%ZVEMRLV",51,0)
 E  D  ;
"RTN","%ZVEMRLV",52,0)
 . S IEN=$O(^VEE(19200.112,"AKEY",RTN,VERSION,""))
"RTN","%ZVEMRLV",53,0)
 . I IEN S DESC=$P($G(^VEE(19200.112,IEN,0)),"^",3)
"RTN","%ZVEMRLV",54,0)
 Q:'IEN
"RTN","%ZVEMRLV",55,0)
 ;
"RTN","%ZVEMRLV",56,0)
 ;Update Description, Date & Text fields
"RTN","%ZVEMRLV",57,0)
 D UPDATE(IEN,DESC,0)
"RTN","%ZVEMRLV",58,0)
 W !!,"Version filed.",!
"RTN","%ZVEMRLV",59,0)
 Q
"RTN","%ZVEMRLV",60,0)
 ;
"RTN","%ZVEMRLV",61,0)
ADD2 ;Create version with no prompting
"RTN","%ZVEMRLV",62,0)
 NEW DEFAULT,DESC,IEN,VERSION
"RTN","%ZVEMRLV",63,0)
 ;
"RTN","%ZVEMRLV",64,0)
 S VERSION=$$DEFAULT(RTN)
"RTN","%ZVEMRLV",65,0)
 S IEN=$$CREATE(RTN,VERSION) ;...Create new entry
"RTN","%ZVEMRLV",66,0)
 S DESC="" ;...Initialize Description field value
"RTN","%ZVEMRLV",67,0)
 D UPDATE(IEN,DESC,1) ;...Update Description, Date & Text fields
"RTN","%ZVEMRLV",68,0)
 W !!,"Version filed.",!
"RTN","%ZVEMRLV",69,0)
 Q
"RTN","%ZVEMRLV",70,0)
 ;
"RTN","%ZVEMRLV",71,0)
PREVIOUS(RTN) ;Get list of previous versions for this routine.
"RTN","%ZVEMRLV",72,0)
 ;RTN=Name of routine
"RTN","%ZVEMRLV",73,0)
 ;Return string of versions. Example: ",1,2,"
"RTN","%ZVEMRLV",74,0)
 NEW LINE,VER
"RTN","%ZVEMRLV",75,0)
 S LINE=""
"RTN","%ZVEMRLV",76,0)
 S VER=0
"RTN","%ZVEMRLV",77,0)
 F  S VER=$O(^VEE(19200.112,"AKEY",RTN,VER)) Q:'VER  D  ;
"RTN","%ZVEMRLV",78,0)
 . S LINE=LINE_VER_","
"RTN","%ZVEMRLV",79,0)
 S:LINE]"" LINE=","_LINE
"RTN","%ZVEMRLV",80,0)
 Q LINE
"RTN","%ZVEMRLV",81,0)
 ;
"RTN","%ZVEMRLV",82,0)
DEFAULT(RTN) ;Get appropriate new version number for this routine.
"RTN","%ZVEMRLV",83,0)
 ;RTN=Name of routine
"RTN","%ZVEMRLV",84,0)
 Q 1+($O(^VEE(19200.112,"AKEY",RTN,""),-1))
"RTN","%ZVEMRLV",85,0)
 ;
"RTN","%ZVEMRLV",86,0)
CREATE(RTN,VER) ;Create a new version
"RTN","%ZVEMRLV",87,0)
 ;RTN=Routine name
"RTN","%ZVEMRLV",88,0)
 ;VER=Version number
"RTN","%ZVEMRLV",89,0)
 ;Return IEN or zero if no entry created.
"RTN","%ZVEMRLV",90,0)
 ;
"RTN","%ZVEMRLV",91,0)
 NEW D,DD,FDA,IEN,MSG
"RTN","%ZVEMRLV",92,0)
 S DD=19200.112
"RTN","%ZVEMRLV",93,0)
 S FDA(DD,"+1,",.01)=RTN
"RTN","%ZVEMRLV",94,0)
 S FDA(DD,"+1,",2)=VER
"RTN","%ZVEMRLV",95,0)
 D UPDATE^DIE("E","FDA","IEN","MSG")
"RTN","%ZVEMRLV",96,0)
 I $D(DIERR) Q 0
"RTN","%ZVEMRLV",97,0)
 Q IEN(1)
"RTN","%ZVEMRLV",98,0)
 ;
"RTN","%ZVEMRLV",99,0)
UPDATE(IEN,DESC,BYPASS) ;Update an existing version
"RTN","%ZVEMRLV",100,0)
 ;IEN : IEN to file 19200.112
"RTN","%ZVEMRLV",101,0)
 ;DESC: Description text
"RTN","%ZVEMRLV",102,0)
 ;BYPASS: 1=Don't edit Description field
"RTN","%ZVEMRLV",103,0)
 ;
"RTN","%ZVEMRLV",104,0)
 NEW D,D0,DA,DI,DIC,DIE,DQ,DR
"RTN","%ZVEMRLV",105,0)
 ;
"RTN","%ZVEMRLV",106,0)
 ;Edit Description field
"RTN","%ZVEMRLV",107,0)
 S DIE=19200.112
"RTN","%ZVEMRLV",108,0)
 S DA=IEN
"RTN","%ZVEMRLV",109,0)
 S DR="4///NOW"
"RTN","%ZVEMRLV",110,0)
 I $G(BYPASS)'=1 S DR=DR_";3"
"RTN","%ZVEMRLV",111,0)
 D ^DIE
"RTN","%ZVEMRLV",112,0)
 ;
"RTN","%ZVEMRLV",113,0)
 ;Stuff Routine text
"RTN","%ZVEMRLV",114,0)
 D WP^DIE(19200.112,IEN_",",20,"","^UTILITY("_$J_",0)")
"RTN","%ZVEMRLV",115,0)
 Q
"RTN","%ZVEMRLX")
0^115^B4096384
"RTN","%ZVEMRLX",1,0)
%ZVEMRLX ;DJB,VRR**RTN VER - Xref ; 11/20/00 9:52pm
"RTN","%ZVEMRLX",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMRLX",3,0)
 ;
"RTN","%ZVEMRLX",4,0)
 ;=======================[ INPUT TRANSFORM 1]=========================
"RTN","%ZVEMRLX",5,0)
KEY1 ;ROUTINE Field
"RTN","%ZVEMRLX",6,0)
 NEW KEY1,KEY2
"RTN","%ZVEMRLX",7,0)
 I X'?.1"%"1A.7AN KILL X Q  ;Check format of input
"RTN","%ZVEMRLX",8,0)
 Q:'$G(DA)
"RTN","%ZVEMRLX",9,0)
 S KEY1=X
"RTN","%ZVEMRLX",10,0)
 S KEY2=$P($G(^VEE(19200.112,DA,0)),U,2)
"RTN","%ZVEMRLX",11,0)
 D CHECK
"RTN","%ZVEMRLX",12,0)
 Q
"RTN","%ZVEMRLX",13,0)
 ;
"RTN","%ZVEMRLX",14,0)
KEY2 ;VERSION Field
"RTN","%ZVEMRLX",15,0)
 NEW KEY1,KEY2
"RTN","%ZVEMRLX",16,0)
 I X<1!(X>99999)!(X?1.N1"."1.E) KILL X Q  ;Check format of input
"RTN","%ZVEMRLX",17,0)
 Q:'$G(DA)
"RTN","%ZVEMRLX",18,0)
 S KEY1=$P($G(^VEE(19200.112,DA,0)),U,1)
"RTN","%ZVEMRLX",19,0)
 S KEY2=X
"RTN","%ZVEMRLX",20,0)
 D CHECK
"RTN","%ZVEMRLX",21,0)
 Q
"RTN","%ZVEMRLX",22,0)
 ;
"RTN","%ZVEMRLX",23,0)
CHECK ;Check for duplicate entry
"RTN","%ZVEMRLX",24,0)
 Q:KEY1']""!(KEY2']"")
"RTN","%ZVEMRLX",25,0)
 Q:'$D(^VEE(19200.112,"AKEY",KEY1,KEY2))
"RTN","%ZVEMRLX",26,0)
 ;
"RTN","%ZVEMRLX",27,0)
 NEW ENTRY
"RTN","%ZVEMRLX",28,0)
 S ENTRY=$O(^VEE(19200.112,"AKEY",KEY1,KEY2,""))
"RTN","%ZVEMRLX",29,0)
 Q:ENTRY']""
"RTN","%ZVEMRLX",30,0)
 Q:ENTRY=DA
"RTN","%ZVEMRLX",31,0)
 Q:'$D(^VEE(19200.112,ENTRY,0))
"RTN","%ZVEMRLX",32,0)
 KILL X
"RTN","%ZVEMRLX",33,0)
 Q
"RTN","%ZVEMRLX",34,0)
 ;========================[ SET "AKEY" XREF ]========================
"RTN","%ZVEMRLX",35,0)
SET1 ;ROUTINE Field
"RTN","%ZVEMRLX",36,0)
 NEW KEY1,KEY2
"RTN","%ZVEMRLX",37,0)
 Q:'$D(^VEE(19200.112,DA,0))
"RTN","%ZVEMRLX",38,0)
 S KEY1=X,KEY2=$P($G(^(0)),U,2)
"RTN","%ZVEMRLX",39,0)
 D XREFSET
"RTN","%ZVEMRLX",40,0)
 Q
"RTN","%ZVEMRLX",41,0)
 ;
"RTN","%ZVEMRLX",42,0)
SET2 ;VERSION Field
"RTN","%ZVEMRLX",43,0)
 NEW KEY1,KEY2
"RTN","%ZVEMRLX",44,0)
 Q:'$D(^VEE(19200.112,DA,0))
"RTN","%ZVEMRLX",45,0)
 S KEY1=$P($G(^(0)),U,1),KEY2=X
"RTN","%ZVEMRLX",46,0)
 D XREFSET
"RTN","%ZVEMRLX",47,0)
 Q
"RTN","%ZVEMRLX",48,0)
 ;
"RTN","%ZVEMRLX",49,0)
XREFSET ;Set xref on "Key" fields
"RTN","%ZVEMRLX",50,0)
 Q:KEY1']""!(KEY2']"")
"RTN","%ZVEMRLX",51,0)
 S ^VEE(19200.112,"AKEY",KEY1,KEY2,DA)=""
"RTN","%ZVEMRLX",52,0)
 Q
"RTN","%ZVEMRLX",53,0)
 ;========================[KILL "AKEY" XREF]=========================
"RTN","%ZVEMRLX",54,0)
KILL1 ;ROUTINE Field
"RTN","%ZVEMRLX",55,0)
 NEW KEY1,KEY2
"RTN","%ZVEMRLX",56,0)
 Q:'$D(^VEE(19200.112,DA,0))
"RTN","%ZVEMRLX",57,0)
 S KEY1=X,KEY2=$P($G(^(0)),U,2)
"RTN","%ZVEMRLX",58,0)
 D XREFKILL
"RTN","%ZVEMRLX",59,0)
 Q
"RTN","%ZVEMRLX",60,0)
 ;
"RTN","%ZVEMRLX",61,0)
KILL2 ;VERSION Field
"RTN","%ZVEMRLX",62,0)
 NEW KEY1,KEY2
"RTN","%ZVEMRLX",63,0)
 Q:'$D(^VEE(19200.112,DA,0))
"RTN","%ZVEMRLX",64,0)
 S KEY1=$P($G(^(0)),U,1),KEY2=X
"RTN","%ZVEMRLX",65,0)
 D XREFKILL
"RTN","%ZVEMRLX",66,0)
 Q
"RTN","%ZVEMRLX",67,0)
 ;
"RTN","%ZVEMRLX",68,0)
XREFKILL ;Kill "AKEY" xref
"RTN","%ZVEMRLX",69,0)
 Q:KEY1']""!(KEY2']"")
"RTN","%ZVEMRLX",70,0)
 KILL ^VEE(19200.112,"AKEY",KEY1,KEY2,DA)
"RTN","%ZVEMRLX",71,0)
 Q
"RTN","%ZVEMRLX",72,0)
 ;========================[KILL "UNIQ" XREF]=========================
"RTN","%ZVEMRLX",73,0)
KILLUNIQ ;Maintain xref of uniques. If an entry is deleted, reset xref to
"RTN","%ZVEMRLX",74,0)
 ;another entry.
"RTN","%ZVEMRLX",75,0)
 ;
"RTN","%ZVEMRLX",76,0)
 NEW IEN
"RTN","%ZVEMRLX",77,0)
 Q:'$D(^VEE(19200.112,"UNIQ",X,DA))
"RTN","%ZVEMRLX",78,0)
 KILL ^VEE(19200.112,"UNIQ",X)
"RTN","%ZVEMRLX",79,0)
 Q:'$D(^VEE(19200.112,"B",X))
"RTN","%ZVEMRLX",80,0)
 S IEN=$O(^VEE(19200.112,"B",X,""))
"RTN","%ZVEMRLX",81,0)
 Q:'IEN
"RTN","%ZVEMRLX",82,0)
 S ^VEE(19200.112,"UNIQ",X,IEN)=""
"RTN","%ZVEMRLX",83,0)
 Q
"RTN","%ZVEMRLY")
0^116^B29479846
"RTN","%ZVEMRLY",1,0)
%ZVEMRLY ;DJB,VRR**RTN VER - ..LBRY Options ; 9/24/02 7:18am
"RTN","%ZVEMRLY",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMRLY",3,0)
 ;
"RTN","%ZVEMRLY",4,0)
INQ ;Inquire
"RTN","%ZVEMRLY",5,0)
 NEW DATA,FLAGQ,I,LINE,LINE1,IEN,POP,RTN,VER
"RTN","%ZVEMRLY",6,0)
 ;
"RTN","%ZVEMRLY",7,0)
 Q:'$D(^VEE(19200.112))  ;...Version file doesn't exist
"RTN","%ZVEMRLY",8,0)
 W !,"*** INQUIRE VERSION HISTORY ***",!
"RTN","%ZVEMRLY",9,0)
 S RTN=$$GETRTN() Q:RTN']""
"RTN","%ZVEMRLY",10,0)
 ;
"RTN","%ZVEMRLY",11,0)
 W ! D ^%ZIS G:POP INQEX U IO ;Allow use of a printer
"RTN","%ZVEMRLY",12,0)
 D INQINIT,INQHD,INQHD1
"RTN","%ZVEMRLY",13,0)
 ;
"RTN","%ZVEMRLY",14,0)
 ;Display all versions
"RTN","%ZVEMRLY",15,0)
 S VER=0
"RTN","%ZVEMRLY",16,0)
 F  S VER=$O(^VEE(19200.112,"AKEY",RTN,VER)) Q:'VER  D  Q:FLAGQ
"RTN","%ZVEMRLY",17,0)
 . S IEN=$O(^VEE(19200.112,"AKEY",RTN,VER,"")) Q:'IEN
"RTN","%ZVEMRLY",18,0)
 . S DATA=$G(^VEE(19200.112,IEN,0))
"RTN","%ZVEMRLY",19,0)
 . W !,VER ;...............................Version
"RTN","%ZVEMRLY",20,0)
 . W ?9,$$FMTE^XLFDT($P(DATA,"^",4),"2D") ;Date
"RTN","%ZVEMRLY",21,0)
 . W ?19,$P(DATA,"^",3) ;..................Description
"RTN","%ZVEMRLY",22,0)
 . Q:'$O(^VEE(19200.112,"AKEY",RTN,VER))  ;Don't display PAUSE here.
"RTN","%ZVEMRLY",23,0)
 . I $Y>(IOSL-5) D INQPG Q:FLAGQ
"RTN","%ZVEMRLY",24,0)
 ;
"RTN","%ZVEMRLY",25,0)
 ;Pause the screen
"RTN","%ZVEMRLY",26,0)
 I FLAGQ!($E(IOST,1,2)="P-") G INQEX
"RTN","%ZVEMRLY",27,0)
 F I=$Y:1:(IOSL-5) W !
"RTN","%ZVEMRLY",28,0)
 D PAUSE^%ZVEMKU(2)
"RTN","%ZVEMRLY",29,0)
INQEX ;Exit
"RTN","%ZVEMRLY",30,0)
 D ^%ZISC
"RTN","%ZVEMRLY",31,0)
 Q
"RTN","%ZVEMRLY",32,0)
 ;
"RTN","%ZVEMRLY",33,0)
INQINIT ;Initialize variables
"RTN","%ZVEMRLY",34,0)
 S FLAGQ=0
"RTN","%ZVEMRLY",35,0)
 S $P(LINE,"=",220)=""
"RTN","%ZVEMRLY",36,0)
 S $P(LINE1,"-",220)=""
"RTN","%ZVEMRLY",37,0)
 Q
"RTN","%ZVEMRLY",38,0)
 ;
"RTN","%ZVEMRLY",39,0)
INQPG ;Page
"RTN","%ZVEMRLY",40,0)
 I $E(IOST,1,2)="P-" W @IOF Q
"RTN","%ZVEMRLY",41,0)
 D PAUSE^%ZVEMKU(1,"Q") Q:FLAGQ
"RTN","%ZVEMRLY",42,0)
 W @IOF D INQHD1
"RTN","%ZVEMRLY",43,0)
 Q
"RTN","%ZVEMRLY",44,0)
 ;
"RTN","%ZVEMRLY",45,0)
INQHD ;Heading
"RTN","%ZVEMRLY",46,0)
 NEW HD
"RTN","%ZVEMRLY",47,0)
 I $E(IOST,1,2)="C-" W @IOF
"RTN","%ZVEMRLY",48,0)
 E  W !!!
"RTN","%ZVEMRLY",49,0)
 S HD="VERSION HISTORY"
"RTN","%ZVEMRLY",50,0)
 W !?(IOM-$L(HD)\2),HD
"RTN","%ZVEMRLY",51,0)
 S HD="Routine: "_RTN
"RTN","%ZVEMRLY",52,0)
 W !,HD,?61 D ^%D,^%T
"RTN","%ZVEMRLY",53,0)
 W !,$E(LINE,1,IOM),!
"RTN","%ZVEMRLY",54,0)
 Q
"RTN","%ZVEMRLY",55,0)
INQHD1 ;
"RTN","%ZVEMRLY",56,0)
 W !,"VERSION",?9,"DATE",?19,"DESCRIPTION"
"RTN","%ZVEMRLY",57,0)
 W !,$E(LINE1,1,7),?9,$E(LINE1,1,8),?19,$E(LINE1,1,60)
"RTN","%ZVEMRLY",58,0)
 Q
"RTN","%ZVEMRLY",59,0)
 ;==================================================================
"RTN","%ZVEMRLY",60,0)
DESC ;Update DESCRIPTION field.
"RTN","%ZVEMRLY",61,0)
 NEW D,D0,DA,DI,DIC,DIE,DQ,DR
"RTN","%ZVEMRLY",62,0)
 NEW IEN,RTN,VER
"RTN","%ZVEMRLY",63,0)
 ;
"RTN","%ZVEMRLY",64,0)
 Q:'$D(^VEE(19200.112))  ;...Version file doesn't exist
"RTN","%ZVEMRLY",65,0)
 ;
"RTN","%ZVEMRLY",66,0)
 F  W @IOF,!,"*** UPDATE DESCRIPTION FIELD ***",! S RTN=$$GETRTN() Q:RTN']""  D  ;
"RTN","%ZVEMRLY",67,0)
 . F  W ! S VER=$$GETVER(RTN) Q:'VER  D  ;
"RTN","%ZVEMRLY",68,0)
 .. S IEN=$$GETIEN(RTN,VER) Q:'IEN
"RTN","%ZVEMRLY",69,0)
 .. ;
"RTN","%ZVEMRLY",70,0)
 .. ;Edit Description field
"RTN","%ZVEMRLY",71,0)
 .. S DIE=19200.112
"RTN","%ZVEMRLY",72,0)
 .. S DA=IEN
"RTN","%ZVEMRLY",73,0)
 .. S DR=3
"RTN","%ZVEMRLY",74,0)
 .. D ^DIE
"RTN","%ZVEMRLY",75,0)
 Q
"RTN","%ZVEMRLY",76,0)
 ;==================================================================
"RTN","%ZVEMRLY",77,0)
REVIEW ;Review a routine from the Version file (19200.112).
"RTN","%ZVEMRLY",78,0)
 NEW IEN,RTN,VER
"RTN","%ZVEMRLY",79,0)
 ;
"RTN","%ZVEMRLY",80,0)
 Q:'$D(^VEE(19200.112))  ;...Version file doesn't exist
"RTN","%ZVEMRLY",81,0)
 ;
"RTN","%ZVEMRLY",82,0)
 F  W @IOF,!,"*** REVIEW A VERSION ***",! S RTN=$$GETRTN() Q:RTN']""  D  ;
"RTN","%ZVEMRLY",83,0)
 . F  S VER=$$GETVER(RTN) Q:'VER  D  ;
"RTN","%ZVEMRLY",84,0)
 .. S IEN=$$GETIEN(RTN,VER) Q:'IEN
"RTN","%ZVEMRLY",85,0)
 .. D REVIEW1 ;Use Rtn Editor to display selected entry
"RTN","%ZVEMRLY",86,0)
 .. ;D VERSION^%ZVEMKT(IEN) ;Use Lister to display selected entry
"RTN","%ZVEMRLY",87,0)
 Q
"RTN","%ZVEMRLY",88,0)
 ;
"RTN","%ZVEMRLY",89,0)
REVIEW1 ;Call Rtn Editor to display rtn from the version file.
"RTN","%ZVEMRLY",90,0)
 NEW %1,FLAGPRM,FLAGVPE
"RTN","%ZVEMRLY",91,0)
 S FLAGPRM=1
"RTN","%ZVEMRLY",92,0)
 S $P(FLAGVPE,"^",4)="LBRY"
"RTN","%ZVEMRLY",93,0)
 S %1=$P($G(^VEE(19200.112,IEN,0)),U,1) ;Routine name
"RTN","%ZVEMRLY",94,0)
 Q:%1']""
"RTN","%ZVEMRLY",95,0)
 S ^TMP("VEE","LBRY",$J)=IEN ;Store IEN so REVIEW2 can use it
"RTN","%ZVEMRLY",96,0)
 D PARAM^%ZVEMR(RTN) ;Call Editor
"RTN","%ZVEMRLY",97,0)
 Q
"RTN","%ZVEMRLY",98,0)
 ;
"RTN","%ZVEMRLY",99,0)
REVIEW2 ;
"RTN","%ZVEMRLY",100,0)
 NEW I,IEN,TXT
"RTN","%ZVEMRLY",101,0)
 S IEN=$G(^TMP("VEE","LBRY",$J))
"RTN","%ZVEMRLY",102,0)
 Q:'$G(IEN)
"RTN","%ZVEMRLY",103,0)
 Q:'$D(^VEE(19200.112,IEN,"WP"))
"RTN","%ZVEMRLY",104,0)
 KILL ^TMP("VEE","VRR",$J,VRRS)
"RTN","%ZVEMRLY",105,0)
 KILL ^TMP("VEE","IR"_VRRS,$J)
"RTN","%ZVEMRLY",106,0)
 S ^TMP("VEE","VRR",$J,1,"NAME")=RTN
"RTN","%ZVEMRLY",107,0)
 X "F I=1:1 S TXT=$G(^VEE(19200.112,IEN,""WP"",I,0)) Q:TXT=""""  S TXT=$P(TXT,"" "")_$C(9)_$P(TXT,"" "",2,999),^TMP(""VEE"",$J,I)=TXT"
"RTN","%ZVEMRLY",108,0)
 D SET^%ZVEMRS1
"RTN","%ZVEMRLY",109,0)
 KILL ^TMP("VEE",$J)
"RTN","%ZVEMRLY",110,0)
 KILL ^TMP("VEE","LBRY",$J)
"RTN","%ZVEMRLY",111,0)
 Q
"RTN","%ZVEMRLY",112,0)
 ;==================================================================
"RTN","%ZVEMRLY",113,0)
RESTORE ;Restore a routine from the Version file (19200.112).
"RTN","%ZVEMRLY",114,0)
 NEW CD,CNT,FLAGQ,I,IEN,RTN,VEES,VER,VRRPGM,X
"RTN","%ZVEMRLY",115,0)
 ;
"RTN","%ZVEMRLY",116,0)
 Q:'$D(^VEE(19200.112))  ;...Version file doesn't exist
"RTN","%ZVEMRLY",117,0)
 S X="ERROR^%ZVEMRLY",@($$TRAP^%ZVEMKU1) KILL X
"RTN","%ZVEMRLY",118,0)
 ;
"RTN","%ZVEMRLY",119,0)
 W !,"*** RESTORE A VERSION ***",!
"RTN","%ZVEMRLY",120,0)
 S RTN=$$GETRTN() Q:RTN']""
"RTN","%ZVEMRLY",121,0)
 ;
"RTN","%ZVEMRLY",122,0)
 ;Quit if routine is currently being edited.
"RTN","%ZVEMRLY",123,0)
 L +VRRLOCK(RTN):0 E  D  Q
"RTN","%ZVEMRLY",124,0)
 . W $C(7),!!,"This program is currently being edited. Try later.",!
"RTN","%ZVEMRLY",125,0)
 . D PAUSE^%ZVEMKU(2,"P")
"RTN","%ZVEMRLY",126,0)
 ;
"RTN","%ZVEMRLY",127,0)
 S VER=$$GETVER(RTN) Q:'VER
"RTN","%ZVEMRLY",128,0)
 S IEN=$$GETIEN(RTN,VER) Q:'IEN
"RTN","%ZVEMRLY",129,0)
 ;
"RTN","%ZVEMRLY",130,0)
 W ! Q:$$ASK^%ZVEMKU("Do you want to restore this version now")'="Y"
"RTN","%ZVEMRLY",131,0)
 ;
"RTN","%ZVEMRLY",132,0)
 ;Put word processing field into ^UTILITY($J) global.
"RTN","%ZVEMRLY",133,0)
 KILL ^UTILITY($J)
"RTN","%ZVEMRLY",134,0)
 S CNT=1
"RTN","%ZVEMRLY",135,0)
 F I=1:1 S CD=$G(^VEE(19200.112,IEN,"WP",I,0)) Q:CD=""  D  ;
"RTN","%ZVEMRLY",136,0)
 . S ^UTILITY($J,0,CNT)=CD
"RTN","%ZVEMRLY",137,0)
 . S CNT=CNT+1
"RTN","%ZVEMRLY",138,0)
 ;
"RTN","%ZVEMRLY",139,0)
 ;Save routine
"RTN","%ZVEMRLY",140,0)
 S FLAGQ=0 D ZSAVE^%ZVEMKY3 Q:FLAGQ
"RTN","%ZVEMRLY",141,0)
 S VRRPGM=RTN X ^%ZVEMS("E",2)
"RTN","%ZVEMRLY",142,0)
 ;
"RTN","%ZVEMRLY",143,0)
 W !!,"Version "_VER_" restored."
"RTN","%ZVEMRLY",144,0)
 L -VRRLOCK(RTN) ;Unlock routine editing
"RTN","%ZVEMRLY",145,0)
 D PAUSE^%ZVEMKU(2)
"RTN","%ZVEMRLY",146,0)
 KILL ^UTILITY($J)
"RTN","%ZVEMRLY",147,0)
 Q
"RTN","%ZVEMRLY",148,0)
 ;
"RTN","%ZVEMRLY",149,0)
 ;==================================================================
"RTN","%ZVEMRLY",150,0)
GETRTN() ;Select a routine from the Version file (19200.112)
"RTN","%ZVEMRLY",151,0)
 ;Return: Routine name
"RTN","%ZVEMRLY",152,0)
 NEW %,%Y,D,DIC,RTN,X,Y
"RTN","%ZVEMRLY",153,0)
 S DIC=19200.112
"RTN","%ZVEMRLY",154,0)
 S DIC(0)="QEAS"
"RTN","%ZVEMRLY",155,0)
 S DIC("A")="Select ROUTINE: "
"RTN","%ZVEMRLY",156,0)
 S D="UNIQ"
"RTN","%ZVEMRLY",157,0)
 D IX^DIC I Y<0 Q ""
"RTN","%ZVEMRLY",158,0)
 S RTN=$P(Y,"^",2)
"RTN","%ZVEMRLY",159,0)
 Q RTN
"RTN","%ZVEMRLY",160,0)
 ;
"RTN","%ZVEMRLY",161,0)
GETVER(RTN) ;Select a version of a routine
"RTN","%ZVEMRLY",162,0)
 ;Return: Version number
"RTN","%ZVEMRLY",163,0)
 NEW PREV,VER
"RTN","%ZVEMRLY",164,0)
 Q:$G(RTN)']""
"RTN","%ZVEMRLY",165,0)
 S PREV=$$PREVIOUS^%ZVEMRLV(RTN)
"RTN","%ZVEMRLY",166,0)
 W !!,"Versions on file: "
"RTN","%ZVEMRLY",167,0)
 W $E(PREV,2,$L(PREV)-1) ;Strip beginning/ending commas.
"RTN","%ZVEMRLY",168,0)
GETVER1 W !,"Select VERSION: "
"RTN","%ZVEMRLY",169,0)
 R VER:300 S:'$T VER="^" I "^"[VER Q 0
"RTN","%ZVEMRLY",170,0)
 I PREV'[(","_VER_",") W "   Invalid selection." G GETVER1
"RTN","%ZVEMRLY",171,0)
 Q VER
"RTN","%ZVEMRLY",172,0)
 ;
"RTN","%ZVEMRLY",173,0)
GETIEN(RTN,VER) ;Get IEN from Version file (19200.112).
"RTN","%ZVEMRLY",174,0)
 ;RTN=Routine name
"RTN","%ZVEMRLY",175,0)
 ;VER=Version number
"RTN","%ZVEMRLY",176,0)
 ;
"RTN","%ZVEMRLY",177,0)
 NEW IEN
"RTN","%ZVEMRLY",178,0)
 Q:$G(RTN)']""
"RTN","%ZVEMRLY",179,0)
 Q:'$G(VER)
"RTN","%ZVEMRLY",180,0)
 S IEN=$O(^VEE(19200.112,"AKEY",RTN,VER,""))
"RTN","%ZVEMRLY",181,0)
 Q +IEN
"RTN","%ZVEMRLY",182,0)
 ;
"RTN","%ZVEMRLY",183,0)
ERROR ;Error trap
"RTN","%ZVEMRLY",184,0)
 NEW ZE
"RTN","%ZVEMRLY",185,0)
 S @("ZE="_VEE("$ZE"))
"RTN","%ZVEMRLY",186,0)
 L -VRRLOCK(RTN) ;Unlock routine editing
"RTN","%ZVEMRLY",187,0)
 W !!,"An error has occurred"
"RTN","%ZVEMRLY",188,0)
 W !,"ERROR: ",ZE
"RTN","%ZVEMRLY",189,0)
 D PAUSE^%ZVEMKU(2,"P")
"RTN","%ZVEMRLY",190,0)
 Q
"RTN","%ZVEMRLZ")
0^117^B39253979
"RTN","%ZVEMRLZ",1,0)
%ZVEMRLZ ;DJB,VRR**RTN VER - ..LBRY Options ; 9/6/02 8:17am
"RTN","%ZVEMRLZ",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMRLZ",3,0)
 ;
"RTN","%ZVEMRLZ",4,0)
DELETE ;Delete versions
"RTN","%ZVEMRLZ",5,0)
 NEW CNT,DA,DESC,DIC,DIK,IEN,ND,RENUM,RTN,TMP,VER
"RTN","%ZVEMRLZ",6,0)
 ;
"RTN","%ZVEMRLZ",7,0)
 Q:'$D(^VEE(19200.112))  ;...Version file doesn't exist
"RTN","%ZVEMRLZ",8,0)
 S X="ERROR^%ZVEMRLZ",@($$TRAP^%ZVEMKU1) KILL X
"RTN","%ZVEMRLZ",9,0)
 ;
"RTN","%ZVEMRLZ",10,0)
 W !,"*** DELETE VERSION(S) ***",!
"RTN","%ZVEMRLZ",11,0)
 S RTN=$$GETRTN^%ZVEMRLY() Q:RTN']""
"RTN","%ZVEMRLZ",12,0)
 ;
"RTN","%ZVEMRLZ",13,0)
 ;Quit if routine is currently being edited.
"RTN","%ZVEMRLZ",14,0)
 L +VRRLOCK(RTN):0 E  D  Q
"RTN","%ZVEMRLZ",15,0)
 . W $C(7),!!,"This program is currently being edited. Try later.",!
"RTN","%ZVEMRLZ",16,0)
 . D PAUSE^%ZVEMKU(2,"P")
"RTN","%ZVEMRLZ",17,0)
 ;
"RTN","%ZVEMRLZ",18,0)
 KILL ^TMP("VPE",$J)
"RTN","%ZVEMRLZ",19,0)
 S CNT=1,VER=0
"RTN","%ZVEMRLZ",20,0)
 F  S VER=$O(^VEE(19200.112,"AKEY",RTN,VER)) Q:'VER  D  ;
"RTN","%ZVEMRLZ",21,0)
 . S IEN=$O(^(VER,"")) Q:'IEN  ;
"RTN","%ZVEMRLZ",22,0)
 . S ND=$G(^VEE(19200.112,IEN,0))
"RTN","%ZVEMRLZ",23,0)
 . S DESC=$P(ND,"^",3) S:DESC="" DESC="No description"
"RTN","%ZVEMRLZ",24,0)
 . S TMP="Version: "_VER
"RTN","%ZVEMRLZ",25,0)
 . S TMP=TMP_$J("",15-$L(TMP))_"|"_DESC
"RTN","%ZVEMRLZ",26,0)
 . S ^TMP("VPE",$J,CNT)=IEN_$C(9)_TMP
"RTN","%ZVEMRLZ",27,0)
 . S CNT=CNT+1
"RTN","%ZVEMRLZ",28,0)
 ;
"RTN","%ZVEMRLZ",29,0)
 G:'$D(^TMP("VPE",$J)) DELEX ;.............No versions on file
"RTN","%ZVEMRLZ",30,0)
 S ^TMP("VPE",$J,"HD")="^"_RTN_" routine "
"RTN","%ZVEMRLZ",31,0)
 D SELECT^%ZVEMKT("^TMP(""VPE"","_$J_")") ;Call SELECTOR
"RTN","%ZVEMRLZ",32,0)
 G:'$D(^TMP("VPE","SELECT",$J)) DELEX  ;...Nothing selected
"RTN","%ZVEMRLZ",33,0)
 ;
"RTN","%ZVEMRLZ",34,0)
 S RENUM=$$ASK^%ZVEMKU("Renumber any remaining versions, starting with 1",1)
"RTN","%ZVEMRLZ",35,0)
 W !
"RTN","%ZVEMRLZ",36,0)
 G:$$ASK^%ZVEMKU("Ok to delete now",1)'="Y" DELEX
"RTN","%ZVEMRLZ",37,0)
 ;
"RTN","%ZVEMRLZ",38,0)
 S CNT=0
"RTN","%ZVEMRLZ",39,0)
 F  S CNT=$O(^TMP("VPE","SELECT",$J,CNT)) Q:'CNT  D  ;
"RTN","%ZVEMRLZ",40,0)
 . S ND=$G(^TMP("VPE","SELECT",$J,CNT))
"RTN","%ZVEMRLZ",41,0)
 . S DA=$P(ND,$C(9),1) Q:'DA
"RTN","%ZVEMRLZ",42,0)
 . S DIK="^VEE(19200.112,"
"RTN","%ZVEMRLZ",43,0)
 . D ^DIK
"RTN","%ZVEMRLZ",44,0)
 ;
"RTN","%ZVEMRLZ",45,0)
 I RENUM="Y" D DELRENUM(RTN) ;Renumber remaining version
"RTN","%ZVEMRLZ",46,0)
 ;
"RTN","%ZVEMRLZ",47,0)
 W !!,"Deletion complete."
"RTN","%ZVEMRLZ",48,0)
 D PAUSE^%ZVEMKU(2)
"RTN","%ZVEMRLZ",49,0)
DELEX ;
"RTN","%ZVEMRLZ",50,0)
 L -VRRLOCK(RTN) ;Unlock routine editing
"RTN","%ZVEMRLZ",51,0)
 KILL ^TMP("VPE",$J)
"RTN","%ZVEMRLZ",52,0)
 KILL ^TMP("VPE","SELECT",$J)
"RTN","%ZVEMRLZ",53,0)
 Q
"RTN","%ZVEMRLZ",54,0)
 ;
"RTN","%ZVEMRLZ",55,0)
DELRENUM(RTN) ;Renumber remaining versions.
"RTN","%ZVEMRLZ",56,0)
 ;RTN=Routine name
"RTN","%ZVEMRLZ",57,0)
 Q:$G(RTN)']""
"RTN","%ZVEMRLZ",58,0)
 Q:'$D(^VEE(19200.112,"AKEY",RTN))
"RTN","%ZVEMRLZ",59,0)
 ;
"RTN","%ZVEMRLZ",60,0)
 NEW CNT,FDA,IEN,MSG,VER
"RTN","%ZVEMRLZ",61,0)
 ;
"RTN","%ZVEMRLZ",62,0)
 S VER=0,CNT=1
"RTN","%ZVEMRLZ",63,0)
 F  S VER=$O(^VEE(19200.112,"AKEY",RTN,VER)) Q:'VER  D  ;
"RTN","%ZVEMRLZ",64,0)
 . I VER=CNT S CNT=CNT+1 Q
"RTN","%ZVEMRLZ",65,0)
 . S IEN=$O(^VEE(19200.112,"AKEY",RTN,VER,0)) Q:'IEN
"RTN","%ZVEMRLZ",66,0)
 . S FDA(19200.112,IEN_",",2)=CNT,CNT=CNT+1
"RTN","%ZVEMRLZ",67,0)
 . D FILE^DIE("","FDA","MSG")
"RTN","%ZVEMRLZ",68,0)
 Q
"RTN","%ZVEMRLZ",69,0)
 ;==================================================================
"RTN","%ZVEMRLZ",70,0)
BULKDEL ;Bulk delete
"RTN","%ZVEMRLZ",71,0)
 NEW PRESERVE,RENUM,SHOW,X
"RTN","%ZVEMRLZ",72,0)
 ;
"RTN","%ZVEMRLZ",73,0)
 Q:'$D(^VEE(19200.112))  ;...Version file doesn't exist
"RTN","%ZVEMRLZ",74,0)
 S X="ERROR^%ZVEMRLZ",@($$TRAP^%ZVEMKU1) KILL X
"RTN","%ZVEMRLZ",75,0)
 KILL ^TMP("VPE",$J)
"RTN","%ZVEMRLZ",76,0)
 ;
"RTN","%ZVEMRLZ",77,0)
 S SHOW=$$BULKS() G:SHOW="" BULKEX
"RTN","%ZVEMRLZ",78,0)
 I SHOW="L" D BULKL I 1 ;Show only Library routines in Selector
"RTN","%ZVEMRLZ",79,0)
 E  D BULKA ;Show ALL routines in Selector
"RTN","%ZVEMRLZ",80,0)
 ;
"RTN","%ZVEMRLZ",81,0)
 G:'$D(^TMP("VPE",$J)) BULKEX ;............No versions on file
"RTN","%ZVEMRLZ",82,0)
 S ^TMP("VPE",$J,"HD")="Routines on file "
"RTN","%ZVEMRLZ",83,0)
 D SELECT^%ZVEMKT("^TMP(""VPE"","_$J_")") ;Call SELECTOR
"RTN","%ZVEMRLZ",84,0)
 G:'$D(^TMP("VPE","SELECT",$J)) BULKEX  ;..Nothing selected
"RTN","%ZVEMRLZ",85,0)
 ;
"RTN","%ZVEMRLZ",86,0)
 S PRESERVE=$$BULKV() ;Preserve any versions?
"RTN","%ZVEMRLZ",87,0)
 I PRESERVE W ! D  ;
"RTN","%ZVEMRLZ",88,0)
 . S RENUM=$$ASK^%ZVEMKU("Renumber any remaining versions, starting with 1",1)
"RTN","%ZVEMRLZ",89,0)
 W ! G:$$ASK^%ZVEMKU("Ok to delete now",1)'="Y" DELEX
"RTN","%ZVEMRLZ",90,0)
 ;
"RTN","%ZVEMRLZ",91,0)
 D BULKD ;Do deletions
"RTN","%ZVEMRLZ",92,0)
 W !!,"Deletion complete."
"RTN","%ZVEMRLZ",93,0)
 D PAUSE^%ZVEMKU(2)
"RTN","%ZVEMRLZ",94,0)
 ;
"RTN","%ZVEMRLZ",95,0)
BULKEX ;Exit
"RTN","%ZVEMRLZ",96,0)
 KILL ^TMP("VPE",$J)
"RTN","%ZVEMRLZ",97,0)
 KILL ^TMP("VPE","SELECT",$J)
"RTN","%ZVEMRLZ",98,0)
 Q
"RTN","%ZVEMRLZ",99,0)
 ;
"RTN","%ZVEMRLZ",100,0)
BULKS() ;Which routines to show in Selector?
"RTN","%ZVEMRLZ",101,0)
 ;Return: L, A, or ""
"RTN","%ZVEMRLZ",102,0)
 NEW SHOW
"RTN","%ZVEMRLZ",103,0)
 W !,"Include which routines in Selector?"
"RTN","%ZVEMRLZ",104,0)
 W !!,"   L  Library Routines"
"RTN","%ZVEMRLZ",105,0)
 W !,"   A  All Routines"
"RTN","%ZVEMRLZ",106,0)
 W !
"RTN","%ZVEMRLZ",107,0)
BULKS1 W !,"Select LETTER: "
"RTN","%ZVEMRLZ",108,0)
 R SHOW:300 S:'$T SHOW="^" I "^"[SHOW Q ""
"RTN","%ZVEMRLZ",109,0)
 I ",L,A,l,a,"'[(","_SHOW_",") D  G BULKS1
"RTN","%ZVEMRLZ",110,0)
 . W "   Enter L or A, or <RET> to abort"
"RTN","%ZVEMRLZ",111,0)
 S:SHOW="l" SHOW="L"
"RTN","%ZVEMRLZ",112,0)
 S:SHOW="a" SHOW="A"
"RTN","%ZVEMRLZ",113,0)
 Q SHOW
"RTN","%ZVEMRLZ",114,0)
 ;
"RTN","%ZVEMRLZ",115,0)
BULKA ;Present all routines in Selector
"RTN","%ZVEMRLZ",116,0)
 NEW CNT,NUM,RTN,TMP,VER
"RTN","%ZVEMRLZ",117,0)
 S CNT=1
"RTN","%ZVEMRLZ",118,0)
 S RTN=""
"RTN","%ZVEMRLZ",119,0)
 F  S RTN=$O(^VEE(19200.112,"UNIQ",RTN)) Q:RTN']""  D  ;
"RTN","%ZVEMRLZ",120,0)
 . S TMP=RTN_$J("",15-$L(RTN))
"RTN","%ZVEMRLZ",121,0)
 . S (NUM,VER)=0
"RTN","%ZVEMRLZ",122,0)
 . F  S VER=$O(^VEE(19200.112,"AKEY",RTN,VER)) Q:'VER  S NUM=NUM+1
"RTN","%ZVEMRLZ",123,0)
 . S TMP=TMP_"|"_NUM_" version"_$S(NUM>1:"s",1:"")
"RTN","%ZVEMRLZ",124,0)
 . S ^TMP("VPE",$J,CNT)=RTN_"^"_NUM_$C(9)_TMP
"RTN","%ZVEMRLZ",125,0)
 . S CNT=CNT+1
"RTN","%ZVEMRLZ",126,0)
 Q
"RTN","%ZVEMRLZ",127,0)
 ;
"RTN","%ZVEMRLZ",128,0)
BULKL ;Present only those routines signed out in the Library
"RTN","%ZVEMRLZ",129,0)
 NEW CNT,DATA,ID,IEN,NUM,RTN,TMP,VER
"RTN","%ZVEMRLZ",130,0)
 ;
"RTN","%ZVEMRLZ",131,0)
 S ID=$$RSID^%ZVEMRLO() Q:ID="^"  ;Use IDENTIFIER field
"RTN","%ZVEMRLZ",132,0)
 ;
"RTN","%ZVEMRLZ",133,0)
 S CNT=1
"RTN","%ZVEMRLZ",134,0)
 S RTN=""
"RTN","%ZVEMRLZ",135,0)
 F  S RTN=$O(^VEE(19200.11,"B",RTN)) Q:RTN']""  D  ;
"RTN","%ZVEMRLZ",136,0)
 . Q:'$D(^VEE(19200.112,"AKEY",RTN))  ;No versions for this rtn
"RTN","%ZVEMRLZ",137,0)
 . S IEN=$O(^VEE(19200.11,"B",RTN,"")) Q:'IEN
"RTN","%ZVEMRLZ",138,0)
 . S DATA=$G(^VEE(19200.11,IEN,0))
"RTN","%ZVEMRLZ",139,0)
 . I ID]"",ID'=$P(DATA,"^",4) Q
"RTN","%ZVEMRLZ",140,0)
 . S TMP=RTN_$J("",15-$L(RTN))
"RTN","%ZVEMRLZ",141,0)
 . S (NUM,VER)=0
"RTN","%ZVEMRLZ",142,0)
 . F  S VER=$O(^VEE(19200.112,"AKEY",RTN,VER)) Q:'VER  S NUM=NUM+1
"RTN","%ZVEMRLZ",143,0)
 . S TMP=TMP_"|"_NUM_" version"_$S(NUM>1:"s",1:"")
"RTN","%ZVEMRLZ",144,0)
 . S ^TMP("VPE",$J,CNT)=RTN_"^"_NUM_$C(9)_TMP
"RTN","%ZVEMRLZ",145,0)
 . S CNT=CNT+1
"RTN","%ZVEMRLZ",146,0)
 Q
"RTN","%ZVEMRLZ",147,0)
 ;
"RTN","%ZVEMRLZ",148,0)
BULKD ;Do deletions
"RTN","%ZVEMRLZ",149,0)
 NEW CNT,DA,DIC,DIK,I,ND,NUM,TMP,RTN,VER
"RTN","%ZVEMRLZ",150,0)
 S CNT=0
"RTN","%ZVEMRLZ",151,0)
 F  S CNT=$O(^TMP("VPE","SELECT",$J,CNT)) Q:'CNT  D  ;
"RTN","%ZVEMRLZ",152,0)
 . S ND=$G(^TMP("VPE","SELECT",$J,CNT))
"RTN","%ZVEMRLZ",153,0)
 . S TMP=$P(ND,$C(9),1)
"RTN","%ZVEMRLZ",154,0)
 . S RTN=$P(TMP,"^",1) Q:RTN']""  ;Routine name
"RTN","%ZVEMRLZ",155,0)
 . S NUM=$P(TMP,"^",2) ;Number of versions on file
"RTN","%ZVEMRLZ",156,0)
 . I PRESERVE S NUM=(NUM-PRESERVE) ;How many to preserve?
"RTN","%ZVEMRLZ",157,0)
 . S VER=0
"RTN","%ZVEMRLZ",158,0)
 . F I=1:1:NUM S VER=$O(^VEE(19200.112,"AKEY",RTN,VER)) Q:'VER  D  ;
"RTN","%ZVEMRLZ",159,0)
 .. S DA=$O(^VEE(19200.112,"AKEY",RTN,VER,0)) Q:'DA
"RTN","%ZVEMRLZ",160,0)
 .. S DIK="^VEE(19200.112,"
"RTN","%ZVEMRLZ",161,0)
 .. D ^DIK
"RTN","%ZVEMRLZ",162,0)
 . I $G(RENUM)="Y" D DELRENUM(RTN) ;Renumber remaining versions
"RTN","%ZVEMRLZ",163,0)
 Q
"RTN","%ZVEMRLZ",164,0)
 ;
"RTN","%ZVEMRLZ",165,0)
BULKV() ;Preserve how many versions?
"RTN","%ZVEMRLZ",166,0)
 NEW PRES
"RTN","%ZVEMRLZ",167,0)
 S PRES=$$ASK^%ZVEMKU("Do you want to preserve any versions",1)
"RTN","%ZVEMRLZ",168,0)
 I PRES'="Y" Q 0
"RTN","%ZVEMRLZ",169,0)
BULKV1 W !!,"Enter number of most recent versions to be preserved: "
"RTN","%ZVEMRLZ",170,0)
 R PRES:300 S:'$T PRES="^" I "^"[PRES Q 0
"RTN","%ZVEMRLZ",171,0)
 I PRES'=+PRES!(PRES?1.N1".".E) D  G BULKV1
"RTN","%ZVEMRLZ",172,0)
 . W !,"If you enter a number I will preserve that many versions of each"
"RTN","%ZVEMRLZ",173,0)
 . W !,"routine on file. The most recent versions will be the ones preserved."
"RTN","%ZVEMRLZ",174,0)
 Q PRES
"RTN","%ZVEMRLZ",175,0)
 ;
"RTN","%ZVEMRLZ",176,0)
ERROR ;Error trap
"RTN","%ZVEMRLZ",177,0)
 NEW ZE
"RTN","%ZVEMRLZ",178,0)
 S @("ZE="_VEE("$ZE"))
"RTN","%ZVEMRLZ",179,0)
 L -VRRLOCK(RTN) ;Unlock routine editing
"RTN","%ZVEMRLZ",180,0)
 W !!,"An error has occurred"
"RTN","%ZVEMRLZ",181,0)
 W !,"ERROR: ",ZE
"RTN","%ZVEMRLZ",182,0)
 D PAUSE^%ZVEMKU(2,"P")
"RTN","%ZVEMRLZ",183,0)
 Q
"RTN","%ZVEMRM")
0^118^B19495283
"RTN","%ZVEMRM",1,0)
%ZVEMRM ;DJB,VRR**Menu Bar ; 12/17/00 4:08pm
"RTN","%ZVEMRM",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMRM",3,0)
 ;
"RTN","%ZVEMRM",4,0)
EN ;Because of FndTag/LctStrng, I need to be able to change the lines
"RTN","%ZVEMRM",5,0)
 ;displayed when exiting back to edit mode. FLAGMENU allows this.
"RTN","%ZVEMRM",6,0)
 NEW FLAGMENU
"RTN","%ZVEMRM",7,0)
 S FLAGMENU=YND_"^"_VEET("TOP")_"^"_YCUR_"^"_XCUR
"RTN","%ZVEMRM",8,0)
 ;-> Do PAGE and then set scroll variables to new values.
"RTN","%ZVEMRM",9,0)
 D PAGE
"RTN","%ZVEMRM",10,0)
 S YND=$P(FLAGMENU,"^",1)
"RTN","%ZVEMRM",11,0)
 S VEET("TOP")=$P(FLAGMENU,"^",2)
"RTN","%ZVEMRM",12,0)
 S YCUR=$P(FLAGMENU,"^",3)
"RTN","%ZVEMRM",13,0)
 Q
"RTN","%ZVEMRM",14,0)
 ;
"RTN","%ZVEMRM",15,0)
PAGE ;Get users response
"RTN","%ZVEMRM",16,0)
 NEW KEY,XCHAR,XCUR,YCUR,YND,CD,CDHLD
"RTN","%ZVEMRM",17,0)
PAGE1 S DX=0,DY=VEET("S2")+1 X VEES("CRSR")
"RTN","%ZVEMRM",18,0)
 W @VEES("BLANK_C_EOL")
"RTN","%ZVEMRM",19,0)
 S DX=8 X VEES("CRSR")
"RTN","%ZVEMRM",20,0)
 W "[  ]  <RET>=Quit  R=Rtn  F=FndTg  L=LctStrg  G=Goto  ?=Help  M=More..."
"RTN","%ZVEMRM",21,0)
 S DX=0 X VEES("CRSR")
"RTN","%ZVEMRM",22,0)
 W @VEE("RON"),"Select:",@VEE("ROFF")
"RTN","%ZVEMRM",23,0)
 S DX=9 X VEES("CRSR")
"RTN","%ZVEMRM",24,0)
PAGE2 S KEY=$$READ^%ZVEMKRN(),KEY=$$ALLCAPS^%ZVEMKU(KEY)
"RTN","%ZVEMRM",25,0)
 Q:KEY="^"
"RTN","%ZVEMRM",26,0)
 Q:",<ESC>,<F1E>,<F1Q>,<RET>,<TO>,"[(","_VEE("K")_",")
"RTN","%ZVEMRM",27,0)
 ;-> No editing if using the Rtn Reader
"RTN","%ZVEMRM",28,0)
 I ",J,LC,SV,"[(","_KEY_","),$G(FLAGVPE)'["EDIT" D  Q
"RTN","%ZVEMRM",29,0)
 . S (XCUR,YCUR)=0 D MSG^%ZVEMRUM(5)
"RTN","%ZVEMRM",30,0)
 I ",?,ASC,FMC,I,RS,SV,VEDD,VGL,"[(","_KEY_",") D MODULES Q
"RTN","%ZVEMRM",31,0)
 I VEE("K")="<ESCH>" D MODULES Q
"RTN","%ZVEMRM",32,0)
 I KEY="CALL" D ^%ZVEMRID Q  ;.............Insert programmer call
"RTN","%ZVEMRM",33,0)
 I KEY="F" D TAG^%ZVEMRMS Q
"RTN","%ZVEMRM",34,0)
 I KEY="L" D LOCATE Q
"RTN","%ZVEMRM",35,0)
 I KEY="G" D GOTO^%ZVEMRM1 Q
"RTN","%ZVEMRM",36,0)
 I KEY="J" D JOIN^%ZVEMREJ Q
"RTN","%ZVEMRM",37,0)
 I KEY="JC" D JOINA^%ZVEMREJ Q
"RTN","%ZVEMRM",38,0)
 I KEY="LC" D ^%ZVEMRM2 Q
"RTN","%ZVEMRM",39,0)
 I KEY="M" D MORE^%ZVEMRM1 G PAGE1
"RTN","%ZVEMRM",40,0)
 I KEY="P" D PARAM^%ZVEMRM1 Q
"RTN","%ZVEMRM",41,0)
 I KEY="PUR" D PUR Q
"RTN","%ZVEMRM",42,0)
 I KEY="R" D ROUTINE Q
"RTN","%ZVEMRM",43,0)
 I KEY="S" D SIZE Q
"RTN","%ZVEMRM",44,0)
 W $C(7)
"RTN","%ZVEMRM",45,0)
 G PAGE1
"RTN","%ZVEMRM",46,0)
 ;
"RTN","%ZVEMRM",47,0)
ROUTINE ;Branch to a routine
"RTN","%ZVEMRM",48,0)
 D SYMTAB^%ZVEMKST("C","VRR",VRRS) ;.......Save/Clear symbol table
"RTN","%ZVEMRM",49,0)
 D ENDSCR^%ZVEMKT2
"RTN","%ZVEMRM",50,0)
 ;-> MSM NT needs this or no form feed occurs
"RTN","%ZVEMRM",51,0)
 I $G(^%ZOSF("OS"))["MSM for Windows NT" H 1
"RTN","%ZVEMRM",52,0)
 W !?1,"***BRANCH TO A ROUTINE***",!
"RTN","%ZVEMRM",53,0)
 D START^%ZVEMR
"RTN","%ZVEMRM",54,0)
 D SYMTAB^%ZVEMKST("R","VRR",VRRS) ;.......Restore symbol table
"RTN","%ZVEMRM",55,0)
 Q
"RTN","%ZVEMRM",56,0)
 ;
"RTN","%ZVEMRM",57,0)
LOCATE ;Locate String
"RTN","%ZVEMRM",58,0)
 NEW HELP,PROMPT,TXT
"RTN","%ZVEMRM",59,0)
 S PROMPT=" STRING"
"RTN","%ZVEMRM",60,0)
 S HELP="   Enter text & I'll search for matching string."
"RTN","%ZVEMRM",61,0)
 S TXT=$$GETTEXT^%ZVEMRM2(PROMPT,HELP) Q:TXT']""
"RTN","%ZVEMRM",62,0)
 ;S VRRFIND=TXT_$C(127)_KEY,YND=$P(FLAGMENU,"^",1)
"RTN","%ZVEMRM",63,0)
 S VRRFIND=TXT
"RTN","%ZVEMRM",64,0)
 S YND=$P(FLAGMENU,"^",1)
"RTN","%ZVEMRM",65,0)
 D LCTSTRG^%ZVEMRM1(TXT)
"RTN","%ZVEMRM",66,0)
 Q
"RTN","%ZVEMRM",67,0)
 ;
"RTN","%ZVEMRM",68,0)
LOCATE1 ;Called by <ESC>N (Find Next) in EDIT mode
"RTN","%ZVEMRM",69,0)
 NEW FLAGMENU,TXT
"RTN","%ZVEMRM",70,0)
 S VRRFIND=$G(VRRFIND)
"RTN","%ZVEMRM",71,0)
 S TXT=$P(VRRFIND,$C(127),1)
"RTN","%ZVEMRM",72,0)
 Q:TXT']""
"RTN","%ZVEMRM",73,0)
 S FLAGMENU=YND_"^"_VEET("TOP")_"^"_YCUR_"^"_XCUR
"RTN","%ZVEMRM",74,0)
 D LCTSTRG^%ZVEMRM1(TXT)
"RTN","%ZVEMRM",75,0)
 S YND=$P(FLAGMENU,"^",1)
"RTN","%ZVEMRM",76,0)
 S VEET("TOP")=$P(FLAGMENU,"^",2)
"RTN","%ZVEMRM",77,0)
 S YCUR=$P(FLAGMENU,"^",3)
"RTN","%ZVEMRM",78,0)
 Q
"RTN","%ZVEMRM",79,0)
 ;
"RTN","%ZVEMRM",80,0)
MODULES ;VGL,VEDD
"RTN","%ZVEMRM",81,0)
 D ENDSCR^%ZVEMKT2
"RTN","%ZVEMRM",82,0)
 I KEY="?"!(VEE("K")="<ESCH>") D HELP^%ZVEMKT("VRR1") Q
"RTN","%ZVEMRM",83,0)
 I KEY="ASC",$G(VEESHL)="RUN" D ASCII^%ZVEMST,PAUSE^%ZVEMKC(1) Q
"RTN","%ZVEMRM",84,0)
 I KEY="FMC",$G(VEESHL)="RUN" D ^%ZVEMSF Q
"RTN","%ZVEMRM",85,0)
 I KEY="I" D INDEX^%ZVEMRMG Q  ;....................Run %INDEX
"RTN","%ZVEMRM",86,0)
 I KEY="RS" D  D RSE^%ZVEMRY Q
"RTN","%ZVEMRM",87,0)
 . W !?1,"***SEARCH ROUTINE(S)***"
"RTN","%ZVEMRM",88,0)
 I KEY="SV" S FLAGQ=1 D SAVE^%ZVEMRMS S FLAGQ=0 Q  ;Save on the fly
"RTN","%ZVEMRM",89,0)
 I KEY="VEDD" D  D VEDD^%ZVEMRY Q
"RTN","%ZVEMRM",90,0)
 . W !?1,"***ELECTRONIC DATA DICTIONARY***",!
"RTN","%ZVEMRM",91,0)
 I KEY="VGL" D  D VGL^%ZVEMRY Q
"RTN","%ZVEMRM",92,0)
 . W !?1,"***GLOBAL LISTER***"
"RTN","%ZVEMRM",93,0)
 Q
"RTN","%ZVEMRM",94,0)
 ;
"RTN","%ZVEMRM",95,0)
SIZE ;Display size of routine
"RTN","%ZVEMRM",96,0)
 NEW NAM,XX,Y
"RTN","%ZVEMRM",97,0)
 S DX=0,DY=VEET("S2")+1 X VEES("CRSR")
"RTN","%ZVEMRM",98,0)
 W @VEES("BLANK_C_EOL")
"RTN","%ZVEMRM",99,0)
 I '$D(^%ZOSF("SIZE")) D  R XX:50 Q
"RTN","%ZVEMRM",100,0)
 . W "  Global node ^%ZOSF(""SIZE"") must be available.."
"RTN","%ZVEMRM",101,0)
 I '$D(^TMP("VEE","VRR",$J,VRRS,"NAME")) D  R XX:50 Q
"RTN","%ZVEMRM",102,0)
 . W "  Routine name unknown.."
"RTN","%ZVEMRM",103,0)
 S (NAM,Y)=^("NAME") X "ZL @Y X ^%ZOSF(""SIZE"")"
"RTN","%ZVEMRM",104,0)
 W "  ^",NAM,".....Routine size = ",Y R XX:50
"RTN","%ZVEMRM",105,0)
 Q
"RTN","%ZVEMRM",106,0)
 ;
"RTN","%ZVEMRM",107,0)
PUR ;Purge clipboard
"RTN","%ZVEMRM",108,0)
 NEW TMP
"RTN","%ZVEMRM",109,0)
 D ENDSCR^%ZVEMKT2
"RTN","%ZVEMRM",110,0)
 W !?1,"*** WARNING ***"
"RTN","%ZVEMRM",111,0)
 W !!?1,"This option will purge the clipboard. If anyone is currently using the"
"RTN","%ZVEMRM",112,0)
 W !?1,"editor and has saved lines to the clipboard, these lines will be lost."
"RTN","%ZVEMRM",113,0)
 W ! S TMP=$$YN^%ZVEMKU1(" Shall I continue? ",1)
"RTN","%ZVEMRM",114,0)
 I TMP=1 KILL ^%ZVEMS("E","SAVEVRR")
"RTN","%ZVEMRM",115,0)
 W !!?1,"Clipboard",$S(TMP'=1:" not",1:"")," purged.."
"RTN","%ZVEMRM",116,0)
 D PAUSE^%ZVEMKC(2)
"RTN","%ZVEMRM",117,0)
 Q
"RTN","%ZVEMRM",118,0)
 ;
"RTN","%ZVEMRM",119,0)
REDRAW ;Redraw screen
"RTN","%ZVEMRM",120,0)
 NEW DX,DY,I,TMP
"RTN","%ZVEMRM",121,0)
 D SCROLL^%ZVEMKT2(1)
"RTN","%ZVEMRM",122,0)
 S DY=VEET("S1")-2
"RTN","%ZVEMRM",123,0)
 F I=VEET("TOP"):1:(VEET("BOT")-1) D  ;
"RTN","%ZVEMRM",124,0)
 . S DX=0,DY=DY+1 X VEES("CRSR")
"RTN","%ZVEMRM",125,0)
 . S TMP=$G(^TMP("VEE","IR"_VRRS,$J,I))
"RTN","%ZVEMRM",126,0)
 . W $P(TMP,$C(30),1)
"RTN","%ZVEMRM",127,0)
 . W $P(TMP,$C(30),2,99)
"RTN","%ZVEMRM",128,0)
 Q
"RTN","%ZVEMRM1")
0^119^B18500520
"RTN","%ZVEMRM1",1,0)
%ZVEMRM1 ;DJB,VRR**FndTag,LctStrg,Goto,More,Param ; 12/17/00 3:56pm
"RTN","%ZVEMRM1",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMRM1",3,0)
 ;
"RTN","%ZVEMRM1",4,0)
GETTAG ;Get tag from scroll array and convert to external format
"RTN","%ZVEMRM1",5,0)
 S TG=$P(TMP," "_$C(30),1) I TG?1.N1." " S TG="" Q
"RTN","%ZVEMRM1",6,0)
 F  Q:$E(TG)'=" "  S TG=$E(TG,2,999) ;Strip starting spaces
"RTN","%ZVEMRM1",7,0)
 Q
"RTN","%ZVEMRM1",8,0)
 ;====================================================================
"RTN","%ZVEMRM1",9,0)
FINDTAG(TXT) ;Find line tag that contains TXT
"RTN","%ZVEMRM1",10,0)
 I $G(^TMP("VEE","IR"_VRRS,$J,YND))=" <> <> <>" W $C(7) Q
"RTN","%ZVEMRM1",11,0)
 I $G(TXT)']"" Q
"RTN","%ZVEMRM1",12,0)
 NEW FLAGQ,I,TG,TMP
"RTN","%ZVEMRM1",13,0)
 S FLAGQ=0
"RTN","%ZVEMRM1",14,0)
 F I=YND+1:1 S TMP=$G(^TMP("VEE","IR"_VRRS,$J,I)) Q:TMP']""  Q:TMP=" <> <> <>"  D  Q:FLAGQ
"RTN","%ZVEMRM1",15,0)
 . Q:TMP'[$C(30)  D GETTAG Q:TG'[TXT
"RTN","%ZVEMRM1",16,0)
 . ;Note: FLAGMENU=YND^VEET("TOP")^YCUR^XCUR
"RTN","%ZVEMRM1",17,0)
 . S FLAGMENU=I_"^"_I_"^"_1,FLAGQ=1 Q
"RTN","%ZVEMRM1",18,0)
 I 'FLAGQ S (XCUR,YCUR)=0 D MSG^%ZVEMRUM(16)
"RTN","%ZVEMRM1",19,0)
 Q
"RTN","%ZVEMRM1",20,0)
 ;====================================================================
"RTN","%ZVEMRM1",21,0)
LCTSTRG(TXT) ;Locate string TXT
"RTN","%ZVEMRM1",22,0)
 I $G(^TMP("VEE","IR"_VRRS,$J,YND))=" <> <> <>" W $C(7) Q
"RTN","%ZVEMRM1",23,0)
 I $G(TXT)']"" Q
"RTN","%ZVEMRM1",24,0)
 NEW FLAGQ,I,I1,LN,TG,TMP
"RTN","%ZVEMRM1",25,0)
 S FLAGQ=0,LN=""
"RTN","%ZVEMRM1",26,0)
 F I=YND+1:1 S TMP=^TMP("VEE","IR"_VRRS,$J,I) Q:TMP=" <> <> <>"  Q:TMP[$C(30)  Q:TMP']""
"RTN","%ZVEMRM1",27,0)
 Q:TMP=" <> <> <>"!(TMP']"")  S YND=I
"RTN","%ZVEMRM1",28,0)
 D GETTAG S LN=TG_" "_$P(TMP,$C(30),2,999)
"RTN","%ZVEMRM1",29,0)
 F I=YND+1:1 S TMP=$G(^TMP("VEE","IR"_VRRS,$J,I)) D  Q:FLAGQ  Q:TMP=" <> <> <>"  Q:TMP']""
"RTN","%ZVEMRM1",30,0)
 . I TMP=" <> <> <>" D  Q
"RTN","%ZVEMRM1",31,0)
 . . Q:LN'[TXT  S FLAGQ=1
"RTN","%ZVEMRM1",32,0)
 . . F I1=I-1:-1:1 Q:$G(^TMP("VEE","IR"_VRRS,$J,I1))[$C(30)
"RTN","%ZVEMRM1",33,0)
 . . S FLAGMENU=I1_"^"_I1_"^"_1
"RTN","%ZVEMRM1",34,0)
 . I TMP'[$C(30) S LN=LN_$E(TMP,10,999) Q  ;Scrolled part of line
"RTN","%ZVEMRM1",35,0)
 . I LN[TXT D  S FLAGQ=1 Q
"RTN","%ZVEMRM1",36,0)
 . . F I1=I-1:-1:1 Q:$G(^TMP("VEE","IR"_VRRS,$J,I1))[$C(30)
"RTN","%ZVEMRM1",37,0)
 . . S FLAGMENU=I1_"^"_I1_"^"_1
"RTN","%ZVEMRM1",38,0)
 . D GETTAG S LN=TG_" "_$P(TMP,$C(30),2,999)
"RTN","%ZVEMRM1",39,0)
 I 'FLAGQ S (XCUR,YCUR)=0 D MSG^%ZVEMRUM(16)
"RTN","%ZVEMRM1",40,0)
 Q
"RTN","%ZVEMRM1",41,0)
 ;====================================================================
"RTN","%ZVEMRM1",42,0)
GOTO ;Go to a line
"RTN","%ZVEMRM1",43,0)
 NEW HELP,LN,NUM,X
"RTN","%ZVEMRM1",44,0)
 S HELP="   Enter line # or Tag+Offset. I'll move to that line."
"RTN","%ZVEMRM1",45,0)
 S LN=$$GETLINE^%ZVEMREJ("LINE",HELP,1)
"RTN","%ZVEMRM1",46,0)
 I LN["+" D ^%ZVEMRMG Q  ;Goto Tag+Offset
"RTN","%ZVEMRM1",47,0)
 Q:LN'>0
"RTN","%ZVEMRM1",48,0)
 ;Convert node array number to line number
"RTN","%ZVEMRM1",49,0)
 S (NUM,X)=0
"RTN","%ZVEMRM1",50,0)
 F  S X=$O(^TMP("VEE","IR"_VRRS,$J,X)) Q:X'>0  D  Q:NUM=LN
"RTN","%ZVEMRM1",51,0)
 . I ^(X)[$C(30) S NUM=NUM+1
"RTN","%ZVEMRM1",52,0)
 ;Show at least 1 line of code
"RTN","%ZVEMRM1",53,0)
 I X'>0 S X=$O(^TMP("VEE","IR"_VRRS,$J,""),-1) S:X>1 X=X-1
"RTN","%ZVEMRM1",54,0)
 S FLAGMENU=X_"^"_X_"^"_1
"RTN","%ZVEMRM1",55,0)
 Q
"RTN","%ZVEMRM1",56,0)
 ;====================================================================
"RTN","%ZVEMRM1",57,0)
MORE ;MORE Menu
"RTN","%ZVEMRM1",58,0)
 D ENDSCR^%ZVEMKT2
"RTN","%ZVEMRM1",59,0)
 W !?5,"CALL = Insert programmer call"
"RTN","%ZVEMRM1",60,0)
 W !?5,"I    = Run %INDEX"
"RTN","%ZVEMRM1",61,0)
 W !?5,"J    = Join 2 lines you select"
"RTN","%ZVEMRM1",62,0)
 W !?5,"JC   = Join next line to current line"
"RTN","%ZVEMRM1",63,0)
 W !?5,"LC   = Locate and change all occurrences of a string"
"RTN","%ZVEMRM1",64,0)
 W !?5,"RS   = Routine search"
"RTN","%ZVEMRM1",65,0)
 W !?5,"S    = Display routine size"
"RTN","%ZVEMRM1",66,0)
 W !?5,"SV   = Save changes"
"RTN","%ZVEMRM1",67,0)
 W !?5,"VEDD = Branch to Electronic Data Dictionary"
"RTN","%ZVEMRM1",68,0)
 W !?5,"VGL  = Branch to Global Lister"
"RTN","%ZVEMRM1",69,0)
 W !?5,"FMC  = Fileman calls"
"RTN","%ZVEMRM1",70,0)
 W !?5,"ASC  = ASCII table"
"RTN","%ZVEMRM1",71,0)
 W !?5,"PUR  = Purge Clipboard"
"RTN","%ZVEMRM1",72,0)
 W !?5,"P    = Edit Parameters"
"RTN","%ZVEMRM1",73,0)
 D PAUSE^%ZVEMKC(2),REDRAW^%ZVEMRM
"RTN","%ZVEMRM1",74,0)
 Q
"RTN","%ZVEMRM1",75,0)
PARAM ;Set parameter
"RTN","%ZVEMRM1",76,0)
 D ENDSCR^%ZVEMKT2
"RTN","%ZVEMRM1",77,0)
 I $G(VEE("ID"))'>0 D  D PAUSE^%ZVEMKC(2) Q
"RTN","%ZVEMRM1",78,0)
 . W $C(7),!!?1,"You're VPE ID is not defined. Aborting.."
"RTN","%ZVEMRM1",79,0)
 W !?1,"When you want to add a new line of code to the routine you are editing,"
"RTN","%ZVEMRM1",80,0)
 W !?1,"you hit <RETURN> to open a new line. By setting the following parameter,"
"RTN","%ZVEMRM1",81,0)
 W !?1,"you can control how this process works."
"RTN","%ZVEMRM1",82,0)
 W !!?5,"1. Open a new line BELOW the current line, regardless of"
"RTN","%ZVEMRM1",83,0)
 W !?5,"   where on the current line the cursor is located."
"RTN","%ZVEMRM1",84,0)
 W !!?5,"2. Open a new line ABOVE the current line if the cursor"
"RTN","%ZVEMRM1",85,0)
 W !?5,"   is at the start of the line. Open a new line BELOW the"
"RTN","%ZVEMRM1",86,0)
 W !?5,"   current line if the cursor is at the end of the line."
"RTN","%ZVEMRM1",87,0)
 W !?5,"   If the cursor is located anywhere else, BREAK the line."
"RTN","%ZVEMRM1",88,0)
 NEW DEF,RET
"RTN","%ZVEMRM1",89,0)
 W ! S DEF=$G(^%ZVEMS("E","PARAM",VEE("ID"),"RETURN"))
"RTN","%ZVEMRM1",90,0)
PARAM1 W !?5,"Enter number of your choice: " I DEF]"" W DEF_"//"
"RTN","%ZVEMRM1",91,0)
 R RET:300 S:'$T RET="^" S:RET="" RET=DEF I "^"[RET Q
"RTN","%ZVEMRM1",92,0)
 I RET'?1N!(RET<1)!(RET>2) D  G PARAM1
"RTN","%ZVEMRM1",93,0)
 . W !?5,"Enter a number from 1 to 2, or ^ to quit."
"RTN","%ZVEMRM1",94,0)
 S ^%ZVEMS("E","PARAM",VEE("ID"),"RETURN")=RET
"RTN","%ZVEMRM1",95,0)
 Q
"RTN","%ZVEMRM2")
0^120^B21594791
"RTN","%ZVEMRM2",1,0)
%ZVEMRM2 ;DJB,VRR**Locate & Change ; 7/25/99 9:49pm
"RTN","%ZVEMRM2",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMRM2",3,0)
 ;
"RTN","%ZVEMRM2",4,0)
TOP ;
"RTN","%ZVEMRM2",5,0)
 NEW HELP,LN1,LN2,ND1,ND2,OFF,OLD,ON,NEW
"RTN","%ZVEMRM2",6,0)
 S HELP="   Enter code you want replaced.."
"RTN","%ZVEMRM2",7,0)
 S OLD=$$GETTEXT("REPLACE",HELP) G:OLD']"" EX
"RTN","%ZVEMRM2",8,0)
 S HELP="   Enter replacement code.."
"RTN","%ZVEMRM2",9,0)
 S NEW=$$GETTEXT("   WITH",HELP)
"RTN","%ZVEMRM2",10,0)
 D LINE G:LN1'>0 EX
"RTN","%ZVEMRM2",11,0)
 S @("ON="_VEE("RON")),@("OFF="_VEE("ROFF"))
"RTN","%ZVEMRM2",12,0)
 D LOCATE
"RTN","%ZVEMRM2",13,0)
EX ;
"RTN","%ZVEMRM2",14,0)
 KILL ^TMP("VEE","SAVE",$J)
"RTN","%ZVEMRM2",15,0)
 Q
"RTN","%ZVEMRM2",16,0)
 ;===================================================================
"RTN","%ZVEMRM2",17,0)
LINE ;Get start and end line numbers
"RTN","%ZVEMRM2",18,0)
 S HELP="   Enter starting line # of range you want edited.."
"RTN","%ZVEMRM2",19,0)
 S LN1=$$GETLINE^%ZVEMREJ("STARTING LINE",HELP)
"RTN","%ZVEMRM2",20,0)
 Q:LN1'>0
"RTN","%ZVEMRM2",21,0)
 S ND1=$$GETNODE^%ZVEMRU(LN1)
"RTN","%ZVEMRM2",22,0)
 I ND1=0 W $C(7) G LINE
"RTN","%ZVEMRM2",23,0)
 S HELP="   Enter ending line # of range you want edited.."
"RTN","%ZVEMRM2",24,0)
 S LN2=$$GETLINE^%ZVEMREJ("  ENDING LINE",HELP)
"RTN","%ZVEMRM2",25,0)
 G:LN2'>0 LINE
"RTN","%ZVEMRM2",26,0)
 S ND2=$$GETNODE^%ZVEMRU(LN2)
"RTN","%ZVEMRM2",27,0)
 I ND2<ND1 W $C(7) G LINE
"RTN","%ZVEMRM2",28,0)
 Q
"RTN","%ZVEMRM2",29,0)
GETTEXT(PROMPT,HELP) ;Get text from user. Maximum of 65 characters.
"RTN","%ZVEMRM2",30,0)
 ;Return: null if no text is entered.
"RTN","%ZVEMRM2",31,0)
 NEW TXT
"RTN","%ZVEMRM2",32,0)
 S PROMPT=$G(PROMPT)
"RTN","%ZVEMRM2",33,0)
 S HELP=$G(HELP)
"RTN","%ZVEMRM2",34,0)
 S DX=0,DY=VEET("S2")+1 X VEES("CRSR") W @VEES("BLANK_C_EOL")
"RTN","%ZVEMRM2",35,0)
 X VEES("CRSR") W @VEE("RON")," "_PROMPT_":",@VEE("ROFF")
"RTN","%ZVEMRM2",36,0)
GETTEXT1 S DX=$L(PROMPT)+3 X VEES("CRSR") W @VEES("BLANK_C_EOL")
"RTN","%ZVEMRM2",37,0)
 X VEES("CRSR") S TXT=$$READ^%ZVEMKRN("",65)
"RTN","%ZVEMRM2",38,0)
 ;--> The following codes are only returned if TXT="".
"RTN","%ZVEMRM2",39,0)
 I ",<ESC>,<F1E>,<F1Q>,<RET>,<TO>,"[(","_VEE("K")_",") Q ""
"RTN","%ZVEMRM2",40,0)
 I TXT="?"!(VEE("K")="<ESCH>"),HELP]"" D  G GETTEXT1
"RTN","%ZVEMRM2",41,0)
 . S DX=$L(PROMPT)+2 X VEES("CRSR") W @VEES("BLANK_C_EOL")
"RTN","%ZVEMRM2",42,0)
 . X VEES("CRSR") W HELP D PAUSE^%ZVEMKC(0)
"RTN","%ZVEMRM2",43,0)
 Q TXT
"RTN","%ZVEMRM2",44,0)
 ;===================================================================
"RTN","%ZVEMRM2",45,0)
LOCATE ;Locate nodes that contain TXT1
"RTN","%ZVEMRM2",46,0)
 NEW ADJUST,ASK,FLAGQ,I,LN,TG,TMP
"RTN","%ZVEMRM2",47,0)
 S FLAGQ=0
"RTN","%ZVEMRM2",48,0)
 S TMP=$G(^TMP("VEE","IR"_VRRS,$J,ND1))
"RTN","%ZVEMRM2",49,0)
 I TMP=" <> <> <>" W $C(7) Q
"RTN","%ZVEMRM2",50,0)
 KILL ^TMP("VEE","SAVE",$J)
"RTN","%ZVEMRM2",51,0)
 S ^($J,ND1)="",YND=ND1
"RTN","%ZVEMRM2",52,0)
 S TG=$P(TMP,$C(30),1)
"RTN","%ZVEMRM2",53,0)
 S LN=$P(TMP,$C(30),2,999)
"RTN","%ZVEMRM2",54,0)
 F I=ND1+1:1 S TMP=$G(^TMP("VEE","IR"_VRRS,$J,I)) D  Q:FLAGQ
"RTN","%ZVEMRM2",55,0)
 . I TMP']"" S FLAGQ=1 Q
"RTN","%ZVEMRM2",56,0)
 . I TMP=" <> <> <>" S FLAGQ=1 D:LN[OLD CHANGE Q
"RTN","%ZVEMRM2",57,0)
 . ;-> Scrolled part of line
"RTN","%ZVEMRM2",58,0)
 . I TMP'[$C(30) S LN=LN_$E(TMP,10,999),^TMP("VEE","SAVE",$J,I)="" Q
"RTN","%ZVEMRM2",59,0)
 . D:LN[OLD CHANGE Q:FLAGQ
"RTN","%ZVEMRM2",60,0)
 . S LN1=LN1+1 ;Show line # when asking to change.
"RTN","%ZVEMRM2",61,0)
 . I I>ND2 S FLAGQ=1 Q
"RTN","%ZVEMRM2",62,0)
 . S TG=$P(TMP,$C(30),1)
"RTN","%ZVEMRM2",63,0)
 . S LN=$P(TMP,$C(30),2,999)
"RTN","%ZVEMRM2",64,0)
 . KILL ^TMP("VEE","SAVE",$J)
"RTN","%ZVEMRM2",65,0)
 . S I=I+$G(ADJUST),ND2=ND2+$G(ADJUST) ;Adj for Del/Paste line# diff
"RTN","%ZVEMRM2",66,0)
 . S YND=I
"RTN","%ZVEMRM2",67,0)
 . S ^TMP("VEE","SAVE",$J,YND)=""
"RTN","%ZVEMRM2",68,0)
 Q
"RTN","%ZVEMRM2",69,0)
CHANGE ;Change TXT1 to TXT2
"RTN","%ZVEMRM2",70,0)
 ;ADJ will adjust START if NEW & OLD are different lengths
"RTN","%ZVEMRM2",71,0)
 ;--> Delete array: ^TMP("VEE","SAVE",$J)
"RTN","%ZVEMRM2",72,0)
 ;--> Paste array:  ^%ZVEMS("E","SAVEVRR",$J)
"RTN","%ZVEMRM2",73,0)
 NEW ADJ,FD,I,SHOW,START
"RTN","%ZVEMRM2",74,0)
 S FLAGSAVE=1
"RTN","%ZVEMRM2",75,0)
 S START=0
"RTN","%ZVEMRM2",76,0)
 S ADJ=$L(NEW)-$L(OLD)
"RTN","%ZVEMRM2",77,0)
 F I=1:1:($L(LN,OLD)-1) D  Q:FLAGQ
"RTN","%ZVEMRM2",78,0)
 . S FD=$F(LN,OLD,START)
"RTN","%ZVEMRM2",79,0)
 . S START=FD+ADJ
"RTN","%ZVEMRM2",80,0)
 . ;-> Used by ASK to display code to be changed
"RTN","%ZVEMRM2",81,0)
 . S SHOW=LN1_". "_$E(LN,(FD-$L(OLD)-7),FD-$L(OLD)-1)
"RTN","%ZVEMRM2",82,0)
 . S SHOW=SHOW_ON_OLD_OFF_$E(LN,FD,FD+6)
"RTN","%ZVEMRM2",83,0)
 . D:$G(ASK)'="A" ASK Q:ASK="N"!FLAGQ
"RTN","%ZVEMRM2",84,0)
 . S LN=$E(LN,1,(FD-$L(OLD)-1))_NEW_$E(LN,FD,999)
"RTN","%ZVEMRM2",85,0)
 S LN=TG_$C(30)_LN
"RTN","%ZVEMRM2",86,0)
 S ^%ZVEMS("E","SAVEVRR",$J,1)=$E(LN,1,VEE("IOM")-1)
"RTN","%ZVEMRM2",87,0)
 S LN=$E(LN,VEE("IOM"),9999)
"RTN","%ZVEMRM2",88,0)
 F I=2:1 Q:LN']""  D  ;
"RTN","%ZVEMRM2",89,0)
 . S ^%ZVEMS("E","SAVEVRR",$J,I)=$J("",9)_$E(LN,1,VEE("IOM")-11)
"RTN","%ZVEMRM2",90,0)
 . S LN=$E(LN,VEE("IOM")-10,9999)
"RTN","%ZVEMRM2",91,0)
 S ^%ZVEMS("E","SAVEVRR",$J,I)=""
"RTN","%ZVEMRM2",92,0)
 D ADJUST
"RTN","%ZVEMRM2",93,0)
 D DELETE^%ZVEMRP1(1)
"RTN","%ZVEMRM2",94,0)
 S YND=YND-1
"RTN","%ZVEMRM2",95,0)
 D PASTE^%ZVEMRP1
"RTN","%ZVEMRM2",96,0)
 Q
"RTN","%ZVEMRM2",97,0)
ASK ;
"RTN","%ZVEMRM2",98,0)
 NEW ZDY
"RTN","%ZVEMRM2",99,0)
 S ZDY=DY
"RTN","%ZVEMRM2",100,0)
ASK1 S DX=0,DY=ZDY-4 X VEES("CRSR") W @VEES("BLANK_C_EOS")
"RTN","%ZVEMRM2",101,0)
 X VEES("CRSR") W "~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"
"RTN","%ZVEMRM2",102,0)
 S DX=0,DY=ZDY-3 X VEES("CRSR") W "REPLACE: "_SHOW
"RTN","%ZVEMRM2",103,0)
 S DX=0,DY=ZDY-2 X VEES("CRSR") W "   WITH: ",ON,NEW,OFF
"RTN","%ZVEMRM2",104,0)
 S DX=0,DY=ZDY-1 X VEES("CRSR")
"RTN","%ZVEMRM2",105,0)
 W "Replace?  Y=Yes  N=No  A=YesToAll   Select: "
"RTN","%ZVEMRM2",106,0)
 S DX=0,DY=ZDY
"RTN","%ZVEMRM2",107,0)
 X VEES("CRSR") W "~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"
"RTN","%ZVEMRM2",108,0)
 S DX=44,DY=ZDY-1 X VEES("CRSR")
"RTN","%ZVEMRM2",109,0)
 S DY=ZDY
"RTN","%ZVEMRM2",110,0)
 R ASK:300 S:'$T ASK="^" I "^"[ASK S FLAGQ=1
"RTN","%ZVEMRM2",111,0)
 S ASK=$E(ASK) I "AaNnYy^"'[ASK W $C(7) G ASK1
"RTN","%ZVEMRM2",112,0)
 S ASK=$S("Yy"[ASK:"Y","Aa"[ASK:"A",1:"N")
"RTN","%ZVEMRM2",113,0)
 Q:ASK'="A"
"RTN","%ZVEMRM2",114,0)
 S DX=0,DY=ZDY-3 X VEES("CRSR") W @VEES("BLANK_C_EOS")
"RTN","%ZVEMRM2",115,0)
 S DX=0,DY=ZDY-2 X VEES("CRSR") W "Please wait.."
"RTN","%ZVEMRM2",116,0)
 S DX=0,DY=ZDY
"RTN","%ZVEMRM2",117,0)
 X VEES("CRSR") W "~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"
"RTN","%ZVEMRM2",118,0)
 S DY=ZDY
"RTN","%ZVEMRM2",119,0)
 Q
"RTN","%ZVEMRM2",120,0)
ADJUST ;Adjust for difference between lines deleted and lines pasted
"RTN","%ZVEMRM2",121,0)
 NEW DELETE,PASTE,X
"RTN","%ZVEMRM2",122,0)
 S (DELETE,PASTE,X)=0
"RTN","%ZVEMRM2",123,0)
 F  S X=$O(^TMP("VEE","SAVE",$J,X)) Q:X'>0  S DELETE=DELETE+1
"RTN","%ZVEMRM2",124,0)
 ;-> Can't use reverse $O due to nature of ^%ZVEMS("E","SAVEVRR")
"RTN","%ZVEMRM2",125,0)
 S X=0
"RTN","%ZVEMRM2",126,0)
 F  S X=$O(^%ZVEMS("E","SAVEVRR",$J,X)) Q:'X!(^(X)="")  S PASTE=PASTE+1
"RTN","%ZVEMRM2",127,0)
 S ADJUST=PASTE-DELETE
"RTN","%ZVEMRM2",128,0)
 Q
"RTN","%ZVEMRMG")
0^121^B4267721
"RTN","%ZVEMRMG",1,0)
%ZVEMRMG ;DJB,VRR**Goto Tag+Offset,%INDEX ; 1/8/01 8:38am
"RTN","%ZVEMRMG",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMRMG",3,0)
 ;
"RTN","%ZVEMRMG",4,0)
EN ;
"RTN","%ZVEMRMG",5,0)
 I '$D(^TMP("VEE","IR"_VRRS,$J,1)) W $C(7) Q
"RTN","%ZVEMRMG",6,0)
 I $G(^TMP("VEE","IR"_VRRS,$J,1))=" <> <> <>" W $C(7) Q
"RTN","%ZVEMRMG",7,0)
 NEW FLAGQ,TAG,OFFSET
"RTN","%ZVEMRMG",8,0)
 Q:$G(LN)'["+"
"RTN","%ZVEMRMG",9,0)
 S TAG=$P(LN,"+",1)
"RTN","%ZVEMRMG",10,0)
 S OFFSET=$P(LN,"+",2) Q:OFFSET'>0
"RTN","%ZVEMRMG",11,0)
 S FLAGQ=0
"RTN","%ZVEMRMG",12,0)
 D FINDTAG Q:FLAGQ
"RTN","%ZVEMRMG",13,0)
 D OFFSET
"RTN","%ZVEMRMG",14,0)
 Q
"RTN","%ZVEMRMG",15,0)
 ;
"RTN","%ZVEMRMG",16,0)
FINDTAG ;Find line tag that contains TXT
"RTN","%ZVEMRMG",17,0)
 NEW CHK,I,TG,TMP
"RTN","%ZVEMRMG",18,0)
 S CHK=0
"RTN","%ZVEMRMG",19,0)
 F I=1:1 S TMP=$G(^TMP("VEE","IR"_VRRS,$J,I)) Q:TMP']""  Q:TMP=" <> <> <>"  D  Q:CHK
"RTN","%ZVEMRMG",20,0)
 . Q:TMP'[$C(30)
"RTN","%ZVEMRMG",21,0)
 . D GETTAG Q:TG'[TAG
"RTN","%ZVEMRMG",22,0)
 . ;Note: FLAGMENU=YND^VEET("TOP")^YCUR^XCUR
"RTN","%ZVEMRMG",23,0)
 . S FLAGMENU=I_"^"_I_"^"_1
"RTN","%ZVEMRMG",24,0)
 . S CHK=1
"RTN","%ZVEMRMG",25,0)
 I 'CHK S FLAGQ=1,(XCUR,YCUR)=0 D MSG^%ZVEMRUM(16)
"RTN","%ZVEMRMG",26,0)
 Q
"RTN","%ZVEMRMG",27,0)
 ;
"RTN","%ZVEMRMG",28,0)
GETTAG ;Get tag from scroll array and convert to external format
"RTN","%ZVEMRMG",29,0)
 S TG=$P(TMP," "_$C(30),1)
"RTN","%ZVEMRMG",30,0)
 I TG?1.N1." " S TG="" Q
"RTN","%ZVEMRMG",31,0)
 F  Q:$E(TG)'=" "  S TG=$E(TG,2,999) ;Strip starting spaces
"RTN","%ZVEMRMG",32,0)
 Q
"RTN","%ZVEMRMG",33,0)
 ;
"RTN","%ZVEMRMG",34,0)
OFFSET ;Go to offset
"RTN","%ZVEMRMG",35,0)
 NEW HELP,NUM,X
"RTN","%ZVEMRMG",36,0)
 ;Convert node array number to line number
"RTN","%ZVEMRMG",37,0)
 S (NUM,X)=$P(FLAGMENU,U,1)
"RTN","%ZVEMRMG",38,0)
 S OFFSET=NUM+OFFSET
"RTN","%ZVEMRMG",39,0)
 F  S X=$O(^TMP("VEE","IR"_VRRS,$J,X)) Q:X'>0  D  Q:NUM=OFFSET
"RTN","%ZVEMRMG",40,0)
 . I ^(X)[$C(30) S NUM=NUM+1
"RTN","%ZVEMRMG",41,0)
 ;Show at least 1 line of code
"RTN","%ZVEMRMG",42,0)
 I X'>0 S X=$O(^TMP("VEE","IR"_VRRS,$J,""),-1) S:X>1 X=X-1
"RTN","%ZVEMRMG",43,0)
 S FLAGMENU=X_"^"_X_"^"_1
"RTN","%ZVEMRMG",44,0)
 Q
"RTN","%ZVEMRMG",45,0)
 ;====================================================================
"RTN","%ZVEMRMG",46,0)
INDEX ;Run %INDEX
"RTN","%ZVEMRMG",47,0)
 D SYMTAB^%ZVEMKST("S","VRR",VRRS) ;......Save symbol table
"RTN","%ZVEMRMG",48,0)
 NEW RTN
"RTN","%ZVEMRMG",49,0)
 S RTN=$G(^TMP("VEE","VRR",$J,VRRS,"NAME"))
"RTN","%ZVEMRMG",50,0)
 W !,"*** RUNNING %INDEX ("_RTN_") ***",!
"RTN","%ZVEMRMG",51,0)
 D  ;
"RTN","%ZVEMRMG",52,0)
 . NEW VEE,VEES,VRRS
"RTN","%ZVEMRMG",53,0)
 . D ^%INDEX
"RTN","%ZVEMRMG",54,0)
 . KILL
"RTN","%ZVEMRMG",55,0)
 D SYMTAB^%ZVEMKST("R","VRR",VRRS) ;......Restore symbol table
"RTN","%ZVEMRMG",56,0)
 X ^%ZVEMS("ZS",3) ;......................Reset VShell variables
"RTN","%ZVEMRMG",57,0)
 D PAUSE^%ZVEMKC(2)
"RTN","%ZVEMRMG",58,0)
 Q
"RTN","%ZVEMRMS")
0^122^B8655818
"RTN","%ZVEMRMS",1,0)
%ZVEMRMS ;DJB,VRR**Save Changes ; 12/17/00 6:32pm
"RTN","%ZVEMRMS",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMRMS",3,0)
 ;
"RTN","%ZVEMRMS",4,0)
SAVE ;Save changes on-the-fly.
"RTN","%ZVEMRMS",5,0)
 ;Rtns calling here should have FLAGQ=1. FLAGQ is set to 0 if user
"RTN","%ZVEMRMS",6,0)
 ;is not to be exited but returned to current rtn to continue editing.
"RTN","%ZVEMRMS",7,0)
 ;
"RTN","%ZVEMRMS",8,0)
 Q:$$ASK^%ZVEMKU(" Do you wish to save your changes",1)'="Y"
"RTN","%ZVEMRMS",9,0)
 ;
"RTN","%ZVEMRMS",10,0)
 NEW VEES,VRRPGM,VRRUPDAT,X
"RTN","%ZVEMRMS",11,0)
 ;
"RTN","%ZVEMRMS",12,0)
 S X="ERROR^%ZVEMRMS",@($$TRAP^%ZVEMKU1) KILL X
"RTN","%ZVEMRMS",13,0)
 KILL ^UTILITY($J)
"RTN","%ZVEMRMS",14,0)
 ;
"RTN","%ZVEMRMS",15,0)
 D BUILD G:$G(VRRPGM)']"" EX
"RTN","%ZVEMRMS",16,0)
 G:$$DUP() EX
"RTN","%ZVEMRMS",17,0)
 D VERIFY^%ZVEMRV(VRRS) G:'FLAGQ EX
"RTN","%ZVEMRMS",18,0)
 X "S X=VRRPGM X VEES(""ZS"")"
"RTN","%ZVEMRMS",19,0)
 I VRRS>1 L -VRRLOCK(VRRPGM)
"RTN","%ZVEMRMS",20,0)
 W !!,"Changes saved to disk..."
"RTN","%ZVEMRMS",21,0)
 ;
"RTN","%ZVEMRMS",22,0)
 D ADD^%ZVEMRLU(VRRPGM) ;Routine Library
"RTN","%ZVEMRMS",23,0)
 D ADD^%ZVEMRLV(VRRPGM) ;Routine Versioning
"RTN","%ZVEMRMS",24,0)
 ;
"RTN","%ZVEMRMS",25,0)
 S FLAGSAVE=0
"RTN","%ZVEMRMS",26,0)
 D PAUSE^%ZVEMKC(2)
"RTN","%ZVEMRMS",27,0)
 ;
"RTN","%ZVEMRMS",28,0)
EX ;Exit
"RTN","%ZVEMRMS",29,0)
 KILL ^UTILITY($J)
"RTN","%ZVEMRMS",30,0)
 Q
"RTN","%ZVEMRMS",31,0)
 ;
"RTN","%ZVEMRMS",32,0)
BUILD ;Build ^UTILITY array
"RTN","%ZVEMRMS",33,0)
 NEW FLAGQ,LN,TG
"RTN","%ZVEMRMS",34,0)
 S FLAGQ=0
"RTN","%ZVEMRMS",35,0)
 D INIT^%ZVEMRC
"RTN","%ZVEMRMS",36,0)
 I FLAGQ S VRRPGM="" Q
"RTN","%ZVEMRMS",37,0)
 S VRRPGM=$G(^TMP("VEE","VRR",$J,VRRS,"NAME"))
"RTN","%ZVEMRMS",38,0)
 Q:VRRPGM']""
"RTN","%ZVEMRMS",39,0)
 D CONVERT^%ZVEMRV(VRRS)
"RTN","%ZVEMRMS",40,0)
 S TMP=$G(^UTILITY($J,0,1))
"RTN","%ZVEMRMS",41,0)
 I TMP']""!(TMP=" <> <> <>") S VRRPGM="" Q
"RTN","%ZVEMRMS",42,0)
 S TG=$P(TMP," ",1),LN=$P(TMP," ",2,99)
"RTN","%ZVEMRMS",43,0)
 D DATE^%ZVEMRC
"RTN","%ZVEMRMS",44,0)
 Q
"RTN","%ZVEMRMS",45,0)
 ;
"RTN","%ZVEMRMS",46,0)
DUP() ;Can't save changes to rtn you are editing in another session
"RTN","%ZVEMRMS",47,0)
 ;0=Ok  1=Quit
"RTN","%ZVEMRMS",48,0)
 ;
"RTN","%ZVEMRMS",49,0)
 I VRRS'>1 Q 0
"RTN","%ZVEMRMS",50,0)
 ;
"RTN","%ZVEMRMS",51,0)
 NEW CHK,I
"RTN","%ZVEMRMS",52,0)
 S CHK=0
"RTN","%ZVEMRMS",53,0)
 F I=1:1 Q:$G(^TMP("VEE","VRR",$J,I,"NAME"))']""  I I'=VRRS,$G(^("NAME"))=VRRPGM S CHK=1 D  Q
"RTN","%ZVEMRMS",54,0)
 . W $C(7),!!,"You are currently editing this program in another session."
"RTN","%ZVEMRMS",55,0)
 I CHK D PAUSE^%ZVEMKU(2) Q 1
"RTN","%ZVEMRMS",56,0)
 Q 0
"RTN","%ZVEMRMS",57,0)
 ;
"RTN","%ZVEMRMS",58,0)
ERROR ;Error trap
"RTN","%ZVEMRMS",59,0)
 KILL ^UTILITY($J) D ERRMSG^%ZVEMKU1("VRR"),PAUSE^%ZVEMKU(2)
"RTN","%ZVEMRMS",60,0)
 Q
"RTN","%ZVEMRMS",61,0)
 ;
"RTN","%ZVEMRMS",62,0)
TAG ;Option 'T' on menu bar. Select a line tag to move to.
"RTN","%ZVEMRMS",63,0)
 NEW FLAGQ,TAG
"RTN","%ZVEMRMS",64,0)
 S FLAGQ=0
"RTN","%ZVEMRMS",65,0)
 D ENDSCR^%ZVEMKT2
"RTN","%ZVEMRMS",66,0)
 D TAGLIST Q:FLAGQ
"RTN","%ZVEMRMS",67,0)
 D TAGASK Q:FLAGQ
"RTN","%ZVEMRMS",68,0)
 D REDRAW^%ZVEMRM
"RTN","%ZVEMRMS",69,0)
 Q
"RTN","%ZVEMRMS",70,0)
 ;
"RTN","%ZVEMRMS",71,0)
TAGLIST ;List line tags
"RTN","%ZVEMRMS",72,0)
 NEW CNT,I,TG,TMP
"RTN","%ZVEMRMS",73,0)
 S CNT=1
"RTN","%ZVEMRMS",74,0)
 F I=2:1 S TMP=$G(^TMP("VEE","IR"_VRRS,$J,I)) Q:TMP']""  Q:TMP=" <> <> <>"  D  ;
"RTN","%ZVEMRMS",75,0)
 . Q:TMP'[$C(30)
"RTN","%ZVEMRMS",76,0)
 . D GETTAG^%ZVEMRM1
"RTN","%ZVEMRMS",77,0)
 . Q:TG']""
"RTN","%ZVEMRMS",78,0)
 . I CNT=1 W !,"Move to a line tag."
"RTN","%ZVEMRMS",79,0)
 . W !,"  " I $L(CNT)=1 W " "
"RTN","%ZVEMRMS",80,0)
 . W CNT,". ",TG
"RTN","%ZVEMRMS",81,0)
 . S TAG(CNT)=I
"RTN","%ZVEMRMS",82,0)
 . S CNT=CNT+1
"RTN","%ZVEMRMS",83,0)
 . I $Y>(VEE("IOSL")-4) D PAUSE^%ZVEMKU(2,"P") W @VEE("IOF")
"RTN","%ZVEMRMS",84,0)
 ;
"RTN","%ZVEMRMS",85,0)
 I CNT=1 D  Q
"RTN","%ZVEMRMS",86,0)
 . S FLAGQ=1
"RTN","%ZVEMRMS",87,0)
 . W !,"There are no line tags in this routine."
"RTN","%ZVEMRMS",88,0)
 . D PAUSE^%ZVEMKC(2)
"RTN","%ZVEMRMS",89,0)
 Q
"RTN","%ZVEMRMS",90,0)
 ;
"RTN","%ZVEMRMS",91,0)
TAGASK ;Select a tag
"RTN","%ZVEMRMS",92,0)
 W !
"RTN","%ZVEMRMS",93,0)
TAGASK1 W !,"Select NUMBER: "
"RTN","%ZVEMRMS",94,0)
 R TAG:100 S:'$T TAG="^" I "^"[TAG S FLAGQ=1 Q
"RTN","%ZVEMRMS",95,0)
 I '$D(TAG(TAG)) D  G TAGASK1
"RTN","%ZVEMRMS",96,0)
 . W "   Enter a number from the left hand column."
"RTN","%ZVEMRMS",97,0)
 ;
"RTN","%ZVEMRMS",98,0)
 ;Move to selected tag.
"RTN","%ZVEMRMS",99,0)
 ;Note: FLAGMENU=YND^VEET("TOP")^YCUR^XCUR
"RTN","%ZVEMRMS",100,0)
 S FLAGMENU=TAG(TAG)_"^"_TAG(TAG)_"^"_1
"RTN","%ZVEMRMS",101,0)
 Q
"RTN","%ZVEMRP")
0^123^B21848818
"RTN","%ZVEMRP",1,0)
%ZVEMRP ;DJB,VRR**Block Mode - Highlight Lines ; 12/28/00 7:56am
"RTN","%ZVEMRP",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMRP",3,0)
 ;
"RTN","%ZVEMRP",4,0)
UP ;F3 Up-arrow highlight
"RTN","%ZVEMRP",5,0)
 Q:$$CHECK()
"RTN","%ZVEMRP",6,0)
 I $D(^TMP("VEE","SAVE",$J,YND-1)) D CLEARUP Q
"RTN","%ZVEMRP",7,0)
 Q:'$D(^TMP("VEE","IR"_VRRS,$J,YND))
"RTN","%ZVEMRP",8,0)
 I ^(YND)=" <> <> <>" D UP^%ZVEMRE(1) Q
"RTN","%ZVEMRP",9,0)
 D CHKBELOW ;See if line below is part of this line
"RTN","%ZVEMRP",10,0)
UP1 I YCUR=1,VEET("TOP")'>1 D  Q
"RTN","%ZVEMRP",11,0)
 . I $D(^TMP("VEE","SAVE",$J,YND)) W $C(7) Q
"RTN","%ZVEMRP",12,0)
 . S ^TMP("VEE","SAVE",$J,YND)=^TMP("VEE","IR"_VRRS,$J,YND)
"RTN","%ZVEMRP",13,0)
 . D MARK(YCUR,YND)
"RTN","%ZVEMRP",14,0)
 . S DX=XCUR,DY=YCUR X VEES("CRSR")
"RTN","%ZVEMRP",15,0)
 S ^TMP("VEE","SAVE",$J,YND)=^TMP("VEE","IR"_VRRS,$J,YND)
"RTN","%ZVEMRP",16,0)
 D MARK(YCUR,YND)
"RTN","%ZVEMRP",17,0)
 D UP^%ZVEMRE(1)
"RTN","%ZVEMRP",18,0)
 Q:^TMP("VEE","IR"_VRRS,$J,YND+1)[$C(30)
"RTN","%ZVEMRP",19,0)
 ;Loop back in case line has scrolled
"RTN","%ZVEMRP",20,0)
 G UP1
"RTN","%ZVEMRP",21,0)
 ;
"RTN","%ZVEMRP",22,0)
DOWN ;F3 Down-arrow highlight
"RTN","%ZVEMRP",23,0)
 Q:$$CHECK()
"RTN","%ZVEMRP",24,0)
 I $D(^TMP("VEE","SAVE",$J,YND)) D CLEARDN1 Q
"RTN","%ZVEMRP",25,0)
 I $D(^TMP("VEE","SAVE",$J,YND+1)) D CLEARDN Q
"RTN","%ZVEMRP",26,0)
 Q:'$D(^TMP("VEE","IR"_VRRS,$J,YND))
"RTN","%ZVEMRP",27,0)
 I ^(YND)=" <> <> <>" W $C(7) Q
"RTN","%ZVEMRP",28,0)
 I ^(YND)'[$C(30) D CHKABOVE ;See if line above is part of this line
"RTN","%ZVEMRP",29,0)
DOWN1 S ^TMP("VEE","SAVE",$J,YND)=^TMP("VEE","IR"_VRRS,$J,YND)
"RTN","%ZVEMRP",30,0)
 D MARK(YCUR,YND)
"RTN","%ZVEMRP",31,0)
 D DOWN^%ZVEMRE(1)
"RTN","%ZVEMRP",32,0)
 Q:^TMP("VEE","IR"_VRRS,$J,YND)[$C(30)
"RTN","%ZVEMRP",33,0)
 Q:^(YND)=" <> <> <>"
"RTN","%ZVEMRP",34,0)
 G DOWN1 ;Do a loop in case line has scrolled
"RTN","%ZVEMRP",35,0)
 ;
"RTN","%ZVEMRP",36,0)
MARK(YVAL,ND) ;Mark selected lines. YVAL=$Y, ND=Node
"RTN","%ZVEMRP",37,0)
 NEW TMP
"RTN","%ZVEMRP",38,0)
 S DX=0,DY=YVAL X VEES("CRSR")
"RTN","%ZVEMRP",39,0)
 W @VEES("BLANK_C_EOL")
"RTN","%ZVEMRP",40,0)
 W @VEE("RON")
"RTN","%ZVEMRP",41,0)
 X VEES("CRSR")
"RTN","%ZVEMRP",42,0)
 S TMP=$G(^TMP("VEE","SAVE",$J,ND))
"RTN","%ZVEMRP",43,0)
 W $P(TMP,$C(30),1)
"RTN","%ZVEMRP",44,0)
 W $P(TMP,$C(30),2)
"RTN","%ZVEMRP",45,0)
 W ?VEE("IOM")-1
"RTN","%ZVEMRP",46,0)
 W @VEE("ROFF")
"RTN","%ZVEMRP",47,0)
 Q
"RTN","%ZVEMRP",48,0)
 ;
"RTN","%ZVEMRP",49,0)
CHKABOVE ;Check if line above is part of this line
"RTN","%ZVEMRP",50,0)
 NEW I,YVAL
"RTN","%ZVEMRP",51,0)
 S YVAL=YCUR
"RTN","%ZVEMRP",52,0)
 F I=YND-1:-1 Q:I<1  D  Q:^TMP("VEE","IR"_VRRS,$J,I)[$C(30)
"RTN","%ZVEMRP",53,0)
 . S ^TMP("VEE","SAVE",$J,I)=^TMP("VEE","IR"_VRRS,$J,I)
"RTN","%ZVEMRP",54,0)
 . S YVAL=YVAL-1
"RTN","%ZVEMRP",55,0)
 . I YVAL>0 D MARK(YVAL,I)
"RTN","%ZVEMRP",56,0)
 Q
"RTN","%ZVEMRP",57,0)
 ;
"RTN","%ZVEMRP",58,0)
CHKBELOW ;Check if line below is part of this line
"RTN","%ZVEMRP",59,0)
 NEW I,YVAL
"RTN","%ZVEMRP",60,0)
 S YVAL=YCUR
"RTN","%ZVEMRP",61,0)
 F I=YND+1:1 Q:'$D(^TMP("VEE","IR"_VRRS,$J,I))  Q:^(I)[$C(30)  Q:^(I)=" <> <> <>"  D  ;
"RTN","%ZVEMRP",62,0)
 . S ^TMP("VEE","SAVE",$J,I)=^TMP("VEE","IR"_VRRS,$J,I)
"RTN","%ZVEMRP",63,0)
 . S YVAL=YVAL+1
"RTN","%ZVEMRP",64,0)
 . I YVAL'>(VEET("BOT")-VEET("TOP")) D MARK(YVAL,I)
"RTN","%ZVEMRP",65,0)
 Q
"RTN","%ZVEMRP",66,0)
 ;
"RTN","%ZVEMRP",67,0)
CLEARUP ;Clear one highlighted line - Cursor UP
"RTN","%ZVEMRP",68,0)
 ;If line has scrolled clear scrolled portion as well
"RTN","%ZVEMRP",69,0)
 NEW FLAGQ,TMP
"RTN","%ZVEMRP",70,0)
 S FLAGQ=0
"RTN","%ZVEMRP",71,0)
 F  D UP^%ZVEMRE(1) D  Q:FLAGQ  Q:'$D(^(YND-1))
"RTN","%ZVEMRP",72,0)
 . S DX=0,DY=YCUR X VEES("CRSR")
"RTN","%ZVEMRP",73,0)
 . S TMP=$G(^TMP("VEE","SAVE",$J,YND))
"RTN","%ZVEMRP",74,0)
 . W $P(TMP,$C(30),1)
"RTN","%ZVEMRP",75,0)
 . W $P(TMP,$C(30),2)
"RTN","%ZVEMRP",76,0)
 . W ?VEE("IOM")-1
"RTN","%ZVEMRP",77,0)
 . S DX=XCUR,DY=YCUR X VEES("CRSR")
"RTN","%ZVEMRP",78,0)
 . S:TMP[$C(30) FLAGQ=1
"RTN","%ZVEMRP",79,0)
 . KILL ^TMP("VEE","SAVE",$J,YND)
"RTN","%ZVEMRP",80,0)
 Q
"RTN","%ZVEMRP",81,0)
 ;
"RTN","%ZVEMRP",82,0)
CLEARDN ;Clear one highlighted line - Cursor DOWN
"RTN","%ZVEMRP",83,0)
 ;If line has scrolled clear scrolled portion as well
"RTN","%ZVEMRP",84,0)
 NEW TMP
"RTN","%ZVEMRP",85,0)
 F  D DOWN^%ZVEMRE(1) D  Q:'$D(^(YND+1))  Q:^(YND+1)[$C(30)
"RTN","%ZVEMRP",86,0)
 . S DX=0,DY=YCUR X VEES("CRSR")
"RTN","%ZVEMRP",87,0)
 . S TMP=$G(^TMP("VEE","SAVE",$J,YND))
"RTN","%ZVEMRP",88,0)
 . W $P(TMP,$C(30),1)
"RTN","%ZVEMRP",89,0)
 . W $P(TMP,$C(30),2)
"RTN","%ZVEMRP",90,0)
 . W ?(VEE("IOM")-1)
"RTN","%ZVEMRP",91,0)
 . S DX=XCUR,DY=YCUR X VEES("CRSR")
"RTN","%ZVEMRP",92,0)
 . KILL ^TMP("VEE","SAVE",$J,YND)
"RTN","%ZVEMRP",93,0)
 Q
"RTN","%ZVEMRP",94,0)
 ;
"RTN","%ZVEMRP",95,0)
CLEARDN1 ;Clear highlighted top line - Cursor DOWN
"RTN","%ZVEMRP",96,0)
 NEW TMP
"RTN","%ZVEMRP",97,0)
 F  D  Q:'$D(^(YND+1))  Q:^(YND+1)[$C(30)  D DOWN^%ZVEMRE(1)
"RTN","%ZVEMRP",98,0)
 . S DX=0,DY=YCUR X VEES("CRSR")
"RTN","%ZVEMRP",99,0)
 . S TMP=$G(^TMP("VEE","SAVE",$J,YND))
"RTN","%ZVEMRP",100,0)
 . W $P(TMP,$C(30),1)
"RTN","%ZVEMRP",101,0)
 . W $P(TMP,$C(30),2)
"RTN","%ZVEMRP",102,0)
 . W ?(VEE("IOM")-1)
"RTN","%ZVEMRP",103,0)
 . S DX=XCUR,DY=YCUR X VEES("CRSR")
"RTN","%ZVEMRP",104,0)
 . KILL ^TMP("VEE","SAVE",$J,YND)
"RTN","%ZVEMRP",105,0)
 Q
"RTN","%ZVEMRP",106,0)
 ;
"RTN","%ZVEMRP",107,0)
CLEARALL ;Clear all highlighted lines
"RTN","%ZVEMRP",108,0)
 NEW CNT,DY,TMP,TMP1
"RTN","%ZVEMRP",109,0)
 S CNT=0
"RTN","%ZVEMRP",110,0)
 S DY=VEET("S1")-2
"RTN","%ZVEMRP",111,0)
 F I=VEET("TOP"):1:VEET("BOT")-1 D  ;
"RTN","%ZVEMRP",112,0)
 . S DX=0,DY=DY+1
"RTN","%ZVEMRP",113,0)
 . S TMP=$G(^TMP("VEE","SAVE",$J,I))
"RTN","%ZVEMRP",114,0)
 . S TMP1=$G(^TMP("VEE","SAVECHAR",$J,I))
"RTN","%ZVEMRP",115,0)
 . I TMP']"",TMP1']"" Q
"RTN","%ZVEMRP",116,0)
 . X VEES("CRSR")
"RTN","%ZVEMRP",117,0)
 . ;
"RTN","%ZVEMRP",118,0)
 . I TMP]"" D  ;
"RTN","%ZVEMRP",119,0)
 .. W $P(TMP,$C(30),1)
"RTN","%ZVEMRP",120,0)
 .. W $P(TMP,$C(30),2)
"RTN","%ZVEMRP",121,0)
 .. W ?(VEE("IOM")-1)
"RTN","%ZVEMRP",122,0)
 . E  D  ;
"RTN","%ZVEMRP",123,0)
 .. W $P(TMP1,$C(30),1)
"RTN","%ZVEMRP",124,0)
 .. W $P(TMP1,$C(30),2)
"RTN","%ZVEMRP",125,0)
 .. W ?(VEE("IOM")-1)
"RTN","%ZVEMRP",126,0)
 ;
"RTN","%ZVEMRP",127,0)
 KILL ^TMP("VEE","SAVE",$J)
"RTN","%ZVEMRP",128,0)
 KILL ^TMP("VEE","SAVECHAR",$J)
"RTN","%ZVEMRP",129,0)
 S DX=XCUR,DY=YCUR X VEES("CRSR")
"RTN","%ZVEMRP",130,0)
 Q
"RTN","%ZVEMRP",131,0)
 ;
"RTN","%ZVEMRP",132,0)
BULKDN ;Bulk highlight from cursor to bottom of rtn
"RTN","%ZVEMRP",133,0)
 Q:$$CHECK()
"RTN","%ZVEMRP",134,0)
 I $D(^TMP("VEE","SAVE",$J)) D  Q
"RTN","%ZVEMRP",135,0)
 . S FLAGMODE=0
"RTN","%ZVEMRP",136,0)
 . D CLEARALL
"RTN","%ZVEMRP",137,0)
 . D MODEOFF^%ZVEMRU("BLOCK")
"RTN","%ZVEMRP",138,0)
 I $G(^TMP("VEE","IR"_VRRS,$J,YND))=" <> <> <>" W $C(7) Q
"RTN","%ZVEMRP",139,0)
 I ^(YND)'[$C(30) D CHKABOVE ;See if line above is part of this line
"RTN","%ZVEMRP",140,0)
 F  D DOWN1 Q:$G(^TMP("VEE","IR"_VRRS,$J,YND))=" <> <> <>"
"RTN","%ZVEMRP",141,0)
 Q
"RTN","%ZVEMRP",142,0)
 ;
"RTN","%ZVEMRP",143,0)
BULKUP ;Bulk highlight from cursor to top of rtn
"RTN","%ZVEMRP",144,0)
 Q:$$CHECK
"RTN","%ZVEMRP",145,0)
 I $D(^TMP("VEE","SAVE",$J)) D  Q
"RTN","%ZVEMRP",146,0)
 . S FLAGMODE=0
"RTN","%ZVEMRP",147,0)
 . D CLEARALL
"RTN","%ZVEMRP",148,0)
 . D MODEOFF^%ZVEMRU("BLOCK")
"RTN","%ZVEMRP",149,0)
 D CHKBELOW ;See if line below is part of this line
"RTN","%ZVEMRP",150,0)
 F  Q:YND=1  D UP
"RTN","%ZVEMRP",151,0)
 I YND=1 D  ;
"RTN","%ZVEMRP",152,0)
 . S ^TMP("VEE","SAVE",$J,YND)=^TMP("VEE","IR"_VRRS,$J,YND)
"RTN","%ZVEMRP",153,0)
 . D MARK(YCUR,YND)
"RTN","%ZVEMRP",154,0)
 . S DX=XCUR,DY=YCUR X VEES("CRSR")
"RTN","%ZVEMRP",155,0)
 Q
"RTN","%ZVEMRP",156,0)
 ;
"RTN","%ZVEMRP",157,0)
CHECK() ;
"RTN","%ZVEMRP",158,0)
 I '$D(^TMP("VEE","SAVECHAR",$J))  Q 0
"RTN","%ZVEMRP",159,0)
 S FLAGMODE=0
"RTN","%ZVEMRP",160,0)
 D CLEARALL^%ZVEMRP
"RTN","%ZVEMRP",161,0)
 D MODEOFF^%ZVEMRU("BLOCK")
"RTN","%ZVEMRP",162,0)
 Q 1
"RTN","%ZVEMRP1")
0^124^B13414292
"RTN","%ZVEMRP1",1,0)
%ZVEMRP1 ;DJB,VRR**Cut,Copy,Paste ; 12/28/00 5:59pm
"RTN","%ZVEMRP1",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMRP1",3,0)
 ;
"RTN","%ZVEMRP1",4,0)
CUT ;Save lines to clipboard, then delete
"RTN","%ZVEMRP1",5,0)
 ;<ESCX> Key combination
"RTN","%ZVEMRP1",6,0)
 I $D(^TMP("VEE","SAVE",$J)) D SAVE,DELETE()
"RTN","%ZVEMRP1",7,0)
 Q
"RTN","%ZVEMRP1",8,0)
 ;
"RTN","%ZVEMRP1",9,0)
COPY ;Save lines to clipboard
"RTN","%ZVEMRP1",10,0)
 ;<ESCC> Key combination
"RTN","%ZVEMRP1",11,0)
 I $D(^TMP("VEE","SAVE",$J)) D SAVE ;.......Line save
"RTN","%ZVEMRP1",12,0)
 I $D(^TMP("VEE","SAVECHAR",$J)) D SAVE1 ;..Character save
"RTN","%ZVEMRP1",13,0)
 D CLEARALL^%ZVEMRP
"RTN","%ZVEMRP1",14,0)
 Q
"RTN","%ZVEMRP1",15,0)
 ;
"RTN","%ZVEMRP1",16,0)
PREPASTE ;Make sure a paste occurs after last of scrolled lines.
"RTN","%ZVEMRP1",17,0)
 NEW DATA,TMP,OLDYND
"RTN","%ZVEMRP1",18,0)
 S (TMP,OLDYND)=YND
"RTN","%ZVEMRP1",19,0)
 F  S TMP=$O(^TMP("VEE","IR"_VRRS,$J,TMP)) Q:TMP'>0  S DATA=^(TMP) Q:DATA[$C(30)!(DATA=" <> <> <>")!(DATA']"")  S YND=YND+1
"RTN","%ZVEMRP1",20,0)
 D PASTE
"RTN","%ZVEMRP1",21,0)
 S YND=OLDYND
"RTN","%ZVEMRP1",22,0)
 Q
"RTN","%ZVEMRP1",23,0)
 ;
"RTN","%ZVEMRP1",24,0)
PASTE ;Paste lines from clipboard to current routine
"RTN","%ZVEMRP1",25,0)
 ;<ESCV> Key combination
"RTN","%ZVEMRP1",26,0)
 ;
"RTN","%ZVEMRP1",27,0)
 Q:'$D(^%ZVEMS("E","SAVEVRR",$J))
"RTN","%ZVEMRP1",28,0)
 I YND>1,$G(^TMP("VEE","IR"_VRRS,$J,YND))=" <> <> <>" W $C(7) Q
"RTN","%ZVEMRP1",29,0)
 ;
"RTN","%ZVEMRP1",30,0)
 NEW CNT,END,I,SPREAD,START
"RTN","%ZVEMRP1",31,0)
 F SPREAD=1:1 Q:$G(^%ZVEMS("E","SAVEVRR",$J,SPREAD))']""
"RTN","%ZVEMRP1",32,0)
 S SPREAD=SPREAD-1
"RTN","%ZVEMRP1",33,0)
 S END=$O(^TMP("VEE","IR"_VRRS,$J,""),-1)
"RTN","%ZVEMRP1",34,0)
 F I=(END+SPREAD):-1:YND+SPREAD D  ;
"RTN","%ZVEMRP1",35,0)
 . S ^TMP("VEE","IR"_VRRS,$J,I)=^TMP("VEE","IR"_VRRS,$J,I-SPREAD)
"RTN","%ZVEMRP1",36,0)
 S CNT=0,START=YND+1
"RTN","%ZVEMRP1",37,0)
 ;-> If there is no code in this rtn, paste to starting line.
"RTN","%ZVEMRP1",38,0)
 S:$G(^TMP("VEE","IR"_VRRS,$J,YND))=" <> <> <>" START=YND
"RTN","%ZVEMRP1",39,0)
 F I=START:1 S CNT=CNT+1 D  Q:CNT=SPREAD
"RTN","%ZVEMRP1",40,0)
 . S ^TMP("VEE","IR"_VRRS,$J,I)=^%ZVEMS("E","SAVEVRR",$J,CNT)
"RTN","%ZVEMRP1",41,0)
 D RENUMBER
"RTN","%ZVEMRP1",42,0)
 Q
"RTN","%ZVEMRP1",43,0)
 ;
"RTN","%ZVEMRP1",44,0)
SAVE ;Save highlighted line code to clipboard
"RTN","%ZVEMRP1",45,0)
 NEW CNT,X
"RTN","%ZVEMRP1",46,0)
 S CNT=1,X=0
"RTN","%ZVEMRP1",47,0)
 F  S X=$O(^TMP("VEE","SAVE",$J,X)) Q:X'>0  D  ;
"RTN","%ZVEMRP1",48,0)
 . S ^%ZVEMS("E","SAVEVRR",$J,CNT)=^TMP("VEE","SAVE",$J,X)
"RTN","%ZVEMRP1",49,0)
 . S CNT=CNT+1
"RTN","%ZVEMRP1",50,0)
 S ^%ZVEMS("E","SAVEVRR",$J,CNT)=""
"RTN","%ZVEMRP1",51,0)
 S ^%ZVEMS("E","SAVEVRR",$J)="LINE"
"RTN","%ZVEMRP1",52,0)
 Q
"RTN","%ZVEMRP1",53,0)
 ;
"RTN","%ZVEMRP1",54,0)
SAVE1 ;Save highlighted character code to clipboard
"RTN","%ZVEMRP1",55,0)
 S ^%ZVEMS("E","SAVEVRR",$J,1)=$G(^TMP("VEE","SAVECHAR",$J))
"RTN","%ZVEMRP1",56,0)
 S ^%ZVEMS("E","SAVEVRR",$J,2)=""
"RTN","%ZVEMRP1",57,0)
 S ^%ZVEMS("E","SAVEVRR",$J)="CHAR"
"RTN","%ZVEMRP1",58,0)
 Q
"RTN","%ZVEMRP1",59,0)
 ;
"RTN","%ZVEMRP1",60,0)
DELETE(QUIT) ;Delete nodes from scroll array
"RTN","%ZVEMRP1",61,0)
 ;If QUIT=1 don't do DELETE1. Allows other rtns to use this code.
"RTN","%ZVEMRP1",62,0)
 ;
"RTN","%ZVEMRP1",63,0)
 Q:'$D(^TMP("VEE","SAVE",$J))
"RTN","%ZVEMRP1",64,0)
 ;
"RTN","%ZVEMRP1",65,0)
 NEW END,I,SPREAD,START,STOP
"RTN","%ZVEMRP1",66,0)
 S START=$O(^TMP("VEE","SAVE",$J,""))
"RTN","%ZVEMRP1",67,0)
 S STOP=$O(^TMP("VEE","SAVE",$J,""),-1)
"RTN","%ZVEMRP1",68,0)
 S SPREAD=STOP-START+1
"RTN","%ZVEMRP1",69,0)
 S END=$O(^TMP("VEE","IR"_VRRS,$J,""),-1)
"RTN","%ZVEMRP1",70,0)
 F I=START:1:END-SPREAD D  ;
"RTN","%ZVEMRP1",71,0)
 . S ^TMP("VEE","IR"_VRRS,$J,I)=^TMP("VEE","IR"_VRRS,$J,I+SPREAD)
"RTN","%ZVEMRP1",72,0)
 F I=END-SPREAD+1:1:END KILL ^TMP("VEE","IR"_VRRS,$J,I)
"RTN","%ZVEMRP1",73,0)
 D RENUMBER
"RTN","%ZVEMRP1",74,0)
 KILL ^TMP("VEE","SAVE",$J)
"RTN","%ZVEMRP1",75,0)
 Q:$G(QUIT)
"RTN","%ZVEMRP1",76,0)
DELETE1 ;If highlight made by cursor up, keep cursor where it is
"RTN","%ZVEMRP1",77,0)
 I YND'<START S VEET("TOP")=YND-(SPREAD+(YND-VEET("TOP")))
"RTN","%ZVEMRP1",78,0)
 S YND=VEET("TOP")+YCUR-1 ;..Reset YND to account for deleted lines
"RTN","%ZVEMRP1",79,0)
 I VEET("TOP")<1 S (VEET("TOP"),YCUR,YND)=1
"RTN","%ZVEMRP1",80,0)
 Q
"RTN","%ZVEMRP1",81,0)
 ;
"RTN","%ZVEMRP1",82,0)
RENUMBER ;Renumber scroll array
"RTN","%ZVEMRP1",83,0)
 NEW L,L1,NUM,NUM1,ONE,TMP,TWO,X
"RTN","%ZVEMRP1",84,0)
 S (NUM,X)=0
"RTN","%ZVEMRP1",85,0)
 F  S X=$O(^TMP("VEE","IR"_VRRS,$J,X)) Q:X'>0  D  ;
"RTN","%ZVEMRP1",86,0)
 . S TMP=^(X) I TMP[$C(30) D  ;...Number lines
"RTN","%ZVEMRP1",87,0)
 . . S NUM=NUM+1,NUM1=+TMP Q:NUM1'>0  S L=$L(NUM),L1=$L(NUM1)
"RTN","%ZVEMRP1",88,0)
 . . I L>L1!(L=L1) S ONE="",TWO=$L(NUM)+1
"RTN","%ZVEMRP1",89,0)
 . . E  S ONE=$J("",L1-L),TWO=L1+1
"RTN","%ZVEMRP1",90,0)
 . . S TMP=NUM_ONE_$E(TMP,TWO,999)
"RTN","%ZVEMRP1",91,0)
 . S ^TMP("VEE","IR"_VRRS,$J,X)=TMP
"RTN","%ZVEMRP1",92,0)
 S VRRHIGH=NUM,FLAGSAVE=1
"RTN","%ZVEMRP1",93,0)
 Q
"RTN","%ZVEMRP1",94,0)
 ;
"RTN","%ZVEMRP1",95,0)
ESCD ;User hit <ESC>D to delete current line
"RTN","%ZVEMRP1",96,0)
 I $D(^TMP("VEE","SAVE",$J)) W $C(7) Q
"RTN","%ZVEMRP1",97,0)
 I $G(^TMP("VEE","IR"_VRRS,$J,YND))=" <> <> <>" W $C(7) Q
"RTN","%ZVEMRP1",98,0)
 NEW I,TMP
"RTN","%ZVEMRP1",99,0)
 F I=YND:-1:1 S ^TMP("VEE","SAVE",$J,I)=$G(^TMP("VEE","IR"_VRRS,$J,I)) Q:^(I)[$C(30)
"RTN","%ZVEMRP1",100,0)
 F I=YND+1:1 S TMP=$G(^TMP("VEE","IR"_VRRS,$J,I)) Q:TMP']""!(TMP[$C(30))!(TMP=" <> <> <>")  S ^TMP("VEE","SAVE",$J,I)=TMP
"RTN","%ZVEMRP1",101,0)
 D DELETE(1)
"RTN","%ZVEMRP1",102,0)
 Q
"RTN","%ZVEMRP2")
0^125^B23060620
"RTN","%ZVEMRP2",1,0)
%ZVEMRP2 ;DJB,VRR**Block Mode - Highlight Characters ; 8/31/02 12:29pm
"RTN","%ZVEMRP2",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMRP2",3,0)
 ;
"RTN","%ZVEMRP2",4,0)
LEFT ;Char highlight - cursor left
"RTN","%ZVEMRP2",5,0)
 NEW CHAR,ND,TAGL,TMP
"RTN","%ZVEMRP2",6,0)
 ;
"RTN","%ZVEMRP2",7,0)
 Q:$$CHECK()
"RTN","%ZVEMRP2",8,0)
 ;
"RTN","%ZVEMRP2",9,0)
 S ND=$G(^TMP("VEE","IR"_VRRS,$J,YND))
"RTN","%ZVEMRP2",10,0)
 Q:ND=" <> <> <>"
"RTN","%ZVEMRP2",11,0)
 ;
"RTN","%ZVEMRP2",12,0)
 S TAGL=$L($P(ND,$C(30),1))
"RTN","%ZVEMRP2",13,0)
 I ND[$C(30),XCUR<TAGL Q
"RTN","%ZVEMRP2",14,0)
 I ND[$C(30),XCUR=TAGL,'$D(^TMP("VEE","SAVECHAR",$J,"CHAR")) Q
"RTN","%ZVEMRP2",15,0)
 ;
"RTN","%ZVEMRP2",16,0)
 ;Beginning of scrolled line
"RTN","%ZVEMRP2",17,0)
 I ND'[$C(30),XCUR<9!($G(MARK)) D  ;
"RTN","%ZVEMRP2",18,0)
 . D UP^%ZVEMRE(1) ;...Move up a line
"RTN","%ZVEMRP2",19,0)
 . S (DX,XCUR)=VEE("IOM")-$S($G(MARK):2,1:3) X VEES("CRSR")
"RTN","%ZVEMRP2",20,0)
 . S ND=$G(^TMP("VEE","IR"_VRRS,$J,YND)) ;...Reset ND
"RTN","%ZVEMRP2",21,0)
 ;
"RTN","%ZVEMRP2",22,0)
 ;Add/Remove highlight character
"RTN","%ZVEMRP2",23,0)
 S TMP=$G(^TMP("VEE","SAVECHAR",$J))
"RTN","%ZVEMRP2",24,0)
 S CHAR=(XCUR+1+(ND[$C(30)))
"RTN","%ZVEMRP2",25,0)
 I '$D(^TMP("VEE","SAVECHAR",$J,"CHAR",YND,CHAR-1)) D LEFTON Q
"RTN","%ZVEMRP2",26,0)
 D LEFTOFF
"RTN","%ZVEMRP2",27,0)
 Q
"RTN","%ZVEMRP2",28,0)
 ;
"RTN","%ZVEMRP2",29,0)
LEFTON ;Add highlight character
"RTN","%ZVEMRP2",30,0)
 KILL MARK
"RTN","%ZVEMRP2",31,0)
 S ^TMP("VEE","SAVECHAR",$J)=$E(ND,CHAR)_TMP
"RTN","%ZVEMRP2",32,0)
 S ^TMP("VEE","SAVECHAR",$J,YND)=ND ;Used to clear highlighted chars
"RTN","%ZVEMRP2",33,0)
 S ^TMP("VEE","SAVECHAR",$J,"CHAR",YND,CHAR)=XCUR_"^"_YCUR
"RTN","%ZVEMRP2",34,0)
 W @VEE("RON")
"RTN","%ZVEMRP2",35,0)
 W $E(ND,CHAR)
"RTN","%ZVEMRP2",36,0)
 W @VEE("ROFF")
"RTN","%ZVEMRP2",37,0)
 S XCUR=XCUR-1
"RTN","%ZVEMRP2",38,0)
 S DX=XCUR X VEES("CRSR")
"RTN","%ZVEMRP2",39,0)
 ;
"RTN","%ZVEMRP2",40,0)
 ;D WRITE
"RTN","%ZVEMRP2",41,0)
 Q
"RTN","%ZVEMRP2",42,0)
 ;
"RTN","%ZVEMRP2",43,0)
LEFTOFF ;Remove highlight character
"RTN","%ZVEMRP2",44,0)
 ;
"RTN","%ZVEMRP2",45,0)
 KILL MARK
"RTN","%ZVEMRP2",46,0)
 S XCUR=XCUR-1
"RTN","%ZVEMRP2",47,0)
 S DX=XCUR X VEES("CRSR")
"RTN","%ZVEMRP2",48,0)
 S CHAR=(XCUR+1+(ND[$C(30)))
"RTN","%ZVEMRP2",49,0)
 ;
"RTN","%ZVEMRP2",50,0)
 S ^TMP("VEE","SAVECHAR",$J)=$E(TMP,1,$L(TMP)-1) ;Strip last char
"RTN","%ZVEMRP2",51,0)
 KILL ^TMP("VEE","SAVECHAR",$J,"CHAR",YND,CHAR)
"RTN","%ZVEMRP2",52,0)
 W $E(ND,CHAR)
"RTN","%ZVEMRP2",53,0)
 X VEES("CRSR")
"RTN","%ZVEMRP2",54,0)
 ;
"RTN","%ZVEMRP2",55,0)
 ;If MARK=1, next <AL> moves up a line
"RTN","%ZVEMRP2",56,0)
 I ND'[$C(30),XCUR=9 S MARK=1
"RTN","%ZVEMRP2",57,0)
 ;
"RTN","%ZVEMRP2",58,0)
 ;D WRITE
"RTN","%ZVEMRP2",59,0)
 Q
"RTN","%ZVEMRP2",60,0)
 ;
"RTN","%ZVEMRP2",61,0)
RIGHT ;Char highlight - cursor right
"RTN","%ZVEMRP2",62,0)
 NEW CHAR,ND,ND1,TAGL,TMP,TMP1
"RTN","%ZVEMRP2",63,0)
 ;
"RTN","%ZVEMRP2",64,0)
 Q:$$CHECK()
"RTN","%ZVEMRP2",65,0)
 ;
"RTN","%ZVEMRP2",66,0)
 S ND=$G(^TMP("VEE","IR"_VRRS,$J,YND))
"RTN","%ZVEMRP2",67,0)
 S ND1=$G(^(YND+1))
"RTN","%ZVEMRP2",68,0)
 Q:ND=" <> <> <>"
"RTN","%ZVEMRP2",69,0)
 ;
"RTN","%ZVEMRP2",70,0)
 ;If cursor is in line tag area, move it to start of line.
"RTN","%ZVEMRP2",71,0)
 S TAGL=$L($P(ND,$C(30),1))
"RTN","%ZVEMRP2",72,0)
 I ND[$C(30),XCUR<TAGL S (DX,XCUR)=(TAGL-1) X VEES("CRSR")
"RTN","%ZVEMRP2",73,0)
 ;
"RTN","%ZVEMRP2",74,0)
 ;Quit if at end of line.
"RTN","%ZVEMRP2",75,0)
 I XCUR+1>($L(ND)-(ND[$C(30))),ND1[$C(30)!(ND1=" <> <> <>") Q
"RTN","%ZVEMRP2",76,0)
 ;
"RTN","%ZVEMRP2",77,0)
 ;Move down a scrolled line
"RTN","%ZVEMRP2",78,0)
 I XCUR+1>($L(ND)-(ND[$C(30)))!($G(MARK)) D  ;End of main line
"RTN","%ZVEMRP2",79,0)
 . D DOWN^%ZVEMRE(1) ;...Move down a line
"RTN","%ZVEMRP2",80,0)
 . S (DX,XCUR)=$S($G(MARK):8,1:9) X VEES("CRSR")
"RTN","%ZVEMRP2",81,0)
 . S ND=$G(^TMP("VEE","IR"_VRRS,$J,YND)) ;...Reset ND
"RTN","%ZVEMRP2",82,0)
 ;
"RTN","%ZVEMRP2",83,0)
 ;Add character to saved string.
"RTN","%ZVEMRP2",84,0)
 S TMP=$G(^TMP("VEE","SAVECHAR",$J))
"RTN","%ZVEMRP2",85,0)
 S CHAR=(XCUR+1+(ND[$C(30)))
"RTN","%ZVEMRP2",86,0)
 I '$D(^TMP("VEE","SAVECHAR",$J,"CHAR",YND,CHAR+1)) D RIGHTON Q
"RTN","%ZVEMRP2",87,0)
 D RIGHTOFF
"RTN","%ZVEMRP2",88,0)
 Q
"RTN","%ZVEMRP2",89,0)
 ;
"RTN","%ZVEMRP2",90,0)
RIGHTON ;Add highlight character
"RTN","%ZVEMRP2",91,0)
 KILL MARK
"RTN","%ZVEMRP2",92,0)
 S ^TMP("VEE","SAVECHAR",$J)=TMP_$E(ND,CHAR)
"RTN","%ZVEMRP2",93,0)
 S ^TMP("VEE","SAVECHAR",$J,YND)=ND ;Used to clear highlighted chars
"RTN","%ZVEMRP2",94,0)
 S ^TMP("VEE","SAVECHAR",$J,"CHAR",YND,CHAR)=XCUR_"^"_YCUR
"RTN","%ZVEMRP2",95,0)
 W @VEE("RON")
"RTN","%ZVEMRP2",96,0)
 W $E(ND,CHAR)
"RTN","%ZVEMRP2",97,0)
 W @VEE("ROFF")
"RTN","%ZVEMRP2",98,0)
 S XCUR=XCUR+1
"RTN","%ZVEMRP2",99,0)
 S DX=XCUR X VEES("CRSR")
"RTN","%ZVEMRP2",100,0)
 ;
"RTN","%ZVEMRP2",101,0)
 ;D WRITE
"RTN","%ZVEMRP2",102,0)
 Q
"RTN","%ZVEMRP2",103,0)
 ;
"RTN","%ZVEMRP2",104,0)
RIGHTOFF ;Remove highlight character
"RTN","%ZVEMRP2",105,0)
 KILL MARK
"RTN","%ZVEMRP2",106,0)
 S XCUR=XCUR+1
"RTN","%ZVEMRP2",107,0)
 S DX=XCUR X VEES("CRSR")
"RTN","%ZVEMRP2",108,0)
 S CHAR=(XCUR+1+(ND[$C(30)))
"RTN","%ZVEMRP2",109,0)
 ;
"RTN","%ZVEMRP2",110,0)
 S ^TMP("VEE","SAVECHAR",$J)=$E(TMP,2,$L(TMP)) ;Strip last char
"RTN","%ZVEMRP2",111,0)
 KILL ^TMP("VEE","SAVECHAR",$J,"CHAR",YND,CHAR)
"RTN","%ZVEMRP2",112,0)
 W $E(ND,CHAR)
"RTN","%ZVEMRP2",113,0)
 X VEES("CRSR")
"RTN","%ZVEMRP2",114,0)
 ;
"RTN","%ZVEMRP2",115,0)
 ;If MARK=1, next <AR> moves down a line
"RTN","%ZVEMRP2",116,0)
 I ND[$C(30),XCUR=(VEE("IOM")-3) S MARK=1
"RTN","%ZVEMRP2",117,0)
 ;
"RTN","%ZVEMRP2",118,0)
 ;D WRITE
"RTN","%ZVEMRP2",119,0)
 Q
"RTN","%ZVEMRP2",120,0)
 ;
"RTN","%ZVEMRP2",121,0)
INSERT ;Insert code into current line
"RTN","%ZVEMRP2",122,0)
 NEW CD,I,KEY,ND,TAGL
"RTN","%ZVEMRP2",123,0)
 ;
"RTN","%ZVEMRP2",124,0)
 ;Disallow restore into line tag area.
"RTN","%ZVEMRP2",125,0)
 S ND=$G(^TMP("VEE","IR"_VRRS,$J,YND))
"RTN","%ZVEMRP2",126,0)
 I ND[$C(30) S TAGL=$L($P(ND,$C(30),1)) I XCUR<TAGL Q
"RTN","%ZVEMRP2",127,0)
 ;
"RTN","%ZVEMRP2",128,0)
 D HIGHOFF^%ZVEMRE ;..Highlight off
"RTN","%ZVEMRP2",129,0)
 S DX=XCUR,DY=YCUR X VEES("CRSR")
"RTN","%ZVEMRP2",130,0)
 ;
"RTN","%ZVEMRP2",131,0)
 S CD=$G(^%ZVEMS("E","SAVEVRR",$J,1))
"RTN","%ZVEMRP2",132,0)
 F I=1:1 S KEY=$E(CD,I) Q:KEY']""  W KEY D ^%ZVEMREA
"RTN","%ZVEMRP2",133,0)
 D HIGHON^%ZVEMRE ;...Highlite on
"RTN","%ZVEMRP2",134,0)
 S FLAGSAVE=1
"RTN","%ZVEMRP2",135,0)
 Q
"RTN","%ZVEMRP2",136,0)
 ;
"RTN","%ZVEMRP2",137,0)
DELETE ;Delete code from current line (<ESCX>).
"RTN","%ZVEMRP2",138,0)
 Q:'$D(^TMP("VEE","SAVECHAR",$J,"CHAR",YND))
"RTN","%ZVEMRP2",139,0)
 NEW CHAR,ND,ND1,VK,YNDHLD
"RTN","%ZVEMRP2",140,0)
 S VK="<BS>"
"RTN","%ZVEMRP2",141,0)
 S YND=""
"RTN","%ZVEMRP2",142,0)
 F  S YND=$O(^TMP("VEE","SAVECHAR",$J,"CHAR",YND),-1) Q:'YND  D  ;
"RTN","%ZVEMRP2",143,0)
 . S YNDHLD=YND
"RTN","%ZVEMRP2",144,0)
 . S ND=^TMP("VEE","IR"_VRRS,$J,YND)
"RTN","%ZVEMRP2",145,0)
 . S CHAR=""
"RTN","%ZVEMRP2",146,0)
 . F  S CHAR=$O(^TMP("VEE","SAVECHAR",$J,"CHAR",YND,CHAR),-1) Q:'CHAR  D  ;
"RTN","%ZVEMRP2",147,0)
 .. S ND1=^(CHAR)
"RTN","%ZVEMRP2",148,0)
 .. S (DX,XCUR)=($P(ND1,"^",1)+1)
"RTN","%ZVEMRP2",149,0)
 .. S (DY,YCUR)=$P(ND1,"^",2)
"RTN","%ZVEMRP2",150,0)
 .. X VEES("CRSR")
"RTN","%ZVEMRP2",151,0)
 .. D ^%ZVEMREB
"RTN","%ZVEMRP2",152,0)
 .. S YND=YNDHLD ;...Reset YND after call to ^%ZVEMREB
"RTN","%ZVEMRP2",153,0)
 S YND=YNDHLD ;Get last value of YND
"RTN","%ZVEMRP2",154,0)
 D REDRAW^%ZVEMRU(YND)
"RTN","%ZVEMRP2",155,0)
 X VEES("CRSR")
"RTN","%ZVEMRP2",156,0)
 S FLAGSAVE=1
"RTN","%ZVEMRP2",157,0)
 Q
"RTN","%ZVEMRP2",158,0)
 ;
"RTN","%ZVEMRP2",159,0)
CHECK() ;
"RTN","%ZVEMRP2",160,0)
 I '$D(^TMP("VEE","SAVE",$J))  Q 0
"RTN","%ZVEMRP2",161,0)
 S FLAGMODE=0
"RTN","%ZVEMRP2",162,0)
 D CLEARALL^%ZVEMRP
"RTN","%ZVEMRP2",163,0)
 D MODEOFF^%ZVEMRU("BLOCK")
"RTN","%ZVEMRP2",164,0)
 Q 1
"RTN","%ZVEMRP2",165,0)
 ;
"RTN","%ZVEMRP2",166,0)
WRITE(TXT) ;Display contents of clipboard - for testing purposes.
"RTN","%ZVEMRP2",167,0)
 NEW DXHLD,DYHLD
"RTN","%ZVEMRP2",168,0)
 S DXHLD=DX,DYHLD=DY
"RTN","%ZVEMRP2",169,0)
 S DX=1,DY=15 X VEES("CRSR")
"RTN","%ZVEMRP2",170,0)
 W "|"_TXT_"|"
"RTN","%ZVEMRP2",171,0)
 S DX=DXHLD,DY=DYHLD X VEES("CRSR")
"RTN","%ZVEMRP2",172,0)
 Q
"RTN","%ZVEMRS")
0^126^B14888231
"RTN","%ZVEMRS",1,0)
%ZVEMRS ;DJB,VRR**Get Program ; 9/24/02 7:18am
"RTN","%ZVEMRS",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMRS",3,0)
 ;
"RTN","%ZVEMRS",4,0)
EN ;Enter here from ^%ZVEMR
"RTN","%ZVEMRS",5,0)
 I FLAGVPE["LBRY" D  Q  ;Use editor to review a previous version.
"RTN","%ZVEMRS",6,0)
 . S VRRPGM=%1
"RTN","%ZVEMRS",7,0)
 . D REVIEW2^%ZVEMRLY
"RTN","%ZVEMRS",8,0)
 D HD
"RTN","%ZVEMRS",9,0)
 D GETPGM G:FLAGQ EX
"RTN","%ZVEMRS",10,0)
 D SETGLB^%ZVEMRS1
"RTN","%ZVEMRS",11,0)
 S:$G(FLAGPRM)=1 FLAGPRM="VRR"
"RTN","%ZVEMRS",12,0)
EX ;
"RTN","%ZVEMRS",13,0)
 Q
"RTN","%ZVEMRS",14,0)
 ;
"RTN","%ZVEMRS",15,0)
GETPGM ;
"RTN","%ZVEMRS",16,0)
 I $G(FLAGPRM)=1 S VRRPGM=%1 G GETPGM1
"RTN","%ZVEMRS",17,0)
 NEW RTN
"RTN","%ZVEMRS",18,0)
 S RTN=$G(^%ZVEMS("E","VRR",DUZ))
"RTN","%ZVEMRS",19,0)
 ; Next: If RTN doesn't exist it shouldn't be the default routine
"RTN","%ZVEMRS",20,0)
 I RTN]"",'$$EXIST^%ZVEMKU(RTN) S RTN="" KILL ^%ZVEMS("E","VRR",DUZ)
"RTN","%ZVEMRS",21,0)
 I $G(VEESHL)="RUN" D  G:VRRPGM?1"<".E1">" GETPGM G GETPGM1
"RTN","%ZVEMRS",22,0)
 . S VRRPGM=$$CLHEDIT^%ZVEMSCL("VRR","Select ROUTINE: "_$S(RTN]"":RTN_"//",1:"")) S:VRRPGM="" VRRPGM=RTN S:VRRPGM=" " VRRPGM="^"
"RTN","%ZVEMRS",23,0)
 W !?1,"Select ROUTINE: ",$S(RTN]"":RTN_"//",1:"")
"RTN","%ZVEMRS",24,0)
 R VRRPGM:VEE("TIME") S:'$T!(VRRPGM=" ") VRRPGM="^" S:VRRPGM="" VRRPGM=RTN
"RTN","%ZVEMRS",25,0)
GETPGM1 ;Come here when passing a parameter
"RTN","%ZVEMRS",26,0)
 NEW CHK,I
"RTN","%ZVEMRS",27,0)
 I "^"[VRRPGM S FLAGQ=1 Q
"RTN","%ZVEMRS",28,0)
 S:VRRPGM["^" VRRPGM=$P(VRRPGM,"^",2) S:VRRPGM["(" VRRPGM=$P(VRRPGM,"(")
"RTN","%ZVEMRS",29,0)
 I VRRPGM="?" D HELP G GETPGM
"RTN","%ZVEMRS",30,0)
 I VRRPGM="??" D LIST KILL ^UTILITY($J) W ! G GETPGM
"RTN","%ZVEMRS",31,0)
 I VRRPGM'?.1"%"1A.7AN D MSG1 G GETPGM
"RTN","%ZVEMRS",32,0)
 I $D(^%ZVEMS("E")),VRRS=1 S ^%ZVEMS("E","VRR",DUZ)=VRRPGM
"RTN","%ZVEMRS",33,0)
 ;
"RTN","%ZVEMRS",34,0)
 ;--> Next lines check to see if anyone else is editing this routine.
"RTN","%ZVEMRS",35,0)
 Q:$G(FLAGVPE)'["EDIT"
"RTN","%ZVEMRS",36,0)
 S CHK=0 F I=1:1 Q:'$D(^TMP("VEE","VRR",$J,I,"NAME"))  D  ;
"RTN","%ZVEMRS",37,0)
 . I ^("NAME")=VRRPGM S CHK=1
"RTN","%ZVEMRS",38,0)
 Q:CHK
"RTN","%ZVEMRS",39,0)
 ;
"RTN","%ZVEMRS",40,0)
 L +VRRLOCK(VRRPGM):0 E  D  Q
"RTN","%ZVEMRS",41,0)
 . S FLAGQ=1
"RTN","%ZVEMRS",42,0)
 . I $G(FLAG("<ESC>R")) W @VEE("IOF")
"RTN","%ZVEMRS",43,0)
 . W $C(7),!!?5,"This program is currently being edited. Try later.",!
"RTN","%ZVEMRS",44,0)
 . D PAUSE^%ZVEMKU(2,"P")
"RTN","%ZVEMRS",45,0)
 Q
"RTN","%ZVEMRS",46,0)
 ;
"RTN","%ZVEMRS",47,0)
LIST ;List routines
"RTN","%ZVEMRS",48,0)
 KILL ^UTILITY($J)
"RTN","%ZVEMRS",49,0)
 D @$S($D(^%ZOSF("RSEL")):"ZOSF^%ZVEMRUS",1:VEE("OS")_"^%ZVEMRUS") Q:$O(^UTILITY($J,""))=""
"RTN","%ZVEMRS",50,0)
LIST1 R !!?1,"Select [B]lock or [L]ist: L// ",VEEX:VEE("TIME") S:'$T VEEX="^" S:VEEX="" VEEX="L" I VEEX="^" Q
"RTN","%ZVEMRS",51,0)
 I VEEX="?" W "   Enter 'B' or 'L'" G LIST1
"RTN","%ZVEMRS",52,0)
 I ",B,b,L,l,"'[(","_VEEX_",") W $C(7),"   ??" G LIST1
"RTN","%ZVEMRS",53,0)
 S VEEX=$S(VEEX="b":"B",VEEX="l":"L",1:VEEX)
"RTN","%ZVEMRS",54,0)
 D @$S(VEEX="B":"LISTB",VEEX="L":"LISTL",1:"")
"RTN","%ZVEMRS",55,0)
 Q
"RTN","%ZVEMRS",56,0)
 ;
"RTN","%ZVEMRS",57,0)
LISTB ;Block list of programs, 8 to a line, 5 lines at a time
"RTN","%ZVEMRS",58,0)
 NEW CNT,COL,FLAGQ,I,X
"RTN","%ZVEMRS",59,0)
 S (CNT,FLAGQ,X)=0,COL=1 W !
"RTN","%ZVEMRS",60,0)
 F I=1:1 S X=$O(^UTILITY($J,X)) Q:X=""  W:COL=1 ! W ?COL,X S COL=COL+10 I COL>75 D  Q:FLAGQ
"RTN","%ZVEMRS",61,0)
 . S COL=1,CNT=CNT+1 I CNT#5=0 D PAUSEQ^%ZVEMKC(2) W !
"RTN","%ZVEMRS",62,0)
 D:I=1 MSG1 W:I>1 !
"RTN","%ZVEMRS",63,0)
 Q
"RTN","%ZVEMRS",64,0)
 ;
"RTN","%ZVEMRS",65,0)
LISTL ;List top line of selected programs
"RTN","%ZVEMRS",66,0)
 NEW CNT,FLAGQ,RTN
"RTN","%ZVEMRS",67,0)
 S (FLAGQ,RTN)=0 W @VEE("IOF")
"RTN","%ZVEMRS",68,0)
 F CNT=1:1 S RTN=$O(^UTILITY($J,RTN)) Q:RTN=""  D  Q:FLAGQ
"RTN","%ZVEMRS",69,0)
 . W !,$J(CNT,3),". ",RTN,?14,$E($P($T(^@RTN)," ",2,99),1,65)
"RTN","%ZVEMRS",70,0)
 . I $Y>VEESIZE D PAUSEQ^%ZVEMKC(2) Q:FLAGQ  W @VEE("IOF"),!
"RTN","%ZVEMRS",71,0)
 Q
"RTN","%ZVEMRS",72,0)
 ;
"RTN","%ZVEMRS",73,0)
MSG ;Messages
"RTN","%ZVEMRS",74,0)
MSG1 W $C(7),!,"Invalid Program"
"RTN","%ZVEMRS",75,0)
 Q
"RTN","%ZVEMRS",76,0)
HELP ;Help text
"RTN","%ZVEMRS",77,0)
 W !!?5,"Enter a routine name, or <RETURN> to select default routine."
"RTN","%ZVEMRS",78,0)
 W !?5,"Enter '??' to display routine names in one of the following forms:"
"RTN","%ZVEMRS",79,0)
 W !!?10,"BLOCK.....Routines listed 8 to a line, 5 lines at a time."
"RTN","%ZVEMRS",80,0)
 W !?10,"LIST......Lists top line of each selected routine.",!
"RTN","%ZVEMRS",81,0)
 Q
"RTN","%ZVEMRS",82,0)
HD ;Heading
"RTN","%ZVEMRS",83,0)
 Q:$G(%1)]""  ;Don't display heading when parameter passing
"RTN","%ZVEMRS",84,0)
 Q:VRRS>1  ;Don't display heading when branching to another program
"RTN","%ZVEMRS",85,0)
 W !?1,"Victory Routine ",$S($G(FLAGVPE)["EDIT":"Editor",1:"Reader")," . . . . . . . . . . . . . . . . . . . . . David Bolduc"
"RTN","%ZVEMRS",86,0)
 W !?1,"^=Quit   <RETURN>=DefaultRtn   ?=Help   ??=RtnList",!
"RTN","%ZVEMRS",87,0)
 Q
"RTN","%ZVEMRS1")
0^127^B2657927
"RTN","%ZVEMRS1",1,0)
%ZVEMRS1 ;DJB,VRR**Set Scroll Array ; 9/5/02 3:13pm
"RTN","%ZVEMRS1",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMRS1",3,0)
 ;
"RTN","%ZVEMRS1",4,0)
SETGLB ;Put routine into global
"RTN","%ZVEMRS1",5,0)
 NEW I,TXT
"RTN","%ZVEMRS1",6,0)
 KILL ^TMP("VEE","VRR",$J,VRRS)
"RTN","%ZVEMRS1",7,0)
 KILL ^TMP("VEE","IR"_VRRS,$J)
"RTN","%ZVEMRS1",8,0)
 KILL ^TMP("VEE",$J)
"RTN","%ZVEMRS1",9,0)
 S ^TMP("VEE","VRR",$J,VRRS,"NAME")=VRRPGM
"RTN","%ZVEMRS1",10,0)
 I $G(VEESHL)="RUN" D CLHSET^%ZVEMSCL("VRR",VRRPGM) ;Cmnd Ln History
"RTN","%ZVEMRS1",11,0)
 I '$$EXIST^%ZVEMKU(VRRPGM) S VRRHIGH=0 Q
"RTN","%ZVEMRS1",12,0)
 X "F I=1:1 S TXT=$T(+I^"_VRRPGM_") Q:TXT=""""  S TXT=$P(TXT,"" "")_$C(9)_$P(TXT,"" "",2,999),^TMP(""VEE"",$J,I)=TXT"
"RTN","%ZVEMRS1",13,0)
 D SET
"RTN","%ZVEMRS1",14,0)
 KILL ^TMP("VEE",$J)
"RTN","%ZVEMRS1",15,0)
 Q
"RTN","%ZVEMRS1",16,0)
SET ;
"RTN","%ZVEMRS1",17,0)
 NEW CODE,CNT,END,END1,LINE,LN,TG,X
"RTN","%ZVEMRS1",18,0)
 S CNT=1,X=0
"RTN","%ZVEMRS1",19,0)
 F  S X=$O(^TMP("VEE",$J,X)) Q:X'>0  S CODE=^(X) D SET1
"RTN","%ZVEMRS1",20,0)
 S ^TMP("VEE","IR"_VRRS,$J,CNT)=" <> <> <>"
"RTN","%ZVEMRS1",21,0)
 Q
"RTN","%ZVEMRS1",22,0)
SET1 ;Set scroll array
"RTN","%ZVEMRS1",23,0)
 S VRRHIGH=X
"RTN","%ZVEMRS1",24,0)
 S TG=$P(CODE,$C(9)),LN=$P(CODE,$C(9),2,999)
"RTN","%ZVEMRS1",25,0)
 S (END,END1)=VEE("IOM")-11
"RTN","%ZVEMRS1",26,0)
 I $L(TG)>8 S END1=END1-($L(TG)-8)
"RTN","%ZVEMRS1",27,0)
 S TXT=$S(TG]"":$J("",8-$L(TG))_TG,1:X_$J("",8-$L(X))) ;Ln number
"RTN","%ZVEMRS1",28,0)
 S TXT=TXT_" "_$C(30)_$E(LN,1,END1)
"RTN","%ZVEMRS1",29,0)
 S ^TMP("VEE","IR"_VRRS,$J,CNT)=TXT,CNT=CNT+1
"RTN","%ZVEMRS1",30,0)
 S LN=$E(LN,(END1+1),999) Q:LN']""  F  D  Q:LN=""
"RTN","%ZVEMRS1",31,0)
 . S TXT=$J("",9)_$E(LN,1,END)
"RTN","%ZVEMRS1",32,0)
 . S LN=$E(LN,(END+1),999)
"RTN","%ZVEMRS1",33,0)
 . S ^TMP("VEE","IR"_VRRS,$J,CNT)=TXT,CNT=CNT+1
"RTN","%ZVEMRS1",34,0)
 Q
"RTN","%ZVEMRSS")
0^128^B37014762
"RTN","%ZVEMRSS",1,0)
%ZVEMRSS ;DJB,VRR**Rtn String Search ; 1/8/01 8:43am
"RTN","%ZVEMRSS",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMRSS",3,0)
 ;
"RTN","%ZVEMRSS",4,0)
 NEW ASK,CNT,EXCLUDE,FLAGEDT,FLAGQ,QUIT,STRING
"RTN","%ZVEMRSS",5,0)
 NEW CODE1,CODE2,CODE3,CODE4
"RTN","%ZVEMRSS",6,0)
 D INIT
"RTN","%ZVEMRSS",7,0)
TOP ;
"RTN","%ZVEMRSS",8,0)
 D SELECT^%ZVEMRUS G:$O(^UTILITY($J," "))="" EX
"RTN","%ZVEMRSS",9,0)
 S (FLAGEDT,FLAGQ)=0
"RTN","%ZVEMRSS",10,0)
 D STRG G:'$D(STRING(1))!FLAGQ TOP
"RTN","%ZVEMRSS",11,0)
 D EXCLUDE
"RTN","%ZVEMRSS",12,0)
 D LIST
"RTN","%ZVEMRSS",13,0)
 G TOP
"RTN","%ZVEMRSS",14,0)
EX ;
"RTN","%ZVEMRSS",15,0)
 KILL ^UTILITY($J)
"RTN","%ZVEMRSS",16,0)
 Q
"RTN","%ZVEMRSS",17,0)
 ;
"RTN","%ZVEMRSS",18,0)
STRG ;Get Search String
"RTN","%ZVEMRSS",19,0)
 NEW CD
"RTN","%ZVEMRSS",20,0)
 KILL STRING
"RTN","%ZVEMRSS",21,0)
 S CNT("STR")=0
"RTN","%ZVEMRSS",22,0)
 W !
"RTN","%ZVEMRSS",23,0)
STRG1 W !,"Enter SEARCH STRING "_(CNT("STR")+1)_": "
"RTN","%ZVEMRSS",24,0)
 R CD:300 I "^"[CD S:CD="^" FLAGQ=1 Q
"RTN","%ZVEMRSS",25,0)
 I "??"[CD D HELP G:ASK'="S" STRG1
"RTN","%ZVEMRSS",26,0)
 S CNT("STR")=CNT("STR")+1
"RTN","%ZVEMRSS",27,0)
 S STRING(CNT("STR"))=CD
"RTN","%ZVEMRSS",28,0)
 I CNT("STR")=1,"=<>"[$E(CD),CD?1E1.2N1"/"1.2N1"/"1.2N D  Q
"RTN","%ZVEMRSS",29,0)
 . S FLAGEDT=$E(CD) ;...Find rtns by edit date: =<> Date
"RTN","%ZVEMRSS",30,0)
 G STRG1
"RTN","%ZVEMRSS",31,0)
 ;
"RTN","%ZVEMRSS",32,0)
EXCLUDE ;Get Exclude String.
"RTN","%ZVEMRSS",33,0)
 NEW CD
"RTN","%ZVEMRSS",34,0)
 KILL EXCLUDE
"RTN","%ZVEMRSS",35,0)
 S CNT("EXC")=0
"RTN","%ZVEMRSS",36,0)
 Q:CNT("STR")>1  ;..Quit if more than 1 Search String
"RTN","%ZVEMRSS",37,0)
 Q:FLAGEDT?1P  ;....Quit if doing an Edit Date type search
"RTN","%ZVEMRSS",38,0)
 W !
"RTN","%ZVEMRSS",39,0)
EXCLUDE1 W !,"Enter EXCLUDE STRING "_(CNT("EXC")+1)_": "
"RTN","%ZVEMRSS",40,0)
 R CD:300 Q:"^"[CD
"RTN","%ZVEMRSS",41,0)
 I "??"[CD D HELP1 G:ASK'="E" EXCLUDE1
"RTN","%ZVEMRSS",42,0)
 S CNT("EXC")=CNT("EXC")+1
"RTN","%ZVEMRSS",43,0)
 S EXCLUDE(CNT("EXC"))=CD
"RTN","%ZVEMRSS",44,0)
 G EXCLUDE1
"RTN","%ZVEMRSS",45,0)
 ;
"RTN","%ZVEMRSS",46,0)
LIST ;List routines
"RTN","%ZVEMRSS",47,0)
 NEW CHKE,CHKS,COL,EXC,FLAGA,I,I1,I2,I3,NUMR,NUMS,RTN,TIC,TXT
"RTN","%ZVEMRSS",48,0)
 S (FLAGA,FLAGQ,NUMR,NUMS,TIC)=0
"RTN","%ZVEMRSS",49,0)
 S COL=1
"RTN","%ZVEMRSS",50,0)
 W !
"RTN","%ZVEMRSS",51,0)
 S RTN=" "
"RTN","%ZVEMRSS",52,0)
 F I=1:1 S RTN=$O(^UTILITY($J,RTN)) Q:RTN=""!FLAGQ  D  ;
"RTN","%ZVEMRSS",53,0)
 . I FLAGEDT?1P D FINDEDIT Q
"RTN","%ZVEMRSS",54,0)
 . W !,RTN,"  "
"RTN","%ZVEMRSS",55,0)
 . X "ZL @RTN X CODE1"
"RTN","%ZVEMRSS",56,0)
 . S NUMR=NUMR+1 S:TIC NUMS=NUMS+1 W:TIC ! S TIC=0
"RTN","%ZVEMRSS",57,0)
 W !!?1,$J(NUMR,4)
"RTN","%ZVEMRSS",58,0)
 W " Routine",$S(NUMR=1:" ",1:"s "),"searched."
"RTN","%ZVEMRSS",59,0)
 W !?1,$J(NUMS,4)
"RTN","%ZVEMRSS",60,0)
 W " Routine",$S(NUMS=1:" ",1:"s "),"contained search string(s)."
"RTN","%ZVEMRSS",61,0)
 Q
"RTN","%ZVEMRSS",62,0)
 ;
"RTN","%ZVEMRSS",63,0)
FINDEDIT ;Find rtns edited before/after/on a certain date
"RTN","%ZVEMRSS",64,0)
 NEW CHK,DATE,I,RTNDATE,TXT
"RTN","%ZVEMRSS",65,0)
 ;
"RTN","%ZVEMRSS",66,0)
 X "ZL @RTN S TXT=$T(+1)"
"RTN","%ZVEMRSS",67,0)
 D  Q:$G(RTNDATE)']""
"RTN","%ZVEMRSS",68,0)
 . ;Old format: [6/1/99 8:40pm]
"RTN","%ZVEMRSS",69,0)
 . I TXT[" [" S RTNDATE=$P(TXT," [",$L(TXT," [")) Q
"RTN","%ZVEMRSS",70,0)
 . ;New format: ; 7/2/99 12:49pm
"RTN","%ZVEMRSS",71,0)
 . I TXT["; " S RTNDATE=$P(TXT,"; ",$L(TXT,"; ")) Q
"RTN","%ZVEMRSS",72,0)
 S RTNDATE=$P(RTNDATE," ",1) ;............Date rtn last edited
"RTN","%ZVEMRSS",73,0)
 S DATE=$E(STRING(1),2,99) ;..............Date being searched for
"RTN","%ZVEMRSS",74,0)
 ;
"RTN","%ZVEMRSS",75,0)
 F I=1:1:3 S RTNDATE(I)=+$P(RTNDATE,"/",I)
"RTN","%ZVEMRSS",76,0)
 F I=1:1:3 S DATE(I)=+$P(DATE,"/",I)
"RTN","%ZVEMRSS",77,0)
 ;
"RTN","%ZVEMRSS",78,0)
 ;If year is less than 40, add 100.
"RTN","%ZVEMRSS",79,0)
 I RTNDATE(3)<40 S RTNDATE(3)=100+RTNDATE(3)
"RTN","%ZVEMRSS",80,0)
 I DATE(3)<40 S DATE(3)=100+DATE(3)
"RTN","%ZVEMRSS",81,0)
 ;
"RTN","%ZVEMRSS",82,0)
 S NUMR=NUMR+1,CHK=0
"RTN","%ZVEMRSS",83,0)
 I FLAGEDT="=",RTNDATE'=DATE Q  ;.........Equals
"RTN","%ZVEMRSS",84,0)
 ; 1=Month 2=Day 3=Year
"RTN","%ZVEMRSS",85,0)
 I FLAGEDT=">" D  Q:CHK  ;................Greater Than
"RTN","%ZVEMRSS",86,0)
 . I RTNDATE(3)<DATE(3) S CHK=1 Q
"RTN","%ZVEMRSS",87,0)
 . I RTNDATE(3)=DATE(3),RTNDATE(1)<DATE(1) S CHK=1 Q
"RTN","%ZVEMRSS",88,0)
 . I RTNDATE(1)=DATE(1),RTNDATE(2)'>DATE(2) S CHK=1 Q
"RTN","%ZVEMRSS",89,0)
 I FLAGEDT="<" D  Q:CHK  ;................Less Than
"RTN","%ZVEMRSS",90,0)
 . I RTNDATE(3)>DATE(3) S CHK=1 Q
"RTN","%ZVEMRSS",91,0)
 . I RTNDATE(3)=DATE(3),RTNDATE(1)>DATE(1) S CHK=1 Q
"RTN","%ZVEMRSS",92,0)
 . I RTNDATE(1)=DATE(1),RTNDATE(2)'<DATE(2) S CHK=1 Q
"RTN","%ZVEMRSS",93,0)
 S NUMS=NUMS+1
"RTN","%ZVEMRSS",94,0)
 W:COL=1 ! W ?COL,RTN,?($X+(10-$L(RTN))) S COL=COL+30 S:COL>70 COL=1
"RTN","%ZVEMRSS",95,0)
 F I=1:1:3 W RTNDATE(I) W:I<3 "/"
"RTN","%ZVEMRSS",96,0)
 Q
"RTN","%ZVEMRSS",97,0)
 ;
"RTN","%ZVEMRSS",98,0)
HELP ;User entered '?' at STRING prompt
"RTN","%ZVEMRSS",99,0)
 ;Return: ASK="S" if user wants to Search
"RTN","%ZVEMRSS",100,0)
 ;
"RTN","%ZVEMRSS",101,0)
 W ?25,"Do you want Help, or to Search for '"_CD_"'"
"RTN","%ZVEMRSS",102,0)
 W !?25,"Select [H]elp or [S]earch: "
"RTN","%ZVEMRSS",103,0)
 R ASK:300 Q:"^"[ASK  I "Ss"[$E(ASK) S ASK="S" Q
"RTN","%ZVEMRSS",104,0)
 W !!?3,"Enter any character string. The selected routines will be searched"
"RTN","%ZVEMRSS",105,0)
 W !?3,"and any line containing the string will be displayed. You may"
"RTN","%ZVEMRSS",106,0)
 W !?3,"enter more than 1 search string.",!
"RTN","%ZVEMRSS",107,0)
 W !?3,"Whenever the display stops at a program line that contains a"
"RTN","%ZVEMRSS",108,0)
 W !?3,"string, you may enter <RETURN> to contine, '^' to quit, '?' for"
"RTN","%ZVEMRSS",109,0)
 W !?3,"Help, or 'A' for Autoprint. When Autoprint is active, the display"
"RTN","%ZVEMRSS",110,0)
 W !?3,"will not stop at each line containing a string."
"RTN","%ZVEMRSS",111,0)
 W !!?3,"If you use ..E as your editor, you can find routines that have been"
"RTN","%ZVEMRSS",112,0)
 W !?3,"edited before/after/on a certain date: Before: <1/2/95"
"RTN","%ZVEMRSS",113,0)
 W !?3,"                                       After.: >1/2/95"
"RTN","%ZVEMRSS",114,0)
 W !?3,"                                       On....: =1/2/95",!
"RTN","%ZVEMRSS",115,0)
 Q
"RTN","%ZVEMRSS",116,0)
HELP1 ;User entered '?' at EXCLUDE prompt
"RTN","%ZVEMRSS",117,0)
 ;Return: ASK="E" if user wants to Exclude
"RTN","%ZVEMRSS",118,0)
 ;
"RTN","%ZVEMRSS",119,0)
 W ?25,"Do you want Help, or to Exclude '"_EXCLUDE_"'"
"RTN","%ZVEMRSS",120,0)
 W !?25,"Select [H]elp or [E]xclude: "
"RTN","%ZVEMRSS",121,0)
 R ASK:300 Q:"^"[ASK  I "Ee"[$E(ASK) S ASK="E" Q
"RTN","%ZVEMRSS",122,0)
 W !!?3,"Enter any character string. Any lines that contain the SEARCH STRING"
"RTN","%ZVEMRSS",123,0)
 W !?3,"will be checked to see if they also contain the EXCLUDE STRING. If they"
"RTN","%ZVEMRSS",124,0)
 W !?3,"do, they may be rejected. For example: If a line of code like 'AB,AB1,YY2'"
"RTN","%ZVEMRSS",125,0)
 W !?3,"is searched for YY excluding YY2, it WON'T pass the search. If it is"
"RTN","%ZVEMRSS",126,0)
 W !?3,"searched for AB excluding AB1, it WILL pass the search."
"RTN","%ZVEMRSS",127,0)
 W !!?3,"You will not be prompted for an EXCLUDE STRING if there is more than"
"RTN","%ZVEMRSS",128,0)
 W !?3,"one SEARCH STRING.",!
"RTN","%ZVEMRSS",129,0)
 Q
"RTN","%ZVEMRSS",130,0)
INIT ;
"RTN","%ZVEMRSS",131,0)
 ;Check each line of rtn to see if it contains STRING array.
"RTN","%ZVEMRSS",132,0)
 ;FLAGA=AutoPrint active
"RTN","%ZVEMRSS",133,0)
 S CODE1="F I1=1:1 S TXT=$T(+I1) Q:TXT=""""!FLAGQ  F I2=1:1:CNT(""STR"") I TXT[STRING(I2) S CHKS=1 X CODE2 I CHKS W !!,RTN,""+"",I1-1,"" -->"",TXT S TIC=1 X:'FLAGA CODE4 Q"
"RTN","%ZVEMRSS",134,0)
 ;
"RTN","%ZVEMRSS",135,0)
 ;Does any part of line surrounding EXCLUDE, contain STRING?
"RTN","%ZVEMRSS",136,0)
 S CODE2="S CHKE=0 X CODE3 Q:'CHKE  S (CHKS,EXC)=0 F  S EXC=$O(EXCLUDE(EXC)) Q:'EXC!CHKS  F I3=1:1:$F(TXT,EXCLUDE(EXC)) I $P(TXT,EXCLUDE(EXC),I3)[STRING(I2) S CHKS=1 Q"
"RTN","%ZVEMRSS",137,0)
 ;
"RTN","%ZVEMRSS",138,0)
 ;See if line that contains STRING also contains EXCLUDE.
"RTN","%ZVEMRSS",139,0)
 S CODE3="S EXC=0 F  S EXC=$O(EXCLUDE(EXC)) Q:'EXC!CHKE  I TXT[EXCLUDE(EXC) S CHKE=1"
"RTN","%ZVEMRSS",140,0)
 ;
"RTN","%ZVEMRSS",141,0)
 S CODE4="R ASK:300 S:ASK=""a"" ASK=""A"" R:""^,A""'[ASK !!?2,""<RETURN>=Continue  ^=Quit  A=AutoPrint"",!?2,""Select: "",ASK:300 S:ASK[""^"" FLAGQ=1 S:ASK=""A"" FLAGA=1"
"RTN","%ZVEMRSS",142,0)
 Q
"RTN","%ZVEMRU")
0^129^B12383017
"RTN","%ZVEMRU",1,0)
%ZVEMRU ;DJB,VRR**Utilities ; 1/6/01 8:12am
"RTN","%ZVEMRU",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMRU",3,0)
 ;
"RTN","%ZVEMRU",4,0)
LNSTART(CD) ;Find start of line for EDIT mode.
"RTN","%ZVEMRU",5,0)
 ;"2^11" - TAG starts at 2, LINE starts at 11
"RTN","%ZVEMRU",6,0)
 I CD[$C(30) Q $$TAGSTART(CD)
"RTN","%ZVEMRU",7,0)
 Q "10^10"
"RTN","%ZVEMRU",8,0)
 ;
"RTN","%ZVEMRU",9,0)
TAGSTART(CD) ;Find start of tag
"RTN","%ZVEMRU",10,0)
 NEW L,START,TAG
"RTN","%ZVEMRU",11,0)
 S TAG=$P(CD,$C(30),1),L=$L(TAG)
"RTN","%ZVEMRU",12,0)
 I TAG?1.N1." "!(TAG?1." ") Q "11^11"
"RTN","%ZVEMRU",13,0)
 F START=1:1 Q:$E(TAG)'=" "  S TAG=$E(TAG,2,999)
"RTN","%ZVEMRU",14,0)
 Q START_"^"_(L+2)
"RTN","%ZVEMRU",15,0)
 ;
"RTN","%ZVEMRU",16,0)
LNSTART1(CD) ;Find start of line for INSERT mode
"RTN","%ZVEMRU",17,0)
 NEW START,TAG
"RTN","%ZVEMRU",18,0)
 S START=9,TAG=$P(CD,$C(30),1)
"RTN","%ZVEMRU",19,0)
 I CD'[$C(30) Q START
"RTN","%ZVEMRU",20,0)
 I +TAG>0 Q START
"RTN","%ZVEMRU",21,0)
 I $L(TAG)'>9 Q START
"RTN","%ZVEMRU",22,0)
 Q START+($L(TAG)-9)
"RTN","%ZVEMRU",23,0)
 ;
"RTN","%ZVEMRU",24,0)
XCHARADD(CD) ;Adjust XCHAR for $C(30) - When adding code
"RTN","%ZVEMRU",25,0)
 ;XCUR=$L(CD)-1 because $X starts with zero.
"RTN","%ZVEMRU",26,0)
 ;--> If XCUR is left of $C(30) XCHAR=XCUR+1. Else XCHAR=XCUR+2.
"RTN","%ZVEMRU",27,0)
 I CD'[$C(30) Q (XCUR+1)
"RTN","%ZVEMRU",28,0)
 ;--> Cursor is in space between tag and line
"RTN","%ZVEMRU",29,0)
 I XCUR+2=$F(CD,$C(30)) Q (XCUR+1)
"RTN","%ZVEMRU",30,0)
 I XCUR+1'<$F(CD,$C(30)) Q (XCUR+2)
"RTN","%ZVEMRU",31,0)
 Q (XCUR+1)
"RTN","%ZVEMRU",32,0)
 ;
"RTN","%ZVEMRU",33,0)
XCHARDEL(CD) ;Adjust XCHAR for $C(30) - When deleting code
"RTN","%ZVEMRU",34,0)
 I CD'[$C(30) Q (XCUR+1)
"RTN","%ZVEMRU",35,0)
 ;--> Cursor is in space between tag and line
"RTN","%ZVEMRU",36,0)
 I XCUR+2'<$F(CD,$C(30)) Q (XCUR+2)
"RTN","%ZVEMRU",37,0)
 Q (XCUR+1)
"RTN","%ZVEMRU",38,0)
 ;
"RTN","%ZVEMRU",39,0)
LINENUM(ND) ;Get line number for new code. ND=Scroll array node
"RTN","%ZVEMRU",40,0)
 I $G(ND)'>0 Q 1
"RTN","%ZVEMRU",41,0)
 NEW NUM,X S NUM=1,X=0
"RTN","%ZVEMRU",42,0)
 F  S X=$O(^TMP("VEE","IR"_VRRS,$J,X)) D  Q:X=ND
"RTN","%ZVEMRU",43,0)
 . I ^(X)[$C(30) S NUM=NUM+1
"RTN","%ZVEMRU",44,0)
 Q NUM
"RTN","%ZVEMRU",45,0)
 ;
"RTN","%ZVEMRU",46,0)
GETNODE(LN) ;Convert a line number to an array node. LN=Line #
"RTN","%ZVEMRU",47,0)
 NEW ND,NM,X
"RTN","%ZVEMRU",48,0)
 S (ND,NM,X)=0
"RTN","%ZVEMRU",49,0)
 F  S X=$O(^TMP("VEE","IR"_VRRS,$J,X)) Q:^(X)=" <> <> <>"  D  Q:NM=LN
"RTN","%ZVEMRU",50,0)
 . S ND=ND+1
"RTN","%ZVEMRU",51,0)
 . I ^(X)[$C(30) S NM=NM+1
"RTN","%ZVEMRU",52,0)
 I X']"" Q 0
"RTN","%ZVEMRU",53,0)
 I ^(X)=" <> <> <>" Q 0
"RTN","%ZVEMRU",54,0)
 Q ND
"RTN","%ZVEMRU",55,0)
 ;==================================================================
"RTN","%ZVEMRU",56,0)
INSERT(DX,DY) ;Insert a line. Uses escape sequences not supported by MSM NT.
"RTN","%ZVEMRU",57,0)
 S DX=+$G(DX),DY=+$G(DY)
"RTN","%ZVEMRU",58,0)
 I $G(^%ZOSF("OS"))["MSM for Windows NT" D ZINSERT(DX,DY) Q
"RTN","%ZVEMRU",59,0)
 X VEES("CRSR") W @VEES("INDEX"),@VEES("INSRT")
"RTN","%ZVEMRU",60,0)
 I VEET("GAP") D  Q
"RTN","%ZVEMRU",61,0)
 . S VEET("GAP")=VEET("GAP")-1
"RTN","%ZVEMRU",62,0)
 S VEET("BOT")=VEET("BOT")-1
"RTN","%ZVEMRU",63,0)
 Q
"RTN","%ZVEMRU",64,0)
 ;
"RTN","%ZVEMRU",65,0)
ZINSERT(DX,DY) ;Insert a line. Don't use above escape sequences.
"RTN","%ZVEMRU",66,0)
 S DX=+$G(DX),DY=+$G(DY)+1 X VEES("CRSR")
"RTN","%ZVEMRU",67,0)
 W @VEES("BLANK_C_EOL") X VEES("XY")
"RTN","%ZVEMRU",68,0)
 I VEET("GAP") S VEET("GAP")=VEET("GAP")-1
"RTN","%ZVEMRU",69,0)
 E  S VEET("BOT")=VEET("BOT")-1
"RTN","%ZVEMRU",70,0)
 D REDRAW^%ZVEMREO(YND+1,VEET("BOT"))
"RTN","%ZVEMRU",71,0)
 S DX=0,DY=YCUR X VEES("CRSR")
"RTN","%ZVEMRU",72,0)
 Q
"RTN","%ZVEMRU",73,0)
 ;==================================================================
"RTN","%ZVEMRU",74,0)
REDRAW(YVAL) ;Adjust line count and redraw from YVAL to bottom of screen
"RTN","%ZVEMRU",75,0)
 Q:$G(YVAL)'>0
"RTN","%ZVEMRU",76,0)
 NEW I,FLAGQ,TMP
"RTN","%ZVEMRU",77,0)
 S FLAGQ=0
"RTN","%ZVEMRU",78,0)
 F I=YVAL:1 D  Q:FLAGQ
"RTN","%ZVEMRU",79,0)
 . S TMP=$G(^TMP("VEE","IR"_VRRS,$J,I))
"RTN","%ZVEMRU",80,0)
 . I I'<VEET("BOT") D  Q:FLAGQ
"RTN","%ZVEMRU",81,0)
 . . I 'VEET("GAP") S FLAGQ=1 Q
"RTN","%ZVEMRU",82,0)
 . . S VEET("BOT")=VEET("BOT")+1,VEET("GAP")=VEET("GAP")-1
"RTN","%ZVEMRU",83,0)
 . S DX=0,DY=I-VEET("TOP")+1
"RTN","%ZVEMRU",84,0)
 . X VEES("CRSR") W @VEES("BLANK_C_EOL") X VEES("XY")
"RTN","%ZVEMRU",85,0)
 . W $P(TMP,$C(30),1),$P(TMP,$C(30),2)
"RTN","%ZVEMRU",86,0)
 . I TMP=" <> <> <>" S FLAGQ=1 Q
"RTN","%ZVEMRU",87,0)
 D LINECNT
"RTN","%ZVEMRU",88,0)
 S DX=XCUR,DY=YCUR X VEES("CRSR")
"RTN","%ZVEMRU",89,0)
 Q
"RTN","%ZVEMRU",90,0)
 ;
"RTN","%ZVEMRU",91,0)
REDRAW1 ;Adjust line count and then redraw top & bottom of screen
"RTN","%ZVEMRU",92,0)
 D LINECNT,REDRAW^%ZVEMKT2(1)
"RTN","%ZVEMRU",93,0)
 Q
"RTN","%ZVEMRU",94,0)
 ;
"RTN","%ZVEMRU",95,0)
REDRAW2 ;Redraw screen with no adjustments
"RTN","%ZVEMRU",96,0)
 D REDRAW^%ZVEMKT2(1),REDRAW(VEET("TOP"))
"RTN","%ZVEMRU",97,0)
 Q
"RTN","%ZVEMRU",98,0)
 ;
"RTN","%ZVEMRU",99,0)
REDRAW3 ;Adjust line count and then redraw screen
"RTN","%ZVEMRU",100,0)
 D LINECNT,REDRAW^%ZVEMKT2(1),REDRAW(VEET("TOP"))
"RTN","%ZVEMRU",101,0)
 Q
"RTN","%ZVEMRU",102,0)
 ;
"RTN","%ZVEMRU",103,0)
LINECNT ;Adjust line count at top of screen
"RTN","%ZVEMRU",104,0)
 NEW NEWHIGH
"RTN","%ZVEMRU",105,0)
 S NEWHIGH=VRRHIGH_$E("    ",1,3-$L(VRRHIGH))
"RTN","%ZVEMRU",106,0)
 S VEET("HD",1)=$E(VEET("HD",1),1,59)_NEWHIGH_$E(VEET("HD",1),63,VEE("IOM"))
"RTN","%ZVEMRU",107,0)
 S DX=59,DY=0 X VEES("CRSR") W $G(VRRHIGH)
"RTN","%ZVEMRU",108,0)
 Q
"RTN","%ZVEMRU",109,0)
 ;
"RTN","%ZVEMRU",110,0)
MODEON(MODE,QUIT) ;MODE display in upper right of screen.
"RTN","%ZVEMRU",111,0)
 ;MODE=BLOCK or WEB
"RTN","%ZVEMRU",112,0)
 ;QUIT=1 Quit before repositioning the cursor
"RTN","%ZVEMRU",113,0)
 S DX=$S($G(MODE)="WEB":65,1:72)
"RTN","%ZVEMRU",114,0)
 S DY=(VEET("S1")-2) X VEES("CRSR")
"RTN","%ZVEMRU",115,0)
 W @VEE("RON") X VEES("XY") W MODE,@VEE("ROFF")
"RTN","%ZVEMRU",116,0)
 Q:$G(QUIT)
"RTN","%ZVEMRU",117,0)
 S DX=XCUR,DY=YCUR X VEES("CRSR")
"RTN","%ZVEMRU",118,0)
 Q
"RTN","%ZVEMRU",119,0)
 ;
"RTN","%ZVEMRU",120,0)
MODEOFF(MODE,QUIT) ;Turn off MODE notice
"RTN","%ZVEMRU",121,0)
 ;MODE=BLOCK or WEB
"RTN","%ZVEMRU",122,0)
 S DX=$S($G(MODE)="WEB":65,1:72)
"RTN","%ZVEMRU",123,0)
 S DY=(VEET("S1")-2) X VEES("CRSR") W "======"
"RTN","%ZVEMRU",124,0)
 Q:$G(QUIT)
"RTN","%ZVEMRU",125,0)
 S DX=XCUR,DY=YCUR X VEES("CRSR")
"RTN","%ZVEMRU",126,0)
 Q
"RTN","%ZVEMRUM")
0^130^B6031618
"RTN","%ZVEMRUM",1,0)
%ZVEMRUM ;DJB,VRR**Messages ; 1/6/01 3:47pm
"RTN","%ZVEMRUM",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMRUM",3,0)
 ;
"RTN","%ZVEMRUM",4,0)
MSG(NUM) ;Msgs for rtn editor
"RTN","%ZVEMRUM",5,0)
 Q:$G(NUM)'>0  NEW XX
"RTN","%ZVEMRUM",6,0)
 S DX=0,DY=VEET("S2") X VEES("CRSR")
"RTN","%ZVEMRUM",7,0)
 W @VEE("RON")
"RTN","%ZVEMRUM",8,0)
 X VEES("XY")
"RTN","%ZVEMRUM",9,0)
 D @NUM
"RTN","%ZVEMRUM",10,0)
 W ?VEE("IOM")
"RTN","%ZVEMRUM",11,0)
 S DX=0,DY=VEET("S2")+1 X VEES("CRSR")
"RTN","%ZVEMRUM",12,0)
 W "<RETURN> to continue.."
"RTN","%ZVEMRUM",13,0)
 W ?VEE("IOM")
"RTN","%ZVEMRUM",14,0)
 S DX=23,DY=VEET("S2")+1 X VEES("CRSR")
"RTN","%ZVEMRUM",15,0)
 R XX:300
"RTN","%ZVEMRUM",16,0)
 W @VEE("ROFF")
"RTN","%ZVEMRUM",17,0)
 S DX=0,DY=VEET("S2") X VEES("CRSR")
"RTN","%ZVEMRUM",18,0)
 W ?VEE("IOM")
"RTN","%ZVEMRUM",19,0)
 X VEES("CRSR")
"RTN","%ZVEMRUM",20,0)
 W VEET("FT",1)
"RTN","%ZVEMRUM",21,0)
 S DX=0,DY=VEET("S2")+1 X VEES("CRSR")
"RTN","%ZVEMRUM",22,0)
 W ?VEE("IOM")
"RTN","%ZVEMRUM",23,0)
 X VEES("CRSR")
"RTN","%ZVEMRUM",24,0)
 W VEET("FT",2)
"RTN","%ZVEMRUM",25,0)
 S DX=XCUR,DY=YCUR X VEES("CRSR")
"RTN","%ZVEMRUM",26,0)
 Q
"RTN","%ZVEMRUM",27,0)
 ;====================================================================
"RTN","%ZVEMRUM",28,0)
1 W "Select from menu bar above." Q
"RTN","%ZVEMRUM",29,0)
2 W $C(7),"Invalid line number" Q
"RTN","%ZVEMRUM",30,0)
3 W $C(7),"Invalid selection" Q
"RTN","%ZVEMRUM",31,0)
4 W "GOTO: 'n'=Line number  MK=Mark  <TAB>=Cursor" Q
"RTN","%ZVEMRUM",32,0)
5 W $C(7),"No editing. " D  Q
"RTN","%ZVEMRUM",33,0)
 . I $G(VRRS)>1 W "You've branched to another Program." Q
"RTN","%ZVEMRUM",34,0)
 . I $G(FLAGVPE)'["EDIT" W "You're using the Routine Reader." Q
"RTN","%ZVEMRUM",35,0)
6 W $C(7),"You haven't Marked any lines" Q
"RTN","%ZVEMRUM",36,0)
7 W $C(7),"You can't Branch to more than 4 programs" Q
"RTN","%ZVEMRUM",37,0)
8 W $C(7),"Invalid Line Tag" Q
"RTN","%ZVEMRUM",38,0)
9 W $C(7),"Line Tag has an invalid subscript" Q
"RTN","%ZVEMRUM",39,0)
10 W $C(7),"Illegal Line" Q
"RTN","%ZVEMRUM",40,0)
11 W $C(7),"A line may not exceed 245 characters" Q
"RTN","%ZVEMRUM",41,0)
13 W $C(7),"Invalid RANGE" Q
"RTN","%ZVEMRUM",42,0)
15 W "Enter code you wish inserted. Use <TAB> as a line start character." Q
"RTN","%ZVEMRUM",43,0)
16 W $C(7),"No match" Q
"RTN","%ZVEMRUM",44,0)
17 W "The line will be broken AFTER the code you enter" Q
"RTN","%ZVEMRUM",45,0)
18 W $C(7),"Line numbers can't match" Q
"RTN","%ZVEMRUM",46,0)
19 W $C(7),"Joined line would be too long" Q
"RTN","%ZVEMRUM",47,0)
20 W $C(7),"You must use <TAB> as a line start character" Q
"RTN","%ZVEMRUM",48,0)
21 W "Purge complete" Q
"RTN","%ZVEMRUM",49,0)
22 W "It is invalid to replace LINES with saved CHARACTERS." Q
"RTN","%ZVEMRUM",50,0)
23 W "It is invalid to replace CHARACTERS with saved LINES." Q
"RTN","%ZVEMRUS")
0^131^B1882935
"RTN","%ZVEMRUS",1,0)
%ZVEMRUS ;DJB,VRR**Rtn Selector [5/17/97 7:05am]
"RTN","%ZVEMRUS",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMRUS",3,0)
 ;
"RTN","%ZVEMRUS",4,0)
SELECT ;
"RTN","%ZVEMRUS",5,0)
 NEW FLAGQ,QUIT
"RTN","%ZVEMRUS",6,0)
 KILL ^UTILITY($J)
"RTN","%ZVEMRUS",7,0)
 S FLAGQ=0
"RTN","%ZVEMRUS",8,0)
 D INIT G:FLAGQ EX
"RTN","%ZVEMRUS",9,0)
 D @$S($D(^%ZOSF("RSEL")):"ZOSF",1:VEE("OS"))
"RTN","%ZVEMRUS",10,0)
EX ;
"RTN","%ZVEMRUS",11,0)
 Q
"RTN","%ZVEMRUS",12,0)
ZOSF ;Use ^%ZOSF("RSEL")
"RTN","%ZVEMRUS",13,0)
 NEW %,X
"RTN","%ZVEMRUS",14,0)
 X ^%ZOSF("RSEL")
"RTN","%ZVEMRUS",15,0)
 Q
"RTN","%ZVEMRUS",16,0)
2 ;Rtn Select for DSM Mumps
"RTN","%ZVEMRUS",17,0)
 D ^%RSEL
"RTN","%ZVEMRUS",18,0)
 Q
"RTN","%ZVEMRUS",19,0)
8 ;Rtn Select for MSM Mumps
"RTN","%ZVEMRUS",20,0)
 D INT^%RSEL
"RTN","%ZVEMRUS",21,0)
 Q
"RTN","%ZVEMRUS",22,0)
9 ;Rtn Select for DataTree Mumps
"RTN","%ZVEMRUS",23,0)
 NEW RTN
"RTN","%ZVEMRUS",24,0)
 KILL ^%RSET($J)
"RTN","%ZVEMRUS",25,0)
 W $$^%rselect
"RTN","%ZVEMRUS",26,0)
 I $O(^%RSET($J,""))="" Q
"RTN","%ZVEMRUS",27,0)
 S RTN=""
"RTN","%ZVEMRUS",28,0)
 F  S RTN=$O(^%RSET($J,RTN)) Q:RTN=""  S ^UTILITY($J,RTN)=""
"RTN","%ZVEMRUS",29,0)
 KILL ^%RSET($J)
"RTN","%ZVEMRUS",30,0)
 Q
"RTN","%ZVEMRUS",31,0)
16 ;Rtn Select for VAX DSM Mumps
"RTN","%ZVEMRUS",32,0)
 NEW %UTILITY
"RTN","%ZVEMRUS",33,0)
 D ^%RSEL Q:$O(%UTILITY(""))=""
"RTN","%ZVEMRUS",34,0)
 S RTN=""
"RTN","%ZVEMRUS",35,0)
 F  S RTN=$O(%UTILITY(RTN)) Q:RTN=""  S ^UTILITY($J,RTN)=""
"RTN","%ZVEMRUS",36,0)
 Q
"RTN","%ZVEMRUS",37,0)
18 ;Rtn Select for OpenM
"RTN","%ZVEMRUS",38,0)
 KILL ^UTILITY($J)
"RTN","%ZVEMRUS",39,0)
 I $L($T(KERNEL^%RSET)) D KERNEL^%RSET KILL %ST Q  ;VA Kernel rtn
"RTN","%ZVEMRUS",40,0)
 NEW %JO,%UR,%R
"RTN","%ZVEMRUS",41,0)
 S %JO=$J,%UR="^ROUTINE",%R=0 D ROU^%RSET
"RTN","%ZVEMRUS",42,0)
 Q
"RTN","%ZVEMRUS",43,0)
INIT ;
"RTN","%ZVEMRUS",44,0)
 I '$D(^%ZOSF("RSEL")),$G(VEE("OS"))="" D OS^%ZVEMKY
"RTN","%ZVEMRUS",45,0)
 Q
"RTN","%ZVEMRV")
0^132^B11657532
"RTN","%ZVEMRV",1,0)
%ZVEMRV ;DJB,VRR**Verify/Convert Scroll Array,Chk Tag/Line [4/1/97 9:41am]
"RTN","%ZVEMRV",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMRV",3,0)
 ;
"RTN","%ZVEMRV",4,0)
VERIFY(ND) ;When editor is exitted, verify that Lines and Tags are legal
"RTN","%ZVEMRV",5,0)
 ;When VERIFY is called, FLAGQ=1
"RTN","%ZVEMRV",6,0)
 ;ND="IR"_VRRS
"RTN","%ZVEMRV",7,0)
 ;QUIT...... 0=Tag and Line are ok
"RTN","%ZVEMRV",8,0)
 ;           1=Invalid tag   2=Invalid tag subscript
"RTN","%ZVEMRV",9,0)
 ;           3=Line exceeds 245 characters
"RTN","%ZVEMRV",10,0)
 NEW I,LN,QUIT,TG,TMP
"RTN","%ZVEMRV",11,0)
 S:$G(ND)'>0 ND=1 S ND="IR"_ND,QUIT=0
"RTN","%ZVEMRV",12,0)
 S TMP=$G(^TMP("VEE",ND,$J,1)) Q:TMP=" <> <> <>"
"RTN","%ZVEMRV",13,0)
 D GETTAG S LN=$P(TMP,$C(30),2,999)
"RTN","%ZVEMRV",14,0)
 F I=2:1 S TMP=$G(^TMP("VEE",ND,$J,I)) D  Q:QUIT  Q:TMP=" <> <> <>"  Q:TMP']""
"RTN","%ZVEMRV",15,0)
 . I TMP=" <> <> <>" D  Q
"RTN","%ZVEMRV",16,0)
 . . S QUIT=$$TAGCHK1(TG) Q:QUIT  ;Bad line tag
"RTN","%ZVEMRV",17,0)
 . . I ($L(LN)+$L(TG)+1)>245 S QUIT=3 Q  ;Too long
"RTN","%ZVEMRV",18,0)
 . I TMP'[$C(30) S LN=LN_$E(TMP,10,999) Q  ;Scrolled part of line
"RTN","%ZVEMRV",19,0)
 . S QUIT=$$TAGCHK1(TG) Q:QUIT  ;Bad line tag
"RTN","%ZVEMRV",20,0)
 . I ($L(LN)+$L(TG)+1)>245 S QUIT=3 Q  ;Too long
"RTN","%ZVEMRV",21,0)
 . D GETTAG S LN=$P(TMP,$C(30),2,999)
"RTN","%ZVEMRV",22,0)
 Q:'QUIT  D ASK
"RTN","%ZVEMRV",23,0)
 Q
"RTN","%ZVEMRV",24,0)
GETTAG ;Get tag from scroll array and convert to external format
"RTN","%ZVEMRV",25,0)
 S TG=$P(TMP," "_$C(30),1) I TG?1.N1." " S TG="" Q
"RTN","%ZVEMRV",26,0)
 F  Q:$E(TG)'=" "  S TG=$E(TG,2,999) ;Strip starting spaces
"RTN","%ZVEMRV",27,0)
 Q
"RTN","%ZVEMRV",28,0)
ASK ;Do they want to quit or correct problems
"RTN","%ZVEMRV",29,0)
 NEW ANS
"RTN","%ZVEMRV",30,0)
 D ENDSCR^%ZVEMKT2 W $C(7),!?1,"WARNING!",!?1
"RTN","%ZVEMRV",31,0)
 I QUIT=1 W "This routine has an invalid line tag."
"RTN","%ZVEMRV",32,0)
 I QUIT=2 W "This routine has a line tag with an invalid subscript."
"RTN","%ZVEMRV",33,0)
 I QUIT=3 W "This routine has a line that exceeds 245 characters."
"RTN","%ZVEMRV",34,0)
 W !?1,"You may wish to remain in the editor to make corrections.",!
"RTN","%ZVEMRV",35,0)
ASK1 W !?1,"Do you still wish to exit? YES// "
"RTN","%ZVEMRV",36,0)
 R ANS:300 S:'$T ANS="Y" S:ANS="" ANS="Y"
"RTN","%ZVEMRV",37,0)
 S ANS=$$ALLCAPS^%ZVEMKU($E(ANS))
"RTN","%ZVEMRV",38,0)
 I "Y,N"'[ANS W "   Y=Yes  N=No" G ASK1
"RTN","%ZVEMRV",39,0)
 I ANS="N" S FLAGQ=0 D REDRAW1^%ZVEMRU
"RTN","%ZVEMRV",40,0)
 Q
"RTN","%ZVEMRV",41,0)
 ;====================================================================
"RTN","%ZVEMRV",42,0)
TAGCHK(TAG) ;Check line tag. 1=Bad Tag
"RTN","%ZVEMRV",43,0)
 I $G(TAG)']"" Q 0
"RTN","%ZVEMRV",44,0)
 NEW I,TAG1,TAG2,TEST
"RTN","%ZVEMRV",45,0)
 S TAG1=$P(TAG,"(")
"RTN","%ZVEMRV",46,0)
 I $L(TAG1)>8 D MSG^%ZVEMRUM(8) Q 1
"RTN","%ZVEMRV",47,0)
 I $E(TAG1)'?1AN,$E(TAG1)'="%" D MSG^%ZVEMRUM(8) Q 1
"RTN","%ZVEMRV",48,0)
 I $L(TAG1)>1,$E(TAG1)'?1N,$E(TAG1,2,999)'?1.AN D MSG^%ZVEMRUM(8) Q 1
"RTN","%ZVEMRV",49,0)
 I $E(TAG1)?1N,TAG1'?1.N D MSG^%ZVEMRUM(8) Q 1
"RTN","%ZVEMRV",50,0)
 I TAG'?.E1"(".E Q 0
"RTN","%ZVEMRV",51,0)
 I $E(TAG,$L(TAG))'=")" D MSG^%ZVEMRUM(9) Q 1
"RTN","%ZVEMRV",52,0)
 S TAG2=$P(TAG,"(",2,99),TAG2=$E(TAG2,1,$L(TAG2)-1)
"RTN","%ZVEMRV",53,0)
 I TAG2="" Q 0
"RTN","%ZVEMRV",54,0)
 S TEST=0 F I=1:1:$L(TAG2,",") I $P(TAG2,",",I)'?1A.AN&($P(TAG2,",",I)'?1"%".AN) S TEST=1 Q
"RTN","%ZVEMRV",55,0)
 I TEST D MSG^%ZVEMRUM(9) Q 1
"RTN","%ZVEMRV",56,0)
 Q 0
"RTN","%ZVEMRV",57,0)
TAGCHK1(TAG) ;Check line tag. Don't generate message.
"RTN","%ZVEMRV",58,0)
 ;0=Tag is ok   1=Invalid tag   2=Invalid subscript
"RTN","%ZVEMRV",59,0)
 I $G(TAG)']"" Q 0
"RTN","%ZVEMRV",60,0)
 NEW I,TAG1,TAG2,TEST
"RTN","%ZVEMRV",61,0)
 S TAG1=$P(TAG,"(")
"RTN","%ZVEMRV",62,0)
 I $L(TAG1)>8 Q 1
"RTN","%ZVEMRV",63,0)
 I $E(TAG1)'?1AN,$E(TAG1)'="%" Q 1
"RTN","%ZVEMRV",64,0)
 I $L(TAG1)>1,$E(TAG1)'?1N,$E(TAG1,2,999)'?1.AN Q 1
"RTN","%ZVEMRV",65,0)
 I $E(TAG1)?1N,TAG1'?1.N Q 1
"RTN","%ZVEMRV",66,0)
 I TAG'?.E1"(".E Q 0
"RTN","%ZVEMRV",67,0)
 I $E(TAG,$L(TAG))'=")" Q 2
"RTN","%ZVEMRV",68,0)
 S TAG2=$P(TAG,"(",2,99),TAG2=$E(TAG2,1,$L(TAG2)-1)
"RTN","%ZVEMRV",69,0)
 I TAG2="" Q 0
"RTN","%ZVEMRV",70,0)
 S TEST=0 F I=1:1:$L(TAG2,",") I $P(TAG2,",",I)'?1A.AN&($P(TAG2,",",I)'?1"%".AN) S TEST=1 Q
"RTN","%ZVEMRV",71,0)
 I TEST Q 2
"RTN","%ZVEMRV",72,0)
 Q 0
"RTN","%ZVEMRV",73,0)
 ;====================================================================
"RTN","%ZVEMRV",74,0)
CONVERT(ND) ;Convert scroll array to ^UTILITY($J)
"RTN","%ZVEMRV",75,0)
 ;ND="IR"_VRRS
"RTN","%ZVEMRV",76,0)
 NEW CNT,DELIM,I,LN,TG,TMP
"RTN","%ZVEMRV",77,0)
 S:$G(ND)'>0 ND=1 S ND="IR"_ND
"RTN","%ZVEMRV",78,0)
 KILL ^UTILITY($J)
"RTN","%ZVEMRV",79,0)
 S DELIM=" "
"RTN","%ZVEMRV",80,0)
 S TMP=$G(^TMP("VEE",ND,$J,1)) Q:TMP=" <> <> <>"
"RTN","%ZVEMRV",81,0)
 S CNT=1 D GETTAG S LN=$P(TMP,$C(30),2,999)
"RTN","%ZVEMRV",82,0)
 F I=2:1 S TMP=$G(^TMP("VEE",ND,$J,I)) D  Q:TMP=" <> <> <>"  Q:TMP']""
"RTN","%ZVEMRV",83,0)
 . I TMP=" <> <> <>" D  Q
"RTN","%ZVEMRV",84,0)
 . . I LN]"" S ^UTILITY($J,0,CNT)=TG_DELIM_LN,CNT=CNT+1
"RTN","%ZVEMRV",85,0)
 . I TMP'[$C(30) S LN=LN_$E(TMP,10,999) Q  ;Scrolled part of line
"RTN","%ZVEMRV",86,0)
 . S ^UTILITY($J,0,CNT)=TG_DELIM_LN,CNT=CNT+1
"RTN","%ZVEMRV",87,0)
 . D GETTAG S LN=$P(TMP,$C(30),2,999)
"RTN","%ZVEMRV",88,0)
 Q
"RTN","%ZVEMRY")
0^133^B6478655
"RTN","%ZVEMRY",1,0)
%ZVEMRY ;DJB,VRR**Init,Branching,Error ; 9/23/02 1:31pm
"RTN","%ZVEMRY",2,0)
 ;;12;VPE;COPYRIGHT David Bolduc @1993;;Build 8
"RTN","%ZVEMRY",3,0)
 ;
"RTN","%ZVEMRY",4,0)
INIT ;Initialize variables
"RTN","%ZVEMRY",5,0)
 NEW X,Y
"RTN","%ZVEMRY",6,0)
 S VRRS=$S($G(VRRS)="":1,1:(VRRS+1)) ;VRRS=# of pgms you are viewing
"RTN","%ZVEMRY",7,0)
 D INIT^%ZVEMKY Q:$G(FLAGVPE)["VRR"
"RTN","%ZVEMRY",8,0)
 I $D(VEE("OS"))#2=0 D OS^%ZVEMKY Q:FLAGQ
"RTN","%ZVEMRY",9,0)
 I $D(VEE("$ZE"))#2=0 D ZE^%ZVEMKY1
"RTN","%ZVEMRY",10,0)
 I $D(VEE("TRMON"))#2=0 D TRMREAD^%ZVEMKY1
"RTN","%ZVEMRY",11,0)
 D REVVID^%ZVEMKY2
"RTN","%ZVEMRY",12,0)
 D BS^%ZVEMKY1
"RTN","%ZVEMRY",13,0)
 D SCRNVAR^%ZVEMKY2
"RTN","%ZVEMRY",14,0)
 D BLANK^%ZVEMKY3
"RTN","%ZVEMRY",15,0)
 D WRAP^%ZVEMKY2 W @(VEES("NOWRAP"))
"RTN","%ZVEMRY",16,0)
 Q
"RTN","%ZVEMRY",17,0)
VGL ;Run the VGlobal Lister
"RTN","%ZVEMRY",18,0)
 I $G(VRRS)>2 D  D PAUSE^%ZVEMKC(1) Q
"RTN","%ZVEMRY",19,0)
 . W $C(7),!?1,"You can't call VGL if you've branched to more than 2 programs."
"RTN","%ZVEMRY",20,0)
 I $G(DUZ(0))'["@",$G(DUZ(0))'["#" D  D PAUSE^%ZVEMKC(1) Q
"RTN","%ZVEMRY",21,0)
 . W $C(7),!?1,"You don't have access. See Help option."
"RTN","%ZVEMRY",22,0)
 I '$$EXIST^%ZVEMKU("%ZVEMG") D  D PAUSE^%ZVEMKC(1) Q
"RTN","%ZVEMRY",23,0)
 . W $C(7),!?1,"You don't have the 'VGlobal Lister' Routines."
"RTN","%ZVEMRY",24,0)
 D SYMTAB^%ZVEMKST("C","VRR",VRRS) ;Clear symbol table
"RTN","%ZVEMRY",25,0)
 D ^%ZVEMG X VEES("RM0")
"RTN","%ZVEMRY",26,0)
 D SYMTAB^%ZVEMKST("R","VRR",VRRS) ;Restore symbol table
"RTN","%ZVEMRY",27,0)
 Q
"RTN","%ZVEMRY",28,0)
VEDD ;Call VEDD, VElectronic Data Dictionary
"RTN","%ZVEMRY",29,0)
 I $G(VRRS)>2 D  D PAUSE^%ZVEMKC(1) Q
"RTN","%ZVEMRY",30,0)
 . W $C(7),!?1,"You can't call VEDD if you've branched to more than 2 programs."
"RTN","%ZVEMRY",31,0)
 I '$$EXIST^%ZVEMKU("%ZVEMD") D  D PAUSE^%ZVEMKC(1) Q
"RTN","%ZVEMRY",32,0)
 . W $C(7),!?1,"You don't have the 'VElectronic Data Dictionary' Routines."
"RTN","%ZVEMRY",33,0)
 D SYMTAB^%ZVEMKST("C","VRR",VRRS) ;Clear symbol table
"RTN","%ZVEMRY",34,0)
 D DIR^%ZVEMD X VEES("RM0")
"RTN","%ZVEMRY",35,0)
 D SYMTAB^%ZVEMKST("R","VRR",VRRS) ;Restore symbol table
"RTN","%ZVEMRY",36,0)
 Q
"RTN","%ZVEMRY",37,0)
RSE ;Search Routine for string(s)
"RTN","%ZVEMRY",38,0)
 I $G(VRRS)>2 D  D PAUSE^%ZVEMKC(1) Q
"RTN","%ZVEMRY",39,0)
 . W $C(7),!?1,"You can't do Routine Search if you've branched to more than 2 programs."
"RTN","%ZVEMRY",40,0)
 D ^%ZVEMRSS
"RTN","%ZVEMRY",41,0)
 Q
"RTN","%ZVEMRY",42,0)
ERROR ;Error trap.
"RTN","%ZVEMRY",43,0)
 NEW ZE
"RTN","%ZVEMRY",44,0)
 S @("ZE="_VEE("$ZE"))
"RTN","%ZVEMRY",45,0)
 I ZE["<INRPT>" W !!?1,"....Interrupted.",!!
"RTN","%ZVEMRY",46,0)
 E  D ERRMSG^%ZVEMKU1("VRR")
"RTN","%ZVEMRY",47,0)
 D PAUSE^%ZVEMKU(2)
"RTN","%ZVEMRY",48,0)
 S:$G(VRRS)'>0 VRRS=1 G EX^%ZVEMR
"RTN","%ZVEMRY",49,0)
 Q
"RTN","%ZVEMRY",50,0)
ERROR1 ;Error trap
"RTN","%ZVEMRY",51,0)
 I $D(VEE("TRMOFF")) X VEE("TRMOFF")
"RTN","%ZVEMRY",52,0)
 I $D(VEE("EON")) X VEE("EON")
"RTN","%ZVEMRY",53,0)
 D ENDSCR^%ZVEMKT2
"RTN","%ZVEMRY",54,0)
 D ERRMSG^%ZVEMKU1("VRR"),PAUSE^%ZVEMKU(2)
"RTN","%ZVEMRY",55,0)
 D REDRAW1^%ZVEMRU
"RTN","%ZVEMRY",56,0)
 Q
"RTN","%ZVEMSCL")
0^134^B9518950
"RTN","%ZVEMSCL",1,0)
%ZVEMSCL ;DJB,VSHL**Command Line History [1/17/97 9:05am]
"RTN","%ZVEMSCL",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMSCL",3,0)
 ;
"RTN","%ZVEMSCL",4,0)
EN(TYPE) ;TYPE=SHL/VEDD/VGL/VRR
"RTN","%ZVEMSCL",5,0)
 NEW CD,FLAGCLH,HOLD,X
"RTN","%ZVEMSCL",6,0)
 S FLAGCLH="CLH",HOLD=0,TYPE=$G(TYPE)
"RTN","%ZVEMSCL",7,0)
 D @$S(VEESHC="<AL>":"LIST",1:"STEP")
"RTN","%ZVEMSCL",8,0)
EX ;
"RTN","%ZVEMSCL",9,0)
 I TYPE="VSHL",VEESHC="TOO LONG" W ! D CLHSET("VSHL",CD) ;Shell's CLH. Line was too long, but save 245 characters to CLH.
"RTN","%ZVEMSCL",10,0)
 D CLEANUP
"RTN","%ZVEMSCL",11,0)
 Q
"RTN","%ZVEMSCL",12,0)
 ;===================================================================
"RTN","%ZVEMSCL",13,0)
STEP ;Step thru Commands 1 at a time
"RTN","%ZVEMSCL",14,0)
 Q:'$D(^%ZVEMS("CLH",VEE("ID"),TYPE))
"RTN","%ZVEMSCL",15,0)
 I VEESHC="<AU>" S X=$S(HOLD>0:HOLD-1,1:+^%ZVEMS("CLH",VEE("ID"),TYPE))
"RTN","%ZVEMSCL",16,0)
 I VEESHC="<AD>" S X=$S(HOLD>0:HOLD+1,1:$O(^%ZVEMS("CLH",VEE("ID"),TYPE,"")))
"RTN","%ZVEMSCL",17,0)
 Q:$G(X)'>0  Q:'$D(^%ZVEMS("CLH",VEE("ID"),TYPE,X))
"RTN","%ZVEMSCL",18,0)
 S CD=^%ZVEMS("CLH",VEE("ID"),TYPE,X)
"RTN","%ZVEMSCL",19,0)
STEP1 D SCREEN^%ZVEMKEA("",0,VEE("IOM")-2)
"RTN","%ZVEMSCL",20,0)
 I VEESHC="<ESCQ>" D QWIK^%ZVEMSCU(CD) Q
"RTN","%ZVEMSCL",21,0)
 I VEESHC="<RET>" S VEESHC="**"_CD Q
"RTN","%ZVEMSCL",22,0)
 I VEESHC="<AU>"!(VEESHC="<AD>") S HOLD=X G STEP
"RTN","%ZVEMSCL",23,0)
 I VEESHC="<ESCH>" D HELP^%ZVEMSCU G STEP1
"RTN","%ZVEMSCL",24,0)
 Q
"RTN","%ZVEMSCL",25,0)
 ;===================================================================
"RTN","%ZVEMSCL",26,0)
LIST ;List Command History (<AL>)
"RTN","%ZVEMSCL",27,0)
 W @VEE("IOF"),!?19,"C O M M A N D   L I N E   H I S T O R Y"
"RTN","%ZVEMSCL",28,0)
 S X="" F  S X=$O(^%ZVEMS("CLH",VEE("ID"),TYPE,X)) Q:X=""  W !?1,X,") ",^(X)
"RTN","%ZVEMSCL",29,0)
 W !
"RTN","%ZVEMSCL",30,0)
LIST1 R !?1,"Select: ",X:500 S:'$T X="^" I "^"[X Q
"RTN","%ZVEMSCL",31,0)
 I '$D(^%ZVEMS("CLH",VEE("ID"),TYPE)) W "   Command Line History for ",TYPE," is empty" G LIST1
"RTN","%ZVEMSCL",32,0)
 I '$D(^%ZVEMS("CLH",VEE("ID"),TYPE,X)) W "   Select number from left hand column" G LIST1
"RTN","%ZVEMSCL",33,0)
 S CD=^%ZVEMS("CLH",VEE("ID"),TYPE,X)
"RTN","%ZVEMSCL",34,0)
LIST2 D SCREEN^%ZVEMKEA("",0,VEE("IOM")-2)
"RTN","%ZVEMSCL",35,0)
 I VEESHC="<ESCQ>" D QWIK^%ZVEMSCU(CD) Q
"RTN","%ZVEMSCL",36,0)
 I VEESHC="<RET>" S VEESHC="**"_CD
"RTN","%ZVEMSCL",37,0)
 I VEESHC="<ESCH>" D HELP^%ZVEMSCU G STEP1
"RTN","%ZVEMSCL",38,0)
 Q
"RTN","%ZVEMSCL",39,0)
 ;===================================================================
"RTN","%ZVEMSCL",40,0)
CLEANUP ;Clean up extra characters if user hits arrow keys at the wrong time
"RTN","%ZVEMSCL",41,0)
 NEW I,Y X VEE("EOFF")
"RTN","%ZVEMSCL",42,0)
 F I=1:1:3 R *Y:0 ;If user types arrow key in wrong place
"RTN","%ZVEMSCL",43,0)
 X VEE("EON")
"RTN","%ZVEMSCL",44,0)
 Q
"RTN","%ZVEMSCL",45,0)
 ;=====================VPE modules call here==========================
"RTN","%ZVEMSCL",46,0)
CLHSET(TYPE,VALUE) ;Store Command Line.
"RTN","%ZVEMSCL",47,0)
 ;TYPE=SHL/VEDD/VGL/VRR
"RTN","%ZVEMSCL",48,0)
 ;VALUE=Command Line
"RTN","%ZVEMSCL",49,0)
 Q:$G(TYPE)']""  Q:$G(VALUE)']""
"RTN","%ZVEMSCL",50,0)
 NEW X
"RTN","%ZVEMSCL",51,0)
 I '$D(VEE("ID")) X ^%ZVEMS("ZS",3)
"RTN","%ZVEMSCL",52,0)
 ;-> Don't save if it matches last 2 commands
"RTN","%ZVEMSCL",53,0)
 S X=$G(^%ZVEMS("CLH",VEE("ID"),TYPE))
"RTN","%ZVEMSCL",54,0)
 I X>0 Q:$G(^(TYPE,X))=VALUE  Q:$G(^(X-1))=VALUE
"RTN","%ZVEMSCL",55,0)
 S X=$G(^%ZVEMS("CLH",VEE("ID"),TYPE))+1,^(TYPE)=X,^(TYPE,X)=VALUE
"RTN","%ZVEMSCL",56,0)
 I X>20 S X=$O(^%ZVEMS("CLH",VEE("ID"),TYPE,"")) KILL ^(X)
"RTN","%ZVEMSCL",57,0)
 Q
"RTN","%ZVEMSCL",58,0)
CLHEDIT(TYPE,PROMPT) ;Edit Command Line - TYPE=VEDD/VGL/VRR
"RTN","%ZVEMSCL",59,0)
 NEW CD,FLAGCLH S FLAGCLH=">>"
"RTN","%ZVEMSCL",60,0)
 S TYPE=$G(TYPE),PROMPT=$G(PROMPT) I TYPE']"" Q "^"
"RTN","%ZVEMSCL",61,0)
 I '$D(VEE("ID")) X ^%ZVEMS("ZS",3) ;Reset VShell variables
"RTN","%ZVEMSCL",62,0)
 D SCREEN^%ZVEMKEA(PROMPT,1,VEE("IOM")-2) I VEESHC="<RET>" Q CD
"RTN","%ZVEMSCL",63,0)
 I VEESHC="<AR>",$G(FLAGVPE)["VEDD",$G(FLAGDEF)]"" S CD=FLAGDEF Q CD
"RTN","%ZVEMSCL",64,0)
 I ",<ESC>,<ESCH>,<F1E>,<F1Q>,<TO>,"[(","_VEESHC_",") S CD=$S(VEESHC="<ESCH>":"?",1:"^") Q CD
"RTN","%ZVEMSCL",65,0)
 I "<AU>,<AD>,<AL>,<AR>"'[VEESHC Q VEESHC
"RTN","%ZVEMSCL",66,0)
 D EN(TYPE) S:VEESHC?1"**".E VEESHC=$P(VEESHC,"**",2,99) S:VEESHC="^" VEESHC=""
"RTN","%ZVEMSCL",67,0)
 Q VEESHC
"RTN","%ZVEMSCU")
0^135^B1997187
"RTN","%ZVEMSCU",1,0)
%ZVEMSCU ;DJB,VSHL**Command Line History Utility [11/06/94]
"RTN","%ZVEMSCU",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMSCU",3,0)
 ;
"RTN","%ZVEMSCU",4,0)
QWIK(CLHCODE) ;Make a QWIK using CODE from Command Line History
"RTN","%ZVEMSCU",5,0)
 Q:$G(CLHCODE)']""
"RTN","%ZVEMSCU",6,0)
 NEW BOX,BX,FLAGJMP,FLAGQ,NAM,PROMPT,TXT
"RTN","%ZVEMSCU",7,0)
 S (FLAGJMP,FLAGQ)=0
"RTN","%ZVEMSCU",8,0)
 D GETQWIK Q:FLAGQ  S ^%ZVEMS("QU",VEE("ID"),NAM)=CLHCODE
"RTN","%ZVEMSCU",9,0)
 I $G(^%ZVEMS("QU",VEE("ID"),NAM))']"" Q
"RTN","%ZVEMSCU",10,0)
 D TEXT^%ZVEMSQE("DSC") Q:VEESHC="<TAB>"!FLAGQ
"RTN","%ZVEMSCU",11,0)
 D TEXT^%ZVEMSQE("PARAM") Q:VEESHC="<TAB>"!FLAGQ
"RTN","%ZVEMSCU",12,0)
 D BOX^%ZVEMSQE
"RTN","%ZVEMSCU",13,0)
 Q
"RTN","%ZVEMSCU",14,0)
GETQWIK ;
"RTN","%ZVEMSCU",15,0)
 D GETNAM^%ZVEMSQ(1) S:$G(NAM)']"" FLAGQ=1 Q:FLAGQ  D  S:'$$YN(PROMPT) FLAGQ=1
"RTN","%ZVEMSCU",16,0)
 . I $D(^%ZVEMS("QU",VEE("ID"),NAM)) S PROMPT="This QWIK already exists. Shall I overwrite? YES// " Q
"RTN","%ZVEMSCU",17,0)
 . S PROMPT="Do you want to add as a new QWIK? YES// "
"RTN","%ZVEMSCU",18,0)
 Q
"RTN","%ZVEMSCU",19,0)
YN(PROMPT) ;1=Ok to delete, 0=No delete
"RTN","%ZVEMSCU",20,0)
 NEW XX S PROMPT=$G(PROMPT)
"RTN","%ZVEMSCU",21,0)
YN1 ;
"RTN","%ZVEMSCU",22,0)
 W !?1,PROMPT R XX:500 S:'$T!(XX="^") XX="N" S:XX="" XX="Y" S XX=$E(XX)
"RTN","%ZVEMSCU",23,0)
 I "YyNn"'[XX W "   Y=YES  N=NO" G YN1
"RTN","%ZVEMSCU",24,0)
 I "Yy"'[XX Q 0
"RTN","%ZVEMSCU",25,0)
 Q 1
"RTN","%ZVEMSD")
0^136^B7235058
"RTN","%ZVEMSD",1,0)
%ZVEMSD ;DJB,VSHL**Delete Range of Variables (..ZD) [05/07/94]
"RTN","%ZVEMSD",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMSD",3,0)
 ;
"RTN","%ZVEMSD",4,0)
 ;;S VEEZD="%,X,Z" D ^%ZVEMSD ;Use in QWIKs to delete a range
"RTN","%ZVEMSD",5,0)
 I '$$EXIST^%ZVEMKU("%ZOSV") W !?2,"This QWIK requires routine ^%ZOSV.",! Q
"RTN","%ZVEMSD",6,0)
TOP ;
"RTN","%ZVEMSD",7,0)
 NEW StarT,StarT1,TemP,TemP1
"RTN","%ZVEMSD",8,0)
 S StarT=$S($D(VEEZD):VEEZD,1:"")
"RTN","%ZVEMSD",9,0)
 I StarT']"" F TemP=1:1:9 Q:@("%"_TemP)']""  S StarT=StarT_@("%"_TemP)_$S(@("%"_(TemP+1))]"":",",1:"")
"RTN","%ZVEMSD",10,0)
 I StarT']"" D HELP G EX
"RTN","%ZVEMSD",11,0)
 I $$YN^%ZVEMKU1("OK TO DELETE? ",2)'=1 G EX
"RTN","%ZVEMSD",12,0)
 D INIT,SAVE,DELETE
"RTN","%ZVEMSD",13,0)
EX ;
"RTN","%ZVEMSD",14,0)
 W ! KILL ^TMP("VEE",$J)
"RTN","%ZVEMSD",15,0)
 Q
"RTN","%ZVEMSD",16,0)
SAVE ;Save symbol table to ^TMP("VEE",$J,"SYM",var)
"RTN","%ZVEMSD",17,0)
 NEW %,%X,%Y,X,Y
"RTN","%ZVEMSD",18,0)
 S X="^TMP(""VEE"","_$J_",""SYM""," D DOLRO^%ZOSV
"RTN","%ZVEMSD",19,0)
 Q:'$D(^TMP("VEE",$J,"SYM"))
"RTN","%ZVEMSD",20,0)
 S X="" F  S X=$O(^TMP("VEE",$J,"SYM",X)) Q:X=""  S Y="" F  S Y=$O(^TMP("VEE",$J,"SYM",X,Y)) Q:Y=""  KILL ^(Y) S ^TMP("VEE",$J,"SYM",X)="" ;Don't need subscript.
"RTN","%ZVEMSD",21,0)
 F X="StarT","StarT1","TemP","TemP1","VEE","VEESHC","VEESHL" KILL ^TMP("VEE",$J,"SYM",X)
"RTN","%ZVEMSD",22,0)
 F X="%","%X","%Y","X","Y","StarT" I $D(^TMP("VEE",$J,"VAR",X)) S ^TMP("VEE",$J,"SYM",X)=^(X)
"RTN","%ZVEMSD",23,0)
 Q
"RTN","%ZVEMSD",24,0)
DELETE ;Delete variable
"RTN","%ZVEMSD",25,0)
 F TemP1=1:1:$L(StarT,",") S StarT1=$P(StarT,",",TemP1) S TemP="" F  S TemP=$O(^TMP("VEE",$J,"SYM",TemP)) Q:TemP=""  D
"RTN","%ZVEMSD",26,0)
 . Q:+StarT1=StarT1  Q:StarT1]TemP
"RTN","%ZVEMSD",27,0)
 . Q:$E(TemP,1,$L(StarT1))'=StarT1
"RTN","%ZVEMSD",28,0)
 . W !?2,TemP,"  deleted.." KILL @TemP
"RTN","%ZVEMSD",29,0)
 Q
"RTN","%ZVEMSD",30,0)
HELP ;
"RTN","%ZVEMSD",31,0)
 W $C(7),!?1,"..ZD will delete local variables from your partition. It requires a"
"RTN","%ZVEMSD",32,0)
 W !?1,"parameter which can be any number of letters. Any variables whose"
"RTN","%ZVEMSD",33,0)
 W !?1,"name begins with these letters will be deleted."
"RTN","%ZVEMSD",34,0)
 W !!?1,"Ex 1: ..ZD XQ      Deletes all local variables whose name begins"
"RTN","%ZVEMSD",35,0)
 W !?1,"                   with the letters ""XQ"".",!
"RTN","%ZVEMSD",36,0)
 W !?1,"Ex 2: ..ZD % XQ    Deletes all variables with a name starting with"
"RTN","%ZVEMSD",37,0)
 W !?1,"                   ""%"" or ""XQ"".",!
"RTN","%ZVEMSD",38,0)
 Q
"RTN","%ZVEMSD",39,0)
INIT ;
"RTN","%ZVEMSD",40,0)
 KILL ^TMP("VEE",$J)
"RTN","%ZVEMSD",41,0)
 F XxX="%","%X","%Y","X","Y" I $D(@XxX)#2 S ^TMP("VEE",$J,"VAR",XxX)=@XxX
"RTN","%ZVEMSD",42,0)
 KILL %1,%2,%3,%4,%5,%6,%7,%8,%9,XxX,VEEZD
"RTN","%ZVEMSD",43,0)
 Q
"RTN","%ZVEMSF")
0^137^B19734632
"RTN","%ZVEMSF",1,0)
%ZVEMSF ;DJB,VSHL**FM Calls [3/6/96 6:16pm]
"RTN","%ZVEMSF",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMSF",3,0)
 ;
"RTN","%ZVEMSF",4,0)
EN ;Entry Point
"RTN","%ZVEMSF",5,0)
 NEW CNT,COL,COLUMNS,COLCNT,HD,LAST,PROMPT,SET,SPACES,WIDTH,WRITE
"RTN","%ZVEMSF",6,0)
 NEW CNTOLD,DX,DY,FLAGQ,I,OPT,TEST,TXT,VEES,X,Y
"RTN","%ZVEMSF",7,0)
 I '$D(VEE("OS")) NEW VEE
"RTN","%ZVEMSF",8,0)
 S FLAGQ=0 D INIT Q:FLAGQ
"RTN","%ZVEMSF",9,0)
 X VEES("RM0")
"RTN","%ZVEMSF",10,0)
TOP ;
"RTN","%ZVEMSF",11,0)
 F  S FLAGQ=0 D HD^%ZVEMSHY,LIST,GETOPT Q:FLAGQ  D RUN Q:FLAGQ
"RTN","%ZVEMSF",12,0)
EX ;
"RTN","%ZVEMSF",13,0)
 X VEES("RM0") W @VEE("IOF")
"RTN","%ZVEMSF",14,0)
 Q
"RTN","%ZVEMSF",15,0)
GETOPT ;
"RTN","%ZVEMSF",16,0)
 X PROMPT S OPT=$$READ^%ZVEMKRN()
"RTN","%ZVEMSF",17,0)
 I OPT="^" S FLAGQ=1 Q
"RTN","%ZVEMSF",18,0)
 I ",<ESC>,<F1E>,<F1Q>,<TAB>,<TO>,"[(","_VEE("K")_",") S FLAGQ=1 Q
"RTN","%ZVEMSF",19,0)
 I VEE("K")="<RET>" S OPT=CNT Q
"RTN","%ZVEMSF",20,0)
 I VEE("K")?1"<A"1A1">" S CNTOLD=CNT D ARROW S OPT=CNT D REDRAW G GETOPT
"RTN","%ZVEMSF",21,0)
 S OPT=$$ALLCAPS^%ZVEMKU(OPT),TEST=0 D  I TEST Q
"RTN","%ZVEMSF",22,0)
 . F I=1:1 S X=$P($T(MENU+I),";",5) Q:X=""  I $E(X,1,$L(OPT))=OPT S (CNT,OPT)=I,COL=$P($T(MENU+I),";",3),TEST=1 Q
"RTN","%ZVEMSF",23,0)
 G GETOPT
"RTN","%ZVEMSF",24,0)
ARROW ;Arrow Keys
"RTN","%ZVEMSF",25,0)
 I "<AU>,<AD>"[VEE("K") D  S COL=$P($T(MENU+CNT),";",3) Q
"RTN","%ZVEMSF",26,0)
 . I VEE("K")="<AU>" S CNT=CNT-1 S:CNT<1 CNT=LAST Q
"RTN","%ZVEMSF",27,0)
 . I VEE("K")="<AD>" S CNT=CNT+1 S:CNT>LAST CNT=1
"RTN","%ZVEMSF",28,0)
 I VEE("K")="<AR>" Q:COL=COLCNT  D  D ADJUST Q
"RTN","%ZVEMSF",29,0)
 . S CNT=CNT+COL(COL),COL=COL+1 S:CNT>LAST CNT=LAST
"RTN","%ZVEMSF",30,0)
 I VEE("K")="<AL>" Q:COL=1  D  D ADJUST Q
"RTN","%ZVEMSF",31,0)
 . S COL=COL-1,CNT=CNT-COL(COL)
"RTN","%ZVEMSF",32,0)
 Q
"RTN","%ZVEMSF",33,0)
RUN ;Run selected routine
"RTN","%ZVEMSF",34,0)
 S X=$P($T(MENU+OPT),";",6) I X="QUIT" S FLAGQ=1 Q
"RTN","%ZVEMSF",35,0)
 NEW CNT,COL,COLUMNS,COLCNT,HD,LAST,PROMPT,SET,SPACES,WIDTH,WRITE
"RTN","%ZVEMSF",36,0)
 I X]"" W @VEE("IOF") D @X X VEES("RM0")
"RTN","%ZVEMSF",37,0)
 Q
"RTN","%ZVEMSF",38,0)
LIST ;List Menu Options
"RTN","%ZVEMSF",39,0)
 F I=1:1 S TXT=$T(MENU+I) Q:TXT=""!(TXT[";***")   X SET,WRITE
"RTN","%ZVEMSF",40,0)
 S TXT=$T(MENU+CNT) Q:TXT=""
"RTN","%ZVEMSF",41,0)
 X SET W @VEE("RON") X WRITE W @VEE("ROFF")
"RTN","%ZVEMSF",42,0)
 Q
"RTN","%ZVEMSF",43,0)
REDRAW ;User moved cursor
"RTN","%ZVEMSF",44,0)
 S TXT=$T(MENU+CNTOLD) X SET,WRITE
"RTN","%ZVEMSF",45,0)
 S TXT=$T(MENU+CNT) X SET W @VEE("RON") X WRITE W @VEE("ROFF")
"RTN","%ZVEMSF",46,0)
 Q
"RTN","%ZVEMSF",47,0)
ADJUST ;Adjust CNT when you switch columns.
"RTN","%ZVEMSF",48,0)
 F  Q:$P($T(MENU+CNT),";",3)=COL  S CNT=CNT-1
"RTN","%ZVEMSF",49,0)
 Q
"RTN","%ZVEMSF",50,0)
INIT ;Initialize variables
"RTN","%ZVEMSF",51,0)
 S COLUMNS="18^18",WIDTH=33
"RTN","%ZVEMSF",52,0)
 S HD="FILEMAN 20 - CALLABLE ROUTINES"
"RTN","%ZVEMSF",53,0)
 D INIT^%ZVEMSHY
"RTN","%ZVEMSF",54,0)
 S PROMPT="S DX=3,DY=22 X VEES(""CRSR"") W ""SELECT: "",@VEES(""BLANK_C_EOL"")"
"RTN","%ZVEMSF",55,0)
 Q
"RTN","%ZVEMSF",56,0)
MENU ;MENU OPTIONS
"RTN","%ZVEMSF",57,0)
 ;;1;DDS...ScreenMan;DDS;HELP^%ZVEMKT("DDS");2;3
"RTN","%ZVEMSF",58,0)
 ;;1;DDIOL.Writer;DDIOL;HELP^%ZVEMKT("DDIOL");2;4
"RTN","%ZVEMSF",59,0)
 ;;1;DIAC..File access;DIAC;HELP^%ZVEMKT("DIAC");2;5
"RTN","%ZVEMSF",60,0)
 ;;1;DIAXU.Extract data;DIAXU;HELP^%ZVEMKT("DIAXU");2;6
"RTN","%ZVEMSF",61,0)
 ;;1;DIB...User controlled edit;DIB;HELP^%ZVEMKT("DIB");2;7
"RTN","%ZVEMSF",62,0)
 ;;1;DIC...Look-up.Add;DIC;HELP^%ZVEMKT("DIC");2;8
"RTN","%ZVEMSF",63,0)
 ;;1;DIC1..Custom look-up.File info;DIC1;HELP^%ZVEMKT("DIC1");2;9
"RTN","%ZVEMSF",64,0)
 ;;1;DICD..Wait msg;DICD;HELP^%ZVEMKT("DICD");2;10
"RTN","%ZVEMSF",65,0)
 ;;1;DICN..New entry.YES/NO;DICN;HELP^%ZVEMKT("DICN");2;11
"RTN","%ZVEMSF",66,0)
 ;;1;DICQ..Look-up display;DICQ;HELP^%ZVEMKT("DICQ");2;12
"RTN","%ZVEMSF",67,0)
 ;;1;DICRW.Required variables;DICRW;HELP^%ZVEMKT("DICRW");2;13
"RTN","%ZVEMSF",68,0)
 ;;1;DID...DD list;DID;HELP^%ZVEMKT("DID");2;14
"RTN","%ZVEMSF",69,0)
 ;;1;DIE...Edit;DIE;HELP^%ZVEMKT("DIE");2;15
"RTN","%ZVEMSF",70,0)
 ;;1;DIEZ..Input temp compile;DIEZ;HELP^%ZVEMKT("DIEZ");2;16
"RTN","%ZVEMSF",71,0)
 ;;1;*DIFG.Filegrams;*DIFG;HELP^%ZVEMKT("DIFG");2;17
"RTN","%ZVEMSF",72,0)
 ;;1;DIK...Delete.Reindex;DIK;HELP^%ZVEMKT("DIK");2;18
"RTN","%ZVEMSF",73,0)
 ;;1;DIKZ..Xref compile;DIKZ;HELP^%ZVEMKT("DIKZ");2;19
"RTN","%ZVEMSF",74,0)
 ;;1;DIM...Code validate;DIM;HELP^%ZVEMKT("DIM");2;20
"RTN","%ZVEMSF",75,0)
 ;;2;DIO2..Intern to extern DATE;DIO2;HELP^%ZVEMKT("DIO2");40;3
"RTN","%ZVEMSF",76,0)
 ;;2;DIP...Print;DIP;HELP^%ZVEMKT("DIP");40;4
"RTN","%ZVEMSF",77,0)
 ;;2;DIPT..Print/Sort Temp;DIPT;HELP^%ZVEMKT("DIPT");40;5
"RTN","%ZVEMSF",78,0)
 ;;2;DIPZ..Print Temp Compile;DIPZ;HELP^%ZVEMKT("DIPZ");40;6
"RTN","%ZVEMSF",79,0)
 ;;2;DIQ...Data display.DATE conver;DIQ;HELP^%ZVEMKT("DIQ");40;7
"RTN","%ZVEMSF",80,0)
 ;;2;DIQ1..Data retrieve;DIQ1;HELP^%ZVEMKT("DIQ1");40;8
"RTN","%ZVEMSF",81,0)
 ;;2;*DIR..Reader;*DIR;HELP^%ZVEMKT("DIR");40;9
"RTN","%ZVEMSF",82,0)
 ;;2;DIS...Search;DIS;HELP^%ZVEMKT("DIS");40;10
"RTN","%ZVEMSF",83,0)
 ;;2;DIU2..DD delete;DIU2;HELP^%ZVEMKT("DIU2");40;11
"RTN","%ZVEMSF",84,0)
 ;;2;DIWE..Text edit;DIWE;HELP^%ZVEMKT("DIWE");40;12
"RTN","%ZVEMSF",85,0)
 ;;2;DIWF..Form document;DIWF;HELP^%ZVEMKT("DIWF");40;13
"RTN","%ZVEMSF",86,0)
 ;;2;DIWP..Word process.;DIWP;HELP^%ZVEMKT("DIWP");40;14
"RTN","%ZVEMSF",87,0)
 ;;2;DIWW..Output last line;DIWW;HELP^%ZVEMKT("DIWW");40;15
"RTN","%ZVEMSF",88,0)
 ;;2;%DT...DATE/Time input/convert;%DT;HELP^%ZVEMKT("%DT");40;16
"RTN","%ZVEMSF",89,0)
 ;;2;%DTC..DATE/Time manipulate;%DTC;HELP^%ZVEMKT("%DTC");40;17
"RTN","%ZVEMSF",90,0)
 ;;2;COMMA.%DTC Number format;COMMA;HELP^%ZVEMKT("COMMA");40;18
"RTN","%ZVEMSF",91,0)
 ;;2;%RCR..Array move;%RCR;HELP^%ZVEMKT("%RCR");40;19
"RTN","%ZVEMSF",92,0)
 ;;2;Quit;QUIT;QUIT;40;20
"RTN","%ZVEMSH")
0^138^B10700786
"RTN","%ZVEMSH",1,0)
%ZVEMSH ;DJB,VSHL**Help Text Menu [3/6/96 6:15pm]
"RTN","%ZVEMSH",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMSH",3,0)
 ;
"RTN","%ZVEMSH",4,0)
EN ;Entry Point
"RTN","%ZVEMSH",5,0)
 NEW CNT,COL,COLCNT,COLUMNS,HD,LAST,PROMPT,SET,SPACES,WIDTH,WRITE
"RTN","%ZVEMSH",6,0)
 NEW CNTOLD,DX,DY,FLAGQ,I,OPT,TEST,TXT,VEES,X,Y
"RTN","%ZVEMSH",7,0)
 I $G(VEESHL)'="RUN" NEW VEE
"RTN","%ZVEMSH",8,0)
 S FLAGQ=0 D INIT,INIT^%ZVEMSHY Q:FLAGQ
"RTN","%ZVEMSH",9,0)
 X VEES("RM0")
"RTN","%ZVEMSH",10,0)
TOP ;
"RTN","%ZVEMSH",11,0)
 F  S FLAGQ=0 D HD^%ZVEMSHY,LIST,GETOPT Q:FLAGQ  D RUN Q:FLAGQ
"RTN","%ZVEMSH",12,0)
EX ;
"RTN","%ZVEMSH",13,0)
 X VEES("RM0") W @VEE("IOF")
"RTN","%ZVEMSH",14,0)
 Q
"RTN","%ZVEMSH",15,0)
GETOPT ;
"RTN","%ZVEMSH",16,0)
 X PROMPT S OPT=$$READ^%ZVEMKRN()
"RTN","%ZVEMSH",17,0)
 I OPT="^" S FLAGQ=1 Q
"RTN","%ZVEMSH",18,0)
 I ",<ESC>,<F1E>,<F1Q>,<TAB>,<TO>,"[(","_VEE("K")_",") S FLAGQ=1 Q
"RTN","%ZVEMSH",19,0)
 I VEE("K")="<RET>" S OPT=CNT Q
"RTN","%ZVEMSH",20,0)
 I VEE("K")?1"<A"1A1">" S CNTOLD=CNT D ARROW S OPT=CNT D REDRAW G GETOPT
"RTN","%ZVEMSH",21,0)
 S OPT=$$ALLCAPS^%ZVEMKU(OPT),TEST=0 D  I TEST Q
"RTN","%ZVEMSH",22,0)
 . F I=1:1 S X=$P($T(MENU+I),";",5) Q:X=""  I $E(X,1,$L(OPT))=OPT S (CNT,OPT)=I,COL=$P($T(MENU+I),";",3),TEST=1 Q
"RTN","%ZVEMSH",23,0)
 G GETOPT
"RTN","%ZVEMSH",24,0)
ARROW ;Arrow Keys
"RTN","%ZVEMSH",25,0)
 I "<AU>,<AD>"[VEE("K") D  S COL=$P($T(MENU+CNT),";",3) Q
"RTN","%ZVEMSH",26,0)
 . I VEE("K")="<AU>" S CNT=CNT-1 S:CNT<1 CNT=LAST Q
"RTN","%ZVEMSH",27,0)
 . I VEE("K")="<AD>" S CNT=CNT+1 S:CNT>LAST CNT=1
"RTN","%ZVEMSH",28,0)
 I VEE("K")="<AR>" Q:COL=COLCNT  D  D ADJUST Q
"RTN","%ZVEMSH",29,0)
 . S CNT=CNT+COL(COL),COL=COL+1 S:CNT>LAST CNT=LAST
"RTN","%ZVEMSH",30,0)
 I VEE("K")="<AL>" Q:COL=1  D  D ADJUST Q
"RTN","%ZVEMSH",31,0)
 . S COL=COL-1,CNT=CNT-COL(COL)
"RTN","%ZVEMSH",32,0)
 Q
"RTN","%ZVEMSH",33,0)
RUN ;Run selected routine
"RTN","%ZVEMSH",34,0)
 S X=$P($T(MENU+OPT),";",6) I X="QUIT" S FLAGQ=1 Q
"RTN","%ZVEMSH",35,0)
 NEW CNT,COL,COLCNT,COLUMNS,HD,LAST,PROMPT,SET,SPACES,WIDTH,WRITE
"RTN","%ZVEMSH",36,0)
 I X]"" W @VEE("IOF") D @X X VEES("RM0")
"RTN","%ZVEMSH",37,0)
 Q
"RTN","%ZVEMSH",38,0)
LIST ;List Menu Options
"RTN","%ZVEMSH",39,0)
 F I=1:1 S TXT=$T(MENU+I) Q:TXT=""!(TXT[";***")   X SET,WRITE
"RTN","%ZVEMSH",40,0)
 S TXT=$T(MENU+CNT) Q:TXT=""  X SET W @VEE("RON") X WRITE W @VEE("ROFF")
"RTN","%ZVEMSH",41,0)
 F I=1:1 S TXT=$T(TOPICS+I) Q:TXT=""!(TXT[";***")   X SET,WRITE
"RTN","%ZVEMSH",42,0)
 Q
"RTN","%ZVEMSH",43,0)
REDRAW ;User moved cursor
"RTN","%ZVEMSH",44,0)
 S TXT=$T(MENU+CNTOLD) X SET,WRITE
"RTN","%ZVEMSH",45,0)
 S TXT=$T(MENU+CNT) X SET W @VEE("RON") X WRITE W @VEE("ROFF")
"RTN","%ZVEMSH",46,0)
 Q
"RTN","%ZVEMSH",47,0)
ADJUST ;Adjust CNT when you switch columns.
"RTN","%ZVEMSH",48,0)
 F  Q:$P($T(MENU+CNT),";",3)=COL  S CNT=CNT-1
"RTN","%ZVEMSH",49,0)
 Q
"RTN","%ZVEMSH",50,0)
INIT ;Initialize variables
"RTN","%ZVEMSH",51,0)
 S COLUMNS="7^7",WIDTH=21
"RTN","%ZVEMSH",52,0)
 S HD="V S H E L L   H E L P   M E N U"
"RTN","%ZVEMSH",53,0)
 Q
"RTN","%ZVEMSH",54,0)
MENU ;MENU OPTIONS
"RTN","%ZVEMSH",55,0)
 ;;1;Introduction;INTRODUCTION;HELP^%ZVEMKT("INTRO");7;4
"RTN","%ZVEMSH",56,0)
 ;;1;Protection;PROTECTION;HELP^%ZVEMKT("PROT");7;6
"RTN","%ZVEMSH",57,0)
 ;;1;Keyboard;KEYBOARD;HELP^%ZVEMKT("KEYS");7;8
"RTN","%ZVEMSH",58,0)
 ;;1;VA KERNEL;VA KERNEL;HELP^%ZVEMKT("KERN");7;10
"RTN","%ZVEMSH",59,0)
 ;;1;QWIK Commands;QWIK COMMANDS;HELP^%ZVEMKT("QWIK");7;12
"RTN","%ZVEMSH",60,0)
 ;;1;System QWIKs;SYSTEM QWIKS;HELP^%ZVEMKT("SYSTEM");7;14
"RTN","%ZVEMSH",61,0)
 ;;1;User QWIKs;USER QWIKS;HELP^%ZVEMKT("USER");7;16
"RTN","%ZVEMSH",62,0)
 ;;2;Boxes;BOXES;HELP^%ZVEMKT("BOXES");41;4
"RTN","%ZVEMSH",63,0)
 ;;2;Vendor Configurations;VENDOR CONFIGURATIONS;HELP^%ZVEMKT("VENDOR");41;6
"RTN","%ZVEMSH",64,0)
 ;;2;Command Line History;COMMAND LINE HISTORY;HELP^%ZVEMKT("CLH");41;8
"RTN","%ZVEMSH",65,0)
 ;;2;Programmer Tools;PROGRAMMER TOOLS;HELP^%ZVEMKT("PGM");41;10
"RTN","%ZVEMSH",66,0)
 ;;2;Parameter Passing;PARAMETER PASSING;HELP^%ZVEMKT("PARAM");41;12
"RTN","%ZVEMSH",67,0)
 ;;2;Miscellaneous;MISCELLANEOUS;HELP^%ZVEMKT("MISC");41;14
"RTN","%ZVEMSH",68,0)
 ;;2;Quit;QUIT;QUIT;41;16
"RTN","%ZVEMSH",69,0)
 ;;***
"RTN","%ZVEMSH",70,0)
TOPICS ;Topic subheadings
"RTN","%ZVEMSH",71,0)
 ;;***
"RTN","%ZVEMSHY")
0^139^B2140061
"RTN","%ZVEMSHY",1,0)
%ZVEMSHY ;DJB,VSHL**Help Text Menu Init [11/12/95 8:57am]
"RTN","%ZVEMSHY",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMSHY",3,0)
 ;
"RTN","%ZVEMSHY",4,0)
HD ;Heading
"RTN","%ZVEMSHY",5,0)
 NEW MAR
"RTN","%ZVEMSHY",6,0)
 S MAR=$G(VEE("IOM")) S:MAR'>0 MAR=80
"RTN","%ZVEMSHY",7,0)
 W @VEE("IOF") S DX=1,DY=22 X VEES("CRSR") W @VEE("RON")
"RTN","%ZVEMSHY",8,0)
 W !," <ESC><ESC>,'^'=Quit    HIGHLIGHT<RET>,Enter Name=Select Menu Option",?(MAR-1),@VEE("ROFF")
"RTN","%ZVEMSHY",9,0)
 S DX=0,DY=0 X VEES("CRSR") W @VEE("RON")
"RTN","%ZVEMSHY",10,0)
 W !?(MAR-$L(HD)/2),HD,?(MAR-1),@VEE("ROFF")
"RTN","%ZVEMSHY",11,0)
 Q
"RTN","%ZVEMSHY",12,0)
INIT ;Initialize variables
"RTN","%ZVEMSHY",13,0)
 I '$D(VEE("OS")) D OS^%ZVEMKY Q:FLAGQ
"RTN","%ZVEMSHY",14,0)
 D IO^%ZVEMKY,SCRNVAR^%ZVEMKY2,REVVID^%ZVEMKY2,BLANK^%ZVEMKY3
"RTN","%ZVEMSHY",15,0)
 S (COL,CNT)=1
"RTN","%ZVEMSHY",16,0)
 S PROMPT="S DX=8,DY=21 X VEES(""CRSR"") W ""SELECT: "",@VEES(""BLANK_C_EOL"")"
"RTN","%ZVEMSHY",17,0)
 S SET="S DX=$P(TXT,"";"",7),DY=$P(TXT,"";"",8),TXT=$P(TXT,"";"",4)"
"RTN","%ZVEMSHY",18,0)
 S WRITE="X VEES(""CRSR"") W "" ""_TXT_$E(SPACES,1,WIDTH-$L(TXT))"
"RTN","%ZVEMSHY",19,0)
 S LAST=0 F I=1:1 Q:$P(COLUMNS,"^",I)'>0  S COL(I)=$P(COLUMNS,"^",I),LAST=LAST+COL(I)
"RTN","%ZVEMSHY",20,0)
 S COLCNT=I-1,$P(SPACES," ",VEE("IOM"))=""
"RTN","%ZVEMSHY",21,0)
 Q
"RTN","%ZVEMSID")
0^140^B12995482
"RTN","%ZVEMSID",1,0)
%ZVEMSID ;DJB,VSHL**Utilities - LIST USERS,ID NOTES [9/28/95 8:28am]
"RTN","%ZVEMSID",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMSID",3,0)
 ;
"RTN","%ZVEMSID",4,0)
LIST ;List Users
"RTN","%ZVEMSID",5,0)
 I '$D(^%ZVEMS("ID"))&('$D(^("PARAM")))&('$D(^("QU"))) D  Q
"RTN","%ZVEMSID",6,0)
 . W !?2,"No user ID's on record.",!
"RTN","%ZVEMSID",7,0)
 NEW DZ,FLAGQ,ID,NAM,X
"RTN","%ZVEMSID",8,0)
 S FLAGQ=0 D HD,CHECK1 G:FLAGQ EX D CHECK2 G:FLAGQ EX D CHECK3
"RTN","%ZVEMSID",9,0)
EX ;
"RTN","%ZVEMSID",10,0)
 W !
"RTN","%ZVEMSID",11,0)
 Q
"RTN","%ZVEMSID",12,0)
CHECK1 ;ID in use. User has logged in thru VA KERNEL.
"RTN","%ZVEMSID",13,0)
 W !?2,"1. VA KERNEL:" Q:'$D(^%ZVEMS("ID","SHL"))
"RTN","%ZVEMSID",14,0)
 S ID=0 F  S ID=$O(^%ZVEMS("ID","SHL",ID)) Q:ID=""!FLAGQ  S X="" F  S X=$O(^%ZVEMS("ID","SHL",ID,X)) Q:X=""!FLAGQ  S DZ=$O(^%ZVEMS("ID","SHL",ID,X,0)) D
"RTN","%ZVEMSID",15,0)
 . S NAM="" I $G(^VA(200,DZ,0))]"" S NAM=$P(^(0),"^")
"RTN","%ZVEMSID",16,0)
 . D PRINT
"RTN","%ZVEMSID",17,0)
 Q
"RTN","%ZVEMSID",18,0)
CHECK2 ;ID in use. User has QWIK commands.
"RTN","%ZVEMSID",19,0)
 W !!?2,"2. QWIK:" Q:'$D(^%ZVEMS("QU"))
"RTN","%ZVEMSID",20,0)
 S (DZ,ID,NAM,X)=""
"RTN","%ZVEMSID",21,0)
 F  S ID=$O(^%ZVEMS("QU",ID)) Q:ID=""!FLAGQ  D PRINT
"RTN","%ZVEMSID",22,0)
 Q
"RTN","%ZVEMSID",23,0)
CHECK3 ;ID in use. User has set parameters.
"RTN","%ZVEMSID",24,0)
 W !!?2,"3. PARAM:" Q:'$D(^%ZVEMS("PARAM"))
"RTN","%ZVEMSID",25,0)
 S (DZ,ID,NAM,X)=""
"RTN","%ZVEMSID",26,0)
 F  S ID=$O(^%ZVEMS("PARAM",ID)) Q:ID=""!FLAGQ  D PRINT
"RTN","%ZVEMSID",27,0)
 Q
"RTN","%ZVEMSID",28,0)
PRINT ;Print line
"RTN","%ZVEMSID",29,0)
 W !?18,ID,?26,NAM,?59,X,?70,DZ I $Y>(VEE("IOSL")-5) D PAGE
"RTN","%ZVEMSID",30,0)
 Q
"RTN","%ZVEMSID",31,0)
HD ;
"RTN","%ZVEMSID",32,0)
 W @VEE("IOF"),!?19,"U S E R   L I S T   ( B Y   T Y P E )"
"RTN","%ZVEMSID",33,0)
 W !!?7,"TYPE",?20,"ID",?40,"NAME",?62,"UCI",?72,"DUZ"
"RTN","%ZVEMSID",34,0)
 W !?2,"--------------",?18,"-------",?27,"------------------------------",?59,"---------",?70,"-------"
"RTN","%ZVEMSID",35,0)
 Q
"RTN","%ZVEMSID",36,0)
PAGE ;
"RTN","%ZVEMSID",37,0)
 D PAUSEQ^%ZVEMKC(2) Q:FLAGQ  W @VEE("IOF") D HD
"RTN","%ZVEMSID",38,0)
 Q
"RTN","%ZVEMSID",39,0)
 ;====================================================================
"RTN","%ZVEMSID",40,0)
IDNOTES ;How to change your ID number.
"RTN","%ZVEMSID",41,0)
 W !!?1,"To change your ID:"
"RTN","%ZVEMSID",42,0)
 W !!?5,"o  If you're running the VShell as a VA KERNEL menu option, HALT back"
"RTN","%ZVEMSID",43,0)
 W !?5,"   to the KERNEL and go into regular Programmer Mode."
"RTN","%ZVEMSID",44,0)
 W !!?5,"o  Move to your MGR UCI. Use ..QSAVE to save your QWIKs."
"RTN","%ZVEMSID",45,0)
 W !!?5,"o  Use ..UL to list ID numbers already in use, and select a new ID"
"RTN","%ZVEMSID",46,0)
 W !?5,"   number that isn't already being used."
"RTN","%ZVEMSID",47,0)
 W !!?5,"o  Exit Shell and re-enter with new ID number."
"RTN","%ZVEMSID",48,0)
 W !!?5,"o  Use ..QSAVE to restore QWIKs to new ID."
"RTN","%ZVEMSID",49,0)
 W !!?5,"o  Confirm that QWIKs have been restored to your new ID number."
"RTN","%ZVEMSID",50,0)
 W !!?5,"o  Delete old ID by: DO IDKILL^%ZVEMSID"
"RTN","%ZVEMSID",51,0)
 W ! Q
"RTN","%ZVEMSID",52,0)
IDKILL ;Delete your old ID
"RTN","%ZVEMSID",53,0)
 ; KILL ^%ZVEMS("CLH",ID), ^("PARAM",ID), ^("QU",ID), ^("ID","SHL",ID)
"RTN","%ZVEMSID",54,0)
 ; Delete appropriate ^%ZVEMS("ID") nodes.
"RTN","%ZVEMSID",55,0)
 NEW ASK,DZ,ID,X
"RTN","%ZVEMSID",56,0)
IDKILL1 R !!?1,"Enter ID to be deleted: ",ID:300 S:'$T ID="^" I "^"[ID Q
"RTN","%ZVEMSID",57,0)
 I ID'?1.N!(ID'>0) W "   Enter old ID number to be deleted." G IDKILL1
"RTN","%ZVEMSID",58,0)
 I $G(VEESHL)="RUN",ID=VEE("ID") D  G IDKILL1
"RTN","%ZVEMSID",59,0)
 . W $C(7),!!?1,"You are currently logged in with this ID number."
"RTN","%ZVEMSID",60,0)
 . W !?1,"You're not allowed to delete yourself."
"RTN","%ZVEMSID",61,0)
 D WARNING W !!?1,"Do you want to DELETE ID number ",ID,"? NO//"
"RTN","%ZVEMSID",62,0)
 R ASK:300 I '$T!(ASK="") S ASK="N"
"RTN","%ZVEMSID",63,0)
 I "yY"'[$E(ASK) W "   Aborting..",! Q
"RTN","%ZVEMSID",64,0)
 KILL ^%ZVEMS("CLH",ID),^%ZVEMS("PARAM",ID),^%ZVEMS("QU",ID)
"RTN","%ZVEMSID",65,0)
 S X="" F  S X=$O(^%ZVEMS("ID","SHL",ID,X)) Q:X=""  S DZ="" F  S DZ=$O(^%ZVEMS("ID","SHL",ID,X,DZ)) Q:DZ=""  D  ;
"RTN","%ZVEMSID",66,0)
 . KILL ^%ZVEMS("ID","DUZ",DZ,X,ID)
"RTN","%ZVEMSID",67,0)
 KILL ^%ZVEMS("ID","SHL",ID)
"RTN","%ZVEMSID",68,0)
 W !?1,"ID number ",ID," deleted..",!
"RTN","%ZVEMSID",69,0)
 Q
"RTN","%ZVEMSID",70,0)
WARNING ;Give warning before deleting
"RTN","%ZVEMSID",71,0)
 W $C(7),!!?5,"WARNING: All QWIKs for this ID will be deleted. Stop now and"
"RTN","%ZVEMSID",72,0)
 W !?5,"use ..QSAVE if you wish to save these QWIKs and restore them"
"RTN","%ZVEMSID",73,0)
 W !?5,"to your active ID number."
"RTN","%ZVEMSID",74,0)
 Q
"RTN","%ZVEMSL")
0^141^B7444961
"RTN","%ZVEMSL",1,0)
%ZVEMSL ;DJB,VSHL**VA KERNEL Library Functions [3/6/96 6:17pm]
"RTN","%ZVEMSL",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMSL",3,0)
 ;
"RTN","%ZVEMSL",4,0)
EN ;Entry Point
"RTN","%ZVEMSL",5,0)
 NEW CNT,COL,COLUMNS,COLCNT,HD,LAST,PROMPT,SET,SPACES,WIDTH,WRITE
"RTN","%ZVEMSL",6,0)
 NEW CNTOLD,DX,DY,FLAGQ,I,OPT,TEST,TXT,VEES,X,Y
"RTN","%ZVEMSL",7,0)
 I $G(VEESHL)'="RUN" NEW VEE
"RTN","%ZVEMSL",8,0)
 S FLAGQ=0 D INIT Q:FLAGQ
"RTN","%ZVEMSL",9,0)
 X VEES("RM0")
"RTN","%ZVEMSL",10,0)
TOP ;
"RTN","%ZVEMSL",11,0)
 F  S FLAGQ=0 D HD^%ZVEMSHY,LIST,GETOPT Q:FLAGQ  D RUN Q:FLAGQ
"RTN","%ZVEMSL",12,0)
EX ;
"RTN","%ZVEMSL",13,0)
 X VEES("RM0") W @VEE("IOF")
"RTN","%ZVEMSL",14,0)
 Q
"RTN","%ZVEMSL",15,0)
GETOPT ;
"RTN","%ZVEMSL",16,0)
 X PROMPT S OPT=$$READ^%ZVEMKRN()
"RTN","%ZVEMSL",17,0)
 I OPT="^" S FLAGQ=1 Q
"RTN","%ZVEMSL",18,0)
 I ",<ESC>,<F1E>,<F1Q>,<TAB>,<TO>,"[(","_VEE("K")_",") S FLAGQ=1 Q
"RTN","%ZVEMSL",19,0)
 I VEE("K")="<RET>" S OPT=CNT Q
"RTN","%ZVEMSL",20,0)
 I VEE("K")?1"<A"1A1">" S CNTOLD=CNT D ARROW S OPT=CNT D REDRAW G GETOPT
"RTN","%ZVEMSL",21,0)
 S OPT=$$ALLCAPS^%ZVEMKU(OPT),TEST=0 D  I TEST Q
"RTN","%ZVEMSL",22,0)
 . F I=1:1 S X=$P($T(MENU+I),";",5) Q:X=""  I $E(X,1,$L(OPT))=OPT S (CNT,OPT)=I,TEST=1 Q
"RTN","%ZVEMSL",23,0)
 G GETOPT
"RTN","%ZVEMSL",24,0)
ARROW ;Arrow Keys
"RTN","%ZVEMSL",25,0)
 I "<AU>,<AD>"[VEE("K") D  S COL=$P($T(MENU+CNT),";",3) Q
"RTN","%ZVEMSL",26,0)
 . I VEE("K")="<AU>" S CNT=CNT-1 S:CNT<1 CNT=LAST Q
"RTN","%ZVEMSL",27,0)
 . I VEE("K")="<AD>" S CNT=CNT+1 S:CNT>LAST CNT=1
"RTN","%ZVEMSL",28,0)
 I VEE("K")="<AR>" Q:COL=COLCNT  D  D ADJUST Q
"RTN","%ZVEMSL",29,0)
 . S CNT=CNT+COL(COL),COL=COL+1 S:CNT>LAST CNT=LAST
"RTN","%ZVEMSL",30,0)
 I VEE("K")="<AL>" Q:COL=1  D  D ADJUST Q
"RTN","%ZVEMSL",31,0)
 . S COL=COL-1,CNT=CNT-COL(COL)
"RTN","%ZVEMSL",32,0)
 Q
"RTN","%ZVEMSL",33,0)
RUN ;Run selected routine
"RTN","%ZVEMSL",34,0)
 S X=$P($T(MENU+OPT),";",6) I X="QUIT" S FLAGQ=1 Q
"RTN","%ZVEMSL",35,0)
 NEW CNT,COL,COLUMNS,COLCNT,HD,LAST,PROMPT,SET,SPACES,WIDTH,WRITE
"RTN","%ZVEMSL",36,0)
 I X]"" W @VEE("IOF") D @X X VEES("RM0")
"RTN","%ZVEMSL",37,0)
 Q
"RTN","%ZVEMSL",38,0)
LIST ;List Menu Options
"RTN","%ZVEMSL",39,0)
 F I=1:1 S TXT=$T(MENU+I) Q:TXT=""!(TXT[";***")   X SET,WRITE
"RTN","%ZVEMSL",40,0)
 S TXT=$T(MENU+CNT) Q:TXT=""  X SET W @VEE("RON") X WRITE W @VEE("ROFF")
"RTN","%ZVEMSL",41,0)
 Q
"RTN","%ZVEMSL",42,0)
REDRAW ;User moved cursor
"RTN","%ZVEMSL",43,0)
 S TXT=$T(MENU+CNTOLD) X SET,WRITE
"RTN","%ZVEMSL",44,0)
 S TXT=$T(MENU+CNT) X SET W @VEE("RON") X WRITE W @VEE("ROFF")
"RTN","%ZVEMSL",45,0)
 Q
"RTN","%ZVEMSL",46,0)
ADJUST ;Adjust CNT when you switch columns.
"RTN","%ZVEMSL",47,0)
 F  Q:$P($T(MENU+CNT),";",3)=COL  S CNT=CNT-1
"RTN","%ZVEMSL",48,0)
 Q
"RTN","%ZVEMSL",49,0)
INIT ;Initialize variables
"RTN","%ZVEMSL",50,0)
 S COLUMNS="5",WIDTH=30
"RTN","%ZVEMSL",51,0)
 S HD="VA   K E R N E L   7.1   L I B R A R Y   F U N C T I O N S"
"RTN","%ZVEMSL",52,0)
 D INIT^%ZVEMSHY
"RTN","%ZVEMSL",53,0)
 Q
"RTN","%ZVEMSL",54,0)
MENU ;MENU OPTIONS
"RTN","%ZVEMSL",55,0)
 ;;1;Date Functions.........XLFDT;DATE FUNCTIONS;HELP^%ZVEMKT("DATE");7;4
"RTN","%ZVEMSL",56,0)
 ;;1;String Functions.......XLFSTR;STRING FUNCTIONS;HELP^%ZVEMKT("STRING");7;6
"RTN","%ZVEMSL",57,0)
 ;;1;Math Functions.........XLFMTH;MATH FUNCTIONS;HELP^%ZVEMKT("MATH");7;8
"RTN","%ZVEMSL",58,0)
 ;;1;Measurement Functions..XLFMSMT;MEASUREMENT FUNCTIONS;HELP^%ZVEMKT("MEAS");7;10
"RTN","%ZVEMSL",59,0)
 ;;1;Quit;QUIT;QUIT;7;12
"RTN","%ZVEMSNR")
0^142^B9487926
"RTN","%ZVEMSNR",1,0)
%ZVEMSNR ;DJB,VSHL**Enter New Routine ; 9/7/02 1:30pm
"RTN","%ZVEMSNR",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMSNR",3,0)
 ;
"RTN","%ZVEMSNR",4,0)
TOP ;Allow user to start a new routine
"RTN","%ZVEMSNR",5,0)
 NEW CNT,CODE,DEF,FLAGQ,I,LINE,RTN,TMP,TAG,VEES,X
"RTN","%ZVEMSNR",6,0)
 NEW X S X="ERROR^%ZVEMSNR",@($$TRAP^%ZVEMKU1) KILL X
"RTN","%ZVEMSNR",7,0)
 S FLAGQ=0 D INIT Q:FLAGQ  KILL ^UTILITY($J)
"RTN","%ZVEMSNR",8,0)
 S CNT=1 D HD,GETCODE
"RTN","%ZVEMSNR",9,0)
 I $D(^UTILITY($J)) W ! D SAVRTN
"RTN","%ZVEMSNR",10,0)
EX ;
"RTN","%ZVEMSNR",11,0)
 KILL ^UTILITY($J)
"RTN","%ZVEMSNR",12,0)
 Q
"RTN","%ZVEMSNR",13,0)
 ;
"RTN","%ZVEMSNR",14,0)
GETCODE ;
"RTN","%ZVEMSNR",15,0)
 R !,"*",CODE:300 Q:CODE=""
"RTN","%ZVEMSNR",16,0)
 I $$CODECHK(CODE) G GETCODE
"RTN","%ZVEMSNR",17,0)
 S TAG=$P(CODE,$C(9),1),LINE=$P(CODE,$C(9),2)
"RTN","%ZVEMSNR",18,0)
 S ^UTILITY($J,0,CNT)=TAG_" "_LINE,CNT=CNT+1
"RTN","%ZVEMSNR",19,0)
 G GETCODE
"RTN","%ZVEMSNR",20,0)
 ;
"RTN","%ZVEMSNR",21,0)
SAVRTN ;Save routine
"RTN","%ZVEMSNR",22,0)
 NEW VRRPGM
"RTN","%ZVEMSNR",23,0)
 S DEF=$P(^UTILITY($J,0,1)," ",1)
"RTN","%ZVEMSNR",24,0)
 S:DEF["(" DEF=$P(DEF,"(",1)
"RTN","%ZVEMSNR",25,0)
 W !,"Save to routine name: ^"
"RTN","%ZVEMSNR",26,0)
 I DEF]"" W DEF,"// "
"RTN","%ZVEMSNR",27,0)
 R RTN:300 S:'$T RTN="^" S:RTN="" RTN=DEF
"RTN","%ZVEMSNR",28,0)
 I "^"[RTN W !,"Not saved.." Q
"RTN","%ZVEMSNR",29,0)
 I "??"[RTN D  G SAVRTN
"RTN","%ZVEMSNR",30,0)
 . W !,"Enter a valid routine name, <RETURN> for default name, or '^' to quit."
"RTN","%ZVEMSNR",31,0)
 I RTN'?1A.7AN D MSG(5) G SAVRTN
"RTN","%ZVEMSNR",32,0)
 I $$EXIST^%ZVEMKU(RTN) D MSG(6) G SAVRTN
"RTN","%ZVEMSNR",33,0)
 I DEF]"",DEF'=RTN D  ;
"RTN","%ZVEMSNR",34,0)
 . S TMP=$P(^UTILITY($J,0,1)," ",1)
"RTN","%ZVEMSNR",35,0)
 . S TMP=$S(TMP'["(":"",1:"("_$P(TMP,"(",2,99))
"RTN","%ZVEMSNR",36,0)
 . S $P(^UTILITY($J,0,1)," ",1)=RTN_TMP
"RTN","%ZVEMSNR",37,0)
 S VRRPGM=RTN X ^%ZVEMS("E",2)
"RTN","%ZVEMSNR",38,0)
 W !,"^",RTN," Saved to disk."
"RTN","%ZVEMSNR",39,0)
 Q
"RTN","%ZVEMSNR",40,0)
 ;
"RTN","%ZVEMSNR",41,0)
HD ;Heading
"RTN","%ZVEMSNR",42,0)
 W !!,"MAKE A NEW ROUTINE"
"RTN","%ZVEMSNR",43,0)
 W !,"-----------------------------------------"
"RTN","%ZVEMSNR",44,0)
 W !,"Use <TAB> key as line start character."
"RTN","%ZVEMSNR",45,0)
 W !,"Enter <RETURN> at '*' prompt to exit."
"RTN","%ZVEMSNR",46,0)
 W !,"-----------------------------------------"
"RTN","%ZVEMSNR",47,0)
 W !,"Begin.....",!
"RTN","%ZVEMSNR",48,0)
 Q
"RTN","%ZVEMSNR",49,0)
 ;
"RTN","%ZVEMSNR",50,0)
CODECHK(CODE) ;Check code. 1=Line bad,2=Line null,3=Line Label bad
"RTN","%ZVEMSNR",51,0)
 I $G(CODE)']"" Q 0
"RTN","%ZVEMSNR",52,0)
 I $L(CODE)>245 D MSG(4) Q 1
"RTN","%ZVEMSNR",53,0)
 NEW LINE,TAG,TAG1,TAG2,TEST
"RTN","%ZVEMSNR",54,0)
 S TAG=$P(CODE,$C(9),1),TAG1=$P(TAG,"("),LINE=$P(CODE,$C(9),2,999)
"RTN","%ZVEMSNR",55,0)
 I $L(CODE,$C(9))'>1 D MSG(3) Q 1
"RTN","%ZVEMSNR",56,0)
 I LINE="" Q 2
"RTN","%ZVEMSNR",57,0)
 I TAG']"" Q 0
"RTN","%ZVEMSNR",58,0)
 I $L(TAG1)>8 D MSG(1) Q 3
"RTN","%ZVEMSNR",59,0)
 I $E(TAG1)'?1AN,$E(TAG1)'="%" D MSG(1) Q 3
"RTN","%ZVEMSNR",60,0)
 I $L(TAG1)>1,$E(TAG1)'?1N,$E(TAG1,2,999)'?1.AN D MSG(1) Q 3
"RTN","%ZVEMSNR",61,0)
 I $E(TAG1)?1N,TAG1'?1.N D MSG(1) Q 3
"RTN","%ZVEMSNR",62,0)
 I TAG'?.E1"(".E Q 0
"RTN","%ZVEMSNR",63,0)
 I $E(TAG,$L(TAG))'=")" D MSG(2) Q 3
"RTN","%ZVEMSNR",64,0)
 S TAG2=$P(TAG,"(",2,99),TAG2=$E(TAG2,1,$L(TAG2)-1) I TAG2="" Q 0
"RTN","%ZVEMSNR",65,0)
 S TEST=0 F I=1:1:$L(TAG2,",") I $P(TAG2,",",I)'?1A.AN S TEST=1 Q
"RTN","%ZVEMSNR",66,0)
 I TEST D MSG(2) Q 3
"RTN","%ZVEMSNR",67,0)
 Q 0
"RTN","%ZVEMSNR",68,0)
 ;
"RTN","%ZVEMSNR",69,0)
INIT ;
"RTN","%ZVEMSNR",70,0)
 I '$D(VEE("OS")) D OS^%ZVEMKY Q:FLAGQ
"RTN","%ZVEMSNR",71,0)
 D ZSAVE^%ZVEMKY3
"RTN","%ZVEMSNR",72,0)
 Q
"RTN","%ZVEMSNR",73,0)
 ;
"RTN","%ZVEMSNR",74,0)
ERROR ;
"RTN","%ZVEMSNR",75,0)
 KILL ^UTILITY($J)
"RTN","%ZVEMSNR",76,0)
 D ERRMSG^%ZVEMKU1("'Create Rtn'"),PAUSE^%ZVEMKU(2)
"RTN","%ZVEMSNR",77,0)
 Q
"RTN","%ZVEMSNR",78,0)
 ;
"RTN","%ZVEMSNR",79,0)
MSG(NUM) ;Messages
"RTN","%ZVEMSNR",80,0)
 ;NUM=Subroutine
"RTN","%ZVEMSNR",81,0)
 Q:$G(NUM)'>0  D @NUM
"RTN","%ZVEMSNR",82,0)
 Q
"RTN","%ZVEMSNR",83,0)
1 W $C(7),!,"Invalid Line Tag" Q
"RTN","%ZVEMSNR",84,0)
2 W $C(7),!,"Line Tag has an invalid subscript" Q
"RTN","%ZVEMSNR",85,0)
3 W $C(7),!,"Illegal Line" Q
"RTN","%ZVEMSNR",86,0)
4 W $C(7),!!,"Code length may not exceed 245 characters",! Q
"RTN","%ZVEMSNR",87,0)
5 W $C(7),"   Invalid routine name" Q
"RTN","%ZVEMSNR",88,0)
6 W $C(7),!,"A routine with this name already exists." Q
"RTN","%ZVEMSO")
0^143^B6047197
"RTN","%ZVEMSO",1,0)
%ZVEMSO ;DJB,VSHL**Run Kernel Menu Option ; 9/6/02 8:34am
"RTN","%ZVEMSO",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMSO",3,0)
 ;
"RTN","%ZVEMSO",4,0)
KERNEL(OPT) ;Calls KERNEL ^XQ
"RTN","%ZVEMSO",5,0)
 ;OPT=Name/number of entry in OPTION file (#19)
"RTN","%ZVEMSO",6,0)
 D SETUP G:OPT']"" EX
"RTN","%ZVEMSO",7,0)
 NEW X S X="ERROR^%ZVEMSO",@($$TRAP^%ZVEMKU1) KILL X
"RTN","%ZVEMSO",8,0)
 NEW %H,%I,A,DIC,I1,X,Y,Z
"RTN","%ZVEMSO",9,0)
 NEW XQAA,XQABOLD,XQABTST,XQCH,XQCY,XQDIC,XQI,XQJ,XQJMP,XQK,XQM,XQNOHALT,XQPSM,XQN,XQPSM,XQSAV,XQSV,XQT,XQTT,XQUR,XQUSER,XQV,XQVOL,XQY,XQYY,XQY0,XQZ,XUD,XUDEV,XUVOL
"RTN","%ZVEMSO",10,0)
 S (XQY,XQM)=OPT,XQNOHALT=1 W ! D ^XQ W !
"RTN","%ZVEMSO",11,0)
 G EX
"RTN","%ZVEMSO",12,0)
OPTION(OPT) ;Uses code taken from KERNEL's ^XQ1
"RTN","%ZVEMSO",13,0)
 ;OPT=Name/number of entry in OPTION file (#19)
"RTN","%ZVEMSO",14,0)
 D SETUP G:OPT']"" EX D CHECK G:OPT']"" EX
"RTN","%ZVEMSO",15,0)
 NEW X S X="ERROR^%ZVEMSO",@($$TRAP^%ZVEMKU1) KILL X
"RTN","%ZVEMSO",16,0)
 NEW D0,DIASKHD,D,DA,DI,DIC,DICS,DIE,DPP,DQ,DR,DW
"RTN","%ZVEMSO",17,0)
 NEW %,%X,%Y,C,FLDS,I,LIST,NUM,Q,VAR,X,Y,Z
"RTN","%ZVEMSO",18,0)
 W !,$P(^DIC(19,OPT,0),U,2) D @($P(^(0),U,4)_"^%ZVEMSO1") W !
"RTN","%ZVEMSO",19,0)
EX ;
"RTN","%ZVEMSO",20,0)
 Q
"RTN","%ZVEMSO",21,0)
SETUP ;Setup variable OPT
"RTN","%ZVEMSO",22,0)
 S U="^",OPT=$G(OPT)
"RTN","%ZVEMSO",23,0)
 I '$D(^XUSEC) D  S OPT="" Q
"RTN","%ZVEMSO",24,0)
 . W $C(7),!?2,"Kernel not available in this UCI.",!
"RTN","%ZVEMSO",25,0)
 I $G(DUZ)'>0 D  I $G(DUZ)="" S OPT="" Q
"RTN","%ZVEMSO",26,0)
 . S ^TMP("VEE",$J)=OPT D ID^%ZVEMKU
"RTN","%ZVEMSO",27,0)
 . S OPT=^TMP("VEE",$J) KILL ^($J)
"RTN","%ZVEMSO",28,0)
 S:$E(OPT)="""" OPT=$E(OPT,2,99) S:$E($L(OPT))="""" OPT=$E(OPT,1,$L(OPT)-1)
"RTN","%ZVEMSO",29,0)
 I OPT="" D GETOPT Q:OPT=""  ;No parameter passed
"RTN","%ZVEMSO",30,0)
 I +OPT'=OPT D GETNUM I OPT="" D  Q  ;OPT equals Option name.
"RTN","%ZVEMSO",31,0)
 . W !?2,"No such option."
"RTN","%ZVEMSO",32,0)
 I '$D(^DIC(19,OPT,0)) D  S OPT="" Q
"RTN","%ZVEMSO",33,0)
 . W $C(7),!?2,"No such Option."
"RTN","%ZVEMSO",34,0)
 I $P(^(0),U,4)']"" D  S OPT="" Q
"RTN","%ZVEMSO",35,0)
 . W !?1,"Option TYPE field is blank."
"RTN","%ZVEMSO",36,0)
 Q
"RTN","%ZVEMSO",37,0)
GETOPT ;Select a menu option to run
"RTN","%ZVEMSO",38,0)
 W !!,"Get Kernel Option.."
"RTN","%ZVEMSO",39,0)
 S DIC="^DIC(19,",DIC(0)="QEAM" D ^DIC Q:Y<0  S OPT=+Y
"RTN","%ZVEMSO",40,0)
 Q
"RTN","%ZVEMSO",41,0)
GETNUM ;Get Option's internal entry number
"RTN","%ZVEMSO",42,0)
 S X=OPT,DIC="^DIC(19,",DIC(0)="QEM" D ^DIC I Y<0 S OPT="" Q
"RTN","%ZVEMSO",43,0)
 S OPT=+Y
"RTN","%ZVEMSO",44,0)
 Q
"RTN","%ZVEMSO",45,0)
CHECK ;Don't allow Menu type option
"RTN","%ZVEMSO",46,0)
 Q:"A,E,I,P,R"[$P(^DIC(19,OPT,0),U,4)  S OPT=""
"RTN","%ZVEMSO",47,0)
 W $C(7),!!?1,"You may only run the following KERNEL option types:"
"RTN","%ZVEMSO",48,0)
 W !!?10,"ACTION",!?10,"EDIT",!?10,"INQUIRE"
"RTN","%ZVEMSO",49,0)
 W !?10,"PRINT",!?10,"ROUTINE"
"RTN","%ZVEMSO",50,0)
 Q
"RTN","%ZVEMSO",51,0)
ERROR ;Error Trap
"RTN","%ZVEMSO",52,0)
 NEW ZE
"RTN","%ZVEMSO",53,0)
 S @("ZE="_VEE("$ZE"))
"RTN","%ZVEMSO",54,0)
 ;Don't show Kernel error at +14^XQ1
"RTN","%ZVEMSO",55,0)
 I ZE'["^XQ1" D ERRMSG^%ZVEMKU1("'KERNEL Call'")
"RTN","%ZVEMSO",56,0)
 D PAUSE^%ZVEMKU(2)
"RTN","%ZVEMSO",57,0)
 Q
"RTN","%ZVEMSO1")
0^144^B4938296
"RTN","%ZVEMSO1",1,0)
%ZVEMSO1 ;DJB,VSHL**A,E,I,P,R [07/01/94]
"RTN","%ZVEMSO1",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMSO1",3,0)
 ;
"RTN","%ZVEMSO1",4,0)
 ;====================================================================
"RTN","%ZVEMSO1",5,0)
A ;ACTION type option
"RTN","%ZVEMSO1",6,0)
 I $D(^DIC(19,+OPT,20)) X ^(20)
"RTN","%ZVEMSO1",7,0)
 Q
"RTN","%ZVEMSO1",8,0)
 ;====================================================================
"RTN","%ZVEMSO1",9,0)
P ;PRINT type option
"RTN","%ZVEMSO1",10,0)
 NEW DIC,PG,L,FLDS,BY,FR,TO,DHD,DCOPIES,DIS,IOP,DHIT,DIOBEG,DIOEND
"RTN","%ZVEMSO1",11,0)
 S LIST="DIC,PG,L,FLDS,BY,FR,TO,DHD,DCOPIES,DIS(0),IOP,DHIT,DIOBEG,DIOEND"
"RTN","%ZVEMSO1",12,0)
 S NUM=59 D SET
"RTN","%ZVEMSO1",13,0)
 I $D(DIS(0))#2 F I=1:1:3 Q:'$D(^DIC(19,+OPT,69+(I/10)))  Q:^(69+(I/10))=""  S DIS(I)=^(69+(I/10))
"RTN","%ZVEMSO1",14,0)
 I $G(^DIC(19,OPT,79))=1 S DIASKHD=""
"RTN","%ZVEMSO1",15,0)
 D D1,EN1^DIP
"RTN","%ZVEMSO1",16,0)
 Q
"RTN","%ZVEMSO1",17,0)
 ;====================================================================
"RTN","%ZVEMSO1",18,0)
I ;INQUIRE type option
"RTN","%ZVEMSO1",19,0)
 D DIC Q:DA=-1
"RTN","%ZVEMSO1",20,0)
 S DI=DIC,LIST="DIC,DR,DIQ(0)",NUM=79 D SET,D1 S:$D(DIC)[0 DIC=DI
"RTN","%ZVEMSO1",21,0)
 I $D(^DIC(19,+OPT,63)),$L(^(63)) S FLDS=^(63) G I1
"RTN","%ZVEMSO1",22,0)
 S:DUZ(0)'="@" DICS="I 1 Q:'$D(^(8))  F DW=1:1:$L(^(8)) I DUZ(0)[$E(^(8),DW) Q"
"RTN","%ZVEMSO1",23,0)
 W VEE("IOF") D EN^DIQ S Y=OPT G I
"RTN","%ZVEMSO1",24,0)
I1 ;
"RTN","%ZVEMSO1",25,0)
 W ! S LIST="DHD",NUM=66 D SET
"RTN","%ZVEMSO1",26,0)
 KILL ^UTILITY($J),^(U,$J) S ^($J,1,DA)=""
"RTN","%ZVEMSO1",27,0)
 S @("L=+$P("_DI_"0),U,2)"),DPP(1)=L_"^^^@",L=0
"RTN","%ZVEMSO1",28,0)
 S C=",",Q="""",DPP=1,DPP(1,"IX")="^UTILITY(U,$J,"_DI_"^2"
"RTN","%ZVEMSO1",29,0)
 D N^DIP1 S Y=OPT
"RTN","%ZVEMSO1",30,0)
 G I
"RTN","%ZVEMSO1",31,0)
 ;====================================================================
"RTN","%ZVEMSO1",32,0)
R ;RUN ROUTINE type option
"RTN","%ZVEMSO1",33,0)
 NEW RTN Q:'$D(^DIC(19,OPT,25))
"RTN","%ZVEMSO1",34,0)
 S RTN=^(25) Q:'$L(RTN)  S:RTN'[U RTN=U_RTN D @RTN
"RTN","%ZVEMSO1",35,0)
 Q
"RTN","%ZVEMSO1",36,0)
 ;====================================================================
"RTN","%ZVEMSO1",37,0)
E ;EDIT type option
"RTN","%ZVEMSO1",38,0)
 D DIC Q:DA=-1  NEW DIE,DIC
"RTN","%ZVEMSO1",39,0)
 S LIST="DIE,DR",NUM=49 D SET S LIST="DIE(""W"")",NUM=53 D SET
"RTN","%ZVEMSO1",40,0)
 I $D(^DIC(19,OPT,53)),$L(^(53)) S %=^(53),DIE("NO^")=$S(%="N":"",1:%)
"RTN","%ZVEMSO1",41,0)
 S:DIE["(" DIE=U_DIE D ^DIE S Y=OPT
"RTN","%ZVEMSO1",42,0)
 G E
"RTN","%ZVEMSO1",43,0)
 ;====================================================================
"RTN","%ZVEMSO1",44,0)
DIC ;Get FileMan parameters from Option File and do look up
"RTN","%ZVEMSO1",45,0)
 NEW D,DIC,NUM W !
"RTN","%ZVEMSO1",46,0)
 S LIST="DIC,DIC(0),DIC(""A""),DIC(""B""),DIC(""S""),DIC(""W""),D",NUM=29 D SET,D1
"RTN","%ZVEMSO1",47,0)
 I '$D(D) D ^DIC I 1
"RTN","%ZVEMSO1",48,0)
 E  S:D="" D="B" D IX^DIC
"RTN","%ZVEMSO1",49,0)
 S DA=+Y,Y=OPT
"RTN","%ZVEMSO1",50,0)
 Q
"RTN","%ZVEMSO1",51,0)
D1 ;
"RTN","%ZVEMSO1",52,0)
 S:DIC["(" DIC=U_DIC
"RTN","%ZVEMSO1",53,0)
 Q
"RTN","%ZVEMSO1",54,0)
SET ;Set variables
"RTN","%ZVEMSO1",55,0)
 NEW I,VAR
"RTN","%ZVEMSO1",56,0)
 F I=1:1 S VAR=$P(LIST,",",I) Q:VAR=""  KILL @VAR I $D(^DIC(19,+OPT,NUM+I)),^(NUM+I)]"" S @VAR=^(NUM+I)
"RTN","%ZVEMSO1",57,0)
 I $G(DIC("A"))]"" S DIC("A")=DIC("A")_" "
"RTN","%ZVEMSO1",58,0)
 Q
"RTN","%ZVEMSP")
0^145^B16409385
"RTN","%ZVEMSP",1,0)
%ZVEMSP ;DJB,VSHL**System Parameters [11/17/96 12:49pm]
"RTN","%ZVEMSP",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMSP",3,0)
 ;
"RTN","%ZVEMSP",4,0)
TOP ;Edit System Parameters
"RTN","%ZVEMSP",5,0)
 NEW DOT,FLAGQ,I,LINE,NUM
"RTN","%ZVEMSP",6,0)
 D INIT
"RTN","%ZVEMSP",7,0)
 S FLAGQ=0
"RTN","%ZVEMSP",8,0)
 F  D DISPLAY,GETPARAM Q:FLAGQ
"RTN","%ZVEMSP",9,0)
EX ;
"RTN","%ZVEMSP",10,0)
 Q
"RTN","%ZVEMSP",11,0)
GETPARAM ;Edit a Parameter
"RTN","%ZVEMSP",12,0)
 R !?1,"Select NUMBER: ",NUM:300 S:'$T NUM="^" I "^"[NUM S FLAGQ=1 Q
"RTN","%ZVEMSP",13,0)
 I NUM'?1.N!(NUM<1)!(NUM>7) W "  To edit a parameter, enter number of your choice." G GETPARAM
"RTN","%ZVEMSP",14,0)
 I NUM=1 D WARN
"RTN","%ZVEMSP",15,0)
 I NUM=2 D PROMPT
"RTN","%ZVEMSP",16,0)
 I NUM=3 D TIMEOUT
"RTN","%ZVEMSP",17,0)
 I NUM=4 D SAVE
"RTN","%ZVEMSP",18,0)
 I NUM=5 D BS
"RTN","%ZVEMSP",19,0)
 I NUM=6 D WIDTH
"RTN","%ZVEMSP",20,0)
 I NUM=7 D LENGTH
"RTN","%ZVEMSP",21,0)
 Q
"RTN","%ZVEMSP",22,0)
DISPLAY ;Display Parameters
"RTN","%ZVEMSP",23,0)
 NEW HD
"RTN","%ZVEMSP",24,0)
 S HD="V P E   S Y S T E M   P A R A M E T E R S"
"RTN","%ZVEMSP",25,0)
 W @VEE("IOF"),!?(VEE("IOM")-$L(HD)\2),HD
"RTN","%ZVEMSP",26,0)
 W !,$E(LINE,1,VEE("IOM")-1)
"RTN","%ZVEMSP",27,0)
 NEW BS,KL,PR,TO,WIDTH,LENGTH
"RTN","%ZVEMSP",28,0)
 S KL=$G(^%ZVEMS("PARAM",VEE("ID"),"WARN")) S:KL']"" KL="NO"
"RTN","%ZVEMSP",29,0)
 W !!?1,"1. Global Kill......... ",KL,?40,"Default answer to global kill warning"
"RTN","%ZVEMSP",30,0)
 S PR=$G(^%ZVEMS("PARAM",VEE("ID"),"PROMPT")) S:PR']"" PR="INACTIVE"
"RTN","%ZVEMSP",31,0)
 W !!?1,"2. Prompt.............. ",PR,?40,"ACTIVE Prompt includes UCI,VOL>>"
"RTN","%ZVEMSP",32,0)
 S TO=$G(^%ZVEMS("PARAM",VEE("ID"),"TO")) S:TO'>0 TO=600
"RTN","%ZVEMSP",33,0)
 W !!?1,"3. Time-out............ ",TO,?40,"Shell Time-out length in seconds"
"RTN","%ZVEMSP",34,0)
 W !!?1,"4. SAVE Routine........ ",$G(^%ZVEMS("PARAM",VEE("ID"),"SAVE")),?40,"Routine that holds your saved QWIKs"
"RTN","%ZVEMSP",35,0)
 S BS=$G(^%ZVEMS("PARAM",VEE("ID"),"BS")) S:BS']"" BS="SAME"
"RTN","%ZVEMSP",36,0)
 W !!?1,"5. <DEL> & <BS> Keys... ",BS,?40,"<DELETE> different from <BACKSPACE>"
"RTN","%ZVEMSP",37,0)
 S WIDTH=$G(^%ZVEMS("PARAM",VEE("ID"),"WIDTH")) S:'WIDTH WIDTH=80
"RTN","%ZVEMSP",38,0)
 W !!?1,"6. Screen Width........ ",WIDTH,?40,"Set screen width"
"RTN","%ZVEMSP",39,0)
 S LENGTH=$G(^%ZVEMS("PARAM",VEE("ID"),"LENGTH")) S:'LENGTH LENGTH=24
"RTN","%ZVEMSP",40,0)
 W !!?1,"7. Screen Length....... ",LENGTH,?40,"Set screen length"
"RTN","%ZVEMSP",41,0)
 W !!,$E(LINE,1,VEE("IOM")-1),!
"RTN","%ZVEMSP",42,0)
 Q
"RTN","%ZVEMSP",43,0)
 ;====================================================================
"RTN","%ZVEMSP",44,0)
WARN ;Default answer to "Global Kill" warning.
"RTN","%ZVEMSP",45,0)
 S ^%ZVEMS("PARAM",VEE("ID"),"WARN")=$S($G(^%ZVEMS("PARAM",VEE("ID"),"WARN"))="YES":"NO",1:"YES")
"RTN","%ZVEMSP",46,0)
 Q
"RTN","%ZVEMSP",47,0)
 ;====================================================================
"RTN","%ZVEMSP",48,0)
PROMPT ;Toggle on/off displaying UCI and Volume Set with ">>" prompt.
"RTN","%ZVEMSP",49,0)
 I $D(^%ZVEMS("PARAM",VEE("ID"),"PROMPT")) KILL ^("PROMPT") Q
"RTN","%ZVEMSP",50,0)
 S ^%ZVEMS("PARAM",VEE("ID"),"PROMPT")="UCI,VOL"
"RTN","%ZVEMSP",51,0)
 Q
"RTN","%ZVEMSP",52,0)
 ;====================================================================
"RTN","%ZVEMSP",53,0)
TIMEOUT ;Number of seconds of inactivity when VShell will time-out.
"RTN","%ZVEMSP",54,0)
 NEW TO,TODEF
"RTN","%ZVEMSP",55,0)
 S TODEF=$G(^%ZVEMS("PARAM",VEE("ID"),"TO")) S:TODEF'>0 TODEF=600
"RTN","%ZVEMSP",56,0)
TIMEOUT1 W !?1,"Enter TIME-OUT: ",TODEF,"// "
"RTN","%ZVEMSP",57,0)
 R TO:300 S:'$T TO="^" S:TO="" TO=TODEF Q:TO["^"
"RTN","%ZVEMSP",58,0)
 I TO'?1.N!(TO'>0) D  G TIMEOUT1
"RTN","%ZVEMSP",59,0)
 . W !?1,"Enter number of seconds for VShell to time-out from inactivity. This time-out"
"RTN","%ZVEMSP",60,0)
 . W !?1,"applies only to you. Other users will have there own time-out value. Enter"
"RTN","%ZVEMSP",61,0)
 . W !?1,"'^' to quit."
"RTN","%ZVEMSP",62,0)
 S ^%ZVEMS("PARAM",VEE("ID"),"TO")=TO,VEE("TIME")=TO
"RTN","%ZVEMSP",63,0)
 Q
"RTN","%ZVEMSP",64,0)
 ;====================================================================
"RTN","%ZVEMSP",65,0)
SAVE ;Edit Save Routine
"RTN","%ZVEMSP",66,0)
 NEW FLAGQ,RTN,TEMP S FLAGQ=0 D GETRTNS^%ZVEMSS
"RTN","%ZVEMSP",67,0)
 Q
"RTN","%ZVEMSP",68,0)
 ;====================================================================
"RTN","%ZVEMSP",69,0)
BS ;Delete different from Backspace
"RTN","%ZVEMSP",70,0)
 I $G(^%ZVEMS("PARAM",VEE("ID"),"BS"))'="DIFF" S ^("BS")="DIFF" Q
"RTN","%ZVEMSP",71,0)
 S ^%ZVEMS("PARAM",VEE("ID"),"BS")="SAME"
"RTN","%ZVEMSP",72,0)
 Q
"RTN","%ZVEMSP",73,0)
 ;====================================================================
"RTN","%ZVEMSP",74,0)
WIDTH ;Set screen width.
"RTN","%ZVEMSP",75,0)
 NEW DEF,WIDTH
"RTN","%ZVEMSP",76,0)
 S DEF=$G(^%ZVEMS("PARAM",VEE("ID"),"WIDTH"))
"RTN","%ZVEMSP",77,0)
 S:'DEF DEF=80
"RTN","%ZVEMSP",78,0)
 D MSG
"RTN","%ZVEMSP",79,0)
WIDTH1 W !?1,"Enter SCREEN WIDTH: "_DEF_"// "
"RTN","%ZVEMSP",80,0)
 R WIDTH:300 S:'$T WIDTH="^" S:WIDTH="" WIDTH=DEF Q:"^"[WIDTH
"RTN","%ZVEMSP",81,0)
 I WIDTH'?1.N!(WIDTH'>0) D  G WIDTH1
"RTN","%ZVEMSP",82,0)
 . W !?1,"Enter your screen width."
"RTN","%ZVEMSP",83,0)
 S ^%ZVEMS("PARAM",VEE("ID"),"WIDTH")=WIDTH
"RTN","%ZVEMSP",84,0)
 Q
"RTN","%ZVEMSP",85,0)
 ;====================================================================
"RTN","%ZVEMSP",86,0)
LENGTH ;Set screen length.
"RTN","%ZVEMSP",87,0)
 NEW DEF,LEN
"RTN","%ZVEMSP",88,0)
 S DEF=$G(^%ZVEMS("PARAM",VEE("ID"),"LENGTH"))
"RTN","%ZVEMSP",89,0)
 S:'DEF DEF=24
"RTN","%ZVEMSP",90,0)
 D MSG
"RTN","%ZVEMSP",91,0)
LENGTH1 W !?1,"Enter SCREEN LENGTH: "_DEF_"// "
"RTN","%ZVEMSP",92,0)
 R LEN:300 S:'$T LEN="^" S:LEN="" LEN=DEF Q:"^"[LEN
"RTN","%ZVEMSP",93,0)
 I LEN'?1.N!(LEN'>0) D  G LENGTH1
"RTN","%ZVEMSP",94,0)
 . W !?1,"Enter your screen length."
"RTN","%ZVEMSP",95,0)
 S ^%ZVEMS("PARAM",VEE("ID"),"LENGTH")=LEN
"RTN","%ZVEMSP",96,0)
 Q
"RTN","%ZVEMSP",97,0)
 ;====================================================================
"RTN","%ZVEMSP",98,0)
MSG ;
"RTN","%ZVEMSP",99,0)
 W !," You must exit and reenter the Shell for change to take effect."
"RTN","%ZVEMSP",100,0)
 Q
"RTN","%ZVEMSP",101,0)
INIT ;
"RTN","%ZVEMSP",102,0)
 S DOT="...............",$P(LINE,"=",220)=""
"RTN","%ZVEMSP",103,0)
 Q
"RTN","%ZVEMSPS")
0^146^B6417846
"RTN","%ZVEMSPS",1,0)
%ZVEMSPS ;DJB,VSHL**Print Symbol Table (..ZW) ; 9/3/99 2:56pm
"RTN","%ZVEMSPS",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMSPS",3,0)
 ;
"RTN","%ZVEMSPS",4,0)
WRITE(StarT) ;
"RTN","%ZVEMSPS",5,0)
 ; StartT is mixed case so it isn't already in symbol table
"RTN","%ZVEMSPS",6,0)
 ;
"RTN","%ZVEMSPS",7,0)
 I '$$EXIST^%ZVEMKU("%ZOSV") D  Q
"RTN","%ZVEMSPS",8,0)
 . W !,"This QWIK requires routine ^%ZOSV.",!
"RTN","%ZVEMSPS",9,0)
 ;
"RTN","%ZVEMSPS",10,0)
 KILL ^TMP("VEE",$J)
"RTN","%ZVEMSPS",11,0)
 D INIT
"RTN","%ZVEMSPS",12,0)
 D SAVE
"RTN","%ZVEMSPS",13,0)
 I '$D(^TMP("VEE",$J,"SYM")) W !,"Symbol Table is empty.." G EX
"RTN","%ZVEMSPS",14,0)
 D START
"RTN","%ZVEMSPS",15,0)
 D LIST^%ZVEMKT("^TMP(""VEE"","_$J_",""LIST"")")
"RTN","%ZVEMSPS",16,0)
EX ;
"RTN","%ZVEMSPS",17,0)
 W !
"RTN","%ZVEMSPS",18,0)
 KILL ^TMP("VEE",$J)
"RTN","%ZVEMSPS",19,0)
 Q
"RTN","%ZVEMSPS",20,0)
 ;
"RTN","%ZVEMSPS",21,0)
SAVE ;Save symbol table to ^TMP("VEE",$J,"SYM",var)
"RTN","%ZVEMSPS",22,0)
 NEW %,%X,%Y,X,Y
"RTN","%ZVEMSPS",23,0)
 S X="^TMP(""VEE"","_$J_",""SYM""," D DOLRO^%ZOSV
"RTN","%ZVEMSPS",24,0)
 ;
"RTN","%ZVEMSPS",25,0)
 NEW I,XxX
"RTN","%ZVEMSPS",26,0)
 F I="%","%X","%Y","X","Y","StarT","VEE","VEESHC","VEESHL" D  ;
"RTN","%ZVEMSPS",27,0)
 . KILL ^TMP("VEE",$J,"SYM",I)
"RTN","%ZVEMSPS",28,0)
 F I="%","%X","%Y","X","Y","StarT" I $D(^TMP("VEE",$J,"VAR",I))  D  ;
"RTN","%ZVEMSPS",29,0)
 . S ^TMP("VEE",$J,"SYM",I)=^(I)
"RTN","%ZVEMSPS",30,0)
 . S XxX=I
"RTN","%ZVEMSPS",31,0)
 . F  S XxX=$O(^TMP("VEE",$J,"VAR",XxX)) Q:XxX=""!($P(XxX,"(",1)'=I)  S ^TMP("VEE",$J,"SYM",XxX)=^(XxX)
"RTN","%ZVEMSPS",32,0)
 Q
"RTN","%ZVEMSPS",33,0)
 ;
"RTN","%ZVEMSPS",34,0)
START ;
"RTN","%ZVEMSPS",35,0)
 NEW %,%CNT,%DOT,%IEN,%L,%TXT,%TMP,%VAL,%VAR
"RTN","%ZVEMSPS",36,0)
 S ^TMP("VEE",$J,"LIST",1)=$J("",28)_"S Y M B O L   T A B L E"
"RTN","%ZVEMSPS",37,0)
 S %CNT=1,%IEN=2
"RTN","%ZVEMSPS",38,0)
 S %TMP="^TMP(""VEE"","_$J_",""SYM"")"
"RTN","%ZVEMSPS",39,0)
 S %="TMP(""VEE"","_$J_",""SYM"","
"RTN","%ZVEMSPS",40,0)
 F  S %TMP=$Q(@%TMP) Q:%TMP=""!(%TMP'[%)  D BUILD
"RTN","%ZVEMSPS",41,0)
 Q
"RTN","%ZVEMSPS",42,0)
 ;
"RTN","%ZVEMSPS",43,0)
BUILD ;Build array in ^%ZVEMS("ZZLIST","SYMTBL"_$J) to pass to scroller
"RTN","%ZVEMSPS",44,0)
 S %VAR=$P(%TMP,",",4),%VAR=$P(%VAR,"""",2) ;Strip quotes
"RTN","%ZVEMSPS",45,0)
 I $P(%TMP,",",5)]""  S %VAR=%VAR_"("_$P(%TMP,",",5,99)
"RTN","%ZVEMSPS",46,0)
 Q:StarT]%VAR
"RTN","%ZVEMSPS",47,0)
 S %VAL=@%TMP
"RTN","%ZVEMSPS",48,0)
 S %TXT=$J(%CNT,3)_". "_%VAR
"RTN","%ZVEMSPS",49,0)
 S %DOT=$S($L(%VAR)<11:$E(".............",1,12-$L(%VAR)),1:"..")_": "
"RTN","%ZVEMSPS",50,0)
 S %TXT=%TXT_%DOT,%L=$L(%TXT)
"RTN","%ZVEMSPS",51,0)
 S %TXT=%TXT_$E(%VAL,1,VEE("IOM")-1-%L)
"RTN","%ZVEMSPS",52,0)
 S %VAL=$E(%VAL,VEE("IOM")-%L,9999)
"RTN","%ZVEMSPS",53,0)
 S ^TMP("VEE",$J,"LIST",%IEN)=%TXT,%CNT=%CNT+1,%IEN=%IEN+1
"RTN","%ZVEMSPS",54,0)
BUILD1 Q:%VAL']""
"RTN","%ZVEMSPS",55,0)
 S %TXT=$E(%VAL,1,VEE("IOM")-1-%L)
"RTN","%ZVEMSPS",56,0)
 S ^TMP("VEE",$J,"LIST",%IEN)=$J("",%L)_%TXT,%IEN=%IEN+1
"RTN","%ZVEMSPS",57,0)
 S %VAL=$E(%VAL,VEE("IOM")-%L,9999)
"RTN","%ZVEMSPS",58,0)
 G BUILD1
"RTN","%ZVEMSPS",59,0)
INIT ;
"RTN","%ZVEMSPS",60,0)
 NEW %TMP
"RTN","%ZVEMSPS",61,0)
 S StarT=$G(StarT)
"RTN","%ZVEMSPS",62,0)
 F XxX="%","%X","%Y","X","Y" I $D(@XxX)#2 D  ;
"RTN","%ZVEMSPS",63,0)
 . S ^TMP("VEE",$J,"VAR",XxX)=@XxX
"RTN","%ZVEMSPS",64,0)
 . S %TMP=XxX
"RTN","%ZVEMSPS",65,0)
 . F  S %TMP=$Q(@%TMP) Q:%TMP=""!(%TMP'[XxX)  D  ;
"RTN","%ZVEMSPS",66,0)
 .. S ^TMP("VEE",$J,"VAR",%TMP)=@%TMP
"RTN","%ZVEMSPS",67,0)
 KILL XxX,%1,%2,%3,%4,%5,%6,%7,%8,%9
"RTN","%ZVEMSPS",68,0)
 Q
"RTN","%ZVEMSQ")
0^147^B6921882
"RTN","%ZVEMSQ",1,0)
%ZVEMSQ ;DJB,VSHL**QWIKs - Add/Edit [1/16/96 11:06pm]
"RTN","%ZVEMSQ",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMSQ",3,0)
 ;
"RTN","%ZVEMSQ",4,0)
 NEW BOX,BX,CD,CDHLD,FLAGJMP,FLAGQ,I,NAM,PROMPT
"RTN","%ZVEMSQ",5,0)
 ;Next 5 lines for viewing BOX
"RTN","%ZVEMSQ",6,0)
 I $E(VEESHC)="." G:VEESHC'?1.2"."1.N.1A EX NEW BOX,TYPE D  D LISTQ^%ZVEMSQL(BOX,TYPE) G EX
"RTN","%ZVEMSQ",7,0)
 . I VEESHC?1"."1.N S BOX=$E(VEESHC,2,99),TYPE=1 Q 
"RTN","%ZVEMSQ",8,0)
 . I VEESHC?1"."1.N1A S BOX=$E(VEESHC,2,$L(VEESHC)-1),TYPE=2 Q
"RTN","%ZVEMSQ",9,0)
 . I VEESHC?1".."1.N S BOX=$E(VEESHC,3,99),TYPE=3 Q
"RTN","%ZVEMSQ",10,0)
 . I VEESHC?1".."1.N1A S BOX=$E(VEESHC,3,$L(VEESHC)-1),TYPE=4 Q
"RTN","%ZVEMSQ",11,0)
 I "<AD>,<AL>,<AU>,<F1-1>,<F1-2>,<F1-3>,<F1-4>,<QD>,<TAB>"'[VEESHC G EX
"RTN","%ZVEMSQ",12,0)
 I VEESHC?1"<A".E D EN^%ZVEMSCL("VSHL") G EX ;Cmnd Line History
"RTN","%ZVEMSQ",13,0)
 D @$S(VEESHC="<F1-1>":"LISTQ^%ZVEMSQL("""",1)",VEESHC="<F1-2>":"LISTQ^%ZVEMSQL("""",2)",VEESHC="<F1-3>":"LISTQ^%ZVEMSQL("""",3)",VEESHC="<F1-4>":"LISTQ^%ZVEMSQL("""",4)",1:"ADD")
"RTN","%ZVEMSQ",14,0)
EX ;
"RTN","%ZVEMSQ",15,0)
 Q
"RTN","%ZVEMSQ",16,0)
ADD ;Add/Edit a QWIK
"RTN","%ZVEMSQ",17,0)
 W !!?1,"*** Add/Edit QWIK Command ***"
"RTN","%ZVEMSQ",18,0)
ADD1 S (FLAGQ,FLAGJMP)=0 D GETNAM(1) Q:FLAGQ  D DISPLAY^%ZVEMSQA
"RTN","%ZVEMSQ",19,0)
ADD2 D NAME^%ZVEMSQE G:VEESHC="<TAB>" ADD1 Q:FLAGQ
"RTN","%ZVEMSQ",20,0)
 D CODE^%ZVEMSQE G:VEESHC="<TAB>" ADD1 Q:FLAGQ
"RTN","%ZVEMSQ",21,0)
 D TEXT^%ZVEMSQE("DSC") G:VEESHC="<TAB>" ADD1 Q:FLAGQ
"RTN","%ZVEMSQ",22,0)
 D TEXT^%ZVEMSQE("PARAM") G:VEESHC="<TAB>" ADD1 Q:FLAGQ
"RTN","%ZVEMSQ",23,0)
 D BOX^%ZVEMSQE Q:FLAGQ
"RTN","%ZVEMSQ",24,0)
 I FLAGJMP G ADD2 ;User hit <ESC> and number of field to jump to
"RTN","%ZVEMSQ",25,0)
 G ADD1
"RTN","%ZVEMSQ",26,0)
 ;====================================================================
"RTN","%ZVEMSQ",27,0)
GETNAM(LAYGO) ;Get name of QWIK.
"RTN","%ZVEMSQ",28,0)
 ;LAYGO=If 1 you may select name of QWIK that doesn't already exist.
"RTN","%ZVEMSQ",29,0)
GETNAM1 W ! S CD="" D SCREEN^%ZVEMKEA("Enter QWIK: ",1,VEE("IOM")-2)
"RTN","%ZVEMSQ",30,0)
 I CD="?"!(VEESHC="<ESCH>") D  G GETNAM1
"RTN","%ZVEMSQ",31,0)
 . I '$G(LAYGO) D MSG^%ZVEMSQA(8),MSG^%ZVEMSQA(7) Q
"RTN","%ZVEMSQ",32,0)
 . D MSG^%ZVEMSQA(1),MSG^%ZVEMSQA(7)
"RTN","%ZVEMSQ",33,0)
 I ",<ESC>,<F1E>,<F1Q>,<TAB>,<TO>,"[(","_VEESHC_",")!(CD']"")!(CD="^") S FLAGQ=1 Q
"RTN","%ZVEMSQ",34,0)
 I CD="??" D USER^%ZVEMSQS G GETNAM1
"RTN","%ZVEMSQ",35,0)
 I CD=" " S CD=$G(^%ZVEMS("%",$J_$G(^%ZVEMS("SY")),"LASTQWIK")) I CD']"" G GETNAM1
"RTN","%ZVEMSQ",36,0)
 S CD=$$ALLCAPS^%ZVEMKU(CD)
"RTN","%ZVEMSQ",37,0)
 I CD'?1A.7AN D MSG^%ZVEMSQA(1),MSG^%ZVEMSQA(7) G GETNAM1
"RTN","%ZVEMSQ",38,0)
 I $D(^%ZVEMS("QU",VEE("ID"),CD))>1,$G(^(CD))']"" KILL ^%ZVEMS("QU",VEE("ID"),CD) ;Clean up any bad nodes.
"RTN","%ZVEMSQ",39,0)
 I '$G(LAYGO),$G(^%ZVEMS("QU",VEE("ID"),CD))']"" D  G GETNAM1
"RTN","%ZVEMSQ",40,0)
 . D MSG^%ZVEMSQA(8),MSG^%ZVEMSQA(7)
"RTN","%ZVEMSQ",41,0)
 S NAM=CD,^%ZVEMS("%",$J_$G(^%ZVEMS("SY")),"LASTQWIK")=NAM
"RTN","%ZVEMSQ",42,0)
 Q
"RTN","%ZVEMSQA")
0^148^B6445449
"RTN","%ZVEMSQA",1,0)
%ZVEMSQA ;DJB,VSHL**QWIKs - Display,Msg [1/16/96 11:04pm]
"RTN","%ZVEMSQA",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMSQA",3,0)
 ;
"RTN","%ZVEMSQA",4,0)
DISPLAY ;Display QWIK info
"RTN","%ZVEMSQA",5,0)
 NEW CD,I,LMAR,PROMPT,START,WIDTH
"RTN","%ZVEMSQA",6,0)
 W @VEE("IOF"),!?1,"ADD/EDIT USER QWIK",!?1 F I=1:1:VEE("IOM")-2 W "-"
"RTN","%ZVEMSQA",7,0)
 W !?1,"1) NAME:  ",NAM I NAM="TO" D TO
"RTN","%ZVEMSQA",8,0)
 W !?1,"2) CODE:" S CD=$G(^%ZVEMS("QU",VEE("ID"),NAM)) I CD]"" S PROMPT="",(LMAR,START)=11,WIDTH=VEE("IOM")-12 D LISTCD^%ZVEMKEA
"RTN","%ZVEMSQA",9,0)
 W !?1,"3) DESC:  " W $P($G(^(NAM,"DSC")),"^")
"RTN","%ZVEMSQA",10,0)
 W !?1,"4) PARAM: " W $P($G(^("DSC")),"^",2)
"RTN","%ZVEMSQA",11,0)
 W !?1,"5) BOX:   " W $P($G(^("DSC")),"^",3)
"RTN","%ZVEMSQA",12,0)
 W !?1 F I=1:1:VEE("IOM")-2 W "-"
"RTN","%ZVEMSQA",13,0)
 W !?1,"<ESC><ESC>=Quit  <TAB>=Restart  <ESC>H=Help  <ESC>1-5=Field  <ESC>U=UNsav"
"RTN","%ZVEMSQA",14,0)
 W ! Q
"RTN","%ZVEMSQA",15,0)
 ;====================================================================
"RTN","%ZVEMSQA",16,0)
TO ;WARNING - If QWIK is named TO, it'll be executed if VShell times-out.
"RTN","%ZVEMSQA",17,0)
 W $C(7),?22,"WARNING: This QWIK will be executed if VShell times-out."
"RTN","%ZVEMSQA",18,0)
 Q
"RTN","%ZVEMSQA",19,0)
 ;====================================================================
"RTN","%ZVEMSQA",20,0)
JUMP ;Set FLAGJMP=Field you wish to edit
"RTN","%ZVEMSQA",21,0)
 S FLAGJMP=0 I VEESHC?1"<ESC"1N1">",$E(VEESHC,5)>0,$E(VEESHC,5)<6 S FLAGJMP=$E(VEESHC,5)
"RTN","%ZVEMSQA",22,0)
 Q
"RTN","%ZVEMSQA",23,0)
 ;====================================================================
"RTN","%ZVEMSQA",24,0)
UNSAVE ;UNsave code SAved from a routine or global.
"RTN","%ZVEMSQA",25,0)
 NEW J
"RTN","%ZVEMSQA",26,0)
 I '$D(^%ZVEMS("E","SAVE",$J,1)) W $C(7),!?1,"No code saved.." Q
"RTN","%ZVEMSQA",27,0)
 S CD=^%ZVEMS("E","SAVE",$J,1)
"RTN","%ZVEMSQA",28,0)
 F J=1:1:($L(CD,$C(9))-1) S CD=$P(CD,$C(9),1)_$P(CD,$C(9),2,999)
"RTN","%ZVEMSQA",29,0)
 W !?1,"1 line of code UNsaved.."
"RTN","%ZVEMSQA",30,0)
 Q
"RTN","%ZVEMSQA",31,0)
 ;====================================================================
"RTN","%ZVEMSQA",32,0)
MSG(NUM) ;Messages
"RTN","%ZVEMSQA",33,0)
 ;NUM=Subroutine
"RTN","%ZVEMSQA",34,0)
 Q:$G(NUM)'>0  D @NUM
"RTN","%ZVEMSQA",35,0)
 Q
"RTN","%ZVEMSQA",36,0)
1 ;Name
"RTN","%ZVEMSQA",37,0)
 W !?3,"QWIK must be from 1 to 8 characters long."
"RTN","%ZVEMSQA",38,0)
 W !?3,"The 1st character must be alpha."
"RTN","%ZVEMSQA",39,0)
 W !?3,"Remaining 7 characters may be alpha/numeric."
"RTN","%ZVEMSQA",40,0)
 Q
"RTN","%ZVEMSQA",41,0)
2 W !?3,"Enter from 1 to 245 characters of M Code, or <ESC>U to UNsave code." Q
"RTN","%ZVEMSQA",42,0)
3 W !?3,"Enter from 1 to 55 Alph/Numeric/Punctuation. '^' Character not allowed." Q
"RTN","%ZVEMSQA",43,0)
4 W $C(7),!?3,"You can not have an '^' character in your text." Q
"RTN","%ZVEMSQA",44,0)
5 W !?3,"Enter display BOX number. Any whole number greater than zero." Q
"RTN","%ZVEMSQA",45,0)
6 W $C(7),!?3,"This QWIK already exists." Q
"RTN","%ZVEMSQA",46,0)
7 W !?3,"Enter '??' for a list of your QWIK Commands." Q
"RTN","%ZVEMSQA",47,0)
8 W !?3,"Enter the name of an existing QWIK." Q
"RTN","%ZVEMSQE")
0^149^B11786287
"RTN","%ZVEMSQE",1,0)
%ZVEMSQE ;DJB,VSHL**QWIKs - Edit Name,Code,Description,Param,Box [9/9/95 6:34pm]
"RTN","%ZVEMSQE",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMSQE",3,0)
 ;
"RTN","%ZVEMSQE",4,0)
NAME ;Edit QWIK Name
"RTN","%ZVEMSQE",5,0)
 Q:$G(NAM)']""  Q:'$D(^%ZVEMS("QU",VEE("ID"),NAM))
"RTN","%ZVEMSQE",6,0)
 I $G(FLAGJMP) Q:FLAGJMP'=1
"RTN","%ZVEMSQE",7,0)
 S CD=NAM D SCREEN^%ZVEMKEA("Edit NAME: ",1,VEE("IOM")-1)
"RTN","%ZVEMSQE",8,0)
 D JUMP^%ZVEMSQA Q:FLAGJMP
"RTN","%ZVEMSQE",9,0)
 I VEESHC="<ESCH>" D MSG^%ZVEMSQA(1) G NAME
"RTN","%ZVEMSQE",10,0)
 I ",<ESC>,<F1E>,<F1Q>,<TO>,"[(","_VEESHC_",") S FLAGQ=1 Q
"RTN","%ZVEMSQE",11,0)
 I VEESHC="<TAB>" Q
"RTN","%ZVEMSQE",12,0)
 I VEESHC'="<RET>",VEESHC?1"<".E1">".E G NAME
"RTN","%ZVEMSQE",13,0)
 S CD=$$ALLCAPS^%ZVEMKU(CD) I NAM=CD Q
"RTN","%ZVEMSQE",14,0)
 I CD']""!(CD="^") G:$$ASKDEL^%ZVEMSQU()'=1 NAME KILL ^%ZVEMS("QU",VEE("ID"),NAM) S VEESHC="<TAB>" W !!?1,NAM," deleted.." Q
"RTN","%ZVEMSQE",15,0)
 I CD'?1A.7AN D MSG^%ZVEMSQA(1) G NAME
"RTN","%ZVEMSQE",16,0)
 I $D(^%ZVEMS("QU",VEE("ID"),CD)) D MSG^%ZVEMSQA(6) G NAME
"RTN","%ZVEMSQE",17,0)
 S ^%ZVEMS("QU",VEE("ID"),CD)=^%ZVEMS("QU",VEE("ID"),NAM)
"RTN","%ZVEMSQE",18,0)
 NEW X S X="" F  S X=$O(^%ZVEMS("QU",VEE("ID"),NAM,X)) Q:X=""  S ^%ZVEMS("QU",VEE("ID"),CD,X)=^%ZVEMS("QU",VEE("ID"),NAM,X)
"RTN","%ZVEMSQE",19,0)
 KILL ^%ZVEMS("QU",VEE("ID"),NAM)
"RTN","%ZVEMSQE",20,0)
 S NAM=CD
"RTN","%ZVEMSQE",21,0)
 Q
"RTN","%ZVEMSQE",22,0)
 ;====================================================================
"RTN","%ZVEMSQE",23,0)
CODE ;Get M Code
"RTN","%ZVEMSQE",24,0)
 I $G(FLAGJMP),$D(^%ZVEMS("QU",VEE("ID"),NAM)) Q:FLAGJMP'=2
"RTN","%ZVEMSQE",25,0)
 S (CD,CDHLD)=$G(^%ZVEMS("QU",VEE("ID"),NAM))
"RTN","%ZVEMSQE",26,0)
CODE1 D SCREEN^%ZVEMKEA("Edit CODE: ",1,VEE("IOM")-1)
"RTN","%ZVEMSQE",27,0)
 D JUMP^%ZVEMSQA Q:FLAGJMP
"RTN","%ZVEMSQE",28,0)
 I CD="?"!(CD="??")!(VEESHC="<ESCH>") D MSG^%ZVEMSQA(2) G CODE
"RTN","%ZVEMSQE",29,0)
 I VEESHC="<ESCU>",CD]"" W $C(7) Q
"RTN","%ZVEMSQE",30,0)
 I VEESHC="<ESCU>" D UNSAVE^%ZVEMSQA I CD']"" G CODE
"RTN","%ZVEMSQE",31,0)
 I ",<ESC>,<F1E>,<F1Q>,<TO>,"[(","_VEESHC_",") S FLAGQ=1 Q
"RTN","%ZVEMSQE",32,0)
 I VEESHC="<TAB>" Q
"RTN","%ZVEMSQE",33,0)
 I VEESHC'="<RET>",VEESHC'="<ESCU>",VEESHC?1"<".E1">".E G CODE
"RTN","%ZVEMSQE",34,0)
 I CD']""!(CD="^") G:'$$ASKDEL^%ZVEMSQU() CODE  KILL ^%ZVEMS("QU",VEE("ID"),NAM) S VEESHC="<TAB>" W !!?1,NAM," deleted.." Q
"RTN","%ZVEMSQE",35,0)
 D KILLCHK^%ZVEMKU(CD)
"RTN","%ZVEMSQE",36,0)
 I CD'=CDHLD  S ^%ZVEMS("QU",VEE("ID"),NAM)=CD
"RTN","%ZVEMSQE",37,0)
 I VEESHC="TOO LONG" G CODE1
"RTN","%ZVEMSQE",38,0)
 Q
"RTN","%ZVEMSQE",39,0)
 ;====================================================================
"RTN","%ZVEMSQE",40,0)
TEXT(TYPE) ;Text for Description and Param Notes. TYPE=DSC or PARAM
"RTN","%ZVEMSQE",41,0)
 I $G(TYPE)'="DSC",$G(TYPE)'="PARAM" Q
"RTN","%ZVEMSQE",42,0)
 Q:'$D(^%ZVEMS("QU",VEE("ID"),NAM))
"RTN","%ZVEMSQE",43,0)
 I $G(FLAGJMP) Q:TYPE="DSC"&(FLAGJMP'=3)  Q:TYPE="PARAM"&(FLAGJMP'=4)
"RTN","%ZVEMSQE",44,0)
TEXT1 I TYPE="DSC" S CD=$P($G(^%ZVEMS("QU",VEE("ID"),NAM,"DSC")),"^",1),PROMPT="Edit DESCRIPTION: "
"RTN","%ZVEMSQE",45,0)
 I TYPE="PARAM" S CD=$P($G(^%ZVEMS("QU",VEE("ID"),NAM,"DSC")),"^",2),PROMPT="Edit PARAM NOTES: "
"RTN","%ZVEMSQE",46,0)
 D SCREEN^%ZVEMKEA(PROMPT,1,VEE("IOM")-1)
"RTN","%ZVEMSQE",47,0)
 D JUMP^%ZVEMSQA Q:FLAGJMP
"RTN","%ZVEMSQE",48,0)
 I CD="?"!(CD="??")!(VEESHC="<ESCH>") D MSG^%ZVEMSQA(3) G TEXT1
"RTN","%ZVEMSQE",49,0)
 I ",<ESC>,<F1E>,<F1Q>,<TO>,"[(","_VEESHC_",") S FLAGQ=1 Q
"RTN","%ZVEMSQE",50,0)
 S:CD="^" VEESHC="<TAB>" Q:VEESHC="<TAB>"
"RTN","%ZVEMSQE",51,0)
 I VEESHC'="<RET>",VEESHC?1"<".E1">".E G TEXT1
"RTN","%ZVEMSQE",52,0)
 I CD["^" D MSG^%ZVEMSQA(4) G TEXT1
"RTN","%ZVEMSQE",53,0)
 I CD]"",CD'?1.55ANP W $C(7) D MSG^%ZVEMSQA(3) G TEXT1
"RTN","%ZVEMSQE",54,0)
 I TYPE="DSC" S $P(^%ZVEMS("QU",VEE("ID"),NAM,"DSC"),"^",1)=CD
"RTN","%ZVEMSQE",55,0)
 I TYPE="PARAM" S $P(^%ZVEMS("QU",VEE("ID"),NAM,"DSC"),"^",2)=CD
"RTN","%ZVEMSQE",56,0)
 Q
"RTN","%ZVEMSQE",57,0)
 ;====================================================================
"RTN","%ZVEMSQE",58,0)
BOX ;Display Box
"RTN","%ZVEMSQE",59,0)
 Q:'$D(^%ZVEMS("QU",VEE("ID"),NAM))
"RTN","%ZVEMSQE",60,0)
 I $G(FLAGJMP) Q:FLAGJMP'=5
"RTN","%ZVEMSQE",61,0)
 S CD=$P($G(^%ZVEMS("QU",VEE("ID"),NAM,"DSC")),"^",3)
"RTN","%ZVEMSQE",62,0)
 D SCREEN^%ZVEMKEA("Edit BOX: ",1,VEE("IOM")-1)
"RTN","%ZVEMSQE",63,0)
 D JUMP^%ZVEMSQA Q:FLAGJMP
"RTN","%ZVEMSQE",64,0)
 I CD="?"!(CD="??")!(VEESHC="<ESCH>") D MSG^%ZVEMSQA(5) G BOX
"RTN","%ZVEMSQE",65,0)
 I ",<ESC>,<F1E>,<F1Q>,<TO>,"[(","_VEESHC_",") S FLAGQ=1 Q
"RTN","%ZVEMSQE",66,0)
 S:CD="^" VEESHC="<TAB>" Q:VEESHC="<TAB>"
"RTN","%ZVEMSQE",67,0)
 I VEESHC'="<RET>",VEESHC?1"<".E1">".E G BOX
"RTN","%ZVEMSQE",68,0)
 I CD]"",CD'?1.N!(CD'>0) W $C(7) D MSG^%ZVEMSQA(5) G BOX
"RTN","%ZVEMSQE",69,0)
 S $P(^%ZVEMS("QU",VEE("ID"),NAM,"DSC"),"^",3)=CD
"RTN","%ZVEMSQE",70,0)
 Q
"RTN","%ZVEMSQL")
0^150^B11218369
"RTN","%ZVEMSQL",1,0)
%ZVEMSQL ;DJB,VSHL**QWIKs - List QWIKs [9/9/95 6:36pm]
"RTN","%ZVEMSQL",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMSQL",3,0)
 ;
"RTN","%ZVEMSQL",4,0)
LISTQ(BOX,TYPE) ;List QWIKs. BOX=Display Box
"RTN","%ZVEMSQL",5,0)
 ;TYPE=1-User Desc,2-User Code,3-Sys Desc,4-Sys Code
"RTN","%ZVEMSQL",6,0)
 NEW X S X="ERROR^%ZVEMSQL",@($$TRAP^%ZVEMKU1) KILL X
"RTN","%ZVEMSQL",7,0)
 NEW CNT,FLAGQ,TEMP,X
"RTN","%ZVEMSQL",8,0)
 NEW DX,DY,VEET NEW:'$D(VEES) VEES
"RTN","%ZVEMSQL",9,0)
 S BOX=$G(BOX),FLAGQ=0 S:$G(TYPE)="" TYPE=1
"RTN","%ZVEMSQL",10,0)
 D IMPORT,@$S("34"[TYPE:"LISTS",1:"LISTU")
"RTN","%ZVEMSQL",11,0)
 D IMPORTF^%ZVEMKT KILL ^TMP("VEE",$J,"K")
"RTN","%ZVEMSQL",12,0)
 Q
"RTN","%ZVEMSQL",13,0)
LISTU ;List User QWIKs
"RTN","%ZVEMSQL",14,0)
 S CNT=1,X="@"
"RTN","%ZVEMSQL",15,0)
 F  S X=$O(^%ZVEMS("QU",VEE("ID"),X)) Q:X=""  D LISTU1 Q:FLAGQ
"RTN","%ZVEMSQL",16,0)
 I CNT=1 D
"RTN","%ZVEMSQL",17,0)
 . I BOX S VEET="No User QWIKs assigned to this box." D ^%ZVEMKT Q
"RTN","%ZVEMSQL",18,0)
 . S VEET="No User QWIKs on record. Is your DUZ correct?" D ^%ZVEMKT
"RTN","%ZVEMSQL",19,0)
 Q
"RTN","%ZVEMSQL",20,0)
LISTU1 ;
"RTN","%ZVEMSQL",21,0)
 Q:$G(^%ZVEMS("QU",VEE("ID"),X))']""
"RTN","%ZVEMSQL",22,0)
 I BOX,$P($G(^(X,"DSC")),"^",3)'=BOX Q
"RTN","%ZVEMSQL",23,0)
 S VEET=$J(CNT,3)_") "_X,VEET=VEET_$J("",15-$L(VEET))
"RTN","%ZVEMSQL",24,0)
 I 'BOX S VEET=VEET_$J($P($G(^%ZVEMS("QU",VEE("ID"),X,"DSC")),"^",3),4)_"  "
"RTN","%ZVEMSQL",25,0)
 I TYPE=1 D
"RTN","%ZVEMSQL",26,0)
 . S VEET=VEET_$P($G(^%ZVEMS("QU",VEE("ID"),X,"DSC")),"^")
"RTN","%ZVEMSQL",27,0)
 . D ^%ZVEMKT Q:FLAGQ
"RTN","%ZVEMSQL",28,0)
 . Q:$P($G(^%ZVEMS("QU",VEE("ID"),X,"DSC")),"^",2)']""
"RTN","%ZVEMSQL",29,0)
 . S TEMP=$S('BOX:21,1:15)
"RTN","%ZVEMSQL",30,0)
 . S VEET=$J("",TEMP)_"-> "_$P(^("DSC"),"^",2) D ^%ZVEMKT Q
"RTN","%ZVEMSQL",31,0)
 I TYPE=2 D
"RTN","%ZVEMSQL",32,0)
 . S TEMP=$S($D(^%ZVEMS("QU",VEE("ID"),X,VEE("OS"))):^(VEE("OS")),1:^%ZVEMS("QU",VEE("ID"),X)) D CD
"RTN","%ZVEMSQL",33,0)
 S CNT=CNT+1
"RTN","%ZVEMSQL",34,0)
 Q
"RTN","%ZVEMSQL",35,0)
LISTS ;List System QWIKs
"RTN","%ZVEMSQL",36,0)
 S CNT=1,X="@"
"RTN","%ZVEMSQL",37,0)
 F  S X=$O(^%ZVEMS("QS",X)) Q:X=""  D LISTS1 Q:FLAGQ
"RTN","%ZVEMSQL",38,0)
 I CNT=1 D
"RTN","%ZVEMSQL",39,0)
 . I 'BOX S VEET="No System QWIKs on record." D ^%ZVEMKT Q
"RTN","%ZVEMSQL",40,0)
 . S VEET="No System QWIKs assigned to this box." D ^%ZVEMKT
"RTN","%ZVEMSQL",41,0)
 Q
"RTN","%ZVEMSQL",42,0)
LISTS1 ;
"RTN","%ZVEMSQL",43,0)
 Q:$G(^%ZVEMS("QS",X))']""
"RTN","%ZVEMSQL",44,0)
 I BOX,$P($G(^(X,"DSC")),"^",3)'=BOX Q
"RTN","%ZVEMSQL",45,0)
 S VEET=$J(CNT,3)_") "_X,VEET=VEET_$J("",15-$L(VEET))
"RTN","%ZVEMSQL",46,0)
 I 'BOX S VEET=VEET_$J($P($G(^%ZVEMS("QS",X,"DSC")),"^",3),4)_"  "
"RTN","%ZVEMSQL",47,0)
 I TYPE=3 D
"RTN","%ZVEMSQL",48,0)
 . S VEET=VEET_$P($G(^%ZVEMS("QS",X,"DSC")),"^")
"RTN","%ZVEMSQL",49,0)
 . D ^%ZVEMKT Q:FLAGQ
"RTN","%ZVEMSQL",50,0)
 . Q:$P($G(^%ZVEMS("QS",X,"DSC")),"^",2)']""
"RTN","%ZVEMSQL",51,0)
 . S TEMP=$S('BOX:21,1:15)
"RTN","%ZVEMSQL",52,0)
 . S VEET=$J("",TEMP)_"-> "_$P(^("DSC"),"^",2) D ^%ZVEMKT Q
"RTN","%ZVEMSQL",53,0)
 I TYPE=4 D
"RTN","%ZVEMSQL",54,0)
 . S TEMP=$S($D(^%ZVEMS("QS",X,VEE("OS"))):^(VEE("OS")),1:^%ZVEMS("QS",X)) D CD
"RTN","%ZVEMSQL",55,0)
 S CNT=CNT+1
"RTN","%ZVEMSQL",56,0)
 Q
"RTN","%ZVEMSQL",57,0)
CD ;Print Code without wrapping
"RTN","%ZVEMSQL",58,0)
 I BOX D CDBX Q
"RTN","%ZVEMSQL",59,0)
 S VEET=VEET_$E(TEMP,1,57) D ^%ZVEMKT Q:FLAGQ  S TEMP=$E(TEMP,58,999)
"RTN","%ZVEMSQL",60,0)
CD1 Q:TEMP']""  S VEET=$J("",20)_$E(TEMP,1,57) D ^%ZVEMKT Q:FLAGQ
"RTN","%ZVEMSQL",61,0)
 S TEMP=$E(TEMP,58,999)
"RTN","%ZVEMSQL",62,0)
 G CD1
"RTN","%ZVEMSQL",63,0)
CDBX ;Print Code without wrapping when Boxes aren't displayed
"RTN","%ZVEMSQL",64,0)
 S VEET=VEET_$E(TEMP,1,63) D ^%ZVEMKT Q:FLAGQ  S TEMP=$E(TEMP,64,999)
"RTN","%ZVEMSQL",65,0)
CDBX1 Q:TEMP']""  S VEET=$J("",15)_$E(TEMP,1,63) D ^%ZVEMKT Q:FLAGQ
"RTN","%ZVEMSQL",66,0)
 S TEMP=$E(TEMP,64,999)
"RTN","%ZVEMSQL",67,0)
 G CDBX1
"RTN","%ZVEMSQL",68,0)
IMPORT ;Use Scroller
"RTN","%ZVEMSQL",69,0)
 NEW HD1,HD2,HD3,LINE,MAR
"RTN","%ZVEMSQL",70,0)
 S MAR=$G(VEE("IOM")) S:MAR'>0 MAR=80
"RTN","%ZVEMSQL",71,0)
 S $P(LINE,"=",MAR)=""
"RTN","%ZVEMSQL",72,0)
 S HD1="U S E R   Q W I K S   (.QWIK)    ID: "_VEE("ID")
"RTN","%ZVEMSQL",73,0)
 S HD2="S Y S T E M   Q W I K S   (..QWIK)    ID: "_VEE("ID")
"RTN","%ZVEMSQL",74,0)
 S HD3="BOX: "_BOX
"RTN","%ZVEMSQL",75,0)
 S VEET("HD")=2
"RTN","%ZVEMSQL",76,0)
 I "1,2"[TYPE S VEET("HD",1)=HD1_$J(HD3,MAR-1-$L(HD1)-$L(HD3))
"RTN","%ZVEMSQL",77,0)
 I "3,4"[TYPE S VEET("HD",1)=HD2_$J(HD3,MAR-1-$L(HD2)-$L(HD3))
"RTN","%ZVEMSQL",78,0)
 S VEET("HD",2)=LINE
"RTN","%ZVEMSQL",79,0)
 S VEET("S1")=3 D IMPORTS^%ZVEMKT("K")
"RTN","%ZVEMSQL",80,0)
 Q
"RTN","%ZVEMSQL",81,0)
ERROR ;
"RTN","%ZVEMSQL",82,0)
 D ENDSCR^%ZVEMKT2 KILL ^TMP("VEE",$J,"K")
"RTN","%ZVEMSQL",83,0)
 D ERRMSG^%ZVEMKU1("'Scroll QWIKs'"),PAUSE^%ZVEMKU(2)
"RTN","%ZVEMSQL",84,0)
 Q
"RTN","%ZVEMSQS")
0^151^B13199885
"RTN","%ZVEMSQS",1,0)
%ZVEMSQS ;DJB,VSHL**QWIKs - List & Select [9/9/95 7:50pm]
"RTN","%ZVEMSQS",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMSQS",3,0)
 ;
"RTN","%ZVEMSQS",4,0)
QWIK(CD) ;User's entry used the "." or ".." syntax.
"RTN","%ZVEMSQS",5,0)
 NEW I,TYPE
"RTN","%ZVEMSQS",6,0)
 KILL ^TMP("VPE",$J)
"RTN","%ZVEMSQS",7,0)
 D PARAMS G:CD']"" EX D GETTYPE G:CD']"" EX D GETCODE
"RTN","%ZVEMSQS",8,0)
EX ;
"RTN","%ZVEMSQS",9,0)
 KILL ^TMP("VPE",$J)
"RTN","%ZVEMSQS",10,0)
 S VEESHC=CD I CD']"" F I=1:1:9 KILL @("%"_I)
"RTN","%ZVEMSQS",11,0)
 Q
"RTN","%ZVEMSQS",12,0)
PARAMS ;Identify passed parameters.
"RTN","%ZVEMSQS",13,0)
 NEW CK,CNT,J,P,PAR,TMP
"RTN","%ZVEMSQS",14,0)
 ;Find spaces that aren't between quotes.
"RTN","%ZVEMSQS",15,0)
 S (CK,CNT)=0 F  S CNT=CNT+1 Q:$E(CD,CNT)=""  D  ;
"RTN","%ZVEMSQS",16,0)
 . S:$E(CD,CNT)="""" CK=CK=0  Q:CK  Q:$E(CD,CNT)'=" "
"RTN","%ZVEMSQS",17,0)
 . S CD=$E(CD,1,CNT-1)_$C(127)_$E(CD,CNT+1,99)
"RTN","%ZVEMSQS",18,0)
 ;Set parameter variables.
"RTN","%ZVEMSQS",19,0)
 F I=1:1:9 S P="%"_I,@P=$P(CD,$C(127),I+1)  D  ;
"RTN","%ZVEMSQS",20,0)
 . ;Get rid of double quotes
"RTN","%ZVEMSQS",21,0)
 . Q:$E(@P)'=""""  S @P=$E(@P,2,$L(@P)-1) Q:@P'[""""""
"RTN","%ZVEMSQS",22,0)
 . S PAR=@P,TMP=""
"RTN","%ZVEMSQS",23,0)
 . F J=1:1:$L(PAR,"""""") D  ;
"RTN","%ZVEMSQS",24,0)
 . . S TMP=TMP_$P(PAR,"""""",J)_$S(J'=$L(PAR,""""""):"""",1:"")
"RTN","%ZVEMSQS",25,0)
 . S @P=TMP
"RTN","%ZVEMSQS",26,0)
 S CD=$P(CD,$C(127),1)
"RTN","%ZVEMSQS",27,0)
 Q
"RTN","%ZVEMSQS",28,0)
GETTYPE ;Get the type of QWIK. 1=User  2=System
"RTN","%ZVEMSQS",29,0)
 S TYPE=$S(CD?1"..".E:2,1:1)
"RTN","%ZVEMSQS",30,0)
 S (CD,VEESHC)=$E(CD,TYPE+1,99) Q:CD]""
"RTN","%ZVEMSQS",31,0)
 D @$S(TYPE=2:"SYSTEM",1:"USER") ;User typed . or .. only.
"RTN","%ZVEMSQS",32,0)
 Q
"RTN","%ZVEMSQS",33,0)
GETCODE ;Get QWIK command code.
"RTN","%ZVEMSQS",34,0)
 I TYPE=2 S CD=$S($D(^%ZVEMS("QS",CD,VEE("OS"))):^(VEE("OS")),$D(^%ZVEMS("QS",CD)):^(CD),1:"")
"RTN","%ZVEMSQS",35,0)
 E  S CD=$S($D(^%ZVEMS("QU",VEE("ID"),CD,VEE("OS"))):^(VEE("OS")),$D(^%ZVEMS("QU",VEE("ID"),CD)):^(CD),1:"")
"RTN","%ZVEMSQS",36,0)
 Q:CD]""  D @$S(TYPE=1:"LOOKUPU",1:"LOOKUPS")
"RTN","%ZVEMSQS",37,0)
 Q
"RTN","%ZVEMSQS",38,0)
LOOKUPU ;Look up User QWIKs
"RTN","%ZVEMSQS",39,0)
 NEW CNT,FLAGQ,HLD,STAT
"RTN","%ZVEMSQS",40,0)
 S CNT=1,FLAGQ=0,HLD=VEESHC
"RTN","%ZVEMSQS",41,0)
 W ! F  S HLD=$O(^%ZVEMS("QU",VEE("ID"),HLD)) Q:HLD']""!FLAGQ!($E(HLD,1,$L(VEESHC))'=VEESHC)  D  ;
"RTN","%ZVEMSQS",42,0)
 . W !,$J(CNT,3),". ",HLD,?15,$P($G(^(HLD,"DSC")),"^",1)
"RTN","%ZVEMSQS",43,0)
 . S STAT=$E($O(^%ZVEMS("QU",VEE("ID"),HLD)),1,$L(VEESHC))'=VEESHC
"RTN","%ZVEMSQS",44,0)
 . S ^TMP("VPE",$J,CNT)=$S($D(^%ZVEMS("QU",VEE("ID"),HLD,VEE("OS"))):^(VEE("OS")),$D(^%ZVEMS("QU",VEE("ID"),HLD)):^(HLD),1:"")
"RTN","%ZVEMSQS",45,0)
 . S CNT=CNT+1
"RTN","%ZVEMSQS",46,0)
 . I STAT D ASK Q
"RTN","%ZVEMSQS",47,0)
 . I CNT#6=0 D ASK Q
"RTN","%ZVEMSQS",48,0)
 D:CNT=1 NOQWIK
"RTN","%ZVEMSQS",49,0)
 Q
"RTN","%ZVEMSQS",50,0)
LOOKUPS ;Look up System QWIKs
"RTN","%ZVEMSQS",51,0)
 NEW CNT,FLAGQ,HLD,STAT
"RTN","%ZVEMSQS",52,0)
 S CNT=1,FLAGQ=0,HLD=VEESHC
"RTN","%ZVEMSQS",53,0)
 W ! F  S HLD=$O(^%ZVEMS("QS",HLD)) Q:HLD']""!FLAGQ!($E(HLD,1,$L(VEESHC))'=VEESHC)  D  ;
"RTN","%ZVEMSQS",54,0)
 . W !,$J(CNT,3),". ",HLD,?15,$P($G(^(HLD,"DSC")),"^",1)
"RTN","%ZVEMSQS",55,0)
 . S STAT=$E($O(^%ZVEMS("QS",HLD)),1,$L(VEESHC))'=VEESHC
"RTN","%ZVEMSQS",56,0)
 . S ^TMP("VPE",$J,CNT)=$S($D(^%ZVEMS("QS",HLD,VEE("OS"))):^(VEE("OS")),$D(^%ZVEMS("QS",HLD)):^(HLD),1:"")
"RTN","%ZVEMSQS",57,0)
 . S CNT=CNT+1
"RTN","%ZVEMSQS",58,0)
 . I STAT D ASK Q
"RTN","%ZVEMSQS",59,0)
 . I CNT#6=0 D ASK Q
"RTN","%ZVEMSQS",60,0)
 D:CNT=1 NOQWIK
"RTN","%ZVEMSQS",61,0)
 Q
"RTN","%ZVEMSQS",62,0)
ASK ;
"RTN","%ZVEMSQS",63,0)
 NEW ASK
"RTN","%ZVEMSQS",64,0)
ASK1 I 'STAT W !?1,"TYPE '^' TO STOP, OR"
"RTN","%ZVEMSQS",65,0)
 W !?1,"CHOOSE 1-"_(CNT-1)_": "
"RTN","%ZVEMSQS",66,0)
 R ASK:300 S:'$T ASK="^" I "^"[ASK S:ASK="^" FLAGQ=1 Q
"RTN","%ZVEMSQS",67,0)
 I ASK?1.N,$D(^TMP("VPE",$J,ASK)) S CD=^(ASK),FLAGQ=1 Q
"RTN","%ZVEMSQS",68,0)
 W $C(7),"   ??"
"RTN","%ZVEMSQS",69,0)
 G ASK1
"RTN","%ZVEMSQS",70,0)
NOQWIK ;Bogus QWIK entered
"RTN","%ZVEMSQS",71,0)
 W $C(7),!?1,"No such QWIK Command."
"RTN","%ZVEMSQS",72,0)
 W:TYPE=1 " Is your VPE ID correct?"
"RTN","%ZVEMSQS",73,0)
 S CD=""
"RTN","%ZVEMSQS",74,0)
 Q
"RTN","%ZVEMSQS",75,0)
 ;====================================================================
"RTN","%ZVEMSQS",76,0)
USER ;List User QWIKs
"RTN","%ZVEMSQS",77,0)
 NEW COL,FLAGQ,HD,NM
"RTN","%ZVEMSQS",78,0)
 I '$D(^%ZVEMS("QU",VEE("ID"))) W "   No User QWIKs on record" Q
"RTN","%ZVEMSQS",79,0)
 S COL=0,NM="@",FLAGQ=0,HD="U S E R" D HD
"RTN","%ZVEMSQS",80,0)
 F  S NM=$O(^%ZVEMS("QU",VEE("ID"),NM)) Q:NM=""!FLAGQ  D LIST
"RTN","%ZVEMSQS",81,0)
 W !
"RTN","%ZVEMSQS",82,0)
 Q
"RTN","%ZVEMSQS",83,0)
SYSTEM ;List System QWIKs
"RTN","%ZVEMSQS",84,0)
 NEW COL,FLAGQ,HD,NM
"RTN","%ZVEMSQS",85,0)
 I '$D(^%ZVEMS("QS")) W "   No System QWIKs on record" Q
"RTN","%ZVEMSQS",86,0)
 S COL=0,NM="@",FLAGQ=0,HD="S Y S T E M" D HD
"RTN","%ZVEMSQS",87,0)
 F  S NM=$O(^%ZVEMS("QS",NM)) Q:NM=""!FLAGQ  D LIST
"RTN","%ZVEMSQS",88,0)
 W !
"RTN","%ZVEMSQS",89,0)
 Q
"RTN","%ZVEMSQS",90,0)
LIST ;List QWIKs
"RTN","%ZVEMSQS",91,0)
 I 'COL W ! I $Y>(VEE("IOSL")-5) D PAUSEQ^%ZVEMKC(1) Q:FLAGQ  W @VEE("IOF"),!
"RTN","%ZVEMSQS",92,0)
 W ?COL,NM S COL=$S(COL<(VEE("IOM")-10):COL+10,1:0)
"RTN","%ZVEMSQS",93,0)
 Q
"RTN","%ZVEMSQS",94,0)
HD ;Heading
"RTN","%ZVEMSQS",95,0)
 S HD=HD_"   Q W I K S"
"RTN","%ZVEMSQS",96,0)
 W @VEE("IOF"),!?1,HD,!
"RTN","%ZVEMSQS",97,0)
 W $E("-----------------------------",1,$L(HD)+2)
"RTN","%ZVEMSQS",98,0)
 Q
"RTN","%ZVEMSQU")
0^152^B5028790
"RTN","%ZVEMSQU",1,0)
%ZVEMSQU ;DJB,VSHL**QWIKs - Delete,Copy,Boxes [11/06/94]
"RTN","%ZVEMSQU",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMSQU",3,0)
 ;
"RTN","%ZVEMSQU",4,0)
DELETE ;Delete a QWIK
"RTN","%ZVEMSQU",5,0)
 W !?1,"*** Delete QWIK Command ***"
"RTN","%ZVEMSQU",6,0)
 NEW CD,FLAGQ,NAM
"RTN","%ZVEMSQU",7,0)
 F  S FLAGQ=0 D GETNAM^%ZVEMSQ() Q:FLAGQ  D
"RTN","%ZVEMSQU",8,0)
 . Q:$$ASKDEL()'=1
"RTN","%ZVEMSQU",9,0)
 . KILL ^%ZVEMS("QU",VEE("ID"),NAM) W !?1,"Deleted.."
"RTN","%ZVEMSQU",10,0)
 Q
"RTN","%ZVEMSQU",11,0)
ASKDEL() ;Ok to delete? 1=YES  0,2=NO
"RTN","%ZVEMSQU",12,0)
 W !?1,"Are you sure you want to delete this QWIK?"
"RTN","%ZVEMSQU",13,0)
 Q $$CHOICE^%ZVEMKC("YES^NO",1)
"RTN","%ZVEMSQU",14,0)
 ;====================================================================
"RTN","%ZVEMSQU",15,0)
COPY ;Copy QWIK code to a new name
"RTN","%ZVEMSQU",16,0)
 NEW CD,FLAGQ,NAM,TEMP,X
"RTN","%ZVEMSQU",17,0)
 W !?1,"Select QWIK you wish to copy."
"RTN","%ZVEMSQU",18,0)
COPY1 ;
"RTN","%ZVEMSQU",19,0)
 S FLAGQ=0 D GETNAM^%ZVEMSQ() Q:FLAGQ
"RTN","%ZVEMSQU",20,0)
 S TEMP=NAM W !!?1,"Copy this QWIK to what name?"
"RTN","%ZVEMSQU",21,0)
COPY2 ;
"RTN","%ZVEMSQU",22,0)
 D GETNAM^%ZVEMSQ(1) Q:FLAGQ
"RTN","%ZVEMSQU",23,0)
 I $D(^%ZVEMS("QU",VEE("ID"),NAM)) D  G COPY2
"RTN","%ZVEMSQU",24,0)
 . W "   This name is already in use"
"RTN","%ZVEMSQU",25,0)
 S ^(NAM)=^(TEMP) I $D(^(TEMP,"DSC")) S ^%ZVEMS("QU",VEE("ID"),NAM,"DSC")=^%ZVEMS("QU",VEE("ID"),TEMP,"DSC")
"RTN","%ZVEMSQU",26,0)
 S X="" F  S X=$O(^%ZVEMS("QU",VEE("ID"),TEMP,X)) Q:X'>0  S ^%ZVEMS("QU",VEE("ID"),NAM,X)=^%ZVEMS("QU",VEE("ID"),TEMP,X)
"RTN","%ZVEMSQU",27,0)
 W "   Copied.."
"RTN","%ZVEMSQU",28,0)
 Q
"RTN","%ZVEMSQU",29,0)
 ;====================================================================
"RTN","%ZVEMSQU",30,0)
BOX ;..QB System QWIK. Put QWIKs into Boxes
"RTN","%ZVEMSQU",31,0)
 NEW BOX,BX,FLAGQ,NAM
"RTN","%ZVEMSQU",32,0)
 W !?1,"Assign QWIK to a display BOX"
"RTN","%ZVEMSQU",33,0)
 S FLAGQ=0 F  D GETNAM^%ZVEMSQ() Q:FLAGQ  D BOX1
"RTN","%ZVEMSQU",34,0)
 Q
"RTN","%ZVEMSQU",35,0)
BOX1 ;
"RTN","%ZVEMSQU",36,0)
 S BX=$P($G(^%ZVEMS("QU",VEE("ID"),NAM,"DSC")),"^",3)
"RTN","%ZVEMSQU",37,0)
 W !!?1,"Enter BOX: " I BX]"" W BX,"// "
"RTN","%ZVEMSQU",38,0)
 R BOX:500 S:'$T BOX="^" Q:"^"[BOX
"RTN","%ZVEMSQU",39,0)
 I BOX="@" D  Q
"RTN","%ZVEMSQU",40,0)
 . I BX>0 S $P(^%ZVEMS("QU",VEE("ID"),NAM,"DSC"),"^",3)="" W "   Deleted.."
"RTN","%ZVEMSQU",41,0)
 I BOX?1.N,BOX>0 S $P(^%ZVEMS("QU",VEE("ID"),NAM,"DSC"),"^",3)=BOX W "   Entered.." Q
"RTN","%ZVEMSQU",42,0)
 W !?2,"Enter a whole number greater than zero to add a QWIK",!?2,"to a display BOX. Enter '@' to delete a BOX."
"RTN","%ZVEMSQU",43,0)
 G BOX1
"RTN","%ZVEMSQV")
0^153^B6095667
"RTN","%ZVEMSQV",1,0)
%ZVEMSQV ;DJB,VSHL**QWIKs - Vendor Specific Code [9/27/95 6:39pm]
"RTN","%ZVEMSQV",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMSQV",3,0)
 ;
"RTN","%ZVEMSQV",4,0)
VENDOR ;Add a Vendor Specific QWIK.
"RTN","%ZVEMSQV",5,0)
 NEW BOX,BX,CHK,CD,CDHLD,CODE,FLAGJMP,FLAGQ,I,NAM,PROMPT,VEN
"RTN","%ZVEMSQV",6,0)
 W !?1,"*** Add Vendor Specific QWIK ***"
"RTN","%ZVEMSQV",7,0)
 F  S FLAGQ=0 D VENDQ Q:FLAGQ  D VENDV Q:FLAGQ
"RTN","%ZVEMSQV",8,0)
 Q
"RTN","%ZVEMSQV",9,0)
VENDQ ;Get QWIK
"RTN","%ZVEMSQV",10,0)
 S (FLAGQ,FLAGJMP)=0 D GETNAM^%ZVEMSQ(1) Q:FLAGQ
"RTN","%ZVEMSQV",11,0)
 Q:$D(^%ZVEMS("QU",VEE("ID"),NAM))
"RTN","%ZVEMSQV",12,0)
 D DISPLAY^%ZVEMSQA
"RTN","%ZVEMSQV",13,0)
VENDQ1 D NAME^%ZVEMSQE G:VEESHC="<TAB>" VENDQ Q:FLAGQ
"RTN","%ZVEMSQV",14,0)
 D CODE^%ZVEMSQE G:VEESHC="<TAB>" VENDQ Q:FLAGQ
"RTN","%ZVEMSQV",15,0)
 D TEXT^%ZVEMSQE("DSC") G:VEESHC="<TAB>" VENDQ Q:FLAGQ
"RTN","%ZVEMSQV",16,0)
 D TEXT^%ZVEMSQE("PARAM") G:VEESHC="<TAB>" VENDQ Q:FLAGQ
"RTN","%ZVEMSQV",17,0)
 D BOX^%ZVEMSQE Q:FLAGQ
"RTN","%ZVEMSQV",18,0)
 I FLAGJMP G VENDQ1 ;User hit <ESC> and number of field to jump to
"RTN","%ZVEMSQV",19,0)
 Q
"RTN","%ZVEMSQV",20,0)
VENDV ;Get M Vendor
"RTN","%ZVEMSQV",21,0)
 W @VEE("IOF"),!?18,"V E N D O R   S P E C I F I C   C O D E"
"RTN","%ZVEMSQV",22,0)
 W !!?1,"QWIK NAME: ",NAM
"RTN","%ZVEMSQV",23,0)
 W !!?1,"DEFAULT CODE: ",^%ZVEMS("QU",VEE("ID"),NAM)
"RTN","%ZVEMSQV",24,0)
 NEW X S X="" F  S X=$O(^%ZVEMS("QU",VEE("ID"),NAM,X)) Q:X'>0  W !?1,"Vendor ",X,$S($L(X)=1:"......",1:"....."),^(X)
"RTN","%ZVEMSQV",25,0)
 W !!?1,"VENDORS:",?10," 1) M/11",?25," 2) DSM",?40," 7) M/VX",?55," 8) MSM",!?10," 9) DTM",?25,"13) M/11+",?40,"16) VAX DSM"
"RTN","%ZVEMSQV",26,0)
VENDV1 ;Get Vendor
"RTN","%ZVEMSQV",27,0)
 S CD="" W ! D SCREEN^%ZVEMKEA("Select VENDOR: ",1,VEE("IOM")-2)
"RTN","%ZVEMSQV",28,0)
 I ",<ESC>,<TO>,"[(","_VEESHC_",") S FLAGQ=1 Q
"RTN","%ZVEMSQV",29,0)
 I CD']""!(CD="^")!(VEESHC="<TAB>") Q
"RTN","%ZVEMSQV",30,0)
 I ",1,2,7,8,9,13,16,"'[(","_CD_",")!(VEESHC="<ESCH>") W "   Enter 1, 2, 7, 8, 9, 13, or 16" G VENDV1
"RTN","%ZVEMSQV",31,0)
 S VEN=CD D VENDC Q:FLAGQ
"RTN","%ZVEMSQV",32,0)
 G VENDV1
"RTN","%ZVEMSQV",33,0)
VENDC ;Get Code
"RTN","%ZVEMSQV",34,0)
 S (CD,CDHLD)=$G(^%ZVEMS("QU",VEE("ID"),NAM,VEN))
"RTN","%ZVEMSQV",35,0)
VENDC1 D SCREEN^%ZVEMKEA("Edit CODE: ",1,VEE("IOM")-2)
"RTN","%ZVEMSQV",36,0)
 I ",<ESC>,<F1E>,<F1Q>,<TAB>,<TO>,"[(","_VEESHC_",") S FLAGQ=1 Q
"RTN","%ZVEMSQV",37,0)
 I CD="?"!(CD="??")!(VEESHC="<ESCH>") D MSG^%ZVEMSQA(2) G VENDC
"RTN","%ZVEMSQV",38,0)
 I CD']"",VEESHC="<ESCU>" D UNSAVE^%ZVEMSQA I CD']"" G VENDC
"RTN","%ZVEMSQV",39,0)
 I CD']""!(CD="^") KILL ^%ZVEMS("QU",VEE("ID"),NAM,VEN) W !?1,NAM," for Vendor ",VEN," deleted" Q
"RTN","%ZVEMSQV",40,0)
 D KILLCHK^%ZVEMKU(CD)
"RTN","%ZVEMSQV",41,0)
 I CD'=CDHLD  S ^%ZVEMS("QU",VEE("ID"),NAM,VEN)=CD
"RTN","%ZVEMSQV",42,0)
 I VEESHC="TOO LONG" G VENDC1
"RTN","%ZVEMSQV",43,0)
 Q
"RTN","%ZVEMSQW")
0^154^B7543155
"RTN","%ZVEMSQW",1,0)
%ZVEMSQW ;DJB,VSHL**QWIKs - Vendor List [9/9/95 6:40pm]
"RTN","%ZVEMSQW",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMSQW",3,0)
 ;
"RTN","%ZVEMSQW",4,0)
VENLIST ;List Vendor Specific Code
"RTN","%ZVEMSQW",5,0)
 NEW CD,FLAGQ,NAM,TYPE
"RTN","%ZVEMSQW",6,0)
 W !?1,"*** List Vendor Specific Code ***"
"RTN","%ZVEMSQW",7,0)
 W !?1,"Enter the name of an existing System/User QWIK"
"RTN","%ZVEMSQW",8,0)
 S FLAGQ=0 F  S TYPE="" D GETNAM Q:FLAGQ  I TYPE]"" D LISTCD
"RTN","%ZVEMSQW",9,0)
 Q
"RTN","%ZVEMSQW",10,0)
GETNAM ;Get either User or System QWIK
"RTN","%ZVEMSQW",11,0)
 W ! S CD="" D SCREEN^%ZVEMKEA("Enter QWIK: ",1,VEE("IOM")-2)
"RTN","%ZVEMSQW",12,0)
 I CD="?"!(CD="??")!(VEESHC="<ESCH>") D  G GETNAM
"RTN","%ZVEMSQW",13,0)
 . W !?3,"Enter the name of an existing System/User QWIK"
"RTN","%ZVEMSQW",14,0)
 I ",<ESC>,<F1E>,<F1Q>,<TAB>,<TO>,"[(","_VEESHC_",")!(CD']"")!(CD="^") S FLAGQ=1 Q
"RTN","%ZVEMSQW",15,0)
 S CD=$$ALLCAPS^%ZVEMKU(CD)
"RTN","%ZVEMSQW",16,0)
 I CD'?1A.7AN D MSG^%ZVEMSQA(1) G GETNAM
"RTN","%ZVEMSQW",17,0)
 S NAM=CD
"RTN","%ZVEMSQW",18,0)
 I $D(^%ZVEMS("QU",VEE("ID"),NAM)),$D(^%ZVEMS("QS",NAM)) D BOTH Q
"RTN","%ZVEMSQW",19,0)
 S TYPE=$S($D(^%ZVEMS("QU",VEE("ID"),NAM)):"User",$D(^%ZVEMS("QS",NAM)):"System",1:"")
"RTN","%ZVEMSQW",20,0)
 I TYPE']"" W "   No such QWIK"
"RTN","%ZVEMSQW",21,0)
 Q
"RTN","%ZVEMSQW",22,0)
LISTCD ;List Code
"RTN","%ZVEMSQW",23,0)
 W @VEE("IOF"),!?12,"D I S P L A Y   V E N D O R   S P E C I F I C   C O D E"
"RTN","%ZVEMSQW",24,0)
 W !!?1,"QWIK NAME...... ",NAM
"RTN","%ZVEMSQW",25,0)
 W !?1,"TYPE........... ",TYPE
"RTN","%ZVEMSQW",26,0)
 W !?1,"DESCRIPTION.... " W $S(TYPE="System":$P(^%ZVEMS("QS",NAM,"DSC"),"^",1),1:$P(^%ZVEMS("QU",VEE("ID"),NAM,"DSC"),"^",1))
"RTN","%ZVEMSQW",27,0)
 W !!?1,"Default Code..." S CD=$S(TYPE="System":^%ZVEMS("QS",NAM),1:^%ZVEMS("QU",VEE("ID"),NAM)) D LISTCD1
"RTN","%ZVEMSQW",28,0)
 I TYPE="User" NEW X S X="" F  S X=$O(^%ZVEMS("QU",VEE("ID"),NAM,X)) Q:X'>0  D LISTNAM S CD=^(X) D LISTCD1
"RTN","%ZVEMSQW",29,0)
 I TYPE="System" NEW X S X="" F  S X=$O(^%ZVEMS("QS",NAM,X)) Q:X'>0  D LISTNAM S CD=^(X) D LISTCD1
"RTN","%ZVEMSQW",30,0)
 Q
"RTN","%ZVEMSQW",31,0)
LISTCD1 ;List Code with wrapping
"RTN","%ZVEMSQW",32,0)
 NEW LMAR,PROMPT,START,WIDTH
"RTN","%ZVEMSQW",33,0)
 S PROMPT="",(LMAR,START)=17,WIDTH=61 D LISTCD^%ZVEMKEA
"RTN","%ZVEMSQW",34,0)
 Q
"RTN","%ZVEMSQW",35,0)
LISTNAM ;
"RTN","%ZVEMSQW",36,0)
 W !!?1,"Vendor ",$S(X=1:"M/11.... ",X=2:"DSM..... ",X=7:"M/VX.... ",X=8:"MSM..... ",X=9:"DTM..... ",X=13:"M/11+... ",X=16:"VAXDSM.. ",1:"........ ")
"RTN","%ZVEMSQW",37,0)
 Q
"RTN","%ZVEMSQW",38,0)
BOTH ;Both a User & System QWIK exists
"RTN","%ZVEMSQW",39,0)
 NEW XX
"RTN","%ZVEMSQW",40,0)
 W !!!?1,"There are 2 QWIKs named ",NAM,". Which one do you wish to see?",!?3,"U = User QWIK",!?3,"S = System QWIK"
"RTN","%ZVEMSQW",41,0)
BOTH1 R !?1,"Enter letter of your choice: ",XX:300 S:'$T XX="^" I "^"[XX Q
"RTN","%ZVEMSQW",42,0)
 S XX=$$ALLCAPS^%ZVEMKU($E(XX))
"RTN","%ZVEMSQW",43,0)
 I "US"'[XX W "   Enter U or S" G BOTH1
"RTN","%ZVEMSQW",44,0)
 S TYPE=$S(XX="U":"User",XX="S":"System",1:"")
"RTN","%ZVEMSQW",45,0)
 Q
"RTN","%ZVEMSRL")
0^155^B9215264
"RTN","%ZVEMSRL",1,0)
%ZVEMSRL ;DJB,VSHL**Routine Lister [9/29/97 8:03pm]
"RTN","%ZVEMSRL",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMSRL",3,0)
 ;
"RTN","%ZVEMSRL",4,0)
EN ;
"RTN","%ZVEMSRL",5,0)
 NEW %,CEMETHOD,LINE,RLIOF,RLSIZE,RTNSIZE,TYPE
"RTN","%ZVEMSRL",6,0)
 NEW FLAGCHK,FLAGP,FLAGQ
"RTN","%ZVEMSRL",7,0)
 D INIT
"RTN","%ZVEMSRL",8,0)
TOP ;
"RTN","%ZVEMSRL",9,0)
 S (FLAGP,FLAGQ)=0
"RTN","%ZVEMSRL",10,0)
 W @RLIOF,!,"ROUTINE LISTER - David Bolduc"
"RTN","%ZVEMSRL",11,0)
 D SELECT^%ZVEMRUS G:$O(^UTILITY($J," "))="" EX
"RTN","%ZVEMSRL",12,0)
 D GETTYPE G:FLAGQ TOP
"RTN","%ZVEMSRL",13,0)
 I $D(^%ZIS) D DEVICE G:POP EX U IO
"RTN","%ZVEMSRL",14,0)
 D @$S(TYPE="B":"PRINT2",1:"PRINT")
"RTN","%ZVEMSRL",15,0)
 I $D(^%ZIS) D ^%ZISC
"RTN","%ZVEMSRL",16,0)
 D:'FLAGQ PAUSE^%ZVEMKU(2,"P")
"RTN","%ZVEMSRL",17,0)
 G TOP
"RTN","%ZVEMSRL",18,0)
EX ;
"RTN","%ZVEMSRL",19,0)
 KILL ^UTILITY($J)
"RTN","%ZVEMSRL",20,0)
 Q
"RTN","%ZVEMSRL",21,0)
 ;==================================================================
"RTN","%ZVEMSRL",22,0)
DEVICE ;
"RTN","%ZVEMSRL",23,0)
 NEW %,%X,%XX,%Y,%YY
"RTN","%ZVEMSRL",24,0)
 S %ZIS="M" D ^%ZIS Q:POP
"RTN","%ZVEMSRL",25,0)
 ;
"RTN","%ZVEMSRL",26,0)
 ;Check for TRACE devices
"RTN","%ZVEMSRL",27,0)
 S CEMETHOD=$S(ION="TRACE SCREEN CAPTURE":"S",ION="TRACE FILE":"F",1:"P")
"RTN","%ZVEMSRL",28,0)
 I CEMETHOD'="P" D ^%ZISC
"RTN","%ZVEMSRL",29,0)
 ;
"RTN","%ZVEMSRL",30,0)
 S RLIOF=IOF,RLSIZE=(IOSL-5)
"RTN","%ZVEMSRL",31,0)
 S:$E(IOST,1,2)="P-" FLAGP=1
"RTN","%ZVEMSRL",32,0)
 Q
"RTN","%ZVEMSRL",33,0)
GETTYPE ;
"RTN","%ZVEMSRL",34,0)
 W !!,"Select [B]LOCK [L]IST or [#]LINES: L// "
"RTN","%ZVEMSRL",35,0)
 R TYPE:300 S:'$T TYPE="^" S:TYPE="" TYPE="L"
"RTN","%ZVEMSRL",36,0)
 I TYPE="^" S FLAGQ=1 Q
"RTN","%ZVEMSRL",37,0)
 S TYPE=$TR(TYPE,"bl","BL")
"RTN","%ZVEMSRL",38,0)
 I ",B,L,"'[(","_TYPE_","),TYPE'?1.N D  G GETTYPE
"RTN","%ZVEMSRL",39,0)
 . W "   Enter 'B', 'L', or number of program lines to display."
"RTN","%ZVEMSRL",40,0)
 Q
"RTN","%ZVEMSRL",41,0)
PRINT ;Print routines
"RTN","%ZVEMSRL",42,0)
 NEW BYTES,CHK,CNT,I,RTN,TOTAL,X,Y
"RTN","%ZVEMSRL",43,0)
 I FLAGP=1 W !!
"RTN","%ZVEMSRL",44,0)
 E  W @RLIOF
"RTN","%ZVEMSRL",45,0)
 D HD
"RTN","%ZVEMSRL",46,0)
 S CNT=1,TOTAL=0
"RTN","%ZVEMSRL",47,0)
 S RTN=" "
"RTN","%ZVEMSRL",48,0)
 F  S RTN=$O(^UTILITY($J,RTN)) Q:RTN=""!FLAGQ  D PRINT1
"RTN","%ZVEMSRL",49,0)
 I TOTAL>0,'FLAGQ D TOTAL
"RTN","%ZVEMSRL",50,0)
 Q
"RTN","%ZVEMSRL",51,0)
PRINT1 ;
"RTN","%ZVEMSRL",52,0)
 X RTNSIZE S TOTAL=TOTAL+BYTES
"RTN","%ZVEMSRL",53,0)
 S CHK=" "
"RTN","%ZVEMSRL",54,0)
 S X=$P($T(+1^@RTN)," ")
"RTN","%ZVEMSRL",55,0)
 S:$F(X,"(") X=$P(X,"(")
"RTN","%ZVEMSRL",56,0)
 I X'=RTN S CHK="*"
"RTN","%ZVEMSRL",57,0)
 W !,CHK,$J(CNT,3),". ",RTN,?14,$J(BYTES,7)
"RTN","%ZVEMSRL",58,0)
 W ?23,$E($P($T(^@RTN)," ",2,999),6,59)
"RTN","%ZVEMSRL",59,0)
 S CNT=CNT+1
"RTN","%ZVEMSRL",60,0)
 D:$Y>RLSIZE PAGE Q:FLAGQ
"RTN","%ZVEMSRL",61,0)
 I TYPE?1.N F I=2:1:TYPE D  Q:FLAGQ
"RTN","%ZVEMSRL",62,0)
 . W !?22,$E($T(+I^@RTN),1,55)
"RTN","%ZVEMSRL",63,0)
 . I $Y>RLSIZE D PAGE
"RTN","%ZVEMSRL",64,0)
 Q
"RTN","%ZVEMSRL",65,0)
PRINT2 ;List
"RTN","%ZVEMSRL",66,0)
 NEW COL,RTN
"RTN","%ZVEMSRL",67,0)
 W @RLIOF
"RTN","%ZVEMSRL",68,0)
 S COL=1
"RTN","%ZVEMSRL",69,0)
 S RTN=" "
"RTN","%ZVEMSRL",70,0)
 F  S RTN=$O(^UTILITY($J,RTN)) Q:RTN=""!(FLAGQ)  D  ;
"RTN","%ZVEMSRL",71,0)
 . I COL=1,$Y>RLSIZE D PAGE Q:FLAGQ
"RTN","%ZVEMSRL",72,0)
 . W:COL=1 !
"RTN","%ZVEMSRL",73,0)
 . W ?COL,RTN
"RTN","%ZVEMSRL",74,0)
 . S COL=COL+10 I COL>75 S COL=1
"RTN","%ZVEMSRL",75,0)
 Q
"RTN","%ZVEMSRL",76,0)
TOTAL ;Print Total
"RTN","%ZVEMSRL",77,0)
 W !,?16,"====="
"RTN","%ZVEMSRL",78,0)
 W !?5,"TOTAL",?11,$J(TOTAL,10,0)
"RTN","%ZVEMSRL",79,0)
 Q
"RTN","%ZVEMSRL",80,0)
PAGE ;
"RTN","%ZVEMSRL",81,0)
 NEW XX
"RTN","%ZVEMSRL",82,0)
 I $O(^UTILITY($J,RTN))="" Q
"RTN","%ZVEMSRL",83,0)
 I FLAGP W @RLIOF,!! D HD Q
"RTN","%ZVEMSRL",84,0)
 D PAUSE^%ZVEMKU(2,"Q") Q:FLAGQ  W @RLIOF D HD
"RTN","%ZVEMSRL",85,0)
 Q
"RTN","%ZVEMSRL",86,0)
HD ;Header
"RTN","%ZVEMSRL",87,0)
 Q:TYPE'="L"
"RTN","%ZVEMSRL",88,0)
 W !?6,"ROUTINE",?16,"BYTES",?33,"CHARACTERS 20-74 OF ROUTINES TOP LINE"
"RTN","%ZVEMSRL",89,0)
 W !?6,"--------",?16,"-----",?23,"--------------------------------------------------------"
"RTN","%ZVEMSRL",90,0)
 Q
"RTN","%ZVEMSRL",91,0)
INIT ;
"RTN","%ZVEMSRL",92,0)
 I $D(^%ZOSF("SIZE")) D  I 1
"RTN","%ZVEMSRL",93,0)
 . S RTNSIZE="ZL @RTN X ^%ZOSF(""SIZE"") S BYTES=Y"
"RTN","%ZVEMSRL",94,0)
 E  S RTNSIZE="S BYTES=0 F I=1:1 S %=$T(+I^@RTN) Q:%=""""  S BYTES=BYTES+$L(%)+2"
"RTN","%ZVEMSRL",95,0)
 S $P(LINE,"=",212)=""
"RTN","%ZVEMSRL",96,0)
 S RLIOF=VEE("IOF"),RLSIZE=18
"RTN","%ZVEMSRL",97,0)
 Q
"RTN","%ZVEMSS")
0^156^B14807749
"RTN","%ZVEMSS",1,0)
%ZVEMSS ;DJB,VSHL**..SAVE ; 9/7/02 1:42pm
"RTN","%ZVEMSS",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMSS",3,0)
 ;
"RTN","%ZVEMSS",4,0)
SAVE ;
"RTN","%ZVEMSS",5,0)
 NEW BOX,CNT,CODE,FLAGQ,ID,MENU,QWIK,RTN,TEMP,VEN,X,VEES,XX
"RTN","%ZVEMSS",6,0)
 S FLAGQ=0 D MENU G:FLAGQ EX
"RTN","%ZVEMSS",7,0)
 I "1,2"[MENU D ZSAVE^%ZVEMKY3 G:FLAGQ EX
"RTN","%ZVEMSS",8,0)
 I MENU=1 D  G:FLAGQ EX
"RTN","%ZVEMSS",9,0)
 . D GETRTNS Q:FLAGQ
"RTN","%ZVEMSS",10,0)
 . W ! D ASK Q:FLAGQ
"RTN","%ZVEMSS",11,0)
 . D BUILD^%ZVEMSS1
"RTN","%ZVEMSS",12,0)
 I MENU=2 D  G:FLAGQ EX
"RTN","%ZVEMSS",13,0)
 . D GETRTNR Q:FLAGQ
"RTN","%ZVEMSS",14,0)
 . D BOX Q:FLAGQ
"RTN","%ZVEMSS",15,0)
 . D ID Q:FLAGQ
"RTN","%ZVEMSS",16,0)
 . D RESTORE^%ZVEMSS1
"RTN","%ZVEMSS",17,0)
EX ;
"RTN","%ZVEMSS",18,0)
 Q
"RTN","%ZVEMSS",19,0)
MENU ;
"RTN","%ZVEMSS",20,0)
 W !!,"*** Save/Restore User QWIKs ***"
"RTN","%ZVEMSS",21,0)
 W !!,"1. Save QWIKs"
"RTN","%ZVEMSS",22,0)
 W !,"2. Restore QWIKs",!
"RTN","%ZVEMSS",23,0)
MENU1 R !,"Select NUMBER: ",MENU:500 S:'$T MENU="^" I "^"[MENU S FLAGQ=1 Q
"RTN","%ZVEMSS",24,0)
 I "??"[MENU D  W ! G MENU1
"RTN","%ZVEMSS",25,0)
 . W !!,"Enter 1 to save your QWIKs to a routine."
"RTN","%ZVEMSS",26,0)
 . W !,"Enter 2 to restore QWIKs from a routine."
"RTN","%ZVEMSS",27,0)
 S MENU=+MENU,MENU=MENU\1
"RTN","%ZVEMSS",28,0)
 I MENU<1!(MENU>2) W $C(7),"   Enter a number from 1 to 2" G MENU1
"RTN","%ZVEMSS",29,0)
 Q
"RTN","%ZVEMSS",30,0)
 ;
"RTN","%ZVEMSS",31,0)
GETRTNS ;Get routine name for SAVE
"RTN","%ZVEMSS",32,0)
 D RTN Q:FLAGQ
"RTN","%ZVEMSS",33,0)
 I RTN="@" KILL ^%ZVEMS("PARAM",VEE("ID"),"SAVE") S FLAGQ=1 Q
"RTN","%ZVEMSS",34,0)
 I "??"[RTN D MSG G GETRTNS
"RTN","%ZVEMSS",35,0)
 I RTN?1"%".E!(RTN'?1A.7AN) D  G GETRTNS
"RTN","%ZVEMSS",36,0)
 . W "   Invalid routine name.."
"RTN","%ZVEMSS",37,0)
 S ^%ZVEMS("PARAM",VEE("ID"),"SAVE")=RTN
"RTN","%ZVEMSS",38,0)
 Q
"RTN","%ZVEMSS",39,0)
 ;
"RTN","%ZVEMSS",40,0)
GETRTNR ;Get routine for RESTORE
"RTN","%ZVEMSS",41,0)
 D RTN Q:FLAGQ
"RTN","%ZVEMSS",42,0)
 I "??"[RTN D  G GETRTNR
"RTN","%ZVEMSS",43,0)
 . W !,"Enter the name of the routine that contains your saved User QWIKs."
"RTN","%ZVEMSS",44,0)
 I @("$T(+2^"_RTN_")'["";;VSHELL;;""") D  G GETRTNR
"RTN","%ZVEMSS",45,0)
 . W !!,"Invalid routine. Routine's 2nd line must be: ;;VSHELL;;"
"RTN","%ZVEMSS",46,0)
 Q
"RTN","%ZVEMSS",47,0)
 ;
"RTN","%ZVEMSS",48,0)
RTN ;Get Routine name
"RTN","%ZVEMSS",49,0)
 S TEMP=""
"RTN","%ZVEMSS",50,0)
 I $D(^%ZVEMS("PARAM",VEE("ID"),"SAVE")) S TEMP=^("SAVE")
"RTN","%ZVEMSS",51,0)
 W !!,"Enter ROUTINE: " W:TEMP]"" TEMP_"// "
"RTN","%ZVEMSS",52,0)
 R RTN:300 S:'$T RTN="^" S:RTN="" RTN=TEMP
"RTN","%ZVEMSS",53,0)
 I "^"[RTN S FLAGQ=1 Q
"RTN","%ZVEMSS",54,0)
 F  Q:$E(RTN)'="^"  S RTN=$E(RTN,2,999) ;Strip off '^'
"RTN","%ZVEMSS",55,0)
 Q
"RTN","%ZVEMSS",56,0)
 ;
"RTN","%ZVEMSS",57,0)
ASK ;
"RTN","%ZVEMSS",58,0)
 W !,"I will save your QWIKs to routine ^",RTN,".  Ok? YES// "
"RTN","%ZVEMSS",59,0)
 R XX:300 S:'$T XX="^" S:XX="" XX="YES" I XX="^" S FLAGQ=1 Q
"RTN","%ZVEMSS",60,0)
 I "YNyn"'[$E(XX) W "   Y=YES or N=NO" G ASK
"RTN","%ZVEMSS",61,0)
 I "Yy"'[$E(XX) S FLAGQ=1
"RTN","%ZVEMSS",62,0)
 Q
"RTN","%ZVEMSS",63,0)
 ;
"RTN","%ZVEMSS",64,0)
BOX ;Save QWIKs to a particular box
"RTN","%ZVEMSS",65,0)
 W !,"Enter BOX: "
"RTN","%ZVEMSS",66,0)
 R BOX:500 S:'$T BOX="^" Q:BOX=""  I BOX="^" S FLAGQ=1 Q
"RTN","%ZVEMSS",67,0)
 S BOX=BOX\1 I BOX'>0 D  G BOX
"RTN","%ZVEMSS",68,0)
 . W !!,"^=Abort Restore   <RET>=Accept Default Boxes"
"RTN","%ZVEMSS",69,0)
 . W !,"If you want to restore the saved QWIKs to a particular box so they don't"
"RTN","%ZVEMSS",70,0)
 . W !,"get mixed up with your own QWIKs, enter that box here.",!
"RTN","%ZVEMSS",71,0)
 Q
"RTN","%ZVEMSS",72,0)
 ;
"RTN","%ZVEMSS",73,0)
ID ;Get ID number
"RTN","%ZVEMSS",74,0)
 R !,"Enter ID: ",ID:500 S:'$T ID="^" I "^"[ID S FLAGQ=1 Q
"RTN","%ZVEMSS",75,0)
 S ID=ID\1 I ID'>0 D  G ID
"RTN","%ZVEMSS",76,0)
 . W "   Enter ID number of person to receive these QWIKs."
"RTN","%ZVEMSS",77,0)
 Q
"RTN","%ZVEMSS",78,0)
 ;
"RTN","%ZVEMSS",79,0)
MSG ;Store routine name in ^%ZVEMS("PARAM",VEE("ID"),"SAVE")
"RTN","%ZVEMSS",80,0)
 ;SAVE will use this routine to save your QWIKs.
"RTN","%ZVEMSS",81,0)
 W !!,"Enter the name of a routine. QSAVE will then save your User QWIKs as"
"RTN","%ZVEMSS",82,0)
 W !,"lines of code in this routine. You then can use QSAVE to reverse the"
"RTN","%ZVEMSS",83,0)
 W !,"process and restore your QWIKs. Use this option to Backup your QWIKs or"
"RTN","%ZVEMSS",84,0)
 W !,"to move your QWIKs to another system."
"RTN","%ZVEMSS",85,0)
 W !!,"IMPORTANT: As a programmer, it is your responsibility to make sure"
"RTN","%ZVEMSS",86,0)
 W !,"the routine name you enter here DOES NOT already exist. If it does"
"RTN","%ZVEMSS",87,0)
 W !,"it will be overwritten."
"RTN","%ZVEMSS",88,0)
 W !!,"Enter '@' to stop displaying the current default routine."
"RTN","%ZVEMSS",89,0)
 Q
"RTN","%ZVEMSS1")
0^157^B7959367
"RTN","%ZVEMSS1",1,0)
%ZVEMSS1 ;DJB,VSHL**..SAVE cont.. ; 9/7/02 1:46pm
"RTN","%ZVEMSS1",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMSS1",3,0)
 ;
"RTN","%ZVEMSS1",4,0)
BUILD ;Build ^UTILITY($J,0) Global
"RTN","%ZVEMSS1",5,0)
 NEW CNT,QWIK,VRRPGM,X
"RTN","%ZVEMSS1",6,0)
 W "   Please wait.."
"RTN","%ZVEMSS1",7,0)
 KILL ^UTILITY($J)
"RTN","%ZVEMSS1",8,0)
 S ^UTILITY($J,0,1)=RTN_" ;VPE**Saved User QWIKs ("_$H_")"
"RTN","%ZVEMSS1",9,0)
 S ^UTILITY($J,0,2)=" ;;VSHELL;;"
"RTN","%ZVEMSS1",10,0)
 S ^UTILITY($J,0,3)="QWIK ;Saved QWIK Commands"
"RTN","%ZVEMSS1",11,0)
 S ^UTILITY($J,0,4000)=" ;;***"
"RTN","%ZVEMSS1",12,0)
 ;
"RTN","%ZVEMSS1",13,0)
 S CNT=4
"RTN","%ZVEMSS1",14,0)
 S QWIK="@" F  S QWIK=$O(^%ZVEMS("QU",VEE("ID"),QWIK)) Q:QWIK=""  D
"RTN","%ZVEMSS1",15,0)
 . S ^UTILITY($J,0,CNT)=" ;;"_QWIK_";D;"_$G(^%ZVEMS("QU",VEE("ID"),QWIK,"DSC")) ;Description
"RTN","%ZVEMSS1",16,0)
 . S CNT=CNT+1
"RTN","%ZVEMSS1",17,0)
 . S ^UTILITY($J,0,CNT)=" ;;"_QWIK_";C;"_^%ZVEMS("QU",VEE("ID"),QWIK) ;Code
"RTN","%ZVEMSS1",18,0)
 . S CNT=CNT+1,X="" ;Next is Vendor specific code
"RTN","%ZVEMSS1",19,0)
 . F  S X=$O(^%ZVEMS("QU",VEE("ID"),QWIK,X)) Q:X'>0  S ^UTILITY($J,0,CNT)=" ;;"_QWIK_";"_X_";"_^%ZVEMS("QU",VEE("ID"),QWIK,X),CNT=CNT+1
"RTN","%ZVEMSS1",20,0)
 ;
"RTN","%ZVEMSS1",21,0)
 S VRRPGM=RTN
"RTN","%ZVEMSS1",22,0)
 X ^%ZVEMS("E",2)
"RTN","%ZVEMSS1",23,0)
 KILL ^UTILITY($J)
"RTN","%ZVEMSS1",24,0)
 Q
"RTN","%ZVEMSS1",25,0)
 ;
"RTN","%ZVEMSS1",26,0)
RESTORE ;Code used to build saving routine
"RTN","%ZVEMSS1",27,0)
 NEW CODE,FLAGQ,I,QWIK,TXT,TYPE
"RTN","%ZVEMSS1",28,0)
 D CHECK G:FLAGQ EX D STUFF
"RTN","%ZVEMSS1",29,0)
EX ;
"RTN","%ZVEMSS1",30,0)
 Q
"RTN","%ZVEMSS1",31,0)
CHECK ;Check for existing QWIKs
"RTN","%ZVEMSS1",32,0)
 S FLAGQ=0
"RTN","%ZVEMSS1",33,0)
 W !!
"RTN","%ZVEMSS1",34,0)
 F I=1:1 S @("TXT=$T(QWIK+"_I_"^"_RTN_")") Q:$P(TXT,";",3)="***"  S QWIK=$P(TXT,";",3) I $P(TXT,";",4)="D",$D(^%ZVEMS("QU",ID,QWIK)) S FLAGQ=1 W " ",QWIK I $X>65 W !
"RTN","%ZVEMSS1",35,0)
 Q:'FLAGQ
"RTN","%ZVEMSS1",36,0)
 S FLAGQ=0
"RTN","%ZVEMSS1",37,0)
 W !!,"This routine contains the above QWIK(s) which already exist on your"
"RTN","%ZVEMSS1",38,0)
 W !,"system. If I continue I will overwrite them. You may stop the load"
"RTN","%ZVEMSS1",39,0)
 W !,"here and edit ^",RTN," to change the names.",!
"RTN","%ZVEMSS1",40,0)
ASK R !,"Should I continue? YES// ",CODE:600 S:'$T CODE="^" S:CODE="" CODE="Y" S CODE=$E(CODE)
"RTN","%ZVEMSS1",41,0)
 I "^YyNn"'[CODE W "   Y=Yes  N=No" G ASK
"RTN","%ZVEMSS1",42,0)
 S:"Yy"'[CODE FLAGQ=1
"RTN","%ZVEMSS1",43,0)
 Q
"RTN","%ZVEMSS1",44,0)
 ;
"RTN","%ZVEMSS1",45,0)
STUFF ;Load the QWIKs
"RTN","%ZVEMSS1",46,0)
 F I=1:1 S @("TXT=$T(QWIK+"_I_"^"_RTN_")") Q:$P(TXT,";",3)="***"  S QWIK=$P(TXT,";",3),TYPE=$P(TXT,";",4) D
"RTN","%ZVEMSS1",47,0)
 . I TYPE="D" S ^%ZVEMS("QU",ID,QWIK,"DSC")=$P(TXT,";",5,999) I $G(BOX)]"" S $P(^("DSC"),"^",3)=BOX ;Description
"RTN","%ZVEMSS1",48,0)
 . I TYPE="C" S ^%ZVEMS("QU",ID,QWIK)=$P(TXT,";",5,999) ;Code
"RTN","%ZVEMSS1",49,0)
 . I TYPE?1.N S ^%ZVEMS("QU",ID,QWIK,TYPE)=$P(TXT,";",5,999) ;Vendor specific code
"RTN","%ZVEMSS1",50,0)
 Q
"RTN","%ZVEMST")
0^158^B12344059
"RTN","%ZVEMST",1,0)
%ZVEMST ;DJB,VSHL** VShell Tool Kit [03/02/95 10:28pm]
"RTN","%ZVEMST",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMST",3,0)
 ;
"RTN","%ZVEMST",4,0)
CALENDAR ;Author: Roger Ackerman   Albuquerque,NM
"RTN","%ZVEMST",5,0)
 NEW %H,%Y,AD,AL,DAYS,DOW,L,M,MM,N,X,Y,NY,NM
"RTN","%ZVEMST",6,0)
 I $G(%1)]"" S:%1'?1.2N!(%1<1)!(%1>12) %1=""
"RTN","%ZVEMST",7,0)
 I $G(DT)="" S DT=$$FMDATE^%ZVEMKDT()
"RTN","%ZVEMST",8,0)
 S NY=+$E(DT,1,3),NM=$S($G(%1)>0:%1,1:+$E(DT,4,5))
"RTN","%ZVEMST",9,0)
 F MM=-1:1:4 S Y=NM+MM,AD=$S(Y<1:(NY-1)_"12",Y>12:(NY+1)_"0"_(Y#12),1:NY_$S($L(Y)=1:"0",1:"")_Y)_"01",M=MM+2 D CAL
"RTN","%ZVEMST",10,0)
 W @VEE("IOF"),!?23,"S I X   M O N T H   P L A N N E R",?63,"Roger Ackerman"
"RTN","%ZVEMST",11,0)
 W !," ============================================================================",!!
"RTN","%ZVEMST",12,0)
 F L=1:1:8 W ?3,AL(1,L),?28,AL(2,L),?53,AL(3,L),!
"RTN","%ZVEMST",13,0)
 W !
"RTN","%ZVEMST",14,0)
 F L=1:1:8 W ?3,AL(4,L),?28,AL(5,L),?53,AL(6,L),!
"RTN","%ZVEMST",15,0)
 W:'$D(AL(6)) !
"RTN","%ZVEMST",16,0)
 W " ============================================================================",!
"RTN","%ZVEMST",17,0)
EXIT ;
"RTN","%ZVEMST",18,0)
 Q
"RTN","%ZVEMST",19,0)
 ;
"RTN","%ZVEMST",20,0)
CAL ;build calendar matrix (also called by ABOCE)
"RTN","%ZVEMST",21,0)
 S X=$E(AD,1,5)_"01" D H S DOW=%Y ; day-of-week month starts on
"RTN","%ZVEMST",22,0)
 S DAYS=$P("31^28^31^30^31^30^31^31^30^31^30^31","^",+$E(AD,4,5))
"RTN","%ZVEMST",23,0)
 S DAYS=DAYS+(+$E(AD,4,5)=2&'($E(AD,1,3)#4)) ;leap year
"RTN","%ZVEMST",24,0)
 S Y=$E(AD,1,5)_"00" D DD
"RTN","%ZVEMST",25,0)
 S AL(M,1)="       "_Y_"       "
"RTN","%ZVEMST",26,0)
 S AL(M,2)=" Su Mo Tu We Th Fr Sa "
"RTN","%ZVEMST",27,0)
 S L=3,X=$J("",3*DOW) ;BLANK SPACE FOR FIRST WEEK OF CALENDAR
"RTN","%ZVEMST",28,0)
 F N=1:1:DAYS S X=X_$J(N,3),DOW=DOW+1 I DOW=7 S DOW=0,AL(M,L)=X_" ",X="",L=L+1
"RTN","%ZVEMST",29,0)
 I DOW>0 S X=X_$J("",21-$L(X))_" ",AL(M,L)=X,L=L+1
"RTN","%ZVEMST",30,0)
 F N=L:1:8 S AL(M,N)=""
"RTN","%ZVEMST",31,0)
 Q
"RTN","%ZVEMST",32,0)
 ;
"RTN","%ZVEMST",33,0)
DD ;from ^DD("DD")
"RTN","%ZVEMST",34,0)
 S:Y Y=$S($E(Y,4,5):$P("JAN^FEB^MAR^APR^MAY^JUN^JUL^AUG^SEP^OCT^NOV^DEC","^",+$E(Y,4,5))_" ",1:"")_$S($E(Y,6,7):+$E(Y,6,7)_",",1:"")_($E(Y,1,3)+1700)_$P("@"_$E(Y_0,9,10)_":"_$E(Y_"000",11,12),"^",Y[".")
"RTN","%ZVEMST",35,0)
 Q
"RTN","%ZVEMST",36,0)
H ;from H^%DTC
"RTN","%ZVEMST",37,0)
 NEW %M,%D,%
"RTN","%ZVEMST",38,0)
 S %Y=$E(X,1,3),%M=$E(X,4,5),%D=$E(X,6,7)
"RTN","%ZVEMST",39,0)
 S %H=%M>2&'(%Y#4)+$P("^31^59^90^120^151^181^212^243^273^304^334","^",%M)+%D
"RTN","%ZVEMST",40,0)
 S %='%M!'%D,%Y=%Y-141,%H=%H+(%Y*365)+(%Y\4)-(%Y>59)+%,%Y=$S(%:-1,1:%H+4#7)
"RTN","%ZVEMST",41,0)
 Q
"RTN","%ZVEMST",42,0)
XQH ;Help text for Kernel Menu Options
"RTN","%ZVEMST",43,0)
 I $T(^XQH)']""!('$D(^XUSEC(0))) D  Q
"RTN","%ZVEMST",44,0)
 . W $C(7),!?2,"Not in this UCI.",!
"RTN","%ZVEMST",45,0)
 I $G(DUZ)="" D ^XUP Q:$G(DUZ)=""
"RTN","%ZVEMST",46,0)
 W !!,"HELP Text for Kernel Menu Options"
"RTN","%ZVEMST",47,0)
 NEW DIC,X,XQH,Y
"RTN","%ZVEMST",48,0)
 I $G(%1)']"" S DIC="^DIC(19,",DIC(0)="QEAM" D ^DIC Q:Y<0  S %1=$P(Y,"^",2)
"RTN","%ZVEMST",49,0)
 S XQH=%1 D EN^XQH I $G(XQH)<0 W " This Option has no Help Text"
"RTN","%ZVEMST",50,0)
 Q
"RTN","%ZVEMST",51,0)
ASCII ;Author: David Laliberte   SF-ISC
"RTN","%ZVEMST",52,0)
 NEW I,B,X S B="|"
"RTN","%ZVEMST",53,0)
 W @VEE("IOF"),!?21,"A S C I I   C H A R A C T E R   S E T",!!
"RTN","%ZVEMST",54,0)
 F I=0:10:70 W ?I,"Dec  Chr"
"RTN","%ZVEMST",55,0)
 W !,"==============================================================================="
"RTN","%ZVEMST",56,0)
 F I=32:1:47 D  W ?19,B,$J(I,3),?25,$S(I>32:$C(I),1:"SP"),?29,B,$J(I+16,3),?35,$C(I+16),?39,B,$J(I+32,3),?45,$C(I+32),?49,B,$J(I+48,3),?55,$C(I+48),?59,B,$J(I+64,3),?65,$C(I+64),?69,B,$J(I+80,3),?75,$S(I+80<127:$C(I+80),1:"DEL")
"RTN","%ZVEMST",57,0)
 .S X=I-32 W !,$J(X,3),?5,$P($T(TXT+X),";",4),?9,B,$J($P($T(TXT+X),";",5),3),?15,$P($T(TXT+X),";",6) Q
"RTN","%ZVEMST",58,0)
 W !,"==============================================================================="
"RTN","%ZVEMST",59,0)
 Q
"RTN","%ZVEMST",60,0)
TXT ;;0;NUL;16;DLE
"RTN","%ZVEMST",61,0)
 ;;1;SOH;17;DC1
"RTN","%ZVEMST",62,0)
 ;;2;STX;18;DC2
"RTN","%ZVEMST",63,0)
 ;;3;ETX;19;DC3
"RTN","%ZVEMST",64,0)
 ;;4;EOT;20;DC4
"RTN","%ZVEMST",65,0)
 ;;5;ENQ;21;NAK
"RTN","%ZVEMST",66,0)
 ;;6;ACK;22;SYN
"RTN","%ZVEMST",67,0)
 ;;7;BEL;23;ETB
"RTN","%ZVEMST",68,0)
 ;;8;BS;24;CAN
"RTN","%ZVEMST",69,0)
 ;;9;HT;25;EM
"RTN","%ZVEMST",70,0)
 ;;10;LF;26;SUB
"RTN","%ZVEMST",71,0)
 ;;11;VT;27;ESC
"RTN","%ZVEMST",72,0)
 ;;12;FF;28;FS
"RTN","%ZVEMST",73,0)
 ;;13;CR;29;GS
"RTN","%ZVEMST",74,0)
 ;;14;SO;30;RS
"RTN","%ZVEMST",75,0)
 ;;15;SI;31;US
"RTN","%ZVEMSTO")
0^159^B9696495
"RTN","%ZVEMSTO",1,0)
%ZVEMSTO ;DJB,VSHL**Time Out - Screen Saver ; 11/14/02 7:22am
"RTN","%ZVEMSTO",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMSTO",3,0)
 ;
"RTN","%ZVEMSTO",4,0)
EN ;
"RTN","%ZVEMSTO",5,0)
 I $G(VEESHL)'="RUN" W $C(7),!!?2,"This routine may only be run from the VShell.",! Q
"RTN","%ZVEMSTO",6,0)
 NEW VEES D MARGIN
"RTN","%ZVEMSTO",7,0)
TOP ;Come here from VMS1
"RTN","%ZVEMSTO",8,0)
 NEW X S X="ERROR^%ZVEMSTO",@($$TRAP^%ZVEMKU1) KILL X
"RTN","%ZVEMSTO",9,0)
 NEW DOT,DOT1,FF,FLAGQ,I,PASSWORD,WHICH,X,XX,XX1,Y
"RTN","%ZVEMSTO",10,0)
 D INIT,INIT1,CUROFF
"RTN","%ZVEMSTO",11,0)
 S WHICH=1,FLAGQ=0
"RTN","%ZVEMSTO",12,0)
 F  D @("TYPE"_WHICH) Q:FLAGQ  S WHICH=WHICH+1 S:WHICH>4 WHICH=1
"RTN","%ZVEMSTO",13,0)
EX ;Exit
"RTN","%ZVEMSTO",14,0)
 D CURSOR X FF,VEES("RM80")
"RTN","%ZVEMSTO",15,0)
 I $D(^%ZOSF("BRK")) X ^("BRK") ;Reenable Ctrl C
"RTN","%ZVEMSTO",16,0)
 Q
"RTN","%ZVEMSTO",17,0)
TYPE1 ;Top to Bottom
"RTN","%ZVEMSTO",18,0)
 F Y=1:1:VEE("IOSL") Q:FLAGQ  F X=1:1:VEE("IOM") D DRAW Q:FLAGQ
"RTN","%ZVEMSTO",19,0)
 D DOTSET
"RTN","%ZVEMSTO",20,0)
 Q
"RTN","%ZVEMSTO",21,0)
TYPE2 ;Left to Right
"RTN","%ZVEMSTO",22,0)
 F X=1:1:VEE("IOM") Q:FLAGQ  F Y=1:1:VEE("IOSL") D DRAW Q:FLAGQ
"RTN","%ZVEMSTO",23,0)
 D DOTSET
"RTN","%ZVEMSTO",24,0)
 Q
"RTN","%ZVEMSTO",25,0)
TYPE3 ;Bottom to Top
"RTN","%ZVEMSTO",26,0)
 F Y=VEE("IOSL"):-1:0 Q:FLAGQ  F X=VEE("IOM"):-1:0 D DRAW Q:FLAGQ
"RTN","%ZVEMSTO",27,0)
 D DOTSET
"RTN","%ZVEMSTO",28,0)
 Q
"RTN","%ZVEMSTO",29,0)
TYPE4 ;Right to Left
"RTN","%ZVEMSTO",30,0)
 F X=VEE("IOM"):-1:0 Q:FLAGQ  F Y=VEE("IOSL"):-1:0 D DRAW Q:FLAGQ
"RTN","%ZVEMSTO",31,0)
 D DOTSET
"RTN","%ZVEMSTO",32,0)
 Q
"RTN","%ZVEMSTO",33,0)
DRAW ;
"RTN","%ZVEMSTO",34,0)
 R XX#1:0 I $T S FLAGQ=1 Q
"RTN","%ZVEMSTO",35,0)
 W $C(27)_"["_Y_";"_X_"H"
"RTN","%ZVEMSTO",36,0)
 ;Smiley face
"RTN","%ZVEMSTO",37,0)
 I Y=5!(Y=17)&(",19,21,59,61,"[(","_X_",")) W 0 Q
"RTN","%ZVEMSTO",38,0)
 I Y=5!(Y=17)&(",20,60,"[(","_X_",")) W " " Q
"RTN","%ZVEMSTO",39,0)
 I Y=6!(Y=18)&(",19,21,59,61,"[(","_X_",")) W " " Q
"RTN","%ZVEMSTO",40,0)
 I Y=6!(Y=18)&(",20,60,"[(","_X_",")) W ">" Q
"RTN","%ZVEMSTO",41,0)
 I Y=7!(Y=19)&(",21,61,"[(","_X_",")) W " " Q
"RTN","%ZVEMSTO",42,0)
 I Y=7!(Y=19)&(",19,59,"[(","_X_",")) W $S(DOT="_":"\",1:"/") Q
"RTN","%ZVEMSTO",43,0)
 I Y=7!(Y=19)&(",20,60,"[(","_X_",")) W $S(DOT="_":"/",1:"\") Q
"RTN","%ZVEMSTO",44,0)
 ;Box pattern
"RTN","%ZVEMSTO",45,0)
 I X<41,Y<13 W $S(X<15!(X>25):DOT,Y<4!(Y>9):DOT,1:DOT1) Q
"RTN","%ZVEMSTO",46,0)
 I X<41,Y>12 W $S(X<15!(X>25):DOT1,Y<16!(Y>21):DOT1,1:DOT) Q
"RTN","%ZVEMSTO",47,0)
 I X>40,Y<13 W $S(X<55!(X>65):DOT1,Y<4!(Y>9):DOT1,1:DOT) Q
"RTN","%ZVEMSTO",48,0)
 I X>40,Y>12 W $S(X<55!(X>65):DOT,Y<16!(Y>21):DOT,1:DOT1)
"RTN","%ZVEMSTO",49,0)
 Q
"RTN","%ZVEMSTO",50,0)
DOTSET ;Change DOT
"RTN","%ZVEMSTO",51,0)
 S DOT=$S(DOT="_":"|",1:"_"),DOT1=$S(DOT1="_":"|",1:"_")
"RTN","%ZVEMSTO",52,0)
 Q
"RTN","%ZVEMSTO",53,0)
CURSOR W $C(27)_"[?25h" Q  ;Cursor on
"RTN","%ZVEMSTO",54,0)
CUROFF W $C(27)_"[?25l" Q  ;Cursor off
"RTN","%ZVEMSTO",55,0)
ERROR ;Turn Cursor back on
"RTN","%ZVEMSTO",56,0)
 D CURSOR,ERRMSG^%ZVEMKU1("'SCRN SAVER'"),PAUSE^%ZVEMKU(2)
"RTN","%ZVEMSTO",57,0)
 Q
"RTN","%ZVEMSTO",58,0)
INIT ;Initialize variables
"RTN","%ZVEMSTO",59,0)
 S PASSWORD="++"
"RTN","%ZVEMSTO",60,0)
 I $D(^%ZOSF("NBRK")) X ^("NBRK") ;Disable 'Ctrl C'
"RTN","%ZVEMSTO",61,0)
 Q
"RTN","%ZVEMSTO",62,0)
INIT1 ;
"RTN","%ZVEMSTO",63,0)
 S DOT="_",DOT1="|",FF="F I=1:1:50 W !"
"RTN","%ZVEMSTO",64,0)
 X FF,VEES("RM0")
"RTN","%ZVEMSTO",65,0)
 Q
"RTN","%ZVEMSTO",66,0)
MARGIN ;Adjust margin if Micronetics
"RTN","%ZVEMSTO",67,0)
 I VEE("OS")=8 S VEES("RM0")="U $I:(0)",VEES("RM80")="U $I:(80)"
"RTN","%ZVEMSTO",68,0)
 E  S (VEES("RM0"),VEES("RM80"))=""
"RTN","%ZVEMSTO",69,0)
 Q
"RTN","%ZVEMSTO",70,0)
VMS ;Drop to VMS to disable Control Y
"RTN","%ZVEMSTO",71,0)
 I $G(VEE("OS"))']"" W $C(7),!!?2,"This routine may only be run from the VShell.",! Q
"RTN","%ZVEMSTO",72,0)
 NEW %SPAWN S %SPAWN="@TIMEOUT.COM" D ^%SPAWN
"RTN","%ZVEMSTO",73,0)
 Q
"RTN","%ZVEMSTO",74,0)
VMS1 ;TIMEOUT.COM should call here
"RTN","%ZVEMSTO",75,0)
 NEW VEES
"RTN","%ZVEMSTO",76,0)
 S (VEES("RM0"),VEES("RM80"))=""
"RTN","%ZVEMSTO",77,0)
 G TOP
"RTN","%ZVEMSTO",78,0)
BLANK ;Call here to blank the screen
"RTN","%ZVEMSTO",79,0)
 I $G(VEESHL)'="RUN" W $C(7),!!?2,"This routine may only be run from the VShell.",! Q
"RTN","%ZVEMSTO",80,0)
 NEW I,PASSWORD,XX
"RTN","%ZVEMSTO",81,0)
 D INIT,CUROFF
"RTN","%ZVEMSTO",82,0)
 X VEE("EOFF") F I=1:1:50 W !
"RTN","%ZVEMSTO",83,0)
BLANK1 R XX#$L(PASSWORD) I XX=PASSWORD X VEE("EON") D CURSOR Q
"RTN","%ZVEMSTO",84,0)
 G BLANK1
"RTN","%ZVEMSTO",85,0)
 Q
"RTN","%ZVEMSU")
0^160^B9492918
"RTN","%ZVEMSU",1,0)
%ZVEMSU ;DJB,VSHL**Util - PURGE,KERNSAVE,RESSYM [10/07/94]
"RTN","%ZVEMSU",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMSU",3,0)
 ;
"RTN","%ZVEMSU",4,0)
USEZERO ;After executing code, reuse device 0
"RTN","%ZVEMSU",5,0)
 I $G(VEE("IO"))']"" U 0 Q
"RTN","%ZVEMSU",6,0)
 NEW X S X="ERROR^%ZVEMSU",@($$TRAP^%ZVEMKU1)
"RTN","%ZVEMSU",7,0)
 U VEE("IO")
"RTN","%ZVEMSU",8,0)
 Q
"RTN","%ZVEMSU",9,0)
ERROR ;Error trap for RESET
"RTN","%ZVEMSU",10,0)
 U 0 W $C(7),!!?1,"---------> VSHELL ALERT!"
"RTN","%ZVEMSU",11,0)
 W !!?1,"VShell is having trouble USEing device 0. This can happen when the"
"RTN","%ZVEMSU",12,0)
 W !?1,"following 3 conditions exist:"
"RTN","%ZVEMSU",13,0)
 W !?5,"1. The VShell global is being translated"
"RTN","%ZVEMSU",14,0)
 W !?5,"2. You have sessions of VShell running on more than one volume group"
"RTN","%ZVEMSU",15,0)
 W !?5,"3. Both sessions have the same $J number but different IO devices"
"RTN","%ZVEMSU",16,0)
 W !!?1,"The fix is to log off one volume group and then log back in under"
"RTN","%ZVEMSU",17,0)
 W !?1,"a different $J number.",!
"RTN","%ZVEMSU",18,0)
 Q
"RTN","%ZVEMSU",19,0)
PURGE ;Purge ^%ZVEMS("%") scratch area
"RTN","%ZVEMSU",20,0)
 I $G(%1)'>0 D PURGEMSG Q
"RTN","%ZVEMSU",21,0)
 NEW X
"RTN","%ZVEMSU",22,0)
 S X="" F  S X=$O(^%ZVEMS("%",X)) Q:X=""  I X'=($J_$G(^%ZVEMS("SY"))) D
"RTN","%ZVEMSU",23,0)
 . I $G(^%ZVEMS("%",X))']"" KILL ^(X) Q
"RTN","%ZVEMSU",24,0)
 . I $D(^%ZVEMS("%",X)),(+$H-(+^(X)))>%1 KILL ^%ZVEMS("%",X) W !?2,"^%ZVEMS(""%"",",X,") deleted.."
"RTN","%ZVEMSU",25,0)
 Q
"RTN","%ZVEMSU",26,0)
PURGEMSG ;Message if no parameter is passed
"RTN","%ZVEMSU",27,0)
 W $C(7),!?1,"The VSHELL has it's own ""scratch"" global area that is deleted when you"
"RTN","%ZVEMSU",28,0)
 W !?1,"HALT. If you HALT unintentionally, these nodes may not be deleted. PUR"
"RTN","%ZVEMSU",29,0)
 W !?1,"will delete these older nodes."
"RTN","%ZVEMSU",30,0)
 W !!?1,"PUR requires a parameter for the number of days to preserve. You'll want"
"RTN","%ZVEMSU",31,0)
 W !?1,"to preserve enough days to cover everyone currently logged into the VSHELL."
"RTN","%ZVEMSU",32,0)
 W !!?1,"Ex: ..PUR 7     Deletes all ^%ZVEMS(""%"") nodes older than 7 days.",!
"RTN","%ZVEMSU",33,0)
 Q
"RTN","%ZVEMSU",34,0)
 ;===================================================================
"RTN","%ZVEMSU",35,0)
KERNSAVE ;Save Symbol Table and ^XUTL("XQ",$J) for Kernel users
"RTN","%ZVEMSU",36,0)
 Q:'$D(XQY0)  Q:'$D(^XUSEC(0))
"RTN","%ZVEMSU",37,0)
 NEW %,%X,%Y,X,Y
"RTN","%ZVEMSU",38,0)
 I $D(^%ZOSF("UCI")) X ^%ZOSF("UCI") S ^%ZVEMS("%",$J_$G(^%ZVEMS("SY")),"KRNUCI")=Y
"RTN","%ZVEMSU",39,0)
 Q:'$D(^XUTL("XQ",$J))
"RTN","%ZVEMSU",40,0)
 S %X="^XUTL(""XQ"",$J,",%Y="^%ZVEMS(""%"","""_$J_$G(^%ZVEMS("SY"))_""",""XUTL"","
"RTN","%ZVEMSU",41,0)
 D %XY^%RCR,SAVSYM
"RTN","%ZVEMSU",42,0)
 Q
"RTN","%ZVEMSU",43,0)
SAVSYM ;Save symbol table.
"RTN","%ZVEMSU",44,0)
 Q:'$$EXIST^%ZVEMKU("%ZOSV")
"RTN","%ZVEMSU",45,0)
 S X="^%ZVEMS(""%"","""_$J_$G(^%ZVEMS("SY"))_""",""SYMTAB""," D DOLRO^%ZOSV
"RTN","%ZVEMSU",46,0)
 Q
"RTN","%ZVEMSU",47,0)
RESSYM ;Restore symbol table.
"RTN","%ZVEMSU",48,0)
 NEW %HLD,%PC,%REF,%VAR
"RTN","%ZVEMSU",49,0)
 KILL (VEESHC) ;Clear symbol table
"RTN","%ZVEMSU",50,0)
 S %REF="^%ZVEMS(""%"","""_$J_$G(^%ZVEMS("SY"))_""",""SYMTAB"")"
"RTN","%ZVEMSU",51,0)
 S %HLD="""%"","""_$J_$G(^%ZVEMS("SY"))_""",""SYMTAB"","
"RTN","%ZVEMSU",52,0)
 F  S %REF=$Q(@%REF) Q:%REF=""!(%REF'[%HLD)  D  ;
"RTN","%ZVEMSU",53,0)
 . F %PC=1:1:10 Q:$P(%REF,",",%PC)["SYMTAB"  ;%PC varies with translation
"RTN","%ZVEMSU",54,0)
 . S %VAR=$P(%REF,",",(%PC+1)),%VAR=$P(%VAR,"""",2) ;Strip quotes
"RTN","%ZVEMSU",55,0)
 . I $P(%REF,",",(%PC+2))]""  S %VAR=%VAR_"("_$P(%REF,",",(%PC+2),99)
"RTN","%ZVEMSU",56,0)
 . I $E(%VAR,1)="%"!($E(%VAR,1,3)="VEE") Q
"RTN","%ZVEMSU",57,0)
 . S @%VAR=@%REF
"RTN","%ZVEMSU",58,0)
 Q
"RTN","%ZVEMSU1")
0^161^B9294180
"RTN","%ZVEMSU1",1,0)
%ZVEMSU1 ;DJB,VSHL**Utilities - KEY,DIC,DIET,DIPT,DIBT ; 1/15/01 8:18am
"RTN","%ZVEMSU1",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMSU1",3,0)
 ;
"RTN","%ZVEMSU1",4,0)
KEY ;Display escape sequence for any key hit.
"RTN","%ZVEMSU1",5,0)
 NEW COL,FLAGQ,HLD,I,X,Y
"RTN","%ZVEMSU1",6,0)
 ;
"RTN","%ZVEMSU1",7,0)
 S X="ERROR^%ZVEMSU1",@($$TRAP^%ZVEMKU1) KILL X
"RTN","%ZVEMSU1",8,0)
 ;
"RTN","%ZVEMSU1",9,0)
 W @VEE("IOF"),!,"K E Y B O A R D   I N T E R P R E T E R",!
"RTN","%ZVEMSU1",10,0)
 S FLAGQ=0
"RTN","%ZVEMSU1",11,0)
 F  D KEY1 Q:FLAGQ
"RTN","%ZVEMSU1",12,0)
 ;
"RTN","%ZVEMSU1",13,0)
KEYEX ;Exit
"RTN","%ZVEMSU1",14,0)
 X VEE("TRMOFF")
"RTN","%ZVEMSU1",15,0)
 X VEE("EON")
"RTN","%ZVEMSU1",16,0)
 Q
"RTN","%ZVEMSU1",17,0)
 ;
"RTN","%ZVEMSU1",18,0)
KEY1 ;Get user input. Use 'Read Terminators'.
"RTN","%ZVEMSU1",19,0)
 X VEE("TRMON")
"RTN","%ZVEMSU1",20,0)
 X VEE("EOFF")
"RTN","%ZVEMSU1",21,0)
 KILL HLD S HLD=""
"RTN","%ZVEMSU1",22,0)
 S COL=12
"RTN","%ZVEMSU1",23,0)
 W !?1,"Hit any key: "
"RTN","%ZVEMSU1",24,0)
 R X#1:100 I ('$T)!($G(X)<0) S FLAGQ=1 Q
"RTN","%ZVEMSU1",25,0)
 I $A(X)>31,$A(X)<127 S X=$A(X)
"RTN","%ZVEMSU1",26,0)
 E  X VEE("TRMRD") S X=Y
"RTN","%ZVEMSU1",27,0)
 W !!?3,"ASCII:",?COL,X
"RTN","%ZVEMSU1",28,0)
 S COL=COL+5
"RTN","%ZVEMSU1",29,0)
 S HLD(1)=X
"RTN","%ZVEMSU1",30,0)
 ;
"RTN","%ZVEMSU1",31,0)
 I (X=0)!(X=27) F I=2:1:10 R *Y:0 D  ;
"RTN","%ZVEMSU1",32,0)
 . Q:(Y<0)
"RTN","%ZVEMSU1",33,0)
 . Q:('$G(Y))
"RTN","%ZVEMSU1",34,0)
 . W ?COL,Y
"RTN","%ZVEMSU1",35,0)
 . S HLD(I)=Y
"RTN","%ZVEMSU1",36,0)
 . S COL=COL+5
"RTN","%ZVEMSU1",37,0)
 ;
"RTN","%ZVEMSU1",38,0)
 W !?3," CHAR:" S COL=12
"RTN","%ZVEMSU1",39,0)
 S X=0
"RTN","%ZVEMSU1",40,0)
 F  S X=$O(HLD(X)) Q:'X  D  ;
"RTN","%ZVEMSU1",41,0)
 . I HLD(X)>31,HLD(X)<127 W ?COL,$C(HLD(X))
"RTN","%ZVEMSU1",42,0)
 . S COL=COL+5
"RTN","%ZVEMSU1",43,0)
 ;
"RTN","%ZVEMSU1",44,0)
 D PAUSEQ^%ZVEMKC(2) W !
"RTN","%ZVEMSU1",45,0)
 Q
"RTN","%ZVEMSU1",46,0)
 ;
"RTN","%ZVEMSU1",47,0)
ERROR ;
"RTN","%ZVEMSU1",48,0)
 W ! G KEYEX
"RTN","%ZVEMSU1",49,0)
 Q
"RTN","%ZVEMSU1",50,0)
 ;====================================================================
"RTN","%ZVEMSU1",51,0)
DICCALL ;Template for on-the-fly DIC look-up
"RTN","%ZVEMSU1",52,0)
 I '$D(^DD) D MSG Q
"RTN","%ZVEMSU1",53,0)
 NEW C,CD,CDHLD,DDH,DIC,DISYS,U,X,Y
"RTN","%ZVEMSU1",54,0)
 S (CD,CDHLD)="S DIC=""^DIZ("",DIC(0)=""QEAM"" D ^DIC"
"RTN","%ZVEMSU1",55,0)
 W !?1,"DIC Look-up Template:"
"RTN","%ZVEMSU1",56,0)
 D SCREEN^%ZVEMKEA("",1,78) W !
"RTN","%ZVEMSU1",57,0)
 Q:CD=CDHLD!(",<ESC>,<F1E>,<F1Q>,<TO>,"[(","_VEESHC_","))
"RTN","%ZVEMSU1",58,0)
 X CD
"RTN","%ZVEMSU1",59,0)
 W !!?1,"Y = ",$G(Y) W:$D(Y(0)) !?1,"Y(0) = ",Y(0) W !
"RTN","%ZVEMSU1",60,0)
 Q
"RTN","%ZVEMSU1",61,0)
 ;====================================================================
"RTN","%ZVEMSU1",62,0)
DIET ;Display Fileman INPUT templates
"RTN","%ZVEMSU1",63,0)
 I '$D(^DD) D MSG Q
"RTN","%ZVEMSU1",64,0)
 I $G(DUZ)'>0 D ID^%ZVEMKU Q:$G(DUZ)=""
"RTN","%ZVEMSU1",65,0)
 NEW DIC,NODE0,X,Y
"RTN","%ZVEMSU1",66,0)
 S DIC="^DIE(",DIC(0)="QEAM"
"RTN","%ZVEMSU1",67,0)
 F  W ! D ^DIC Q:Y<0  W ! S D0=+Y D  D ^DIET
"RTN","%ZVEMSU1",68,0)
 . S NODE0=^DIE(D0,0) D HEADING
"RTN","%ZVEMSU1",69,0)
 Q
"RTN","%ZVEMSU1",70,0)
DIPT ;Display Fileman PRINT templates
"RTN","%ZVEMSU1",71,0)
 I '$D(^DD) D MSG Q
"RTN","%ZVEMSU1",72,0)
 I $G(DUZ)'>0 D ID^%ZVEMKU Q:$G(DUZ)=""
"RTN","%ZVEMSU1",73,0)
 NEW DIC,NODE0,X,Y
"RTN","%ZVEMSU1",74,0)
 S DIC="^DIPT(",DIC(0)="QEAM"
"RTN","%ZVEMSU1",75,0)
 F  W ! D ^DIC Q:Y<0  W ! S D0=+Y D  D ^DIPT
"RTN","%ZVEMSU1",76,0)
 . S NODE0=^DIPT(D0,0) D HEADING
"RTN","%ZVEMSU1",77,0)
 Q
"RTN","%ZVEMSU1",78,0)
DIBT ;Display Fileman SORT templates
"RTN","%ZVEMSU1",79,0)
 I '$D(^DD) D MSG Q
"RTN","%ZVEMSU1",80,0)
 NEW D0,DIC,NODE0,X,Y
"RTN","%ZVEMSU1",81,0)
 S DIC="^DIBT(",DIC(0)="QEAM"
"RTN","%ZVEMSU1",82,0)
 F  W ! D ^DIC Q:Y<0  W ! S D0=+Y D  D DIBT^DIPT
"RTN","%ZVEMSU1",83,0)
 . S NODE0=^DIBT(D0,0) D HEADING
"RTN","%ZVEMSU1",84,0)
 Q
"RTN","%ZVEMSU1",85,0)
MSG ;
"RTN","%ZVEMSU1",86,0)
 W $C(7),!?2,"Fileman not in this UCI.",!
"RTN","%ZVEMSU1",87,0)
 Q
"RTN","%ZVEMSU1",88,0)
HEADING ;Heading for template prints
"RTN","%ZVEMSU1",89,0)
 NEW DATE,FILE,FILENAM
"RTN","%ZVEMSU1",90,0)
 I '$D(DT) S DT=$$FMDATE^%ZVEMKDT()
"RTN","%ZVEMSU1",91,0)
 W @VEE("IOF") S FILENAM="",DATE=$P(NODE0,U,7)
"RTN","%ZVEMSU1",92,0)
 I DATE]"" S DATE=$$DATEDASH^%ZVEMKU1(DATE)
"RTN","%ZVEMSU1",93,0)
 S FILE=$P(NODE0,U,4) I FILE>0,$D(^DIC(FILE,0)) S FILENAM=$P(^(0),U,1)
"RTN","%ZVEMSU1",94,0)
 W !?1,"Template: ",$P(NODE0,U,1)
"RTN","%ZVEMSU1",95,0)
 W ?60,"Printed: ",$E(DT,4,5)_"/"_$E(DT,6,7)_"/"_$E(DT,2,3)
"RTN","%ZVEMSU1",96,0)
 W !?1,"File: ",FILENAM," (#",FILE,")"
"RTN","%ZVEMSU1",97,0)
 W !?1,"Last Used: ",DATE
"RTN","%ZVEMSU1",98,0)
 W !,"-------------------------------------------------------------------------------"
"RTN","%ZVEMSU1",99,0)
 Q
"RTN","%ZVEMSU2")
0^162^B3775138
"RTN","%ZVEMSU2",1,0)
%ZVEMSU2 ;DJB,VSHL**Utilities - ZPrint,ZRemove,Version ; 9/7/02 1:55pm
"RTN","%ZVEMSU2",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMSU2",3,0)
 ;
"RTN","%ZVEMSU2",4,0)
ZPRINT ;ZP System QWIK to print a routine
"RTN","%ZVEMSU2",5,0)
 I $G(%1)']"" D ZPMSG Q
"RTN","%ZVEMSU2",6,0)
 D RTN^%ZVEMKT(%1)
"RTN","%ZVEMSU2",7,0)
 Q
"RTN","%ZVEMSU2",8,0)
ZPMSG ;No parameter passed
"RTN","%ZVEMSU2",9,0)
 W $C(7),!!,"..ZP will print a routine to your screen in scrolling mode. Pass the name"
"RTN","%ZVEMSU2",10,0)
 W !,"of the routine you want to print, as a parameter."
"RTN","%ZVEMSU2",11,0)
 W !!,"Example: ..ZP %ZIS     Print routine ^%ZIS",!
"RTN","%ZVEMSU2",12,0)
 Q
"RTN","%ZVEMSU2",13,0)
 ;====================================================================
"RTN","%ZVEMSU2",14,0)
ZREMOVE() ;Delete a routine
"RTN","%ZVEMSU2",15,0)
 I $G(%1)']"" D ZRMSG Q 0
"RTN","%ZVEMSU2",16,0)
 NEW CHK,I,TMP
"RTN","%ZVEMSU2",17,0)
 S CHK=0 F I=1:1:9 S TMP="%"_I I $G(@TMP)]"",@TMP["^" S CHK=1
"RTN","%ZVEMSU2",18,0)
 I CHK W $C(7),!,"..ZR parameters should not contain ""^"".",! Q 0
"RTN","%ZVEMSU2",19,0)
 I $$YN^%ZVEMKU1("OK TO DELETE? ",2)'=1 Q 0
"RTN","%ZVEMSU2",20,0)
 Q 1
"RTN","%ZVEMSU2",21,0)
ZRMSG ;
"RTN","%ZVEMSU2",22,0)
 W $C(7),!!,"..ZR will delete from 1 to 9 routines. You pass the names of the routines"
"RTN","%ZVEMSU2",23,0)
 W !,"to be deleted, as parameters."
"RTN","%ZVEMSU2",24,0)
 W !!,"Ex 1: ..ZR RTN1             Delete routine ^RTN1"
"RTN","%ZVEMSU2",25,0)
 W !!,"Ex 2: ..ZR RTN1 RTN2 RTN3   Delete routines ^RTN1,^RTN2, & ^RTN3.",!
"RTN","%ZVEMSU2",26,0)
 Q
"RTN","%ZVEMSU2",27,0)
 ;====================================================================
"RTN","%ZVEMSU2",28,0)
VERSION ;VShell Version Information
"RTN","%ZVEMSU2",29,0)
 D:'$D(VEE("RON")) REVVID^%ZVEMKY2
"RTN","%ZVEMSU2",30,0)
 W !?3,@VEE("RON")
"RTN","%ZVEMSU2",31,0)
 W " VPE version ",$P($T(+2),";",3)," "
"RTN","%ZVEMSU2",32,0)
 W @VEE("ROFF"),!
"RTN","%ZVEMSU2",33,0)
 Q
"RTN","%ZVEMSU2",34,0)
 ;
"RTN","%ZVEMSU2",35,0)
CACHE ;
"RTN","%ZVEMSU2",36,0)
 NEW VEES,VRRPGM,VRRS
"RTN","%ZVEMSU2",37,0)
 S VRRS=1
"RTN","%ZVEMSU2",38,0)
 KILL ^TMP("VEE","IR"_VRRS,$J)
"RTN","%ZVEMSU2",39,0)
 S VRRS=1
"RTN","%ZVEMSU2",40,0)
 D ZSAVE^%ZVEMKY3 Q:FLAGQ
"RTN","%ZVEMSU2",41,0)
 F VRRPGM="%ZVEMKRN","%ZVEMSU1" D  ;
"RTN","%ZVEMSU2",42,0)
 . D SETGLB^%ZVEMRS1
"RTN","%ZVEMSU2",43,0)
 . D CONVERT^%ZVEMRV(VRRS)
"RTN","%ZVEMSU2",44,0)
 . X ^%ZVEMS("E",2)
"RTN","%ZVEMSU2",45,0)
 KILL ^TMP("VEE","IR"_VRRS,$J)
"RTN","%ZVEMSU2",46,0)
 KILL ^TMP("VEE","VRR",$J)
"RTN","%ZVEMSU2",47,0)
 Q
"RTN","%ZVEMSY")
0^163^B24494812
"RTN","%ZVEMSY",1,0)
%ZVEMSY ;DJB,VSHL**Init,Error ; 4/6/03 8:25am
"RTN","%ZVEMSY",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMSY",3,0)
 ;
"RTN","%ZVEMSY",4,0)
INIT ;Initialize variables
"RTN","%ZVEMSY",5,0)
 NEW VEESIZE,X,Y
"RTN","%ZVEMSY",6,0)
 I $D(XQY0),$P(XQY0,"^",1)'["VSHELL" D XQY0MSG^%ZVEMSY1 I $D(XQY0) S FLAGQ=1 G EX
"RTN","%ZVEMSY",7,0)
 D  I FLAGQ=1 W $C(7),!!?3,"*** VSHELL CURRENTLY ACTIVE ***",! G EX
"RTN","%ZVEMSY",8,0)
 . I $G(VEESHL)="RUN" S FLAGQ=1 Q
"RTN","%ZVEMSY",9,0)
 . I $D(XQY0),$G(^%ZVEMS("%",$J_$G(^%ZVEMS("SY")),"SHL"))="RUN" S FLAGQ=1
"RTN","%ZVEMSY",10,0)
 KILL ^%ZVEMS("%",$J_$G(^%ZVEMS("SY")))
"RTN","%ZVEMSY",11,0)
 S ^%ZVEMS("%",$J_$G(^%ZVEMS("SY")),"SHL")="RUN"
"RTN","%ZVEMSY",12,0)
 D KERNSAVE^%ZVEMSU ;Support for VA KERNEL
"RTN","%ZVEMSY",13,0)
 I $G(VEE("ID"))'>0 D SETID G:FLAGQ EX
"RTN","%ZVEMSY",14,0)
 D IO^%ZVEMKY
"RTN","%ZVEMSY",15,0)
 D CLH^%ZVEMSY1,OS^%ZVEMKY G:FLAGQ EX
"RTN","%ZVEMSY",16,0)
 D BS^%ZVEMKY1
"RTN","%ZVEMSY",17,0)
 D ZE^%ZVEMKY1
"RTN","%ZVEMSY",18,0)
 D TRMREAD^%ZVEMKY1
"RTN","%ZVEMSY",19,0)
 D ECHO^%ZVEMKY1
"RTN","%ZVEMSY",20,0)
 D HD^%ZVEMSY1
"RTN","%ZVEMSY",21,0)
 D DTM^%ZVEMKY2
"RTN","%ZVEMSY",22,0)
 I $D(^%ZVEMS("%",$J_$G(^%ZVEMS("SY")),"KRNUCI")) D BRK^%ZVEMKY2 ;Enable Ctrl C if VShell is a VA KERNEL menu option.
"RTN","%ZVEMSY",23,0)
 D AUDIT^%ZVEMSY1 Q:FLAGQ
"RTN","%ZVEMSY",24,0)
EX ;
"RTN","%ZVEMSY",25,0)
 Q
"RTN","%ZVEMSY",26,0)
SETID ;Set VEE("ID") variable
"RTN","%ZVEMSY",27,0)
 I $D(^XUSEC(0)) D KERN Q
"RTN","%ZVEMSY",28,0)
 D GETID
"RTN","%ZVEMSY",29,0)
 Q
"RTN","%ZVEMSY",30,0)
KERN ;Get ID using VA KERNEL
"RTN","%ZVEMSY",31,0)
 I $G(DUZ)'>0 D  D ^XUP I $G(DUZ)'>0 S FLAGQ=1 Q
"RTN","%ZVEMSY",32,0)
 . W !!,"------------------------------------------"
"RTN","%ZVEMSY",33,0)
 . W !,"Your DUZ isn't defined. I'm calling ^XUP."
"RTN","%ZVEMSY",34,0)
 . W !,"------------------------------------------",!
"RTN","%ZVEMSY",35,0)
 S FLAGQ=0 I '$D(^%ZOSF("UCI")) D GETID Q
"RTN","%ZVEMSY",36,0)
 NEW VEEUCI X ^%ZOSF("UCI") S VEEUCI=Y
"RTN","%ZVEMSY",37,0)
 I $D(^%ZVEMS("ID","DUZ",DUZ,VEEUCI)) D  Q
"RTN","%ZVEMSY",38,0)
 . S VEE("ID")=$O(^%ZVEMS("ID","DUZ",DUZ,VEEUCI,""))
"RTN","%ZVEMSY",39,0)
 . S ^%ZVEMS("ID","DUZ",DUZ,VEEUCI,VEE("ID"))=$H
"RTN","%ZVEMSY",40,0)
 . S ^%ZVEMS("ID","SHL",VEE("ID"),VEEUCI,DUZ)=$H
"RTN","%ZVEMSY",41,0)
 D KGETID Q:FLAGQ
"RTN","%ZVEMSY",42,0)
 S ^%ZVEMS("ID","DUZ",DUZ,VEEUCI,VEE("ID"))=$H
"RTN","%ZVEMSY",43,0)
 S ^%ZVEMS("ID","SHL",VEE("ID"),VEEUCI,DUZ)=$H
"RTN","%ZVEMSY",44,0)
 Q
"RTN","%ZVEMSY",45,0)
KGETID ;Get ID when using VA KERNEL
"RTN","%ZVEMSY",46,0)
 NEW DEF,ID
"RTN","%ZVEMSY",47,0)
 D IDMSG^%ZVEMSY1,DISCLAIM^%ZVEMKU1
"RTN","%ZVEMSY",48,0)
 S DEF=$G(DUZ)
"RTN","%ZVEMSY",49,0)
KGETID1 W !,"Enter ID Number: " I DEF W DEF_"// "
"RTN","%ZVEMSY",50,0)
 R ID:600 S:'$T ID="^" S:ID="" ID=DEF
"RTN","%ZVEMSY",51,0)
 I "^"[ID S FLAGQ=1 Q
"RTN","%ZVEMSY",52,0)
 I +ID'=ID!(ID<.1)!(ID>999999) D IDHELP^%ZVEMSY1 G KGETID1
"RTN","%ZVEMSY",53,0)
 I $D(^%ZVEMS("ID","SHL",ID,VEEUCI)) D  G KGETID1
"RTN","%ZVEMSY",54,0)
 . W $C(7),"   This ID is already in use."
"RTN","%ZVEMSY",55,0)
 S VEE("ID")=ID
"RTN","%ZVEMSY",56,0)
 Q
"RTN","%ZVEMSY",57,0)
GETID ;Get ID not using VA KERNEL
"RTN","%ZVEMSY",58,0)
 NEW ID
"RTN","%ZVEMSY",59,0)
 D IDMSG^%ZVEMSY1,DISCLAIM^%ZVEMKU1
"RTN","%ZVEMSY",60,0)
GETID1 W !,"Enter ID Number: "
"RTN","%ZVEMSY",61,0)
 R ID:600 S:'$T ID="^" I "^"[ID S FLAGQ=1 Q
"RTN","%ZVEMSY",62,0)
 I +ID'=ID!(ID<.1)!(ID>999999) D IDHELP^%ZVEMSY1 G GETID1
"RTN","%ZVEMSY",63,0)
 S VEE("ID")=ID
"RTN","%ZVEMSY",64,0)
 Q
"RTN","%ZVEMSY",65,0)
T() ;Set error trap. Called by ^%ZVEMS("ZA",1)
"RTN","%ZVEMSY",66,0)
 KILL %1
"RTN","%ZVEMSY",67,0)
 I $D(X)#2 S %1=X
"RTN","%ZVEMSY",68,0)
 S X="ERROR^%ZVEMSY"
"RTN","%ZVEMSY",69,0)
 I $D(^%ZOSF("TRAP")) Q ^("TRAP")
"RTN","%ZVEMSY",70,0)
 Q "$ZT=X"
"RTN","%ZVEMSY",71,0)
 ;
"RTN","%ZVEMSY",72,0)
RESET ;Reset $T and Naked Reference
"RTN","%ZVEMSY",73,0)
 NEW FLAGQ
"RTN","%ZVEMSY",74,0)
 S VEE("$T")=$T
"RTN","%ZVEMSY",75,0)
 I '$G(VEE("OS")) D OS^%ZVEMKY
"RTN","%ZVEMSY",76,0)
 Q:'$G(VEE("OS"))
"RTN","%ZVEMSY",77,0)
 I VEE("OS")=17!(VEE("OS")=19) D  I 1 ;GTM Mumps
"RTN","%ZVEMSY",78,0)
 . X "I $R'[""^%ZVEMS"",$R'[""^TMP(""""VEE"""""" S VEE(""$ZR"")=$R"
"RTN","%ZVEMSY",79,0)
 E  D  ;Non-GTM Mumps
"RTN","%ZVEMSY",80,0)
 . X "I $ZR'[""^%ZVEMS"",$ZR'[""^TMP(""""VEE"""""" S VEE(""$ZR"")=$ZR"
"RTN","%ZVEMSY",81,0)
 Q
"RTN","%ZVEMSY",82,0)
 ;
"RTN","%ZVEMSY",83,0)
ERROR ;Error trap.
"RTN","%ZVEMSY",84,0)
 NEW ERROR,ZE
"RTN","%ZVEMSY",85,0)
 S VEE("$T")=$T
"RTN","%ZVEMSY",86,0)
 S @("ZE="_VEE("$ZE"))
"RTN","%ZVEMSY",87,0)
 ;
"RTN","%ZVEMSY",88,0)
 ;Stop error loops from occurring. If same error occurrs less than a
"RTN","%ZVEMSY",89,0)
 ;second apart, quit VPE Shell.
"RTN","%ZVEMSY",90,0)
 S ERROR=$G(^%ZVEMS("ERROR",VEE("ID")))
"RTN","%ZVEMSY",91,0)
 I ERROR]"",ZE=$P(ERROR,"^",3),$P($H,",",1)=$P(ERROR,"^",1),$P($H,",",2)-$P(ERROR,"^",2)=0 D  Q
"RTN","%ZVEMSY",92,0)
 . S VEESHC="^" ;Stop Shell
"RTN","%ZVEMSY",93,0)
 . W !,"-------------------------------------------------------------"
"RTN","%ZVEMSY",94,0)
 . W !,"The VPE Shell detected an error loop and shut itself down."
"RTN","%ZVEMSY",95,0)
 . W !,"An error loop is the same error occurring twice for the same"
"RTN","%ZVEMSY",96,0)
 . W !,"person, less than a second apart."
"RTN","%ZVEMSY",97,0)
 . W !,"-------------------------------------------------------------"
"RTN","%ZVEMSY",98,0)
 . W !
"RTN","%ZVEMSY",99,0)
 S ^%ZVEMS("ERROR",VEE("ID"))=$P($H,",",1)_"^"_$P($H,",",2)_"^"_ZE
"RTN","%ZVEMSY",100,0)
 ;
"RTN","%ZVEMSY",101,0)
 I VEE("OS")=17!(VEE("OS")=19) D  I 1 ;GTM Mumps
"RTN","%ZVEMSY",102,0)
 . X "I $R'[""^%ZVEMS"",$R'[""^TMP(""""VEE"""""" S VEE(""$ZR"")=$R"
"RTN","%ZVEMSY",103,0)
 . X "I $R[""^%ZOSF(""""UCI"""")"" S VEE(""$ZR"")="""""
"RTN","%ZVEMSY",104,0)
 E  D  ;Non-GTM Mumps
"RTN","%ZVEMSY",105,0)
 . X "I $ZR'[""^%ZVEMS"",$ZR'[""^TMP(""""VEE"""""" S VEE(""$ZR"")=$ZR"
"RTN","%ZVEMSY",106,0)
 . X "I $ZR[""^%ZOSF(""""UCI"""")"" S VEE(""$ZR"")="""""
"RTN","%ZVEMSY",107,0)
 I ZE["PROT" S VEE("$ZR")="" ;Prevents repetitive <PROT> errors
"RTN","%ZVEMSY",108,0)
 I ZE["NOSYS" S VEE("$ZR")="" ;Prevents repetitive <NOSYS> errors
"RTN","%ZVEMSY",109,0)
 S VEE("$ZR")=$G(VEE("$ZR"))
"RTN","%ZVEMSY",110,0)
 D USEZERO^%ZVEMSU
"RTN","%ZVEMSY",111,0)
 I $D(VEE("TRMOFF")) X VEE("TRMOFF")
"RTN","%ZVEMSY",112,0)
 I $D(VEE("EON")) X VEE("EON")
"RTN","%ZVEMSY",113,0)
 W !!,"VPE Error Trap"
"RTN","%ZVEMSY",114,0)
 W !,"Last Global: ",VEE("$ZR")
"RTN","%ZVEMSY",115,0)
 W !,"ERROR: ",ZE,!
"RTN","%ZVEMSY",116,0)
 I $G(IO)>0,$G(VEE("IO"))>0,IO'=VEE("IO") D  D PAUSE^%ZVEMKU(2)
"RTN","%ZVEMSY",117,0)
 . W $C(7),!!,"---------> VSHELL ALERT!"
"RTN","%ZVEMSY",118,0)
 . W !!,"Your IO device isn't what VShell thinks it should be. D ^%ZISC to"
"RTN","%ZVEMSY",119,0)
 . W !,"restore your IO variables to match your login device.",!
"RTN","%ZVEMSY",120,0)
 NEW I F I=1:1:9 KILL @("%"_I) ;Clean up parameter variables
"RTN","%ZVEMSY",121,0)
 Q
"RTN","%ZVEMSY",122,0)
 ;I stopped using following code. In OpenM, it caused Shell to Halt.
"RTN","%ZVEMSY",123,0)
 ;Next, see if ^%ZOSF("VOL") has been deleted or changed.
"RTN","%ZVEMSY",124,0)
 I '$D(^%ZVEMS("%",$J_$G(^%ZVEMS("SY")))) D  Q
"RTN","%ZVEMSY",125,0)
 . W $C(7),!!,"W A R N I N G ! !"
"RTN","%ZVEMSY",126,0)
 . W !!,"^%ZOSF(""VOL"") may have been alterred. This node must"
"RTN","%ZVEMSY",127,0)
 . W !,"be set correctly for VShell to work."
"RTN","%ZVEMSY",128,0)
 . S VEESHC="^" D PAUSE^%ZVEMKU(2)
"RTN","%ZVEMSY",129,0)
 Q
"RTN","%ZVEMSY1")
0^164^B13691164
"RTN","%ZVEMSY1",1,0)
%ZVEMSY1 ;DJB,VSHL**Init cont.. [10/17/97 8:45pm]
"RTN","%ZVEMSY1",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMSY1",3,0)
 ;
"RTN","%ZVEMSY1",4,0)
CLH ;Resequence Command Line History nodes
"RTN","%ZVEMSY1",5,0)
 NEW I,TYPE,X
"RTN","%ZVEMSY1",6,0)
 F TYPE="VSHL","VEDD","VGL","VRR" D  ;
"RTN","%ZVEMSY1",7,0)
 . I $D(^%ZVEMS("CLH",VEE("ID"),TYPE))'>9 KILL ^(TYPE) Q
"RTN","%ZVEMSY1",8,0)
 . S X=""
"RTN","%ZVEMSY1",9,0)
 . F I=1:1 S X=$O(^%ZVEMS("CLH",VEE("ID"),TYPE,X)) Q:X=""!(I>20)  I X>I S ^(I)=^(X) KILL ^(X)
"RTN","%ZVEMSY1",10,0)
 . S ^%ZVEMS("CLH",VEE("ID"),TYPE)=(I-1)
"RTN","%ZVEMSY1",11,0)
 . S X=20
"RTN","%ZVEMSY1",12,0)
 . F  S X=$O(^%ZVEMS("CLH",VEE("ID"),TYPE,X)) Q:X=""  KILL ^(X)
"RTN","%ZVEMSY1",13,0)
 Q
"RTN","%ZVEMSY1",14,0)
IDMSG ;ID message when you first login the VShell.
"RTN","%ZVEMSY1",15,0)
 W !!,"==========================< I D   N U M B E R >=========================="
"RTN","%ZVEMSY1",16,0)
 W !,"Enter your VShell ID number. Your User QWIK commands will not be"
"RTN","%ZVEMSY1",17,0)
 W !,"accessible if your ID is incorrect."
"RTN","%ZVEMSY1",18,0)
 W !!,"For first time users: Your ID number can be a number from .1 to 999999,"
"RTN","%ZVEMSY1",19,0)
 W !,"2 decimal digits. It can match your DUZ number but it doesn't have to."
"RTN","%ZVEMSY1",20,0)
 W !,"The VShell will use your ID to store data that pertains only to you. If"
"RTN","%ZVEMSY1",21,0)
 W !,"VA KERNEL routine ^XUP is not in this UCI, you will need to enter your"
"RTN","%ZVEMSY1",22,0)
 W !,"ID number each time you enter the VShell from this UCI."
"RTN","%ZVEMSY1",23,0)
 W !,"========================================================================="
"RTN","%ZVEMSY1",24,0)
 Q
"RTN","%ZVEMSY1",25,0)
IDHELP ;User hit "?" at ID prompt
"RTN","%ZVEMSY1",26,0)
 W !!,"Any QWIK commands you may have set up are stored with your ID number."
"RTN","%ZVEMSY1",27,0)
 W !,"Enter that number now or these QWIKs will not be accessible. Enter a"
"RTN","%ZVEMSY1",28,0)
 W !,"number from .1 to 999999, 2 decimal digits. If you are using the VA KERNEL"
"RTN","%ZVEMSY1",29,0)
 W !,"and your DUZ is defined, then your DUZ is offered as a default."
"RTN","%ZVEMSY1",30,0)
 W !!,"ID NUMBERS CURRENTLY IN USE:  " I '$D(^%ZVEMS("ID")) W "None",! Q
"RTN","%ZVEMSY1",31,0)
 NEW ID
"RTN","%ZVEMSY1",32,0)
 S ID=""
"RTN","%ZVEMSY1",33,0)
 F  S ID=$O(^%ZVEMS("ID","SHL",ID)) Q:ID=""  D
"RTN","%ZVEMSY1",34,0)
 . W ID
"RTN","%ZVEMSY1",35,0)
 . I $X>70 W ! Q
"RTN","%ZVEMSY1",36,0)
 . W $S($O(^%ZVEMS("ID","SHL",ID))]"":", ",1:"  ")
"RTN","%ZVEMSY1",37,0)
 F  S ID=$O(^%ZVEMS("PARAM",ID)) Q:ID=""  D
"RTN","%ZVEMSY1",38,0)
 . Q:$D(^%ZVEMS("ID","SHL",ID))
"RTN","%ZVEMSY1",39,0)
 . W ID
"RTN","%ZVEMSY1",40,0)
 . I $X>70 W ! Q
"RTN","%ZVEMSY1",41,0)
 . W $S($O(^%ZVEMS("PARAM",ID))]"":", ",1:"  ")
"RTN","%ZVEMSY1",42,0)
 F  S ID=$O(^%ZVEMS("QU",ID)) Q:ID=""  D
"RTN","%ZVEMSY1",43,0)
 . Q:$D(^%ZVEMS("ID","SHL",ID))
"RTN","%ZVEMSY1",44,0)
 . Q:$D(^%ZVEMS("PARAM",ID))
"RTN","%ZVEMSY1",45,0)
 . W ID
"RTN","%ZVEMSY1",46,0)
 . I $X>70 W ! Q
"RTN","%ZVEMSY1",47,0)
 . W $S($O(^%ZVEMS("QU",ID))]"":", ",1:"  ")
"RTN","%ZVEMSY1",48,0)
 W !
"RTN","%ZVEMSY1",49,0)
 Q
"RTN","%ZVEMSY1",50,0)
HD ;Login Heading
"RTN","%ZVEMSY1",51,0)
 D RVCHK^%ZVEMSY2 ;Check reverse video in the TERMINAL TYPE file.
"RTN","%ZVEMSY1",52,0)
 W !!,"VPE . . . Victory Programmer Environment . . . . . . . . . . . . David Bolduc"
"RTN","%ZVEMSY1",53,0)
 W !,"^,H,HALT=Quit   ?=Help   <F1>1,<F1>2=User QWIKs   <F1>3,<F1>4=System QWIKs",!
"RTN","%ZVEMSY1",54,0)
 Q
"RTN","%ZVEMSY1",55,0)
 ;===========================VA KERNEL===============================
"RTN","%ZVEMSY1",56,0)
XQY0MSG ;Invalid Kernel menu option
"RTN","%ZVEMSY1",57,0)
 W $C(7),!!,"VA KERNEL"
"RTN","%ZVEMSY1",58,0)
 W !,"If you're trying to access the VPE VSHELL from the VA KERNEL menu"
"RTN","%ZVEMSY1",59,0)
 W !,"system, the name of the option must contain the word 'VSHELL'."
"RTN","%ZVEMSY1",60,0)
 W !,"You must rename your VSHELL menu option."
"RTN","%ZVEMSY1",61,0)
 W !!,"PROGRAMMER MODE"
"RTN","%ZVEMSY1",62,0)
 W !,"If you're trying to access the VSHELL from Programmer Mode, XQY0"
"RTN","%ZVEMSY1",63,0)
 W !,"must first be killed."
"RTN","%ZVEMSY1",64,0)
 W !
"RTN","%ZVEMSY1",65,0)
 I $$YN^%ZVEMKU1("Shall I kill XQY0? ",2)=1 D  ;
"RTN","%ZVEMSY1",66,0)
 . KILL XQY0
"RTN","%ZVEMSY1",67,0)
 . W "   XQY0 killed..",!
"RTN","%ZVEMSY1",68,0)
 Q
"RTN","%ZVEMSY1",69,0)
AUDIT ;Audit support for VA KERNEL
"RTN","%ZVEMSY1",70,0)
 ;NOTE: May cause problems in MSM NT (DO^%XUCI)
"RTN","%ZVEMSY1",71,0)
 Q:'$D(^%ZOSF("PROGMODE"))
"RTN","%ZVEMSY1",72,0)
 Q:'$D(^%ZOSF("UCI"))
"RTN","%ZVEMSY1",73,0)
 Q:'$D(^%ZOSF("UCICHECK"))
"RTN","%ZVEMSY1",74,0)
 Q:'$$EXIST^%ZVEMKU("%ZOSV")
"RTN","%ZVEMSY1",75,0)
 Q:'$$EXIST^%ZVEMKU("%XUCI")
"RTN","%ZVEMSY1",76,0)
 ;
"RTN","%ZVEMSY1",77,0)
 ;Programmer Mode Log
"RTN","%ZVEMSY1",78,0)
 NEW %,%UCI,%XUCI,PGM,X,XQZ,XUCI,XUSLNT,XUVOL,Y,ZVER
"RTN","%ZVEMSY1",79,0)
 X ^%ZOSF("PROGMODE")
"RTN","%ZVEMSY1",80,0)
 I 'Y X ^%ZOSF("UCI") S XUCI=Y,XQZ="PRGM^ZUA[MGR]",XUSLNT=1,XUVOL=$S($D(^%ZOSF("VOL")):^("VOL"),1:"") D DO^%XUCI
"RTN","%ZVEMSY1",81,0)
 Q
"RTN","%ZVEMSY2")
0^165^B2736809
"RTN","%ZVEMSY2",1,0)
%ZVEMSY2 ;DJB,VSHL**Init cont.. [01/11/94]
"RTN","%ZVEMSY2",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","%ZVEMSY2",3,0)
 ;
"RTN","%ZVEMSY2",4,0)
RVCHK ;Check reverse video
"RTN","%ZVEMSY2",5,0)
 NEW NODE5,RVOFF,RVON,X
"RTN","%ZVEMSY2",6,0)
 Q:$G(IOST(0))'>0  Q:'$D(^%ZIS(2,IOST(0),0))  S NODE5=$G(^(5))
"RTN","%ZVEMSY2",7,0)
 S RVON=$P(NODE5,"^",4),RVOFF=$P(NODE5,"^",5)
"RTN","%ZVEMSY2",8,0)
 I RVON']""!(RVOFF']"") D RVMSG1 Q
"RTN","%ZVEMSY2",9,0)
 W @RVON,@RVOFF D RVMSG2
"RTN","%ZVEMSY2",10,0)
 Q
"RTN","%ZVEMSY2",11,0)
RVMSG1 ;
"RTN","%ZVEMSY2",12,0)
 W $C(7),!!!!?1,"TERMINAL TYPE: " W $P(^%ZIS(2,IOST(0),0),"^",1)
"RTN","%ZVEMSY2",13,0)
 W !?1,"The REVERSE VIDEO ON and REVERSE VIDEO OFF fields in the TERMINAL TYPE"
"RTN","%ZVEMSY2",14,0)
 W !?1,"file are not filled in for your terminal type.",!
"RTN","%ZVEMSY2",15,0)
 Q
"RTN","%ZVEMSY2",16,0)
RVMSG2 ;
"RTN","%ZVEMSY2",17,0)
 W !!!!?1,"TERMINAL TYPE: " W $P(^%ZIS(2,IOST(0),0),"^",1)
"RTN","%ZVEMSY2",18,0)
 W !?1,"If your screen is now in Reverse Video, the REVERSE VIDEO OFF field in the"
"RTN","%ZVEMSY2",19,0)
 W !?1,"TERMINAL TYPE file may not be correct for your terminal type. This will"
"RTN","%ZVEMSY2",20,0)
 W !?1,"adversely effect some VSHELL screens and should be corrected."
"RTN","%ZVEMSY2",21,0)
 W !?1,"Type 'W $C(27,91,109)' if you need to return your screen to normal.",!
"RTN","%ZVEMSY2",22,0)
 Q
"RTN","VEEMI001")
0^166^B9166523
"RTN","VEEMI001",1,0)
VEEMI001 ; ; 04-JAN-2004
"RTN","VEEMI001",2,0)
 ;;12;VPE SHELL;;JAN 04, 2004;Build 8
"RTN","VEEMI001",3,0)
 Q:'DIFQ(19200.11)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
"RTN","VEEMI001",4,0)
Q Q
"RTN","VEEMI001",5,0)
 ;;^DIC(19200.11,0,"GL")
"RTN","VEEMI001",6,0)
 ;;=^VEE(19200.11,
"RTN","VEEMI001",7,0)
 ;;^DIC("B","VPE RTN LBRY",19200.11)
"RTN","VEEMI001",8,0)
 ;;=
"RTN","VEEMI001",9,0)
 ;;^DIC(19200.11,"%D",0)
"RTN","VEEMI001",10,0)
 ;;=^^4^4^3001204^
"RTN","VEEMI001",11,0)
 ;;^DIC(19200.11,"%D",1,0)
"RTN","VEEMI001",12,0)
 ;;=This file stores the names of routines checked out by programmers.
"RTN","VEEMI001",13,0)
 ;;^DIC(19200.11,"%D",2,0)
"RTN","VEEMI001",14,0)
 ;;=When other programmers go to edit a routine on this list, using
"RTN","VEEMI001",15,0)
 ;;^DIC(19200.11,"%D",3,0)
"RTN","VEEMI001",16,0)
 ;;=VPE's routine editor, they get a message notifying them that another
"RTN","VEEMI001",17,0)
 ;;^DIC(19200.11,"%D",4,0)
"RTN","VEEMI001",18,0)
 ;;=programmer has checked out this routine.
"RTN","VEEMI001",19,0)
 ;;^DD(19200.11,0)
"RTN","VEEMI001",20,0)
 ;;=FIELD^^13^4
"RTN","VEEMI001",21,0)
 ;;^DD(19200.11,0,"DT")
"RTN","VEEMI001",22,0)
 ;;=2960202
"RTN","VEEMI001",23,0)
 ;;^DD(19200.11,0,"ID","A1")
"RTN","VEEMI001",24,0)
 ;;=S %I=Y,Y=$S('$D(^(0)):"",$D(^VEE(19200.111,+$P(^(0),U,13),0))#2:$P(^(0),U,1),1:""),C=$P(^DD(19200.111,.01,0),U,2) D Y^DIQ:Y]"" W ?15,Y,@("$E("_DIC_"%I,0),0)") S Y=%I K %I
"RTN","VEEMI001",25,0)
 ;;^DD(19200.11,0,"ID","A2")
"RTN","VEEMI001",26,0)
 ;;=S %I=Y,Y=$S('$D(^(0)):"",$D(^DIC(9.4,+$P(^(0),U,4),0))#2:$P(^(0),U,1),1:""),C=$P(^DD(9.4,.01,0),U,2) D Y^DIQ:Y]"" W ?45,Y,@("$E("_DIC_"%I,0),0)") S Y=%I K %I
"RTN","VEEMI001",27,0)
 ;;^DD(19200.11,0,"IX","B",19200.11,.01)
"RTN","VEEMI001",28,0)
 ;;=
"RTN","VEEMI001",29,0)
 ;;^DD(19200.11,0,"NM","VPE RTN LBRY")
"RTN","VEEMI001",30,0)
 ;;=
"RTN","VEEMI001",31,0)
 ;;^DD(19200.11,.01,0)
"RTN","VEEMI001",32,0)
 ;;=NAME^RF^^0;1^K:$L(X)>8!($L(X)<1)!'(X?1E1.7AN) X
"RTN","VEEMI001",33,0)
 ;;^DD(19200.11,.01,1,0)
"RTN","VEEMI001",34,0)
 ;;=^.1^^-1
"RTN","VEEMI001",35,0)
 ;;^DD(19200.11,.01,1,1,0)
"RTN","VEEMI001",36,0)
 ;;=19200.11^B
"RTN","VEEMI001",37,0)
 ;;^DD(19200.11,.01,1,1,1)
"RTN","VEEMI001",38,0)
 ;;=S ^VEE(19200.11,"B",$E(X,1,30),DA)=""
"RTN","VEEMI001",39,0)
 ;;^DD(19200.11,.01,1,1,2)
"RTN","VEEMI001",40,0)
 ;;=K ^VEE(19200.11,"B",$E(X,1,30),DA)
"RTN","VEEMI001",41,0)
 ;;^DD(19200.11,.01,3)
"RTN","VEEMI001",42,0)
 ;;=Enter name of mumps routine you wish to sign out (1-8 characters).
"RTN","VEEMI001",43,0)
 ;;^DD(19200.11,.01,"DT")
"RTN","VEEMI001",44,0)
 ;;=2951225
"RTN","VEEMI001",45,0)
 ;;^DD(19200.11,4,0)
"RTN","VEEMI001",46,0)
 ;;=IDENTIFIER^F^^0;4^K:$L(X)>30!($L(X)<1) X
"RTN","VEEMI001",47,0)
 ;;^DD(19200.11,4,3)
"RTN","VEEMI001",48,0)
 ;;=Enter word or phrase to group your programmers for easy selection (1-30 characters).
"RTN","VEEMI001",49,0)
 ;;^DD(19200.11,4,"DT")
"RTN","VEEMI001",50,0)
 ;;=2960202
"RTN","VEEMI001",51,0)
 ;;^DD(19200.11,12,0)
"RTN","VEEMI001",52,0)
 ;;=DATE SIGNED OUT^D^^0;12^S %DT="ET" D ^%DT S X=Y K:Y<1 X
"RTN","VEEMI001",53,0)
 ;;^DD(19200.11,12,3)
"RTN","VEEMI001",54,0)
 ;;=Enter data & time routine was signed out.
"RTN","VEEMI001",55,0)
 ;;^DD(19200.11,12,"DT")
"RTN","VEEMI001",56,0)
 ;;=2951224
"RTN","VEEMI001",57,0)
 ;;^DD(19200.11,13,0)
"RTN","VEEMI001",58,0)
 ;;=SIGNED OUT BY^P19200.111'^VEE(19200.111,^0;13^Q
"RTN","VEEMI001",59,0)
 ;;^DD(19200.11,13,3)
"RTN","VEEMI001",60,0)
 ;;=Enter name of programmer who signed out this routine.
"RTN","VEEMI001",61,0)
 ;;^DD(19200.11,13,"DT")
"RTN","VEEMI001",62,0)
 ;;=2951225
"RTN","VEEMI002")
0^167^B12882797
"RTN","VEEMI002",1,0)
VEEMI002 ; ; 04-JAN-2004
"RTN","VEEMI002",2,0)
 ;;12;VPE SHELL;;JAN 04, 2004;Build 8
"RTN","VEEMI002",3,0)
 Q:'DIFQ(19200.111)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
"RTN","VEEMI002",4,0)
Q Q
"RTN","VEEMI002",5,0)
 ;;^DIC(19200.111,0,"GL")
"RTN","VEEMI002",6,0)
 ;;=^VEE(19200.111,
"RTN","VEEMI002",7,0)
 ;;^DIC("B","VPE PERSON",19200.111)
"RTN","VEEMI002",8,0)
 ;;=
"RTN","VEEMI002",9,0)
 ;;^DIC(19200.111,"%D",0)
"RTN","VEEMI002",10,0)
 ;;=^^1^1^3001204^
"RTN","VEEMI002",11,0)
 ;;^DIC(19200.111,"%D",1,0)
"RTN","VEEMI002",12,0)
 ;;=This file associates a person name with a VPE ID.
"RTN","VEEMI002",13,0)
 ;;^DD(19200.111,0)
"RTN","VEEMI002",14,0)
 ;;=FIELD^^4^4
"RTN","VEEMI002",15,0)
 ;;^DD(19200.111,0,"DT")
"RTN","VEEMI002",16,0)
 ;;=3001130
"RTN","VEEMI002",17,0)
 ;;^DD(19200.111,0,"ID","A1")
"RTN","VEEMI002",18,0)
 ;;=W ?40,$P(^(0),U,2)
"RTN","VEEMI002",19,0)
 ;;^DD(19200.111,0,"IX","B",19200.111,.01)
"RTN","VEEMI002",20,0)
 ;;=
"RTN","VEEMI002",21,0)
 ;;^DD(19200.111,0,"IX","C",19200.111,2)
"RTN","VEEMI002",22,0)
 ;;=
"RTN","VEEMI002",23,0)
 ;;^DD(19200.111,0,"IX","ID",19200.111,3)
"RTN","VEEMI002",24,0)
 ;;=
"RTN","VEEMI002",25,0)
 ;;^DD(19200.111,0,"NM","VPE PERSON")
"RTN","VEEMI002",26,0)
 ;;=
"RTN","VEEMI002",27,0)
 ;;^DD(19200.111,0,"PT",19200.11,13)
"RTN","VEEMI002",28,0)
 ;;=
"RTN","VEEMI002",29,0)
 ;;^DD(19200.111,.01,0)
"RTN","VEEMI002",30,0)
 ;;=NAME^RFX^^0;1^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)<3!($L(X)>30)!(X'?1U.UP1","1U.UP) X
"RTN","VEEMI002",31,0)
 ;;^DD(19200.111,.01,1,0)
"RTN","VEEMI002",32,0)
 ;;=^.1
"RTN","VEEMI002",33,0)
 ;;^DD(19200.111,.01,1,1,0)
"RTN","VEEMI002",34,0)
 ;;=19200.111^B
"RTN","VEEMI002",35,0)
 ;;^DD(19200.111,.01,1,1,1)
"RTN","VEEMI002",36,0)
 ;;=S ^VEE(19200.111,"B",$E(X,1,30),DA)=""
"RTN","VEEMI002",37,0)
 ;;^DD(19200.111,.01,1,1,2)
"RTN","VEEMI002",38,0)
 ;;=K ^VEE(19200.111,"B",$E(X,1,30),DA)
"RTN","VEEMI002",39,0)
 ;;^DD(19200.111,.01,3)
"RTN","VEEMI002",40,0)
 ;;=Enter names of programmers who will be signing routines out of the Routine Library (Last,First MI...3-30 characters).
"RTN","VEEMI002",41,0)
 ;;^DD(19200.111,.01,"DT")
"RTN","VEEMI002",42,0)
 ;;=2951225
"RTN","VEEMI002",43,0)
 ;;^DD(19200.111,2,0)
"RTN","VEEMI002",44,0)
 ;;=INITIALS^F^^0;2^K:$L(X)>5!($L(X)<1) X
"RTN","VEEMI002",45,0)
 ;;^DD(19200.111,2,1,0)
"RTN","VEEMI002",46,0)
 ;;=^.1
"RTN","VEEMI002",47,0)
 ;;^DD(19200.111,2,1,1,0)
"RTN","VEEMI002",48,0)
 ;;=19200.111^C
"RTN","VEEMI002",49,0)
 ;;^DD(19200.111,2,1,1,1)
"RTN","VEEMI002",50,0)
 ;;=S ^VEE(19200.111,"C",$E(X,1,30),DA)=""
"RTN","VEEMI002",51,0)
 ;;^DD(19200.111,2,1,1,2)
"RTN","VEEMI002",52,0)
 ;;=K ^VEE(19200.111,"C",$E(X,1,30),DA)
"RTN","VEEMI002",53,0)
 ;;^DD(19200.111,2,1,1,"DT")
"RTN","VEEMI002",54,0)
 ;;=2951225
"RTN","VEEMI002",55,0)
 ;;^DD(19200.111,2,3)
"RTN","VEEMI002",56,0)
 ;;=Enter you initials (1-5 characters). This will help in displays where your name takes up too much space.
"RTN","VEEMI002",57,0)
 ;;^DD(19200.111,2,"DT")
"RTN","VEEMI002",58,0)
 ;;=3001130
"RTN","VEEMI002",59,0)
 ;;^DD(19200.111,3,0)
"RTN","VEEMI002",60,0)
 ;;=VPE ID^NJ9,2^^0;3^K:+X'=X!(X>999999)!(X<.1)!(X?.E1"."3N.N) X
"RTN","VEEMI002",61,0)
 ;;^DD(19200.111,3,1,0)
"RTN","VEEMI002",62,0)
 ;;=^.1
"RTN","VEEMI002",63,0)
 ;;^DD(19200.111,3,1,1,0)
"RTN","VEEMI002",64,0)
 ;;=19200.111^ID
"RTN","VEEMI002",65,0)
 ;;^DD(19200.111,3,1,1,1)
"RTN","VEEMI002",66,0)
 ;;=S ^VEE(19200.111,"ID",$E(X,1,30),DA)=""
"RTN","VEEMI002",67,0)
 ;;^DD(19200.111,3,1,1,2)
"RTN","VEEMI002",68,0)
 ;;=K ^VEE(19200.111,"ID",$E(X,1,30),DA)
"RTN","VEEMI002",69,0)
 ;;^DD(19200.111,3,1,1,"DT")
"RTN","VEEMI002",70,0)
 ;;=2970515
"RTN","VEEMI002",71,0)
 ;;^DD(19200.111,3,3)
"RTN","VEEMI002",72,0)
 ;;=Enter this person's VPE ID number (from .1 to 999999, 2 decimal digits). Your VPE ID is stored in variable VEE("ID").
"RTN","VEEMI002",73,0)
 ;;^DD(19200.111,3,21,0)
"RTN","VEEMI002",74,0)
 ;;=^^2^2^2970515^
"RTN","VEEMI002",75,0)
 ;;^DD(19200.111,3,21,1,0)
"RTN","VEEMI002",76,0)
 ;;= The VPE ID number is used to identify who signed out
"RTN","VEEMI002",77,0)
 ;;^DD(19200.111,3,21,2,0)
"RTN","VEEMI002",78,0)
 ;;= routines in the Routine Library package (..LBRY).
"RTN","VEEMI002",79,0)
 ;;^DD(19200.111,3,"DT")
"RTN","VEEMI002",80,0)
 ;;=2971017
"RTN","VEEMI002",81,0)
 ;;^DD(19200.111,4,0)
"RTN","VEEMI002",82,0)
 ;;=ROUTINE VERSIONING PROMPT^S^y:YES;n:NO;^0;4^Q
"RTN","VEEMI002",83,0)
 ;;^DD(19200.111,4,3)
"RTN","VEEMI002",84,0)
 ;;=Enter NO if you want the routine editor to create versions in the background with no user prompts.
"RTN","VEEMI002",85,0)
 ;;^DD(19200.111,4,"DT")
"RTN","VEEMI002",86,0)
 ;;=3001130
"RTN","VEEMI003")
0^168^B16040385
"RTN","VEEMI003",1,0)
VEEMI003 ; ; 04-JAN-2004
"RTN","VEEMI003",2,0)
 ;;12;VPE SHELL;;JAN 04, 2004;Build 8
"RTN","VEEMI003",3,0)
 Q:'DIFQ(19200.112)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
"RTN","VEEMI003",4,0)
Q Q
"RTN","VEEMI003",5,0)
 ;;^DIC(19200.112,0,"GL")
"RTN","VEEMI003",6,0)
 ;;=^VEE(19200.112,
"RTN","VEEMI003",7,0)
 ;;^DIC("B","VPE RTN VERSIONING",19200.112)
"RTN","VEEMI003",8,0)
 ;;=
"RTN","VEEMI003",9,0)
 ;;^DIC(19200.112,"%D",0)
"RTN","VEEMI003",10,0)
 ;;=^^3^3^3001204^
"RTN","VEEMI003",11,0)
 ;;^DIC(19200.112,"%D",1,0)
"RTN","VEEMI003",12,0)
 ;;=This file stores versions of routines being edited. It allows programmers,
"RTN","VEEMI003",13,0)
 ;;^DIC(19200.112,"%D",2,0)
"RTN","VEEMI003",14,0)
 ;;=who use VPE's routine editor, to restore previous versions of any routine
"RTN","VEEMI003",15,0)
 ;;^DIC(19200.112,"%D",3,0)
"RTN","VEEMI003",16,0)
 ;;=edited.
"RTN","VEEMI003",17,0)
 ;;^DD(19200.112,0)
"RTN","VEEMI003",18,0)
 ;;=FIELD^^4^5
"RTN","VEEMI003",19,0)
 ;;^DD(19200.112,0,"DT")
"RTN","VEEMI003",20,0)
 ;;=3001123
"RTN","VEEMI003",21,0)
 ;;^DD(19200.112,0,"IX","AC1",19200.112,.01)
"RTN","VEEMI003",22,0)
 ;;=
"RTN","VEEMI003",23,0)
 ;;^DD(19200.112,0,"IX","AC2",19200.112,2)
"RTN","VEEMI003",24,0)
 ;;=
"RTN","VEEMI003",25,0)
 ;;^DD(19200.112,0,"IX","B",19200.112,.01)
"RTN","VEEMI003",26,0)
 ;;=
"RTN","VEEMI003",27,0)
 ;;^DD(19200.112,0,"IX","UNIQ",19200.112,.01)
"RTN","VEEMI003",28,0)
 ;;=
"RTN","VEEMI003",29,0)
 ;;^DD(19200.112,0,"NM","VPE RTN VERSIONING")
"RTN","VEEMI003",30,0)
 ;;=
"RTN","VEEMI003",31,0)
 ;;^DD(19200.112,.01,0)
"RTN","VEEMI003",32,0)
 ;;=ROUTINE^RFX^^0;1^D KEY1^%ZVEMRLX
"RTN","VEEMI003",33,0)
 ;;^DD(19200.112,.01,1,0)
"RTN","VEEMI003",34,0)
 ;;=^.1
"RTN","VEEMI003",35,0)
 ;;^DD(19200.112,.01,1,1,0)
"RTN","VEEMI003",36,0)
 ;;=19200.112^B
"RTN","VEEMI003",37,0)
 ;;^DD(19200.112,.01,1,1,1)
"RTN","VEEMI003",38,0)
 ;;=S ^VEE(19200.112,"B",$E(X,1,30),DA)=""
"RTN","VEEMI003",39,0)
 ;;^DD(19200.112,.01,1,1,2)
"RTN","VEEMI003",40,0)
 ;;=K ^VEE(19200.112,"B",$E(X,1,30),DA)
"RTN","VEEMI003",41,0)
 ;;^DD(19200.112,.01,1,2,0)
"RTN","VEEMI003",42,0)
 ;;=19200.112^AC1^MUMPS
"RTN","VEEMI003",43,0)
 ;;^DD(19200.112,.01,1,2,1)
"RTN","VEEMI003",44,0)
 ;;=D SET1^%ZVEMRLX
"RTN","VEEMI003",45,0)
 ;;^DD(19200.112,.01,1,2,2)
"RTN","VEEMI003",46,0)
 ;;=D KILL1^%ZVEMRLX
"RTN","VEEMI003",47,0)
 ;;^DD(19200.112,.01,1,2,"%D",0)
"RTN","VEEMI003",48,0)
 ;;=^^1^1^3001115^
"RTN","VEEMI003",49,0)
 ;;^DD(19200.112,.01,1,2,"%D",1,0)
"RTN","VEEMI003",50,0)
 ;;=This xref prevents duplicate entries for ROUTINE & VERSION fields.
"RTN","VEEMI003",51,0)
 ;;^DD(19200.112,.01,1,2,"DT")
"RTN","VEEMI003",52,0)
 ;;=3001115
"RTN","VEEMI003",53,0)
 ;;^DD(19200.112,.01,1,3,0)
"RTN","VEEMI003",54,0)
 ;;=19200.112^UNIQ^MUMPS
"RTN","VEEMI003",55,0)
 ;;^DD(19200.112,.01,1,3,1)
"RTN","VEEMI003",56,0)
 ;;=I '$D(^VEE(19200.112,"UNIQ",X)) S ^VEE(19200.112,"UNIQ",X,DA)=""
"RTN","VEEMI003",57,0)
 ;;^DD(19200.112,.01,1,3,2)
"RTN","VEEMI003",58,0)
 ;;=D KILLUNIQ^%ZVEMRLX
"RTN","VEEMI003",59,0)
 ;;^DD(19200.112,.01,1,3,"%D",0)
"RTN","VEEMI003",60,0)
 ;;=^^1^1^3001118^^^^
"RTN","VEEMI003",61,0)
 ;;^DD(19200.112,.01,1,3,"%D",1,0)
"RTN","VEEMI003",62,0)
 ;;=This xref allows DIC lookups for unique routine names.
"RTN","VEEMI003",63,0)
 ;;^DD(19200.112,.01,1,3,"DT")
"RTN","VEEMI003",64,0)
 ;;=3001118
"RTN","VEEMI003",65,0)
 ;;^DD(19200.112,.01,3)
"RTN","VEEMI003",66,0)
 ;;=Enter name of a Mumps routine.
"RTN","VEEMI003",67,0)
 ;;^DD(19200.112,.01,"DT")
"RTN","VEEMI003",68,0)
 ;;=3001118
"RTN","VEEMI003",69,0)
 ;;^DD(19200.112,2,0)
"RTN","VEEMI003",70,0)
 ;;=VERSION^RNJ5,0X^^0;2^D KEY2^%ZVEMRLX
"RTN","VEEMI003",71,0)
 ;;^DD(19200.112,2,1,0)
"RTN","VEEMI003",72,0)
 ;;=^.1
"RTN","VEEMI003",73,0)
 ;;^DD(19200.112,2,1,1,0)
"RTN","VEEMI003",74,0)
 ;;=19200.112^AC2^MUMPS
"RTN","VEEMI003",75,0)
 ;;^DD(19200.112,2,1,1,1)
"RTN","VEEMI003",76,0)
 ;;=D SET2^%ZVEMRLX
"RTN","VEEMI003",77,0)
 ;;^DD(19200.112,2,1,1,2)
"RTN","VEEMI003",78,0)
 ;;=D KILL2^%ZVEMRLX
"RTN","VEEMI003",79,0)
 ;;^DD(19200.112,2,1,1,"%D",0)
"RTN","VEEMI003",80,0)
 ;;=^^1^1^3001116^^
"RTN","VEEMI003",81,0)
 ;;^DD(19200.112,2,1,1,"%D",1,0)
"RTN","VEEMI003",82,0)
 ;;=This xref prevents duplicates on the ROUTINE & VERSION fields.
"RTN","VEEMI003",83,0)
 ;;^DD(19200.112,2,1,1,"DT")
"RTN","VEEMI003",84,0)
 ;;=3001115
"RTN","VEEMI003",85,0)
 ;;^DD(19200.112,2,3)
"RTN","VEEMI003",86,0)
 ;;=Enter version number for this routine (1-99999).
"RTN","VEEMI003",87,0)
 ;;^DD(19200.112,2,"DT")
"RTN","VEEMI003",88,0)
 ;;=3001115
"RTN","VEEMI003",89,0)
 ;;^DD(19200.112,3,0)
"RTN","VEEMI003",90,0)
 ;;=DESCRIPTION^F^^0;3^K:$L(X)>60!($L(X)<1) X
"RTN","VEEMI003",91,0)
 ;;^DD(19200.112,3,3)
"RTN","VEEMI003",92,0)
 ;;=Enter a description that will help you decide which version to restore (1-60 characters).
"RTN","VEEMI003",93,0)
 ;;^DD(19200.112,3,"DT")
"RTN","VEEMI003",94,0)
 ;;=3001118
"RTN","VEEMI003",95,0)
 ;;^DD(19200.112,4,0)
"RTN","VEEMI003",96,0)
 ;;=DATE^D^^0;4^S %DT="E" D ^%DT S X=Y K:Y<1 X
"RTN","VEEMI003",97,0)
 ;;^DD(19200.112,4,3)
"RTN","VEEMI003",98,0)
 ;;=Enter the date this version was created or last updated.
"RTN","VEEMI003",99,0)
 ;;^DD(19200.112,4,"DT")
"RTN","VEEMI003",100,0)
 ;;=3001123
"RTN","VEEMI003",101,0)
 ;;^DD(19200.112,20,0)
"RTN","VEEMI003",102,0)
 ;;=TEXT^19200.1121^^WP;0
"RTN","VEEMI003",103,0)
 ;;^DD(19200.1121,0)
"RTN","VEEMI003",104,0)
 ;;=TEXT SUB-FIELD^^.01^1
"RTN","VEEMI003",105,0)
 ;;^DD(19200.1121,0,"DT")
"RTN","VEEMI003",106,0)
 ;;=3001115
"RTN","VEEMI003",107,0)
 ;;^DD(19200.1121,0,"NM","TEXT")
"RTN","VEEMI003",108,0)
 ;;=
"RTN","VEEMI003",109,0)
 ;;^DD(19200.1121,0,"UP")
"RTN","VEEMI003",110,0)
 ;;=19200.112
"RTN","VEEMI003",111,0)
 ;;^DD(19200.1121,.01,0)
"RTN","VEEMI003",112,0)
 ;;=TEXT^W^^0;1^Q
"RTN","VEEMI003",113,0)
 ;;^DD(19200.1121,.01,3)
"RTN","VEEMI003",114,0)
 ;;=Enter the routine's text.
"RTN","VEEMI003",115,0)
 ;;^DD(19200.1121,.01,"DT")
"RTN","VEEMI003",116,0)
 ;;=3001115
"RTN","VEEMI004")
0^169^B29700065
"RTN","VEEMI004",1,0)
VEEMI004 ; ; 04-JAN-2004
"RTN","VEEMI004",2,0)
 ;;12;VPE SHELL;;JAN 04, 2004;Build 8
"RTN","VEEMI004",3,0)
 Q:'DIFQ(19200.113)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
"RTN","VEEMI004",4,0)
Q Q
"RTN","VEEMI004",5,0)
 ;;^DIC(19200.113,0,"GL")
"RTN","VEEMI004",6,0)
 ;;=^VEE(19200.113,
"RTN","VEEMI004",7,0)
 ;;^DIC("B","VPE PROGRAMMER CALL",19200.113)
"RTN","VEEMI004",8,0)
 ;;=
"RTN","VEEMI004",9,0)
 ;;^DD(19200.113,0)
"RTN","VEEMI004",10,0)
 ;;=FIELD^^73^32
"RTN","VEEMI004",11,0)
 ;;^DD(19200.113,0,"DT")
"RTN","VEEMI004",12,0)
 ;;=2960107
"RTN","VEEMI004",13,0)
 ;;^DD(19200.113,0,"ID","A1")
"RTN","VEEMI004",14,0)
 ;;=W ?32,$P(^(0),U,5)
"RTN","VEEMI004",15,0)
 ;;^DD(19200.113,0,"ID","A2")
"RTN","VEEMI004",16,0)
 ;;=W:$D(^("RTN")) ?60,$E(^("RTN"),1,245)
"RTN","VEEMI004",17,0)
 ;;^DD(19200.113,0,"IX","B",19200.113,.01)
"RTN","VEEMI004",18,0)
 ;;=
"RTN","VEEMI004",19,0)
 ;;^DD(19200.113,0,"IX","C",19200.113,3)
"RTN","VEEMI004",20,0)
 ;;=
"RTN","VEEMI004",21,0)
 ;;^DD(19200.113,0,"IX","D",19200.113,20)
"RTN","VEEMI004",22,0)
 ;;=
"RTN","VEEMI004",23,0)
 ;;^DD(19200.113,0,"NM","VPE PROGRAMMER CALL")
"RTN","VEEMI004",24,0)
 ;;=
"RTN","VEEMI004",25,0)
 ;;^DD(19200.113,.01,0)
"RTN","VEEMI004",26,0)
 ;;=NAME^RF^^0;1^K:$L(X)>30!($L(X)<3)!'(X'?1P.E) X
"RTN","VEEMI004",27,0)
 ;;^DD(19200.113,.01,1,0)
"RTN","VEEMI004",28,0)
 ;;=^.1
"RTN","VEEMI004",29,0)
 ;;^DD(19200.113,.01,1,1,0)
"RTN","VEEMI004",30,0)
 ;;=19200.113^B
"RTN","VEEMI004",31,0)
 ;;^DD(19200.113,.01,1,1,1)
"RTN","VEEMI004",32,0)
 ;;=S ^VEE(19200.113,"B",$E(X,1,30),DA)=""
"RTN","VEEMI004",33,0)
 ;;^DD(19200.113,.01,1,1,2)
"RTN","VEEMI004",34,0)
 ;;=K ^VEE(19200.113,"B",$E(X,1,30),DA)
"RTN","VEEMI004",35,0)
 ;;^DD(19200.113,.01,3)
"RTN","VEEMI004",36,0)
 ;;=Enter name of a MUMPS programmer call (3-30 characters).
"RTN","VEEMI004",37,0)
 ;;^DD(19200.113,.01,"DT")
"RTN","VEEMI004",38,0)
 ;;=2960107
"RTN","VEEMI004",39,0)
 ;;^DD(19200.113,2,0)
"RTN","VEEMI004",40,0)
 ;;=ACTIVE^S^n:NO;^0;2^Q
"RTN","VEEMI004",41,0)
 ;;^DD(19200.113,2,3)
"RTN","VEEMI004",42,0)
 ;;=Enter NO to deactivate this call.
"RTN","VEEMI004",43,0)
 ;;^DD(19200.113,2,"DT")
"RTN","VEEMI004",44,0)
 ;;=2960107
"RTN","VEEMI004",45,0)
 ;;^DD(19200.113,3,0)
"RTN","VEEMI004",46,0)
 ;;=IDENTIFIER^F^^0;3^K:$L(X)>20!($L(X)<1) X
"RTN","VEEMI004",47,0)
 ;;^DD(19200.113,3,1,0)
"RTN","VEEMI004",48,0)
 ;;=^.1
"RTN","VEEMI004",49,0)
 ;;^DD(19200.113,3,1,1,0)
"RTN","VEEMI004",50,0)
 ;;=19200.113^C
"RTN","VEEMI004",51,0)
 ;;^DD(19200.113,3,1,1,1)
"RTN","VEEMI004",52,0)
 ;;=S ^VEE(19200.113,"C",$E(X,1,30),DA)=""
"RTN","VEEMI004",53,0)
 ;;^DD(19200.113,3,1,1,2)
"RTN","VEEMI004",54,0)
 ;;=K ^VEE(19200.113,"C",$E(X,1,30),DA)
"RTN","VEEMI004",55,0)
 ;;^DD(19200.113,3,1,1,"DT")
"RTN","VEEMI004",56,0)
 ;;=2960107
"RTN","VEEMI004",57,0)
 ;;^DD(19200.113,3,3)
"RTN","VEEMI004",58,0)
 ;;=This field is cross referenced and can be used for lookup (1-20 characters).
"RTN","VEEMI004",59,0)
 ;;^DD(19200.113,3,"DT")
"RTN","VEEMI004",60,0)
 ;;=2960107
"RTN","VEEMI004",61,0)
 ;;^DD(19200.113,4,0)
"RTN","VEEMI004",62,0)
 ;;=TYPE^S^p:PARAMETER;v:VARIABLE;^0;4^Q
"RTN","VEEMI004",63,0)
 ;;^DD(19200.113,4,3)
"RTN","VEEMI004",64,0)
 ;;=Does this call use parameters or does it rely on variables being set?
"RTN","VEEMI004",65,0)
 ;;^DD(19200.113,4,"DT")
"RTN","VEEMI004",66,0)
 ;;=2960107
"RTN","VEEMI004",67,0)
 ;;^DD(19200.113,5,0)
"RTN","VEEMI004",68,0)
 ;;=DESCRIPTION^F^^0;5^K:$L(X)>30!($L(X)<3) X
"RTN","VEEMI004",69,0)
 ;;^DD(19200.113,5,3)
"RTN","VEEMI004",70,0)
 ;;=Enter short description. It will appear when user types "?" (3-30 characters).
"RTN","VEEMI004",71,0)
 ;;^DD(19200.113,5,"DT")
"RTN","VEEMI004",72,0)
 ;;=2960107
"RTN","VEEMI004",73,0)
 ;;^DD(19200.113,20,0)
"RTN","VEEMI004",74,0)
 ;;=ROUTINE^F^^RTN;E1,245^K:$L(X)>245!($L(X)<1) X
"RTN","VEEMI004",75,0)
 ;;^DD(19200.113,20,1,0)
"RTN","VEEMI004",76,0)
 ;;=^.1
"RTN","VEEMI004",77,0)
 ;;^DD(19200.113,20,1,1,0)
"RTN","VEEMI004",78,0)
 ;;=19200.113^D
"RTN","VEEMI004",79,0)
 ;;^DD(19200.113,20,1,1,1)
"RTN","VEEMI004",80,0)
 ;;=S ^VEE(19200.113,"D",$E(X,1,30),DA)=""
"RTN","VEEMI004",81,0)
 ;;^DD(19200.113,20,1,1,2)
"RTN","VEEMI004",82,0)
 ;;=K ^VEE(19200.113,"D",$E(X,1,30),DA)
"RTN","VEEMI004",83,0)
 ;;^DD(19200.113,20,1,1,"DT")
"RTN","VEEMI004",84,0)
 ;;=2960107
"RTN","VEEMI004",85,0)
 ;;^DD(19200.113,20,3)
"RTN","VEEMI004",86,0)
 ;;=Enter name of MUMPS routine.
"RTN","VEEMI004",87,0)
 ;;^DD(19200.113,20,"DT")
"RTN","VEEMI004",88,0)
 ;;=2960107
"RTN","VEEMI004",89,0)
 ;;^DD(19200.113,21,0)
"RTN","VEEMI004",90,0)
 ;;=PARAM 1^*P19200.114'^VEE(19200.114,^P;1^S DIC("S")="I $P(^(0),U,2)'=""n""" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"RTN","VEEMI004",91,0)
 ;;^DD(19200.113,21,12)
"RTN","VEEMI004",92,0)
 ;;=Screen inactive parameters.
"RTN","VEEMI004",93,0)
 ;;^DD(19200.113,21,12.1)
"RTN","VEEMI004",94,0)
 ;;=S DIC("S")="I $P(^(0),U,2)'=""n"""
"RTN","VEEMI004",95,0)
 ;;^DD(19200.113,21,"DT")
"RTN","VEEMI004",96,0)
 ;;=2960107
"RTN","VEEMI004",97,0)
 ;;^DD(19200.113,22,0)
"RTN","VEEMI004",98,0)
 ;;=PARAM 2^*P19200.114'^VEE(19200.114,^P;2^S DIC("S")="I $P(^(0),U,2)'=""n""" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"RTN","VEEMI004",99,0)
 ;;^DD(19200.113,22,12)
"RTN","VEEMI004",100,0)
 ;;=Screen inactive parameters.
"RTN","VEEMI004",101,0)
 ;;^DD(19200.113,22,12.1)
"RTN","VEEMI004",102,0)
 ;;=S DIC("S")="I $P(^(0),U,2)'=""n"""
"RTN","VEEMI004",103,0)
 ;;^DD(19200.113,22,"DT")
"RTN","VEEMI004",104,0)
 ;;=2960107
"RTN","VEEMI004",105,0)
 ;;^DD(19200.113,23,0)
"RTN","VEEMI004",106,0)
 ;;=PARAM 3^*P19200.114'^VEE(19200.114,^P;3^S DIC("S")="I $P(^(0),U,2)'=""n""" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"RTN","VEEMI004",107,0)
 ;;^DD(19200.113,23,12)
"RTN","VEEMI004",108,0)
 ;;=Screen inactive parameters.
"RTN","VEEMI004",109,0)
 ;;^DD(19200.113,23,12.1)
"RTN","VEEMI004",110,0)
 ;;=S DIC("S")="I $P(^(0),U,2)'=""n"""
"RTN","VEEMI004",111,0)
 ;;^DD(19200.113,23,"DT")
"RTN","VEEMI004",112,0)
 ;;=2960107
"RTN","VEEMI004",113,0)
 ;;^DD(19200.113,24,0)
"RTN","VEEMI004",114,0)
 ;;=PARAM 4^*P19200.114'^VEE(19200.114,^P;4^S DIC("S")="I $P(^(0),U,2)'=""n""" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"RTN","VEEMI004",115,0)
 ;;^DD(19200.113,24,12)
"RTN","VEEMI004",116,0)
 ;;=Screen inactive parameters.
"RTN","VEEMI004",117,0)
 ;;^DD(19200.113,24,12.1)
"RTN","VEEMI004",118,0)
 ;;=S DIC("S")="I $P(^(0),U,2)'=""n"""
"RTN","VEEMI004",119,0)
 ;;^DD(19200.113,24,"DT")
"RTN","VEEMI004",120,0)
 ;;=2960107
"RTN","VEEMI004",121,0)
 ;;^DD(19200.113,25,0)
"RTN","VEEMI004",122,0)
 ;;=PARAM 5^*P19200.114'^VEE(19200.114,^P;5^S DIC("S")="I $P(^(0),U,2)'=""n""" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"RTN","VEEMI004",123,0)
 ;;^DD(19200.113,25,12)
"RTN","VEEMI004",124,0)
 ;;=Screen inactive parameters.
"RTN","VEEMI004",125,0)
 ;;^DD(19200.113,25,12.1)
"RTN","VEEMI004",126,0)
 ;;=S DIC("S")="I $P(^(0),U,2)'=""n"""
"RTN","VEEMI004",127,0)
 ;;^DD(19200.113,25,"DT")
"RTN","VEEMI004",128,0)
 ;;=2960107
"RTN","VEEMI004",129,0)
 ;;^DD(19200.113,26,0)
"RTN","VEEMI004",130,0)
 ;;=PARAM 6^*P19200.114'^VEE(19200.114,^P;6^S DIC("S")="I $P(^(0),U,2)'=""n""" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"RTN","VEEMI004",131,0)
 ;;^DD(19200.113,26,12)
"RTN","VEEMI004",132,0)
 ;;=Screen inactive parameters.
"RTN","VEEMI004",133,0)
 ;;^DD(19200.113,26,12.1)
"RTN","VEEMI004",134,0)
 ;;=S DIC("S")="I $P(^(0),U,2)'=""n"""
"RTN","VEEMI004",135,0)
 ;;^DD(19200.113,26,"DT")
"RTN","VEEMI004",136,0)
 ;;=2960107
"RTN","VEEMI004",137,0)
 ;;^DD(19200.113,27,0)
"RTN","VEEMI004",138,0)
 ;;=PARAM 7^*P19200.114'^VEE(19200.114,^P;7^S DIC("S")="I $P(^(0),U,2)'=""n""" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"RTN","VEEMI004",139,0)
 ;;^DD(19200.113,27,12)
"RTN","VEEMI004",140,0)
 ;;=Screen inactive parameters.
"RTN","VEEMI004",141,0)
 ;;^DD(19200.113,27,12.1)
"RTN","VEEMI004",142,0)
 ;;=S DIC("S")="I $P(^(0),U,2)'=""n"""
"RTN","VEEMI004",143,0)
 ;;^DD(19200.113,27,"DT")
"RTN","VEEMI004",144,0)
 ;;=2960107
"RTN","VEEMI004",145,0)
 ;;^DD(19200.113,28,0)
"RTN","VEEMI004",146,0)
 ;;=PARAM 8^*P19200.114'^VEE(19200.114,^P;8^S DIC("S")="I $P(^(0),U,2)'=""n""" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"RTN","VEEMI004",147,0)
 ;;^DD(19200.113,28,12)
"RTN","VEEMI004",148,0)
 ;;=Screen inactive parameters.
"RTN","VEEMI005")
0^170^B21641135
"RTN","VEEMI005",1,0)
VEEMI005 ; ; 04-JAN-2004
"RTN","VEEMI005",2,0)
 ;;12;VPE SHELL;;JAN 04, 2004;Build 8
"RTN","VEEMI005",3,0)
 Q:'DIFQ(19200.113)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
"RTN","VEEMI005",4,0)
Q Q
"RTN","VEEMI005",5,0)
 ;;^DD(19200.113,28,12.1)
"RTN","VEEMI005",6,0)
 ;;=S DIC("S")="I $P(^(0),U,2)'=""n"""
"RTN","VEEMI005",7,0)
 ;;^DD(19200.113,28,"DT")
"RTN","VEEMI005",8,0)
 ;;=2960107
"RTN","VEEMI005",9,0)
 ;;^DD(19200.113,29,0)
"RTN","VEEMI005",10,0)
 ;;=PARAM 9^*P19200.114'^VEE(19200.114,^P;9^S DIC("S")="I $P(^(0),U,2)'=""n""" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"RTN","VEEMI005",11,0)
 ;;^DD(19200.113,29,12)
"RTN","VEEMI005",12,0)
 ;;=Screen inactive parameters.
"RTN","VEEMI005",13,0)
 ;;^DD(19200.113,29,12.1)
"RTN","VEEMI005",14,0)
 ;;=S DIC("S")="I $P(^(0),U,2)'=""n"""
"RTN","VEEMI005",15,0)
 ;;^DD(19200.113,29,"DT")
"RTN","VEEMI005",16,0)
 ;;=2960107
"RTN","VEEMI005",17,0)
 ;;^DD(19200.113,30,0)
"RTN","VEEMI005",18,0)
 ;;=PARAM 10^*P19200.114'^VEE(19200.114,^P;10^S DIC("S")="I $P(^(0),U,2)'=""n""" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"RTN","VEEMI005",19,0)
 ;;^DD(19200.113,30,12)
"RTN","VEEMI005",20,0)
 ;;=Screen inactive parameters.
"RTN","VEEMI005",21,0)
 ;;^DD(19200.113,30,12.1)
"RTN","VEEMI005",22,0)
 ;;=S DIC("S")="I $P(^(0),U,2)'=""n"""
"RTN","VEEMI005",23,0)
 ;;^DD(19200.113,30,"DT")
"RTN","VEEMI005",24,0)
 ;;=2960107
"RTN","VEEMI005",25,0)
 ;;^DD(19200.113,31,0)
"RTN","VEEMI005",26,0)
 ;;=PARAM 11^*P19200.114'^VEE(19200.114,^P;11^S DIC("S")="I $P(^(0),U,2)'=""n""" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"RTN","VEEMI005",27,0)
 ;;^DD(19200.113,31,12)
"RTN","VEEMI005",28,0)
 ;;=Screen inactive parameters.
"RTN","VEEMI005",29,0)
 ;;^DD(19200.113,31,12.1)
"RTN","VEEMI005",30,0)
 ;;=S DIC("S")="I $P(^(0),U,2)'=""n"""
"RTN","VEEMI005",31,0)
 ;;^DD(19200.113,31,"DT")
"RTN","VEEMI005",32,0)
 ;;=2960107
"RTN","VEEMI005",33,0)
 ;;^DD(19200.113,32,0)
"RTN","VEEMI005",34,0)
 ;;=PARAM 12^*P19200.114'^VEE(19200.114,^P;12^S DIC("S")="I $P(^(0),U,2)'=""n""" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"RTN","VEEMI005",35,0)
 ;;^DD(19200.113,32,12)
"RTN","VEEMI005",36,0)
 ;;=Screen inactive parameters.
"RTN","VEEMI005",37,0)
 ;;^DD(19200.113,32,12.1)
"RTN","VEEMI005",38,0)
 ;;=S DIC("S")="I $P(^(0),U,2)'=""n"""
"RTN","VEEMI005",39,0)
 ;;^DD(19200.113,32,"DT")
"RTN","VEEMI005",40,0)
 ;;=2960107
"RTN","VEEMI005",41,0)
 ;;^DD(19200.113,33,0)
"RTN","VEEMI005",42,0)
 ;;=PARAM 13^*P19200.114'^VEE(19200.114,^P;13^S DIC("S")="I $P(^(0),U,2)'=""n""" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"RTN","VEEMI005",43,0)
 ;;^DD(19200.113,33,12)
"RTN","VEEMI005",44,0)
 ;;=Screen inactive parameters.
"RTN","VEEMI005",45,0)
 ;;^DD(19200.113,33,12.1)
"RTN","VEEMI005",46,0)
 ;;=S DIC("S")="I $P(^(0),U,2)'=""n"""
"RTN","VEEMI005",47,0)
 ;;^DD(19200.113,33,"DT")
"RTN","VEEMI005",48,0)
 ;;=2960107
"RTN","VEEMI005",49,0)
 ;;^DD(19200.113,61,0)
"RTN","VEEMI005",50,0)
 ;;=VALUE 1^F^^V1;E1,245^K:$L(X)>245!($L(X)<1) X
"RTN","VEEMI005",51,0)
 ;;^DD(19200.113,61,3)
"RTN","VEEMI005",52,0)
 ;;=Answer must be 1-245 characters in length.
"RTN","VEEMI005",53,0)
 ;;^DD(19200.113,61,4)
"RTN","VEEMI005",54,0)
 ;;=
"RTN","VEEMI005",55,0)
 ;;^DD(19200.113,61,"DT")
"RTN","VEEMI005",56,0)
 ;;=2960107
"RTN","VEEMI005",57,0)
 ;;^DD(19200.113,62,0)
"RTN","VEEMI005",58,0)
 ;;=VALUE 2^F^^V2;E1,245^K:$L(X)>245!($L(X)<1) X
"RTN","VEEMI005",59,0)
 ;;^DD(19200.113,62,3)
"RTN","VEEMI005",60,0)
 ;;=Answer must be 1-245 characters in length.
"RTN","VEEMI005",61,0)
 ;;^DD(19200.113,62,"DT")
"RTN","VEEMI005",62,0)
 ;;=2960107
"RTN","VEEMI005",63,0)
 ;;^DD(19200.113,63,0)
"RTN","VEEMI005",64,0)
 ;;=VALUE 3^F^^V3;E1,245^K:$L(X)>245!($L(X)<1) X
"RTN","VEEMI005",65,0)
 ;;^DD(19200.113,63,3)
"RTN","VEEMI005",66,0)
 ;;=Answer must be 1-245 characters in length.
"RTN","VEEMI005",67,0)
 ;;^DD(19200.113,63,"DT")
"RTN","VEEMI005",68,0)
 ;;=2960107
"RTN","VEEMI005",69,0)
 ;;^DD(19200.113,64,0)
"RTN","VEEMI005",70,0)
 ;;=VALUE 4^F^^V4;E1,245^K:$L(X)>245!($L(X)<1) X
"RTN","VEEMI005",71,0)
 ;;^DD(19200.113,64,3)
"RTN","VEEMI005",72,0)
 ;;=Answer must be 1-245 characters in length.
"RTN","VEEMI005",73,0)
 ;;^DD(19200.113,64,"DT")
"RTN","VEEMI005",74,0)
 ;;=2960107
"RTN","VEEMI005",75,0)
 ;;^DD(19200.113,65,0)
"RTN","VEEMI005",76,0)
 ;;=VALUE 5^F^^V5;E1,245^K:$L(X)>245!($L(X)<1) X
"RTN","VEEMI005",77,0)
 ;;^DD(19200.113,65,3)
"RTN","VEEMI005",78,0)
 ;;=Answer must be 1-245 characters in length.
"RTN","VEEMI005",79,0)
 ;;^DD(19200.113,65,"DT")
"RTN","VEEMI005",80,0)
 ;;=2960107
"RTN","VEEMI005",81,0)
 ;;^DD(19200.113,66,0)
"RTN","VEEMI005",82,0)
 ;;=VALUE 6^F^^V6;E1,245^K:$L(X)>245!($L(X)<1) X
"RTN","VEEMI005",83,0)
 ;;^DD(19200.113,66,3)
"RTN","VEEMI005",84,0)
 ;;=Answer must be 1-245 characters in length.
"RTN","VEEMI005",85,0)
 ;;^DD(19200.113,66,"DT")
"RTN","VEEMI005",86,0)
 ;;=2960107
"RTN","VEEMI005",87,0)
 ;;^DD(19200.113,67,0)
"RTN","VEEMI005",88,0)
 ;;=VALUE 7^F^^V7;E1,245^K:$L(X)>245!($L(X)<1) X
"RTN","VEEMI005",89,0)
 ;;^DD(19200.113,67,3)
"RTN","VEEMI005",90,0)
 ;;=Answer must be 1-245 characters in length.
"RTN","VEEMI005",91,0)
 ;;^DD(19200.113,67,"DT")
"RTN","VEEMI005",92,0)
 ;;=2960107
"RTN","VEEMI005",93,0)
 ;;^DD(19200.113,68,0)
"RTN","VEEMI005",94,0)
 ;;=VALUE 8^F^^V8;E1,245^K:$L(X)>245!($L(X)<1) X
"RTN","VEEMI005",95,0)
 ;;^DD(19200.113,68,3)
"RTN","VEEMI005",96,0)
 ;;=Answer must be 1-245 characters in length.
"RTN","VEEMI005",97,0)
 ;;^DD(19200.113,68,"DT")
"RTN","VEEMI005",98,0)
 ;;=2960107
"RTN","VEEMI005",99,0)
 ;;^DD(19200.113,69,0)
"RTN","VEEMI005",100,0)
 ;;=VALUE 9^F^^V9;E1,245^K:$L(X)>245!($L(X)<1) X
"RTN","VEEMI005",101,0)
 ;;^DD(19200.113,69,3)
"RTN","VEEMI005",102,0)
 ;;=Answer must be 1-245 characters in length.
"RTN","VEEMI005",103,0)
 ;;^DD(19200.113,69,"DT")
"RTN","VEEMI005",104,0)
 ;;=2960107
"RTN","VEEMI005",105,0)
 ;;^DD(19200.113,70,0)
"RTN","VEEMI005",106,0)
 ;;=VALUE 10^F^^V10;E1,245^K:$L(X)>245!($L(X)<1) X
"RTN","VEEMI005",107,0)
 ;;^DD(19200.113,70,3)
"RTN","VEEMI005",108,0)
 ;;=Answer must be 1-245 characters in length.
"RTN","VEEMI005",109,0)
 ;;^DD(19200.113,70,"DT")
"RTN","VEEMI005",110,0)
 ;;=2960107
"RTN","VEEMI005",111,0)
 ;;^DD(19200.113,71,0)
"RTN","VEEMI005",112,0)
 ;;=VALUE 11^F^^V11;E1,245^K:$L(X)>245!($L(X)<1) X
"RTN","VEEMI005",113,0)
 ;;^DD(19200.113,71,3)
"RTN","VEEMI005",114,0)
 ;;=Answer must be 1-245 characters in length.
"RTN","VEEMI005",115,0)
 ;;^DD(19200.113,71,"DT")
"RTN","VEEMI005",116,0)
 ;;=2960107
"RTN","VEEMI005",117,0)
 ;;^DD(19200.113,72,0)
"RTN","VEEMI005",118,0)
 ;;=VALUE 12^F^^V12;E1,245^K:$L(X)>245!($L(X)<1) X
"RTN","VEEMI005",119,0)
 ;;^DD(19200.113,72,3)
"RTN","VEEMI005",120,0)
 ;;=Answer must be 1-245 characters in length.
"RTN","VEEMI005",121,0)
 ;;^DD(19200.113,72,"DT")
"RTN","VEEMI005",122,0)
 ;;=2960107
"RTN","VEEMI005",123,0)
 ;;^DD(19200.113,73,0)
"RTN","VEEMI005",124,0)
 ;;=VALUE 13^F^^V13;E1,245^K:$L(X)>245!($L(X)<1) X
"RTN","VEEMI005",125,0)
 ;;^DD(19200.113,73,3)
"RTN","VEEMI005",126,0)
 ;;=Answer must be 1-245 characters in length.
"RTN","VEEMI005",127,0)
 ;;^DD(19200.113,73,"DT")
"RTN","VEEMI005",128,0)
 ;;=2960107
"RTN","VEEMI006")
0^171^B24804433
"RTN","VEEMI006",1,0)
VEEMI006 ; ; 04-JAN-2004
"RTN","VEEMI006",2,0)
 ;;12;VPE SHELL;;JAN 04, 2004;Build 8
"RTN","VEEMI006",3,0)
 Q:'DIFQR(19200.113)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
"RTN","VEEMI006",4,0)
Q Q
"RTN","VEEMI006",5,0)
 ;;^UTILITY(U,$J,19200.113)
"RTN","VEEMI006",6,0)
 ;;=^VEE(19200.113,
"RTN","VEEMI006",7,0)
 ;;^UTILITY(U,$J,19200.113,0)
"RTN","VEEMI006",8,0)
 ;;=VPE PROGRAMMER CALL^19200.113I^21^21
"RTN","VEEMI006",9,0)
 ;;^UTILITY(U,$J,19200.113,1,0)
"RTN","VEEMI006",10,0)
 ;;=DBS DIALOG BUILDER^^DIALOG^p^Create msg array
"RTN","VEEMI006",11,0)
 ;;^UTILITY(U,$J,19200.113,1,"P")
"RTN","VEEMI006",12,0)
 ;;=1^2^3^4^5
"RTN","VEEMI006",13,0)
 ;;^UTILITY(U,$J,19200.113,1,"RTN")
"RTN","VEEMI006",14,0)
 ;;=BLD^DIALOG
"RTN","VEEMI006",15,0)
 ;;^UTILITY(U,$J,19200.113,1,"V1")
"RTN","VEEMI006",16,0)
 ;;=201
"RTN","VEEMI006",17,0)
 ;;^UTILITY(U,$J,19200.113,1,"V2")
"RTN","VEEMI006",18,0)
 ;;="TEST"
"RTN","VEEMI006",19,0)
 ;;^UTILITY(U,$J,19200.113,1,"V4")
"RTN","VEEMI006",20,0)
 ;;="AAA"
"RTN","VEEMI006",21,0)
 ;;^UTILITY(U,$J,19200.113,2,0)
"RTN","VEEMI006",22,0)
 ;;=DBS DIALOG EZBLD^^DIALOG^p^Simple text output
"RTN","VEEMI006",23,0)
 ;;^UTILITY(U,$J,19200.113,2,"P")
"RTN","VEEMI006",24,0)
 ;;=1^2
"RTN","VEEMI006",25,0)
 ;;^UTILITY(U,$J,19200.113,2,"RTN")
"RTN","VEEMI006",26,0)
 ;;=$$EZBLD^DIALOG
"RTN","VEEMI006",27,0)
 ;;^UTILITY(U,$J,19200.113,3,0)
"RTN","VEEMI006",28,0)
 ;;=DBS DIALOG WRITER^^DIALOG^p^Writes text
"RTN","VEEMI006",29,0)
 ;;^UTILITY(U,$J,19200.113,3,"P")
"RTN","VEEMI006",30,0)
 ;;=6^4^7^8^9
"RTN","VEEMI006",31,0)
 ;;^UTILITY(U,$J,19200.113,3,"RTN")
"RTN","VEEMI006",32,0)
 ;;=MSG^DIALOG
"RTN","VEEMI006",33,0)
 ;;^UTILITY(U,$J,19200.113,4,0)
"RTN","VEEMI006",34,0)
 ;;=DBS DIC $$FIND^^DIC^p^Returns record number
"RTN","VEEMI006",35,0)
 ;;^UTILITY(U,$J,19200.113,4,"P")
"RTN","VEEMI006",36,0)
 ;;=10^12^15^14^17^18^21
"RTN","VEEMI006",37,0)
 ;;^UTILITY(U,$J,19200.113,4,"RTN")
"RTN","VEEMI006",38,0)
 ;;=$$FIND^DIC
"RTN","VEEMI006",39,0)
 ;;^UTILITY(U,$J,19200.113,5,0)
"RTN","VEEMI006",40,0)
 ;;=DBS DIC FIND^^DIC^p^General purpose look-up
"RTN","VEEMI006",41,0)
 ;;^UTILITY(U,$J,19200.113,5,"P")
"RTN","VEEMI006",42,0)
 ;;=10^12^13^15^14^16^17^18^19^20^21
"RTN","VEEMI006",43,0)
 ;;^UTILITY(U,$J,19200.113,5,"RTN")
"RTN","VEEMI006",44,0)
 ;;=FIND^DIC
"RTN","VEEMI006",45,0)
 ;;^UTILITY(U,$J,19200.113,6,0)
"RTN","VEEMI006",46,0)
 ;;=FM DELETE^^DIK^v^Delete an entry
"RTN","VEEMI006",47,0)
 ;;^UTILITY(U,$J,19200.113,6,"P")
"RTN","VEEMI006",48,0)
 ;;=24^22^23
"RTN","VEEMI006",49,0)
 ;;^UTILITY(U,$J,19200.113,6,"RTN")
"RTN","VEEMI006",50,0)
 ;;=DIK
"RTN","VEEMI006",51,0)
 ;;^UTILITY(U,$J,19200.113,7,0)
"RTN","VEEMI006",52,0)
 ;;=FM DIB^^DIB^v^User controlled edit
"RTN","VEEMI006",53,0)
 ;;^UTILITY(U,$J,19200.113,7,"P")
"RTN","VEEMI006",54,0)
 ;;=25^59^26
"RTN","VEEMI006",55,0)
 ;;^UTILITY(U,$J,19200.113,7,"RTN")
"RTN","VEEMI006",56,0)
 ;;=EN^DIB
"RTN","VEEMI006",57,0)
 ;;^UTILITY(U,$J,19200.113,8,0)
"RTN","VEEMI006",58,0)
 ;;=FM DATA CONVERT^^DIQ^v^Convert data to ext. form
"RTN","VEEMI006",59,0)
 ;;^UTILITY(U,$J,19200.113,8,"P")
"RTN","VEEMI006",60,0)
 ;;=27^28
"RTN","VEEMI006",61,0)
 ;;^UTILITY(U,$J,19200.113,8,"RTN")
"RTN","VEEMI006",62,0)
 ;;=Y^DIQ
"RTN","VEEMI006",63,0)
 ;;^UTILITY(U,$J,19200.113,9,0)
"RTN","VEEMI006",64,0)
 ;;=FM DATA DISPLAY^^DIQ^v^Display data
"RTN","VEEMI006",65,0)
 ;;^UTILITY(U,$J,19200.113,9,"P")
"RTN","VEEMI006",66,0)
 ;;=29^22^30^31
"RTN","VEEMI006",67,0)
 ;;^UTILITY(U,$J,19200.113,9,"RTN")
"RTN","VEEMI006",68,0)
 ;;=EN^DIQ
"RTN","VEEMI006",69,0)
 ;;^UTILITY(U,$J,19200.113,10,0)
"RTN","VEEMI006",70,0)
 ;;=FM LOADER^^DDIOL^p^Replaces WRITE statements
"RTN","VEEMI006",71,0)
 ;;^UTILITY(U,$J,19200.113,10,"P")
"RTN","VEEMI006",72,0)
 ;;=32^33^34
"RTN","VEEMI006",73,0)
 ;;^UTILITY(U,$J,19200.113,10,"RTN")
"RTN","VEEMI006",74,0)
 ;;=EN^DDIOL
"RTN","VEEMI006",75,0)
 ;;^UTILITY(U,$J,19200.113,11,0)
"RTN","VEEMI006",76,0)
 ;;=FM ACCESS^^^v^Determine file access
"RTN","VEEMI006",77,0)
 ;;^UTILITY(U,$J,19200.113,11,"P")
"RTN","VEEMI006",78,0)
 ;;=35^36
"RTN","VEEMI006",79,0)
 ;;^UTILITY(U,$J,19200.113,11,"RTN")
"RTN","VEEMI006",80,0)
 ;;=DIAC
"RTN","VEEMI006",81,0)
 ;;^UTILITY(U,$J,19200.113,12,0)
"RTN","VEEMI006",82,0)
 ;;=FM DIC^^^v^File lookup/Add new entry
"RTN","VEEMI006",83,0)
 ;;^UTILITY(U,$J,19200.113,12,"P")
"RTN","VEEMI006",84,0)
 ;;=29^37^38^39^40^41^42^43^44^45^46^47^48
"RTN","VEEMI006",85,0)
 ;;^UTILITY(U,$J,19200.113,12,"RTN")
"RTN","VEEMI006",86,0)
 ;;=DIC
"RTN","VEEMI006",87,0)
 ;;^UTILITY(U,$J,19200.113,13,0)
"RTN","VEEMI006",88,0)
 ;;=FM XREF LOOKUP^^DIC1^v^Lookup on specific xrefs
"RTN","VEEMI006",89,0)
 ;;^UTILITY(U,$J,19200.113,13,"P")
"RTN","VEEMI006",90,0)
 ;;=29^37^49^47
"RTN","VEEMI006",91,0)
 ;;^UTILITY(U,$J,19200.113,13,"RTN")
"RTN","VEEMI006",92,0)
 ;;=MIX^DIC1
"RTN","VEEMI006",93,0)
 ;;^UTILITY(U,$J,19200.113,14,0)
"RTN","VEEMI006",94,0)
 ;;=FM NEW ENTRY^^DICN^v^Adding a new entry
"RTN","VEEMI006",95,0)
 ;;^UTILITY(U,$J,19200.113,14,"P")
"RTN","VEEMI006",96,0)
 ;;=53^37^43^22^50^51^52
"RTN","VEEMI006",97,0)
 ;;^UTILITY(U,$J,19200.113,14,"RTN")
"RTN","VEEMI006",98,0)
 ;;=FILE^DICN
"RTN","VEEMI006",99,0)
 ;;^UTILITY(U,$J,19200.113,15,0)
"RTN","VEEMI006",100,0)
 ;;=FM YES/NO^^DICN^v^YES/NO response
"RTN","VEEMI006",101,0)
 ;;^UTILITY(U,$J,19200.113,15,"P")
"RTN","VEEMI006",102,0)
 ;;=54
"RTN","VEEMI006",103,0)
 ;;^UTILITY(U,$J,19200.113,15,"RTN")
"RTN","VEEMI006",104,0)
 ;;=YN^DICN
"RTN","VEEMI006",105,0)
 ;;^UTILITY(U,$J,19200.113,16,0)
"RTN","VEEMI006",106,0)
 ;;=FM DISPLAY^^DICQ^v^Entry display for lookups
"RTN","VEEMI006",107,0)
 ;;^UTILITY(U,$J,19200.113,16,"P")
"RTN","VEEMI006",108,0)
 ;;=29^37^40^55^56
"RTN","VEEMI006",109,0)
 ;;^UTILITY(U,$J,19200.113,16,"RTN")
"RTN","VEEMI006",110,0)
 ;;=DQ^DICQ
"RTN","VEEMI006",111,0)
 ;;^UTILITY(U,$J,19200.113,17,0)
"RTN","VEEMI006",112,0)
 ;;=FM DATA DICTIONARY^^DID^v^List data dictionary
"RTN","VEEMI006",113,0)
 ;;^UTILITY(U,$J,19200.113,17,"P")
"RTN","VEEMI006",114,0)
 ;;=29^57
"RTN","VEEMI006",115,0)
 ;;^UTILITY(U,$J,19200.113,17,"RTN")
"RTN","VEEMI006",116,0)
 ;;=EN^DID
"RTN","VEEMI006",117,0)
 ;;^UTILITY(U,$J,19200.113,18,0)
"RTN","VEEMI006",118,0)
 ;;=FM EDIT^^^v^Edit an entry
"RTN","VEEMI006",119,0)
 ;;^UTILITY(U,$J,19200.113,18,"P")
"RTN","VEEMI006",120,0)
 ;;=25^22^58^59^26^60
"RTN","VEEMI006",121,0)
 ;;^UTILITY(U,$J,19200.113,18,"RTN")
"RTN","VEEMI006",122,0)
 ;;=DIE
"RTN","VEEMI006",123,0)
 ;;^UTILITY(U,$J,19200.113,19,0)
"RTN","VEEMI006",124,0)
 ;;=DBS DATA RETRIEVER^^DIQ^p^Retrieves fields of data
"RTN","VEEMI006",125,0)
 ;;^UTILITY(U,$J,19200.113,19,"P")
"RTN","VEEMI006",126,0)
 ;;=10^12^62^61^67^21
"RTN","VEEMI006",127,0)
 ;;^UTILITY(U,$J,19200.113,19,"RTN")
"RTN","VEEMI006",128,0)
 ;;=GETS^DIQ
"RTN","VEEMI006",129,0)
 ;;^UTILITY(U,$J,19200.113,20,0)
"RTN","VEEMI006",130,0)
 ;;=DBS UPDATER^^DIE^p^Add new entries
"RTN","VEEMI006",131,0)
 ;;^UTILITY(U,$J,19200.113,20,"P")
"RTN","VEEMI006",132,0)
 ;;=63^64^65^21
"RTN","VEEMI006",133,0)
 ;;^UTILITY(U,$J,19200.113,20,"RTN")
"RTN","VEEMI006",134,0)
 ;;=UPDATE^DIE
"RTN","VEEMI006",135,0)
 ;;^UTILITY(U,$J,19200.113,21,0)
"RTN","VEEMI006",136,0)
 ;;=DBS FILER^^DIE^p^Puts data into the database
"RTN","VEEMI006",137,0)
 ;;^UTILITY(U,$J,19200.113,21,"P")
"RTN","VEEMI006",138,0)
 ;;=66^64^21
"RTN","VEEMI006",139,0)
 ;;^UTILITY(U,$J,19200.113,21,"RTN")
"RTN","VEEMI006",140,0)
 ;;=FILE^DIE
"RTN","VEEMI006",141,0)
 ;;^UTILITY(U,$J,19200.113,21,"V1")
"RTN","VEEMI006",142,0)
 ;;=
"RTN","VEEMI006",143,0)
 ;;^UTILITY(U,$J,19200.113,21,"V2")
"RTN","VEEMI006",144,0)
 ;;=
"RTN","VEEMI006",145,0)
 ;;^UTILITY(U,$J,19200.113,21,"V3")
"RTN","VEEMI006",146,0)
 ;;=
"RTN","VEEMI007")
0^172^B18056322
"RTN","VEEMI007",1,0)
VEEMI007 ; ; 04-JAN-2004
"RTN","VEEMI007",2,0)
 ;;12;VPE SHELL;;JAN 04, 2004;Build 8
"RTN","VEEMI007",3,0)
 Q:'DIFQ(19200.114)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
"RTN","VEEMI007",4,0)
Q Q
"RTN","VEEMI007",5,0)
 ;;^DIC(19200.114,0,"GL")
"RTN","VEEMI007",6,0)
 ;;=^VEE(19200.114,
"RTN","VEEMI007",7,0)
 ;;^DIC("B","VPE PROGRAMMER PARAMETER",19200.114)
"RTN","VEEMI007",8,0)
 ;;=
"RTN","VEEMI007",9,0)
 ;;^DD(19200.114,0)
"RTN","VEEMI007",10,0)
 ;;=FIELD^^21^6
"RTN","VEEMI007",11,0)
 ;;^DD(19200.114,0,"DT")
"RTN","VEEMI007",12,0)
 ;;=2960115
"RTN","VEEMI007",13,0)
 ;;^DD(19200.114,0,"ID","A1")
"RTN","VEEMI007",14,0)
 ;;=W:$D(^("I")) ?35,$E(^("I"),1,245)
"RTN","VEEMI007",15,0)
 ;;^DD(19200.114,0,"IX","B",19200.114,.01)
"RTN","VEEMI007",16,0)
 ;;=
"RTN","VEEMI007",17,0)
 ;;^DD(19200.114,0,"NM","VPE PROGRAMMER PARAMETER")
"RTN","VEEMI007",18,0)
 ;;=
"RTN","VEEMI007",19,0)
 ;;^DD(19200.114,0,"PT",19200.113,2)
"RTN","VEEMI007",20,0)
 ;;=
"RTN","VEEMI007",21,0)
 ;;^DD(19200.114,0,"PT",19200.113,3)
"RTN","VEEMI007",22,0)
 ;;=
"RTN","VEEMI007",23,0)
 ;;^DD(19200.114,0,"PT",19200.113,4)
"RTN","VEEMI007",24,0)
 ;;=
"RTN","VEEMI007",25,0)
 ;;^DD(19200.114,0,"PT",19200.113,5)
"RTN","VEEMI007",26,0)
 ;;=
"RTN","VEEMI007",27,0)
 ;;^DD(19200.114,0,"PT",19200.113,6)
"RTN","VEEMI007",28,0)
 ;;=
"RTN","VEEMI007",29,0)
 ;;^DD(19200.114,0,"PT",19200.113,7)
"RTN","VEEMI007",30,0)
 ;;=
"RTN","VEEMI007",31,0)
 ;;^DD(19200.114,0,"PT",19200.113,8)
"RTN","VEEMI007",32,0)
 ;;=
"RTN","VEEMI007",33,0)
 ;;^DD(19200.114,0,"PT",19200.113,9)
"RTN","VEEMI007",34,0)
 ;;=
"RTN","VEEMI007",35,0)
 ;;^DD(19200.114,0,"PT",19200.113,10)
"RTN","VEEMI007",36,0)
 ;;=
"RTN","VEEMI007",37,0)
 ;;^DD(19200.114,0,"PT",19200.113,11)
"RTN","VEEMI007",38,0)
 ;;=
"RTN","VEEMI007",39,0)
 ;;^DD(19200.114,0,"PT",19200.113,12)
"RTN","VEEMI007",40,0)
 ;;=
"RTN","VEEMI007",41,0)
 ;;^DD(19200.114,0,"PT",19200.113,13)
"RTN","VEEMI007",42,0)
 ;;=
"RTN","VEEMI007",43,0)
 ;;^DD(19200.114,0,"PT",19200.113,21)
"RTN","VEEMI007",44,0)
 ;;=
"RTN","VEEMI007",45,0)
 ;;^DD(19200.114,0,"PT",19200.113,22)
"RTN","VEEMI007",46,0)
 ;;=
"RTN","VEEMI007",47,0)
 ;;^DD(19200.114,0,"PT",19200.113,23)
"RTN","VEEMI007",48,0)
 ;;=
"RTN","VEEMI007",49,0)
 ;;^DD(19200.114,0,"PT",19200.113,24)
"RTN","VEEMI007",50,0)
 ;;=
"RTN","VEEMI007",51,0)
 ;;^DD(19200.114,0,"PT",19200.113,25)
"RTN","VEEMI007",52,0)
 ;;=
"RTN","VEEMI007",53,0)
 ;;^DD(19200.114,0,"PT",19200.113,26)
"RTN","VEEMI007",54,0)
 ;;=
"RTN","VEEMI007",55,0)
 ;;^DD(19200.114,0,"PT",19200.113,27)
"RTN","VEEMI007",56,0)
 ;;=
"RTN","VEEMI007",57,0)
 ;;^DD(19200.114,0,"PT",19200.113,28)
"RTN","VEEMI007",58,0)
 ;;=
"RTN","VEEMI007",59,0)
 ;;^DD(19200.114,0,"PT",19200.113,29)
"RTN","VEEMI007",60,0)
 ;;=
"RTN","VEEMI007",61,0)
 ;;^DD(19200.114,0,"PT",19200.113,30)
"RTN","VEEMI007",62,0)
 ;;=
"RTN","VEEMI007",63,0)
 ;;^DD(19200.114,0,"PT",19200.113,31)
"RTN","VEEMI007",64,0)
 ;;=
"RTN","VEEMI007",65,0)
 ;;^DD(19200.114,0,"PT",19200.113,32)
"RTN","VEEMI007",66,0)
 ;;=
"RTN","VEEMI007",67,0)
 ;;^DD(19200.114,0,"PT",19200.113,33)
"RTN","VEEMI007",68,0)
 ;;=
"RTN","VEEMI007",69,0)
 ;;^DD(19200.114,.01,0)
"RTN","VEEMI007",70,0)
 ;;=NAME^RF^^0;1^K:$L(X)>30!($L(X)<1) X
"RTN","VEEMI007",71,0)
 ;;^DD(19200.114,.01,1,0)
"RTN","VEEMI007",72,0)
 ;;=^.1
"RTN","VEEMI007",73,0)
 ;;^DD(19200.114,.01,1,1,0)
"RTN","VEEMI007",74,0)
 ;;=19200.114^B
"RTN","VEEMI007",75,0)
 ;;^DD(19200.114,.01,1,1,1)
"RTN","VEEMI007",76,0)
 ;;=S ^VEE(19200.114,"B",$E(X,1,30),DA)=""
"RTN","VEEMI007",77,0)
 ;;^DD(19200.114,.01,1,1,2)
"RTN","VEEMI007",78,0)
 ;;=K ^VEE(19200.114,"B",$E(X,1,30),DA)
"RTN","VEEMI007",79,0)
 ;;^DD(19200.114,.01,3)
"RTN","VEEMI007",80,0)
 ;;=Use ~ for ^, and ' for " (1-30 characters).
"RTN","VEEMI007",81,0)
 ;;^DD(19200.114,.01,"DT")
"RTN","VEEMI007",82,0)
 ;;=2960114
"RTN","VEEMI007",83,0)
 ;;^DD(19200.114,2,0)
"RTN","VEEMI007",84,0)
 ;;=ACTIVE^S^n:NO;^0;2^Q
"RTN","VEEMI007",85,0)
 ;;^DD(19200.114,2,3)
"RTN","VEEMI007",86,0)
 ;;=Enter NO to deactivate this parameter.
"RTN","VEEMI007",87,0)
 ;;^DD(19200.114,2,"DT")
"RTN","VEEMI007",88,0)
 ;;=2960106
"RTN","VEEMI007",89,0)
 ;;^DD(19200.114,15,0)
"RTN","VEEMI007",90,0)
 ;;=IDENTIFIER^F^^I;E1,245^K:$L(X)>245!($L(X)<1) X
"RTN","VEEMI007",91,0)
 ;;^DD(19200.114,15,3)
"RTN","VEEMI007",92,0)
 ;;=Enter text to help identify this parameter since some parameters have to be entered with the same name but different values.
"RTN","VEEMI007",93,0)
 ;;^DD(19200.114,15,"DT")
"RTN","VEEMI007",94,0)
 ;;=2960106
"RTN","VEEMI007",95,0)
 ;;^DD(19200.114,16,0)
"RTN","VEEMI007",96,0)
 ;;=DEFAULT^F^^D;E1,245^K:$L(X)>245!($L(X)<1) X
"RTN","VEEMI007",97,0)
 ;;^DD(19200.114,16,3)
"RTN","VEEMI007",98,0)
 ;;=Answer must be 1-245 characters in length.
"RTN","VEEMI007",99,0)
 ;;^DD(19200.114,16,"DT")
"RTN","VEEMI007",100,0)
 ;;=2960108
"RTN","VEEMI007",101,0)
 ;;^DD(19200.114,20,0)
"RTN","VEEMI007",102,0)
 ;;=HELP TEXT^19200.124^^WP;0
"RTN","VEEMI007",103,0)
 ;;^DD(19200.114,20,"DT")
"RTN","VEEMI007",104,0)
 ;;=2960107
"RTN","VEEMI007",105,0)
 ;;^DD(19200.114,21,0)
"RTN","VEEMI007",106,0)
 ;;=EXTENDED HELP TEXT^19200.11421^^WP1;0
"RTN","VEEMI007",107,0)
 ;;^DD(19200.11421,0)
"RTN","VEEMI007",108,0)
 ;;=EXTENDED HELP TEXT SUB-FIELD^^.01^1
"RTN","VEEMI007",109,0)
 ;;^DD(19200.11421,0,"DT")
"RTN","VEEMI007",110,0)
 ;;=2960115
"RTN","VEEMI007",111,0)
 ;;^DD(19200.11421,0,"NM","EXTENDED HELP TEXT")
"RTN","VEEMI007",112,0)
 ;;=
"RTN","VEEMI007",113,0)
 ;;^DD(19200.11421,0,"UP")
"RTN","VEEMI007",114,0)
 ;;=19200.114
"RTN","VEEMI007",115,0)
 ;;^DD(19200.11421,.01,0)
"RTN","VEEMI007",116,0)
 ;;=EXTENDED HELP TEXT^W^^0;1^Q
"RTN","VEEMI007",117,0)
 ;;^DD(19200.11421,.01,3)
"RTN","VEEMI007",118,0)
 ;;=Text entered here will display when user hits "H".
"RTN","VEEMI007",119,0)
 ;;^DD(19200.11421,.01,"DT")
"RTN","VEEMI007",120,0)
 ;;=2960115
"RTN","VEEMI007",121,0)
 ;;^DD(19200.124,0)
"RTN","VEEMI007",122,0)
 ;;=HELP TEXT SUB-FIELD^^.01^1
"RTN","VEEMI007",123,0)
 ;;^DD(19200.124,0,"DT")
"RTN","VEEMI007",124,0)
 ;;=2960106
"RTN","VEEMI007",125,0)
 ;;^DD(19200.124,0,"NM","HELP TEXT")
"RTN","VEEMI007",126,0)
 ;;=
"RTN","VEEMI007",127,0)
 ;;^DD(19200.124,0,"UP")
"RTN","VEEMI007",128,0)
 ;;=19200.114
"RTN","VEEMI007",129,0)
 ;;^DD(19200.124,.01,0)
"RTN","VEEMI007",130,0)
 ;;=HELP TEXT^W^^0;1^Q
"RTN","VEEMI007",131,0)
 ;;^DD(19200.124,.01,3)
"RTN","VEEMI007",132,0)
 ;;=Enter text describing this parameter.
"RTN","VEEMI007",133,0)
 ;;^DD(19200.124,.01,"DT")
"RTN","VEEMI007",134,0)
 ;;=2960107
"RTN","VEEMI008")
0^173^B29790897
"RTN","VEEMI008",1,0)
VEEMI008 ; ; 04-JAN-2004
"RTN","VEEMI008",2,0)
 ;;12;VPE SHELL;;JAN 04, 2004;Build 8
"RTN","VEEMI008",3,0)
 Q:'DIFQR(19200.114)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
"RTN","VEEMI008",4,0)
Q Q
"RTN","VEEMI008",5,0)
 ;;^UTILITY(U,$J,19200.114)
"RTN","VEEMI008",6,0)
 ;;=^VEE(19200.114,
"RTN","VEEMI008",7,0)
 ;;^UTILITY(U,$J,19200.114,0)
"RTN","VEEMI008",8,0)
 ;;=VPE PROGRAMMER PARAMETER^19200.114I^67^67
"RTN","VEEMI008",9,0)
 ;;^UTILITY(U,$J,19200.114,1,0)
"RTN","VEEMI008",10,0)
 ;;=DIALOG#^n
"RTN","VEEMI008",11,0)
 ;;^UTILITY(U,$J,19200.114,1,"WP",0)
"RTN","VEEMI008",12,0)
 ;;=^^1^1^2960107^^^^
"RTN","VEEMI008",13,0)
 ;;^UTILITY(U,$J,19200.114,1,"WP",1,0)
"RTN","VEEMI008",14,0)
 ;;=Record number from DIALOG file ^DI(.84), for text to be returned.
"RTN","VEEMI008",15,0)
 ;;^UTILITY(U,$J,19200.114,2,0)
"RTN","VEEMI008",16,0)
 ;;=TEXT_PARAM
"RTN","VEEMI008",17,0)
 ;;^UTILITY(U,$J,19200.114,2,"WP",0)
"RTN","VEEMI008",18,0)
 ;;=^^3^3^2960106^
"RTN","VEEMI008",19,0)
 ;;^UTILITY(U,$J,19200.114,2,"WP",1,0)
"RTN","VEEMI008",20,0)
 ;;=Name of local array containing list of parameters to be incorporated
"RTN","VEEMI008",21,0)
 ;;^UTILITY(U,$J,19200.114,2,"WP",2,0)
"RTN","VEEMI008",22,0)
 ;;=into the text. External format. If only one param, it can be passed
"RTN","VEEMI008",23,0)
 ;;^UTILITY(U,$J,19200.114,2,"WP",3,0)
"RTN","VEEMI008",24,0)
 ;;=in a local variable or a literal.
"RTN","VEEMI008",25,0)
 ;;^UTILITY(U,$J,19200.114,3,0)
"RTN","VEEMI008",26,0)
 ;;=OUTPUT_PARAM
"RTN","VEEMI008",27,0)
 ;;^UTILITY(U,$J,19200.114,3,"WP",0)
"RTN","VEEMI008",28,0)
 ;;=^^2^2^2960106^^
"RTN","VEEMI008",29,0)
 ;;^UTILITY(U,$J,19200.114,3,"WP",1,0)
"RTN","VEEMI008",30,0)
 ;;=Used for ERROR dialogue only. Local array containing list of
"RTN","VEEMI008",31,0)
 ;;^UTILITY(U,$J,19200.114,3,"WP",2,0)
"RTN","VEEMI008",32,0)
 ;;=parameters to be passed to calling routine along with text.
"RTN","VEEMI008",33,0)
 ;;^UTILITY(U,$J,19200.114,4,0)
"RTN","VEEMI008",34,0)
 ;;=OUT_ARRAY
"RTN","VEEMI008",35,0)
 ;;^UTILITY(U,$J,19200.114,4,"WP",0)
"RTN","VEEMI008",36,0)
 ;;=^^1^1^2960106^^
"RTN","VEEMI008",37,0)
 ;;^UTILITY(U,$J,19200.114,4,"WP",1,0)
"RTN","VEEMI008",38,0)
 ;;=Text will be output to this array. If null, ^TMP is used.
"RTN","VEEMI008",39,0)
 ;;^UTILITY(U,$J,19200.114,5,0)
"RTN","VEEMI008",40,0)
 ;;=FLAGS
"RTN","VEEMI008",41,0)
 ;;^UTILITY(U,$J,19200.114,5,"I")
"RTN","VEEMI008",42,0)
 ;;=BLD^DIALOG
"RTN","VEEMI008",43,0)
 ;;^UTILITY(U,$J,19200.114,5,"WP",0)
"RTN","VEEMI008",44,0)
 ;;=^^2^2^2960521^^^^
"RTN","VEEMI008",45,0)
 ;;^UTILITY(U,$J,19200.114,5,"WP",1,0)
"RTN","VEEMI008",46,0)
 ;;=S=Suppress blank line normally inserted between text blocks.
"RTN","VEEMI008",47,0)
 ;;^UTILITY(U,$J,19200.114,5,"WP",2,0)
"RTN","VEEMI008",48,0)
 ;;=F=Formats local array similar to default output to ^TMP global.
"RTN","VEEMI008",49,0)
 ;;^UTILITY(U,$J,19200.114,6,0)
"RTN","VEEMI008",50,0)
 ;;=FLAGS
"RTN","VEEMI008",51,0)
 ;;^UTILITY(U,$J,19200.114,6,"I")
"RTN","VEEMI008",52,0)
 ;;=MSG^DIALOG
"RTN","VEEMI008",53,0)
 ;;^UTILITY(U,$J,19200.114,6,"WP",0)
"RTN","VEEMI008",54,0)
 ;;=^^4^4^2960521^^^
"RTN","VEEMI008",55,0)
 ;;^UTILITY(U,$J,19200.114,6,"WP",1,0)
"RTN","VEEMI008",56,0)
 ;;=A=Array specified by 2nd param receives the text.
"RTN","VEEMI008",57,0)
 ;;^UTILITY(U,$J,19200.114,6,"WP",2,0)
"RTN","VEEMI008",58,0)
 ;;=W=Write text to current device.
"RTN","VEEMI008",59,0)
 ;;^UTILITY(U,$J,19200.114,6,"WP",3,0)
"RTN","VEEMI008",60,0)
 ;;=S=Save ^TMP or designated array.
"RTN","VEEMI008",61,0)
 ;;^UTILITY(U,$J,19200.114,6,"WP",4,0)
"RTN","VEEMI008",62,0)
 ;;=E,H,M=Error,Help, or Message array text is processed.
"RTN","VEEMI008",63,0)
 ;;^UTILITY(U,$J,19200.114,7,0)
"RTN","VEEMI008",64,0)
 ;;=TEXT_WIDTH
"RTN","VEEMI008",65,0)
 ;;^UTILITY(U,$J,19200.114,7,"WP",0)
"RTN","VEEMI008",66,0)
 ;;=^^3^3^2960106^
"RTN","VEEMI008",67,0)
 ;;^UTILITY(U,$J,19200.114,7,"WP",1,0)
"RTN","VEEMI008",68,0)
 ;;=Maximum line length for formatting text. If sent, text is broken
"RTN","VEEMI008",69,0)
 ;;^UTILITY(U,$J,19200.114,7,"WP",2,0)
"RTN","VEEMI008",70,0)
 ;;=into lines of this length. Lines are not "joined" to fill out to
"RTN","VEEMI008",71,0)
 ;;^UTILITY(U,$J,19200.114,7,"WP",3,0)
"RTN","VEEMI008",72,0)
 ;;=this width. Default is IOM or 75.
"RTN","VEEMI008",73,0)
 ;;^UTILITY(U,$J,19200.114,8,0)
"RTN","VEEMI008",74,0)
 ;;=LEFT_MARGIN
"RTN","VEEMI008",75,0)
 ;;^UTILITY(U,$J,19200.114,8,"WP",0)
"RTN","VEEMI008",76,0)
 ;;=^^1^1^2960106^
"RTN","VEEMI008",77,0)
 ;;^UTILITY(U,$J,19200.114,8,"WP",1,0)
"RTN","VEEMI008",78,0)
 ;;=Left margin for writing text. Has no effect on text sent to an array.
"RTN","VEEMI008",79,0)
 ;;^UTILITY(U,$J,19200.114,9,0)
"RTN","VEEMI008",80,0)
 ;;=INPUT_ROOT
"RTN","VEEMI008",81,0)
 ;;^UTILITY(U,$J,19200.114,9,"WP",0)
"RTN","VEEMI008",82,0)
 ;;=^^3^3^2960106^
"RTN","VEEMI008",83,0)
 ;;^UTILITY(U,$J,19200.114,9,"WP",1,0)
"RTN","VEEMI008",84,0)
 ;;=Closed root of array in which text resides. If text resides in a
"RTN","VEEMI008",85,0)
 ;;^UTILITY(U,$J,19200.114,9,"WP",2,0)
"RTN","VEEMI008",86,0)
 ;;=local array, this parameter MUST be sent. The last subscript of the
"RTN","VEEMI008",87,0)
 ;;^UTILITY(U,$J,19200.114,9,"WP",3,0)
"RTN","VEEMI008",88,0)
 ;;=array must describe type of text ("DIERR", "DIHELP", or "DIMSG").
"RTN","VEEMI008",89,0)
 ;;^UTILITY(U,$J,19200.114,10,0)
"RTN","VEEMI008",90,0)
 ;;=FILE
"RTN","VEEMI008",91,0)
 ;;^UTILITY(U,$J,19200.114,10,"WP",0)
"RTN","VEEMI008",92,0)
 ;;=^^2^2^2960106^
"RTN","VEEMI008",93,0)
 ;;^UTILITY(U,$J,19200.114,10,"WP",1,0)
"RTN","VEEMI008",94,0)
 ;;=Number of file or subfile. If it is a subfile, it must be
"RTN","VEEMI008",95,0)
 ;;^UTILITY(U,$J,19200.114,10,"WP",2,0)
"RTN","VEEMI008",96,0)
 ;;=accompanied by the IENS parameter.
"RTN","VEEMI008",97,0)
 ;;^UTILITY(U,$J,19200.114,11,0)
"RTN","VEEMI008",98,0)
 ;;=IENS
"RTN","VEEMI008",99,0)
 ;;^UTILITY(U,$J,19200.114,11,"I")
"RTN","VEEMI008",100,0)
 ;;=EXTENDED
"RTN","VEEMI008",101,0)
 ;;^UTILITY(U,$J,19200.114,11,"WP",0)
"RTN","VEEMI008",102,0)
 ;;=^^4^4^2960106^^^^
"RTN","VEEMI008",103,0)
 ;;^UTILITY(U,$J,19200.114,11,"WP",1,0)
"RTN","VEEMI008",104,0)
 ;;=A comma-delimited list of internal entry numbers beginning with
"RTN","VEEMI008",105,0)
 ;;^UTILITY(U,$J,19200.114,11,"WP",2,0)
"RTN","VEEMI008",106,0)
 ;;=the lowest level subentry. A "," is appended to the end. A place-
"RTN","VEEMI008",107,0)
 ;;^UTILITY(U,$J,19200.114,11,"WP",3,0)
"RTN","VEEMI008",108,0)
 ;;=holder of 1 or 2 characters can be used. +=Add a new entry
"RTN","VEEMI008",109,0)
 ;;^UTILITY(U,$J,19200.114,11,"WP",4,0)
"RTN","VEEMI008",110,0)
 ;;=?=Find entry and use for filing  ?+=Find entry (LAYGO authorized)
"RTN","VEEMI008",111,0)
 ;;^UTILITY(U,$J,19200.114,12,0)
"RTN","VEEMI008",112,0)
 ;;=IENS
"RTN","VEEMI008",113,0)
 ;;^UTILITY(U,$J,19200.114,12,"I")
"RTN","VEEMI008",114,0)
 ;;=FIND^DIC
"RTN","VEEMI008",115,0)
 ;;^UTILITY(U,$J,19200.114,12,"WP",0)
"RTN","VEEMI008",116,0)
 ;;=^^5^5^2960117^
"RTN","VEEMI008",117,0)
 ;;^UTILITY(U,$J,19200.114,12,"WP",1,0)
"RTN","VEEMI008",118,0)
 ;;=--> H=Help
"RTN","VEEMI008",119,0)
 ;;^UTILITY(U,$J,19200.114,12,"WP",2,0)
"RTN","VEEMI008",120,0)
 ;;=If the FILE parameter equals a subfile number, the IENS parameter is
"RTN","VEEMI008",121,0)
 ;;^UTILITY(U,$J,19200.114,12,"WP",3,0)
"RTN","VEEMI008",122,0)
 ;;=needed to help identify which subfile. Since this parameter identifies
"RTN","VEEMI008",123,0)
 ;;^UTILITY(U,$J,19200.114,12,"WP",4,0)
"RTN","VEEMI008",124,0)
 ;;=the subfile under that record, and not the subrecord itself, the first
"RTN","VEEMI009")
0^174^B28618790
"RTN","VEEMI009",1,0)
VEEMI009 ; ; 04-JAN-2004
"RTN","VEEMI009",2,0)
 ;;12;VPE SHELL;;JAN 04, 2004;Build 8
"RTN","VEEMI009",3,0)
 Q:'DIFQR(19200.114)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
"RTN","VEEMI009",4,0)
Q Q
"RTN","VEEMI009",5,0)
 ;;^UTILITY(U,$J,19200.114,12,"WP",5,0)
"RTN","VEEMI009",6,0)
 ;;=comma-piece of the parameter should be empty.
"RTN","VEEMI009",7,0)
 ;;^UTILITY(U,$J,19200.114,12,"WP1",0)
"RTN","VEEMI009",8,0)
 ;;=^^15^15^2960117^^
"RTN","VEEMI009",9,0)
 ;;^UTILITY(U,$J,19200.114,12,"WP1",1,0)
"RTN","VEEMI009",10,0)
 ;;=If the FILE parameter equals a file number, the IENS parameter is ignored.
"RTN","VEEMI009",11,0)
 ;;^UTILITY(U,$J,19200.114,12,"WP1",2,0)
"RTN","VEEMI009",12,0)
 ;;=If the FILE parameter equals a subfile number, the IENS is needed to help
"RTN","VEEMI009",13,0)
 ;;^UTILITY(U,$J,19200.114,12,"WP1",3,0)
"RTN","VEEMI009",14,0)
 ;;=identify which subfile to list. In other words, files can be specified
"RTN","VEEMI009",15,0)
 ;;^UTILITY(U,$J,19200.114,12,"WP1",4,0)
"RTN","VEEMI009",16,0)
 ;;=with the FILE parameter alone, but subfiles require both the FILE and IENS
"RTN","VEEMI009",17,0)
 ;;^UTILITY(U,$J,19200.114,12,"WP1",5,0)
"RTN","VEEMI009",18,0)
 ;;=parameters.
"RTN","VEEMI009",19,0)
 ;;^UTILITY(U,$J,19200.114,12,"WP1",6,0)
"RTN","VEEMI009",20,0)
 ;;= 
"RTN","VEEMI009",21,0)
 ;;^UTILITY(U,$J,19200.114,12,"WP1",7,0)
"RTN","VEEMI009",22,0)
 ;;=When the IENS parameter is used, it must equal an IENS that identifies the
"RTN","VEEMI009",23,0)
 ;;^UTILITY(U,$J,19200.114,12,"WP1",8,0)
"RTN","VEEMI009",24,0)
 ;;=parent record of the exact subfile to list. Since this parameter
"RTN","VEEMI009",25,0)
 ;;^UTILITY(U,$J,19200.114,12,"WP1",9,0)
"RTN","VEEMI009",26,0)
 ;;=identifies the subfile under that record, and not the subrecord itself,
"RTN","VEEMI009",27,0)
 ;;^UTILITY(U,$J,19200.114,12,"WP1",10,0)
"RTN","VEEMI009",28,0)
 ;;=the first comma-piece of the parameter should be empty.
"RTN","VEEMI009",29,0)
 ;;^UTILITY(U,$J,19200.114,12,"WP1",11,0)
"RTN","VEEMI009",30,0)
 ;;= 
"RTN","VEEMI009",31,0)
 ;;^UTILITY(U,$J,19200.114,12,"WP1",12,0)
"RTN","VEEMI009",32,0)
 ;;=For example, to specify the Menu Item subfile under option number 67, you
"RTN","VEEMI009",33,0)
 ;;^UTILITY(U,$J,19200.114,12,"WP1",13,0)
"RTN","VEEMI009",34,0)
 ;;=must pass FILE=19.01 (the subfile number for the Menu subfile) and
"RTN","VEEMI009",35,0)
 ;;^UTILITY(U,$J,19200.114,12,"WP1",14,0)
"RTN","VEEMI009",36,0)
 ;;=IENS=",67," (showing that record number 67 holds the Menu subfile you want
"RTN","VEEMI009",37,0)
 ;;^UTILITY(U,$J,19200.114,12,"WP1",15,0)
"RTN","VEEMI009",38,0)
 ;;=to list).
"RTN","VEEMI009",39,0)
 ;;^UTILITY(U,$J,19200.114,13,0)
"RTN","VEEMI009",40,0)
 ;;=FIELDS
"RTN","VEEMI009",41,0)
 ;;^UTILITY(U,$J,19200.114,13,"I")
"RTN","VEEMI009",42,0)
 ;;=FIND^DIC
"RTN","VEEMI009",43,0)
 ;;^UTILITY(U,$J,19200.114,13,"WP",0)
"RTN","VEEMI009",44,0)
 ;;=^^4^4^2960512^
"RTN","VEEMI009",45,0)
 ;;^UTILITY(U,$J,19200.114,13,"WP",1,0)
"RTN","VEEMI009",46,0)
 ;;=The fields to return with each entry found, in addition to the .01
"RTN","VEEMI009",47,0)
 ;;^UTILITY(U,$J,19200.114,13,"WP",2,0)
"RTN","VEEMI009",48,0)
 ;;=field, IEN, and any MUMPS identifiers on the file. It should be set
"RTN","VEEMI009",49,0)
 ;;^UTILITY(U,$J,19200.114,13,"WP",3,0)
"RTN","VEEMI009",50,0)
 ;;=equal to the field numbers separated by ";" characters. Don't include
"RTN","VEEMI009",51,0)
 ;;^UTILITY(U,$J,19200.114,13,"WP",4,0)
"RTN","VEEMI009",52,0)
 ;;=computed, word processing, or multiple fields.
"RTN","VEEMI009",53,0)
 ;;^UTILITY(U,$J,19200.114,14,0)
"RTN","VEEMI009",54,0)
 ;;=VALUE
"RTN","VEEMI009",55,0)
 ;;^UTILITY(U,$J,19200.114,14,"I")
"RTN","VEEMI009",56,0)
 ;;=FIND^DIC
"RTN","VEEMI009",57,0)
 ;;^UTILITY(U,$J,19200.114,14,"WP",0)
"RTN","VEEMI009",58,0)
 ;;=^^2^2^2960117^^^
"RTN","VEEMI009",59,0)
 ;;^UTILITY(U,$J,19200.114,14,"WP",1,0)
"RTN","VEEMI009",60,0)
 ;;=The lookup value. The Finder searches the specified indexes of the file
"RTN","VEEMI009",61,0)
 ;;^UTILITY(U,$J,19200.114,14,"WP",2,0)
"RTN","VEEMI009",62,0)
 ;;=looking for values that match this value.
"RTN","VEEMI009",63,0)
 ;;^UTILITY(U,$J,19200.114,14,"WP1",0)
"RTN","VEEMI009",64,0)
 ;;=^^25^25^2960117^
"RTN","VEEMI009",65,0)
 ;;^UTILITY(U,$J,19200.114,14,"WP1",1,0)
"RTN","VEEMI009",66,0)
 ;;= Certain values generate special behavior by the Finder as follows:
"RTN","VEEMI009",67,0)
 ;;^UTILITY(U,$J,19200.114,14,"WP1",2,0)
"RTN","VEEMI009",68,0)
 ;;= 1. Control characters. Always results in no matches.
"RTN","VEEMI009",69,0)
 ;;^UTILITY(U,$J,19200.114,14,"WP1",3,0)
"RTN","VEEMI009",70,0)
 ;;= 2. ^ (shift 6). Always results in no matches. This signifies to FM
"RTN","VEEMI009",71,0)
 ;;^UTILITY(U,$J,19200.114,14,"WP1",4,0)
"RTN","VEEMI009",72,0)
 ;;=    that the current activity should be stopped.
"RTN","VEEMI009",73,0)
 ;;^UTILITY(U,$J,19200.114,14,"WP1",5,0)
"RTN","VEEMI009",74,0)
 ;;= 3. "" (the empty string). Always results in no matches.
"RTN","VEEMI009",75,0)
 ;;^UTILITY(U,$J,19200.114,14,"WP1",6,0)
"RTN","VEEMI009",76,0)
 ;;= 4. " " (the space character). This value indicates that the Finder
"RTN","VEEMI009",77,0)
 ;;^UTILITY(U,$J,19200.114,14,"WP1",7,0)
"RTN","VEEMI009",78,0)
 ;;=    should return the current user's previous selection from this file.
"RTN","VEEMI009",79,0)
 ;;^UTILITY(U,$J,19200.114,14,"WP1",8,0)
"RTN","VEEMI009",80,0)
 ;;=    If FM has no previous selection then the Finder returns no matches.
"RTN","VEEMI009",81,0)
 ;;^UTILITY(U,$J,19200.114,14,"WP1",9,0)
"RTN","VEEMI009",82,0)
 ;;=    The Finder itself never preserves its found values for this recall;
"RTN","VEEMI009",83,0)
 ;;^UTILITY(U,$J,19200.114,14,"WP1",10,0)
"RTN","VEEMI009",84,0)
 ;;=    applications wishing to preserve found values should call
"RTN","VEEMI009",85,0)
 ;;^UTILITY(U,$J,19200.114,14,"WP1",11,0)
"RTN","VEEMI009",86,0)
 ;;=    RECALL^DILFD.
"RTN","VEEMI009",87,0)
 ;;^UTILITY(U,$J,19200.114,14,"WP1",12,0)
"RTN","VEEMI009",88,0)
 ;;= 5. "`"-Number (accent-grave followed by a number). This indicates that
"RTN","VEEMI009",89,0)
 ;;^UTILITY(U,$J,19200.114,14,"WP1",13,0)
"RTN","VEEMI009",90,0)
 ;;=    the Finder should select the entry whose IEN equals the number
"RTN","VEEMI009",91,0)
 ;;^UTILITY(U,$J,19200.114,14,"WP1",14,0)
"RTN","VEEMI009",92,0)
 ;;=    following the accent-grave. This does not require the A flag.
"RTN","VEEMI009",93,0)
 ;;^UTILITY(U,$J,19200.114,14,"WP1",15,0)
"RTN","VEEMI009",94,0)
 ;;= 6. Numbers. The Finder tries strictly numeric input as an IEN under
"RTN","VEEMI009",95,0)
 ;;^UTILITY(U,$J,19200.114,14,"WP1",16,0)
"RTN","VEEMI009",96,0)
 ;;=    any for the following 3 conditions: 1) The caller uses the A flag,
"RTN","VEEMI009",97,0)
 ;;^UTILITY(U,$J,19200.114,14,"WP1",17,0)
"RTN","VEEMI009",98,0)
 ;;=    2) the file has a .001 field, or 3) the file's .01 field is not
"RTN","VEEMI009",99,0)
 ;;^UTILITY(U,$J,19200.114,14,"WP1",18,0)
"RTN","VEEMI009",100,0)
 ;;=    numeric and the file has no lookup index.
"RTN","VEEMI00A")
0^175^B27961283
"RTN","VEEMI00A",1,0)
VEEMI00A ; ; 04-JAN-2004
"RTN","VEEMI00A",2,0)
 ;;12;VPE SHELL;;JAN 04, 2004;Build 8
"RTN","VEEMI00A",3,0)
 Q:'DIFQR(19200.114)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
"RTN","VEEMI00A",4,0)
Q Q
"RTN","VEEMI00A",5,0)
 ;;^UTILITY(U,$J,19200.114,14,"WP1",19,0)
"RTN","VEEMI00A",6,0)
 ;;=    Strictly numeric input differs from `-numeric input in that if no
"RTN","VEEMI00A",7,0)
 ;;^UTILITY(U,$J,19200.114,14,"WP1",20,0)
"RTN","VEEMI00A",8,0)
 ;;=    record corresponding to this IEN exists or is selectable, the Finder
"RTN","VEEMI00A",9,0)
 ;;^UTILITY(U,$J,19200.114,14,"WP1",21,0)
"RTN","VEEMI00A",10,0)
 ;;=    proceeds with a regular lookup, using the numeric value to find
"RTN","VEEMI00A",11,0)
 ;;^UTILITY(U,$J,19200.114,14,"WP1",22,0)
"RTN","VEEMI00A",12,0)
 ;;=    matches in the file's indexes. Even used this way, however, numeric
"RTN","VEEMI00A",13,0)
 ;;^UTILITY(U,$J,19200.114,14,"WP1",23,0)
"RTN","VEEMI00A",14,0)
 ;;=    input has the following special restrictions: it is not used as a
"RTN","VEEMI00A",15,0)
 ;;^UTILITY(U,$J,19200.114,14,"WP1",24,0)
"RTN","VEEMI00A",16,0)
 ;;=    lookup value in any indexed pointer or variable pointer field (unless
"RTN","VEEMI00A",17,0)
 ;;^UTILITY(U,$J,19200.114,14,"WP1",25,0)
"RTN","VEEMI00A",18,0)
 ;;=    the Q flag is passed).
"RTN","VEEMI00A",19,0)
 ;;^UTILITY(U,$J,19200.114,15,0)
"RTN","VEEMI00A",20,0)
 ;;=FLAGS
"RTN","VEEMI00A",21,0)
 ;;^UTILITY(U,$J,19200.114,15,"I")
"RTN","VEEMI00A",22,0)
 ;;=FIND^DIC
"RTN","VEEMI00A",23,0)
 ;;^UTILITY(U,$J,19200.114,15,"WP",0)
"RTN","VEEMI00A",24,0)
 ;;=^^5^5^2960521^^^
"RTN","VEEMI00A",25,0)
 ;;^UTILITY(U,$J,19200.114,15,"WP",1,0)
"RTN","VEEMI00A",26,0)
 ;;=--> H=Help
"RTN","VEEMI00A",27,0)
 ;;^UTILITY(U,$J,19200.114,15,"WP",2,0)
"RTN","VEEMI00A",28,0)
 ;;=A=Allow pure numeric input to always be tried as an IEN.
"RTN","VEEMI00A",29,0)
 ;;^UTILITY(U,$J,19200.114,15,"WP",3,0)
"RTN","VEEMI00A",30,0)
 ;;=M=Multiple index lookup allowed. Else only search "B" index.
"RTN","VEEMI00A",31,0)
 ;;^UTILITY(U,$J,19200.114,15,"WP",4,0)
"RTN","VEEMI00A",32,0)
 ;;=Q=Quick lookup. Finder assumes passed value is in internal format.
"RTN","VEEMI00A",33,0)
 ;;^UTILITY(U,$J,19200.114,15,"WP",5,0)
"RTN","VEEMI00A",34,0)
 ;;=O=Only find exact matches if possible.   X=Exact matches only.
"RTN","VEEMI00A",35,0)
 ;;^UTILITY(U,$J,19200.114,15,"WP1",0)
"RTN","VEEMI00A",36,0)
 ;;=^^17^17^2960521^^^^
"RTN","VEEMI00A",37,0)
 ;;^UTILITY(U,$J,19200.114,15,"WP1",1,0)
"RTN","VEEMI00A",38,0)
 ;;=A = Allow pure numeric input to always be tried as an IEN. Normally
"RTN","VEEMI00A",39,0)
 ;;^UTILITY(U,$J,19200.114,15,"WP1",2,0)
"RTN","VEEMI00A",40,0)
 ;;=    the Finder will only try pure numbers as IENs if: 1) the file has
"RTN","VEEMI00A",41,0)
 ;;^UTILITY(U,$J,19200.114,15,"WP1",3,0)
"RTN","VEEMI00A",42,0)
 ;;=    a .001 field, -or- 2) its .01 field is not numeric and the file has
"RTN","VEEMI00A",43,0)
 ;;^UTILITY(U,$J,19200.114,15,"WP1",4,0)
"RTN","VEEMI00A",44,0)
 ;;=    no lookup index.
"RTN","VEEMI00A",45,0)
 ;;^UTILITY(U,$J,19200.114,15,"WP1",5,0)
"RTN","VEEMI00A",46,0)
 ;;=M = Multiple index lookup allowed. If this flag is passed, the Finder
"RTN","VEEMI00A",47,0)
 ;;^UTILITY(U,$J,19200.114,15,"WP1",6,0)
"RTN","VEEMI00A",48,0)
 ;;=    searches all of the file's lookup indexes from B on. If FLAGS does
"RTN","VEEMI00A",49,0)
 ;;^UTILITY(U,$J,19200.114,15,"WP1",7,0)
"RTN","VEEMI00A",50,0)
 ;;=    not contain an M, the Finder only searches the B index.
"RTN","VEEMI00A",51,0)
 ;;^UTILITY(U,$J,19200.114,15,"WP1",8,0)
"RTN","VEEMI00A",52,0)
 ;;=O = Only find exact matches if possible. The Finder first searches for
"RTN","VEEMI00A",53,0)
 ;;^UTILITY(U,$J,19200.114,15,"WP1",9,0)
"RTN","VEEMI00A",54,0)
 ;;=    exact matches; if any are found, it returns all exact matches to the
"RTN","VEEMI00A",55,0)
 ;;^UTILITY(U,$J,19200.114,15,"WP1",10,0)
"RTN","VEEMI00A",56,0)
 ;;=    lookup value. Only if it finds none in the file does it search for
"RTN","VEEMI00A",57,0)
 ;;^UTILITY(U,$J,19200.114,15,"WP1",11,0)
"RTN","VEEMI00A",58,0)
 ;;=    partial matches, returning every partial match.
"RTN","VEEMI00A",59,0)
 ;;^UTILITY(U,$J,19200.114,15,"WP1",12,0)
"RTN","VEEMI00A",60,0)
 ;;=Q = Quick lookup. If this flag is passed, the Finder assumes the passed
"RTN","VEEMI00A",61,0)
 ;;^UTILITY(U,$J,19200.114,15,"WP1",13,0)
"RTN","VEEMI00A",62,0)
 ;;=    value is in internal format. The Finder performs NO transforms of
"RTN","VEEMI00A",63,0)
 ;;^UTILITY(U,$J,19200.114,15,"WP1",14,0)
"RTN","VEEMI00A",64,0)
 ;;=    the input value, but only tries to find the value in the specified
"RTN","VEEMI00A",65,0)
 ;;^UTILITY(U,$J,19200.114,15,"WP1",15,0)
"RTN","VEEMI00A",66,0)
 ;;=    lookup indexes. This lookup is much more efficient.
"RTN","VEEMI00A",67,0)
 ;;^UTILITY(U,$J,19200.114,15,"WP1",16,0)
"RTN","VEEMI00A",68,0)
 ;;=X = Exact matches only. The Finder returns every exact match to the
"RTN","VEEMI00A",69,0)
 ;;^UTILITY(U,$J,19200.114,15,"WP1",17,0)
"RTN","VEEMI00A",70,0)
 ;;=    lookup value. Any partial matches present in the file are ignored.
"RTN","VEEMI00A",71,0)
 ;;^UTILITY(U,$J,19200.114,16,0)
"RTN","VEEMI00A",72,0)
 ;;=NUMBER
"RTN","VEEMI00A",73,0)
 ;;^UTILITY(U,$J,19200.114,16,"I")
"RTN","VEEMI00A",74,0)
 ;;=FIND^DIC
"RTN","VEEMI00A",75,0)
 ;;^UTILITY(U,$J,19200.114,16,"WP",0)
"RTN","VEEMI00A",76,0)
 ;;=^^2^2^2960106^
"RTN","VEEMI00A",77,0)
 ;;^UTILITY(U,$J,19200.114,16,"WP",1,0)
"RTN","VEEMI00A",78,0)
 ;;=The maximum number of entries to find. A value of "*" designates all
"RTN","VEEMI00A",79,0)
 ;;^UTILITY(U,$J,19200.114,16,"WP",2,0)
"RTN","VEEMI00A",80,0)
 ;;=entries (the default).
"RTN","VEEMI00A",81,0)
 ;;^UTILITY(U,$J,19200.114,17,0)
"RTN","VEEMI00A",82,0)
 ;;=INDEXES
"RTN","VEEMI00A",83,0)
 ;;^UTILITY(U,$J,19200.114,17,"I")
"RTN","VEEMI00A",84,0)
 ;;=FIND^DIC
"RTN","VEEMI00A",85,0)
 ;;^UTILITY(U,$J,19200.114,17,"WP",0)
"RTN","VEEMI00A",86,0)
 ;;=^^2^2^2960106^
"RTN","VEEMI00A",87,0)
 ;;^UTILITY(U,$J,19200.114,17,"WP",1,0)
"RTN","VEEMI00A",88,0)
 ;;=The indexes the Finder should search for matches. A list of index
"RTN","VEEMI00A",89,0)
 ;;^UTILITY(U,$J,19200.114,17,"WP",2,0)
"RTN","VEEMI00A",90,0)
 ;;=names separated by "^" characters.
"RTN","VEEMI00A",91,0)
 ;;^UTILITY(U,$J,19200.114,18,0)
"RTN","VEEMI00A",92,0)
 ;;=SCREEN
"RTN","VEEMI00A",93,0)
 ;;^UTILITY(U,$J,19200.114,18,"WP",0)
"RTN","VEEMI00A",94,0)
 ;;=^^3^3^2960117^
"RTN","VEEMI00A",95,0)
 ;;^UTILITY(U,$J,19200.114,18,"WP",1,0)
"RTN","VEEMI00A",96,0)
 ;;=A string of MUMPS code that sets $T to 1 if record should be selected.
"RTN","VEEMI00A",97,0)
 ;;^UTILITY(U,$J,19200.114,18,"WP",2,0)
"RTN","VEEMI00A",98,0)
 ;;=   Naked indicator is set to record's 0-node
"RTN","VEEMI00A",99,0)
 ;;^UTILITY(U,$J,19200.114,18,"WP",3,0)
"RTN","VEEMI00A",100,0)
 ;;=   Y=IEN, Y1=IENS, and Y array=The DA array for this entry.
"RTN","VEEMI00A",101,0)
 ;;^UTILITY(U,$J,19200.114,19,0)
"RTN","VEEMI00A",102,0)
 ;;=IDENTIFIER
"RTN","VEEMI00A",103,0)
 ;;^UTILITY(U,$J,19200.114,19,"WP",0)
"RTN","VEEMI00A",104,0)
 ;;=^^5^5^2960117^
"RTN","VEEMI00A",105,0)
 ;;^UTILITY(U,$J,19200.114,19,"WP",1,0)
"RTN","VEEMI00A",106,0)
 ;;=Text to accompany each found entry to help identify it to end user. This
"RTN","VEEMI00B")
0^176^B28017477
"RTN","VEEMI00B",1,0)
VEEMI00B ; ; 04-JAN-2004
"RTN","VEEMI00B",2,0)
 ;;12;VPE SHELL;;JAN 04, 2004;Build 8
"RTN","VEEMI00B",3,0)
 Q:'DIFQR(19200.114)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
"RTN","VEEMI00B",4,0)
Q Q
"RTN","VEEMI00B",5,0)
 ;;^UTILITY(U,$J,19200.114,19,"WP",2,0)
"RTN","VEEMI00B",6,0)
 ;;=should be set to MUMPS code that calls the EN^DDIOL utility to load
"RTN","VEEMI00B",7,0)
 ;;^UTILITY(U,$J,19200.114,19,"WP",3,0)
"RTN","VEEMI00B",8,0)
 ;;=identification text. This code relies upon the same input as the SCREEN
"RTN","VEEMI00B",9,0)
 ;;^UTILITY(U,$J,19200.114,19,"WP",4,0)
"RTN","VEEMI00B",10,0)
 ;;=(Y, Y1, and naked indicator). Returns string with each entry returned as
"RTN","VEEMI00B",11,0)
 ;;^UTILITY(U,$J,19200.114,19,"WP",5,0)
"RTN","VEEMI00B",12,0)
 ;;=a separate node under the "ID","WRITE" nodes of the output array.
"RTN","VEEMI00B",13,0)
 ;;^UTILITY(U,$J,19200.114,20,0)
"RTN","VEEMI00B",14,0)
 ;;=TARGET_ROOT
"RTN","VEEMI00B",15,0)
 ;;^UTILITY(U,$J,19200.114,20,"WP",0)
"RTN","VEEMI00B",16,0)
 ;;=^^4^4^2960614^^
"RTN","VEEMI00B",17,0)
 ;;^UTILITY(U,$J,19200.114,20,"WP",1,0)
"RTN","VEEMI00B",18,0)
 ;;=The array that should receive the output list of found entries. This
"RTN","VEEMI00B",19,0)
 ;;^UTILITY(U,$J,19200.114,20,"WP",2,0)
"RTN","VEEMI00B",20,0)
 ;;=must be a closed array reference and can be either local or global.
"RTN","VEEMI00B",21,0)
 ;;^UTILITY(U,$J,19200.114,20,"WP",3,0)
"RTN","VEEMI00B",22,0)
 ;;=If TARGET_ROOT is not passed, the list is returned descendent from
"RTN","VEEMI00B",23,0)
 ;;^UTILITY(U,$J,19200.114,20,"WP",4,0)
"RTN","VEEMI00B",24,0)
 ;;=^TMP("DILIST",$J).
"RTN","VEEMI00B",25,0)
 ;;^UTILITY(U,$J,19200.114,21,0)
"RTN","VEEMI00B",26,0)
 ;;=MSG_ROOT
"RTN","VEEMI00B",27,0)
 ;;^UTILITY(U,$J,19200.114,21,"WP",0)
"RTN","VEEMI00B",28,0)
 ;;=^^3^3^2960106^
"RTN","VEEMI00B",29,0)
 ;;^UTILITY(U,$J,19200.114,21,"WP",1,0)
"RTN","VEEMI00B",30,0)
 ;;=The array that should receive any error messages. Example: If
"RTN","VEEMI00B",31,0)
 ;;^UTILITY(U,$J,19200.114,21,"WP",2,0)
"RTN","VEEMI00B",32,0)
 ;;=MSG_ROOT="OUT(42)", any errors generated appear in OUT(42,"DIERR").
"RTN","VEEMI00B",33,0)
 ;;^UTILITY(U,$J,19200.114,21,"WP",3,0)
"RTN","VEEMI00B",34,0)
 ;;=Otherwise, errors are returned descendent from ^TMP("DIERR",$J).
"RTN","VEEMI00B",35,0)
 ;;^UTILITY(U,$J,19200.114,22,0)
"RTN","VEEMI00B",36,0)
 ;;=DA
"RTN","VEEMI00B",37,0)
 ;;^UTILITY(U,$J,19200.114,22,"WP",0)
"RTN","VEEMI00B",38,0)
 ;;=^^1^1^2960115^^
"RTN","VEEMI00B",39,0)
 ;;^UTILITY(U,$J,19200.114,22,"WP",1,0)
"RTN","VEEMI00B",40,0)
 ;;=The file entry's internal entry number.
"RTN","VEEMI00B",41,0)
 ;;^UTILITY(U,$J,19200.114,23,0)
"RTN","VEEMI00B",42,0)
 ;;=DA(1)
"RTN","VEEMI00B",43,0)
 ;;^UTILITY(U,$J,19200.114,23,"I")
"RTN","VEEMI00B",44,0)
 ;;=DIK
"RTN","VEEMI00B",45,0)
 ;;^UTILITY(U,$J,19200.114,23,"WP",0)
"RTN","VEEMI00B",46,0)
 ;;=^^2^2^2960115^^^^
"RTN","VEEMI00B",47,0)
 ;;^UTILITY(U,$J,19200.114,23,"WP",1,0)
"RTN","VEEMI00B",48,0)
 ;;=Needed when deleting at lower levels.
"RTN","VEEMI00B",49,0)
 ;;^UTILITY(U,$J,19200.114,23,"WP",2,0)
"RTN","VEEMI00B",50,0)
 ;;=Ex: S DA(1)=1,DA=2,DIK="^EMP("_DA(1)_",""SX"","
"RTN","VEEMI00B",51,0)
 ;;^UTILITY(U,$J,19200.114,24,0)
"RTN","VEEMI00B",52,0)
 ;;=DIK
"RTN","VEEMI00B",53,0)
 ;;^UTILITY(U,$J,19200.114,24,"WP",0)
"RTN","VEEMI00B",54,0)
 ;;=^^1^1^2960107^
"RTN","VEEMI00B",55,0)
 ;;^UTILITY(U,$J,19200.114,24,"WP",1,0)
"RTN","VEEMI00B",56,0)
 ;;=Global root.
"RTN","VEEMI00B",57,0)
 ;;^UTILITY(U,$J,19200.114,25,0)
"RTN","VEEMI00B",58,0)
 ;;=DIE
"RTN","VEEMI00B",59,0)
 ;;^UTILITY(U,$J,19200.114,25,"WP",0)
"RTN","VEEMI00B",60,0)
 ;;=^^1^1^2960115^
"RTN","VEEMI00B",61,0)
 ;;^UTILITY(U,$J,19200.114,25,"WP",1,0)
"RTN","VEEMI00B",62,0)
 ;;=File number or global root.
"RTN","VEEMI00B",63,0)
 ;;^UTILITY(U,$J,19200.114,26,0)
"RTN","VEEMI00B",64,0)
 ;;=DIDEL
"RTN","VEEMI00B",65,0)
 ;;^UTILITY(U,$J,19200.114,26,"WP",0)
"RTN","VEEMI00B",66,0)
 ;;=^^1^1^2960115^^
"RTN","VEEMI00B",67,0)
 ;;^UTILITY(U,$J,19200.114,26,"WP",1,0)
"RTN","VEEMI00B",68,0)
 ;;=Override delete access (Set DIDEL=FileNumber).
"RTN","VEEMI00B",69,0)
 ;;^UTILITY(U,$J,19200.114,27,0)
"RTN","VEEMI00B",70,0)
 ;;=Y
"RTN","VEEMI00B",71,0)
 ;;^UTILITY(U,$J,19200.114,27,"I")
"RTN","VEEMI00B",72,0)
 ;;=Y^DIQ
"RTN","VEEMI00B",73,0)
 ;;^UTILITY(U,$J,19200.114,27,"WP",0)
"RTN","VEEMI00B",74,0)
 ;;=^^1^1^2960108^
"RTN","VEEMI00B",75,0)
 ;;^UTILITY(U,$J,19200.114,27,"WP",1,0)
"RTN","VEEMI00B",76,0)
 ;;=The internal form of the value being converted.
"RTN","VEEMI00B",77,0)
 ;;^UTILITY(U,$J,19200.114,28,0)
"RTN","VEEMI00B",78,0)
 ;;=C
"RTN","VEEMI00B",79,0)
 ;;^UTILITY(U,$J,19200.114,28,"D")
"RTN","VEEMI00B",80,0)
 ;;=$P(^DD(?,?,0),U,2)
"RTN","VEEMI00B",81,0)
 ;;^UTILITY(U,$J,19200.114,28,"I")
"RTN","VEEMI00B",82,0)
 ;;=Y^DIQ
"RTN","VEEMI00B",83,0)
 ;;^UTILITY(U,$J,19200.114,28,"WP",0)
"RTN","VEEMI00B",84,0)
 ;;=^^3^3^2960108^^
"RTN","VEEMI00B",85,0)
 ;;^UTILITY(U,$J,19200.114,28,"WP",1,0)
"RTN","VEEMI00B",86,0)
 ;;=The 2nd piece of the zero node of the data dictionary which defines
"RTN","VEEMI00B",87,0)
 ;;^UTILITY(U,$J,19200.114,28,"WP",2,0)
"RTN","VEEMI00B",88,0)
 ;;=that element. To correctly set the naked global reference do:
"RTN","VEEMI00B",89,0)
 ;;^UTILITY(U,$J,19200.114,28,"WP",3,0)
"RTN","VEEMI00B",90,0)
 ;;=      S C=$P(^DD(File#,Field#,0),U,2)
"RTN","VEEMI00B",91,0)
 ;;^UTILITY(U,$J,19200.114,29,0)
"RTN","VEEMI00B",92,0)
 ;;=DIC
"RTN","VEEMI00B",93,0)
 ;;^UTILITY(U,$J,19200.114,29,"WP",0)
"RTN","VEEMI00B",94,0)
 ;;=^^1^1^2960114^^^
"RTN","VEEMI00B",95,0)
 ;;^UTILITY(U,$J,19200.114,29,"WP",1,0)
"RTN","VEEMI00B",96,0)
 ;;=The global root or file number.
"RTN","VEEMI00B",97,0)
 ;;^UTILITY(U,$J,19200.114,30,0)
"RTN","VEEMI00B",98,0)
 ;;=DR
"RTN","VEEMI00B",99,0)
 ;;^UTILITY(U,$J,19200.114,30,"I")
"RTN","VEEMI00B",100,0)
 ;;=DIQ
"RTN","VEEMI00B",101,0)
 ;;^UTILITY(U,$J,19200.114,30,"WP",0)
"RTN","VEEMI00B",102,0)
 ;;=^^4^4^2960115^^
"RTN","VEEMI00B",103,0)
 ;;^UTILITY(U,$J,19200.114,30,"WP",1,0)
"RTN","VEEMI00B",104,0)
 ;;=Names the global subscript(s) which are to be displayed. Enter ":" for
"RTN","VEEMI00B",105,0)
 ;;^UTILITY(U,$J,19200.114,30,"WP",2,0)
"RTN","VEEMI00B",106,0)
 ;;=a range of subscripts. All data fields stored within, and descendent from,
"RTN","VEEMI00B",107,0)
 ;;^UTILITY(U,$J,19200.114,30,"WP",3,0)
"RTN","VEEMI00B",108,0)
 ;;=the subscript(s) will be displayed. If DR is not defined, all fields are
"RTN","VEEMI00B",109,0)
 ;;^UTILITY(U,$J,19200.114,30,"WP",4,0)
"RTN","VEEMI00B",110,0)
 ;;=displayed.
"RTN","VEEMI00B",111,0)
 ;;^UTILITY(U,$J,19200.114,31,0)
"RTN","VEEMI00B",112,0)
 ;;=DIQ(0)
"RTN","VEEMI00B",113,0)
 ;;^UTILITY(U,$J,19200.114,31,"WP",0)
"RTN","VEEMI00B",114,0)
 ;;=^^3^3^2960108^
"RTN","VEEMI00B",115,0)
 ;;^UTILITY(U,$J,19200.114,31,"WP",1,0)
"RTN","VEEMI00B",116,0)
 ;;=C=Display computed fields
"RTN","VEEMI00B",117,0)
 ;;^UTILITY(U,$J,19200.114,31,"WP",2,0)
"RTN","VEEMI00B",118,0)
 ;;=A=Display audit records for the entry
"RTN","VEEMI00B",119,0)
 ;;^UTILITY(U,$J,19200.114,31,"WP",3,0)
"RTN","VEEMI00B",120,0)
 ;;=R=Display entry's IEN.
"RTN","VEEMI00B",121,0)
 ;;^UTILITY(U,$J,19200.114,32,0)
"RTN","VEEMI00B",122,0)
 ;;=VALUE
"RTN","VEEMI00B",123,0)
 ;;^UTILITY(U,$J,19200.114,32,"I")
"RTN","VEEMI00B",124,0)
 ;;=EN^DDIOL
"RTN","VEEMI00B",125,0)
 ;;^UTILITY(U,$J,19200.114,32,"WP",0)
"RTN","VEEMI00B",126,0)
 ;;=^^3^3^2960108^
"RTN","VEEMI00B",127,0)
 ;;^UTILITY(U,$J,19200.114,32,"WP",1,0)
"RTN","VEEMI00B",128,0)
 ;;=If just 1 line of text place here. It can be a string, numeric literal,
"RTN","VEEMI00B",129,0)
 ;;^UTILITY(U,$J,19200.114,32,"WP",2,0)
"RTN","VEEMI00B",130,0)
 ;;=or variable. If more than 1 line of text, enter .ARRAY, where text is
"RTN","VEEMI00C")
0^177^B28508700
"RTN","VEEMI00C",1,0)
VEEMI00C ; ; 04-JAN-2004
"RTN","VEEMI00C",2,0)
 ;;12;VPE SHELL;;JAN 04, 2004;Build 8
"RTN","VEEMI00C",3,0)
 Q:'DIFQR(19200.114)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
"RTN","VEEMI00C",4,0)
Q Q
"RTN","VEEMI00C",5,0)
 ;;^UTILITY(U,$J,19200.114,32,"WP",3,0)
"RTN","VEEMI00C",6,0)
 ;;=stored in ARRAY(1),ARRAY(2), etc.
"RTN","VEEMI00C",7,0)
 ;;^UTILITY(U,$J,19200.114,33,0)
"RTN","VEEMI00C",8,0)
 ;;=GLOBAL ROOT
"RTN","VEEMI00C",9,0)
 ;;^UTILITY(U,$J,19200.114,33,"WP",0)
"RTN","VEEMI00C",10,0)
 ;;=^^5^5^2960108^
"RTN","VEEMI00C",11,0)
 ;;^UTILITY(U,$J,19200.114,33,"WP",1,0)
"RTN","VEEMI00C",12,0)
 ;;=An alternate way to pass text is in a global root. The VALUE parameter is
"RTN","VEEMI00C",13,0)
 ;;^UTILITY(U,$J,19200.114,33,"WP",2,0)
"RTN","VEEMI00C",14,0)
 ;;=null and GLOBAL ROOT contains the name of the global root that contains
"RTN","VEEMI00C",15,0)
 ;;^UTILITY(U,$J,19200.114,33,"WP",3,0)
"RTN","VEEMI00C",16,0)
 ;;=the text. Example: ^GLB(1)=Text,^GLB(2)=Text GLOBAL ROOT="^GLB"
"RTN","VEEMI00C",17,0)
 ;;^UTILITY(U,$J,19200.114,33,"WP",4,0)
"RTN","VEEMI00C",18,0)
 ;;=Put formatting instructions in "F" nodes descendent from the node
"RTN","VEEMI00C",19,0)
 ;;^UTILITY(U,$J,19200.114,33,"WP",5,0)
"RTN","VEEMI00C",20,0)
 ;;=containing text. Example: A(1)="Text", A(1,"F")="!?5"
"RTN","VEEMI00C",21,0)
 ;;^UTILITY(U,$J,19200.114,34,0)
"RTN","VEEMI00C",22,0)
 ;;=FORMAT
"RTN","VEEMI00C",23,0)
 ;;^UTILITY(U,$J,19200.114,34,"WP",0)
"RTN","VEEMI00C",24,0)
 ;;=^^2^2^2960108^
"RTN","VEEMI00C",25,0)
 ;;^UTILITY(U,$J,19200.114,34,"WP",1,0)
"RTN","VEEMI00C",26,0)
 ;;=Formatting instructions. Only use when VALUE parameter is used.
"RTN","VEEMI00C",27,0)
 ;;^UTILITY(U,$J,19200.114,34,"WP",2,0)
"RTN","VEEMI00C",28,0)
 ;;=Example: FORMAT="!!!?4"
"RTN","VEEMI00C",29,0)
 ;;^UTILITY(U,$J,19200.114,35,0)
"RTN","VEEMI00C",30,0)
 ;;=DIFILE
"RTN","VEEMI00C",31,0)
 ;;^UTILITY(U,$J,19200.114,35,"WP",0)
"RTN","VEEMI00C",32,0)
 ;;=^^1^1^2960108^
"RTN","VEEMI00C",33,0)
 ;;^UTILITY(U,$J,19200.114,35,"WP",1,0)
"RTN","VEEMI00C",34,0)
 ;;=The file number.
"RTN","VEEMI00C",35,0)
 ;;^UTILITY(U,$J,19200.114,36,0)
"RTN","VEEMI00C",36,0)
 ;;=DIAC
"RTN","VEEMI00C",37,0)
 ;;^UTILITY(U,$J,19200.114,36,"WP",0)
"RTN","VEEMI00C",38,0)
 ;;=^^4^4^2960115^^^
"RTN","VEEMI00C",39,0)
 ;;^UTILITY(U,$J,19200.114,36,"WP",1,0)
"RTN","VEEMI00C",40,0)
 ;;=Use one of the values listed below. Returns DIAC=0 or 1
"RTN","VEEMI00C",41,0)
 ;;^UTILITY(U,$J,19200.114,36,"WP",2,0)
"RTN","VEEMI00C",42,0)
 ;;=                  "RD"=Read         "WR"=Write
"RTN","VEEMI00C",43,0)
 ;;^UTILITY(U,$J,19200.114,36,"WP",3,0)
"RTN","VEEMI00C",44,0)
 ;;=               "AUDIT"=Audit        "DD"=Data Dictionary  
"RTN","VEEMI00C",45,0)
 ;;^UTILITY(U,$J,19200.114,36,"WP",4,0)
"RTN","VEEMI00C",46,0)
 ;;=                 "DEL"=Delete    "LAYGO"=Laygo
"RTN","VEEMI00C",47,0)
 ;;^UTILITY(U,$J,19200.114,37,0)
"RTN","VEEMI00C",48,0)
 ;;=DIC(0)
"RTN","VEEMI00C",49,0)
 ;;^UTILITY(U,$J,19200.114,37,"I")
"RTN","VEEMI00C",50,0)
 ;;=DIC
"RTN","VEEMI00C",51,0)
 ;;^UTILITY(U,$J,19200.114,37,"WP",0)
"RTN","VEEMI00C",52,0)
 ;;=^^2^2^2960115^
"RTN","VEEMI00C",53,0)
 ;;^UTILITY(U,$J,19200.114,37,"WP",1,0)
"RTN","VEEMI00C",54,0)
 ;;=--> H=HELP
"RTN","VEEMI00C",55,0)
 ;;^UTILITY(U,$J,19200.114,37,"WP",2,0)
"RTN","VEEMI00C",56,0)
 ;;=A string of alpha characters which alter how the program responds.
"RTN","VEEMI00C",57,0)
 ;;^UTILITY(U,$J,19200.114,37,"WP1",0)
"RTN","VEEMI00C",58,0)
 ;;=^^43^43^2960115^^^^
"RTN","VEEMI00C",59,0)
 ;;^UTILITY(U,$J,19200.114,37,"WP1",1,0)
"RTN","VEEMI00C",60,0)
 ;;=A = Ask the entry
"RTN","VEEMI00C",61,0)
 ;;^UTILITY(U,$J,19200.114,37,"WP1",2,0)
"RTN","VEEMI00C",62,0)
 ;;=    If DIC(0) does not contain A, the input to DIC is assumed to be in
"RTN","VEEMI00C",63,0)
 ;;^UTILITY(U,$J,19200.114,37,"WP1",3,0)
"RTN","VEEMI00C",64,0)
 ;;=    the variable X.
"RTN","VEEMI00C",65,0)
 ;;^UTILITY(U,$J,19200.114,37,"WP1",4,0)
"RTN","VEEMI00C",66,0)
 ;;=C = Xref suppression
"RTN","VEEMI00C",67,0)
 ;;^UTILITY(U,$J,19200.114,37,"WP1",5,0)
"RTN","VEEMI00C",68,0)
 ;;=    When DIC does a lookup and finds an entry that matches the input,
"RTN","VEEMI00C",69,0)
 ;;^UTILITY(U,$J,19200.114,37,"WP1",6,0)
"RTN","VEEMI00C",70,0)
 ;;=    that entry is presented to the user only once even if the entry
"RTN","VEEMI00C",71,0)
 ;;^UTILITY(U,$J,19200.114,37,"WP1",7,0)
"RTN","VEEMI00C",72,0)
 ;;=    appears in more than one cross reference. This is called cross
"RTN","VEEMI00C",73,0)
 ;;^UTILITY(U,$J,19200.114,37,"WP1",8,0)
"RTN","VEEMI00C",74,0)
 ;;=    reference suppression. It can be overridden by including a C in
"RTN","VEEMI00C",75,0)
 ;;^UTILITY(U,$J,19200.114,37,"WP1",9,0)
"RTN","VEEMI00C",76,0)
 ;;=    DIC(0).
"RTN","VEEMI00C",77,0)
 ;;^UTILITY(U,$J,19200.114,37,"WP1",10,0)
"RTN","VEEMI00C",78,0)
 ;;=E = Echo back information
"RTN","VEEMI00C",79,0)
 ;;^UTILITY(U,$J,19200.114,37,"WP1",11,0)
"RTN","VEEMI00C",80,0)
 ;;=    The file entry names that match the input will be echoed back to the
"RTN","VEEMI00C",81,0)
 ;;^UTILITY(U,$J,19200.114,37,"WP1",12,0)
"RTN","VEEMI00C",82,0)
 ;;=    terminal.
"RTN","VEEMI00C",83,0)
 ;;^UTILITY(U,$J,19200.114,37,"WP1",13,0)
"RTN","VEEMI00C",84,0)
 ;;=F = Forget lookup value.
"RTN","VEEMI00C",85,0)
 ;;^UTILITY(U,$J,19200.114,37,"WP1",14,0)
"RTN","VEEMI00C",86,0)
 ;;=    If an entry is found, the entry number gets saved in the ^DISV global.
"RTN","VEEMI00C",87,0)
 ;;^UTILITY(U,$J,19200.114,37,"WP1",15,0)
"RTN","VEEMI00C",88,0)
 ;;=    ^DISV(DUZ,DIC) is set equal to the entry number. This allows the user
"RTN","VEEMI00C",89,0)
 ;;^UTILITY(U,$J,19200.114,37,"WP1",16,0)
"RTN","VEEMI00C",90,0)
 ;;=    to do a subsequent lookup of the same entry by pressing <SPACE BAR>,
"RTN","VEEMI00C",91,0)
 ;;^UTILITY(U,$J,19200.114,37,"WP1",17,0)
"RTN","VEEMI00C",92,0)
 ;;=    <RET>. To suppress this, include F in DIC(0).
"RTN","VEEMI00C",93,0)
 ;;^UTILITY(U,$J,19200.114,37,"WP1",18,0)
"RTN","VEEMI00C",94,0)
 ;;=I = Ignore special lookup program
"RTN","VEEMI00C",95,0)
 ;;^UTILITY(U,$J,19200.114,37,"WP1",19,0)
"RTN","VEEMI00C",96,0)
 ;;=    Any special user written lookup program will be ignored and DIC will
"RTN","VEEMI00C",97,0)
 ;;^UTILITY(U,$J,19200.114,37,"WP1",20,0)
"RTN","VEEMI00C",98,0)
 ;;=    proceed with its normal lookup process.
"RTN","VEEMI00C",99,0)
 ;;^UTILITY(U,$J,19200.114,37,"WP1",21,0)
"RTN","VEEMI00C",100,0)
 ;;=L = LAYGO allowed
"RTN","VEEMI00C",101,0)
 ;;^UTILITY(U,$J,19200.114,37,"WP1",22,0)
"RTN","VEEMI00C",102,0)
 ;;=    Allow user to add a new entry to the file.
"RTN","VEEMI00C",103,0)
 ;;^UTILITY(U,$J,19200.114,37,"WP1",23,0)
"RTN","VEEMI00C",104,0)
 ;;=M = Multiple-index lookup allowed
"RTN","VEEMI00C",105,0)
 ;;^UTILITY(U,$J,19200.114,37,"WP1",24,0)
"RTN","VEEMI00C",106,0)
 ;;=N = IEN lookup allowed
"RTN","VEEMI00C",107,0)
 ;;^UTILITY(U,$J,19200.114,37,"WP1",25,0)
"RTN","VEEMI00C",108,0)
 ;;=O = Only find 1 entry if it matches exactly
"RTN","VEEMI00C",109,0)
 ;;^UTILITY(U,$J,19200.114,37,"WP1",26,0)
"RTN","VEEMI00C",110,0)
 ;;=    If there is an exact match for the lookup value, only the entry that
"RTN","VEEMI00C",111,0)
 ;;^UTILITY(U,$J,19200.114,37,"WP1",27,0)
"RTN","VEEMI00C",112,0)
 ;;=    matches exactly will be selected.
"RTN","VEEMI00C",113,0)
 ;;^UTILITY(U,$J,19200.114,37,"WP1",28,0)
"RTN","VEEMI00C",114,0)
 ;;=Q = Question erroneous input
"RTN","VEEMI00D")
0^178^B27415503
"RTN","VEEMI00D",1,0)
VEEMI00D ; ; 04-JAN-2004
"RTN","VEEMI00D",2,0)
 ;;12;VPE SHELL;;JAN 04, 2004;Build 8
"RTN","VEEMI00D",3,0)
 Q:'DIFQR(19200.114)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
"RTN","VEEMI00D",4,0)
Q Q
"RTN","VEEMI00D",5,0)
 ;;^UTILITY(U,$J,19200.114,37,"WP1",29,0)
"RTN","VEEMI00D",6,0)
 ;;=    If erroneous input is entered, 2 question marks will be displayed and
"RTN","VEEMI00D",7,0)
 ;;^UTILITY(U,$J,19200.114,37,"WP1",30,0)
"RTN","VEEMI00D",8,0)
 ;;=    a beep will sound.
"RTN","VEEMI00D",9,0)
 ;;^UTILITY(U,$J,19200.114,37,"WP1",31,0)
"RTN","VEEMI00D",10,0)
 ;;=S = Suppress display of .01 (except B xref match)
"RTN","VEEMI00D",11,0)
 ;;^UTILITY(U,$J,19200.114,37,"WP1",32,0)
"RTN","VEEMI00D",12,0)
 ;;=    If DIC(0) does not contain S, the value of the .01 field will be
"RTN","VEEMI00D",13,0)
 ;;^UTILITY(U,$J,19200.114,37,"WP1",33,0)
"RTN","VEEMI00D",14,0)
 ;;=    displayed for all matches found in any xref. If it does contain S, the
"RTN","VEEMI00D",15,0)
 ;;^UTILITY(U,$J,19200.114,37,"WP1",34,0)
"RTN","VEEMI00D",16,0)
 ;;=    .01 field won't be displayed unless the match was found in the B xref.
"RTN","VEEMI00D",17,0)
 ;;^UTILITY(U,$J,19200.114,37,"WP1",35,0)
"RTN","VEEMI00D",18,0)
 ;;=X = Exact match required
"RTN","VEEMI00D",19,0)
 ;;^UTILITY(U,$J,19200.114,37,"WP1",36,0)
"RTN","VEEMI00D",20,0)
 ;;=    The input value must be found exactly as it was entered. Otherwise,
"RTN","VEEMI00D",21,0)
 ;;^UTILITY(U,$J,19200.114,37,"WP1",37,0)
"RTN","VEEMI00D",22,0)
 ;;=    the routine will look for any entries that begin with the input X.
"RTN","VEEMI00D",23,0)
 ;;^UTILITY(U,$J,19200.114,37,"WP1",38,0)
"RTN","VEEMI00D",24,0)
 ;;=Z = Zero node returned in Y(0) and external form in Y(0,0)
"RTN","VEEMI00D",25,0)
 ;;^UTILITY(U,$J,19200.114,37,"WP1",39,0)
"RTN","VEEMI00D",26,0)
 ;;=    If lookup was successful, then variable Y(0) will be returned equal to
"RTN","VEEMI00D",27,0)
 ;;^UTILITY(U,$J,19200.114,37,"WP1",40,0)
"RTN","VEEMI00D",28,0)
 ;;=    the entire zero node of the entry. Y(0,0) is also returned and will be
"RTN","VEEMI00D",29,0)
 ;;^UTILITY(U,$J,19200.114,37,"WP1",41,0)
"RTN","VEEMI00D",30,0)
 ;;=    equal to the printable expression of the .01 field. This means that
"RTN","VEEMI00D",31,0)
 ;;^UTILITY(U,$J,19200.114,37,"WP1",42,0)
"RTN","VEEMI00D",32,0)
 ;;=    for Date/Time, Set of Codes, and Pointer data types, Y(0,0) will
"RTN","VEEMI00D",33,0)
 ;;^UTILITY(U,$J,19200.114,37,"WP1",43,0)
"RTN","VEEMI00D",34,0)
 ;;=    contain the external format.
"RTN","VEEMI00D",35,0)
 ;;^UTILITY(U,$J,19200.114,38,0)
"RTN","VEEMI00D",36,0)
 ;;=DIC('A')
"RTN","VEEMI00D",37,0)
 ;;^UTILITY(U,$J,19200.114,38,"WP",0)
"RTN","VEEMI00D",38,0)
 ;;=^^1^1^2960113^
"RTN","VEEMI00D",39,0)
 ;;^UTILITY(U,$J,19200.114,38,"WP",1,0)
"RTN","VEEMI00D",40,0)
 ;;=Default prompt.
"RTN","VEEMI00D",41,0)
 ;;^UTILITY(U,$J,19200.114,39,0)
"RTN","VEEMI00D",42,0)
 ;;=DIC('B')
"RTN","VEEMI00D",43,0)
 ;;^UTILITY(U,$J,19200.114,39,"WP",0)
"RTN","VEEMI00D",44,0)
 ;;=^^1^1^2960113^
"RTN","VEEMI00D",45,0)
 ;;^UTILITY(U,$J,19200.114,39,"WP",1,0)
"RTN","VEEMI00D",46,0)
 ;;=Default answer.
"RTN","VEEMI00D",47,0)
 ;;^UTILITY(U,$J,19200.114,40,0)
"RTN","VEEMI00D",48,0)
 ;;=DIC('S')
"RTN","VEEMI00D",49,0)
 ;;^UTILITY(U,$J,19200.114,40,"WP",0)
"RTN","VEEMI00D",50,0)
 ;;=^^4^4^2960113^
"RTN","VEEMI00D",51,0)
 ;;^UTILITY(U,$J,19200.114,40,"WP",1,0)
"RTN","VEEMI00D",52,0)
 ;;=String of MUMPS code that DIC will use to screen an entry from
"RTN","VEEMI00D",53,0)
 ;;^UTILITY(U,$J,19200.114,40,"WP",2,0)
"RTN","VEEMI00D",54,0)
 ;;=selection. If $T=1 entry will be displayed. When DIC("S") is
"RTN","VEEMI00D",55,0)
 ;;^UTILITY(U,$J,19200.114,40,"WP",3,0)
"RTN","VEEMI00D",56,0)
 ;;=executed, Y=IEN and naked indicator is at the global level
"RTN","VEEMI00D",57,0)
 ;;^UTILITY(U,$J,19200.114,40,"WP",4,0)
"RTN","VEEMI00D",58,0)
 ;;=@(DIC_"Y,0)").
"RTN","VEEMI00D",59,0)
 ;;^UTILITY(U,$J,19200.114,41,0)
"RTN","VEEMI00D",60,0)
 ;;=DIC('W')
"RTN","VEEMI00D",61,0)
 ;;^UTILITY(U,$J,19200.114,41,"WP",0)
"RTN","VEEMI00D",62,0)
 ;;=^^4^4^2960113^
"RTN","VEEMI00D",63,0)
 ;;^UTILITY(U,$J,19200.114,41,"WP",1,0)
"RTN","VEEMI00D",64,0)
 ;;=A MUMPS string that will be executed when DIC displays each entry
"RTN","VEEMI00D",65,0)
 ;;^UTILITY(U,$J,19200.114,41,"WP",2,0)
"RTN","VEEMI00D",66,0)
 ;;=that matches user input. Y and naked indicator are the same as for
"RTN","VEEMI00D",67,0)
 ;;^UTILITY(U,$J,19200.114,41,"WP",3,0)
"RTN","VEEMI00D",68,0)
 ;;=DIC("S"). DIC("W") overrides identifiers. So, DIC("W")="" will
"RTN","VEEMI00D",69,0)
 ;;^UTILITY(U,$J,19200.114,41,"WP",4,0)
"RTN","VEEMI00D",70,0)
 ;;=suppress the display of identifiers.
"RTN","VEEMI00D",71,0)
 ;;^UTILITY(U,$J,19200.114,42,0)
"RTN","VEEMI00D",72,0)
 ;;=DIC('DR')
"RTN","VEEMI00D",73,0)
 ;;^UTILITY(U,$J,19200.114,42,"WP",0)
"RTN","VEEMI00D",74,0)
 ;;=^^3^3^2960114^^
"RTN","VEEMI00D",75,0)
 ;;^UTILITY(U,$J,19200.114,42,"WP",1,0)
"RTN","VEEMI00D",76,0)
 ;;=When DIC(0) contains L, you can specify fields to be asked for if
"RTN","VEEMI00D",77,0)
 ;;^UTILITY(U,$J,19200.114,42,"WP",2,0)
"RTN","VEEMI00D",78,0)
 ;;=user enters new entry. Looks same as DIE's DR string. This overrides
"RTN","VEEMI00D",79,0)
 ;;^UTILITY(U,$J,19200.114,42,"WP",3,0)
"RTN","VEEMI00D",80,0)
 ;;=the asking of identifiers.
"RTN","VEEMI00D",81,0)
 ;;^UTILITY(U,$J,19200.114,43,0)
"RTN","VEEMI00D",82,0)
 ;;=DIC('P')
"RTN","VEEMI00D",83,0)
 ;;^UTILITY(U,$J,19200.114,43,"WP",0)
"RTN","VEEMI00D",84,0)
 ;;=^^4^4^2960115^
"RTN","VEEMI00D",85,0)
 ;;^UTILITY(U,$J,19200.114,43,"WP",1,0)
"RTN","VEEMI00D",86,0)
 ;;=--> H=Help
"RTN","VEEMI00D",87,0)
 ;;^UTILITY(U,$J,19200.114,43,"WP",2,0)
"RTN","VEEMI00D",88,0)
 ;;=This variable is needed to successfully add the FIRST subentry to a
"RTN","VEEMI00D",89,0)
 ;;^UTILITY(U,$J,19200.114,43,"WP",3,0)
"RTN","VEEMI00D",90,0)
 ;;=multiple when the header node of the multiple doesn't exist.
"RTN","VEEMI00D",91,0)
 ;;^UTILITY(U,$J,19200.114,43,"WP",4,0)
"RTN","VEEMI00D",92,0)
 ;;=Example: S DIC("P")=$P(^DD(16150,9,0),"^",2).
"RTN","VEEMI00D",93,0)
 ;;^UTILITY(U,$J,19200.114,43,"WP1",0)
"RTN","VEEMI00D",94,0)
 ;;=^^10^10^2960115^^
"RTN","VEEMI00D",95,0)
 ;;^UTILITY(U,$J,19200.114,43,"WP1",1,0)
"RTN","VEEMI00D",96,0)
 ;;=This variable is needed to successfully add the FIRST subentry to a
"RTN","VEEMI00D",97,0)
 ;;^UTILITY(U,$J,19200.114,43,"WP1",2,0)
"RTN","VEEMI00D",98,0)
 ;;=multiple when the descriptor node of the multiple does not exist. In
"RTN","VEEMI00D",99,0)
 ;;^UTILITY(U,$J,19200.114,43,"WP1",3,0)
"RTN","VEEMI00D",100,0)
 ;;=that situation, DIC("P") should be set equal to the subfile number and
"RTN","VEEMI00D",101,0)
 ;;^UTILITY(U,$J,19200.114,43,"WP1",4,0)
"RTN","VEEMI00D",102,0)
 ;;=subfile specifier codes for the multiple.
"RTN","VEEMI00D",103,0)
 ;;^UTILITY(U,$J,19200.114,43,"WP1",5,0)
"RTN","VEEMI00D",104,0)
 ;;= 
"RTN","VEEMI00D",105,0)
 ;;^UTILITY(U,$J,19200.114,43,"WP1",6,0)
"RTN","VEEMI00D",106,0)
 ;;=In order to automatically include any changes in the field's definition,
"RTN","VEEMI00D",107,0)
 ;;^UTILITY(U,$J,19200.114,43,"WP1",7,0)
"RTN","VEEMI00D",108,0)
 ;;=it is best to set this variable to the 2nd piece of the 0-node of the
"RTN","VEEMI00E")
0^179^B28564047
"RTN","VEEMI00E",1,0)
VEEMI00E ; ; 04-JAN-2004
"RTN","VEEMI00E",2,0)
 ;;12;VPE SHELL;;JAN 04, 2004;Build 8
"RTN","VEEMI00E",3,0)
 Q:'DIFQR(19200.114)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
"RTN","VEEMI00E",4,0)
Q Q
"RTN","VEEMI00E",5,0)
 ;;^UTILITY(U,$J,19200.114,43,"WP1",8,0)
"RTN","VEEMI00E",6,0)
 ;;=multiple field's definition in the DD.
"RTN","VEEMI00E",7,0)
 ;;^UTILITY(U,$J,19200.114,43,"WP1",9,0)
"RTN","VEEMI00E",8,0)
 ;;= 
"RTN","VEEMI00E",9,0)
 ;;^UTILITY(U,$J,19200.114,43,"WP1",10,0)
"RTN","VEEMI00E",10,0)
 ;;=Example:  S DIC("P")=$P(^DD(16150,9,0),"^",2)
"RTN","VEEMI00E",11,0)
 ;;^UTILITY(U,$J,19200.114,44,0)
"RTN","VEEMI00E",12,0)
 ;;=DIC('V')
"RTN","VEEMI00E",13,0)
 ;;^UTILITY(U,$J,19200.114,44,"WP",0)
"RTN","VEEMI00E",14,0)
 ;;=^^3^3^2960115^
"RTN","VEEMI00E",15,0)
 ;;^UTILITY(U,$J,19200.114,44,"WP",1,0)
"RTN","VEEMI00E",16,0)
 ;;=--> H=Help
"RTN","VEEMI00E",17,0)
 ;;^UTILITY(U,$J,19200.114,44,"WP",2,0)
"RTN","VEEMI00E",18,0)
 ;;=If .01 field is a variable pointer, you can restrict users from inputting
"RTN","VEEMI00E",19,0)
 ;;^UTILITY(U,$J,19200.114,44,"WP",3,0)
"RTN","VEEMI00E",20,0)
 ;;=entries from certain files by setting DIC("V").
"RTN","VEEMI00E",21,0)
 ;;^UTILITY(U,$J,19200.114,44,"WP1",0)
"RTN","VEEMI00E",22,0)
 ;;=^^7^7^2960115^^^
"RTN","VEEMI00E",23,0)
 ;;^UTILITY(U,$J,19200.114,44,"WP1",1,0)
"RTN","VEEMI00E",24,0)
 ;;=If the .01 field is a variable pointer, it can point to entries in more
"RTN","VEEMI00E",25,0)
 ;;^UTILITY(U,$J,19200.114,44,"WP1",2,0)
"RTN","VEEMI00E",26,0)
 ;;=than one file. You can restrict the user's ability to input entries from
"RTN","VEEMI00E",27,0)
 ;;^UTILITY(U,$J,19200.114,44,"WP1",3,0)
"RTN","VEEMI00E",28,0)
 ;;=certain files by using the DIC("V") variable. It is used to screen files
"RTN","VEEMI00E",29,0)
 ;;^UTILITY(U,$J,19200.114,44,"WP1",4,0)
"RTN","VEEMI00E",30,0)
 ;;=from the user. The variable is set equal to a line of MUMPS code that will
"RTN","VEEMI00E",31,0)
 ;;^UTILITY(U,$J,19200.114,44,"WP1",5,0)
"RTN","VEEMI00E",32,0)
 ;;=return a truth value when executed. The code is executed after someone
"RTN","VEEMI00E",33,0)
 ;;^UTILITY(U,$J,19200.114,44,"WP1",6,0)
"RTN","VEEMI00E",34,0)
 ;;=enters data into a variable pointer field. If the code tests false, the
"RTN","VEEMI00E",35,0)
 ;;^UTILITY(U,$J,19200.114,44,"WP1",7,0)
"RTN","VEEMI00E",36,0)
 ;;=user's input is rejected.
"RTN","VEEMI00E",37,0)
 ;;^UTILITY(U,$J,19200.114,45,0)
"RTN","VEEMI00E",38,0)
 ;;=DTIME
"RTN","VEEMI00E",39,0)
 ;;^UTILITY(U,$J,19200.114,45,"WP",0)
"RTN","VEEMI00E",40,0)
 ;;=^^1^1^2960113^
"RTN","VEEMI00E",41,0)
 ;;^UTILITY(U,$J,19200.114,45,"WP",1,0)
"RTN","VEEMI00E",42,0)
 ;;=Number of seconds for timeout. DTOUT=1 is returned.
"RTN","VEEMI00E",43,0)
 ;;^UTILITY(U,$J,19200.114,46,0)
"RTN","VEEMI00E",44,0)
 ;;=DLAYGO
"RTN","VEEMI00E",45,0)
 ;;^UTILITY(U,$J,19200.114,46,"WP",0)
"RTN","VEEMI00E",46,0)
 ;;=^^3^3^2960113^
"RTN","VEEMI00E",47,0)
 ;;^UTILITY(U,$J,19200.114,46,"WP",1,0)
"RTN","VEEMI00E",48,0)
 ;;=If set equal to file number, then user will be able to add a new entry
"RTN","VEEMI00E",49,0)
 ;;^UTILITY(U,$J,19200.114,46,"WP",2,0)
"RTN","VEEMI00E",50,0)
 ;;=to the file whether or not they have LAYGO access to the file. DIC(0)
"RTN","VEEMI00E",51,0)
 ;;^UTILITY(U,$J,19200.114,46,"WP",3,0)
"RTN","VEEMI00E",52,0)
 ;;=must also contain "L".
"RTN","VEEMI00E",53,0)
 ;;^UTILITY(U,$J,19200.114,47,0)
"RTN","VEEMI00E",54,0)
 ;;=X
"RTN","VEEMI00E",55,0)
 ;;^UTILITY(U,$J,19200.114,47,"I")
"RTN","VEEMI00E",56,0)
 ;;=DIC
"RTN","VEEMI00E",57,0)
 ;;^UTILITY(U,$J,19200.114,47,"WP",0)
"RTN","VEEMI00E",58,0)
 ;;=^^3^3^2960114^^
"RTN","VEEMI00E",59,0)
 ;;^UTILITY(U,$J,19200.114,47,"WP",1,0)
"RTN","VEEMI00E",60,0)
 ;;=If DIC(0) does not contain an A, then the variable X must be defined
"RTN","VEEMI00E",61,0)
 ;;^UTILITY(U,$J,19200.114,47,"WP",2,0)
"RTN","VEEMI00E",62,0)
 ;;=equal to the value you want to lookup. If the value in X has more than
"RTN","VEEMI00E",63,0)
 ;;^UTILITY(U,$J,19200.114,47,"WP",3,0)
"RTN","VEEMI00E",64,0)
 ;;=one match or partial match, the lookup fails and Y=-1 is returned.
"RTN","VEEMI00E",65,0)
 ;;^UTILITY(U,$J,19200.114,48,0)
"RTN","VEEMI00E",66,0)
 ;;=DA(1)
"RTN","VEEMI00E",67,0)
 ;;^UTILITY(U,$J,19200.114,48,"I")
"RTN","VEEMI00E",68,0)
 ;;=DIC
"RTN","VEEMI00E",69,0)
 ;;^UTILITY(U,$J,19200.114,48,"WP",0)
"RTN","VEEMI00E",70,0)
 ;;=^^5^5^2960113^
"RTN","VEEMI00E",71,0)
 ;;^UTILITY(U,$J,19200.114,48,"WP",1,0)
"RTN","VEEMI00E",72,0)
 ;;=Use to add new subentries to a multiple. DIC(0) would contain 'L'.
"RTN","VEEMI00E",73,0)
 ;;^UTILITY(U,$J,19200.114,48,"WP",2,0)
"RTN","VEEMI00E",74,0)
 ;;=DA(1)=IEN of the entry to which the subentry is to be added.
"RTN","VEEMI00E",75,0)
 ;;^UTILITY(U,$J,19200.114,48,"WP",3,0)
"RTN","VEEMI00E",76,0)
 ;;=  S DIC=DIC_DA(1)_",4," ;..............The root of the subfile
"RTN","VEEMI00E",77,0)
 ;;^UTILITY(U,$J,19200.114,48,"WP",4,0)
"RTN","VEEMI00E",78,0)
 ;;=  S DIC("P")=$P(^DD(16150,9,0),"^",2) ;Return subfile# & specifiers
"RTN","VEEMI00E",79,0)
 ;;^UTILITY(U,$J,19200.114,48,"WP",5,0)
"RTN","VEEMI00E",80,0)
 ;;=  D ^DIC
"RTN","VEEMI00E",81,0)
 ;;^UTILITY(U,$J,19200.114,49,0)
"RTN","VEEMI00E",82,0)
 ;;=D
"RTN","VEEMI00E",83,0)
 ;;^UTILITY(U,$J,19200.114,49,"WP",0)
"RTN","VEEMI00E",84,0)
 ;;=^^2^2^2960114^^
"RTN","VEEMI00E",85,0)
 ;;^UTILITY(U,$J,19200.114,49,"WP",1,0)
"RTN","VEEMI00E",86,0)
 ;;=List of xrefs to be searched (separated by "^").
"RTN","VEEMI00E",87,0)
 ;;^UTILITY(U,$J,19200.114,49,"WP",2,0)
"RTN","VEEMI00E",88,0)
 ;;=Example: D="B^SSN^C"
"RTN","VEEMI00E",89,0)
 ;;^UTILITY(U,$J,19200.114,50,0)
"RTN","VEEMI00E",90,0)
 ;;=X
"RTN","VEEMI00E",91,0)
 ;;^UTILITY(U,$J,19200.114,50,"I")
"RTN","VEEMI00E",92,0)
 ;;=FILE^DICN
"RTN","VEEMI00E",93,0)
 ;;^UTILITY(U,$J,19200.114,50,"WP",0)
"RTN","VEEMI00E",94,0)
 ;;=^^3^3^2960114^
"RTN","VEEMI00E",95,0)
 ;;^UTILITY(U,$J,19200.114,50,"WP",1,0)
"RTN","VEEMI00E",96,0)
 ;;=The value of the .01 field that is to be added to the file. The
"RTN","VEEMI00E",97,0)
 ;;^UTILITY(U,$J,19200.114,50,"WP",2,0)
"RTN","VEEMI00E",98,0)
 ;;=programmer has to ensure that the value meets all the criteria
"RTN","VEEMI00E",99,0)
 ;;^UTILITY(U,$J,19200.114,50,"WP",3,0)
"RTN","VEEMI00E",100,0)
 ;;=described in the input transform.
"RTN","VEEMI00E",101,0)
 ;;^UTILITY(U,$J,19200.114,51,0)
"RTN","VEEMI00E",102,0)
 ;;=DINUM
"RTN","VEEMI00E",103,0)
 ;;^UTILITY(U,$J,19200.114,51,"WP",0)
"RTN","VEEMI00E",104,0)
 ;;=^^2^2^2960114^
"RTN","VEEMI00E",105,0)
 ;;^UTILITY(U,$J,19200.114,51,"WP",1,0)
"RTN","VEEMI00E",106,0)
 ;;=The IEN of the new entry. Must be a canonic number and no data can
"RTN","VEEMI00E",107,0)
 ;;^UTILITY(U,$J,19200.114,51,"WP",2,0)
"RTN","VEEMI00E",108,0)
 ;;=exist in the global at this subscript location.
"RTN","VEEMI00E",109,0)
 ;;^UTILITY(U,$J,19200.114,52,0)
"RTN","VEEMI00E",110,0)
 ;;=DIC('DR')
"RTN","VEEMI00E",111,0)
 ;;^UTILITY(U,$J,19200.114,52,"I")
"RTN","VEEMI00E",112,0)
 ;;=FILE^DICN
"RTN","VEEMI00E",113,0)
 ;;^UTILITY(U,$J,19200.114,52,"WP",0)
"RTN","VEEMI00E",114,0)
 ;;=^^3^3^2960114^
"RTN","VEEMI00E",115,0)
 ;;^UTILITY(U,$J,19200.114,52,"WP",1,0)
"RTN","VEEMI00E",116,0)
 ;;=Used to input other data elements at the time of adding the entry.
"RTN","VEEMI00E",117,0)
 ;;^UTILITY(U,$J,19200.114,52,"WP",2,0)
"RTN","VEEMI00E",118,0)
 ;;=If the user does not enter these elements, the entry will not be
"RTN","VEEMI00E",119,0)
 ;;^UTILITY(U,$J,19200.114,52,"WP",3,0)
"RTN","VEEMI00E",120,0)
 ;;=added. The format is the same as DR when making a DIE call.
"RTN","VEEMI00F")
0^180^B29318210
"RTN","VEEMI00F",1,0)
VEEMI00F ; ; 04-JAN-2004
"RTN","VEEMI00F",2,0)
 ;;12;VPE SHELL;;JAN 04, 2004;Build 8
"RTN","VEEMI00F",3,0)
 Q:'DIFQR(19200.114)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
"RTN","VEEMI00F",4,0)
Q Q
"RTN","VEEMI00F",5,0)
 ;;^UTILITY(U,$J,19200.114,53,0)
"RTN","VEEMI00F",6,0)
 ;;=DIC
"RTN","VEEMI00F",7,0)
 ;;^UTILITY(U,$J,19200.114,53,"I")
"RTN","VEEMI00F",8,0)
 ;;=FILE^DICN
"RTN","VEEMI00F",9,0)
 ;;^UTILITY(U,$J,19200.114,53,"WP",0)
"RTN","VEEMI00F",10,0)
 ;;=^^4^4^2960114^
"RTN","VEEMI00F",11,0)
 ;;^UTILITY(U,$J,19200.114,53,"WP",1,0)
"RTN","VEEMI00F",12,0)
 ;;=The global root or file number.
"RTN","VEEMI00F",13,0)
 ;;^UTILITY(U,$J,19200.114,53,"WP",2,0)
"RTN","VEEMI00F",14,0)
 ;;=You MUST kill DD variable PRIOR to calling FILE^DICN. If DO does not
"RTN","VEEMI00F",15,0)
 ;;^UTILITY(U,$J,19200.114,53,"WP",3,0)
"RTN","VEEMI00F",16,0)
 ;;=contain the characteristics of the file you are adding to, then DO
"RTN","VEEMI00F",17,0)
 ;;^UTILITY(U,$J,19200.114,53,"WP",4,0)
"RTN","VEEMI00F",18,0)
 ;;=should be killed also. NOTE: This variable is D with the letter O.
"RTN","VEEMI00F",19,0)
 ;;^UTILITY(U,$J,19200.114,54,0)
"RTN","VEEMI00F",20,0)
 ;;=%
"RTN","VEEMI00F",21,0)
 ;;^UTILITY(U,$J,19200.114,54,"I")
"RTN","VEEMI00F",22,0)
 ;;=YN^DICN
"RTN","VEEMI00F",23,0)
 ;;^UTILITY(U,$J,19200.114,54,"WP",0)
"RTN","VEEMI00F",24,0)
 ;;=^^4^4^2960517^^
"RTN","VEEMI00F",25,0)
 ;;^UTILITY(U,$J,19200.114,54,"WP",1,0)
"RTN","VEEMI00F",26,0)
 ;;=--> H=Help
"RTN","VEEMI00F",27,0)
 ;;^UTILITY(U,$J,19200.114,54,"WP",2,0)
"RTN","VEEMI00F",28,0)
 ;;=The default response:   %=0  No default
"RTN","VEEMI00F",29,0)
 ;;^UTILITY(U,$J,19200.114,54,"WP",3,0)
"RTN","VEEMI00F",30,0)
 ;;=                        %=1  YES
"RTN","VEEMI00F",31,0)
 ;;^UTILITY(U,$J,19200.114,54,"WP",4,0)
"RTN","VEEMI00F",32,0)
 ;;=                        %=2 (NO)
"RTN","VEEMI00F",33,0)
 ;;^UTILITY(U,$J,19200.114,54,"WP1",0)
"RTN","VEEMI00F",34,0)
 ;;=^^8^8^2960115^^^
"RTN","VEEMI00F",35,0)
 ;;^UTILITY(U,$J,19200.114,54,"WP1",1,0)
"RTN","VEEMI00F",36,0)
 ;;= Output Variables:
"RTN","VEEMI00F",37,0)
 ;;^UTILITY(U,$J,19200.114,54,"WP1",2,0)
"RTN","VEEMI00F",38,0)
 ;;=    %    %=-1  User entered "^"
"RTN","VEEMI00F",39,0)
 ;;^UTILITY(U,$J,19200.114,54,"WP1",3,0)
"RTN","VEEMI00F",40,0)
 ;;=         %=0   User entered <RET> when no default was presented
"RTN","VEEMI00F",41,0)
 ;;^UTILITY(U,$J,19200.114,54,"WP1",4,0)
"RTN","VEEMI00F",42,0)
 ;;=               User entered "?"
"RTN","VEEMI00F",43,0)
 ;;^UTILITY(U,$J,19200.114,54,"WP1",5,0)
"RTN","VEEMI00F",44,0)
 ;;=         %=1   User entered YES
"RTN","VEEMI00F",45,0)
 ;;^UTILITY(U,$J,19200.114,54,"WP1",6,0)
"RTN","VEEMI00F",46,0)
 ;;=         %=2   User entered NO
"RTN","VEEMI00F",47,0)
 ;;^UTILITY(U,$J,19200.114,54,"WP1",7,0)
"RTN","VEEMI00F",48,0)
 ;;= 
"RTN","VEEMI00F",49,0)
 ;;^UTILITY(U,$J,19200.114,54,"WP1",8,0)
"RTN","VEEMI00F",50,0)
 ;;=   %Y = The actual text that the user entered.
"RTN","VEEMI00F",51,0)
 ;;^UTILITY(U,$J,19200.114,55,0)
"RTN","VEEMI00F",52,0)
 ;;=D
"RTN","VEEMI00F",53,0)
 ;;^UTILITY(U,$J,19200.114,55,"D")
"RTN","VEEMI00F",54,0)
 ;;="B"
"RTN","VEEMI00F",55,0)
 ;;^UTILITY(U,$J,19200.114,55,"I")
"RTN","VEEMI00F",56,0)
 ;;=DQ^DICQ
"RTN","VEEMI00F",57,0)
 ;;^UTILITY(U,$J,19200.114,55,"WP",0)
"RTN","VEEMI00F",58,0)
 ;;=^^1^1^2960114^^
"RTN","VEEMI00F",59,0)
 ;;^UTILITY(U,$J,19200.114,55,"WP",1,0)
"RTN","VEEMI00F",60,0)
 ;;=Set to "B".
"RTN","VEEMI00F",61,0)
 ;;^UTILITY(U,$J,19200.114,56,0)
"RTN","VEEMI00F",62,0)
 ;;=DZ
"RTN","VEEMI00F",63,0)
 ;;^UTILITY(U,$J,19200.114,56,"D")
"RTN","VEEMI00F",64,0)
 ;;="??"
"RTN","VEEMI00F",65,0)
 ;;^UTILITY(U,$J,19200.114,56,"WP",0)
"RTN","VEEMI00F",66,0)
 ;;=^^2^2^2960114^
"RTN","VEEMI00F",67,0)
 ;;^UTILITY(U,$J,19200.114,56,"WP",1,0)
"RTN","VEEMI00F",68,0)
 ;;=Set to "??". This is set in order to prevent FM from issuing the
"RTN","VEEMI00F",69,0)
 ;;^UTILITY(U,$J,19200.114,56,"WP",2,0)
"RTN","VEEMI00F",70,0)
 ;;="DO YOU WANT TO SEE ALL nn ENTRIES?" prompt.
"RTN","VEEMI00F",71,0)
 ;;^UTILITY(U,$J,19200.114,57,0)
"RTN","VEEMI00F",72,0)
 ;;=DIFORMAT
"RTN","VEEMI00F",73,0)
 ;;^UTILITY(U,$J,19200.114,57,"WP",0)
"RTN","VEEMI00F",74,0)
 ;;=^^3^3^2960114^
"RTN","VEEMI00F",75,0)
 ;;^UTILITY(U,$J,19200.114,57,"WP",1,0)
"RTN","VEEMI00F",76,0)
 ;;=Equal to the desired data dictionary listing format:
"RTN","VEEMI00F",77,0)
 ;;^UTILITY(U,$J,19200.114,57,"WP",2,0)
"RTN","VEEMI00F",78,0)
 ;;=  STANDARD            BRIEF               MODIFIED STANDARD
"RTN","VEEMI00F",79,0)
 ;;^UTILITY(U,$J,19200.114,57,"WP",3,0)
"RTN","VEEMI00F",80,0)
 ;;=  TEMPLATES ONLY      GLOBAL MAP          CONDENSED
"RTN","VEEMI00F",81,0)
 ;;^UTILITY(U,$J,19200.114,58,0)
"RTN","VEEMI00F",82,0)
 ;;=DR
"RTN","VEEMI00F",83,0)
 ;;^UTILITY(U,$J,19200.114,58,"I")
"RTN","VEEMI00F",84,0)
 ;;=DIE
"RTN","VEEMI00F",85,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP",0)
"RTN","VEEMI00F",86,0)
 ;;=^^2^2^2960115^^^
"RTN","VEEMI00F",87,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP",1,0)
"RTN","VEEMI00F",88,0)
 ;;=--> H=Help
"RTN","VEEMI00F",89,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP",2,0)
"RTN","VEEMI00F",90,0)
 ;;=A string specifying data fields to be asked.
"RTN","VEEMI00F",91,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",0)
"RTN","VEEMI00F",92,0)
 ;;=^^57^57^2960115^
"RTN","VEEMI00F",93,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",1,0)
"RTN","VEEMI00F",94,0)
 ;;=The DR string consists of the following:
"RTN","VEEMI00F",95,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",2,0)
"RTN","VEEMI00F",96,0)
 ;;=  o  A single number corresponding to the IEN of a field in the file.
"RTN","VEEMI00F",97,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",3,0)
"RTN","VEEMI00F",98,0)
 ;;=  o  A field number followed by "//" and a default prompt.
"RTN","VEEMI00F",99,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",4,0)
"RTN","VEEMI00F",100,0)
 ;;=  o  A fild number followed by "///" and a value. The value should be
"RTN","VEEMI00F",101,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",5,0)
"RTN","VEEMI00F",102,0)
 ;;=     in the external form of the field's value. The value will be
"RTN","VEEMI00F",103,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",6,0)
"RTN","VEEMI00F",104,0)
 ;;=     automatically inserted into the data base after passing through the
"RTN","VEEMI00F",105,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",7,0)
"RTN","VEEMI00F",106,0)
 ;;=     input transform. You may pass the value contained in a variable. In
"RTN","VEEMI00F",107,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",8,0)
"RTN","VEEMI00F",108,0)
 ;;=     that case use: "S DR=27///^S X=VAR"
"RTN","VEEMI00F",109,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",9,0)
"RTN","VEEMI00F",110,0)
 ;;=  o  A field followed by "////" and a value. The value will be inserted
"RTN","VEEMI00F",111,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",10,0)
"RTN","VEEMI00F",112,0)
 ;;=     WITHOUT VALIDATION into the data base. The value should be in its
"RTN","VEEMI00F",113,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",11,0)
"RTN","VEEMI00F",114,0)
 ;;=     internally stored form. Cannot be used for .01 fields.
"RTN","VEEMI00F",115,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",12,0)
"RTN","VEEMI00F",116,0)
 ;;=  o  A range of field numbers, in the form M:N.
"RTN","VEEMI00F",117,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",13,0)
"RTN","VEEMI00F",118,0)
 ;;=  o  A place-holder like @1.
"RTN","VEEMI00F",119,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",14,0)
"RTN","VEEMI00F",120,0)
 ;;=  o  A line of MUMPS code.
"RTN","VEEMI00F",121,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",15,0)
"RTN","VEEMI00F",122,0)
 ;;=  o  A sequence of any of the above, separated by ";".
"RTN","VEEMI00F",123,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",16,0)
"RTN","VEEMI00F",124,0)
 ;;=  o  An input templete enclosed in "[]".
"RTN","VEEMI00G")
0^181^B25928541
"RTN","VEEMI00G",1,0)
VEEMI00G ; ; 04-JAN-2004
"RTN","VEEMI00G",2,0)
 ;;12;VPE SHELL;;JAN 04, 2004;Build 8
"RTN","VEEMI00G",3,0)
 Q:'DIFQR(19200.114)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
"RTN","VEEMI00G",4,0)
Q Q
"RTN","VEEMI00G",5,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",17,0)
"RTN","VEEMI00G",6,0)
 ;;= 
"RTN","VEEMI00G",7,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",18,0)
"RTN","VEEMI00G",8,0)
 ;;=S P E C I F I E R S
"RTN","VEEMI00G",9,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",19,0)
"RTN","VEEMI00G",10,0)
 ;;=You can include specifiers in the DR string:
"RTN","VEEMI00G",11,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",20,0)
"RTN","VEEMI00G",12,0)
 ;;=       T = Use Title of field rather than field label.
"RTN","VEEMI00G",13,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",21,0)
"RTN","VEEMI00G",14,0)
 ;;=   "xxx" = Literal enclosed in quotes. Used as the prompt rather than
"RTN","VEEMI00G",15,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",22,0)
"RTN","VEEMI00G",16,0)
 ;;=           field label.
"RTN","VEEMI00G",17,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",23,0)
"RTN","VEEMI00G",18,0)
 ;;=     DUP = Duplicate the response to this field from entry to entry.
"RTN","VEEMI00G",19,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",24,0)
"RTN","VEEMI00G",20,0)
 ;;=     REQ = Require an answer to the field.
"RTN","VEEMI00G",21,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",25,0)
"RTN","VEEMI00G",22,0)
 ;;= 
"RTN","VEEMI00G",23,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",26,0)
"RTN","VEEMI00G",24,0)
 ;;=Using field #3 as an example:
"RTN","VEEMI00G",25,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",27,0)
"RTN","VEEMI00G",26,0)
 ;;=      3T = Title......The T immediately follows the field number.
"RTN","VEEMI00G",27,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",28,0)
"RTN","VEEMI00G",28,0)
 ;;=    3xxx = Literal....No quotes.
"RTN","VEEMI00G",29,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",29,0)
"RTN","VEEMI00G",30,0)
 ;;=      3d = Duplicate..Lowercase D.
"RTN","VEEMI00G",31,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",30,0)
"RTN","VEEMI00G",32,0)
 ;;=      3R = Required...Uppercase R
"RTN","VEEMI00G",33,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",31,0)
"RTN","VEEMI00G",34,0)
 ;;=You can combine specifiers by separating with a "~".
"RTN","VEEMI00G",35,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",32,0)
"RTN","VEEMI00G",36,0)
 ;;= 
"RTN","VEEMI00G",37,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",33,0)
"RTN","VEEMI00G",38,0)
 ;;=B R A N C H I N G   L O G I C
"RTN","VEEMI00G",39,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",34,0)
"RTN","VEEMI00G",40,0)
 ;;=You can include branching logic within DR. This done by inserting an
"RTN","VEEMI00G",41,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",35,0)
"RTN","VEEMI00G",42,0)
 ;;=executable MUMPS statement in one of the semicolon-pieces. This code will
"RTN","VEEMI00G",43,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",36,0)
"RTN","VEEMI00G",44,0)
 ;;=be executed when this piece is encountered by the DIE routine. If the
"RTN","VEEMI00G",45,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",37,0)
"RTN","VEEMI00G",46,0)
 ;;=MUMPS code sets the variable Y, DIE will jump to the field whose number
"RTN","VEEMI00G",47,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",38,0)
"RTN","VEEMI00G",48,0)
 ;;=(or label) matches Y. The field must be specified elsewhere within the
"RTN","VEEMI00G",49,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",39,0)
"RTN","VEEMI00G",50,0)
 ;;=DR variable. Y may look like a place holder, e.g. @1. If Y is set to zero
"RTN","VEEMI00G",51,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",40,0)
"RTN","VEEMI00G",52,0)
 ;;=or null, DIE will exit. If Y is killed or never set, no branching will
"RTN","VEEMI00G",53,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",41,0)
"RTN","VEEMI00G",54,0)
 ;;=occur. X will be equal to the internal value of the field previously
"RTN","VEEMI00G",55,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",42,0)
"RTN","VEEMI00G",56,0)
 ;;=asked.
"RTN","VEEMI00G",57,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",43,0)
"RTN","VEEMI00G",58,0)
 ;;=Example: S DR="4;I X=""YES"" S Y=10;.01;10:15"
"RTN","VEEMI00G",59,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",44,0)
"RTN","VEEMI00G",60,0)
 ;;= 
"RTN","VEEMI00G",61,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",45,0)
"RTN","VEEMI00G",62,0)
 ;;=S P E C I F I C   F I E L D S   I N   A   M U L T I P L E
"RTN","VEEMI00G",63,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",46,0)
"RTN","VEEMI00G",64,0)
 ;;=If you want to edit only selected fields in a multiple, set DR normally
"RTN","VEEMI00G",65,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",47,0)
"RTN","VEEMI00G",66,0)
 ;;=and then set a subscripted value of Dr equal to the sub-fields to edit.
"RTN","VEEMI00G",67,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",48,0)
"RTN","VEEMI00G",68,0)
 ;;=Example: S DR="5",DR(2,16001.02)=".01;7"
"RTN","VEEMI00G",69,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",49,0)
"RTN","VEEMI00G",70,0)
 ;;=         Where 2 means the 2nd level of the file, and the 2nd subscript
"RTN","VEEMI00G",71,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",50,0)
"RTN","VEEMI00G",72,0)
 ;;=         is the subfile number of the multiple field (#5).
"RTN","VEEMI00G",73,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",51,0)
"RTN","VEEMI00G",74,0)
 ;;= 
"RTN","VEEMI00G",75,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",52,0)
"RTN","VEEMI00G",76,0)
 ;;=C O N T I N U E D   D R   S T R I N G S
"RTN","VEEMI00G",77,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",53,0)
"RTN","VEEMI00G",78,0)
 ;;=If there is more than 245 characters in a DR-string, you can set
"RTN","VEEMI00G",79,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",54,0)
"RTN","VEEMI00G",80,0)
 ;;=continuation strings by defining the DR-array at the 3rd subscript
"RTN","VEEMI00G",81,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",55,0)
"RTN","VEEMI00G",82,0)
 ;;=level. These subscripts should be sequential integers starting at 1.
"RTN","VEEMI00G",83,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",56,0)
"RTN","VEEMI00G",84,0)
 ;;=Example: The 1st continuation node of DR(2,16001.02) would be
"RTN","VEEMI00G",85,0)
 ;;^UTILITY(U,$J,19200.114,58,"WP1",57,0)
"RTN","VEEMI00G",86,0)
 ;;=         DR(2,160001.02,1).
"RTN","VEEMI00G",87,0)
 ;;^UTILITY(U,$J,19200.114,59,0)
"RTN","VEEMI00G",88,0)
 ;;=DIE('NO~')
"RTN","VEEMI00G",89,0)
 ;;^UTILITY(U,$J,19200.114,59,"I")
"RTN","VEEMI00G",90,0)
 ;;=DIE
"RTN","VEEMI00G",91,0)
 ;;^UTILITY(U,$J,19200.114,59,"WP",0)
"RTN","VEEMI00G",92,0)
 ;;=^^5^5^2960115^
"RTN","VEEMI00G",93,0)
 ;;^UTILITY(U,$J,19200.114,59,"WP",1,0)
"RTN","VEEMI00G",94,0)
 ;;=DIE("NO^") variable:
"RTN","VEEMI00G",95,0)
 ;;^UTILITY(U,$J,19200.114,59,"WP",2,0)
"RTN","VEEMI00G",96,0)
 ;;=   "OUTOK"          Exiting YES        Jumping NO
"RTN","VEEMI00G",97,0)
 ;;^UTILITY(U,$J,19200.114,59,"WP",3,0)
"RTN","VEEMI00G",98,0)
 ;;=   "BACK"           Exiting NO    Jumping back YES
"RTN","VEEMI00G",99,0)
 ;;^UTILITY(U,$J,19200.114,59,"WP",4,0)
"RTN","VEEMI00G",100,0)
 ;;=   "BACKOUTOK"      Exiting YES   Jumping back YES
"RTN","VEEMI00G",101,0)
 ;;^UTILITY(U,$J,19200.114,59,"WP",5,0)
"RTN","VEEMI00G",102,0)
 ;;=   "Other value"    Exiting NO         Jumping NO
"RTN","VEEMI00G",103,0)
 ;;^UTILITY(U,$J,19200.114,60,0)
"RTN","VEEMI00G",104,0)
 ;;=DA(1)
"RTN","VEEMI00G",105,0)
 ;;^UTILITY(U,$J,19200.114,60,"I")
"RTN","VEEMI00G",106,0)
 ;;=DIE
"RTN","VEEMI00G",107,0)
 ;;^UTILITY(U,$J,19200.114,60,"WP",0)
"RTN","VEEMI00G",108,0)
 ;;=^^2^2^2960115^
"RTN","VEEMI00H")
0^182^B29341833
"RTN","VEEMI00H",1,0)
VEEMI00H ; ; 04-JAN-2004
"RTN","VEEMI00H",2,0)
 ;;12;VPE SHELL;;JAN 04, 2004;Build 8
"RTN","VEEMI00H",3,0)
 Q:'DIFQR(19200.114)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
"RTN","VEEMI00H",4,0)
Q Q
"RTN","VEEMI00H",5,0)
 ;;^UTILITY(U,$J,19200.114,60,"WP",1,0)
"RTN","VEEMI00H",6,0)
 ;;=--> H=Help
"RTN","VEEMI00H",7,0)
 ;;^UTILITY(U,$J,19200.114,60,"WP",2,0)
"RTN","VEEMI00H",8,0)
 ;;=DIE can be called to directly edit an entry in a subfile.
"RTN","VEEMI00H",9,0)
 ;;^UTILITY(U,$J,19200.114,60,"WP1",0)
"RTN","VEEMI00H",10,0)
 ;;=^^8^8^2960115^
"RTN","VEEMI00H",11,0)
 ;;^UTILITY(U,$J,19200.114,60,"WP1",1,0)
"RTN","VEEMI00H",12,0)
 ;;=Suppose that the data in subfile 16000.02 is stored decendent from
"RTN","VEEMI00H",13,0)
 ;;^UTILITY(U,$J,19200.114,60,"WP1",2,0)
"RTN","VEEMI00H",14,0)
 ;;=subscript 20 and you are going to edit entry number 777, subentry
"RTN","VEEMI00H",15,0)
 ;;^UTILITY(U,$J,19200.114,60,"WP1",3,0)
"RTN","VEEMI00H",16,0)
 ;;=number 1:
"RTN","VEEMI00H",17,0)
 ;;^UTILITY(U,$J,19200.114,60,"WP1",4,0)
"RTN","VEEMI00H",18,0)
 ;;=   S DIE="^FILE(777,20,"
"RTN","VEEMI00H",19,0)
 ;;^UTILITY(U,$J,19200.114,60,"WP1",5,0)
"RTN","VEEMI00H",20,0)
 ;;=   S DA(1)=777
"RTN","VEEMI00H",21,0)
 ;;^UTILITY(U,$J,19200.114,60,"WP1",6,0)
"RTN","VEEMI00H",22,0)
 ;;=   S DA=1
"RTN","VEEMI00H",23,0)
 ;;^UTILITY(U,$J,19200.114,60,"WP1",7,0)
"RTN","VEEMI00H",24,0)
 ;;=   S DR="3;7"
"RTN","VEEMI00H",25,0)
 ;;^UTILITY(U,$J,19200.114,60,"WP1",8,0)
"RTN","VEEMI00H",26,0)
 ;;=   D ^DIE
"RTN","VEEMI00H",27,0)
 ;;^UTILITY(U,$J,19200.114,61,0)
"RTN","VEEMI00H",28,0)
 ;;=FLAGS
"RTN","VEEMI00H",29,0)
 ;;^UTILITY(U,$J,19200.114,61,"I")
"RTN","VEEMI00H",30,0)
 ;;=GETS^DIQ
"RTN","VEEMI00H",31,0)
 ;;^UTILITY(U,$J,19200.114,61,"WP",0)
"RTN","VEEMI00H",32,0)
 ;;=^^5^5^2960521^^
"RTN","VEEMI00H",33,0)
 ;;^UTILITY(U,$J,19200.114,61,"WP",1,0)
"RTN","VEEMI00H",34,0)
 ;;=E = Returns external values in nodes ending with "E".
"RTN","VEEMI00H",35,0)
 ;;^UTILITY(U,$J,19200.114,61,"WP",2,0)
"RTN","VEEMI00H",36,0)
 ;;=I = Returns internal values in nodes ending with "I".
"RTN","VEEMI00H",37,0)
 ;;^UTILITY(U,$J,19200.114,61,"WP",3,0)
"RTN","VEEMI00H",38,0)
 ;;=N = Does not return Null values.
"RTN","VEEMI00H",39,0)
 ;;^UTILITY(U,$J,19200.114,61,"WP",4,0)
"RTN","VEEMI00H",40,0)
 ;;=R = Resolves field numbers to field names in target array subscripts.
"RTN","VEEMI00H",41,0)
 ;;^UTILITY(U,$J,19200.114,61,"WP",5,0)
"RTN","VEEMI00H",42,0)
 ;;=Z = Word processing fields include Zero nodes.
"RTN","VEEMI00H",43,0)
 ;;^UTILITY(U,$J,19200.114,62,0)
"RTN","VEEMI00H",44,0)
 ;;=FIELDS
"RTN","VEEMI00H",45,0)
 ;;^UTILITY(U,$J,19200.114,62,"I")
"RTN","VEEMI00H",46,0)
 ;;=GETS^DIQ
"RTN","VEEMI00H",47,0)
 ;;^UTILITY(U,$J,19200.114,62,"WP",0)
"RTN","VEEMI00H",48,0)
 ;;=^^5^5^2960512^
"RTN","VEEMI00H",49,0)
 ;;^UTILITY(U,$J,19200.114,62,"WP",1,0)
"RTN","VEEMI00H",50,0)
 ;;=A single field number. A list of field numbers separated by semicolons.
"RTN","VEEMI00H",51,0)
 ;;^UTILITY(U,$J,19200.114,62,"WP",2,0)
"RTN","VEEMI00H",52,0)
 ;;=A range of field numbers, in the form M:N. * for all fields at the top
"RTN","VEEMI00H",53,0)
 ;;^UTILITY(U,$J,19200.114,62,"WP",3,0)
"RTN","VEEMI00H",54,0)
 ;;=level. ** for all fields including sub-multiple fields. Field number of
"RTN","VEEMI00H",55,0)
 ;;^UTILITY(U,$J,19200.114,62,"WP",4,0)
"RTN","VEEMI00H",56,0)
 ;;=a multiple followed by an * to indicate all fields and records in the
"RTN","VEEMI00H",57,0)
 ;;^UTILITY(U,$J,19200.114,62,"WP",5,0)
"RTN","VEEMI00H",58,0)
 ;;=submultiple for that field.
"RTN","VEEMI00H",59,0)
 ;;^UTILITY(U,$J,19200.114,63,0)
"RTN","VEEMI00H",60,0)
 ;;=FLAGS
"RTN","VEEMI00H",61,0)
 ;;^UTILITY(U,$J,19200.114,63,"I")
"RTN","VEEMI00H",62,0)
 ;;=UPDATE^DIE
"RTN","VEEMI00H",63,0)
 ;;^UTILITY(U,$J,19200.114,63,"WP",0)
"RTN","VEEMI00H",64,0)
 ;;=^^5^5^2960526^^
"RTN","VEEMI00H",65,0)
 ;;^UTILITY(U,$J,19200.114,63,"WP",1,0)
"RTN","VEEMI00H",66,0)
 ;;=E=External values are processed. Values in the FDA must be in the format
"RTN","VEEMI00H",67,0)
 ;;^UTILITY(U,$J,19200.114,63,"WP",2,0)
"RTN","VEEMI00H",68,0)
 ;;=  input by the user. Updater validates all values and converts them to
"RTN","VEEMI00H",69,0)
 ;;^UTILITY(U,$J,19200.114,63,"WP",3,0)
"RTN","VEEMI00H",70,0)
 ;;=  internal format. Invalid values cancel the entire transaction.
"RTN","VEEMI00H",71,0)
 ;;^UTILITY(U,$J,19200.114,63,"WP",4,0)
"RTN","VEEMI00H",72,0)
 ;;=  If flag is not set, values must be in internal format and valid.
"RTN","VEEMI00H",73,0)
 ;;^UTILITY(U,$J,19200.114,63,"WP",5,0)
"RTN","VEEMI00H",74,0)
 ;;=S=Updater Saves the FDA instead of killing it.
"RTN","VEEMI00H",75,0)
 ;;^UTILITY(U,$J,19200.114,64,0)
"RTN","VEEMI00H",76,0)
 ;;=FDA_ROOT
"RTN","VEEMI00H",77,0)
 ;;^UTILITY(U,$J,19200.114,64,"I")
"RTN","VEEMI00H",78,0)
 ;;=UPDATE^DIE
"RTN","VEEMI00H",79,0)
 ;;^UTILITY(U,$J,19200.114,64,"WP",0)
"RTN","VEEMI00H",80,0)
 ;;=^^3^3^2960521^
"RTN","VEEMI00H",81,0)
 ;;^UTILITY(U,$J,19200.114,64,"WP",1,0)
"RTN","VEEMI00H",82,0)
 ;;=The name of the root of a Fileman Data Array, which describes the
"RTN","VEEMI00H",83,0)
 ;;^UTILITY(U,$J,19200.114,64,"WP",2,0)
"RTN","VEEMI00H",84,0)
 ;;=entries to add to the database. The Updater accepts Adding Nodes,
"RTN","VEEMI00H",85,0)
 ;;^UTILITY(U,$J,19200.114,64,"WP",3,0)
"RTN","VEEMI00H",86,0)
 ;;=Filing Nodes, Finding Nodes, and LAYGO Finding Nodes in its FDAs.
"RTN","VEEMI00H",87,0)
 ;;^UTILITY(U,$J,19200.114,65,0)
"RTN","VEEMI00H",88,0)
 ;;=IEN_ROOT
"RTN","VEEMI00H",89,0)
 ;;^UTILITY(U,$J,19200.114,65,"I")
"RTN","VEEMI00H",90,0)
 ;;=UPDATE^DIE
"RTN","VEEMI00H",91,0)
 ;;^UTILITY(U,$J,19200.114,65,"WP",0)
"RTN","VEEMI00H",92,0)
 ;;=^^2^2^2960521^^
"RTN","VEEMI00H",93,0)
 ;;^UTILITY(U,$J,19200.114,65,"WP",1,0)
"RTN","VEEMI00H",94,0)
 ;;=--> Help Text
"RTN","VEEMI00H",95,0)
 ;;^UTILITY(U,$J,19200.114,65,"WP",2,0)
"RTN","VEEMI00H",96,0)
 ;;=The name of the IEN Array. This should be a closed root.
"RTN","VEEMI00H",97,0)
 ;;^UTILITY(U,$J,19200.114,65,"WP1",0)
"RTN","VEEMI00H",98,0)
 ;;=^^32^32^2960521^
"RTN","VEEMI00H",99,0)
 ;;^UTILITY(U,$J,19200.114,65,"WP1",1,0)
"RTN","VEEMI00H",100,0)
 ;;=The IEN Array has 2 functions:
"RTN","VEEMI00H",101,0)
 ;;^UTILITY(U,$J,19200.114,65,"WP1",2,0)
"RTN","VEEMI00H",102,0)
 ;;= 
"RTN","VEEMI00H",103,0)
 ;;^UTILITY(U,$J,19200.114,65,"WP1",3,0)
"RTN","VEEMI00H",104,0)
 ;;=1. Requesting Record Numbers for New Entries.
"RTN","VEEMI00H",105,0)
 ;;^UTILITY(U,$J,19200.114,65,"WP1",4,0)
"RTN","VEEMI00H",106,0)
 ;;=   The application can set nodes in the IEN Array to direct the Updater
"RTN","VEEMI00H",107,0)
 ;;^UTILITY(U,$J,19200.114,65,"WP1",5,0)
"RTN","VEEMI00H",108,0)
 ;;=   to use specific record numbers for specific new records. These nodes
"RTN","VEEMI00H",109,0)
 ;;^UTILITY(U,$J,19200.114,65,"WP1",6,0)
"RTN","VEEMI00H",110,0)
 ;;=   should have a single subscript equal to the sequence number in the
"RTN","VEEMI00H",111,0)
 ;;^UTILITY(U,$J,19200.114,65,"WP1",7,0)
"RTN","VEEMI00H",112,0)
 ;;=   IENS subscript of the FDA entry and a value equal to the desired record
"RTN","VEEMI00H",113,0)
 ;;^UTILITY(U,$J,19200.114,65,"WP1",8,0)
"RTN","VEEMI00H",114,0)
 ;;=   number.
"RTN","VEEMI00H",115,0)
 ;;^UTILITY(U,$J,19200.114,65,"WP1",9,0)
"RTN","VEEMI00H",116,0)
 ;;= 
"RTN","VEEMI00H",117,0)
 ;;^UTILITY(U,$J,19200.114,65,"WP1",10,0)
"RTN","VEEMI00H",118,0)
 ;;=   For example, if the application sets the IEN_ROOT parameter to ORIEN,
"RTN","VEEMI00I")
0^183^B14938470
"RTN","VEEMI00I",1,0)
VEEMI00I ; ; 04-JAN-2004
"RTN","VEEMI00I",2,0)
 ;;12;VPE SHELL;;JAN 04, 2004;Build 8
"RTN","VEEMI00I",3,0)
 Q:'DIFQR(19200.114)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
"RTN","VEEMI00I",4,0)
Q Q
"RTN","VEEMI00I",5,0)
 ;;^UTILITY(U,$J,19200.114,65,"WP1",11,0)
"RTN","VEEMI00I",6,0)
 ;;=   and sets ORIEN(1)=1701, the Updater will try to assign record number
"RTN","VEEMI00I",7,0)
 ;;^UTILITY(U,$J,19200.114,65,"WP1",12,0)
"RTN","VEEMI00I",8,0)
 ;;=   1701 to the new record denoted by the "+1" value in the FDA subscripts.
"RTN","VEEMI00I",9,0)
 ;;^UTILITY(U,$J,19200.114,65,"WP1",13,0)
"RTN","VEEMI00I",10,0)
 ;;= 
"RTN","VEEMI00I",11,0)
 ;;^UTILITY(U,$J,19200.114,65,"WP1",14,0)
"RTN","VEEMI00I",12,0)
 ;;=   This feature also affects LAYGO Finding nodes. When these nodes result
"RTN","VEEMI00I",13,0)
 ;;^UTILITY(U,$J,19200.114,65,"WP1",15,0)
"RTN","VEEMI00I",14,0)
 ;;=   in adding a new record, the Updater will check the IEN Array to see if
"RTN","VEEMI00I",15,0)
 ;;^UTILITY(U,$J,19200.114,65,"WP1",16,0)
"RTN","VEEMI00I",16,0)
 ;;=   the application wants to place the new record at a specific record
"RTN","VEEMI00I",17,0)
 ;;^UTILITY(U,$J,19200.114,65,"WP1",17,0)
"RTN","VEEMI00I",18,0)
 ;;=   number. When LAYGO Finding nodes result in a successful lookup, the
"RTN","VEEMI00I",19,0)
 ;;^UTILITY(U,$J,19200.114,65,"WP1",18,0)
"RTN","VEEMI00I",20,0)
 ;;=   IEN Array node passed in by the application is changed to the record
"RTN","VEEMI00I",21,0)
 ;;^UTILITY(U,$J,19200.114,65,"WP1",19,0)
"RTN","VEEMI00I",22,0)
 ;;=   number of the record found.
"RTN","VEEMI00I",23,0)
 ;;^UTILITY(U,$J,19200.114,65,"WP1",20,0)
"RTN","VEEMI00I",24,0)
 ;;= 
"RTN","VEEMI00I",25,0)
 ;;^UTILITY(U,$J,19200.114,65,"WP1",21,0)
"RTN","VEEMI00I",26,0)
 ;;=   If the application sets an entry in the IEN Array for a Finding node,
"RTN","VEEMI00I",27,0)
 ;;^UTILITY(U,$J,19200.114,65,"WP1",22,0)
"RTN","VEEMI00I",28,0)
 ;;=   the Updater will ignore it (actually, it will overwrite it when it
"RTN","VEEMI00I",29,0)
 ;;^UTILITY(U,$J,19200.114,65,"WP1",23,0)
"RTN","VEEMI00I",30,0)
 ;;=   finds the record number for that node). This feature is meaningless
"RTN","VEEMI00I",31,0)
 ;;^UTILITY(U,$J,19200.114,65,"WP1",24,0)
"RTN","VEEMI00I",32,0)
 ;;=   for Filing nodes since they have no sequence numbers.
"RTN","VEEMI00I",33,0)
 ;;^UTILITY(U,$J,19200.114,65,"WP1",25,0)
"RTN","VEEMI00I",34,0)
 ;;= 
"RTN","VEEMI00I",35,0)
 ;;^UTILITY(U,$J,19200.114,65,"WP1",26,0)
"RTN","VEEMI00I",36,0)
 ;;=2. Locating Feedback on What the Update Did.
"RTN","VEEMI00I",37,0)
 ;;^UTILITY(U,$J,19200.114,65,"WP1",27,0)
"RTN","VEEMI00I",38,0)
 ;;=   As the Updater decodes and processes the sequence numbers, it
"RTN","VEEMI00I",39,0)
 ;;^UTILITY(U,$J,19200.114,65,"WP1",28,0)
"RTN","VEEMI00I",40,0)
 ;;=   gradually converts them into genuine record numbers. The IEN Array
"RTN","VEEMI00I",41,0)
 ;;^UTILITY(U,$J,19200.114,65,"WP1",29,0)
"RTN","VEEMI00I",42,0)
 ;;=   named by the IEN_ROOT parameter is where this feedback will be given.
"RTN","VEEMI00I",43,0)
 ;;^UTILITY(U,$J,19200.114,65,"WP1",30,0)
"RTN","VEEMI00I",44,0)
 ;;=   Those sequence numbers not already assigned by the application will
"RTN","VEEMI00I",45,0)
 ;;^UTILITY(U,$J,19200.114,65,"WP1",31,0)
"RTN","VEEMI00I",46,0)
 ;;=   be filled in by the Updater (or sometimes replaced, in the case of
"RTN","VEEMI00I",47,0)
 ;;^UTILITY(U,$J,19200.114,65,"WP1",32,0)
"RTN","VEEMI00I",48,0)
 ;;=   LAYGO Finding nodes).
"RTN","VEEMI00I",49,0)
 ;;^UTILITY(U,$J,19200.114,66,0)
"RTN","VEEMI00I",50,0)
 ;;=FLAGS
"RTN","VEEMI00I",51,0)
 ;;^UTILITY(U,$J,19200.114,66,"I")
"RTN","VEEMI00I",52,0)
 ;;=FILE^DIE
"RTN","VEEMI00I",53,0)
 ;;^UTILITY(U,$J,19200.114,66,"WP",0)
"RTN","VEEMI00I",54,0)
 ;;=^^3^3^2960526^
"RTN","VEEMI00I",55,0)
 ;;^UTILITY(U,$J,19200.114,66,"WP",1,0)
"RTN","VEEMI00I",56,0)
 ;;=K=Locking is done by Filer.
"RTN","VEEMI00I",57,0)
 ;;^UTILITY(U,$J,19200.114,66,"WP",2,0)
"RTN","VEEMI00I",58,0)
 ;;=S=Save FDA array.
"RTN","VEEMI00I",59,0)
 ;;^UTILITY(U,$J,19200.114,66,"WP",3,0)
"RTN","VEEMI00I",60,0)
 ;;=E=External values are processed.
"RTN","VEEMI00I",61,0)
 ;;^UTILITY(U,$J,19200.114,67,0)
"RTN","VEEMI00I",62,0)
 ;;=TARGET_ROOT
"RTN","VEEMI00I",63,0)
 ;;^UTILITY(U,$J,19200.114,67,"I")
"RTN","VEEMI00I",64,0)
 ;;=GETS^DIQ
"RTN","VEEMI00I",65,0)
 ;;^UTILITY(U,$J,19200.114,67,"WP",0)
"RTN","VEEMI00I",66,0)
 ;;=^^3^3^2960614^
"RTN","VEEMI00I",67,0)
 ;;^UTILITY(U,$J,19200.114,67,"WP",1,0)
"RTN","VEEMI00I",68,0)
 ;;=The array that should receive the output list of found entries. This
"RTN","VEEMI00I",69,0)
 ;;^UTILITY(U,$J,19200.114,67,"WP",2,0)
"RTN","VEEMI00I",70,0)
 ;;=must be a closed array reference and can be either local or global.
"RTN","VEEMI00I",71,0)
 ;;^UTILITY(U,$J,19200.114,67,"WP",3,0)
"RTN","VEEMI00I",72,0)
 ;;=This is a REQUIRED field.
"RTN","VEEMI00J")
0^184^B25448476
"RTN","VEEMI00J",1,0)
VEEMI00J ; ; 04-JAN-2004
"RTN","VEEMI00J",2,0)
 ;;12;VPE SHELL;;JAN 04, 2004;Build 8
"RTN","VEEMI00J",3,0)
 F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
"RTN","VEEMI00J",4,0)
Q Q
"RTN","VEEMI00J",5,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,0)
"RTN","VEEMI00J",6,0)
 ;;=VEEM PGM EDIT^^^^2960511.221^^^19200.113^0^0^1
"RTN","VEEMI00J",7,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,40,0)
"RTN","VEEMI00J",8,0)
 ;;=^.4031I^1^1
"RTN","VEEMI00J",9,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,40,1,0)
"RTN","VEEMI00J",10,0)
 ;;=1^^1,1
"RTN","VEEMI00J",11,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,40,1,1)
"RTN","VEEMI00J",12,0)
 ;;=Page 1
"RTN","VEEMI00J",13,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,40,1,40,0)
"RTN","VEEMI00J",14,0)
 ;;=^.4032IP^716^2
"RTN","VEEMI00J",15,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,40,1,40,715,0)
"RTN","VEEMI00J",16,0)
 ;;=VEEM PGM EDIT HD^1^1,1^d
"RTN","VEEMI00J",17,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,40,1,40,716,0)
"RTN","VEEMI00J",18,0)
 ;;=VEEM PGM EDIT EDT^2^2,1^e
"RTN","VEEMI00J",19,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,40,1,40,"AC",1,715)
"RTN","VEEMI00J",20,0)
 ;;=
"RTN","VEEMI00J",21,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,40,1,40,"AC",2,716)
"RTN","VEEMI00J",22,0)
 ;;=
"RTN","VEEMI00J",23,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,40,1,40,"B",715,715)
"RTN","VEEMI00J",24,0)
 ;;=
"RTN","VEEMI00J",25,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,40,1,40,"B",716,716)
"RTN","VEEMI00J",26,0)
 ;;=
"RTN","VEEMI00J",27,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,40,"B",1,1)
"RTN","VEEMI00J",28,0)
 ;;=
"RTN","VEEMI00J",29,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,40,"C","PAGE 1",1)
"RTN","VEEMI00J",30,0)
 ;;=
"RTN","VEEMI00J",31,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY",1,0,0,"N")
"RTN","VEEMI00J",32,0)
 ;;=18,716^1,716^1,716^18,716^1,716
"RTN","VEEMI00J",33,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY",1,715)
"RTN","VEEMI00J",34,0)
 ;;=0^0^19200.113^^d^^^^0
"RTN","VEEMI00J",35,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY",1,716)
"RTN","VEEMI00J",36,0)
 ;;=1^0^19200.113^^e^^^^1
"RTN","VEEMI00J",37,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY",1,716,1,"D")
"RTN","VEEMI00J",38,0)
 ;;=2^14^30^.01
"RTN","VEEMI00J",39,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY",1,716,1,"N")
"RTN","VEEMI00J",40,0)
 ;;=0^5^2^0^2
"RTN","VEEMI00J",41,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY",1,716,2,"D")
"RTN","VEEMI00J",42,0)
 ;;=2^57^2^2
"RTN","VEEMI00J",43,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY",1,716,2,"N")
"RTN","VEEMI00J",44,0)
 ;;=0^4^5^1^5
"RTN","VEEMI00J",45,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY",1,716,3,"D")
"RTN","VEEMI00J",46,0)
 ;;=5^14^20^3
"RTN","VEEMI00J",47,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY",1,716,3,"N")
"RTN","VEEMI00J",48,0)
 ;;=5^7^6^4^6
"RTN","VEEMI00J",49,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY",1,716,4,"D")
"RTN","VEEMI00J",50,0)
 ;;=4^57^9^4
"RTN","VEEMI00J",51,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY",1,716,4,"N")
"RTN","VEEMI00J",52,0)
 ;;=2^6^3^5^3
"RTN","VEEMI00J",53,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY",1,716,5,"D")
"RTN","VEEMI00J",54,0)
 ;;=4^14^30^5
"RTN","VEEMI00J",55,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY",1,716,5,"N")
"RTN","VEEMI00J",56,0)
 ;;=1^3^4^2^4
"RTN","VEEMI00J",57,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY",1,716,6,"D")
"RTN","VEEMI00J",58,0)
 ;;=5^57^20^20
"RTN","VEEMI00J",59,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY",1,716,6,"N")
"RTN","VEEMI00J",60,0)
 ;;=4^8^7^3^7
"RTN","VEEMI00J",61,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY",1,716,7,"D")
"RTN","VEEMI00J",62,0)
 ;;=7^14^25^21
"RTN","VEEMI00J",63,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY",1,716,7,"N")
"RTN","VEEMI00J",64,0)
 ;;=3^9^8^6^8
"RTN","VEEMI00J",65,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY",1,716,8,"D")
"RTN","VEEMI00J",66,0)
 ;;=7^53^25^22
"RTN","VEEMI00J",67,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY",1,716,8,"N")
"RTN","VEEMI00J",68,0)
 ;;=3^10^9^7^9
"RTN","VEEMI00J",69,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY",1,716,9,"D")
"RTN","VEEMI00J",70,0)
 ;;=8^14^25^23
"RTN","VEEMI00J",71,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY",1,716,9,"N")
"RTN","VEEMI00J",72,0)
 ;;=7^11^10^8^10
"RTN","VEEMI00J",73,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY",1,716,10,"D")
"RTN","VEEMI00J",74,0)
 ;;=8^53^25^24
"RTN","VEEMI00J",75,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY",1,716,10,"N")
"RTN","VEEMI00J",76,0)
 ;;=8^12^11^9^11
"RTN","VEEMI00J",77,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY",1,716,11,"D")
"RTN","VEEMI00J",78,0)
 ;;=9^14^25^25
"RTN","VEEMI00J",79,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY",1,716,11,"N")
"RTN","VEEMI00J",80,0)
 ;;=9^13^12^10^12
"RTN","VEEMI00J",81,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY",1,716,12,"D")
"RTN","VEEMI00J",82,0)
 ;;=9^53^25^26
"RTN","VEEMI00J",83,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY",1,716,12,"N")
"RTN","VEEMI00J",84,0)
 ;;=10^14^13^11^13
"RTN","VEEMI00J",85,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY",1,716,13,"D")
"RTN","VEEMI00J",86,0)
 ;;=10^14^25^27
"RTN","VEEMI00J",87,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY",1,716,13,"N")
"RTN","VEEMI00J",88,0)
 ;;=11^15^14^12^14
"RTN","VEEMI00J",89,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY",1,716,14,"D")
"RTN","VEEMI00J",90,0)
 ;;=10^53^25^28
"RTN","VEEMI00J",91,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY",1,716,14,"N")
"RTN","VEEMI00J",92,0)
 ;;=12^16^15^13^15
"RTN","VEEMI00J",93,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY",1,716,15,"D")
"RTN","VEEMI00J",94,0)
 ;;=11^14^25^29
"RTN","VEEMI00J",95,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY",1,716,15,"N")
"RTN","VEEMI00J",96,0)
 ;;=13^17^16^14^16
"RTN","VEEMI00J",97,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY",1,716,16,"D")
"RTN","VEEMI00J",98,0)
 ;;=11^53^25^30
"RTN","VEEMI00J",99,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY",1,716,16,"N")
"RTN","VEEMI00J",100,0)
 ;;=14^19^17^15^17
"RTN","VEEMI00J",101,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY",1,716,17,"D")
"RTN","VEEMI00J",102,0)
 ;;=12^14^25^31
"RTN","VEEMI00J",103,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY",1,716,17,"N")
"RTN","VEEMI00J",104,0)
 ;;=15^18^19^16^19
"RTN","VEEMI00J",105,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY",1,716,18,"D")
"RTN","VEEMI00J",106,0)
 ;;=13^14^25^33
"RTN","VEEMI00J",107,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY",1,716,18,"N")
"RTN","VEEMI00J",108,0)
 ;;=17^0^0^19^0
"RTN","VEEMI00J",109,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY",1,716,19,"D")
"RTN","VEEMI00J",110,0)
 ;;=12^53^25^32
"RTN","VEEMI00J",111,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY",1,716,19,"N")
"RTN","VEEMI00J",112,0)
 ;;=16^18^18^17^18
"RTN","VEEMI00J",113,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY",1,"FIRST")
"RTN","VEEMI00J",114,0)
 ;;=1,716
"RTN","VEEMI00J",115,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","CAP","ACTIVE",1,1,716,2)
"RTN","VEEMI00J",116,0)
 ;;=
"RTN","VEEMI00J",117,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","CAP","DESCRIPTION",1,1,716,5)
"RTN","VEEMI00J",118,0)
 ;;=
"RTN","VEEMI00J",119,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","CAP","IDENTIFIER",1,1,716,3)
"RTN","VEEMI00J",120,0)
 ;;=
"RTN","VEEMI00J",121,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","CAP","NAME",1,1,716,1)
"RTN","VEEMI00J",122,0)
 ;;=
"RTN","VEEMI00J",123,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","CAP","PARAM 1",1,1,716,7)
"RTN","VEEMI00J",124,0)
 ;;=
"RTN","VEEMI00J",125,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","CAP","PARAM 10",1,1,716,16)
"RTN","VEEMI00J",126,0)
 ;;=
"RTN","VEEMI00J",127,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","CAP","PARAM 11",1,1,716,17)
"RTN","VEEMI00J",128,0)
 ;;=
"RTN","VEEMI00J",129,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","CAP","PARAM 12",1,1,716,19)
"RTN","VEEMI00J",130,0)
 ;;=
"RTN","VEEMI00J",131,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","CAP","PARAM 13",1,1,716,18)
"RTN","VEEMI00J",132,0)
 ;;=
"RTN","VEEMI00J",133,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","CAP","PARAM 2",1,1,716,8)
"RTN","VEEMI00J",134,0)
 ;;=
"RTN","VEEMI00J",135,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","CAP","PARAM 3",1,1,716,9)
"RTN","VEEMI00J",136,0)
 ;;=
"RTN","VEEMI00J",137,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","CAP","PARAM 4",1,1,716,10)
"RTN","VEEMI00J",138,0)
 ;;=
"RTN","VEEMI00J",139,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","CAP","PARAM 5",1,1,716,11)
"RTN","VEEMI00J",140,0)
 ;;=
"RTN","VEEMI00K")
0^185^B22507510
"RTN","VEEMI00K",1,0)
VEEMI00K ; ; 04-JAN-2004
"RTN","VEEMI00K",2,0)
 ;;12;VPE SHELL;;JAN 04, 2004;Build 8
"RTN","VEEMI00K",3,0)
 F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
"RTN","VEEMI00K",4,0)
Q Q
"RTN","VEEMI00K",5,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","CAP","PARAM 6",1,1,716,12)
"RTN","VEEMI00K",6,0)
 ;;=
"RTN","VEEMI00K",7,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","CAP","PARAM 7",1,1,716,13)
"RTN","VEEMI00K",8,0)
 ;;=
"RTN","VEEMI00K",9,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","CAP","PARAM 8",1,1,716,14)
"RTN","VEEMI00K",10,0)
 ;;=
"RTN","VEEMI00K",11,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","CAP","PARAM 9",1,1,716,15)
"RTN","VEEMI00K",12,0)
 ;;=
"RTN","VEEMI00K",13,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","CAP","ROUTINE",1,1,716,6)
"RTN","VEEMI00K",14,0)
 ;;=
"RTN","VEEMI00K",15,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","CAP","TYPE",1,1,716,4)
"RTN","VEEMI00K",16,0)
 ;;=
"RTN","VEEMI00K",17,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","F19200.113",.01,"L",1,716,1)
"RTN","VEEMI00K",18,0)
 ;;=
"RTN","VEEMI00K",19,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","F19200.113",2,"L",1,716,2)
"RTN","VEEMI00K",20,0)
 ;;=
"RTN","VEEMI00K",21,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","F19200.113",3,"L",1,716,3)
"RTN","VEEMI00K",22,0)
 ;;=
"RTN","VEEMI00K",23,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","F19200.113",4,"L",1,716,4)
"RTN","VEEMI00K",24,0)
 ;;=
"RTN","VEEMI00K",25,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","F19200.113",5,"L",1,716,5)
"RTN","VEEMI00K",26,0)
 ;;=
"RTN","VEEMI00K",27,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","F19200.113",20,"L",1,716,6)
"RTN","VEEMI00K",28,0)
 ;;=
"RTN","VEEMI00K",29,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","F19200.113",21,"L",1,716,7)
"RTN","VEEMI00K",30,0)
 ;;=
"RTN","VEEMI00K",31,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","F19200.113",22,"L",1,716,8)
"RTN","VEEMI00K",32,0)
 ;;=
"RTN","VEEMI00K",33,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","F19200.113",23,"L",1,716,9)
"RTN","VEEMI00K",34,0)
 ;;=
"RTN","VEEMI00K",35,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","F19200.113",24,"L",1,716,10)
"RTN","VEEMI00K",36,0)
 ;;=
"RTN","VEEMI00K",37,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","F19200.113",25,"L",1,716,11)
"RTN","VEEMI00K",38,0)
 ;;=
"RTN","VEEMI00K",39,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","F19200.113",26,"L",1,716,12)
"RTN","VEEMI00K",40,0)
 ;;=
"RTN","VEEMI00K",41,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","F19200.113",27,"L",1,716,13)
"RTN","VEEMI00K",42,0)
 ;;=
"RTN","VEEMI00K",43,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","F19200.113",28,"L",1,716,14)
"RTN","VEEMI00K",44,0)
 ;;=
"RTN","VEEMI00K",45,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","F19200.113",29,"L",1,716,15)
"RTN","VEEMI00K",46,0)
 ;;=
"RTN","VEEMI00K",47,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","F19200.113",30,"L",1,716,16)
"RTN","VEEMI00K",48,0)
 ;;=
"RTN","VEEMI00K",49,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","F19200.113",31,"L",1,716,17)
"RTN","VEEMI00K",50,0)
 ;;=
"RTN","VEEMI00K",51,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","F19200.113",32,"L",1,716,19)
"RTN","VEEMI00K",52,0)
 ;;=
"RTN","VEEMI00K",53,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","F19200.113",33,"L",1,716,18)
"RTN","VEEMI00K",54,0)
 ;;=
"RTN","VEEMI00K",55,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","X",1,0,31)
"RTN","VEEMI00K",56,0)
 ;;=EDIT PROGRAM CALL                   Page 1 of 1
"RTN","VEEMI00K",57,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","X",1,1,0)
"RTN","VEEMI00K",58,0)
 ;;=-------------------------------------------------------------------------------
"RTN","VEEMI00K",59,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","X",1,2,8)
"RTN","VEEMI00K",60,0)
 ;;=NAME:                                    ACTIVE:
"RTN","VEEMI00K",61,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","X",1,2,8,"A")
"RTN","VEEMI00K",62,0)
 ;;=1;4;U
"RTN","VEEMI00K",63,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","X",1,4,1)
"RTN","VEEMI00K",64,0)
 ;;=DESCRIPTION:                                      TYPE:
"RTN","VEEMI00K",65,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","X",1,5,2)
"RTN","VEEMI00K",66,0)
 ;;=IDENTIFIER:                                   ROUTINE:
"RTN","VEEMI00K",67,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","X",1,7,5)
"RTN","VEEMI00K",68,0)
 ;;=PARAM 1:                               PARAM 2:
"RTN","VEEMI00K",69,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","X",1,8,5)
"RTN","VEEMI00K",70,0)
 ;;=PARAM 3:                               PARAM 4:
"RTN","VEEMI00K",71,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","X",1,9,5)
"RTN","VEEMI00K",72,0)
 ;;=PARAM 5:                               PARAM 6:
"RTN","VEEMI00K",73,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","X",1,10,5)
"RTN","VEEMI00K",74,0)
 ;;=PARAM 7:                               PARAM 8:
"RTN","VEEMI00K",75,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","X",1,11,5)
"RTN","VEEMI00K",76,0)
 ;;=PARAM 9:                              PARAM 10:
"RTN","VEEMI00K",77,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","X",1,12,4)
"RTN","VEEMI00K",78,0)
 ;;=PARAM 11:                              PARAM 12:
"RTN","VEEMI00K",79,0)
 ;;^UTILITY(U,$J,"DIST(.403,",188,"AY","X",1,13,4)
"RTN","VEEMI00K",80,0)
 ;;=PARAM 13:
"RTN","VEEMI00K",81,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,0)
"RTN","VEEMI00K",82,0)
 ;;=VEEM PGM CALL^^^^2960107.0859^^^19200.113^0^0^1
"RTN","VEEMI00K",83,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,40,0)
"RTN","VEEMI00K",84,0)
 ;;=^.4031I^1^1
"RTN","VEEMI00K",85,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,40,1,0)
"RTN","VEEMI00K",86,0)
 ;;=1^^1,1
"RTN","VEEMI00K",87,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,40,1,1)
"RTN","VEEMI00K",88,0)
 ;;=Page 1
"RTN","VEEMI00K",89,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,40,1,40,0)
"RTN","VEEMI00K",90,0)
 ;;=^.4032IP^718^2
"RTN","VEEMI00K",91,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,40,1,40,717,0)
"RTN","VEEMI00K",92,0)
 ;;=VEEM PGM CALL HD^1^1,1^d
"RTN","VEEMI00K",93,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,40,1,40,718,0)
"RTN","VEEMI00K",94,0)
 ;;=VEEM PGM CALL EDT^2^2,1^e
"RTN","VEEMI00K",95,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,40,1,40,"AC",1,717)
"RTN","VEEMI00K",96,0)
 ;;=
"RTN","VEEMI00K",97,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,40,1,40,"AC",2,718)
"RTN","VEEMI00K",98,0)
 ;;=
"RTN","VEEMI00K",99,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,40,1,40,"B",717,717)
"RTN","VEEMI00K",100,0)
 ;;=
"RTN","VEEMI00K",101,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,40,1,40,"B",718,718)
"RTN","VEEMI00K",102,0)
 ;;=
"RTN","VEEMI00K",103,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,40,"B",1,1)
"RTN","VEEMI00K",104,0)
 ;;=
"RTN","VEEMI00K",105,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,40,"C","PAGE 1",1)
"RTN","VEEMI00K",106,0)
 ;;=
"RTN","VEEMI00K",107,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,0,0,"N")
"RTN","VEEMI00K",108,0)
 ;;=27,718^2,718^2,718^28,718^2,718
"RTN","VEEMI00K",109,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,717)
"RTN","VEEMI00K",110,0)
 ;;=0^0^19200.113^^d^^^^0
"RTN","VEEMI00K",111,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,717,4,"D")
"RTN","VEEMI00K",112,0)
 ;;=^^^^3^4^^0
"RTN","VEEMI00K",113,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718)
"RTN","VEEMI00K",114,0)
 ;;=1^0^19200.113^^e^^^^2
"RTN","VEEMI00K",115,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,2,"D")
"RTN","VEEMI00K",116,0)
 ;;=2^10^20^20
"RTN","VEEMI00K",117,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,2,"N")
"RTN","VEEMI00K",118,0)
 ;;=0^3^29^0^3
"RTN","VEEMI00K",119,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,3,"D")
"RTN","VEEMI00K",120,0)
 ;;=4^4^25^21
"RTN","VEEMI00K",121,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,3,"N")
"RTN","VEEMI00K",122,0)
 ;;=2^4^6^29^6
"RTN","VEEMI00K",123,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,4,"D")
"RTN","VEEMI00K",124,0)
 ;;=5^4^25^22
"RTN","VEEMI00L")
0^186^B24805616
"RTN","VEEMI00L",1,0)
VEEMI00L ; ; 04-JAN-2004
"RTN","VEEMI00L",2,0)
 ;;12;VPE SHELL;;JAN 04, 2004;Build 8
"RTN","VEEMI00L",3,0)
 F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
"RTN","VEEMI00L",4,0)
Q Q
"RTN","VEEMI00L",5,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,4,"N")
"RTN","VEEMI00L",6,0)
 ;;=3^5^7^6^7
"RTN","VEEMI00L",7,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,5,"D")
"RTN","VEEMI00L",8,0)
 ;;=6^4^25^23
"RTN","VEEMI00L",9,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,5,"N")
"RTN","VEEMI00L",10,0)
 ;;=4^9^8^7^8
"RTN","VEEMI00L",11,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,6,"D")
"RTN","VEEMI00L",12,0)
 ;;=4^31^47^61
"RTN","VEEMI00L",13,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,6,"N")
"RTN","VEEMI00L",14,0)
 ;;=2^7^4^3^4
"RTN","VEEMI00L",15,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,7,"D")
"RTN","VEEMI00L",16,0)
 ;;=5^31^47^62
"RTN","VEEMI00L",17,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,7,"N")
"RTN","VEEMI00L",18,0)
 ;;=6^8^5^4^5
"RTN","VEEMI00L",19,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,8,"D")
"RTN","VEEMI00L",20,0)
 ;;=6^31^47^63
"RTN","VEEMI00L",21,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,8,"N")
"RTN","VEEMI00L",22,0)
 ;;=7^10^9^5^9
"RTN","VEEMI00L",23,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,9,"D")
"RTN","VEEMI00L",24,0)
 ;;=7^4^25^24
"RTN","VEEMI00L",25,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,9,"N")
"RTN","VEEMI00L",26,0)
 ;;=5^11^10^8^10
"RTN","VEEMI00L",27,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,10,"D")
"RTN","VEEMI00L",28,0)
 ;;=7^31^47^64
"RTN","VEEMI00L",29,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,10,"N")
"RTN","VEEMI00L",30,0)
 ;;=8^19^11^9^11
"RTN","VEEMI00L",31,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,11,"D")
"RTN","VEEMI00L",32,0)
 ;;=8^4^25^25
"RTN","VEEMI00L",33,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,11,"N")
"RTN","VEEMI00L",34,0)
 ;;=9^12^19^10^19
"RTN","VEEMI00L",35,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,12,"D")
"RTN","VEEMI00L",36,0)
 ;;=9^4^25^26
"RTN","VEEMI00L",37,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,12,"N")
"RTN","VEEMI00L",38,0)
 ;;=11^13^20^19^20
"RTN","VEEMI00L",39,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,13,"D")
"RTN","VEEMI00L",40,0)
 ;;=10^4^25^27
"RTN","VEEMI00L",41,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,13,"N")
"RTN","VEEMI00L",42,0)
 ;;=12^14^22^20^22
"RTN","VEEMI00L",43,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,14,"D")
"RTN","VEEMI00L",44,0)
 ;;=11^4^25^28
"RTN","VEEMI00L",45,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,14,"N")
"RTN","VEEMI00L",46,0)
 ;;=13^15^21^22^21
"RTN","VEEMI00L",47,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,15,"D")
"RTN","VEEMI00L",48,0)
 ;;=12^4^25^29
"RTN","VEEMI00L",49,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,15,"N")
"RTN","VEEMI00L",50,0)
 ;;=14^16^23^21^23
"RTN","VEEMI00L",51,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,16,"D")
"RTN","VEEMI00L",52,0)
 ;;=13^4^25^30
"RTN","VEEMI00L",53,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,16,"N")
"RTN","VEEMI00L",54,0)
 ;;=15^17^24^23^24
"RTN","VEEMI00L",55,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,17,"D")
"RTN","VEEMI00L",56,0)
 ;;=14^4^25^31
"RTN","VEEMI00L",57,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,17,"N")
"RTN","VEEMI00L",58,0)
 ;;=16^18^25^24^25
"RTN","VEEMI00L",59,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,18,"D")
"RTN","VEEMI00L",60,0)
 ;;=15^4^25^32
"RTN","VEEMI00L",61,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,18,"N")
"RTN","VEEMI00L",62,0)
 ;;=17^27^26^25^26
"RTN","VEEMI00L",63,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,19,"D")
"RTN","VEEMI00L",64,0)
 ;;=8^31^47^65
"RTN","VEEMI00L",65,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,19,"N")
"RTN","VEEMI00L",66,0)
 ;;=10^20^12^11^12
"RTN","VEEMI00L",67,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,20,"D")
"RTN","VEEMI00L",68,0)
 ;;=9^31^47^66
"RTN","VEEMI00L",69,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,20,"N")
"RTN","VEEMI00L",70,0)
 ;;=19^22^13^12^13
"RTN","VEEMI00L",71,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,21,"D")
"RTN","VEEMI00L",72,0)
 ;;=11^31^47^68
"RTN","VEEMI00L",73,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,21,"N")
"RTN","VEEMI00L",74,0)
 ;;=22^23^15^14^15
"RTN","VEEMI00L",75,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,22,"D")
"RTN","VEEMI00L",76,0)
 ;;=10^31^47^67
"RTN","VEEMI00L",77,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,22,"N")
"RTN","VEEMI00L",78,0)
 ;;=20^21^14^13^14
"RTN","VEEMI00L",79,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,23,"D")
"RTN","VEEMI00L",80,0)
 ;;=12^31^47^69
"RTN","VEEMI00L",81,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,23,"N")
"RTN","VEEMI00L",82,0)
 ;;=21^24^16^15^16
"RTN","VEEMI00L",83,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,24,"D")
"RTN","VEEMI00L",84,0)
 ;;=13^31^47^70
"RTN","VEEMI00L",85,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,24,"N")
"RTN","VEEMI00L",86,0)
 ;;=23^25^17^16^17
"RTN","VEEMI00L",87,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,25,"D")
"RTN","VEEMI00L",88,0)
 ;;=14^31^47^71
"RTN","VEEMI00L",89,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,25,"N")
"RTN","VEEMI00L",90,0)
 ;;=24^26^18^17^18
"RTN","VEEMI00L",91,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,26,"D")
"RTN","VEEMI00L",92,0)
 ;;=15^31^47^72
"RTN","VEEMI00L",93,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,26,"N")
"RTN","VEEMI00L",94,0)
 ;;=25^28^27^18^27
"RTN","VEEMI00L",95,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,27,"D")
"RTN","VEEMI00L",96,0)
 ;;=16^4^25^33
"RTN","VEEMI00L",97,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,27,"N")
"RTN","VEEMI00L",98,0)
 ;;=18^0^28^26^28
"RTN","VEEMI00L",99,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,28,"D")
"RTN","VEEMI00L",100,0)
 ;;=16^31^47^73
"RTN","VEEMI00L",101,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,28,"N")
"RTN","VEEMI00L",102,0)
 ;;=26^0^0^27^29
"RTN","VEEMI00L",103,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,29,"D")
"RTN","VEEMI00L",104,0)
 ;;=2^48^30^5
"RTN","VEEMI00L",105,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,718,29,"N")
"RTN","VEEMI00L",106,0)
 ;;=0^6^3^2^0
"RTN","VEEMI00L",107,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY",1,"FIRST")
"RTN","VEEMI00L",108,0)
 ;;=2,718
"RTN","VEEMI00L",109,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","CAP",1,1,1,718,3)
"RTN","VEEMI00L",110,0)
 ;;=
"RTN","VEEMI00L",111,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","CAP",2,1,1,718,4)
"RTN","VEEMI00L",112,0)
 ;;=
"RTN","VEEMI00L",113,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","CAP",3,1,1,718,5)
"RTN","VEEMI00L",114,0)
 ;;=
"RTN","VEEMI00L",115,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","CAP",4,1,1,718,9)
"RTN","VEEMI00L",116,0)
 ;;=
"RTN","VEEMI00L",117,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","CAP",5,1,1,718,11)
"RTN","VEEMI00L",118,0)
 ;;=
"RTN","VEEMI00L",119,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","CAP",6,1,1,718,12)
"RTN","VEEMI00L",120,0)
 ;;=
"RTN","VEEMI00L",121,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","CAP",7,1,1,718,13)
"RTN","VEEMI00L",122,0)
 ;;=
"RTN","VEEMI00L",123,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","CAP",8,1,1,718,14)
"RTN","VEEMI00L",124,0)
 ;;=
"RTN","VEEMI00L",125,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","CAP",9,1,1,718,15)
"RTN","VEEMI00L",126,0)
 ;;=
"RTN","VEEMI00L",127,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","CAP",10,1,1,718,16)
"RTN","VEEMI00L",128,0)
 ;;=
"RTN","VEEMI00L",129,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","CAP",11,1,1,718,17)
"RTN","VEEMI00L",130,0)
 ;;=
"RTN","VEEMI00L",131,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","CAP",12,1,1,718,18)
"RTN","VEEMI00L",132,0)
 ;;=
"RTN","VEEMI00L",133,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","CAP",13,1,1,718,27)
"RTN","VEEMI00L",134,0)
 ;;=
"RTN","VEEMI00L",135,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","CAP","DESCRIPTION",1,1,718,29)
"RTN","VEEMI00L",136,0)
 ;;=
"RTN","VEEMI00L",137,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","CAP","FM CALL",1,1,718,2)
"RTN","VEEMI00L",138,0)
 ;;=
"RTN","VEEMI00L",139,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","F19200.113",5,"L",1,718,29)
"RTN","VEEMI00L",140,0)
 ;;=
"RTN","VEEMI00M")
0^187^B24549315
"RTN","VEEMI00M",1,0)
VEEMI00M ; ; 04-JAN-2004
"RTN","VEEMI00M",2,0)
 ;;12;VPE SHELL;;JAN 04, 2004;Build 8
"RTN","VEEMI00M",3,0)
 F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
"RTN","VEEMI00M",4,0)
Q Q
"RTN","VEEMI00M",5,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","F19200.113",20,"L",1,718,2)
"RTN","VEEMI00M",6,0)
 ;;=
"RTN","VEEMI00M",7,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","F19200.113",21,"L",1,718,3)
"RTN","VEEMI00M",8,0)
 ;;=
"RTN","VEEMI00M",9,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","F19200.113",22,"L",1,718,4)
"RTN","VEEMI00M",10,0)
 ;;=
"RTN","VEEMI00M",11,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","F19200.113",23,"L",1,718,5)
"RTN","VEEMI00M",12,0)
 ;;=
"RTN","VEEMI00M",13,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","F19200.113",24,"L",1,718,9)
"RTN","VEEMI00M",14,0)
 ;;=
"RTN","VEEMI00M",15,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","F19200.113",25,"L",1,718,11)
"RTN","VEEMI00M",16,0)
 ;;=
"RTN","VEEMI00M",17,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","F19200.113",26,"L",1,718,12)
"RTN","VEEMI00M",18,0)
 ;;=
"RTN","VEEMI00M",19,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","F19200.113",27,"L",1,718,13)
"RTN","VEEMI00M",20,0)
 ;;=
"RTN","VEEMI00M",21,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","F19200.113",28,"L",1,718,14)
"RTN","VEEMI00M",22,0)
 ;;=
"RTN","VEEMI00M",23,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","F19200.113",29,"L",1,718,15)
"RTN","VEEMI00M",24,0)
 ;;=
"RTN","VEEMI00M",25,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","F19200.113",30,"L",1,718,16)
"RTN","VEEMI00M",26,0)
 ;;=
"RTN","VEEMI00M",27,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","F19200.113",31,"L",1,718,17)
"RTN","VEEMI00M",28,0)
 ;;=
"RTN","VEEMI00M",29,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","F19200.113",32,"L",1,718,18)
"RTN","VEEMI00M",30,0)
 ;;=
"RTN","VEEMI00M",31,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","F19200.113",33,"L",1,718,27)
"RTN","VEEMI00M",32,0)
 ;;=
"RTN","VEEMI00M",33,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","F19200.113",61,"L",1,718,6)
"RTN","VEEMI00M",34,0)
 ;;=
"RTN","VEEMI00M",35,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","F19200.113",62,"L",1,718,7)
"RTN","VEEMI00M",36,0)
 ;;=
"RTN","VEEMI00M",37,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","F19200.113",63,"L",1,718,8)
"RTN","VEEMI00M",38,0)
 ;;=
"RTN","VEEMI00M",39,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","F19200.113",64,"L",1,718,10)
"RTN","VEEMI00M",40,0)
 ;;=
"RTN","VEEMI00M",41,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","F19200.113",65,"L",1,718,19)
"RTN","VEEMI00M",42,0)
 ;;=
"RTN","VEEMI00M",43,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","F19200.113",66,"L",1,718,20)
"RTN","VEEMI00M",44,0)
 ;;=
"RTN","VEEMI00M",45,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","F19200.113",67,"L",1,718,22)
"RTN","VEEMI00M",46,0)
 ;;=
"RTN","VEEMI00M",47,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","F19200.113",68,"L",1,718,21)
"RTN","VEEMI00M",48,0)
 ;;=
"RTN","VEEMI00M",49,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","F19200.113",69,"L",1,718,23)
"RTN","VEEMI00M",50,0)
 ;;=
"RTN","VEEMI00M",51,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","F19200.113",70,"L",1,718,24)
"RTN","VEEMI00M",52,0)
 ;;=
"RTN","VEEMI00M",53,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","F19200.113",71,"L",1,718,25)
"RTN","VEEMI00M",54,0)
 ;;=
"RTN","VEEMI00M",55,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","F19200.113",72,"L",1,718,26)
"RTN","VEEMI00M",56,0)
 ;;=
"RTN","VEEMI00M",57,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","F19200.113",73,"L",1,718,28)
"RTN","VEEMI00M",58,0)
 ;;=
"RTN","VEEMI00M",59,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","X",1,0,22)
"RTN","VEEMI00M",60,0)
 ;;=CONSTRUCT & INSERT PROGRAMMER CALL           Page 1 of 1
"RTN","VEEMI00M",61,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","X",1,1,0)
"RTN","VEEMI00M",62,0)
 ;;=-------------------------------------------------------------------------------
"RTN","VEEMI00M",63,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","X",1,2,1)
"RTN","VEEMI00M",64,0)
 ;;=FM CALL:                          DESCRIPTION:
"RTN","VEEMI00M",65,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","X",1,3,31)
"RTN","VEEMI00M",66,0)
 ;;=Value:
"RTN","VEEMI00M",67,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","X",1,4,2)
"RTN","VEEMI00M",68,0)
 ;;=1
"RTN","VEEMI00M",69,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","X",1,5,2)
"RTN","VEEMI00M",70,0)
 ;;=2
"RTN","VEEMI00M",71,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","X",1,6,2)
"RTN","VEEMI00M",72,0)
 ;;=3
"RTN","VEEMI00M",73,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","X",1,7,2)
"RTN","VEEMI00M",74,0)
 ;;=4
"RTN","VEEMI00M",75,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","X",1,8,2)
"RTN","VEEMI00M",76,0)
 ;;=5
"RTN","VEEMI00M",77,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","X",1,9,2)
"RTN","VEEMI00M",78,0)
 ;;=6
"RTN","VEEMI00M",79,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","X",1,10,2)
"RTN","VEEMI00M",80,0)
 ;;=7
"RTN","VEEMI00M",81,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","X",1,11,2)
"RTN","VEEMI00M",82,0)
 ;;=8
"RTN","VEEMI00M",83,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","X",1,12,2)
"RTN","VEEMI00M",84,0)
 ;;=9
"RTN","VEEMI00M",85,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","X",1,13,1)
"RTN","VEEMI00M",86,0)
 ;;=10
"RTN","VEEMI00M",87,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","X",1,14,1)
"RTN","VEEMI00M",88,0)
 ;;=11
"RTN","VEEMI00M",89,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","X",1,15,1)
"RTN","VEEMI00M",90,0)
 ;;=12
"RTN","VEEMI00M",91,0)
 ;;^UTILITY(U,$J,"DIST(.403,",189,"AY","X",1,16,1)
"RTN","VEEMI00M",92,0)
 ;;=13
"RTN","VEEMI00M",93,0)
 ;;^UTILITY(U,$J,"DIST(.403,",252,0)
"RTN","VEEMI00M",94,0)
 ;;=VEEM PER^^^^3001224.1959^^^19200.111^0^0^1
"RTN","VEEMI00M",95,0)
 ;;^UTILITY(U,$J,"DIST(.403,",252,40,0)
"RTN","VEEMI00M",96,0)
 ;;=^.4031I^1^1
"RTN","VEEMI00M",97,0)
 ;;^UTILITY(U,$J,"DIST(.403,",252,40,1,0)
"RTN","VEEMI00M",98,0)
 ;;=1^^1,1
"RTN","VEEMI00M",99,0)
 ;;^UTILITY(U,$J,"DIST(.403,",252,40,1,1)
"RTN","VEEMI00M",100,0)
 ;;=Page 1
"RTN","VEEMI00M",101,0)
 ;;^UTILITY(U,$J,"DIST(.403,",252,40,1,40,0)
"RTN","VEEMI00M",102,0)
 ;;=^.4032IP^966^2
"RTN","VEEMI00M",103,0)
 ;;^UTILITY(U,$J,"DIST(.403,",252,40,1,40,965,0)
"RTN","VEEMI00M",104,0)
 ;;=VEEM PER HD^1^1,1^d
"RTN","VEEMI00M",105,0)
 ;;^UTILITY(U,$J,"DIST(.403,",252,40,1,40,966,0)
"RTN","VEEMI00M",106,0)
 ;;=VEEM PER EDT^2^2,1^e
"RTN","VEEMI00M",107,0)
 ;;^UTILITY(U,$J,"DIST(.403,",252,40,1,40,"AC",1,965)
"RTN","VEEMI00M",108,0)
 ;;=
"RTN","VEEMI00M",109,0)
 ;;^UTILITY(U,$J,"DIST(.403,",252,40,1,40,"AC",2,966)
"RTN","VEEMI00M",110,0)
 ;;=
"RTN","VEEMI00M",111,0)
 ;;^UTILITY(U,$J,"DIST(.403,",252,40,1,40,"B",965,965)
"RTN","VEEMI00M",112,0)
 ;;=
"RTN","VEEMI00M",113,0)
 ;;^UTILITY(U,$J,"DIST(.403,",252,40,1,40,"B",966,966)
"RTN","VEEMI00M",114,0)
 ;;=
"RTN","VEEMI00M",115,0)
 ;;^UTILITY(U,$J,"DIST(.403,",252,40,"B",1,1)
"RTN","VEEMI00M",116,0)
 ;;=
"RTN","VEEMI00M",117,0)
 ;;^UTILITY(U,$J,"DIST(.403,",252,40,"C","PAGE 1",1)
"RTN","VEEMI00M",118,0)
 ;;=
"RTN","VEEMI00M",119,0)
 ;;^UTILITY(U,$J,"DIST(.403,",252,"AY",1,0,0,"N")
"RTN","VEEMI00M",120,0)
 ;;=4,966^1,966^1,966^4,966^1,966
"RTN","VEEMI00M",121,0)
 ;;^UTILITY(U,$J,"DIST(.403,",252,"AY",1,965)
"RTN","VEEMI00M",122,0)
 ;;=0^0^19200.111^^d^^^^0
"RTN","VEEMI00M",123,0)
 ;;^UTILITY(U,$J,"DIST(.403,",252,"AY",1,966)
"RTN","VEEMI00M",124,0)
 ;;=1^0^19200.111^^e^^^^1
"RTN","VEEMI00M",125,0)
 ;;^UTILITY(U,$J,"DIST(.403,",252,"AY",1,966,1,"D")
"RTN","VEEMI00M",126,0)
 ;;=3^28^30^.01
"RTN","VEEMI00M",127,0)
 ;;^UTILITY(U,$J,"DIST(.403,",252,"AY",1,966,1,"N")
"RTN","VEEMI00M",128,0)
 ;;=0^2^2^0^2
"RTN","VEEMI00M",129,0)
 ;;^UTILITY(U,$J,"DIST(.403,",252,"AY",1,966,2,"D")
"RTN","VEEMI00M",130,0)
 ;;=4^28^5^2
"RTN","VEEMI00M",131,0)
 ;;^UTILITY(U,$J,"DIST(.403,",252,"AY",1,966,2,"N")
"RTN","VEEMI00M",132,0)
 ;;=1^3^3^1^3
"RTN","VEEMI00M",133,0)
 ;;^UTILITY(U,$J,"DIST(.403,",252,"AY",1,966,3,"D")
"RTN","VEEMI00M",134,0)
 ;;=5^28^9^3
"RTN","VEEMI00M",135,0)
 ;;^UTILITY(U,$J,"DIST(.403,",252,"AY",1,966,3,"N")
"RTN","VEEMI00M",136,0)
 ;;=2^4^4^2^4
"RTN","VEEMI00M",137,0)
 ;;^UTILITY(U,$J,"DIST(.403,",252,"AY",1,966,4,"D")
"RTN","VEEMI00M",138,0)
 ;;=6^28^3^4
"RTN","VEEMI00N")
0^188^B24982447
"RTN","VEEMI00N",1,0)
VEEMI00N ; ; 04-JAN-2004
"RTN","VEEMI00N",2,0)
 ;;12;VPE SHELL;;JAN 04, 2004;Build 8
"RTN","VEEMI00N",3,0)
 F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
"RTN","VEEMI00N",4,0)
Q Q
"RTN","VEEMI00N",5,0)
 ;;^UTILITY(U,$J,"DIST(.403,",252,"AY",1,966,4,"N")
"RTN","VEEMI00N",6,0)
 ;;=3^0^0^3^0
"RTN","VEEMI00N",7,0)
 ;;^UTILITY(U,$J,"DIST(.403,",252,"AY",1,"FIRST")
"RTN","VEEMI00N",8,0)
 ;;=1,966
"RTN","VEEMI00N",9,0)
 ;;^UTILITY(U,$J,"DIST(.403,",252,"AY","CAP","INITIALS",1,1,966,2)
"RTN","VEEMI00N",10,0)
 ;;=
"RTN","VEEMI00N",11,0)
 ;;^UTILITY(U,$J,"DIST(.403,",252,"AY","CAP","NAME",1,1,966,1)
"RTN","VEEMI00N",12,0)
 ;;=
"RTN","VEEMI00N",13,0)
 ;;^UTILITY(U,$J,"DIST(.403,",252,"AY","CAP","ROUTINE VERSIONING PROMPT",1,1,966,4)
"RTN","VEEMI00N",14,0)
 ;;=
"RTN","VEEMI00N",15,0)
 ;;^UTILITY(U,$J,"DIST(.403,",252,"AY","CAP","VPE ID",1,1,966,3)
"RTN","VEEMI00N",16,0)
 ;;=
"RTN","VEEMI00N",17,0)
 ;;^UTILITY(U,$J,"DIST(.403,",252,"AY","F19200.111",.01,"L",1,966,1)
"RTN","VEEMI00N",18,0)
 ;;=
"RTN","VEEMI00N",19,0)
 ;;^UTILITY(U,$J,"DIST(.403,",252,"AY","F19200.111",2,"L",1,966,2)
"RTN","VEEMI00N",20,0)
 ;;=
"RTN","VEEMI00N",21,0)
 ;;^UTILITY(U,$J,"DIST(.403,",252,"AY","F19200.111",3,"L",1,966,3)
"RTN","VEEMI00N",22,0)
 ;;=
"RTN","VEEMI00N",23,0)
 ;;^UTILITY(U,$J,"DIST(.403,",252,"AY","F19200.111",4,"L",1,966,4)
"RTN","VEEMI00N",24,0)
 ;;=
"RTN","VEEMI00N",25,0)
 ;;^UTILITY(U,$J,"DIST(.403,",252,"AY","X",1,0,33)
"RTN","VEEMI00N",26,0)
 ;;=Edit PERSON                       Page 1 of 1
"RTN","VEEMI00N",27,0)
 ;;^UTILITY(U,$J,"DIST(.403,",252,"AY","X",1,1,0)
"RTN","VEEMI00N",28,0)
 ;;=------------------------------------------------------------------------------
"RTN","VEEMI00N",29,0)
 ;;^UTILITY(U,$J,"DIST(.403,",252,"AY","X",1,3,22)
"RTN","VEEMI00N",30,0)
 ;;=NAME:
"RTN","VEEMI00N",31,0)
 ;;^UTILITY(U,$J,"DIST(.403,",252,"AY","X",1,3,22,"A")
"RTN","VEEMI00N",32,0)
 ;;=1;4;U
"RTN","VEEMI00N",33,0)
 ;;^UTILITY(U,$J,"DIST(.403,",252,"AY","X",1,4,18)
"RTN","VEEMI00N",34,0)
 ;;=INITIALS:
"RTN","VEEMI00N",35,0)
 ;;^UTILITY(U,$J,"DIST(.403,",252,"AY","X",1,5,20)
"RTN","VEEMI00N",36,0)
 ;;=VPE ID:
"RTN","VEEMI00N",37,0)
 ;;^UTILITY(U,$J,"DIST(.403,",252,"AY","X",1,6,1)
"RTN","VEEMI00N",38,0)
 ;;=ROUTINE VERSIONING PROMPT:
"RTN","VEEMI00N",39,0)
 ;;^UTILITY(U,$J,"DIST(.404,",715,0)
"RTN","VEEMI00N",40,0)
 ;;=VEEM PGM EDIT HD^19200.113^
"RTN","VEEMI00N",41,0)
 ;;^UTILITY(U,$J,"DIST(.404,",715,40,0)
"RTN","VEEMI00N",42,0)
 ;;=^.4044I^3^3
"RTN","VEEMI00N",43,0)
 ;;^UTILITY(U,$J,"DIST(.404,",715,40,1,0)
"RTN","VEEMI00N",44,0)
 ;;=1^EDIT PROGRAM CALL^1
"RTN","VEEMI00N",45,0)
 ;;^UTILITY(U,$J,"DIST(.404,",715,40,1,2)
"RTN","VEEMI00N",46,0)
 ;;=^^1,32
"RTN","VEEMI00N",47,0)
 ;;^UTILITY(U,$J,"DIST(.404,",715,40,2,0)
"RTN","VEEMI00N",48,0)
 ;;=2^Page 1 of 1^1
"RTN","VEEMI00N",49,0)
 ;;^UTILITY(U,$J,"DIST(.404,",715,40,2,2)
"RTN","VEEMI00N",50,0)
 ;;=^^1,68
"RTN","VEEMI00N",51,0)
 ;;^UTILITY(U,$J,"DIST(.404,",715,40,3,0)
"RTN","VEEMI00N",52,0)
 ;;=3^-------------------------------------------------------------------------------^1
"RTN","VEEMI00N",53,0)
 ;;^UTILITY(U,$J,"DIST(.404,",715,40,3,2)
"RTN","VEEMI00N",54,0)
 ;;=^^2,1
"RTN","VEEMI00N",55,0)
 ;;^UTILITY(U,$J,"DIST(.404,",715,40,"B",1,1)
"RTN","VEEMI00N",56,0)
 ;;=
"RTN","VEEMI00N",57,0)
 ;;^UTILITY(U,$J,"DIST(.404,",715,40,"B",2,2)
"RTN","VEEMI00N",58,0)
 ;;=
"RTN","VEEMI00N",59,0)
 ;;^UTILITY(U,$J,"DIST(.404,",715,40,"B",3,3)
"RTN","VEEMI00N",60,0)
 ;;=
"RTN","VEEMI00N",61,0)
 ;;^UTILITY(U,$J,"DIST(.404,",715,40,"C","---------------------------------------------------------------",3)
"RTN","VEEMI00N",62,0)
 ;;=
"RTN","VEEMI00N",63,0)
 ;;^UTILITY(U,$J,"DIST(.404,",715,40,"C","EDIT PROGRAM CALL",1)
"RTN","VEEMI00N",64,0)
 ;;=
"RTN","VEEMI00N",65,0)
 ;;^UTILITY(U,$J,"DIST(.404,",715,40,"C","PAGE 1 OF 1",2)
"RTN","VEEMI00N",66,0)
 ;;=
"RTN","VEEMI00N",67,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,0)
"RTN","VEEMI00N",68,0)
 ;;=VEEM PGM EDIT EDT^19200.113
"RTN","VEEMI00N",69,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,0)
"RTN","VEEMI00N",70,0)
 ;;=^.4044I^19^19
"RTN","VEEMI00N",71,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,1,0)
"RTN","VEEMI00N",72,0)
 ;;=1^NAME^3
"RTN","VEEMI00N",73,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,1,1)
"RTN","VEEMI00N",74,0)
 ;;=.01
"RTN","VEEMI00N",75,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,1,2)
"RTN","VEEMI00N",76,0)
 ;;=2,15^30^2,9
"RTN","VEEMI00N",77,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,2,0)
"RTN","VEEMI00N",78,0)
 ;;=2^ACTIVE^3
"RTN","VEEMI00N",79,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,2,1)
"RTN","VEEMI00N",80,0)
 ;;=2
"RTN","VEEMI00N",81,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,2,2)
"RTN","VEEMI00N",82,0)
 ;;=2,58^2^2,50
"RTN","VEEMI00N",83,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,3,0)
"RTN","VEEMI00N",84,0)
 ;;=5^IDENTIFIER^3
"RTN","VEEMI00N",85,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,3,1)
"RTN","VEEMI00N",86,0)
 ;;=3
"RTN","VEEMI00N",87,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,3,2)
"RTN","VEEMI00N",88,0)
 ;;=5,15^20^5,3
"RTN","VEEMI00N",89,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,4,0)
"RTN","VEEMI00N",90,0)
 ;;=4^TYPE^3
"RTN","VEEMI00N",91,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,4,1)
"RTN","VEEMI00N",92,0)
 ;;=4
"RTN","VEEMI00N",93,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,4,2)
"RTN","VEEMI00N",94,0)
 ;;=4,58^9^4,52
"RTN","VEEMI00N",95,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,5,0)
"RTN","VEEMI00N",96,0)
 ;;=3^DESCRIPTION^3
"RTN","VEEMI00N",97,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,5,1)
"RTN","VEEMI00N",98,0)
 ;;=5
"RTN","VEEMI00N",99,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,5,2)
"RTN","VEEMI00N",100,0)
 ;;=4,15^30^4,2
"RTN","VEEMI00N",101,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,6,0)
"RTN","VEEMI00N",102,0)
 ;;=6^ROUTINE^3
"RTN","VEEMI00N",103,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,6,1)
"RTN","VEEMI00N",104,0)
 ;;=20
"RTN","VEEMI00N",105,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,6,2)
"RTN","VEEMI00N",106,0)
 ;;=5,58^20^5,49
"RTN","VEEMI00N",107,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,7,0)
"RTN","VEEMI00N",108,0)
 ;;=7^PARAM 1^3
"RTN","VEEMI00N",109,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,7,1)
"RTN","VEEMI00N",110,0)
 ;;=21
"RTN","VEEMI00N",111,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,7,2)
"RTN","VEEMI00N",112,0)
 ;;=7,15^25^7,6
"RTN","VEEMI00N",113,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,8,0)
"RTN","VEEMI00N",114,0)
 ;;=8^PARAM 2^3
"RTN","VEEMI00N",115,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,8,1)
"RTN","VEEMI00N",116,0)
 ;;=22
"RTN","VEEMI00N",117,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,8,2)
"RTN","VEEMI00N",118,0)
 ;;=7,54^25^7,45
"RTN","VEEMI00N",119,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,9,0)
"RTN","VEEMI00N",120,0)
 ;;=9^PARAM 3^3
"RTN","VEEMI00N",121,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,9,1)
"RTN","VEEMI00N",122,0)
 ;;=23
"RTN","VEEMI00N",123,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,9,2)
"RTN","VEEMI00N",124,0)
 ;;=8,15^25^8,6
"RTN","VEEMI00N",125,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,10,0)
"RTN","VEEMI00N",126,0)
 ;;=10^PARAM 4^3
"RTN","VEEMI00N",127,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,10,1)
"RTN","VEEMI00N",128,0)
 ;;=24
"RTN","VEEMI00N",129,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,10,2)
"RTN","VEEMI00N",130,0)
 ;;=8,54^25^8,45
"RTN","VEEMI00N",131,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,11,0)
"RTN","VEEMI00N",132,0)
 ;;=11^PARAM 5^3
"RTN","VEEMI00N",133,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,11,1)
"RTN","VEEMI00N",134,0)
 ;;=25
"RTN","VEEMI00N",135,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,11,2)
"RTN","VEEMI00N",136,0)
 ;;=9,15^25^9,6
"RTN","VEEMI00N",137,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,12,0)
"RTN","VEEMI00N",138,0)
 ;;=12^PARAM 6^3
"RTN","VEEMI00N",139,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,12,1)
"RTN","VEEMI00N",140,0)
 ;;=26
"RTN","VEEMI00N",141,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,12,2)
"RTN","VEEMI00N",142,0)
 ;;=9,54^25^9,45
"RTN","VEEMI00N",143,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,13,0)
"RTN","VEEMI00N",144,0)
 ;;=13^PARAM 7^3
"RTN","VEEMI00N",145,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,13,1)
"RTN","VEEMI00N",146,0)
 ;;=27
"RTN","VEEMI00N",147,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,13,2)
"RTN","VEEMI00N",148,0)
 ;;=10,15^25^10,6
"RTN","VEEMI00N",149,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,14,0)
"RTN","VEEMI00N",150,0)
 ;;=14^PARAM 8^3
"RTN","VEEMI00N",151,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,14,1)
"RTN","VEEMI00N",152,0)
 ;;=28
"RTN","VEEMI00O")
0^189^B28258721
"RTN","VEEMI00O",1,0)
VEEMI00O ; ; 04-JAN-2004
"RTN","VEEMI00O",2,0)
 ;;12;VPE SHELL;;JAN 04, 2004;Build 8
"RTN","VEEMI00O",3,0)
 F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
"RTN","VEEMI00O",4,0)
Q Q
"RTN","VEEMI00O",5,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,14,2)
"RTN","VEEMI00O",6,0)
 ;;=10,54^25^10,45
"RTN","VEEMI00O",7,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,15,0)
"RTN","VEEMI00O",8,0)
 ;;=15^PARAM 9^3
"RTN","VEEMI00O",9,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,15,1)
"RTN","VEEMI00O",10,0)
 ;;=29
"RTN","VEEMI00O",11,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,15,2)
"RTN","VEEMI00O",12,0)
 ;;=11,15^25^11,6
"RTN","VEEMI00O",13,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,16,0)
"RTN","VEEMI00O",14,0)
 ;;=16^PARAM 10^3
"RTN","VEEMI00O",15,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,16,1)
"RTN","VEEMI00O",16,0)
 ;;=30
"RTN","VEEMI00O",17,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,16,2)
"RTN","VEEMI00O",18,0)
 ;;=11,54^25^11,44
"RTN","VEEMI00O",19,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,17,0)
"RTN","VEEMI00O",20,0)
 ;;=17^PARAM 11^3
"RTN","VEEMI00O",21,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,17,1)
"RTN","VEEMI00O",22,0)
 ;;=31
"RTN","VEEMI00O",23,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,17,2)
"RTN","VEEMI00O",24,0)
 ;;=12,15^25^12,5
"RTN","VEEMI00O",25,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,18,0)
"RTN","VEEMI00O",26,0)
 ;;=19^PARAM 13^3
"RTN","VEEMI00O",27,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,18,1)
"RTN","VEEMI00O",28,0)
 ;;=33
"RTN","VEEMI00O",29,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,18,2)
"RTN","VEEMI00O",30,0)
 ;;=13,15^25^13,5
"RTN","VEEMI00O",31,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,19,0)
"RTN","VEEMI00O",32,0)
 ;;=18^PARAM 12^3
"RTN","VEEMI00O",33,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,19,1)
"RTN","VEEMI00O",34,0)
 ;;=32
"RTN","VEEMI00O",35,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,19,2)
"RTN","VEEMI00O",36,0)
 ;;=12,54^25^12,44
"RTN","VEEMI00O",37,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,"B",1,1)
"RTN","VEEMI00O",38,0)
 ;;=
"RTN","VEEMI00O",39,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,"B",2,2)
"RTN","VEEMI00O",40,0)
 ;;=
"RTN","VEEMI00O",41,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,"B",3,5)
"RTN","VEEMI00O",42,0)
 ;;=
"RTN","VEEMI00O",43,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,"B",4,4)
"RTN","VEEMI00O",44,0)
 ;;=
"RTN","VEEMI00O",45,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,"B",5,3)
"RTN","VEEMI00O",46,0)
 ;;=
"RTN","VEEMI00O",47,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,"B",6,6)
"RTN","VEEMI00O",48,0)
 ;;=
"RTN","VEEMI00O",49,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,"B",7,7)
"RTN","VEEMI00O",50,0)
 ;;=
"RTN","VEEMI00O",51,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,"B",8,8)
"RTN","VEEMI00O",52,0)
 ;;=
"RTN","VEEMI00O",53,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,"B",9,9)
"RTN","VEEMI00O",54,0)
 ;;=
"RTN","VEEMI00O",55,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,"B",10,10)
"RTN","VEEMI00O",56,0)
 ;;=
"RTN","VEEMI00O",57,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,"B",11,11)
"RTN","VEEMI00O",58,0)
 ;;=
"RTN","VEEMI00O",59,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,"B",12,12)
"RTN","VEEMI00O",60,0)
 ;;=
"RTN","VEEMI00O",61,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,"B",13,13)
"RTN","VEEMI00O",62,0)
 ;;=
"RTN","VEEMI00O",63,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,"B",14,14)
"RTN","VEEMI00O",64,0)
 ;;=
"RTN","VEEMI00O",65,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,"B",15,15)
"RTN","VEEMI00O",66,0)
 ;;=
"RTN","VEEMI00O",67,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,"B",16,16)
"RTN","VEEMI00O",68,0)
 ;;=
"RTN","VEEMI00O",69,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,"B",17,17)
"RTN","VEEMI00O",70,0)
 ;;=
"RTN","VEEMI00O",71,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,"B",18,19)
"RTN","VEEMI00O",72,0)
 ;;=
"RTN","VEEMI00O",73,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,"B",19,18)
"RTN","VEEMI00O",74,0)
 ;;=
"RTN","VEEMI00O",75,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,"C","ACTIVE",2)
"RTN","VEEMI00O",76,0)
 ;;=
"RTN","VEEMI00O",77,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,"C","DESCRIPTION",5)
"RTN","VEEMI00O",78,0)
 ;;=
"RTN","VEEMI00O",79,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,"C","IDENTIFIER",3)
"RTN","VEEMI00O",80,0)
 ;;=
"RTN","VEEMI00O",81,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,"C","NAME",1)
"RTN","VEEMI00O",82,0)
 ;;=
"RTN","VEEMI00O",83,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,"C","PARAM 1",7)
"RTN","VEEMI00O",84,0)
 ;;=
"RTN","VEEMI00O",85,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,"C","PARAM 10",16)
"RTN","VEEMI00O",86,0)
 ;;=
"RTN","VEEMI00O",87,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,"C","PARAM 11",17)
"RTN","VEEMI00O",88,0)
 ;;=
"RTN","VEEMI00O",89,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,"C","PARAM 12",19)
"RTN","VEEMI00O",90,0)
 ;;=
"RTN","VEEMI00O",91,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,"C","PARAM 13",18)
"RTN","VEEMI00O",92,0)
 ;;=
"RTN","VEEMI00O",93,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,"C","PARAM 2",8)
"RTN","VEEMI00O",94,0)
 ;;=
"RTN","VEEMI00O",95,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,"C","PARAM 3",9)
"RTN","VEEMI00O",96,0)
 ;;=
"RTN","VEEMI00O",97,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,"C","PARAM 4",10)
"RTN","VEEMI00O",98,0)
 ;;=
"RTN","VEEMI00O",99,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,"C","PARAM 5",11)
"RTN","VEEMI00O",100,0)
 ;;=
"RTN","VEEMI00O",101,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,"C","PARAM 6",12)
"RTN","VEEMI00O",102,0)
 ;;=
"RTN","VEEMI00O",103,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,"C","PARAM 7",13)
"RTN","VEEMI00O",104,0)
 ;;=
"RTN","VEEMI00O",105,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,"C","PARAM 8",14)
"RTN","VEEMI00O",106,0)
 ;;=
"RTN","VEEMI00O",107,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,"C","PARAM 9",15)
"RTN","VEEMI00O",108,0)
 ;;=
"RTN","VEEMI00O",109,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,"C","ROUTINE",6)
"RTN","VEEMI00O",110,0)
 ;;=
"RTN","VEEMI00O",111,0)
 ;;^UTILITY(U,$J,"DIST(.404,",716,40,"C","TYPE",4)
"RTN","VEEMI00O",112,0)
 ;;=
"RTN","VEEMI00O",113,0)
 ;;^UTILITY(U,$J,"DIST(.404,",717,0)
"RTN","VEEMI00O",114,0)
 ;;=VEEM PGM CALL HD^19200.113^
"RTN","VEEMI00O",115,0)
 ;;^UTILITY(U,$J,"DIST(.404,",717,40,0)
"RTN","VEEMI00O",116,0)
 ;;=^.4044I^6^5
"RTN","VEEMI00O",117,0)
 ;;^UTILITY(U,$J,"DIST(.404,",717,40,1,0)
"RTN","VEEMI00O",118,0)
 ;;=1^CONSTRUCT & INSERT PROGRAMMER CALL^1
"RTN","VEEMI00O",119,0)
 ;;^UTILITY(U,$J,"DIST(.404,",717,40,1,2)
"RTN","VEEMI00O",120,0)
 ;;=^^1,23
"RTN","VEEMI00O",121,0)
 ;;^UTILITY(U,$J,"DIST(.404,",717,40,2,0)
"RTN","VEEMI00O",122,0)
 ;;=2^Page 1 of 1^1
"RTN","VEEMI00O",123,0)
 ;;^UTILITY(U,$J,"DIST(.404,",717,40,2,2)
"RTN","VEEMI00O",124,0)
 ;;=^^1,68
"RTN","VEEMI00O",125,0)
 ;;^UTILITY(U,$J,"DIST(.404,",717,40,4,0)
"RTN","VEEMI00O",126,0)
 ;;=4^!M^1
"RTN","VEEMI00O",127,0)
 ;;^UTILITY(U,$J,"DIST(.404,",717,40,4,.1)
"RTN","VEEMI00O",128,0)
 ;;=S Y=$S($P($G(^VEE(19200.113,DA,0)),U,4)'="v":"Parameter:",1:"Variable:")
"RTN","VEEMI00O",129,0)
 ;;^UTILITY(U,$J,"DIST(.404,",717,40,4,2)
"RTN","VEEMI00O",130,0)
 ;;=^^4,5
"RTN","VEEMI00O",131,0)
 ;;^UTILITY(U,$J,"DIST(.404,",717,40,5,0)
"RTN","VEEMI00O",132,0)
 ;;=5^Value:^1
"RTN","VEEMI00O",133,0)
 ;;^UTILITY(U,$J,"DIST(.404,",717,40,5,2)
"RTN","VEEMI00O",134,0)
 ;;=^^4,32
"RTN","VEEMI00O",135,0)
 ;;^UTILITY(U,$J,"DIST(.404,",717,40,6,0)
"RTN","VEEMI00O",136,0)
 ;;=3^-------------------------------------------------------------------------------^1
"RTN","VEEMI00O",137,0)
 ;;^UTILITY(U,$J,"DIST(.404,",717,40,6,2)
"RTN","VEEMI00O",138,0)
 ;;=^^2,1
"RTN","VEEMI00O",139,0)
 ;;^UTILITY(U,$J,"DIST(.404,",717,40,"B",1,1)
"RTN","VEEMI00O",140,0)
 ;;=
"RTN","VEEMI00O",141,0)
 ;;^UTILITY(U,$J,"DIST(.404,",717,40,"B",2,2)
"RTN","VEEMI00O",142,0)
 ;;=
"RTN","VEEMI00O",143,0)
 ;;^UTILITY(U,$J,"DIST(.404,",717,40,"B",3,6)
"RTN","VEEMI00O",144,0)
 ;;=
"RTN","VEEMI00O",145,0)
 ;;^UTILITY(U,$J,"DIST(.404,",717,40,"B",4,4)
"RTN","VEEMI00O",146,0)
 ;;=
"RTN","VEEMI00O",147,0)
 ;;^UTILITY(U,$J,"DIST(.404,",717,40,"B",5,5)
"RTN","VEEMI00O",148,0)
 ;;=
"RTN","VEEMI00O",149,0)
 ;;^UTILITY(U,$J,"DIST(.404,",717,40,"C","---------------------------------------------------------------",6)
"RTN","VEEMI00O",150,0)
 ;;=
"RTN","VEEMI00O",151,0)
 ;;^UTILITY(U,$J,"DIST(.404,",717,40,"C","CONSTRUCT & INSERT PROGRAMMER CALL",1)
"RTN","VEEMI00O",152,0)
 ;;=
"RTN","VEEMI00O",153,0)
 ;;^UTILITY(U,$J,"DIST(.404,",717,40,"C","PAGE 1 OF 1",2)
"RTN","VEEMI00O",154,0)
 ;;=
"RTN","VEEMI00O",155,0)
 ;;^UTILITY(U,$J,"DIST(.404,",717,40,"C","VALUE:",5)
"RTN","VEEMI00O",156,0)
 ;;=
"RTN","VEEMI00O",157,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,0)
"RTN","VEEMI00O",158,0)
 ;;=VEEM PGM CALL EDT^19200.113
"RTN","VEEMI00O",159,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,0)
"RTN","VEEMI00O",160,0)
 ;;=^.4044I^29^28
"RTN","VEEMI00P")
0^190^B27594566
"RTN","VEEMI00P",1,0)
VEEMI00P ; ; 04-JAN-2004
"RTN","VEEMI00P",2,0)
 ;;12;VPE SHELL;;JAN 04, 2004;Build 8
"RTN","VEEMI00P",3,0)
 F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
"RTN","VEEMI00P",4,0)
Q Q
"RTN","VEEMI00P",5,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,2,0)
"RTN","VEEMI00P",6,0)
 ;;=1^FM CALL^3
"RTN","VEEMI00P",7,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,2,1)
"RTN","VEEMI00P",8,0)
 ;;=20
"RTN","VEEMI00P",9,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,2,2)
"RTN","VEEMI00P",10,0)
 ;;=2,11^20^2,2
"RTN","VEEMI00P",11,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,2,4)
"RTN","VEEMI00P",12,0)
 ;;=^^^1
"RTN","VEEMI00P",13,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,3,0)
"RTN","VEEMI00P",14,0)
 ;;=3^1^3
"RTN","VEEMI00P",15,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,3,1)
"RTN","VEEMI00P",16,0)
 ;;=21
"RTN","VEEMI00P",17,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,3,2)
"RTN","VEEMI00P",18,0)
 ;;=4,5^25^4,3^1
"RTN","VEEMI00P",19,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,3,4)
"RTN","VEEMI00P",20,0)
 ;;=^^^1
"RTN","VEEMI00P",21,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,4,0)
"RTN","VEEMI00P",22,0)
 ;;=5^2^3
"RTN","VEEMI00P",23,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,4,1)
"RTN","VEEMI00P",24,0)
 ;;=22
"RTN","VEEMI00P",25,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,4,2)
"RTN","VEEMI00P",26,0)
 ;;=5,5^25^5,3^1
"RTN","VEEMI00P",27,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,4,4)
"RTN","VEEMI00P",28,0)
 ;;=^^^1
"RTN","VEEMI00P",29,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,5,0)
"RTN","VEEMI00P",30,0)
 ;;=7^3^3
"RTN","VEEMI00P",31,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,5,1)
"RTN","VEEMI00P",32,0)
 ;;=23
"RTN","VEEMI00P",33,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,5,2)
"RTN","VEEMI00P",34,0)
 ;;=6,5^25^6,3^1
"RTN","VEEMI00P",35,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,5,4)
"RTN","VEEMI00P",36,0)
 ;;=^^^1
"RTN","VEEMI00P",37,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,6,0)
"RTN","VEEMI00P",38,0)
 ;;=4^^3^^VALUE1
"RTN","VEEMI00P",39,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,6,1)
"RTN","VEEMI00P",40,0)
 ;;=61
"RTN","VEEMI00P",41,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,6,2)
"RTN","VEEMI00P",42,0)
 ;;=4,32^47
"RTN","VEEMI00P",43,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,6,3)
"RTN","VEEMI00P",44,0)
 ;;=!M
"RTN","VEEMI00P",45,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,6,3.1)
"RTN","VEEMI00P",46,0)
 ;;=D DEFAULT^%ZVEMRID(1)
"RTN","VEEMI00P",47,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,6,11)
"RTN","VEEMI00P",48,0)
 ;;=D HELP^%ZVEMRID(1)
"RTN","VEEMI00P",49,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,6,14)
"RTN","VEEMI00P",50,0)
 ;;=Q:X=""  Q:"Hh"'[X  D EXTHELP^%ZVEMRIE(1)
"RTN","VEEMI00P",51,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,7,0)
"RTN","VEEMI00P",52,0)
 ;;=6^^3
"RTN","VEEMI00P",53,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,7,1)
"RTN","VEEMI00P",54,0)
 ;;=62
"RTN","VEEMI00P",55,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,7,2)
"RTN","VEEMI00P",56,0)
 ;;=5,32^47
"RTN","VEEMI00P",57,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,7,3)
"RTN","VEEMI00P",58,0)
 ;;=!M
"RTN","VEEMI00P",59,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,7,3.1)
"RTN","VEEMI00P",60,0)
 ;;=D DEFAULT^%ZVEMRID(2)
"RTN","VEEMI00P",61,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,7,11)
"RTN","VEEMI00P",62,0)
 ;;=D HELP^%ZVEMRID(2)
"RTN","VEEMI00P",63,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,7,14)
"RTN","VEEMI00P",64,0)
 ;;=Q:X=""  Q:"Hh"'[X  D EXTHELP^%ZVEMRIE(2)
"RTN","VEEMI00P",65,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,8,0)
"RTN","VEEMI00P",66,0)
 ;;=8^^3
"RTN","VEEMI00P",67,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,8,1)
"RTN","VEEMI00P",68,0)
 ;;=63
"RTN","VEEMI00P",69,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,8,2)
"RTN","VEEMI00P",70,0)
 ;;=6,32^47
"RTN","VEEMI00P",71,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,8,3)
"RTN","VEEMI00P",72,0)
 ;;=!M
"RTN","VEEMI00P",73,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,8,3.1)
"RTN","VEEMI00P",74,0)
 ;;=D DEFAULT^%ZVEMRID(3)
"RTN","VEEMI00P",75,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,8,11)
"RTN","VEEMI00P",76,0)
 ;;=D HELP^%ZVEMRID(3)
"RTN","VEEMI00P",77,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,8,14)
"RTN","VEEMI00P",78,0)
 ;;=Q:X=""  Q:"Hh"'[X  D EXTHELP^%ZVEMRIE(3)
"RTN","VEEMI00P",79,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,9,0)
"RTN","VEEMI00P",80,0)
 ;;=9^4^3
"RTN","VEEMI00P",81,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,9,1)
"RTN","VEEMI00P",82,0)
 ;;=24
"RTN","VEEMI00P",83,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,9,2)
"RTN","VEEMI00P",84,0)
 ;;=7,5^25^7,3^1
"RTN","VEEMI00P",85,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,9,4)
"RTN","VEEMI00P",86,0)
 ;;=^^^1
"RTN","VEEMI00P",87,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,10,0)
"RTN","VEEMI00P",88,0)
 ;;=10^^3
"RTN","VEEMI00P",89,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,10,1)
"RTN","VEEMI00P",90,0)
 ;;=64
"RTN","VEEMI00P",91,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,10,2)
"RTN","VEEMI00P",92,0)
 ;;=7,32^47
"RTN","VEEMI00P",93,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,10,3)
"RTN","VEEMI00P",94,0)
 ;;=!M
"RTN","VEEMI00P",95,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,10,3.1)
"RTN","VEEMI00P",96,0)
 ;;=D DEFAULT^%ZVEMRID(4)
"RTN","VEEMI00P",97,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,10,11)
"RTN","VEEMI00P",98,0)
 ;;=D HELP^%ZVEMRID(4)
"RTN","VEEMI00P",99,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,10,14)
"RTN","VEEMI00P",100,0)
 ;;=Q:X=""  Q:"Hh"'[X  D EXTHELP^%ZVEMRIE(4)
"RTN","VEEMI00P",101,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,11,0)
"RTN","VEEMI00P",102,0)
 ;;=11^5^3
"RTN","VEEMI00P",103,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,11,1)
"RTN","VEEMI00P",104,0)
 ;;=25
"RTN","VEEMI00P",105,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,11,2)
"RTN","VEEMI00P",106,0)
 ;;=8,5^25^8,3^1
"RTN","VEEMI00P",107,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,11,4)
"RTN","VEEMI00P",108,0)
 ;;=^^^1
"RTN","VEEMI00P",109,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,12,0)
"RTN","VEEMI00P",110,0)
 ;;=13^6^3
"RTN","VEEMI00P",111,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,12,1)
"RTN","VEEMI00P",112,0)
 ;;=26
"RTN","VEEMI00P",113,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,12,2)
"RTN","VEEMI00P",114,0)
 ;;=9,5^25^9,3^1
"RTN","VEEMI00P",115,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,12,4)
"RTN","VEEMI00P",116,0)
 ;;=^^^1
"RTN","VEEMI00P",117,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,13,0)
"RTN","VEEMI00P",118,0)
 ;;=15^7^3
"RTN","VEEMI00P",119,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,13,1)
"RTN","VEEMI00P",120,0)
 ;;=27
"RTN","VEEMI00P",121,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,13,2)
"RTN","VEEMI00P",122,0)
 ;;=10,5^25^10,3^1
"RTN","VEEMI00P",123,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,13,4)
"RTN","VEEMI00P",124,0)
 ;;=^^^1
"RTN","VEEMI00P",125,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,14,0)
"RTN","VEEMI00P",126,0)
 ;;=17^8^3
"RTN","VEEMI00P",127,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,14,1)
"RTN","VEEMI00P",128,0)
 ;;=28
"RTN","VEEMI00P",129,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,14,2)
"RTN","VEEMI00P",130,0)
 ;;=11,5^25^11,3^1
"RTN","VEEMI00P",131,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,14,4)
"RTN","VEEMI00P",132,0)
 ;;=^^^1
"RTN","VEEMI00P",133,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,15,0)
"RTN","VEEMI00P",134,0)
 ;;=19^9^3
"RTN","VEEMI00P",135,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,15,1)
"RTN","VEEMI00P",136,0)
 ;;=29
"RTN","VEEMI00P",137,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,15,2)
"RTN","VEEMI00P",138,0)
 ;;=12,5^25^12,3^1
"RTN","VEEMI00P",139,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,15,4)
"RTN","VEEMI00P",140,0)
 ;;=^^^1
"RTN","VEEMI00P",141,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,16,0)
"RTN","VEEMI00P",142,0)
 ;;=21^10^3
"RTN","VEEMI00P",143,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,16,1)
"RTN","VEEMI00P",144,0)
 ;;=30
"RTN","VEEMI00P",145,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,16,2)
"RTN","VEEMI00P",146,0)
 ;;=13,5^25^13,2^1
"RTN","VEEMI00P",147,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,16,4)
"RTN","VEEMI00P",148,0)
 ;;=^^^1
"RTN","VEEMI00P",149,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,17,0)
"RTN","VEEMI00P",150,0)
 ;;=23^11^3
"RTN","VEEMI00P",151,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,17,1)
"RTN","VEEMI00P",152,0)
 ;;=31
"RTN","VEEMI00P",153,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,17,2)
"RTN","VEEMI00P",154,0)
 ;;=14,5^25^14,2^1
"RTN","VEEMI00P",155,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,17,4)
"RTN","VEEMI00P",156,0)
 ;;=^^^1
"RTN","VEEMI00P",157,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,18,0)
"RTN","VEEMI00P",158,0)
 ;;=25^12^3
"RTN","VEEMI00P",159,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,18,1)
"RTN","VEEMI00P",160,0)
 ;;=32
"RTN","VEEMI00P",161,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,18,2)
"RTN","VEEMI00P",162,0)
 ;;=15,5^25^15,2^1
"RTN","VEEMI00P",163,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,18,4)
"RTN","VEEMI00P",164,0)
 ;;=^^^1
"RTN","VEEMI00P",165,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,19,0)
"RTN","VEEMI00P",166,0)
 ;;=12^^3
"RTN","VEEMI00P",167,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,19,1)
"RTN","VEEMI00P",168,0)
 ;;=65
"RTN","VEEMI00Q")
0^191^B26140851
"RTN","VEEMI00Q",1,0)
VEEMI00Q ; ; 04-JAN-2004
"RTN","VEEMI00Q",2,0)
 ;;12;VPE SHELL;;JAN 04, 2004;Build 8
"RTN","VEEMI00Q",3,0)
 F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
"RTN","VEEMI00Q",4,0)
Q Q
"RTN","VEEMI00Q",5,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,19,2)
"RTN","VEEMI00Q",6,0)
 ;;=8,32^47
"RTN","VEEMI00Q",7,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,19,3)
"RTN","VEEMI00Q",8,0)
 ;;=!M
"RTN","VEEMI00Q",9,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,19,3.1)
"RTN","VEEMI00Q",10,0)
 ;;=D DEFAULT^%ZVEMRID(5)
"RTN","VEEMI00Q",11,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,19,11)
"RTN","VEEMI00Q",12,0)
 ;;=D HELP^%ZVEMRID(5)
"RTN","VEEMI00Q",13,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,19,14)
"RTN","VEEMI00Q",14,0)
 ;;=Q:X=""  Q:"Hh"'[X  D EXTHELP^%ZVEMRIE(5)
"RTN","VEEMI00Q",15,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,20,0)
"RTN","VEEMI00Q",16,0)
 ;;=14^^3
"RTN","VEEMI00Q",17,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,20,1)
"RTN","VEEMI00Q",18,0)
 ;;=66
"RTN","VEEMI00Q",19,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,20,2)
"RTN","VEEMI00Q",20,0)
 ;;=9,32^47
"RTN","VEEMI00Q",21,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,20,3)
"RTN","VEEMI00Q",22,0)
 ;;=!M
"RTN","VEEMI00Q",23,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,20,3.1)
"RTN","VEEMI00Q",24,0)
 ;;=D DEFAULT^%ZVEMRID(6)
"RTN","VEEMI00Q",25,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,20,11)
"RTN","VEEMI00Q",26,0)
 ;;=D HELP^%ZVEMRID(6)
"RTN","VEEMI00Q",27,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,20,14)
"RTN","VEEMI00Q",28,0)
 ;;=Q:X=""  Q:"Hh"'[X  D EXTHELP^%ZVEMRIE(6)
"RTN","VEEMI00Q",29,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,21,0)
"RTN","VEEMI00Q",30,0)
 ;;=18^^3
"RTN","VEEMI00Q",31,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,21,1)
"RTN","VEEMI00Q",32,0)
 ;;=68
"RTN","VEEMI00Q",33,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,21,2)
"RTN","VEEMI00Q",34,0)
 ;;=11,32^47
"RTN","VEEMI00Q",35,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,21,3)
"RTN","VEEMI00Q",36,0)
 ;;=!M
"RTN","VEEMI00Q",37,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,21,3.1)
"RTN","VEEMI00Q",38,0)
 ;;=D DEFAULT^%ZVEMRID(8)
"RTN","VEEMI00Q",39,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,21,11)
"RTN","VEEMI00Q",40,0)
 ;;=D HELP^%ZVEMRID(8)
"RTN","VEEMI00Q",41,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,21,14)
"RTN","VEEMI00Q",42,0)
 ;;=Q:X=""  Q:"Hh"'[X  D EXTHELP^%ZVEMRIE(8)
"RTN","VEEMI00Q",43,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,22,0)
"RTN","VEEMI00Q",44,0)
 ;;=16^^3
"RTN","VEEMI00Q",45,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,22,1)
"RTN","VEEMI00Q",46,0)
 ;;=67
"RTN","VEEMI00Q",47,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,22,2)
"RTN","VEEMI00Q",48,0)
 ;;=10,32^47
"RTN","VEEMI00Q",49,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,22,3)
"RTN","VEEMI00Q",50,0)
 ;;=!M
"RTN","VEEMI00Q",51,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,22,3.1)
"RTN","VEEMI00Q",52,0)
 ;;=D DEFAULT^%ZVEMRID(7)
"RTN","VEEMI00Q",53,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,22,11)
"RTN","VEEMI00Q",54,0)
 ;;=D HELP^%ZVEMRID(7)
"RTN","VEEMI00Q",55,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,22,14)
"RTN","VEEMI00Q",56,0)
 ;;=Q:X=""  Q:"Hh"'[X  D EXTHELP^%ZVEMRIE(7)
"RTN","VEEMI00Q",57,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,23,0)
"RTN","VEEMI00Q",58,0)
 ;;=20^^3
"RTN","VEEMI00Q",59,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,23,1)
"RTN","VEEMI00Q",60,0)
 ;;=69
"RTN","VEEMI00Q",61,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,23,2)
"RTN","VEEMI00Q",62,0)
 ;;=12,32^47
"RTN","VEEMI00Q",63,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,23,3)
"RTN","VEEMI00Q",64,0)
 ;;=!M
"RTN","VEEMI00Q",65,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,23,3.1)
"RTN","VEEMI00Q",66,0)
 ;;=D DEFAULT^%ZVEMRID(9)
"RTN","VEEMI00Q",67,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,23,11)
"RTN","VEEMI00Q",68,0)
 ;;=D HELP^%ZVEMRID(9)
"RTN","VEEMI00Q",69,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,23,14)
"RTN","VEEMI00Q",70,0)
 ;;=Q:X=""  Q:"Hh"'[X  D EXTHELP^%ZVEMRIE(9)
"RTN","VEEMI00Q",71,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,24,0)
"RTN","VEEMI00Q",72,0)
 ;;=22^^3
"RTN","VEEMI00Q",73,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,24,1)
"RTN","VEEMI00Q",74,0)
 ;;=70
"RTN","VEEMI00Q",75,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,24,2)
"RTN","VEEMI00Q",76,0)
 ;;=13,32^47
"RTN","VEEMI00Q",77,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,24,3)
"RTN","VEEMI00Q",78,0)
 ;;=!M
"RTN","VEEMI00Q",79,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,24,3.1)
"RTN","VEEMI00Q",80,0)
 ;;=D DEFAULT^%ZVEMRID(10)
"RTN","VEEMI00Q",81,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,24,11)
"RTN","VEEMI00Q",82,0)
 ;;=D HELP^%ZVEMRID(10)
"RTN","VEEMI00Q",83,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,24,14)
"RTN","VEEMI00Q",84,0)
 ;;=Q:X=""  Q:"Hh"'[X  D EXTHELP^%ZVEMRIE(10)
"RTN","VEEMI00Q",85,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,25,0)
"RTN","VEEMI00Q",86,0)
 ;;=24^^3
"RTN","VEEMI00Q",87,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,25,1)
"RTN","VEEMI00Q",88,0)
 ;;=71
"RTN","VEEMI00Q",89,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,25,2)
"RTN","VEEMI00Q",90,0)
 ;;=14,32^47
"RTN","VEEMI00Q",91,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,25,3)
"RTN","VEEMI00Q",92,0)
 ;;=!M
"RTN","VEEMI00Q",93,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,25,3.1)
"RTN","VEEMI00Q",94,0)
 ;;=D DEFAULT^%ZVEMRID(11)
"RTN","VEEMI00Q",95,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,25,11)
"RTN","VEEMI00Q",96,0)
 ;;=D HELP^%ZVEMRID(11)
"RTN","VEEMI00Q",97,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,25,14)
"RTN","VEEMI00Q",98,0)
 ;;=Q:X=""  Q:"Hh"'[X  D EXTHELP^%ZVEMRIE(11)
"RTN","VEEMI00Q",99,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,26,0)
"RTN","VEEMI00Q",100,0)
 ;;=26^^3
"RTN","VEEMI00Q",101,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,26,1)
"RTN","VEEMI00Q",102,0)
 ;;=72
"RTN","VEEMI00Q",103,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,26,2)
"RTN","VEEMI00Q",104,0)
 ;;=15,32^47
"RTN","VEEMI00Q",105,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,26,3)
"RTN","VEEMI00Q",106,0)
 ;;=!M
"RTN","VEEMI00Q",107,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,26,3.1)
"RTN","VEEMI00Q",108,0)
 ;;=D DEFAULT^%ZVEMRID(12)
"RTN","VEEMI00Q",109,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,26,11)
"RTN","VEEMI00Q",110,0)
 ;;=D HELP^%ZVEMRID(12)
"RTN","VEEMI00Q",111,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,26,14)
"RTN","VEEMI00Q",112,0)
 ;;=Q:X=""  Q:"Hh"'[X  D EXTHELP^%ZVEMRIE(12)
"RTN","VEEMI00Q",113,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,27,0)
"RTN","VEEMI00Q",114,0)
 ;;=27^13^3
"RTN","VEEMI00Q",115,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,27,1)
"RTN","VEEMI00Q",116,0)
 ;;=33
"RTN","VEEMI00Q",117,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,27,2)
"RTN","VEEMI00Q",118,0)
 ;;=16,5^25^16,2^1
"RTN","VEEMI00Q",119,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,27,4)
"RTN","VEEMI00Q",120,0)
 ;;=^^^1
"RTN","VEEMI00Q",121,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,28,0)
"RTN","VEEMI00Q",122,0)
 ;;=28^^3
"RTN","VEEMI00Q",123,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,28,1)
"RTN","VEEMI00Q",124,0)
 ;;=73
"RTN","VEEMI00Q",125,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,28,2)
"RTN","VEEMI00Q",126,0)
 ;;=16,32^47
"RTN","VEEMI00Q",127,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,28,3)
"RTN","VEEMI00Q",128,0)
 ;;=!M
"RTN","VEEMI00Q",129,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,28,3.1)
"RTN","VEEMI00Q",130,0)
 ;;=D DEFAULT^%ZVEMRID(13)
"RTN","VEEMI00Q",131,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,28,11)
"RTN","VEEMI00Q",132,0)
 ;;=D HELP^%ZVEMRID(13)
"RTN","VEEMI00Q",133,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,28,14)
"RTN","VEEMI00Q",134,0)
 ;;=Q:X=""  Q:"Hh"'[X  D EXTHELP^%ZVEMRIE(13)
"RTN","VEEMI00Q",135,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,29,0)
"RTN","VEEMI00Q",136,0)
 ;;=29^DESCRIPTION^3
"RTN","VEEMI00Q",137,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,29,1)
"RTN","VEEMI00Q",138,0)
 ;;=5
"RTN","VEEMI00Q",139,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,29,2)
"RTN","VEEMI00Q",140,0)
 ;;=2,49^30^2,36
"RTN","VEEMI00Q",141,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,29,4)
"RTN","VEEMI00Q",142,0)
 ;;=^^^1
"RTN","VEEMI00Q",143,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,"B",1,2)
"RTN","VEEMI00Q",144,0)
 ;;=
"RTN","VEEMI00Q",145,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,"B",3,3)
"RTN","VEEMI00Q",146,0)
 ;;=
"RTN","VEEMI00Q",147,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,"B",4,6)
"RTN","VEEMI00Q",148,0)
 ;;=
"RTN","VEEMI00Q",149,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,"B",5,4)
"RTN","VEEMI00Q",150,0)
 ;;=
"RTN","VEEMI00Q",151,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,"B",6,7)
"RTN","VEEMI00Q",152,0)
 ;;=
"RTN","VEEMI00Q",153,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,"B",7,5)
"RTN","VEEMI00Q",154,0)
 ;;=
"RTN","VEEMI00Q",155,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,"B",8,8)
"RTN","VEEMI00Q",156,0)
 ;;=
"RTN","VEEMI00R")
0^192^B29582470
"RTN","VEEMI00R",1,0)
VEEMI00R ; ; 04-JAN-2004
"RTN","VEEMI00R",2,0)
 ;;12;VPE SHELL;;JAN 04, 2004;Build 8
"RTN","VEEMI00R",3,0)
 F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
"RTN","VEEMI00R",4,0)
Q Q
"RTN","VEEMI00R",5,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,"B",9,9)
"RTN","VEEMI00R",6,0)
 ;;=
"RTN","VEEMI00R",7,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,"B",10,10)
"RTN","VEEMI00R",8,0)
 ;;=
"RTN","VEEMI00R",9,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,"B",11,11)
"RTN","VEEMI00R",10,0)
 ;;=
"RTN","VEEMI00R",11,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,"B",12,19)
"RTN","VEEMI00R",12,0)
 ;;=
"RTN","VEEMI00R",13,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,"B",13,12)
"RTN","VEEMI00R",14,0)
 ;;=
"RTN","VEEMI00R",15,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,"B",14,20)
"RTN","VEEMI00R",16,0)
 ;;=
"RTN","VEEMI00R",17,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,"B",15,13)
"RTN","VEEMI00R",18,0)
 ;;=
"RTN","VEEMI00R",19,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,"B",16,22)
"RTN","VEEMI00R",20,0)
 ;;=
"RTN","VEEMI00R",21,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,"B",17,14)
"RTN","VEEMI00R",22,0)
 ;;=
"RTN","VEEMI00R",23,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,"B",18,21)
"RTN","VEEMI00R",24,0)
 ;;=
"RTN","VEEMI00R",25,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,"B",19,15)
"RTN","VEEMI00R",26,0)
 ;;=
"RTN","VEEMI00R",27,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,"B",20,23)
"RTN","VEEMI00R",28,0)
 ;;=
"RTN","VEEMI00R",29,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,"B",21,16)
"RTN","VEEMI00R",30,0)
 ;;=
"RTN","VEEMI00R",31,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,"B",22,24)
"RTN","VEEMI00R",32,0)
 ;;=
"RTN","VEEMI00R",33,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,"B",23,17)
"RTN","VEEMI00R",34,0)
 ;;=
"RTN","VEEMI00R",35,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,"B",24,25)
"RTN","VEEMI00R",36,0)
 ;;=
"RTN","VEEMI00R",37,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,"B",25,18)
"RTN","VEEMI00R",38,0)
 ;;=
"RTN","VEEMI00R",39,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,"B",26,26)
"RTN","VEEMI00R",40,0)
 ;;=
"RTN","VEEMI00R",41,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,"B",27,27)
"RTN","VEEMI00R",42,0)
 ;;=
"RTN","VEEMI00R",43,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,"B",28,28)
"RTN","VEEMI00R",44,0)
 ;;=
"RTN","VEEMI00R",45,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,"B",29,29)
"RTN","VEEMI00R",46,0)
 ;;=
"RTN","VEEMI00R",47,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,"C",1,3)
"RTN","VEEMI00R",48,0)
 ;;=
"RTN","VEEMI00R",49,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,"C",2,4)
"RTN","VEEMI00R",50,0)
 ;;=
"RTN","VEEMI00R",51,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,"C",3,5)
"RTN","VEEMI00R",52,0)
 ;;=
"RTN","VEEMI00R",53,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,"C",4,9)
"RTN","VEEMI00R",54,0)
 ;;=
"RTN","VEEMI00R",55,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,"C",5,11)
"RTN","VEEMI00R",56,0)
 ;;=
"RTN","VEEMI00R",57,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,"C",6,12)
"RTN","VEEMI00R",58,0)
 ;;=
"RTN","VEEMI00R",59,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,"C",7,13)
"RTN","VEEMI00R",60,0)
 ;;=
"RTN","VEEMI00R",61,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,"C",8,14)
"RTN","VEEMI00R",62,0)
 ;;=
"RTN","VEEMI00R",63,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,"C",9,15)
"RTN","VEEMI00R",64,0)
 ;;=
"RTN","VEEMI00R",65,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,"C",10,16)
"RTN","VEEMI00R",66,0)
 ;;=
"RTN","VEEMI00R",67,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,"C",11,17)
"RTN","VEEMI00R",68,0)
 ;;=
"RTN","VEEMI00R",69,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,"C",12,18)
"RTN","VEEMI00R",70,0)
 ;;=
"RTN","VEEMI00R",71,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,"C",13,27)
"RTN","VEEMI00R",72,0)
 ;;=
"RTN","VEEMI00R",73,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,"C","DESCRIPTION",29)
"RTN","VEEMI00R",74,0)
 ;;=
"RTN","VEEMI00R",75,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,"C","FM CALL",2)
"RTN","VEEMI00R",76,0)
 ;;=
"RTN","VEEMI00R",77,0)
 ;;^UTILITY(U,$J,"DIST(.404,",718,40,"D","VALUE1",6)
"RTN","VEEMI00R",78,0)
 ;;=
"RTN","VEEMI00R",79,0)
 ;;^UTILITY(U,$J,"DIST(.404,",965,0)
"RTN","VEEMI00R",80,0)
 ;;=VEEM PER HD^19200.111^
"RTN","VEEMI00R",81,0)
 ;;^UTILITY(U,$J,"DIST(.404,",965,40,0)
"RTN","VEEMI00R",82,0)
 ;;=^.4044I^3^3
"RTN","VEEMI00R",83,0)
 ;;^UTILITY(U,$J,"DIST(.404,",965,40,1,0)
"RTN","VEEMI00R",84,0)
 ;;=1^Edit PERSON^1
"RTN","VEEMI00R",85,0)
 ;;^UTILITY(U,$J,"DIST(.404,",965,40,1,2)
"RTN","VEEMI00R",86,0)
 ;;=^^1,34
"RTN","VEEMI00R",87,0)
 ;;^UTILITY(U,$J,"DIST(.404,",965,40,2,0)
"RTN","VEEMI00R",88,0)
 ;;=2^Page 1 of 1^1
"RTN","VEEMI00R",89,0)
 ;;^UTILITY(U,$J,"DIST(.404,",965,40,2,2)
"RTN","VEEMI00R",90,0)
 ;;=^^1,68
"RTN","VEEMI00R",91,0)
 ;;^UTILITY(U,$J,"DIST(.404,",965,40,3,0)
"RTN","VEEMI00R",92,0)
 ;;=3^------------------------------------------------------------------------------^1
"RTN","VEEMI00R",93,0)
 ;;^UTILITY(U,$J,"DIST(.404,",965,40,3,2)
"RTN","VEEMI00R",94,0)
 ;;=^^2,1
"RTN","VEEMI00R",95,0)
 ;;^UTILITY(U,$J,"DIST(.404,",965,40,"B",1,1)
"RTN","VEEMI00R",96,0)
 ;;=
"RTN","VEEMI00R",97,0)
 ;;^UTILITY(U,$J,"DIST(.404,",965,40,"B",2,2)
"RTN","VEEMI00R",98,0)
 ;;=
"RTN","VEEMI00R",99,0)
 ;;^UTILITY(U,$J,"DIST(.404,",965,40,"B",3,3)
"RTN","VEEMI00R",100,0)
 ;;=
"RTN","VEEMI00R",101,0)
 ;;^UTILITY(U,$J,"DIST(.404,",965,40,"C","---------------------------------------------------------------",3)
"RTN","VEEMI00R",102,0)
 ;;=
"RTN","VEEMI00R",103,0)
 ;;^UTILITY(U,$J,"DIST(.404,",965,40,"C","EDIT PERSON",1)
"RTN","VEEMI00R",104,0)
 ;;=
"RTN","VEEMI00R",105,0)
 ;;^UTILITY(U,$J,"DIST(.404,",965,40,"C","PAGE 1 OF 1",2)
"RTN","VEEMI00R",106,0)
 ;;=
"RTN","VEEMI00R",107,0)
 ;;^UTILITY(U,$J,"DIST(.404,",966,0)
"RTN","VEEMI00R",108,0)
 ;;=VEEM PER EDT^19200.111
"RTN","VEEMI00R",109,0)
 ;;^UTILITY(U,$J,"DIST(.404,",966,40,0)
"RTN","VEEMI00R",110,0)
 ;;=^.4044I^4^4
"RTN","VEEMI00R",111,0)
 ;;^UTILITY(U,$J,"DIST(.404,",966,40,1,0)
"RTN","VEEMI00R",112,0)
 ;;=1^NAME^3
"RTN","VEEMI00R",113,0)
 ;;^UTILITY(U,$J,"DIST(.404,",966,40,1,1)
"RTN","VEEMI00R",114,0)
 ;;=.01
"RTN","VEEMI00R",115,0)
 ;;^UTILITY(U,$J,"DIST(.404,",966,40,1,2)
"RTN","VEEMI00R",116,0)
 ;;=3,29^30^3,23
"RTN","VEEMI00R",117,0)
 ;;^UTILITY(U,$J,"DIST(.404,",966,40,2,0)
"RTN","VEEMI00R",118,0)
 ;;=2^INITIALS^3
"RTN","VEEMI00R",119,0)
 ;;^UTILITY(U,$J,"DIST(.404,",966,40,2,1)
"RTN","VEEMI00R",120,0)
 ;;=2
"RTN","VEEMI00R",121,0)
 ;;^UTILITY(U,$J,"DIST(.404,",966,40,2,2)
"RTN","VEEMI00R",122,0)
 ;;=4,29^5^4,19
"RTN","VEEMI00R",123,0)
 ;;^UTILITY(U,$J,"DIST(.404,",966,40,3,0)
"RTN","VEEMI00R",124,0)
 ;;=3^VPE ID^3
"RTN","VEEMI00R",125,0)
 ;;^UTILITY(U,$J,"DIST(.404,",966,40,3,1)
"RTN","VEEMI00R",126,0)
 ;;=3
"RTN","VEEMI00R",127,0)
 ;;^UTILITY(U,$J,"DIST(.404,",966,40,3,2)
"RTN","VEEMI00R",128,0)
 ;;=5,29^9^5,21
"RTN","VEEMI00R",129,0)
 ;;^UTILITY(U,$J,"DIST(.404,",966,40,4,0)
"RTN","VEEMI00R",130,0)
 ;;=4^ROUTINE VERSIONING PROMPT^3
"RTN","VEEMI00R",131,0)
 ;;^UTILITY(U,$J,"DIST(.404,",966,40,4,1)
"RTN","VEEMI00R",132,0)
 ;;=4
"RTN","VEEMI00R",133,0)
 ;;^UTILITY(U,$J,"DIST(.404,",966,40,4,2)
"RTN","VEEMI00R",134,0)
 ;;=6,29^3^6,2
"RTN","VEEMI00R",135,0)
 ;;^UTILITY(U,$J,"DIST(.404,",966,40,"B",1,1)
"RTN","VEEMI00R",136,0)
 ;;=
"RTN","VEEMI00R",137,0)
 ;;^UTILITY(U,$J,"DIST(.404,",966,40,"B",2,2)
"RTN","VEEMI00R",138,0)
 ;;=
"RTN","VEEMI00R",139,0)
 ;;^UTILITY(U,$J,"DIST(.404,",966,40,"B",3,3)
"RTN","VEEMI00R",140,0)
 ;;=
"RTN","VEEMI00R",141,0)
 ;;^UTILITY(U,$J,"DIST(.404,",966,40,"B",4,4)
"RTN","VEEMI00R",142,0)
 ;;=
"RTN","VEEMI00R",143,0)
 ;;^UTILITY(U,$J,"DIST(.404,",966,40,"C","INITIALS",2)
"RTN","VEEMI00R",144,0)
 ;;=
"RTN","VEEMI00R",145,0)
 ;;^UTILITY(U,$J,"DIST(.404,",966,40,"C","NAME",1)
"RTN","VEEMI00R",146,0)
 ;;=
"RTN","VEEMI00R",147,0)
 ;;^UTILITY(U,$J,"DIST(.404,",966,40,"C","ROUTINE VERSIONING PROMPT",4)
"RTN","VEEMI00R",148,0)
 ;;=
"RTN","VEEMI00R",149,0)
 ;;^UTILITY(U,$J,"DIST(.404,",966,40,"C","VPE ID",3)
"RTN","VEEMI00R",150,0)
 ;;=
"RTN","VEEMI00R",151,0)
 ;;^UTILITY(U,$J,"PKG",19,0)
"RTN","VEEMI00R",152,0)
 ;;=VPE SHELL^VEEM^Victory Programmer Environment
"RTN","VEEMI00R",153,0)
 ;;^UTILITY(U,$J,"PKG",19,1,0)
"RTN","VEEMI00R",154,0)
 ;;=^^2^2^3040104^^^^
"RTN","VEEMI00R",155,0)
 ;;^UTILITY(U,$J,"PKG",19,1,1,0)
"RTN","VEEMI00R",156,0)
 ;;=This is the Victory Programmer Environment package developed and
"RTN","VEEMI00R",157,0)
 ;;^UTILITY(U,$J,"PKG",19,1,2,0)
"RTN","VEEMI00R",158,0)
 ;;=distributed by David Bolduc.
"RTN","VEEMI00R",159,0)
 ;;^UTILITY(U,$J,"PKG",19,4,0)
"RTN","VEEMI00R",160,0)
 ;;=^9.44PA^5^5
"RTN","VEEMI00R",161,0)
 ;;^UTILITY(U,$J,"PKG",19,4,1,0)
"RTN","VEEMI00R",162,0)
 ;;=19200.113
"RTN","VEEMI00R",163,0)
 ;;^UTILITY(U,$J,"PKG",19,4,1,222)
"RTN","VEEMI00R",164,0)
 ;;=y^^^y^^^y^o^y
"RTN","VEEMI00R",165,0)
 ;;^UTILITY(U,$J,"PKG",19,4,2,0)
"RTN","VEEMI00R",166,0)
 ;;=19200.114
"RTN","VEEMI00S")
0^193^B6096604
"RTN","VEEMI00S",1,0)
VEEMI00S ; ; 04-JAN-2004
"RTN","VEEMI00S",2,0)
 ;;12;VPE SHELL;;JAN 04, 2004;Build 8
"RTN","VEEMI00S",3,0)
 F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
"RTN","VEEMI00S",4,0)
Q Q
"RTN","VEEMI00S",5,0)
 ;;^UTILITY(U,$J,"PKG",19,4,2,222)
"RTN","VEEMI00S",6,0)
 ;;=y^^^y^^^y^o^y
"RTN","VEEMI00S",7,0)
 ;;^UTILITY(U,$J,"PKG",19,4,3,0)
"RTN","VEEMI00S",8,0)
 ;;=19200.11
"RTN","VEEMI00S",9,0)
 ;;^UTILITY(U,$J,"PKG",19,4,3,222)
"RTN","VEEMI00S",10,0)
 ;;=y^^^y
"RTN","VEEMI00S",11,0)
 ;;^UTILITY(U,$J,"PKG",19,4,4,0)
"RTN","VEEMI00S",12,0)
 ;;=19200.111
"RTN","VEEMI00S",13,0)
 ;;^UTILITY(U,$J,"PKG",19,4,4,222)
"RTN","VEEMI00S",14,0)
 ;;=y^^^y
"RTN","VEEMI00S",15,0)
 ;;^UTILITY(U,$J,"PKG",19,4,5,0)
"RTN","VEEMI00S",16,0)
 ;;=19200.112
"RTN","VEEMI00S",17,0)
 ;;^UTILITY(U,$J,"PKG",19,4,5,222)
"RTN","VEEMI00S",18,0)
 ;;=y^^^y
"RTN","VEEMI00S",19,0)
 ;;^UTILITY(U,$J,"PKG",19,4,"B",19200.11,3)
"RTN","VEEMI00S",20,0)
 ;;=
"RTN","VEEMI00S",21,0)
 ;;^UTILITY(U,$J,"PKG",19,4,"B",19200.111,4)
"RTN","VEEMI00S",22,0)
 ;;=
"RTN","VEEMI00S",23,0)
 ;;^UTILITY(U,$J,"PKG",19,4,"B",19200.112,5)
"RTN","VEEMI00S",24,0)
 ;;=
"RTN","VEEMI00S",25,0)
 ;;^UTILITY(U,$J,"PKG",19,4,"B",19200.113,1)
"RTN","VEEMI00S",26,0)
 ;;=
"RTN","VEEMI00S",27,0)
 ;;^UTILITY(U,$J,"PKG",19,4,"B",19200.114,2)
"RTN","VEEMI00S",28,0)
 ;;=
"RTN","VEEMI00S",29,0)
 ;;^UTILITY(U,$J,"PKG",19,11)
"RTN","VEEMI00S",30,0)
 ;;=
"RTN","VEEMI00S",31,0)
 ;;^UTILITY(U,$J,"PKG",19,22,0)
"RTN","VEEMI00S",32,0)
 ;;=^9.49I^6^6
"RTN","VEEMI00S",33,0)
 ;;^UTILITY(U,$J,"PKG",19,22,1,0)
"RTN","VEEMI00S",34,0)
 ;;=7.3^2960106^2960107
"RTN","VEEMI00S",35,0)
 ;;^UTILITY(U,$J,"PKG",19,22,2,0)
"RTN","VEEMI00S",36,0)
 ;;=8^2961117
"RTN","VEEMI00S",37,0)
 ;;^UTILITY(U,$J,"PKG",19,22,3,0)
"RTN","VEEMI00S",38,0)
 ;;=9^2970515^2970515
"RTN","VEEMI00S",39,0)
 ;;^UTILITY(U,$J,"PKG",19,22,4,0)
"RTN","VEEMI00S",40,0)
 ;;=9.3^2971017
"RTN","VEEMI00S",41,0)
 ;;^UTILITY(U,$J,"PKG",19,22,5,0)
"RTN","VEEMI00S",42,0)
 ;;=11^3001224
"RTN","VEEMI00S",43,0)
 ;;^UTILITY(U,$J,"PKG",19,22,6,0)
"RTN","VEEMI00S",44,0)
 ;;=12^3040104
"RTN","VEEMI00S",45,0)
 ;;^UTILITY(U,$J,"PKG",19,22,"B",7.3,1)
"RTN","VEEMI00S",46,0)
 ;;=
"RTN","VEEMI00S",47,0)
 ;;^UTILITY(U,$J,"PKG",19,22,"B",8,2)
"RTN","VEEMI00S",48,0)
 ;;=
"RTN","VEEMI00S",49,0)
 ;;^UTILITY(U,$J,"PKG",19,22,"B",9,3)
"RTN","VEEMI00S",50,0)
 ;;=
"RTN","VEEMI00S",51,0)
 ;;^UTILITY(U,$J,"PKG",19,22,"B",9.3,4)
"RTN","VEEMI00S",52,0)
 ;;=
"RTN","VEEMI00S",53,0)
 ;;^UTILITY(U,$J,"PKG",19,22,"B",11,5)
"RTN","VEEMI00S",54,0)
 ;;=
"RTN","VEEMI00S",55,0)
 ;;^UTILITY(U,$J,"PKG",19,22,"B",12,6)
"RTN","VEEMI00S",56,0)
 ;;=
"RTN","VEEMI00S",57,0)
 ;;^UTILITY(U,$J,"PKG",19,"DEV")
"RTN","VEEMI00S",58,0)
 ;;=David Bolduc
"RTN","VEEMI00S",59,0)
 ;;^UTILITY(U,$J,"PKG",19,"DIST",0)
"RTN","VEEMI00S",60,0)
 ;;=^9.485^^0
"RTN","VEEMI00S",61,0)
 ;;^UTILITY(U,$J,"SBF",19200.11,19200.11)
"RTN","VEEMI00S",62,0)
 ;;=
"RTN","VEEMI00S",63,0)
 ;;^UTILITY(U,$J,"SBF",19200.111,19200.111)
"RTN","VEEMI00S",64,0)
 ;;=
"RTN","VEEMI00S",65,0)
 ;;^UTILITY(U,$J,"SBF",19200.112,19200.112)
"RTN","VEEMI00S",66,0)
 ;;=
"RTN","VEEMI00S",67,0)
 ;;^UTILITY(U,$J,"SBF",19200.112,19200.1121)
"RTN","VEEMI00S",68,0)
 ;;=
"RTN","VEEMI00S",69,0)
 ;;^UTILITY(U,$J,"SBF",19200.113,19200.113)
"RTN","VEEMI00S",70,0)
 ;;=
"RTN","VEEMI00S",71,0)
 ;;^UTILITY(U,$J,"SBF",19200.114,19200.114)
"RTN","VEEMI00S",72,0)
 ;;=
"RTN","VEEMI00S",73,0)
 ;;^UTILITY(U,$J,"SBF",19200.114,19200.11421)
"RTN","VEEMI00S",74,0)
 ;;=
"RTN","VEEMI00S",75,0)
 ;;^UTILITY(U,$J,"SBF",19200.114,19200.124)
"RTN","VEEMI00S",76,0)
 ;;=
"RTN","VEEMINI1")
0^194^B6522142
"RTN","VEEMINI1",1,0)
VEEMINI1 ; ; 04-JAN-2004
"RTN","VEEMINI1",2,0)
 ;;12;VPE SHELL;;JAN 04, 2004;Build 8
"RTN","VEEMINI1",3,0)
 ; LOADS AND INDEXES DD'S
"RTN","VEEMINI1",4,0)
 ;
"RTN","VEEMINI1",5,0)
 K DIF,DIK,D,DDF,DDT,DTO,D0,DLAYGO,DIC,DIDUZ,DIR,DA,DFR,DTN,DIX,DZ D DT^DICRW S %=1,U="^",DSEC=1
"RTN","VEEMINI1",6,0)
 S NO=$P("I 0^I $D(@X)#2,X[U",U,%) I %<1 K DIFQ Q
"RTN","VEEMINI1",7,0)
ASK I %=1,$D(DIFQ(0)) W !,"SHALL I WRITE OVER FILE SECURITY CODES" S %=2 D YN^DICN S DSEC=%=1 I %<1 K DIFQ Q
"RTN","VEEMINI1",8,0)
 F X="DIS" D W Q:'$D(DIFQ)
"RTN","VEEMINI1",9,0)
 Q:'$D(DIFQ)  S %=2 W !!,"ARE YOU SURE EVERYTHING'S OK" D YN^DICN I %-1 K DIFQ Q
"RTN","VEEMINI1",10,0)
 I $D(DIFKEP) F DIDIU=0:0 S DIDIU=$O(DIFKEP(DIDIU)) Q:DIDIU'>0  S DIU=DIDIU,DIU(0)=DIFKEP(DIDIU) D EN^DIU2
"RTN","VEEMINI1",11,0)
 D DT^DICRW K ^UTILITY(U,$J),^UTILITY("DIK",$J) D WAIT^DICD
"RTN","VEEMINI1",12,0)
 S DN="^VEEMI" F R=1:1:28 D @(DN_$$B36(R)) W "."
"RTN","VEEMINI1",13,0)
 F  S D=$O(^UTILITY(U,$J,"SBF","")) Q:D'>0  K:'DIFQ(D) ^(D) S D=$O(^(D,"")) I D>0  K ^(D) D IX
"RTN","VEEMINI1",14,0)
DATA W "." S (D,DDF(1),DDT(0))=$O(^UTILITY(U,$J,0)) Q:D'>0
"RTN","VEEMINI1",15,0)
 I DIFQR(D) S DTO=0,DMRG=1,DTO(0)=^(D),Z=^(D)_"0)",D0=^(D,0),@Z=D0,DFR(1)="^UTILITY(U,$J,DDF(1),D0,",DKP=DIFQR(D)'=2 F D0=0:0 S D0=$O(^UTILITY(U,$J,DDF(1),D0)) S:D0="" D0=-1 Q:'$D(^(D0,0))  S Z=^(0) D I^DITR
"RTN","VEEMINI1",16,0)
 K ^UTILITY(U,$J,DDF(1)),DDF,DDT,DTO,DFR,DFN,DTN G DATA
"RTN","VEEMINI1",17,0)
 ;
"RTN","VEEMINI1",18,0)
W S Y=$P($T(@X),";",2) W !,"NOTE: This package also contains "_Y_"S",! Q:'$D(DIFQ(0))
"RTN","VEEMINI1",19,0)
 S %=1 W ?6,"SHALL I WRITE OVER EXISTING "_Y_"S OF THE SAME NAME" D YN^DICN I '% W !?6,"Answer YES to replace the current "_Y_"S with the incoming ones." G W
"RTN","VEEMINI1",20,0)
 S:%=2 DIFQ(X)=0 K:%<0 DIFQ
"RTN","VEEMINI1",21,0)
 Q
"RTN","VEEMINI1",22,0)
 ;
"RTN","VEEMINI1",23,0)
OPT ;OPTION
"RTN","VEEMINI1",24,0)
RTN ;ROUTINE DOCUMENTATION NOTE
"RTN","VEEMINI1",25,0)
FUN ;FUNCTION
"RTN","VEEMINI1",26,0)
BUL ;BULLETIN
"RTN","VEEMINI1",27,0)
KEY ;SECURITY KEY
"RTN","VEEMINI1",28,0)
HEL ;HELP FRAME
"RTN","VEEMINI1",29,0)
DIP ;PRINT TEMPLATE
"RTN","VEEMINI1",30,0)
DIE ;INPUT TEMPLATE
"RTN","VEEMINI1",31,0)
DIB ;SORT TEMPLATE
"RTN","VEEMINI1",32,0)
DIS ;FORM
"RTN","VEEMINI1",33,0)
REM ;REMOTE PROCEDURE
"RTN","VEEMINI1",34,0)
 ;
"RTN","VEEMINI1",35,0)
SBF ;FILE AND SUB FILE NUMBERS
"RTN","VEEMINI1",36,0)
IX W "." S DIK="A" F %=0:0 S DIK=$O(^DD(D,DIK)) Q:DIK=""  K ^(DIK)
"RTN","VEEMINI1",37,0)
 S DA(1)=D,DIK="^DD("_D_"," D IXALL^DIK
"RTN","VEEMINI1",38,0)
 I $D(^DIC(D,"%",0)) S DIK="^DIC(D,""%""," G IXALL^DIK
"RTN","VEEMINI1",39,0)
 Q
"RTN","VEEMINI1",40,0)
B36(X) Q $$N(X\(36*36)#36+1)_$$N(X\36#36+1)_$$N(X#36+1)
"RTN","VEEMINI1",41,0)
N(%) Q $E("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",%)
"RTN","VEEMINI2")
0^195^B6721390
"RTN","VEEMINI2",1,0)
VEEMINI2 ; ; 04-JAN-2004
"RTN","VEEMINI2",2,0)
 ;;12;VPE SHELL;;JAN 04, 2004;Build 8
"RTN","VEEMINI2",3,0)
 ;
"RTN","VEEMINI2",4,0)
 ;
"RTN","VEEMINI2",5,0)
 K ^UTILITY("DIFROM",$J),DIC S DIDUZ=0 S:$D(DUZ)#2 DIDUZ=DUZ S DUZ=.5
"RTN","VEEMINI2",6,0)
 I $D(^DIC(9.2,0))#2,^(0)?1"HEL".E S (DIC,DLAYGO)=9.2,N="HEL",DIC(0)="LX" G ADD
"RTN","VEEMINI2",7,0)
 Q
"RTN","VEEMINI2",8,0)
 ;
"RTN","VEEMINI2",9,0)
ADD F R=0:0 S R=$O(^UTILITY(U,$J,N,R)) Q:R'>0  S X=$P(^(R,0),U,1) W "." K DA D ^DIC I Y>0,'$D(DIFQ(N))!$P(Y,U,3) S ^UTILITY("DIFROM",$J,N,X)=+Y K ^DIC(9.2,+Y,1),^(2),^(3),^(10) S %X="^UTILITY(U,$J,N,R,",%Y=DIC_"+Y,",DA=+Y D %XY^%RCR
"RTN","VEEMINI2",10,0)
 S DIK=DIC
"RTN","VEEMINI2",11,0)
HELP S R=$O(^UTILITY("DIFROM",$J,N,R)) Q:R=""  W !,"'"_R_"' Help Frame filed." S DA=^(R)
"RTN","VEEMINI2",12,0)
 F X=0:0 S X=$O(^DIC(9.2,DA,2,X)) Q:'X  S I=$S($D(^(X,0)):^(0),1:0),Y=$P(I,U,2) S:Y]"" Y=$O(^DIC(9.2,"B",Y,0)) S ^(0)=$P(^DIC(9.2,DA,2,X,0),U,1)_U_$S(Y>0:Y,1:"")_U_$P(^(0),U,3,99)
"RTN","VEEMINI2",13,0)
 S I=0 F X=0:0 S X=$O(^DIC(9.2,DA,10,X)) Q:'X  I $D(^(X,0)) S Y=$P(^(0),U),Y=$S(Y]"":$O(^MAG("B",Y,0)),1:0) S:Y $P(^DIC(9.2,DA,10,X,0),U)=Y,I=I+1,%=X I 'Y K ^DIC(9.2,DA,10,X,0)
"RTN","VEEMINI2",14,0)
 I I S $P(^DIC(9.2,DA,10,0),U,3,4)=%_U_I
"RTN","VEEMINI2",15,0)
IX D IX1^DIK G HELP
"RTN","VEEMINI2",16,0)
 ;
"RTN","VEEMINI2",17,0)
U I $D(DIRUT) S DIFQ=1
"RTN","VEEMINI2",18,0)
 W ! Q
"RTN","VEEMINI2",19,0)
REP S DIR(0)="Y",DIR("A")="Shall I change the NAME of the file to "_DIF
"RTN","VEEMINI2",20,0)
 S DIR("??")="^D REP^DIFROMH1",DIR("B")="NO" D ^DIR G U:$D(DIRUT)
"RTN","VEEMINI2",21,0)
 I Y S DIE=1,DIFQ=0,DA=N,DR=".01////"_DIF D ^DIE Q
"RTN","VEEMINI2",22,0)
 S DIR("A")="Shall I replace your file with mine"
"RTN","VEEMINI2",23,0)
 S DIR("??")="^D AG^DIFROMH1" D ^DIR G U:$D(DIRUT)!'Y
"RTN","VEEMINI2",24,0)
 S DIU(0)="E",DIR("A")="Do you want to keep the Data"
"RTN","VEEMINI2",25,0)
 S DIR("??")="^D CHG^DIFROMH1" D ^DIR G U:$D(DIRUT)
"RTN","VEEMINI2",26,0)
 S:'Y DIU(0)=DIU(0)_"D"
"RTN","VEEMINI2",27,0)
 S DIR("A")="Do you want to keep the Templates"
"RTN","VEEMINI2",28,0)
 S DIR("??")="^D TEMP^DIFROMH1" D ^DIR G U:$D(DIRUT) S:'Y DIU(0)=DIU(0)_"T"
"RTN","VEEMINI2",29,0)
 S DIFQ(N)=1,DIFKEP(N)=DIU(0) W !?15," (",DIF,") " Q
"RTN","VEEMINI3")
0^196^B27036495
"RTN","VEEMINI3",1,0)
VEEMINI3 ; ; 04-JAN-2004
"RTN","VEEMINI3",2,0)
 ;;12;VPE SHELL;;JAN 04, 2004;Build 8
"RTN","VEEMINI3",3,0)
 ;
"RTN","VEEMINI3",4,0)
 ;
"RTN","VEEMINI3",5,0)
 K ^UTILITY("DIFROM",$J) S DIC(0)="LX",(DIC,DLAYGO)=3.6,N="BUL" D ADD:$D(^XMB(3.6,0))
"RTN","VEEMINI3",6,0)
 S X=0 F R=0:0 S X=$O(^UTILITY("DIFROM",$J,N,X)) Q:X=""  W !,"'",X,"' BULLETIN FILED -- Remember to add mail groups for new bulletins."
"RTN","VEEMINI3",7,0)
 I $D(^DIC(9.4,0))#2,^(0)?1"PACK".E S N="PKG",(DIC,DLAYGO)=9.4 D ADD
"RTN","VEEMINI3",8,0)
 G NP:'$D(DA) S %=+$O(^DIC(9.4,DA,22,"B",DIFROM,0)) I $D(^DIC(9.4,DA,22,%,0)) S $P(^(0),U,3)=DT
"RTN","VEEMINI3",9,0)
 I $D(^DIC(9.4,DA,0))#2 S %=$P(^(0),U,4) I %]"" S %=$O(^DIC(9.2,"B",%,0)) S:%]"" $P(^DIC(9.4,DA,0),U,4)=%
"RTN","VEEMINI3",10,0)
OR I $D(^ORD(100.99))&$O(^UTILITY(U,$J,"OR","")) D EN^VEEMINI4
"RTN","VEEMINI3",11,0)
NP K DIC,^UTILITY("DIFROM",$J) S DIC(0)="LX" I $D(^DIC(19,0))#2,^(0)?1"OPTION".E S (DIC,DLAYGO)=19,N="OPT" D ADD,OP
"RTN","VEEMINI3",12,0)
 I $D(^DIC(19.1,0))#2,($P(^(0),U)?1"SECUR".E)!($P(^(0),U)="KEY") S (DIC,DLAYGO)=19.1,N="KEY" D ADD K ^UTILITY("DIFROM",$J)
"RTN","VEEMINI3",13,0)
 I $D(^DIC(9.8,0))#2,^(0)?1"ROUTINE^".E S (DIC,DLAYGO)=9.8,N="RTN" D ADD
"RTN","VEEMINI3",14,0)
 S DIC=.5,DLAYGO=0,N="FUN" D ADD
"RTN","VEEMINI3",15,0)
 I $P($G(^DIC(8994,0)),U)="REMOTE PROCEDURE" S (DIC,DLAYGO)=8994,N="REM" D ADD
"RTN","VEEMINI3",16,0)
 S DIC("S")="I $P(^(0),U,4)=DIFL" F N="DIPT","DIBT","DIE" S DIC=U_N_"(" D ADD
"RTN","VEEMINI3",17,0)
 K DIC("S") S N="DIST(.404,",DIC=U_N,DLAYGO=.404 D ADD
"RTN","VEEMINI3",18,0)
 S DIC("S")="I $P(^(0),U,8)=DIFL",N="DIST(.403,",DIC=U_N,DLAYGO=.403 D ADD
"RTN","VEEMINI3",19,0)
 K ^UTILITY(U,$J),DIC,DLAYGO F DIFR="DIE","DIPT" D DIEZ
"RTN","VEEMINI3",20,0)
 K ^UTILITY("DIFROM",$J) Q
"RTN","VEEMINI3",21,0)
DIEZ I ^DD("VERSION")>17.4,'$D(DISYS) D OS^DII
"RTN","VEEMINI3",22,0)
 E  S DISYS=^DD("OS")
"RTN","VEEMINI3",23,0)
 Q:'$D(^DD("OS",DISYS,"ZS"))
"RTN","VEEMINI3",24,0)
 S DIFR1=""
"RTN","VEEMINI3",25,0)
DZ1 S DIFR1=$O(^UTILITY("DIFROM",$J,DIFR,DIFR1)) Q:DIFR1=""
"RTN","VEEMINI3",26,0)
 F DIFR2=0:0 S DIFR2=$O(^UTILITY("DIFROM",$J,DIFR,DIFR1,DIFR2)) Q:'DIFR2  S Y=DIFR2 I $D(@(U_DIFR_"(Y,""ROU"")")) K ^("ROU") I $D(^("ROUOLD")) S X=^("ROUOLD"),DMAX=^DD("ROU") D:X]"" @("EN^DI"_$E(DIFR,3)_"Z")
"RTN","VEEMINI3",27,0)
 G DZ1
"RTN","VEEMINI3",28,0)
 ;
"RTN","VEEMINI3",29,0)
OP S R=$O(^UTILITY("DIFROM",$J,N,R)) I R="" K ^UTILITY("DIFROM",$J) G Q
"RTN","VEEMINI3",30,0)
 W !,"'"_R_"' Option Filed" S DA=+^UTILITY("DIFROM",$J,N,R) G:$P(^(R),U,2,3)="XUCORE^"!($P(^(R),U,2,3)="XUCOMMAND^") OP
"RTN","VEEMINI3",31,0)
 I $D(^DIC(19,DA,220)) S %=$P(^(220),U) S:%]"" %=$O(^XMB(3.6,"B",%,0)) S $P(^DIC(19,DA,220),U)=%,%=$P(^(220),U,3) S:%]"" %=$O(^XMB(3.8,"B",%,0)) S $P(^DIC(19,DA,220),U,3)=%
"RTN","VEEMINI3",32,0)
 S %=$P(^DIC(19,DA,0),U,12) S:%]"" %=$O(^DIC(9.4,"B",%,0))
"RTN","VEEMINI3",33,0)
 S $P(^DIC(19,DA,0),U,12)=%,%=$P(^(0),U,7),(DZ,DIX)=0
"RTN","VEEMINI3",34,0)
 D:$D(^DIC(19,DA,10,"B")) KAD(DA) S:%]"" %=$O(^DIC(9.2,"B",%,0)) S $P(^DIC(19,DA,0),U,7)=%,%=$P(^(0),U,4),%="MOQXL"[% K ^(10,"B"),^("C")
"RTN","VEEMINI3",35,0)
 F X=0:0 S X=$O(^DIC(19,DA,10,X)) Q:'X  S I=$S($D(^(X,0)):^(0),1:0),Y=$S($D(^(U)):^(U),1:"") K ^DIC(19,DA,10,X) I Y]"",% S D=$O(^DIC(19,"B",Y,0)) I D S ^DIC(19,DA,10,X,0)=D_U_$P(I,U,2,9),DZ=DZ+1,DIX=X
"RTN","VEEMINI3",36,0)
 S:% ^DIC(19,DA,10,0)="^19.01PI^"_DIX_U_DZ D IX1^DIK G OP
"RTN","VEEMINI3",37,0)
 ;
"RTN","VEEMINI3",38,0)
ADD F R=0:0 S R=$O(^UTILITY(U,$J,N,R)) Q:R=""  S X=$P(^(R,0),U),DIFL=$S(N="DIST(.403,":$P(^(0),U,8),N="DIST(.404,":$P(^(0),U,2),1:$P(^(0),U,4)) W "." K DA D ^DIC I Y>0,'$D(DIFQ($E(N,1,3)))!$P(Y,U,3) S Y=Y_U D A
"RTN","VEEMINI3",39,0)
Q Q
"RTN","VEEMINI3",40,0)
A I N="BUL" K % S %(0)=$G(@(DIC_"+Y,2,0)")) F %=0:0 S %=$O(@(DIC_"+Y,2,%)")) Q:'%  S %(%)=$G(^(%,0))
"RTN","VEEMINI3",41,0)
 K:N'="KEY"&(N'="OPT") @(DIC_"+Y)") S ^UTILITY("DIFROM",$J,N,X)=Y S:$E(N,1,2)="DI" ^(X,+Y)="" S:N="PKG" DIFROM(0)=+Y Q:$P(Y,U,2,3)="XUCORE^"!($P(Y,U,2,3)="XUCOMMAND^")
"RTN","VEEMINI3",42,0)
 I N="BUL",%(0)]"" S @(DIC_"+Y,2,0)")=%(0) F %=0:0 S %=$O(%(%)) Q:'%  S @(DIC_"+Y,2,%,0)")=%(%)
"RTN","VEEMINI3",43,0)
 I $E(N,1,2)="DI",('DIFL)!('$D(^DD(+DIFL))) D
"RTN","VEEMINI3",44,0)
 .W !,"**WARNING--"_$S(N="DIE":"INPUT",N="DIPT":"PRINT",N="DIBT":"SORT",1:"FORM or BLOCK")_$S(N'["DIST":" template ",1:" ")_$P(Y,U,2)_" has been installed,",!,"but associated file "_DIFL_" is not on your system!"
"RTN","VEEMINI3",45,0)
 .Q
"RTN","VEEMINI3",46,0)
 I N="OPT" S:$P(^DIC(19,+Y,0),U,6)]"" DIOPT=$P(^(0),U,6) I $O(^UTILITY(U,$J,N,R,1,0)) K ^DIC(19,+Y,1)
"RTN","VEEMINI3",47,0)
 I N="DIST(.403," D BLK
"RTN","VEEMINI3",48,0)
 S %X="^UTILITY(U,$J,N,R,",%Y=DIC_"+Y,",DA=+Y,DIK=DIC D %XY^%RCR
"RTN","VEEMINI3",49,0)
 D IX1^DIK:N'="OPT" I N="OPT",$D(DIOPT) S:$P(^DIC(19,DA,0),U,6)="" $P(^(0),U,6)=DIOPT K DIOPT
"RTN","VEEMINI3",50,0)
 I N="DIST(.403," D
"RTN","VEEMINI3",51,0)
 .N DIFRVAL S DIFRVAL=$$VAL^DIFROMSS(.403,DA)
"RTN","VEEMINI3",52,0)
 .I DIFRVAL W !,"Compiling form: ",$P(^DIST(.403,DA,0),U) D EN^DDSZ(DA) Q
"RTN","VEEMINI3",53,0)
 .W !,"ERROR: Form: ",$P(^DIST(.403,DA,0),U)," cannot be compiled"
"RTN","VEEMINI3",54,0)
 .Q
"RTN","VEEMINI3",55,0)
 Q
"RTN","VEEMINI3",56,0)
BLK F J=0:0 S J=$O(^UTILITY(U,$J,N,R,40,J)) Q:'J  I $D(^(J,0)) S %=$P(^(0),U,2) S:%]"" %=$O(^DIST(.404,"B",%,0)) S:% $P(^UTILITY(U,$J,N,R,40,J,0),U,2)=% D B1
"RTN","VEEMINI3",57,0)
 K A0,A1,A2,J,L Q
"RTN","VEEMINI3",58,0)
B1 F L=0:0 S L=$O(^UTILITY(U,$J,N,R,40,J,40,L)) Q:'L  S A0=$G(^(L,0)),%=$P(A0,U) I %]"" S %=$O(^DIST(.404,"B",%,0)) I % S $P(A0,U)=%,^UTILITY(U,$J,N,R,40,J,"BLK",%,0)=A0 D
"RTN","VEEMINI3",59,0)
 .N X S X=0
"RTN","VEEMINI3",60,0)
 .F  S X=$O(^UTILITY(U,$J,N,R,40,J,40,L,X)) Q:X=""  S ^UTILITY(U,$J,N,R,40,J,"BLK",%,X)=^(X)
"RTN","VEEMINI3",61,0)
 .Q
"RTN","VEEMINI3",62,0)
 S A0=$G(^UTILITY(U,$J,N,R,40,J,40,0)) Q:A0=""  K ^UTILITY(U,$J,N,R,40,J,40) S (A1,A2)=0
"RTN","VEEMINI3",63,0)
 F L=0:0 S L=$O(^UTILITY(U,$J,N,R,40,J,"BLK",L)) Q:'L  S ^UTILITY(U,$J,N,R,40,J,40,L,0)=^(L,0),A1=L,A2=A2+1 D
"RTN","VEEMINI3",64,0)
 .N X S X=0
"RTN","VEEMINI3",65,0)
 .F  S X=$O(^UTILITY(U,$J,N,R,40,J,"BLK",L,X)) Q:X=""  S ^UTILITY(U,$J,N,R,40,J,40,L,X)=^(X)
"RTN","VEEMINI3",66,0)
 .Q
"RTN","VEEMINI3",67,0)
 S $P(A0,U,3,4)=A1_U_A2,^UTILITY(U,$J,N,R,40,J,40,0)=A0 K ^UTILITY(U,$J,N,R,40,J,"BLK")
"RTN","VEEMINI3",68,0)
 Q
"RTN","VEEMINI3",69,0)
KAD(D0) N D1,X
"RTN","VEEMINI3",70,0)
 S X=0 F  S X=$O(^DIC(19,D0,10,"B",X)) Q:X'>0  S D1=0 F  S D1=$O(^DIC(19,D0,10,"B",X,D1)) Q:D1'>0  K ^DIC(19,"AD",X,D0,D1)
"RTN","VEEMINI3",71,0)
 Q
"RTN","VEEMINI4")
0^197^B4280461
"RTN","VEEMINI4",1,0)
VEEMINI4 ; ; 04-JAN-2004
"RTN","VEEMINI4",2,0)
 ;;12;VPE SHELL;;JAN 04, 2004;Build 8
"RTN","VEEMINI4",3,0)
 ;
"RTN","VEEMINI4",4,0)
 ;
"RTN","VEEMINI4",5,0)
EN S DA(1)=1,DIK="^ORD(100.99,1,5," I $D(^ORD(100.99,1,5,DA)) D ^DIK
"RTN","VEEMINI4",6,0)
 S %X="^UTILITY(U,$J,""OR"","_$O(^UTILITY(U,$J,"OR",""))_",",%Y=DIK_DA_","
"RTN","VEEMINI4",7,0)
 S:'$D(^ORD(100.99,1,5,0)) ^(0)="^100.995P^^" S $P(^(0),U,3,4)=DA_U_($P(^(0),U,4)+1)
"RTN","VEEMINI4",8,0)
 D %XY^%RCR S $P(^ORD(100.99,1,5,DA,0),U)=DA,%=$P(^(0),U,4)
"RTN","VEEMINI4",9,0)
 I %]"" S %=$O(^ORD(100.98,"B",%,0)) I %>0 S $P(^ORD(100.99,1,5,DA,0),U,4)=%
"RTN","VEEMINI4",10,0)
 D OR
"RTN","VEEMINI4",11,0)
 S DA(1)=1 D IX1^DIK
"RTN","VEEMINI4",12,0)
 Q
"RTN","VEEMINI4",13,0)
OR S (N,I)=0,X=""
"RTN","VEEMINI4",14,0)
 F  S N=$O(^ORD(100.99,1,5,DA,1,N)) Q:'N  S X=$P(^(N,0),U) I X]"" S %=$O(^ORD(101,"B",X,0)) D:'% ADDP S:% ^ORD(100.99,1,5,DA,1,N,0)=% S X=N,I=I+1,(R,J)=0,Y="" D OR1
"RTN","VEEMINI4",15,0)
 S:I $P(^ORD(100.99,1,5,DA,1,0),U,3,4)=X_U_I S (N,I)=0,X=""
"RTN","VEEMINI4",16,0)
 F  S N=$O(^ORD(100.99,1,5,DA,5,N)) Q:'N  S X=$P(^(N,0),U,3) I X]"" S %=$O(^ORD(101,"B",X,0)) D:'% ADDP S:% $P(^ORD(100.99,1,5,DA,5,N,0),U,3)=% S X=N,I=I+1
"RTN","VEEMINI4",17,0)
 S:I $P(^ORD(100.99,1,5,DA,5,0),U,3,4)=X_U_I K N,R,X,Y,I,J
"RTN","VEEMINI4",18,0)
 Q
"RTN","VEEMINI4",19,0)
OR1 N X F  S R=$O(^ORD(100.99,1,5,DA,1,N,1,R)) Q:'R  S X=$P(^(R,0),U) I X]"" S %=$O(^ORD(101,"B",X,0)) D:'% ADDP S:% ^ORD(100.99,1,5,DA,1,N,1,R,0)=% S Y=R,J=J+1
"RTN","VEEMINI4",20,0)
 S:J $P(^ORD(100.99,1,5,DA,1,N,1,0),U,3,4)=Y_U_J
"RTN","VEEMINI4",21,0)
 Q
"RTN","VEEMINI4",22,0)
ADDP N I,J,N,R,DA,DLAYGO,DO S %=""
"RTN","VEEMINI4",23,0)
 S DIC="^ORD(101,",DIC(0)="LX",DLAYGO=101 D FILE^DICN K DIC Q:Y=-1  S %=+Y Q
"RTN","VEEMINI5")
0^198^B1174761
"RTN","VEEMINI5",1,0)
VEEMINI5 ; ; 04-JAN-2004
"RTN","VEEMINI5",2,0)
 ;;12;VPE SHELL;;JAN 04, 2004;Build 8
"RTN","VEEMINI5",3,0)
 K ^UTILITY("DIF",$J) S DIFRDIFI=1 F I=1:1:10 S ^UTILITY("DIF",$J,DIFRDIFI)=$T(IXF+I),DIFRDIFI=DIFRDIFI+1
"RTN","VEEMINI5",4,0)
 Q
"RTN","VEEMINI5",5,0)
IXF ;;VPE SHELL^VEEM
"RTN","VEEMINI5",6,0)
 ;;19200.11I;VPE RTN LBRY;^VEE(19200.11,;0;y;;;y
"RTN","VEEMINI5",7,0)
 ;;
"RTN","VEEMINI5",8,0)
 ;;19200.111I;VPE PERSON;^VEE(19200.111,;0;y;;;y
"RTN","VEEMINI5",9,0)
 ;;
"RTN","VEEMINI5",10,0)
 ;;19200.112O;VPE RTN VERSIONING;^VEE(19200.112,;0;y;;;y
"RTN","VEEMINI5",11,0)
 ;;
"RTN","VEEMINI5",12,0)
 ;;19200.113I;VPE PROGRAMMER CALL;^VEE(19200.113,;0;y;;;y;;;y;o;y
"RTN","VEEMINI5",13,0)
 ;;
"RTN","VEEMINI5",14,0)
 ;;19200.114I;VPE PROGRAMMER PARAMETER;^VEE(19200.114,;0;y;;;y;;;y;o;y
"RTN","VEEMINI5",15,0)
 ;;
"RTN","VEEMINIS")
0^199^B4303329
"RTN","VEEMINIS",1,0)
VEEMINIS ; ; 04-JAN-2004
"RTN","VEEMINIS",2,0)
 ;;12;VPE SHELL;;JAN 04, 2004;Build 8
"RTN","VEEMINIS",3,0)
PAC(PKG,VER) ; called from package init (DIFROM7 created this routine)
"RTN","VEEMINIS",4,0)
 ; PKG = $T(IXF) of the INIT routine.
"RTN","VEEMINIS",5,0)
 ; VER is an array that is contained in DIFROM from the INIT routine
"RTN","VEEMINIS",6,0)
 ;
"RTN","VEEMINIS",7,0)
 N %,%I,%H,DATE,DIFROM,NOW,PACKAGE,RUN,SERVER,SITE,START,X,XMDUZ,XMSUB,XMTEXT,XMY,Y K ^TMP("VEEMINIS",$J)
"RTN","VEEMINIS",8,0)
 ;
"RTN","VEEMINIS",9,0)
 ; Site tracking updates only occur if run in a VA production primary domain
"RTN","VEEMINIS",10,0)
 ; account.
"RTN","VEEMINIS",11,0)
 I $G(^XMB("NETNAME"))'[".VA.GOV" Q
"RTN","VEEMINIS",12,0)
 Q:'$D(^%ZOSF("UCI"))  Q:'$D(^%ZOSF("PROD"))
"RTN","VEEMINIS",13,0)
 X ^%ZOSF("UCI") I Y'=^%ZOSF("PROD") Q
"RTN","VEEMINIS",14,0)
 ;
"RTN","VEEMINIS",15,0)
 S SERVER="S.A5CSTS@FORUM.VA.GOV"
"RTN","VEEMINIS",16,0)
 S PACKAGE=$P($P(PKG,";",3),U)
"RTN","VEEMINIS",17,0)
 S SITE=$G(^XMB("NETNAME"))
"RTN","VEEMINIS",18,0)
 S START=$P($G(^DIC(9.4,VER(0),"PRE")),U,2) I '$L(START) S START="Unknown"
"RTN","VEEMINIS",19,0)
 D  ; check if ok to use kernel functions
"RTN","VEEMINIS",20,0)
 .S X="XLFDT" X ^%ZOSF("TEST") I $T D  Q
"RTN","VEEMINIS",21,0)
 ..S NOW=$$HTFM^XLFDT($H)
"RTN","VEEMINIS",22,0)
 ..S RUN="Unknown" I START S RUN=$$FMDIFF^XLFDT(NOW,START,3)
"RTN","VEEMINIS",23,0)
 ..S START=$$FMTE^XLFDT(START)
"RTN","VEEMINIS",24,0)
 ..S DATE=NOW\1
"RTN","VEEMINIS",25,0)
 ..S NOW=$$FMTE^XLFDT(NOW)
"RTN","VEEMINIS",26,0)
 .D NOW^%DTC S NOW=%,DATE=X
"RTN","VEEMINIS",27,0)
 .S RUN="" ; don't bother to compute
"RTN","VEEMINIS",28,0)
 .S Y=START D DD^%DT S START=Y
"RTN","VEEMINIS",29,0)
 .S Y=NOW D DD^%DT S NOW=Y
"RTN","VEEMINIS",30,0)
 ;
"RTN","VEEMINIS",31,0)
 ; Message for server
"RTN","VEEMINIS",32,0)
 S ^TMP("VEEMINIS",$J,1,0)="PACKAGE INSTALL"
"RTN","VEEMINIS",33,0)
 S ^TMP("VEEMINIS",$J,2,0)="SITE: "_SITE
"RTN","VEEMINIS",34,0)
 S ^TMP("VEEMINIS",$J,3,0)="PACKAGE: "_PACKAGE
"RTN","VEEMINIS",35,0)
 S ^TMP("VEEMINIS",$J,4,0)="VERSION: "_VER
"RTN","VEEMINIS",36,0)
 S ^TMP("VEEMINIS",$J,5,0)="Start time: "_START
"RTN","VEEMINIS",37,0)
 S ^TMP("VEEMINIS",$J,6,0)="Completion time: "_NOW
"RTN","VEEMINIS",38,0)
 S ^TMP("VEEMINIS",$J,7,0)="Run time: "_RUN
"RTN","VEEMINIS",39,0)
 S ^TMP("VEEMINIS",$J,8,0)="DATE: "_DATE
"RTN","VEEMINIS",40,0)
 ;
"RTN","VEEMINIS",41,0)
 ; Data is sent to server on FORUM - S.A5CSTS
"RTN","VEEMINIS",42,0)
 S XMY(SERVER)="",XMDUZ=.5,XMTEXT="^TMP(""VEEMINIS"",$J,",XMSUB=PACKAGE_" VERSION "_VER_" INSTALLATION"
"RTN","VEEMINIS",43,0)
 D ^XMD
"RTN","VEEMINIS",44,0)
 K ^TMP("VEEMINIS",$J)
"RTN","VEEMINIS",45,0)
 Q
"RTN","VEEMINIT")
0^200^B14975659
"RTN","VEEMINIT",1,0)
VEEMINIT ; ; 04-JAN-2004
"RTN","VEEMINIT",2,0)
 ;;12;VPE SHELL;;JAN 04, 2004;Build 8
"RTN","VEEMINIT",3,0)
 ;
"RTN","VEEMINIT",4,0)
 K DIF,DIFQ,DIFQR,DIFQN,DIK,DDF,DDT,DTO,D0,DLAYGO,DIC,DIDUZ,DIR,DA,DIFROM,DFR,DTN,DIX,DZ,DIRUT,DTOUT,DUOUT
"RTN","VEEMINIT",5,0)
 S DIOVRD=1,U="^",DIFQ=0,DIFROM="12" W !,"This version (#12) of 'VEEMINIT' was created on 04-JAN-2004"
"RTN","VEEMINIT",6,0)
 W !?9,"(at DJB, by VA FileMan V.22.0)",!
"RTN","VEEMINIT",7,0)
 I $D(^DD("VERSION")),^("VERSION")'<22 G GO
"RTN","VEEMINIT",8,0)
 ;W !,"FIRST, I'LL FRESHEN UP YOUR VA FILEMAN...." D N^DINIT
"RTN","VEEMINIT",9,0)
 I ^DD("VERSION")<22 W !,"but I need version 22 of the VA FileMan!" G Q
"RTN","VEEMINIT",10,0)
GO ;
"RTN","VEEMINIT",11,0)
EN ; ENTER HERE TO BYPASS THE PRE-INIT PROGRAM
"RTN","VEEMINIT",12,0)
 S DIFQ=0 K DIRUT,DTOUT,DUOUT
"RTN","VEEMINIT",13,0)
 F DIFRIR=1:1:1 S DIFRRTN="^VEEMINI"_$E("5",DIFRIR) D @DIFRRTN
"RTN","VEEMINIT",14,0)
 W:1 !,"I AM GOING TO SET UP THE FOLLOWING FILES:" F I=1:2:10 S DIF(I)=^UTILITY("DIF",$J,I) D 1 G Q:DIFQ!$D(DIRUT) K DIF(I)
"RTN","VEEMINIT",15,0)
 S DIFROM="12" D PKG:'$D(DIFROM(0)),^VEEMINI1 G Q:'$D(DIFQ) S DIK(0)="AB"
"RTN","VEEMINIT",16,0)
 F DIF=1:2:10 S %=^UTILITY("DIF",$J,DIF),DIK=$P(%,";",5),N=$P(%,";",3),D=$P(%,";",4)_U_N D D K DIFQ(N)
"RTN","VEEMINIT",17,0)
 K DIFQR D ^VEEMINI2,^VEEMINI3
"RTN","VEEMINIT",18,0)
 L  S DUZ=DIDUZ W:1 !,$C(7),"OK, I'M DONE.",!,"NO"_$P("TE THAT FILE",U,DSEC)_" SECURITY-CODE PROTECTION HAS BEEN MADE"
"RTN","VEEMINIT",19,0)
 I DIFROM F DIF=1:2:10 S %=^UTILITY("DIF",$J,DIF),N=+$P(%,";",3) I N,$P(%,";",8)="y" S ^DD(N,0,"VR")=DIFROM
"RTN","VEEMINIT",20,0)
 I DIFROM(0)>0 F %="PRE","INI","INIT" S:$D(DIFROM(%)) $P(^DIC(9.4,DIFROM(0),%),U,2)=DIFROM(%)
"RTN","VEEMINIT",21,0)
 I $G(DIFQN) S $P(^(0),U,3,4)=$P(DIFQN,U,2)_U_($P(^DIC(0),U,4)+DIFQN) K DIFQN
"RTN","VEEMINIT",22,0)
 I DIFROM,$D(^%ZTSK) S X="VEEMINIS" X ^%ZOSF("TEST") D:$T PAC^VEEMINIS($T(IXF),.DIFROM)
"RTN","VEEMINIT",23,0)
 S:DIFROM(0)>0 ^DIC(9.4,DIFROM(0),"VERSION")=DIFROM G Q^DIFROM0
"RTN","VEEMINIT",24,0)
D S:$D(^DIC(+N,0))[0 ^(0)=D S X=$D(@(DIK_"0)")),^(0)=D_U_$S(X#2:$P(^(0),U,3,9),1:U)
"RTN","VEEMINIT",25,0)
 S DIFQR=DIFQR(+N) I ^DD("VERSION")>17.5,$D(^DD(+N,0,"DIK"))#2 S X=^("DIK"),Y=+N,DMAX=^DD("ROU") D EN^DIKZ
"RTN","VEEMINIT",26,0)
 I DIFQR D IXALL^DIK:$O(@(DIK_"0)")) W "."
"RTN","VEEMINIT",27,0)
 Q
"RTN","VEEMINIT",28,0)
R G REP^VEEMINI2
"RTN","VEEMINIT",29,0)
 ;
"RTN","VEEMINIT",30,0)
1 S N=+$P(DIF(I),";",3),DIF=$P(DIF(I),";",4),S=$P(DIF(I),";",5)
"RTN","VEEMINIT",31,0)
 W !!?3,N,?13,DIF,$P("  (Partial Definition)",U,$P(DIF(I),";",6)),$P("  (including data)",U,$P(DIF(I),";",13)="y") S Z=$S($D(^DIC(N,0))#2:^(0),1:"")
"RTN","VEEMINIT",32,0)
 I Z="" S DIFQ(N)=1,DIFQN=$G(DIFQN)+1_U_N G S
"RTN","VEEMINIT",33,0)
 I $L($P(Z,DIF)) W $C(7),!,"*BUT YOU ALREADY HAVE '",$P(Z,U),"' AS FILE #",N,"!" D R Q:DIFQ  G S:$D(DIFKEP(N)),1
"RTN","VEEMINIT",34,0)
 S DIFQ(N)=$P(DIF(I),";",7)'="n"
"RTN","VEEMINIT",35,0)
 I $L(Z) W $C(7),!,"Note:  You already have the '",$P(Z,U),"' File." S DIFQ(0)=1
"RTN","VEEMINIT",36,0)
 S %=$E(^UTILITY("DIF",$J,I+1),4,245) I %]"" X % S DIFQ(N)=$T W:'$T !,"Screen on this Data Dictionary did not pass--DD will not be installed!" G S
"RTN","VEEMINIT",37,0)
 I $L(Z),$P(DIF(I),";",10)="y" S DIR("A")="Shall I write over the existing Data Definition",DIR("??")="^D DD^DIFROMH1",DIR("B")="YES",DIR(0)="Y" D ^DIR S DIFQ(N)=Y
"RTN","VEEMINIT",38,0)
S S DIFQR(N)=0 Q:$P(DIF(I),";",13)'="y"!$D(DIRUT)
"RTN","VEEMINIT",39,0)
 I $P(DIF(I),";",15)="y",$O(@(S_"0)"))>0 S DIF=$P(DIF(I),";",14)="o",DIR("A")="Want my data "_$P("merged with^to overwrite",U,DIF+1)_" yours",DIR("??")="^D DTA^DIFROMH1",DIR(0)="Y" D ^DIR S DIFQR(N)=$S('Y:Y,1:Y+DIF) Q
"RTN","VEEMINIT",40,0)
 S %=$P(DIF(I),";",14)="o" W !,$C(7),"I will ",$P("MERGE^OVERWRITE",U,%+1)," your data with mine." S DIFQR(N)=%+1
"RTN","VEEMINIT",41,0)
 Q
"RTN","VEEMINIT",42,0)
Q W $C(7),!!,"NO UPDATING HAS OCCURRED!" G Q^DIFROM0
"RTN","VEEMINIT",43,0)
 ;
"RTN","VEEMINIT",44,0)
PKG S X=$P($T(IXF),";",3),DIC="^DIC(9.4,",DIC(0)="",DIC("S")="I $P(^(0),U,2)="""_$P(X,U,2)_"""",X=$P(X,U) D ^DIC S DIFROM(0)=+Y K DIC
"RTN","VEEMINIT",45,0)
 Q
"RTN","VEEMINIT",46,0)
 ;
"RTN","VEEMINIT",47,0)
IXF ;;VPE SHELL^VEEM;1
"RTN","VEEMVPE")
0^201^B1972060
"RTN","VEEMVPE",1,0)
VEEMVPE ;DJB,VPE**Edit PERSON ; 9/13/02 5:28pm
"RTN","VEEMVPE",2,0)
 ;;12;VPE;;;Build 8
"RTN","VEEMVPE",3,0)
 ;
"RTN","VEEMVPE",4,0)
EN ;
"RTN","VEEMVPE",5,0)
 NEW FLAGQ,VEEPERI,VEEPERN
"RTN","VEEMVPE",6,0)
TOP W @IOF
"RTN","VEEMVPE",7,0)
 W !,"*** ENTER/EDIT PERSON ***",!
"RTN","VEEMVPE",8,0)
 S FLAGQ=0
"RTN","VEEMVPE",9,0)
 D GETPER G:FLAGQ EX
"RTN","VEEMVPE",10,0)
 D EDIT
"RTN","VEEMVPE",11,0)
 G TOP
"RTN","VEEMVPE",12,0)
EX ;
"RTN","VEEMVPE",13,0)
 Q
"RTN","VEEMVPE",14,0)
 ;
"RTN","VEEMVPE",15,0)
GETPER ;Select a Person
"RTN","VEEMVPE",16,0)
 ;Return:
"RTN","VEEMVPE",17,0)
 ;   VEEPERI...Person IEN
"RTN","VEEMVPE",18,0)
 ;   VEEPERN...Person name
"RTN","VEEMVPE",19,0)
 ;   FLAGQ.....Quit variable
"RTN","VEEMVPE",20,0)
 ;
"RTN","VEEMVPE",21,0)
 NEW %,%Y,DDH,DIC,X,Y
"RTN","VEEMVPE",22,0)
 S DIC="^VEE(19200.111,"
"RTN","VEEMVPE",23,0)
 S DIC(0)="QEAML"
"RTN","VEEMVPE",24,0)
 S DIC("A")="Select PERSON: "
"RTN","VEEMVPE",25,0)
 D ^DIC I Y<0 S FLAGQ=1 Q
"RTN","VEEMVPE",26,0)
 S VEEPERI=+Y,VEEPERN=$P(Y,"^",2)
"RTN","VEEMVPE",27,0)
 Q
"RTN","VEEMVPE",28,0)
 ;
"RTN","VEEMVPE",29,0)
EDIT ;Edit Person
"RTN","VEEMVPE",30,0)
 NEW DA,DIERR,DIMSG,DINUM,DR,DTOUT,DUTOUT,I
"RTN","VEEMVPE",31,0)
 NEW DDSFILE,DDSPAGE,DDSPARM,DDSSAVE,DIERR
"RTN","VEEMVPE",32,0)
 ;
"RTN","VEEMVPE",33,0)
 S DDSFILE=19200.111
"RTN","VEEMVPE",34,0)
 S DA=VEEPERI
"RTN","VEEMVPE",35,0)
 S DR="[VEEM PER]"
"RTN","VEEMVPE",36,0)
 S DDSPARM="CE"
"RTN","VEEMVPE",37,0)
 D ^DDS
"RTN","VEEMVPE",38,0)
 I $G(DIERR) D DDSERR Q  ;... process error & quit
"RTN","VEEMVPE",39,0)
 Q
"RTN","VEEMVPE",40,0)
 ;
"RTN","VEEMVPE",41,0)
DDSERR ;Form couldn't load
"RTN","VEEMVPE",42,0)
 NEW I
"RTN","VEEMVPE",43,0)
 W @IOF,!!,"Screenman couldn't load this form."
"RTN","VEEMVPE",44,0)
 S I=0
"RTN","VEEMVPE",45,0)
 F  S I=$O(^TMP("DIERR",$J,1,"TEXT",I)) Q:I'>0  W !,^(I)
"RTN","VEEMVPE",46,0)
 D PAUSE^%ZVEMKU(2,"R")
"RTN","VEEMVPE",47,0)
 KILL ^TMP("DIERR",$J)
"RTN","VEEMVPE",48,0)
 Q
"RTN","ZVEMBLD")
0^202^B2632287
"RTN","ZVEMBLD",1,0)
ZVEMBLD ;DJB,VSHL**VPE Setup - Start ; 1/5/04 7:37am
"RTN","ZVEMBLD",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMBLD",3,0)
 ;
"RTN","ZVEMBLD",4,0)
 I $G(VEESHL)="RUN" D  Q
"RTN","ZVEMBLD",5,0)
 . W $C(7),!?2,"Please exit the VShell before running ^ZVEMBLD.",!
"RTN","ZVEMBLD",6,0)
 NEW END,FF,FLAGQ,I,LINE,START,TO,TXT,U,X,XX,Y
"RTN","ZVEMBLD",7,0)
 D INIT S FLAGQ=0
"RTN","ZVEMBLD",8,0)
 D PAGE1^ZVEMBLDA G:FLAGQ EX
"RTN","ZVEMBLD",9,0)
 D PAGE2^ZVEMBLDA G:FLAGQ EX
"RTN","ZVEMBLD",10,0)
 D PAGE3^ZVEMBLDA G:FLAGQ EX
"RTN","ZVEMBLD",11,0)
 D PAGE4^ZVEMBLDB G:FLAGQ EX
"RTN","ZVEMBLD",12,0)
 D PAGE5^ZVEMBLDB G:FLAGQ EX
"RTN","ZVEMBLD",13,0)
 D PAGE6^ZVEMBLDB G:FLAGQ EX
"RTN","ZVEMBLD",14,0)
 D UCI G:FLAGQ EX
"RTN","ZVEMBLD",15,0)
 D ^ZVEMBLDL
"RTN","ZVEMBLD",16,0)
EX ;
"RTN","ZVEMBLD",17,0)
 Q
"RTN","ZVEMBLD",18,0)
UCI ;
"RTN","ZVEMBLD",19,0)
 W @FF
"RTN","ZVEMBLD",20,0)
 Q:'$D(^%ZOSF("UCI"))  X ^%ZOSF("UCI") I Y["MG" Q
"RTN","ZVEMBLD",21,0)
 W $C(7),!!?2,"THIS IS NOT THE MANAGER UCI. I think it is ",Y,"."
"RTN","ZVEMBLD",22,0)
 D YESNO("Should I continue anyway: YES// ")
"RTN","ZVEMBLD",23,0)
 Q
"RTN","ZVEMBLD",24,0)
YESNO(PROMPT) ;Process YES/NO questions
"RTN","ZVEMBLD",25,0)
 ;Return FLAGQ: 1=NO  2="^"
"RTN","ZVEMBLD",26,0)
 NEW XX S PROMPT=$G(PROMPT)
"RTN","ZVEMBLD",27,0)
YN W !?2,PROMPT R XX:TO S:'$T XX="^" S:XX="" XX="YES" S XX=$E(XX)
"RTN","ZVEMBLD",28,0)
 S:"Nn"[XX FLAGQ=1 S:"^"[XX FLAGQ=2 Q:FLAGQ
"RTN","ZVEMBLD",29,0)
 I "YyNn"'[XX W !?10,"Y=Yes  N=No  ^=Quit" G YN
"RTN","ZVEMBLD",30,0)
 Q
"RTN","ZVEMBLD",31,0)
ASK ;
"RTN","ZVEMBLD",32,0)
 NEW X
"RTN","ZVEMBLD",33,0)
 W !?1,"<RETURN> to continue, '^' to quit: "
"RTN","ZVEMBLD",34,0)
 R X:TO S:'$T X="^" I X'="" S FLAGQ=1 Q
"RTN","ZVEMBLD",35,0)
 Q
"RTN","ZVEMBLD",36,0)
INIT ;Set numbers
"RTN","ZVEMBLD",37,0)
 S $P(LINE,"@",76)="",U="^",TO=300
"RTN","ZVEMBLD",38,0)
 I $G(IOF)]"" S FF=IOF Q
"RTN","ZVEMBLD",39,0)
 I $D(^%ZIS(1)) D HOME^%ZIS S FF=IOF Q
"RTN","ZVEMBLD",40,0)
 S FF="#,$C(27),""[2J"",$C(27),""[H"""
"RTN","ZVEMBLD",41,0)
 Q
"RTN","ZVEMBLDA")
0^203^B8470651
"RTN","ZVEMBLDA",1,0)
ZVEMBLDA ;DJB,VSHL**VPE Setup - Pages 1-3 [2/18/96 8:48am]
"RTN","ZVEMBLDA",2,0)
 ;;10;VPE;COPYRIGHT David Bolduc @1993;;Build 8
"RTN","ZVEMBLDA",3,0)
 ;
"RTN","ZVEMBLDA",4,0)
PAGE1 ;
"RTN","ZVEMBLDA",5,0)
 W @FF S START=10,END=START+4
"RTN","ZVEMBLDA",6,0)
 F I=START:1:END W !?I,"\" W:I=(END-2) "____" W:I=(END-1) "db" W ?(END*2+1-I),"/" W:I=(END-1) "  I  C  T  O  R  Y    S  O  F  T  W  A  R  E"
"RTN","ZVEMBLDA",7,0)
 W !!!?19,"** VICTORY  PROGRAMMER  ENVIROMENT **"
"RTN","ZVEMBLDA",8,0)
 W !!!?2,"WELCOME to the Victory Programmer Environment. VPE consists of a number"
"RTN","ZVEMBLDA",9,0)
 W !!?2,"of integrated programmer utilities that will increase your productivity"
"RTN","ZVEMBLDA",10,0)
 W !!?2,"and dramatically decrease the number of key strokes required to complete"
"RTN","ZVEMBLDA",11,0)
 W !!?2,"your normal tasks."
"RTN","ZVEMBLDA",12,0)
 W !!!! D ASK^ZVEMBLD
"RTN","ZVEMBLDA",13,0)
 Q
"RTN","ZVEMBLDA",14,0)
PAGE2 ;
"RTN","ZVEMBLDA",15,0)
 W @FF,!!?2,"V I C T O R Y   P R O G R A M M E R   E N V I R O N M E N T"
"RTN","ZVEMBLDA",16,0)
 W !!!?2,"GLOBAL LISTER/EDITOR"
"RTN","ZVEMBLDA",17,0)
 W !?2,"Use to view your globals. Has extensive support for VA FILEMAN files."
"RTN","ZVEMBLDA",18,0)
 W !!?2,"ROUTINE READER/EDITOR"
"RTN","ZVEMBLDA",19,0)
 W !?2,"Use to read and edit routines. Allows branching to other routines to"
"RTN","ZVEMBLDA",20,0)
 W !?2,"follow the flow of the code or capture code for importing into the"
"RTN","ZVEMBLDA",21,0)
 W !?2,"current routine."
"RTN","ZVEMBLDA",22,0)
 W !!?2,"ELECTRONIC DATA DICTIONARY"
"RTN","ZVEMBLDA",23,0)
 W !?2,"Easy to use utility for viewing the data dictionaries of VA FILEMAN files."
"RTN","ZVEMBLDA",24,0)
 W !!?2,"PROGRAMMER VSHELL"
"RTN","ZVEMBLDA",25,0)
 W !?2,"A replacement for conventional 'Programmer's Mode'. Provides a safe,"
"RTN","ZVEMBLDA",26,0)
 W !?2,"productive environment for M programmers. You will wonder how you ever"
"RTN","ZVEMBLDA",27,0)
 W !?2,"got along without it."
"RTN","ZVEMBLDA",28,0)
 W !! D ASK^ZVEMBLD
"RTN","ZVEMBLDA",29,0)
 Q
"RTN","ZVEMBLDA",30,0)
PAGE3 ;
"RTN","ZVEMBLDA",31,0)
 W @FF,!!?2,"G L O B A L   P R O T E C T I O N"
"RTN","ZVEMBLDA",32,0)
 W !!!?2,"If you receive 'Protection Errors' when you first start the VSHELL,"
"RTN","ZVEMBLDA",33,0)
 W !?2,"check that the following globals are set correctly:"
"RTN","ZVEMBLDA",34,0)
 W !!?5,"^%ZOSF   System-RWD   World-R     Group-R     User-RWD"
"RTN","ZVEMBLDA",35,0)
 W !!?5,"^%ZVEMS  System-RWD   World-RWD   Group-RWD   User-RWD"
"RTN","ZVEMBLDA",36,0)
 W !!!?2,"If you have the VA KERNEL software on your system, you should confirm"
"RTN","ZVEMBLDA",37,0)
 W !?2,"that node ^%ZOSF(""OS"") is set correctly. The 2nd piece of this node"
"RTN","ZVEMBLDA",38,0)
 W !?2,"should be the number of your Mumps system. See node ^DD(""OS"")."
"RTN","ZVEMBLDA",39,0)
 W !?5,"DSM=2  MSM=8  DTM=9  VAXDSM=16"
"RTN","ZVEMBLDA",40,0)
 W !!!!! D ASK^ZVEMBLD
"RTN","ZVEMBLDA",41,0)
 Q
"RTN","ZVEMBLDB")
0^204^B5123279
"RTN","ZVEMBLDB",1,0)
ZVEMBLDB ;DJB,VSHL**VPE Setup - Pages 4-7 ; 1/5/04 7:48am
"RTN","ZVEMBLDB",2,0)
 ;;10;VPE;COPYRIGHT David Bolduc @1993;;Build 8
"RTN","ZVEMBLDB",3,0)
PAGE4 ;Instructions for upgrading VPE
"RTN","ZVEMBLDB",4,0)
 W @FF,!!?2,"U P G R A D E"
"RTN","ZVEMBLDB",5,0)
 W !!?2,"IF YOU CURRENTLY HAVE AN EARLIER VERSION OF VPE ON YOUR"
"RTN","ZVEMBLDB",6,0)
 W !?2,"SYSTEM, FOLLOW THESE INSTRUCTIONS TO UPGRADE SMOOTHLY."
"RTN","ZVEMBLDB",7,0)
 W !!?2,"1) Have all users save their QWIKs (Use ..QSAVE System QWIK)."
"RTN","ZVEMBLDB",8,0)
 W !?2,"2) Make sure all users have halted off VPE Shell."
"RTN","ZVEMBLDB",9,0)
 W !?2,"3) Delete routines ^ZVEM*, ^%ZVEM*, and ^VEEM*."
"RTN","ZVEMBLDB",10,0)
 W !?2,"4) Kill global ^%ZVEMS."
"RTN","ZVEMBLDB",11,0)
 W !?2,"5) Load VPE_xx.MGR routines from the disk."
"RTN","ZVEMBLDB",12,0)
 W !?2,"6) DO ^ZVEMBLD to install VPE."
"RTN","ZVEMBLDB",13,0)
 W !?2,"7) Load VPE_xx.PRD routines from the disk."
"RTN","ZVEMBLDB",14,0)
 W !?2,"8) DO ^VEEMINIT to install VPE Fileman files."
"RTN","ZVEMBLDB",15,0)
 W !?2,"9) Start VPE Shell and run ..QSAVE to restore your QWIKs."
"RTN","ZVEMBLDB",16,0)
 W !?1,"10) Run ..PARAM to adjust your parameters."
"RTN","ZVEMBLDB",17,0)
 W !!!!! D ASK^ZVEMBLD
"RTN","ZVEMBLDB",18,0)
 Q
"RTN","ZVEMBLDB",19,0)
PAGE5 ;
"RTN","ZVEMBLDB",20,0)
 W @FF,!!?2,"D E I N S T A L L"
"RTN","ZVEMBLDB",21,0)
 W !!!?2,"To completely deinstall VPE do the following:"
"RTN","ZVEMBLDB",22,0)
 W !!?2,"1) GLOBALS:      MGR      KILL ^%ZVEMS"
"RTN","ZVEMBLDB",23,0)
 W !!?2,"2) ROUTINES:     MGR      DELETE ^%ZVEM*"
"RTN","ZVEMBLDB",24,0)
 W !?2,"                 MGR      DELETE ^ZVEM*"
"RTN","ZVEMBLDB",25,0)
 W !?2,"                 PRD      DELETE ^VEEM*"
"RTN","ZVEMBLDB",26,0)
 W !?2,"3) FILES:        PRD      DELETE VPE* files in FM"
"RTN","ZVEMBLDB",27,0)
 W !!!!!!!!! D ASK^ZVEMBLD
"RTN","ZVEMBLDB",28,0)
 Q
"RTN","ZVEMBLDB",29,0)
PAGE6 ;Modules list
"RTN","ZVEMBLDB",30,0)
 W @FF,!!?2,"V P E   M O D U L E S   L I S T"
"RTN","ZVEMBLDB",31,0)
 W !!?40,"ROUTINES",?58,"ACTION"
"RTN","ZVEMBLDB",32,0)
 W !?40,"--------",?54,"---------------"
"RTN","ZVEMBLDB",33,0)
 W !?4,"VGL...Global Lister/Editor..........^%ZVEMG*......DO ^%ZVEMG"
"RTN","ZVEMBLDB",34,0)
 W !?4,"VRR...Routine Reader................^%ZVEMR*......DO ^%ZVEMR"
"RTN","ZVEMBLDB",35,0)
 W !?4,"E.....Routine Editor...............................X ^%ZVEMS(""E"")"
"RTN","ZVEMBLDB",36,0)
 W !?4,"VEDD..Electronic Data Dictionary...^%ZVEMD*......DO ^%ZVEMD"
"RTN","ZVEMBLDB",37,0)
 W !?4,"      VPE Shell.....................^%ZVEMS*.......X ^%ZVEMS"
"RTN","ZVEMBLDB",38,0)
 W !!!!!!!!!!! D ASK^ZVEMBLD
"RTN","ZVEMBLDB",39,0)
 Q
"RTN","ZVEMBLDL")
0^205^B5503046
"RTN","ZVEMBLDL",1,0)
ZVEMBLDL ;DJB,VSHL**VPE Setup - Load Editor & Shell ; 9/7/02 2:06pm
"RTN","ZVEMBLDL",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMBLDL",3,0)
 ;
"RTN","ZVEMBLDL",4,0)
TOP ;
"RTN","ZVEMBLDL",5,0)
 D SHELL
"RTN","ZVEMBLDL",6,0)
 I FLAGQ D  G EX
"RTN","ZVEMBLDL",7,0)
 . W !!,"VPE Shell global not loaded."
"RTN","ZVEMBLDL",8,0)
 D EDITOR
"RTN","ZVEMBLDL",9,0)
 W !!,"VPE Programmer Shell successfully loaded."
"RTN","ZVEMBLDL",10,0)
 W !,"VPE full screen routine editor successfully loaded."
"RTN","ZVEMBLDL",11,0)
 W !,"Initialization finished."
"RTN","ZVEMBLDL",12,0)
 W !!,"NOTE: To start the VPE Shell, type:  X ^%ZVEMS"
"RTN","ZVEMBLDL",13,0)
 R !!,"<RETURN> to continue..",XX:300
"RTN","ZVEMBLDL",14,0)
 D DISCLAIM^%ZVEMKU1
"RTN","ZVEMBLDL",15,0)
EX ;
"RTN","ZVEMBLDL",16,0)
 Q
"RTN","ZVEMBLDL",17,0)
 ;===================================================================
"RTN","ZVEMBLDL",18,0)
SHELL ;Load VPE Shell Global - ^%ZVEMS
"RTN","ZVEMBLDL",19,0)
 S FLAGQ=0
"RTN","ZVEMBLDL",20,0)
 ;W !!?2,"S T E P   2",!
"RTN","ZVEMBLDL",21,0)
 D YESNO^ZVEMBLD("Load VPE Shell global: YES// ")
"RTN","ZVEMBLDL",22,0)
 Q:FLAGQ
"RTN","ZVEMBLDL",23,0)
 D ALL^ZVEMSG
"RTN","ZVEMBLDL",24,0)
 Q
"RTN","ZVEMBLDL",25,0)
 ;
"RTN","ZVEMBLDL",26,0)
EDITOR ;Load Editor into ^%ZVEMS("E") global
"RTN","ZVEMBLDL",27,0)
 NEW CODE,I,TXT
"RTN","ZVEMBLDL",28,0)
 ;S FLAGQ=0
"RTN","ZVEMBLDL",29,0)
 ;W !!?2,"S T E P   1",!
"RTN","ZVEMBLDL",30,0)
 ;D YESNO^ZVEMBLD("Install 'VPE Routine Editor': YES// ")
"RTN","ZVEMBLDL",31,0)
 ;Q:FLAGQ
"RTN","ZVEMBLDL",32,0)
EDITOR1 ;
"RTN","ZVEMBLDL",33,0)
 S TXT=$T(CODE+1)
"RTN","ZVEMBLDL",34,0)
 S CODE=$P(TXT,";",3,99)
"RTN","ZVEMBLDL",35,0)
 KILL ^%ZVEMS("E")
"RTN","ZVEMBLDL",36,0)
 S ^%ZVEMS("E")=CODE
"RTN","ZVEMBLDL",37,0)
 F I=2:1 S TXT=$T(CODE+I) Q:$P(TXT,";",3)="***"  S CODE=$P(TXT,";",3,99),^%ZVEMS("E",I-1)=CODE
"RTN","ZVEMBLDL",38,0)
 Q
"RTN","ZVEMBLDL",39,0)
 ;
"RTN","ZVEMBLDL",40,0)
CODE ;Global for Rtn editing
"RTN","ZVEMBLDL",41,0)
 ;;X ^%ZVEMS("E",3) Q:$G(DUZ)=""  NEW FLAGSAVE,FLAGVPE,VEES NEW:$G(VEE("OS"))']"" VEE X ^%ZVEMS("E",4) Q:'$D(^TMP("VEE","VRR",$J))  X ^%ZVEMS("E",1) KILL ^UTILITY($J) L
"RTN","ZVEMBLDL",42,0)
 ;;NEW %Y,VRRPGM,X D SAVE^%ZVEMRC(1) Q:$G(VRRPGM)']""  X ^%ZVEMS("E",2)
"RTN","ZVEMBLDL",43,0)
 ;;NEW X S X=VRRPGM X VEES("ZS"),^%ZVEMS("E",5)
"RTN","ZVEMBLDL",44,0)
 ;;Q:$G(DUZ)>0  S ^TMP("VEE",$J,1)=$G(%1),^(2)=$G(%2) D ID^%ZVEMKU S:$G(VEESHL)="RUN" %1=^TMP("VEE",$J,1),%2=^(2) KILL ^TMP("VEE",$J)
"RTN","ZVEMBLDL",45,0)
 ;;S $P(FLAGVPE,"^",4)="EDIT" D PARAM^%ZVEMR($G(%1),$G(%2))
"RTN","ZVEMBLDL",46,0)
 ;;Q:VEE("OS")'=17&(VEE("OS")'=19)  NEW LINK,PGM S PGM=VRRPGM,PGM=$TR(PGM,"%","_") S LINK="ZLINK """_PGM_"""" X LINK
"RTN","ZVEMBLDL",47,0)
 ;;***
"RTN","ZVEMBLDO")
0^206^B4526548
"RTN","ZVEMBLDO",1,0)
ZVEMBLDO ;DJB,VSHL**VPE Setup - Old Editor ; 12/15/00 5:21pm
"RTN","ZVEMBLDO",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMBLDO",3,0)
 ;
"RTN","ZVEMBLDO",4,0)
TOP ;
"RTN","ZVEMBLDO",5,0)
 NEW END,FF,FLAGQ,I,LINE,START,TO,TXT,U,X,XX,Y
"RTN","ZVEMBLDO",6,0)
 NEW CNT,LN,RTN,TAG
"RTN","ZVEMBLDO",7,0)
 S FLAGQ=0
"RTN","ZVEMBLDO",8,0)
 D INIT^ZVEMBLD G:FLAGQ EX
"RTN","ZVEMBLDO",9,0)
 D UCI^ZVEMBLD G:FLAGQ EX
"RTN","ZVEMBLDO",10,0)
 D EDITOLD G:FLAGQ EX
"RTN","ZVEMBLDO",11,0)
 ;Next, load Help text
"RTN","ZVEMBLDO",12,0)
 S CNT=1
"RTN","ZVEMBLDO",13,0)
 KILL ^%ZVEMS("ZZ","VRROLD")
"RTN","ZVEMBLDO",14,0)
 S RTN="ZVEMOH",TAG="VRROLD" D TEXT2^ZVEMSGH
"RTN","ZVEMBLDO",15,0)
 S RTN="ZVEMOH1",TAG="VRROLD" D TEXT2^ZVEMSGH
"RTN","ZVEMBLDO",16,0)
 S RTN="ZVEMOH2",TAG="VRROLD" D TEXT2^ZVEMSGH
"RTN","ZVEMBLDO",17,0)
EX ;
"RTN","ZVEMBLDO",18,0)
 Q
"RTN","ZVEMBLDO",19,0)
EDITOLD ;Load old Editor into ^%ZVEMS("EOLD") global
"RTN","ZVEMBLDO",20,0)
 NEW CODE,I,TXT
"RTN","ZVEMBLDO",21,0)
 S FLAGQ=0
"RTN","ZVEMBLDO",22,0)
 W !!?2,"Install global at ""%ZVEMS(""EOLD"")",!
"RTN","ZVEMBLDO",23,0)
 D YESNO^ZVEMBLD("Install old Routine Editor global: YES// ") Q:FLAGQ
"RTN","ZVEMBLDO",24,0)
 S TXT=$T(CODEOLD+1)
"RTN","ZVEMBLDO",25,0)
 S CODE=$P(TXT,";",3,99)
"RTN","ZVEMBLDO",26,0)
 KILL ^%ZVEMS("EOLD")
"RTN","ZVEMBLDO",27,0)
 S ^%ZVEMS("EOLD")=CODE
"RTN","ZVEMBLDO",28,0)
 F I=2:1 S TXT=$T(CODEOLD+I) Q:$P(TXT,";",3)="***"  S CODE=$P(TXT,";",3,99),^%ZVEMS("EOLD",I-1)=CODE
"RTN","ZVEMBLDO",29,0)
 W !!?2,"Old routine editor successfully loaded.",!
"RTN","ZVEMBLDO",30,0)
 Q
"RTN","ZVEMBLDO",31,0)
 ;
"RTN","ZVEMBLDO",32,0)
CODEOLD ;Old global for rtn editing
"RTN","ZVEMBLDO",33,0)
 ;;X ^%ZVEMS("EOLD",3) Q:$G(DUZ)=""  NEW FLAGSAVE,FLAGVPE,VEES NEW:$G(VEE("OS"))']"" VEE X ^%ZVEMS("EOLD",4) Q:'$D(^TMP("VEE","VRR",$J))  X ^%ZVEMS("EOLD",1) L
"RTN","ZVEMBLDO",34,0)
 ;;NEW VRRPGM,X D SAVE^%ZVEMOC Q:$G(VRRPGM)']""  X ^%ZVEMS("EOLD",2)
"RTN","ZVEMBLDO",35,0)
 ;;NEW X S X=VRRPGM X VEES("ZS") KILL ^UTILITY($J)
"RTN","ZVEMBLDO",36,0)
 ;;Q:$G(DUZ)>0  S ^TMP("VEE",$J)=$G(%1) D ID^%ZVEMKU S:$G(VEESHL)="RUN" %1=^TMP("VEE",$J) KILL ^TMP("VEE",$J)
"RTN","ZVEMBLDO",37,0)
 ;;S $P(FLAGVPE,"^",4)="EDIT",FLAGSAVE=0 D PARAM^%ZVEMO($G(%1))
"RTN","ZVEMBLDO",38,0)
 ;;***
"RTN","ZVEMDH1")
0^207^B4798983
"RTN","ZVEMDH1",1,0)
ZVEMDH1 ;DJB,VEDD**Help Text - Main Menu [06/07/94]
"RTN","ZVEMDH1",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMDH1",3,0)
 ;
"RTN","ZVEMDH1",4,0)
VEDD1 ;;;
"RTN","ZVEMDH1",5,0)
 ;;; A)  E N T R Y   P O I N T S:
"RTN","ZVEMDH1",6,0)
 ;;;
"RTN","ZVEMDH1",7,0)
 ;;;        ^%ZVEMD  - Main entry point.
"RTN","ZVEMDH1",8,0)
 ;;;     DIR^%ZVEMD  - Bypasses opening screen.
"RTN","ZVEMDH1",9,0)
 ;;;
"RTN","ZVEMDH1",10,0)
 ;;; B)  M E N U   O P T I O N S:
"RTN","ZVEMDH1",11,0)
 ;;;
"RTN","ZVEMDH1",12,0)
 ;;;     1) Cross References - An '*' in the far left column indicates that if
"RTN","ZVEMDH1",13,0)
 ;;;                           you concantenate the global shown on the Main Menu
"RTN","ZVEMDH1",14,0)
 ;;;                           screen with this XREF, there will be data.
"RTN","ZVEMDH1",15,0)
 ;;;
"RTN","ZVEMDH1",16,0)
 ;;;     2) Pointers IN - Lists all files that point to this file.
"RTN","ZVEMDH1",17,0)
 ;;;
"RTN","ZVEMDH1",18,0)
 ;;;     3) Pointers OUT - Lists all fields in this file that are pointers and
"RTN","ZVEMDH1",19,0)
 ;;;                       the files they point to. An 'M' in the far left
"RTN","ZVEMDH1",20,0)
 ;;;                       column indicates the pointing field is a multiple.
"RTN","ZVEMDH1",21,0)
 ;;;                       Use 'Trace a Field' to determine its path.
"RTN","ZVEMDH1",22,0)
 ;;;
"RTN","ZVEMDH1",23,0)
 ;;;     4) Groups - In Filemanager Groups are a shorthand way for a user to
"RTN","ZVEMDH1",24,0)
 ;;;                 call up several fields at once for Print or Entrer/Edit
"RTN","ZVEMDH1",25,0)
 ;;;                 purposes. Also, some programmers use Groups to keep track
"RTN","ZVEMDH1",26,0)
 ;;;                 of locally added/alterred fields. See VA FILEMAN USER'S
"RTN","ZVEMDH1",27,0)
 ;;;                 MANUAL to learn how to use Groups.
"RTN","ZVEMDH1",28,0)
 ;;;***
"RTN","ZVEMDH2")
0^208^B8418896
"RTN","ZVEMDH2",1,0)
ZVEMDH2 ;DJB,VEDD**Help Text - Main Menu [7/19/95 9:14pm]
"RTN","ZVEMDH2",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMDH2",3,0)
 ;
"RTN","ZVEMDH2",4,0)
VEDD1 ;;;
"RTN","ZVEMDH2",5,0)
 ;;;
"RTN","ZVEMDH2",6,0)
 ;;;     5) Trace a Field - Displays the pathway to fields that are decendent
"RTN","ZVEMDH2",7,0)
 ;;;                        from a multiple.
"RTN","ZVEMDH2",8,0)
 ;;;                        Example: When looking at PATIENT file, you type
"RTN","ZVEMDH2",9,0)
 ;;;                        'MOV' at the 'Enter Field Name:' prompt. Trace a
"RTN","ZVEMDH2",10,0)
 ;;;                        Field will display:
"RTN","ZVEMDH2",11,0)
 ;;;                                  401 Admission Date/Time
"RTN","ZVEMDH2",12,0)
 ;;;                                    5 Treating Specialty
"RTN","ZVEMDH2",13,0)
 ;;;                                 1000 Movement Number
"RTN","ZVEMDH2",14,0)
 ;;;                        This is the pathway to the MOVEMENT NUMBER field.
"RTN","ZVEMDH2",15,0)
 ;;;                        You can now select 'I' and type in the field
"RTN","ZVEMDH2",16,0)
 ;;;                        number of each field in the path. You will get the
"RTN","ZVEMDH2",17,0)
 ;;;                        Individual Field Listing for the MOVEMENT NUMBER field.
"RTN","ZVEMDH2",18,0)
 ;;;
"RTN","ZVEMDH2",19,0)
 ;;;     6) Indiv Fld DD - Lists contents of the Data Dictionary for selected
"RTN","ZVEMDH2",20,0)
 ;;;                       field.
"RTN","ZVEMDH2",21,0)
 ;;;
"RTN","ZVEMDH2",22,0)
 ;;;     7) Fld Global Location - List of all fields and their global
"RTN","ZVEMDH2",23,0)
 ;;;                           location (NODE;PIECE). When working with larger
"RTN","ZVEMDH2",24,0)
 ;;;                           files, you may start the list at a particular
"RTN","ZVEMDH2",25,0)
 ;;;                           field or a particular screen. See the HELP that's
"RTN","ZVEMDH2",26,0)
 ;;;                           available in this option.
"RTN","ZVEMDH2",27,0)
 ;;;
"RTN","ZVEMDH2",28,0)
 ;;;     8) Templates - Lists Print, Sort, and Input templates. If the listing
"RTN","ZVEMDH2",29,0)
 ;;;                    is too long for any type, you may enter 'S' and skip
"RTN","ZVEMDH2",30,0)
 ;;;                    over to next type.
"RTN","ZVEMDH2",31,0)
 ;;;
"RTN","ZVEMDH2",32,0)
 ;;;     9) File Description - Narrative describing the selected file.
"RTN","ZVEMDH2",33,0)
 ;;;
"RTN","ZVEMDH2",34,0)
 ;;;     10) File Characteristics  - Displays post-selection actions, special
"RTN","ZVEMDH2",35,0)
 ;;;                             look-up programs, and identifiers. For more
"RTN","ZVEMDH2",36,0)
 ;;;                             information on any of these topics see Chapter 5
"RTN","ZVEMDH2",37,0)
 ;;;                             Section D of the VA Fileman Programmers' manual
"RTN","ZVEMDH2",38,0)
 ;;;                             (Version 18).
"RTN","ZVEMDH2",39,0)
 ;;;***
"RTN","ZVEMDH3")
0^209^B5660370
"RTN","ZVEMDH3",1,0)
ZVEMDH3 ;DJB,VEDD**Help Text - Main Menu [7/19/95 9:14pm]
"RTN","ZVEMDH3",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMDH3",3,0)
 ;
"RTN","ZVEMDH3",4,0)
VEDD1 ;;;
"RTN","ZVEMDH3",5,0)
 ;;;
"RTN","ZVEMDH3",6,0)
 ;;;     11) Required Fields  - Lists all fields that are Required.
"RTN","ZVEMDH3",7,0)
 ;;;
"RTN","ZVEMDH3",8,0)
 ;;;     12) VGL - Victory Global Lister. To use this option your DUZ(0) must
"RTN","ZVEMDH3",9,0)
 ;;;               must contain '@' or '#'.
"RTN","ZVEMDH3",10,0)
 ;;;
"RTN","ZVEMDH3",11,0)
 ;;;     13) Printing-On/Off  - Allows you to send screens to a printer. You
"RTN","ZVEMDH3",12,0)
 ;;;                            will be offered the DEVICE: prompt. Enter printer.
"RTN","ZVEMDH3",13,0)
 ;;;                            After <RETURN>, Main Menu will reappear and
"RTN","ZVEMDH3",14,0)
 ;;;                            PRINTING STATUS, in the top half of the screen,
"RTN","ZVEMDH3",15,0)
 ;;;                            will be set to 'ON'. You then select a Main
"RTN","ZVEMDH3",16,0)
 ;;;                            Menu option and output will go to the selected
"RTN","ZVEMDH3",17,0)
 ;;;                            device. When you return to the Main Menu,
"RTN","ZVEMDH3",18,0)
 ;;;                            PRINTING STATUS will be 'OFF'. To print again
"RTN","ZVEMDH3",19,0)
 ;;;                            you must select Printing On/Off option again
"RTN","ZVEMDH3",20,0)
 ;;;                            to reset PRINTING STATUS to 'ON'. If PRINTING
"RTN","ZVEMDH3",21,0)
 ;;;                            STATUS is 'ON' you may turn it off by selecting
"RTN","ZVEMDH3",22,0)
 ;;;                            Printing On/Off option again. To slave
"RTN","ZVEMDH3",23,0)
 ;;;                            print, enter '0;;60' at the DEVICE: prompt.
"RTN","ZVEMDH3",24,0)
 ;;;
"RTN","ZVEMDH3",25,0)
 ;;;                            NOTE: Since all screens are designed to be
"RTN","ZVEMDH3",26,0)
 ;;;                            displayed on a CRT, printing to a 10 pitch
"RTN","ZVEMDH3",27,0)
 ;;;                            80 margin printer looks best.
"RTN","ZVEMDH3",28,0)
 ;;;***
"RTN","ZVEMDH4")
0^210^B10174356
"RTN","ZVEMDH4",1,0)
ZVEMDH4 ;DJB,VEDD**Help Text - Field Global Location [08/01/94]
"RTN","ZVEMDH4",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMDH4",3,0)
 ;
"RTN","ZVEMDH4",4,0)
VEDD2 ;;;
"RTN","ZVEMDH4",5,0)
 ;;; E N T E R                            R  E  S  U  L  T
"RTN","ZVEMDH4",6,0)
 ;;; ---------    ----------------------------------------------------------------
"RTN","ZVEMDH4",7,0)
 ;;;
"RTN","ZVEMDH4",8,0)
 ;;;    ^         Quit back to Main Menu.
"RTN","ZVEMDH4",9,0)
 ;;;
"RTN","ZVEMDH4",10,0)
 ;;;    ^^        Exit VEDD completely.
"RTN","ZVEMDH4",11,0)
 ;;;
"RTN","ZVEMDH4",12,0)
 ;;; <SPACE>      Quit back to Main Menu
"RTN","ZVEMDH4",13,0)
 ;;;
"RTN","ZVEMDH4",14,0)
 ;;; <ESC>H       Help text for scrolling.
"RTN","ZVEMDH4",15,0)
 ;;;
"RTN","ZVEMDH4",16,0)
 ;;;    I         Allows you to select a field and display its data dictionary.
"RTN","ZVEMDH4",17,0)
 ;;;
"RTN","ZVEMDH4",18,0)
 ;;;   'n'        Entering a field's Reference number from the REF column, is a
"RTN","ZVEMDH4",19,0)
 ;;;              shortcut method for displaying a field's data dictionary.
"RTN","ZVEMDH4",20,0)
 ;;;
"RTN","ZVEMDH4",21,0)
 ;;;  <TAB>       As noted above, you enter the REF number to select a field.
"RTN","ZVEMDH4",22,0)
 ;;;              You may also select a field by positioning the highlight
"RTN","ZVEMDH4",23,0)
 ;;;              located on the extreme left hand side of the screen, and then
"RTN","ZVEMDH4",24,0)
 ;;;              hitting <TAB>.
"RTN","ZVEMDH4",25,0)
 ;;;
"RTN","ZVEMDH4",26,0)
 ;;;    D         Data display. In addition to the data dictionary, you may
"RTN","ZVEMDH4",27,0)
 ;;;              look at the actual data in the file. After selecting a REF
"RTN","ZVEMDH4",28,0)
 ;;;              number or range of numbers, you select the type of display
"RTN","ZVEMDH4",29,0)
 ;;;              you want. You have the following choices:
"RTN","ZVEMDH4",30,0)
 ;;;                         E  = External values
"RTN","ZVEMDH4",31,0)
 ;;;                         I  = Internal values
"RTN","ZVEMDH4",32,0)
 ;;;                         EN = External values, null fields ignored
"RTN","ZVEMDH4",33,0)
 ;;;                         IN = Internal values, null fields ignored
"RTN","ZVEMDH4",34,0)
 ;;;              You will then be asked which entry you want to see. If any
"RTN","ZVEMDH4",35,0)
 ;;;              of the fields you requested are multiples, you will also be
"RTN","ZVEMDH4",36,0)
 ;;;              asked which multiple entry you want to see.  After viewing
"RTN","ZVEMDH4",37,0)
 ;;;              the data, you are returned to the Global Location screen.
"RTN","ZVEMDH4",38,0)
 ;;;
"RTN","ZVEMDH4",39,0)
 ;;;    F         Find a field. You will be prompted for a field name. Enter a
"RTN","ZVEMDH4",40,0)
 ;;;              name or part of a name. VEDD will locate the field and position
"RTN","ZVEMDH4",41,0)
 ;;;              it at the top of the display. If no field is found the screen
"RTN","ZVEMDH4",42,0)
 ;;;              will be blank because you are at the end of the file. Use the
"RTN","ZVEMDH4",43,0)
 ;;;              Up-Arrow key to scroll up and again display fields.
"RTN","ZVEMDH4",44,0)
 ;;;***
"RTN","ZVEMDH5")
0^211^B10128668
"RTN","ZVEMDH5",1,0)
ZVEMDH5 ;DJB,VEDD**Help Text - Field Global Location [11/05/94]
"RTN","ZVEMDH5",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMDH5",3,0)
 ;
"RTN","ZVEMDH5",4,0)
VEDD2 ;;;
"RTN","ZVEMDH5",5,0)
 ;;;
"RTN","ZVEMDH5",6,0)
 ;;;    G         Goto a REF number. Select a REF number from the left hand
"RTN","ZVEMDH5",7,0)
 ;;;              column, and that field will be positioned at the top of the
"RTN","ZVEMDH5",8,0)
 ;;;              display. If you select a REF number that has not yet been
"RTN","ZVEMDH5",9,0)
 ;;;              displayed, the last field viewed will be positioned at the top
"RTN","ZVEMDH5",10,0)
 ;;;              of the display. G 1 to return to the beginning display.
"RTN","ZVEMDH5",11,0)
 ;;;
"RTN","ZVEMDH5",12,0)
 ;;; <HOME>       Returns you to beginning dislay. Since your terminal emulation
"RTN","ZVEMDH5",13,0)
 ;;;              software may use the <HOME> key for other purposes, you may
"RTN","ZVEMDH5",14,0)
 ;;;              type the word HOME for the same effect.
"RTN","ZVEMDH5",15,0)
 ;;;
"RTN","ZVEMDH5",16,0)
 ;;; <END>        Returns you to the highest field that's been displayed. You
"RTN","ZVEMDH5",17,0)
 ;;;              may type the word END for the same effect.
"RTN","ZVEMDH5",18,0)
 ;;;
"RTN","ZVEMDH5",19,0)
 ;;;    N         Allows you to do a look up by global node. At the 'Select
"RTN","ZVEMDH5",20,0)
 ;;;              NODE:' prompt type '?' to see all nodes, or enter node. If
"RTN","ZVEMDH5",21,0)
 ;;;              that node is a multiple you will be asked for subnode. You
"RTN","ZVEMDH5",22,0)
 ;;;              will then get a list of all fields that are contained by
"RTN","ZVEMDH5",23,0)
 ;;;              that node. You may then do an 'Individual Field Summary' on
"RTN","ZVEMDH5",24,0)
 ;;;              any field listed.
"RTN","ZVEMDH5",25,0)
 ;;;              Example: If you wanted to know what fields are contained
"RTN","ZVEMDH5",26,0)
 ;;;                         in ^DPT(34,"DA",3,"T",0) you would enter '^DPT' at
"RTN","ZVEMDH5",27,0)
 ;;;                         the 'Select FILE:' prompt, select option 7, enter
"RTN","ZVEMDH5",28,0)
 ;;;                         'N' for node, and then enter the following:
"RTN","ZVEMDH5",29,0)
 ;;;                              Select NODE: 'DA'
"RTN","ZVEMDH5",30,0)
 ;;;                              Select 'DA' SUBNODE: 'T'
"RTN","ZVEMDH5",31,0)
 ;;;                              Select 'T' SUBNODE: '0'
"RTN","ZVEMDH5",32,0)
 ;;;                         VEDD will now display all the fields contained in
"RTN","ZVEMDH5",33,0)
 ;;;                         the selected node and allow you to do an 'Individual
"RTN","ZVEMDH5",34,0)
 ;;;                         Field Summary'.
"RTN","ZVEMDH5",35,0)
 ;;;
"RTN","ZVEMDH5",36,0)
 ;;;    P         Allows you to branch off to a pointed-to file. P will prompt
"RTN","ZVEMDH5",37,0)
 ;;;              you for a REF number from the left hand column. If the
"RTN","ZVEMDH5",38,0)
 ;;;              field you select is a pointer field, the display will branch
"RTN","ZVEMDH5",39,0)
 ;;;              to that file. Pointer fields are marked with "<-Pntr".
"RTN","ZVEMDH5",40,0)
 ;;;
"RTN","ZVEMDH5",41,0)
 ;;;   VGL        Victory Global Lister
"RTN","ZVEMDH5",42,0)
 ;;;***
"RTN","ZVEMGH")
0^212^B9287570
"RTN","ZVEMGH",1,0)
ZVEMGH ;DJB,VGL**Help Text - Global Prompt [06/19/94]
"RTN","ZVEMGH",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMGH",3,0)
 ;
"RTN","ZVEMGH",4,0)
VGL1 ;;;
"RTN","ZVEMGH",5,0)
 ;;; V G L . . . . . . . . Victory Global Lister . . . . . . . . . . David Bolduc
"RTN","ZVEMGH",6,0)
 ;;;
"RTN","ZVEMGH",7,0)
 ;;; NOTE: DUZ(0) must contain either '@' or '#' to run VGL.
"RTN","ZVEMGH",8,0)
 ;;;
"RTN","ZVEMGH",9,0)
 ;;; A)  E N T E R:
"RTN","ZVEMGH",10,0)
 ;;;                A global reference
"RTN","ZVEMGH",11,0)
 ;;;                      -or-
"RTN","ZVEMGH",12,0)
 ;;;          <SPACE>.... to select global using a file name or number
"RTN","ZVEMGH",13,0)
 ;;;          Global*.... to select global from a list
"RTN","ZVEMGH",14,0)
 ;;;               *D.... for a directory list (DSM,DT,MSM)
"RTN","ZVEMGH",15,0)
 ;;;              *%D.... for a library directory list (DSM,DT,MSM)
"RTN","ZVEMGH",16,0)
 ;;;
"RTN","ZVEMGH",17,0)
 ;;;   The global reference may contain variables which must be defined.
"RTN","ZVEMGH",18,0)
 ;;;   Ranges can be specified with a ":" (colon), and multiple arguments
"RTN","ZVEMGH",19,0)
 ;;;   with a " " (space). Ending in a closed paren will prevent the display
"RTN","ZVEMGH",20,0)
 ;;;   from going below the last node specified.
"RTN","ZVEMGH",21,0)
 ;;;
"RTN","ZVEMGH",22,0)
 ;;;   EXAMPLES:
"RTN","ZVEMGH",23,0)
 ;;;
"RTN","ZVEMGH",24,0)
 ;;;       ^DD .................Will list all of ^DD.
"RTN","ZVEMGH",25,0)
 ;;;
"RTN","ZVEMGH",26,0)
 ;;;       ^VA(200 .............Will list all of global ^VA using first level
"RTN","ZVEMGH",27,0)
 ;;;                            subscript 200.
"RTN","ZVEMGH",28,0)
 ;;;
"RTN","ZVEMGH",29,0)
 ;;;       ^DPT(DFN ............Will list all of ^DPT using first level subscript
"RTN","ZVEMGH",30,0)
 ;;;                            equal to variable DFN.
"RTN","ZVEMGH",31,0)
 ;;;
"RTN","ZVEMGH",32,0)
 ;;;       ^%ZIS* ..............List each ^%ZIS node by the first subscript level,
"RTN","ZVEMGH",33,0)
 ;;;                            and allow user to select one for viewing.
"RTN","ZVEMGH",34,0)
 ;;;
"RTN","ZVEMGH",35,0)
 ;;;       ^DIC(4 9.4,1:10,0) ..In ^DIC the first level subscript may be either
"RTN","ZVEMGH",36,0)
 ;;;                            4 or 9.4, the second level subscript must be
"RTN","ZVEMGH",37,0)
 ;;;                            from 1 to 10, and the third level subscript
"RTN","ZVEMGH",38,0)
 ;;;                            must be 0.
"RTN","ZVEMGH",39,0)
 ;;;
"RTN","ZVEMGH",40,0)
 ;;;       ^DPT(,,, ............Will display only those nodes of ^DPT whose
"RTN","ZVEMGH",41,0)
 ;;;                            subscript is 4 levels or lower.
"RTN","ZVEMGH",42,0)
 ;;;
"RTN","ZVEMGH",43,0)
 ;;;       ^DIZ(,500:) .........In ^DIZ, any first level subscript, and second 
"RTN","ZVEMGH",44,0)
 ;;;                            level subscript equal to or greater than 500.
"RTN","ZVEMGH",45,0)
 ;;;
"RTN","ZVEMGH",46,0)
 ;;;       <SPACE>
"RTN","ZVEMGH",47,0)
 ;;;       Select FILE: 4 ......Select global for file 4 [INSTITUTION..^DIC(4,].
"RTN","ZVEMGH",48,0)
 ;;;
"RTN","ZVEMGH",49,0)
 ;;;       ^|"MGR","ROU"|EDI ...List ^EDI global which resides in MGR.
"RTN","ZVEMGH",50,0)
 ;;;***
"RTN","ZVEMGH1")
0^213^B11600309
"RTN","ZVEMGH1",1,0)
ZVEMGH1 ;DJB,VGL**Help Text - Main Screen [02/05/95]
"RTN","ZVEMGH1",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMGH1",3,0)
 ;
"RTN","ZVEMGH1",4,0)
VGL2 ;;;
"RTN","ZVEMGH1",5,0)
 ;;; V G L   E N T R Y   P O I N T S
"RTN","ZVEMGH1",6,0)
 ;;;
"RTN","ZVEMGH1",7,0)
 ;;;     ^%ZVEMG    Normal entry point
"RTN","ZVEMGH1",8,0)
 ;;;    R^%ZVEMG    A Fileman subscript has the following pattern:
"RTN","ZVEMGH1",9,0)
 ;;;                   Root..Variable..Constant..Variable..Constant..etc
"RTN","ZVEMGH1",10,0)
 ;;;                Entry point R^%ZVEMG will display the variable portion of
"RTN","ZVEMGH1",11,0)
 ;;;                the subscript in reverse video.
"RTN","ZVEMGH1",12,0)
 ;;;PARAM(var)^%ZVEMG  Parameter passing.
"RTN","ZVEMGH1",13,0)
 ;;;
"RTN","ZVEMGH1",14,0)
 ;;; E N T E R                            R  E  S  U  L  T
"RTN","ZVEMGH1",15,0)
 ;;; ---------    ----------------------------------------------------------------
"RTN","ZVEMGH1",16,0)
 ;;;   'n'        Enter a REF number from the left hand column and the pieces of
"RTN","ZVEMGH1",17,0)
 ;;;              the selected node will be displayed vertically. You can then
"RTN","ZVEMGH1",18,0)
 ;;;              select a piece and view the data dictionary for the field
"RTN","ZVEMGH1",19,0)
 ;;;              this piece represents.
"RTN","ZVEMGH1",20,0)
 ;;;
"RTN","ZVEMGH1",21,0)
 ;;;              If the node you select is a Xref, the data dictionary for
"RTN","ZVEMGH1",22,0)
 ;;;              the field setting the Xref, will be displayed. If the node is
"RTN","ZVEMGH1",23,0)
 ;;;              a word processing field, the field will be displayed directly.
"RTN","ZVEMGH1",24,0)
 ;;;              If the node is a zero node, information on the contents of a
"RTN","ZVEMGH1",25,0)
 ;;;              zero node will be displayed.
"RTN","ZVEMGH1",26,0)
 ;;;
"RTN","ZVEMGH1",27,0)
 ;;;   <TAB>      As noted above, you select a node by entering it's REF number.
"RTN","ZVEMGH1",28,0)
 ;;;              You may also select a node by positioning the highlight located
"RTN","ZVEMGH1",29,0)
 ;;;              on the extreme left hand side of the screen, and then hitting
"RTN","ZVEMGH1",30,0)
 ;;;              <TAB>.
"RTN","ZVEMGH1",31,0)
 ;;;
"RTN","ZVEMGH1",32,0)
 ;;;    A         This option allows you to start up an alternate session to
"RTN","ZVEMGH1",33,0)
 ;;;              view a 2nd global.
"RTN","ZVEMGH1",34,0)
 ;;;
"RTN","ZVEMGH1",35,0)
 ;;;    G         Goto a node number. G 1 will return you to the opening screen.
"RTN","ZVEMGH1",36,0)
 ;;;              G 1000 (or any high number) will cause the listing to begin with
"RTN","ZVEMGH1",37,0)
 ;;;              the highest node that's been displayed.
"RTN","ZVEMGH1",38,0)
 ;;;
"RTN","ZVEMGH1",39,0)
 ;;; <HOME>,<F4><AL>  Returns you to the opening screen.
"RTN","ZVEMGH1",40,0)
 ;;;
"RTN","ZVEMGH1",41,0)
 ;;; <END>,<F4><AR>   Causes listing to begin with highest node displayed.
"RTN","ZVEMGH1",42,0)
 ;;;
"RTN","ZVEMGH1",43,0)
 ;;;   S'n'       Skip over subscipt level 'n'.
"RTN","ZVEMGH1",44,0)
 ;;;              Example:  Assume you started the listing with the NEW PERSON
"RTN","ZVEMGH1",45,0)
 ;;;              file ^VA(200, and you were now at ^VA(200,4,"FOF",3.05,0). If
"RTN","ZVEMGH1",46,0)
 ;;;              you wanted to skip to the next user, you would enter S2. This
"RTN","ZVEMGH1",47,0)
 ;;;              means subscript level 2 would skip to the next value. This
"RTN","ZVEMGH1",48,0)
 ;;;              would result in ^VA(200,5,0) being displayed.
"RTN","ZVEMGH1",49,0)
 ;;;***
"RTN","ZVEMGH2")
0^214^B7702211
"RTN","ZVEMGH2",1,0)
ZVEMGH2 ;DJB,VGL**Help Text - Main Screen [06/08/94]
"RTN","ZVEMGH2",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMGH2",3,0)
 ;
"RTN","ZVEMGH2",4,0)
VGL2 ;;;
"RTN","ZVEMGH2",5,0)
 ;;;
"RTN","ZVEMGH2",6,0)
 ;;;    C         Enter Mumps code in the form of an IF statement. If True,
"RTN","ZVEMGH2",7,0)
 ;;;              the node will be displayed. When you select 'C' you will see
"RTN","ZVEMGH2",8,0)
 ;;;              a display of available variables. These variables may be used
"RTN","ZVEMGH2",9,0)
 ;;;              in your code.
"RTN","ZVEMGH2",10,0)
 ;;;
"RTN","ZVEMGH2",11,0)
 ;;;              NOTE: To run this option, DUZ(0) must contain '@'.
"RTN","ZVEMGH2",12,0)
 ;;;
"RTN","ZVEMGH2",13,0)
 ;;;              Examples:
"RTN","ZVEMGH2",14,0)
 ;;;
"RTN","ZVEMGH2",15,0)
 ;;;                   I $P(GLVAL,U,2)=5
"RTN","ZVEMGH2",16,0)
 ;;;
"RTN","ZVEMGH2",17,0)
 ;;;              This will display only those nodes whose 2nd "Piece" equals 5.
"RTN","ZVEMGH2",18,0)
 ;;;
"RTN","ZVEMGH2",19,0)
 ;;;                   I 1 W !?40,"PIECE 5: ",$P(GLVAL,U,5)
"RTN","ZVEMGH2",20,0)
 ;;;
"RTN","ZVEMGH2",21,0)
 ;;;              This will display "Piece" 5 on one line and the entire node on
"RTN","ZVEMGH2",22,0)
 ;;;              the next, so you can track the changes in value of "Piece" 5.
"RTN","ZVEMGH2",23,0)
 ;;;
"RTN","ZVEMGH2",24,0)
 ;;;              Some code searches may take a long time depending on the size
"RTN","ZVEMGH2",25,0)
 ;;;              of the global being viewed. For this reason, I allow you to
"RTN","ZVEMGH2",26,0)
 ;;;              abort a search by hitting any key. The display of all nodes
"RTN","ZVEMGH2",27,0)
 ;;;              will resume in the normal fashion.
"RTN","ZVEMGH2",28,0)
 ;;;
"RTN","ZVEMGH2",29,0)
 ;;;  VEDD        Allows branching to 'Electronic Data Dictionary' to view a file.
"RTN","ZVEMGH2",30,0)
 ;;;
"RTN","ZVEMGH2",31,0)
 ;;;    ES        Edit a node's subscript. You are not allowed to edit the
"RTN","ZVEMGH2",32,0)
 ;;;              subscript of a node that has decendents.
"RTN","ZVEMGH2",33,0)
 ;;;
"RTN","ZVEMGH2",34,0)
 ;;;    EV        Edit a node's value.
"RTN","ZVEMGH2",35,0)
 ;;;
"RTN","ZVEMGH2",36,0)
 ;;;    SA        SAves selected nodes which can then be UNsaved later. This
"RTN","ZVEMGH2",37,0)
 ;;;              option is used to move code. In conjunction with my routine
"RTN","ZVEMGH2",38,0)
 ;;;              editor, you can move code FROM a global TO a routine, FROM a
"RTN","ZVEMGH2",39,0)
 ;;;              routine TO a global, or FROM a global TO another global.
"RTN","ZVEMGH2",40,0)
 ;;;
"RTN","ZVEMGH2",41,0)
 ;;;    UN        UNsave previously SAved code.
"RTN","ZVEMGH2",42,0)
 ;;;***
"RTN","ZVEMOH")
0^215^B12758953
"RTN","ZVEMOH",1,0)
ZVEMOH ;DJB,VRROLD**Help Text [12/31/94]
"RTN","ZVEMOH",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMOH",3,0)
 ;
"RTN","ZVEMOH",4,0)
VRROLD ;;;
"RTN","ZVEMOH",5,0)
 ;;; V R R . . . . . . . . . The VRoutine Reader . . . . . . . . . . David Bolduc
"RTN","ZVEMOH",6,0)
 ;;;
"RTN","ZVEMOH",7,0)
 ;;;  NOTES: VRR displays the line number for all program lines not having a
"RTN","ZVEMOH",8,0)
 ;;;         line tag. It also displays the total program lines at the top of
"RTN","ZVEMOH",9,0)
 ;;;         the screen. The 2 vertical bars at the left side of the top and
"RTN","ZVEMOH",10,0)
 ;;;         bottom borders, help delineate line tags.
"RTN","ZVEMOH",11,0)
 ;;;         Submenu 'ED=Edit' is only available if you have global ^%ZVEMS("E")
"RTN","ZVEMOH",12,0)
 ;;;         on your system and you eXecute ^%ZVEMS("E").
"RTN","ZVEMOH",13,0)
 ;;;
"RTN","ZVEMOH",14,0)
 ;;;  E N T R Y   P O I N T S:
"RTN","ZVEMOH",15,0)
 ;;;
"RTN","ZVEMOH",16,0)
 ;;;        DO ^%ZVEMO - Normal entry point.
"RTN","ZVEMOH",17,0)
 ;;;        DO PARAM^%ZVEMO(routine) - To bypass routine selection prompt.
"RTN","ZVEMOH",18,0)
 ;;;        X ^%ZVEMS("E") - VPE routine editor that utilizes the VRR module.
"RTN","ZVEMOH",19,0)
 ;;;
"RTN","ZVEMOH",20,0)
 ;;;
"RTN","ZVEMOH",21,0)
 ;;;  In the RESULT column, the word 'selected' indicates you will receive a
"RTN","ZVEMOH",22,0)
 ;;;  prompt asking you to enter the required value. T,G,F,L Options position
"RTN","ZVEMOH",23,0)
 ;;;  the selected line to the top of the display.
"RTN","ZVEMOH",24,0)
 ;;;
"RTN","ZVEMOH",25,0)
 ;;; E N T E R                            R  E  S  U  L  T
"RTN","ZVEMOH",26,0)
 ;;; ---------    ---------------------------------------------------------------
"RTN","ZVEMOH",27,0)
 ;;;    ^         Quit current session.
"RTN","ZVEMOH",28,0)
 ;;;
"RTN","ZVEMOH",29,0)
 ;;; <SPACE>      Quit current session.
"RTN","ZVEMOH",30,0)
 ;;;
"RTN","ZVEMOH",31,0)
 ;;;  N A V I G A T E   Submenu
"RTN","ZVEMOH",32,0)
 ;;;
"RTN","ZVEMOH",33,0)
 ;;; <RETURN>     Continue on to next page.
"RTN","ZVEMOH",34,0)
 ;;;
"RTN","ZVEMOH",35,0)
 ;;;    U         Move UP a page. U will move you back 12 lines if you are in
"RTN","ZVEMOH",36,0)
 ;;;              single space mode, or 6 lines if in double space mode.
"RTN","ZVEMOH",37,0)
 ;;;
"RTN","ZVEMOH",38,0)
 ;;;    T         Move to the top of the routine.
"RTN","ZVEMOH",39,0)
 ;;;
"RTN","ZVEMOH",40,0)
 ;;;    B         Move to the bottom of the routine.
"RTN","ZVEMOH",41,0)
 ;;;
"RTN","ZVEMOH",42,0)
 ;;;    G         Go to selected line number.
"RTN","ZVEMOH",43,0)
 ;;;
"RTN","ZVEMOH",44,0)
 ;;;    F         Find selected Line Tag. If the Tag does not exist the display
"RTN","ZVEMOH",45,0)
 ;;;              will be blank. Use 'T' to return to top of program.
"RTN","ZVEMOH",46,0)
 ;;;
"RTN","ZVEMOH",47,0)
 ;;;    L         Locate selected string. If the string does not exist the display
"RTN","ZVEMOH",48,0)
 ;;;              will be blank. Use 'T' to return to top of program.
"RTN","ZVEMOH",49,0)
 ;;;
"RTN","ZVEMOH",50,0)
 ;;;   <AU>       Hitting the Up Arrow key moves the HIGHLIGHT up one line. Once
"RTN","ZVEMOH",51,0)
 ;;;              the HIGHLIGHT reaches the top of the page, hitting <AU> will
"RTN","ZVEMOH",52,0)
 ;;;              insert a new line at the top, thus backing up 1 line.
"RTN","ZVEMOH",53,0)
 ;;;
"RTN","ZVEMOH",54,0)
 ;;;   <AD>       Hitting the Down Arrow key moves the HIGHLIGHT down one line.
"RTN","ZVEMOH",55,0)
 ;;;              Once the HIGHLIGHT reaches the bottom of the page, hitting <AD>
"RTN","ZVEMOH",56,0)
 ;;;              will insert a new line at the bottom, thus moving ahead 1 line.
"RTN","ZVEMOH",57,0)
 ;;;
"RTN","ZVEMOH",58,0)
 ;;;   <AL>       Move highlight to top of page.
"RTN","ZVEMOH",59,0)
 ;;;
"RTN","ZVEMOH",60,0)
 ;;;   <AR>       Move highlight to bottom of page.
"RTN","ZVEMOH",61,0)
 ;;;***
"RTN","ZVEMOH1")
0^216^B11870886
"RTN","ZVEMOH1",1,0)
ZVEMOH1 ;DJB,VRROLD**Help Text [12/31/94]
"RTN","ZVEMOH1",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMOH1",3,0)
 ;
"RTN","ZVEMOH1",4,0)
VRROLD ;;;
"RTN","ZVEMOH1",5,0)
 ;;;
"RTN","ZVEMOH1",6,0)
 ;;;  B R A N C H   Submenu
"RTN","ZVEMOH1",7,0)
 ;;;
"RTN","ZVEMOH1",8,0)
 ;;;    R         Branch to selected Routine. Use this option when you encounter
"RTN","ZVEMOH1",9,0)
 ;;;              a DO command in the current program and you wish to temporarily
"RTN","ZVEMOH1",10,0)
 ;;;              view the Routine being called. You can branch to up to 4 dif-
"RTN","ZVEMOH1",11,0)
 ;;;              ferent routines in succession. The top line of the display will
"RTN","ZVEMOH1",12,0)
 ;;;              indicate the number of programs you have branched to and the
"RTN","ZVEMOH1",13,0)
 ;;;              name of the current routine.
"RTN","ZVEMOH1",14,0)
 ;;;
"RTN","ZVEMOH1",15,0)
 ;;;    H         Hot key. When you've branched to other routines, H will allow
"RTN","ZVEMOH1",16,0)
 ;;;              you to quickly toggle back and forth between routines.
"RTN","ZVEMOH1",17,0)
 ;;;
"RTN","ZVEMOH1",18,0)
 ;;;    RS        Routine search. Searches selected routines for selected strings.
"RTN","ZVEMOH1",19,0)
 ;;;              Whenever a string is found and the display stops, you may enter
"RTN","ZVEMOH1",20,0)
 ;;;              <RETURN> to continue, '^' to quit, '?' for Help, or 'A' for
"RTN","ZVEMOH1",21,0)
 ;;;              Autoprint. When Autoprint is active, the display will not stop
"RTN","ZVEMOH1",22,0)
 ;;;              when a string is located.
"RTN","ZVEMOH1",23,0)
 ;;;
"RTN","ZVEMOH1",24,0)
 ;;;   VEDD       View a file by branching to VPE module VELECTRONIC DATA
"RTN","ZVEMOH1",25,0)
 ;;;              DICTIONARY.
"RTN","ZVEMOH1",26,0)
 ;;;
"RTN","ZVEMOH1",27,0)
 ;;;   VGL        View a global by branching to VPE module VGLOBAL LISTER. DUZ(0)
"RTN","ZVEMOH1",28,0)
 ;;;              must contain '@' or '#'.
"RTN","ZVEMOH1",29,0)
 ;;;
"RTN","ZVEMOH1",30,0)
 ;;;  O T H E R   Submenu
"RTN","ZVEMOH1",31,0)
 ;;;
"RTN","ZVEMOH1",32,0)
 ;;;    SP        Toggles back and forth between single and double spacing. Use
"RTN","ZVEMOH1",33,0)
 ;;;              single spacing to rapidly move through the program, and double
"RTN","ZVEMOH1",34,0)
 ;;;              spacing to make the code easier to read.
"RTN","ZVEMOH1",35,0)
 ;;;
"RTN","ZVEMOH1",36,0)
 ;;;    MK        Marks the line at the top of the display. To return to this
"RTN","ZVEMOH1",37,0)
 ;;;              line, enter 'G' for GOTO and 'MK' at the LINE NUMBER prompt.
"RTN","ZVEMOH1",38,0)
 ;;;              This can be used as a place holder while you move elsewhere in
"RTN","ZVEMOH1",39,0)
 ;;;              the program to follow a DO or GOTO command.
"RTN","ZVEMOH1",40,0)
 ;;;
"RTN","ZVEMOH1",41,0)
 ;;;  COL'n'      Entering COL and a number is a quick way to collapse backwards
"RTN","ZVEMOH1",42,0)
 ;;;              when you've branched to a number of programs. If you are
"RTN","ZVEMOH1",43,0)
 ;;;              currently in the 4th program, entering COL1 will return you
"RTN","ZVEMOH1",44,0)
 ;;;              back to the 1st program.
"RTN","ZVEMOH1",45,0)
 ;;;
"RTN","ZVEMOH1",46,0)
 ;;;   FMC        If you are running VShell, you may access VShell's database of
"RTN","ZVEMOH1",47,0)
 ;;;              documented Fileman Calls.
"RTN","ZVEMOH1",48,0)
 ;;;
"RTN","ZVEMOH1",49,0)
 ;;;   ASC        If you are running VShell, ASC will display the ASCII Character
"RTN","ZVEMOH1",50,0)
 ;;;              Set.
"RTN","ZVEMOH1",51,0)
 ;;;***
"RTN","ZVEMOH2")
0^217^B9681063
"RTN","ZVEMOH2",1,0)
ZVEMOH2 ;DJB,VRROLD**Help Text [01/15/95]
"RTN","ZVEMOH2",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMOH2",3,0)
 ;
"RTN","ZVEMOH2",4,0)
VRROLD ;;;
"RTN","ZVEMOH2",5,0)
 ;;;
"RTN","ZVEMOH2",6,0)
 ;;;  E D I T   Submenu
"RTN","ZVEMOH2",7,0)
 ;;;
"RTN","ZVEMOH2",8,0)
 ;;;   'n'         Enter the line number of the line of code you wish to edit.
"RTN","ZVEMOH2",9,0)
 ;;; HIGHLIGHT     You may also position the HIGHLIGHT and hit <TAB> to select
"RTN","ZVEMOH2",10,0)
 ;;;               a line for editing. You may use the HIGHLIGHT/<TAB> combination
"RTN","ZVEMOH2",11,0)
 ;;;               for other commands as well. Any other command that asks for
"RTN","ZVEMOH2",12,0)
 ;;;               LINE NUMBER will accept <TAB> to mean the HIGHLIGHTED line.
"RTN","ZVEMOH2",13,0)
 ;;;
"RTN","ZVEMOH2",14,0)
 ;;;    I          Insert new code after selected line number. To insert a line
"RTN","ZVEMOH2",15,0)
 ;;;               at the top of the routine, INSERT after line 0 (zero).
"RTN","ZVEMOH2",16,0)
 ;;;
"RTN","ZVEMOH2",17,0)
 ;;;    D          Delete selected line or range of lines. To select a range
"RTN","ZVEMOH2",18,0)
 ;;;               use a dash. Ex. Delete lines 5-9.
"RTN","ZVEMOH2",19,0)
 ;;;
"RTN","ZVEMOH2",20,0)
 ;;;    LC         Locate and change string. This option will locate every
"RTN","ZVEMOH2",21,0)
 ;;;               occurrance of the selected string and change it to the selected
"RTN","ZVEMOH2",22,0)
 ;;;               value, within a selected range of lines.
"RTN","ZVEMOH2",23,0)
 ;;;
"RTN","ZVEMOH2",24,0)
 ;;;    SA         Save a line or range of lines. Use this option to move code
"RTN","ZVEMOH2",25,0)
 ;;;               elsewhere in the program or to other programs.
"RTN","ZVEMOH2",26,0)
 ;;;
"RTN","ZVEMOH2",27,0)
 ;;;    UN         UNsave  copies SAved  code to a new location. The code will
"RTN","ZVEMOH2",28,0)
 ;;;               be inserted after the selected line number. To UNSAVE a line
"RTN","ZVEMOH2",29,0)
 ;;;               at the top of the routine, UNSAVE after line 0 (zero).
"RTN","ZVEMOH2",30,0)
 ;;;
"RTN","ZVEMOH2",31,0)
 ;;;    BK         Break a line into 2 lines. Trailing and leading spaces are
"RTN","ZVEMOH2",32,0)
 ;;;               removed.
"RTN","ZVEMOH2",33,0)
 ;;;
"RTN","ZVEMOH2",34,0)
 ;;;    J          Join 2 selected lines. The 2nd line is joined to the end of
"RTN","ZVEMOH2",35,0)
 ;;;               the 1st line and then deleted. Use Split to undo.
"RTN","ZVEMOH2",36,0)
 ;;;
"RTN","ZVEMOH2",37,0)
 ;;;    MD         This is a toggle switch that changes between screen edit mode
"RTN","ZVEMOH2",38,0)
 ;;;               and line edit mode (REPLACE: WITH:).
"RTN","ZVEMOH2",39,0)
 ;;;
"RTN","ZVEMOH2",40,0)
 ;;;   PUR         The SAve and UNsave options use global ^%ZVEMS("E","SAVE")
"RTN","ZVEMOH2",41,0)
 ;;;               as a holding location. ^%ZVEMS("E","SAVE") does not grow to any
"RTN","ZVEMOH2",42,0)
 ;;;               great extent, but it can be killed at any time with this purge
"RTN","ZVEMOH2",43,0)
 ;;;               option.
"RTN","ZVEMOH2",44,0)
 ;;;***
"RTN","ZVEMRH")
0^218^B9866100
"RTN","ZVEMRH",1,0)
ZVEMRH ;DJB,VRR**Help Text [01/27/95]
"RTN","ZVEMRH",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMRH",3,0)
 ;
"RTN","ZVEMRH",4,0)
VRR1 ;;;
"RTN","ZVEMRH",5,0)
 ;;; V R R . . . . . . . . . Routine Reader/Editor . . . . . . . . . David Bolduc
"RTN","ZVEMRH",6,0)
 ;;;
"RTN","ZVEMRH",7,0)
 ;;;  E N T R Y   P O I N T S:
"RTN","ZVEMRH",8,0)
 ;;;
"RTN","ZVEMRH",9,0)
 ;;;        DO ^%ZVEMR ................ Entry point to read a routine.
"RTN","ZVEMRH",10,0)
 ;;;        DO PARAM^%ZVEMR(routine) .. To bypass routine selection prompt.
"RTN","ZVEMRH",11,0)
 ;;;        X ^%ZVEMS("E") ............ VPE routine editor that utilizes
"RTN","ZVEMRH",12,0)
 ;;;                                    the VRR module.
"RTN","ZVEMRH",13,0)
 ;;;
"RTN","ZVEMRH",14,0)
 ;;;  N O T E S:
"RTN","ZVEMRH",15,0)
 ;;;
"RTN","ZVEMRH",16,0)
 ;;;         VRR displays the line number for all routine lines not having a
"RTN","ZVEMRH",17,0)
 ;;;         line tag. It also displays total routine lines at the top of
"RTN","ZVEMRH",18,0)
 ;;;         the screen. The 2 vertical bars at the left side of the top and
"RTN","ZVEMRH",19,0)
 ;;;         bottom borders, help delineate line tags. The phrase "1 of 4"
"RTN","ZVEMRH",20,0)
 ;;;         that appears in the top border, refers to the routine level you
"RTN","ZVEMRH",21,0)
 ;;;         are currently in. As you branch to other routines, the 1 will
"RTN","ZVEMRH",22,0)
 ;;;         increment.
"RTN","ZVEMRH",23,0)
 ;;;
"RTN","ZVEMRH",24,0)
 ;;;         VRR has 4 modes: EDIT        Default mode
"RTN","ZVEMRH",25,0)
 ;;;                          INSERT      <RETURN>
"RTN","ZVEMRH",26,0)
 ;;;                          BLOCK       <F3>
"RTN","ZVEMRH",27,0)
 ;;;                          MENU BAR    <TAB>
"RTN","ZVEMRH",28,0)
 ;;;
"RTN","ZVEMRH",29,0)
 ;;;  E D I T   M O D E:
"RTN","ZVEMRH",30,0)
 ;;;
"RTN","ZVEMRH",31,0)
 ;;;  When you first enter the editor you are in EDIT mode. You may position
"RTN","ZVEMRH",32,0)
 ;;;  the cursor anywhere on the screen and enter code. Hitting <BS> will
"RTN","ZVEMRH",33,0)
 ;;;  delete the character to the left of the cursor. Hitting <DEL> will delete
"RTN","ZVEMRH",34,0)
 ;;;  the character under the cursor. When you move the cursor to the left side
"RTN","ZVEMRH",35,0)
 ;;;  of the screen, you are in the line tag area. When you enter or delete code
"RTN","ZVEMRH",36,0)
 ;;;  here, the code will be placed so that the tag is displayed correctly.
"RTN","ZVEMRH",37,0)
 ;;;
"RTN","ZVEMRH",38,0)
 ;;;  I N S E R T   M O D E:
"RTN","ZVEMRH",39,0)
 ;;;
"RTN","ZVEMRH",40,0)
 ;;;  In EDIT mode, when you wish to add a new line of code, type <RETURN> to
"RTN","ZVEMRH",41,0)
 ;;;  change to INSERT mode. A blank line will open below the line the cursor
"RTN","ZVEMRH",42,0)
 ;;;  is currently on. You may now add new code. Use <TAB> as a line start
"RTN","ZVEMRH",43,0)
 ;;;  character. Once you hit <TAB> you are returned to EDIT mode. If you hit
"RTN","ZVEMRH",44,0)
 ;;;  <RETURN> without adding any new code, the opened line will be closed.
"RTN","ZVEMRH",45,0)
 ;;;
"RTN","ZVEMRH",46,0)
 ;;;***
"RTN","ZVEMRH1")
0^219^B17033275
"RTN","ZVEMRH1",1,0)
ZVEMRH1 ;DJB,VRR**Help Text [10/22/96 8:35am]
"RTN","ZVEMRH1",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMRH1",3,0)
 ;
"RTN","ZVEMRH1",4,0)
VRR1 ;;;
"RTN","ZVEMRH1",5,0)
 ;;;  B L O C K   M O D E:
"RTN","ZVEMRH1",6,0)
 ;;;
"RTN","ZVEMRH1",7,0)
 ;;;  In EDIT mode, type <F3> to change to BLOCK mode. The word BLOCK will
"RTN","ZVEMRH1",8,0)
 ;;;  appear at the upper right of the screen. Use the Up/Down Arrow keys to
"RTN","ZVEMRH1",9,0)
 ;;;  highlight routine lines. To act on the highlighted lines do:
"RTN","ZVEMRH1",10,0)
 ;;;     <ESC>C .....Copy lines to the clipboard
"RTN","ZVEMRH1",11,0)
 ;;;     <ESC>X .....Cut lines to the clipboard
"RTN","ZVEMRH1",12,0)
 ;;;     <DEL> ......Delete lines
"RTN","ZVEMRH1",13,0)
 ;;;     <F3> .......Return to EDIT mode without taking action
"RTN","ZVEMRH1",14,0)
 ;;;
"RTN","ZVEMRH1",15,0)
 ;;;  While in BLOCK mode, you may position the cursor and then hit:
"RTN","ZVEMRH1",16,0)
 ;;;     <F1><AL> ...Highlight all lines from cursor to top of routine
"RTN","ZVEMRH1",17,0)
 ;;;     <F1><AR> ...Highlight all lines from cursor to bottom of routine
"RTN","ZVEMRH1",18,0)
 ;;;
"RTN","ZVEMRH1",19,0)
 ;;;  When you've returned to EDIT mode, position the cursor and hit <ESC>V
"RTN","ZVEMRH1",20,0)
 ;;;  to paste saved lines into the current routine. The new lines will be
"RTN","ZVEMRH1",21,0)
 ;;;  inserted below the cursor. In MENU BAR mode you can branch to other routines
"RTN","ZVEMRH1",22,0)
 ;;;  save code to the clipboard, return to the current routine, and paste the
"RTN","ZVEMRH1",23,0)
 ;;;  code in.
"RTN","ZVEMRH1",24,0)
 ;;;
"RTN","ZVEMRH1",25,0)
 ;;;  M E N U   B A R   M O D E:
"RTN","ZVEMRH1",26,0)
 ;;;
"RTN","ZVEMRH1",27,0)
 ;;;  In EDIT mode, type <TAB> to change to MENU BAR mode. This positions the
"RTN","ZVEMRH1",28,0)
 ;;;  cursor at the bottom of the screen and the following menu becomes active:
"RTN","ZVEMRH1",29,0)
 ;;;
"RTN","ZVEMRH1",30,0)
 ;;;    R         Branch to selected routine.
"RTN","ZVEMRH1",31,0)
 ;;;              NOTE: You can also branch to a routine while in EDIT mode.
"RTN","ZVEMRH1",32,0)
 ;;;              To do so, position the cursor over the "^" part of any routine
"RTN","ZVEMRH1",33,0)
 ;;;              referenced on the screen, and hit <ESC>R.
"RTN","ZVEMRH1",34,0)
 ;;;
"RTN","ZVEMRH1",35,0)
 ;;;    F         Find selected Line Tag. Search begins on next line after cursor.
"RTN","ZVEMRH1",36,0)
 ;;;              Use <ESC>N in EDIT mode to find next occurance.
"RTN","ZVEMRH1",37,0)
 ;;;
"RTN","ZVEMRH1",38,0)
 ;;;    L         Locate selected string. Search begins on next line after cursor.
"RTN","ZVEMRH1",39,0)
 ;;;              Use <ESC>N in EDIT mode to find next occurance.
"RTN","ZVEMRH1",40,0)
 ;;;
"RTN","ZVEMRH1",41,0)
 ;;;    G         Move to selected line number in current routine. Also, you may
"RTN","ZVEMRH1",42,0)
 ;;;              goto a line by entering 'Line Tag+Offset' (Ex: EN+15)
"RTN","ZVEMRH1",43,0)
 ;;;
"RTN","ZVEMRH1",44,0)
 ;;;    J         Join 2 lines you select.
"RTN","ZVEMRH1",45,0)
 ;;;
"RTN","ZVEMRH1",46,0)
 ;;;    JC        Join next line to current line.
"RTN","ZVEMRH1",47,0)
 ;;;
"RTN","ZVEMRH1",48,0)
 ;;;    S         Display routine size.
"RTN","ZVEMRH1",49,0)
 ;;;
"RTN","ZVEMRH1",50,0)
 ;;;    LC        Locate and change all occurances of selected string.
"RTN","ZVEMRH1",51,0)
 ;;;
"RTN","ZVEMRH1",52,0)
 ;;;    RS        Search routine(s) for selected string.
"RTN","ZVEMRH1",53,0)
 ;;;
"RTN","ZVEMRH1",54,0)
 ;;;    VEDD      Branch to Electronic Data Dictionary
"RTN","ZVEMRH1",55,0)
 ;;;
"RTN","ZVEMRH1",56,0)
 ;;;    VGL       Branch to Global Lister
"RTN","ZVEMRH1",57,0)
 ;;;              NOTE: You may also branch to a global while in EDIT mode,
"RTN","ZVEMRH1",58,0)
 ;;;              by passing the global reference as a parameter. To do so,
"RTN","ZVEMRH1",59,0)
 ;;;              find the global reference on the screen, position the curosr
"RTN","ZVEMRH1",60,0)
 ;;;              at the start of the name and hit <ESC>G. Then position the
"RTN","ZVEMRH1",61,0)
 ;;;              cursor as far to the right as you want to include as your
"RTN","ZVEMRH1",62,0)
 ;;;              parameter, and hit <ESC>G again.
"RTN","ZVEMRH1",63,0)
 ;;;
"RTN","ZVEMRH1",64,0)
 ;;;    CALL      Helps you construct certain programmer calls and inserts
"RTN","ZVEMRH1",65,0)
 ;;;              them into your code.
"RTN","ZVEMRH1",66,0)
 ;;;
"RTN","ZVEMRH1",67,0)
 ;;;    FMC       View VShell's 'Fileman Calls' database.
"RTN","ZVEMRH1",68,0)
 ;;;
"RTN","ZVEMRH1",69,0)
 ;;;    ASC       View VShell's 'ASCII Table' display.
"RTN","ZVEMRH1",70,0)
 ;;;
"RTN","ZVEMRH1",71,0)
 ;;;    PUR       Purge the Clipboard (^%ZVEMS("E","SAVEVRR")).
"RTN","ZVEMRH1",72,0)
 ;;;***
"RTN","ZVEMRHK")
0^220^B6846622
"RTN","ZVEMRHK",1,0)
ZVEMRHK ;DJB,VRR**Help Text - Keyboard [9/23/95 12:05pm]
"RTN","ZVEMRHK",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMRHK",3,0)
 ;
"RTN","ZVEMRHK",4,0)
VRR2 ;
"RTN","ZVEMRHK",5,0)
 ;;; NOTES: <AU>=Arrow Up  <AD>=Arrow Down  <AL>=Arrow Left  <AR>=Arrow Right
"RTN","ZVEMRHK",6,0)
 ;;;
"RTN","ZVEMRHK",7,0)
 ;;; <AU> ........: Cursor up 1 line        <F1><AU> ..: Cursor to top of page
"RTN","ZVEMRHK",8,0)
 ;;; <AD> ........: Cursor down 1 line      <F1><AD> ..: Cursor to bottom of page
"RTN","ZVEMRHK",9,0)
 ;;; <AL> ........: Cursor left 1 char      <F1><AL> ..: Cursor to start of line
"RTN","ZVEMRHK",10,0)
 ;;; <AR> ........: Cursor right 1 char     <F1><AR> ..: Cursor to end of line
"RTN","ZVEMRHK",11,0)
 ;;; <PGUP> ......: Up 1 page               <F2><AU> ..: Cursor up 5 lines
"RTN","ZVEMRHK",12,0)
 ;;; <PGDN> ......: Down 1 page             <F2><AD> ..: Cursor down 5 lines
"RTN","ZVEMRHK",13,0)
 ;;; <HOME> ......: Top of Rtn              <F2><AL> ..: Cursor left 15 char
"RTN","ZVEMRHK",14,0)
 ;;; <END> .......: Bottom of Rtn           <F2><AR> ..: Cursor right 15 char
"RTN","ZVEMRHK",15,0)
 ;;;                                        <F4><AU> ..: Up 1 page
"RTN","ZVEMRHK",16,0)
 ;;; <ESC>G ......: Branch to global        <F4><AD> ..: Down 1 page
"RTN","ZVEMRHK",17,0)
 ;;; <ESC>R ......: Branch to routine       <F4><AL> ..: Top of Rtn
"RTN","ZVEMRHK",18,0)
 ;;; <ESC>H ......: Help - General          <F4><AR> ..: Bottom of Rtn
"RTN","ZVEMRHK",19,0)
 ;;; <ESC>K ......: Help - Keyboard
"RTN","ZVEMRHK",20,0)
 ;;; <ESC>X ......: Cut                     <RETURN> ..: Insert Mode
"RTN","ZVEMRHK",21,0)
 ;;; <ESC>C ......: Copy                    <TAB> .....: Menu Bar Mode
"RTN","ZVEMRHK",22,0)
 ;;; <ESC>V ......: Paste                   <F3> ......: Block Mode
"RTN","ZVEMRHK",23,0)
 ;;; <ESC>N ......: Find next occurance
"RTN","ZVEMRHK",24,0)
 ;;; <ESC>D ......: Delete current line     <F1>L .....: Move down 1 rtn line
"RTN","ZVEMRHK",25,0)
 ;;; <ESC>B ......: Break line              <F1><F1> ..: Left side of line
"RTN","ZVEMRHK",26,0)
 ;;; <ESC><ESC> ..: Quit                    <F2><F2> ..: Right side of line
"RTN","ZVEMRHK",27,0)
 ;;;
"RTN","ZVEMRHK",28,0)
 ;;; HINTS FOR REMEMBERING KEY COMBINATIONS:
"RTN","ZVEMRHK",29,0)
 ;;; <F1> and <F2> with the arrow keys, move the cursor WITHIN the current page.
"RTN","ZVEMRHK",30,0)
 ;;; <F1> is extreme movements and <F2> is incremental movements. <F4> and the
"RTN","ZVEMRHK",31,0)
 ;;; arrow keys, move the cursor OUTSIDE the current page. <ESC> keys run
"RTN","ZVEMRHK",32,0)
 ;;; actions.
"RTN","ZVEMRHK",33,0)
 ;;;***
"RTN","ZVEMRHL")
0^221^B35770473
"RTN","ZVEMRHL",1,0)
ZVEMRHL ;DJB,VRR**Help Text - Rtn Lbry ; 11/30/00 1:30pm
"RTN","ZVEMRHL",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMRHL",3,0)
 ;
"RTN","ZVEMRHL",4,0)
LIBRARY ;;;Routine Library & Versioning
"RTN","ZVEMRHL",5,0)
 ;;; INTRODUCTION
"RTN","ZVEMRHL",6,0)
 ;;; ------------
"RTN","ZVEMRHL",7,0)
 ;;;
"RTN","ZVEMRHL",8,0)
 ;;; VPE's Library & Versioning modules work in concert with the routine
"RTN","ZVEMRHL",9,0)
 ;;; editor (..E). They are activated with the ..LBRY System QWIK as follows:
"RTN","ZVEMRHL",10,0)
 ;;;
"RTN","ZVEMRHL",11,0)
 ;;;     ..LBRY        Displays the Library/Versioning menu.
"RTN","ZVEMRHL",12,0)
 ;;;     ..LBRY ON     Activates both modules.
"RTN","ZVEMRHL",13,0)
 ;;;     ..LBRY OFF    Inactivates both modules.
"RTN","ZVEMRHL",14,0)
 ;;;     ..LBRY ON L   Activates Library only.
"RTN","ZVEMRHL",15,0)
 ;;;     ..LBRY ON V   Activates Versioning only.
"RTN","ZVEMRHL",16,0)
 ;;;
"RTN","ZVEMRHL",17,0)
 ;;; This sets the following nodes:
"RTN","ZVEMRHL",18,0)
 ;;;     ^VEE(19200.11,"A-ACTIVE") = "ON/OFF" (Library)
"RTN","ZVEMRHL",19,0)
 ;;;     ^VEE(19200.112,"A-ACTIVE")= "ON/OFF" (Version)
"RTN","ZVEMRHL",20,0)
 ;;;
"RTN","ZVEMRHL",21,0)
 ;;; Note: If Library is active and Versioning inactive and you want to
"RTN","ZVEMRHL",22,0)
 ;;;       reverse this, first do ..LBRY OFF to inactivate Library and then
"RTN","ZVEMRHL",23,0)
 ;;;       do ..LBRY ON V to activate Versioning.
"RTN","ZVEMRHL",24,0)
 ;;;
"RTN","ZVEMRHL",25,0)
 ;;; SETUP
"RTN","ZVEMRHL",26,0)
 ;;; -----
"RTN","ZVEMRHL",27,0)
 ;;;
"RTN","ZVEMRHL",28,0)
 ;;; Files used:
"RTN","ZVEMRHL",29,0)
 ;;;
"RTN","ZVEMRHL",30,0)
 ;;;      VPE PERSON.......^VEE(19200.111)
"RTN","ZVEMRHL",31,0)
 ;;;             Name
"RTN","ZVEMRHL",32,0)
 ;;;             Identifier
"RTN","ZVEMRHL",33,0)
 ;;;             VPE ID
"RTN","ZVEMRHL",34,0)
 ;;;             Routine Versioning Prompt
"RTN","ZVEMRHL",35,0)
 ;;;
"RTN","ZVEMRHL",36,0)
 ;;;      VPE RTN LBRY..............^VEE(19200.11)
"RTN","ZVEMRHL",37,0)
 ;;;             Name
"RTN","ZVEMRHL",38,0)
 ;;;             Identifier
"RTN","ZVEMRHL",39,0)
 ;;;             Date Signed Out
"RTN","ZVEMRHL",40,0)
 ;;;             Signed Out By (Pointer to 19200.111)
"RTN","ZVEMRHL",41,0)
 ;;;
"RTN","ZVEMRHL",42,0)
 ;;;      VPE RTN VERSIONING...^VEE(19200.112)
"RTN","ZVEMRHL",43,0)
 ;;;             Routine
"RTN","ZVEMRHL",44,0)
 ;;;             Version
"RTN","ZVEMRHL",45,0)
 ;;;             Description
"RTN","ZVEMRHL",46,0)
 ;;;             Date
"RTN","ZVEMRHL",47,0)
 ;;;             Text
"RTN","ZVEMRHL",48,0)
 ;;;
"RTN","ZVEMRHL",49,0)
 ;;; Move to your production account and restore file VPE_x.PRD. This will load
"RTN","ZVEMRHL",50,0)
 ;;; FM Init routines ^VEEMI*. Next, DO ^VEEMINIT to install the files listed
"RTN","ZVEMRHL",51,0)
 ;;; above. Edit file VPE PERSON. This file should contain the names of all
"RTN","ZVEMRHL",52,0)
 ;;; your programmers. It IS NOT a pointer to the NEW PERSON file. It also
"RTN","ZVEMRHL",53,0)
 ;;; contains each person's VPE ID number, which you can find by looking at
"RTN","ZVEMRHL",54,0)
 ;;; variable VEE("ID") at the ">>" prompt when you're logged into the VPE
"RTN","ZVEMRHL",55,0)
 ;;; programmer shell. For this to work correctly, these files should be
"RTN","ZVEMRHL",56,0)
 ;;; translated so they are available in multiple UCI's.
"RTN","ZVEMRHL",57,0)
 ;;;
"RTN","ZVEMRHL",58,0)
 ;;; R O U T I N E   L I B R A R Y
"RTN","ZVEMRHL",59,0)
 ;;; -----------------------------
"RTN","ZVEMRHL",60,0)
 ;;;
"RTN","ZVEMRHL",61,0)
 ;;; The Library's purpose is to help prevent routines from being accidentily
"RTN","ZVEMRHL",62,0)
 ;;; overwritten when there are multiple programmers working on the same routines.
"RTN","ZVEMRHL",63,0)
 ;;;
"RTN","ZVEMRHL",64,0)
 ;;; The premise is that programmers can 'sign out' routines they will be working
"RTN","ZVEMRHL",65,0)
 ;;; on. If another programmer attempts to edit a signed out routine using VPE's
"RTN","ZVEMRHL",66,0)
 ;;; routine editor, a message is displayed warning that the routine has been 
"RTN","ZVEMRHL",67,0)
 ;;; signed out. The programmer should then check with the person who signed out
"RTN","ZVEMRHL",68,0)
 ;;; the routine, before continuing.
"RTN","ZVEMRHL",69,0)
 ;;;
"RTN","ZVEMRHL",70,0)
 ;;; This IS NOT a database that tracks revisions to routines. It is a database
"RTN","ZVEMRHL",71,0)
 ;;; of the names of all routines currently signed out. Once the routines are
"RTN","ZVEMRHL",72,0)
 ;;; signed back in, they are dropped from the database.
"RTN","ZVEMRHL",73,0)
 ;;;
"RTN","ZVEMRHL",74,0)
 ;;; System QWIC ..LBRY is the main menu for signing routines in & out of the
"RTN","ZVEMRHL",75,0)
 ;;; Library. The VPE routine editor (..E) also interacts with the Library.
"RTN","ZVEMRHL",76,0)
 ;;;
"RTN","ZVEMRHL",77,0)
 ;;; Routine Editor (..E):
"RTN","ZVEMRHL",78,0)
 ;;;
"RTN","ZVEMRHL",79,0)
 ;;;    a. When you enter the editor, you will receive a warning message IF
"RTN","ZVEMRHL",80,0)
 ;;;       the routine you are editing has been signed out by someone else.
"RTN","ZVEMRHL",81,0)
 ;;;       The same will happen if you BRANCH to another routine.
"RTN","ZVEMRHL",82,0)
 ;;;
"RTN","ZVEMRHL",83,0)
 ;;;    b. When you leave the editor, IF the routine you were editing hasn't
"RTN","ZVEMRHL",84,0)
 ;;;       been signed out and you hit SAVE to save any changes, you will be
"RTN","ZVEMRHL",85,0)
 ;;;       asked if you want to sign out the routine.
"RTN","ZVEMRHL",86,0)
 ;;;
"RTN","ZVEMRHL",87,0)
 ;;; NOTE: The menu option "Sign In Routines" uses VPE's 'Selector' software.
"RTN","ZVEMRHL",88,0)
 ;;; You select the routines you want to sign in, by positioning the cursor
"RTN","ZVEMRHL",89,0)
 ;;; and hitting <SPACE BAR>. "=>" Will appear next to selected items. Hit
"RTN","ZVEMRHL",90,0)
 ;;; <SPACE BAR> again to de-select an item.
"RTN","ZVEMRHL",91,0)
 ;;;
"RTN","ZVEMRHL",92,0)
 ;;; R O U T I N E   V E R S I O N I N G
"RTN","ZVEMRHL",93,0)
 ;;; -----------------------------------
"RTN","ZVEMRHL",94,0)
 ;;;
"RTN","ZVEMRHL",95,0)
 ;;; As a routine is edited and the changes saved, the versioning module stores
"RTN","ZVEMRHL",96,0)
 ;;; the routine's code, by version number. A programmer can, at any time,
"RTN","ZVEMRHL",97,0)
 ;;; restore any version of the routine, making it the active version.
"RTN","ZVEMRHL",98,0)
 ;;;
"RTN","ZVEMRHL",99,0)
 ;;; System QWIK ..LBRY is the main menu for viewing and restoring different
"RTN","ZVEMRHL",100,0)
 ;;; versions of a routine. The VPE routine editor (..E) contains the prompts
"RTN","ZVEMRHL",101,0)
 ;;; that allow a programmer to create the different versions.
"RTN","ZVEMRHL",102,0)
 ;;;
"RTN","ZVEMRHL",103,0)
 ;;; Routine Editor (..E):
"RTN","ZVEMRHL",104,0)
 ;;;
"RTN","ZVEMRHL",105,0)
 ;;;    a. When you leave the editor, if you choose SAVE to save any changes,
"RTN","ZVEMRHL",106,0)
 ;;;       you will be asked if you want to store a version of the routine.
"RTN","ZVEMRHL",107,0)
 ;;;       You may create a new version or update an existing version.
"RTN","ZVEMRHL",108,0)
 ;;;
"RTN","ZVEMRHL",109,0)
 ;;;    b. Filling in the DESCRIPTION field will aid you in selecting the
"RTN","ZVEMRHL",110,0)
 ;;;       correct routine to restore.
"RTN","ZVEMRHL",111,0)
 ;;;***
"RTN","ZVEMRHW")
0^222^B2410370
"RTN","ZVEMRHW",1,0)
ZVEMRHW ;DJB,VRR**Help Text - Web [12/14/96 6:34pm]
"RTN","ZVEMRHW",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMRHW",3,0)
 ;
"RTN","ZVEMRHW",4,0)
WEB ;;;
"RTN","ZVEMRHW",5,0)
 ;;; Insert HTML code onto new lines
"RTN","ZVEMRHW",6,0)
 ;;; ---------------------------------------------------------------------------
"RTN","ZVEMRHW",7,0)
 ;;; xxx ...... Generic          <xxx></xxx>
"RTN","ZVEMRHW",8,0)
 ;;; C ........ Comment          <!-- -->
"RTN","ZVEMRHW",9,0)
 ;;; I ........ Image            <IMG SRC="IMAGES/X.GIF">
"RTN","ZVEMRHW",10,0)
 ;;; L ........ List             <UL><LI>
"RTN","ZVEMRHW",11,0)
 ;;; LK ....... Link             <A HREF="DOC.HTM">Click Here
"RTN","ZVEMRHW",12,0)
 ;;; R ........ Required tags    <HTML><HEADER><TITLE><BODY>
"RTN","ZVEMRHW",13,0)
 ;;; T ........ Table            <TABLE><TR><TD>
"RTN","ZVEMRHW",14,0)
 ;;;
"RTN","ZVEMRHW",15,0)
 ;;; Insert HTML code into current line (preceed code with ".")
"RTN","ZVEMRHW",16,0)
 ;;; ---------------------------------------------------------------------------
"RTN","ZVEMRHW",17,0)
 ;;; .xxx ..... Generic       <xxx>
"RTN","ZVEMRHW",18,0)
 ;;; .AQUA    238E68    .GREEN  00FF00    .PURPLE 871F78    .YELLOW FFFF00
"RTN","ZVEMRHW",19,0)
 ;;; .BLACK   000000    .LIME   32CD32    .RED    FF0000
"RTN","ZVEMRHW",20,0)
 ;;; .BLUE    0000FF    .MAROON 8E236B    .SILVER 545454
"RTN","ZVEMRHW",21,0)
 ;;; .FUCHSIA FF00FF    .NAVY   23238E    .TEAL   00FFFF
"RTN","ZVEMRHW",22,0)
 ;;; .GRAY    C0C0C0    .OLIVE  238E23    .WHITE  FFFFFF
"RTN","ZVEMRHW",23,0)
 ;;;***
"RTN","ZVEMS")
0^223^B3407255
"RTN","ZVEMS",1,0)
ZVEMS ;DJB,VSHL**Setup VShell [11/17/96 12:47pm]
"RTN","ZVEMS",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMS",3,0)
 ;
"RTN","ZVEMS",4,0)
 Q
"RTN","ZVEMS",5,0)
NOTES ;General notes
"RTN","ZVEMS",6,0)
 ;;VEE File numbers: 19200-19204
"RTN","ZVEMS",7,0)
 ;;************** SCROLLING **************
"RTN","ZVEMS",8,0)
 ;;Keep Scroll arrays from clashing. Any array originating in ^ZVEMKT
"RTN","ZVEMS",9,0)
 ;;can't allow branching (to Help for example) which will call ^ZVEMKT
"RTN","ZVEMS",10,0)
 ;;and start another array that will clash. Only external users of the
"RTN","ZVEMS",11,0)
 ;;scroller (like VGL) which have a different subscript, can do this.
"RTN","ZVEMS",12,0)
 ;;^%ZVEMKT - Scroller
"RTN","ZVEMS",13,0)
 ;; IMPORT          ^TMP("VEE","K",$J,
"RTN","ZVEMS",14,0)
 ;; RTN                    ""
"RTN","ZVEMS",15,0)
 ;; GLB                    ""
"RTN","ZVEMS",16,0)
 ;;External IMPORTING - Subscript starts with "I" when IMPORTING.
"RTN","ZVEMS",17,0)
 ;; VGL                     ^TMP("VEE","IG"_GLS,$J,
"RTN","ZVEMS",18,0)
 ;; VGL(Piece)              ^TMP("VEE","IGP",$J,
"RTN","ZVEMS",19,0)
 ;; VEDD(Global Location)   ^TMP("VEE","ID"_VEDDS,$J,
"RTN","ZVEMS",20,0)
 ;;VRR(Rtn Edit)           ^TMP("VEE","IR"_VRRS,$J,
"RTN","ZVEMS",21,0)
 ;;
"RTN","ZVEMS",22,0)
 ;;VEET("HD") + VEET("FT") - 1 = Top $Y
"RTN","ZVEMS",23,0)
 ;;Top $Y + VEET("S2") - VEET("S1") = Bottom $Y
"RTN","ZVEMS",24,0)
 ;;************** NEW VPE VERSION **************
"RTN","ZVEMS",25,0)
 ;;Notes for changing version number and doing updates.
"RTN","ZVEMS",26,0)
 ;;VEE File number range: 19200-19204
"RTN","ZVEMS",27,0)
 ;;NEW VERSION: 1. VPE_xx.DOC.....in DOS..Update version number
"RTN","ZVEMS",28,0)
 ;;             2. Change 2nd line of ^ZVEM*
"RTN","ZVEMSF1")
0^224^B9773043
"RTN","ZVEMSF1",1,0)
ZVEMSF1 ;DJB,VSHL**DDS,DIAC,DIB,DIM,DIO2 [04/17/94]
"RTN","ZVEMSF1",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMSF1",3,0)
 ;
"RTN","ZVEMSF1",4,0)
DDS ;;;
"RTN","ZVEMSF1",5,0)
 ;;; D D S     ScreenMan
"RTN","ZVEMSF1",6,0)
 ;;;
"RTN","ZVEMSF1",7,0)
 ;;; 1. ENTRY POINT: ^DDS
"RTN","ZVEMSF1",8,0)
 ;;;
"RTN","ZVEMSF1",9,0)
 ;;; 2. INPUT VARIABLES
"RTN","ZVEMSF1",10,0)
 ;;;    DDSFILE.....File number or global root.
"RTN","ZVEMSF1",11,0)
 ;;;    DA..........Internal entry number.
"RTN","ZVEMSF1",12,0)
 ;;;    DR..........Name of form enclosed in brackets (FORM file).
"RTN","ZVEMSF1",13,0)
 ;;;
"RTN","ZVEMSF1",14,0)
 ;;;    Editing a subfile directly. Kill DDSFILE(1) when complete.
"RTN","ZVEMSF1",15,0)
 ;;;    DDSFILE(1).....Subfile number or global root.
"RTN","ZVEMSF1",16,0)
 ;;;    DA(1)...DA(n)..The DA array. DA is subrecord number and DA(n) is record
"RTN","ZVEMSF1",17,0)
 ;;;    number at top level.
"RTN","ZVEMSF1",18,0)
 ;;;
"RTN","ZVEMSF1",19,0)
 ;;; 3. OUTPUT VARIABLES
"RTN","ZVEMSF1",20,0)
 ;;;    DTOUT..........User timed out.
"RTN","ZVEMSF1",21,0)
 ;;;
"RTN","ZVEMSF1",22,0)
 ;;; 4. EXAMPLE
"RTN","ZVEMSF1",23,0)
 ;;;    S DDSFILE=16500,DA=15,DR="[EE FORM1]" D ^DDS
"RTN","ZVEMSF1",24,0)
 ;;;***
"RTN","ZVEMSF1",25,0)
DIAC ;;;
"RTN","ZVEMSF1",26,0)
 ;;; D I A C     File Access Determination
"RTN","ZVEMSF1",27,0)
 ;;;
"RTN","ZVEMSF1",28,0)
 ;;; 1. ENTRY POINT: ^DIAC
"RTN","ZVEMSF1",29,0)
 ;;;
"RTN","ZVEMSF1",30,0)
 ;;; 2. INPUT VARIABLES
"RTN","ZVEMSF1",31,0)
 ;;;    DIFILE.....File number.
"RTN","ZVEMSF1",32,0)
 ;;;    DIAC......."RD"    Verify Read access
"RTN","ZVEMSF1",33,0)
 ;;;               "WR"    Verify Write access
"RTN","ZVEMSF1",34,0)
 ;;;               "AUDIT" Verify Audit access
"RTN","ZVEMSF1",35,0)
 ;;;               "DD"    Verify Data Dictionary access
"RTN","ZVEMSF1",36,0)
 ;;;               "DEL"   Verify Delete access
"RTN","ZVEMSF1",37,0)
 ;;;               "LAYGO" Verify LAYGO access
"RTN","ZVEMSF1",38,0)
 ;;;
"RTN","ZVEMSF1",39,0)
 ;;; 3. OUTPUT VARIABLES
"RTN","ZVEMSF1",40,0)
 ;;;    DIAC.....Either 1 (has access) or 0 (doesn't have access).
"RTN","ZVEMSF1",41,0)
 ;;;    %........Same as DIAC.
"RTN","ZVEMSF1",42,0)
 ;;;***
"RTN","ZVEMSF1",43,0)
DIB ;;;
"RTN","ZVEMSF1",44,0)
 ;;; D I B     User Controlled Editing
"RTN","ZVEMSF1",45,0)
 ;;;
"RTN","ZVEMSF1",46,0)
 ;;; 1. ENTRY POINT: EN^DIB
"RTN","ZVEMSF1",47,0)
 ;;;
"RTN","ZVEMSF1",48,0)
 ;;; 2. INPUT VARIABLES
"RTN","ZVEMSF1",49,0)
 ;;;    DIE..........File number or global root.
"RTN","ZVEMSF1",50,0)
 ;;;    DIE("NO^")..."OUTOK"         Prevents jumping. Allows exiting.
"RTN","ZVEMSF1",51,0)
 ;;;                 "BACK"          Allows jumping back. No exiting.
"RTN","ZVEMSF1",52,0)
 ;;;                 "BACKOUTOK"     Allows jumping back. Allows exiting.
"RTN","ZVEMSF1",53,0)
 ;;;                 "Other value"   Prevents all jumping. No exiting.
"RTN","ZVEMSF1",54,0)
 ;;;    DIDEL........Override Delete Access (Set DIDEL=File number).
"RTN","ZVEMSF1",55,0)
 ;;;***
"RTN","ZVEMSF1",56,0)
DIM ;;;
"RTN","ZVEMSF1",57,0)
 ;;; D I M     M Code Validation.
"RTN","ZVEMSF1",58,0)
 ;;;
"RTN","ZVEMSF1",59,0)
 ;;; 1. ENTRY POINT: ^DIM
"RTN","ZVEMSF1",60,0)
 ;;;
"RTN","ZVEMSF1",61,0)
 ;;; 2. INPUT VARIABLES
"RTN","ZVEMSF1",62,0)
 ;;;    X......Code to be evaluated.
"RTN","ZVEMSF1",63,0)
 ;;;
"RTN","ZVEMSF1",64,0)
 ;;; 3. OUTPUT VARIABLES
"RTN","ZVEMSF1",65,0)
 ;;;    X......If $D(X) is zero the line of code was invalid.
"RTN","ZVEMSF1",66,0)
 ;;;***
"RTN","ZVEMSF1",67,0)
DIO2 ;;;
"RTN","ZVEMSF1",68,0)
 ;;; D I O 2     Internal to External Date
"RTN","ZVEMSF1",69,0)
 ;;;
"RTN","ZVEMSF1",70,0)
 ;;; 1. ENTRY POINT: DT^DIO2
"RTN","ZVEMSF1",71,0)
 ;;;    Takes an internal date and writes out its external form.
"RTN","ZVEMSF1",72,0)
 ;;;
"RTN","ZVEMSF1",73,0)
 ;;; 2. INPUT VARIABLES
"RTN","ZVEMSF1",74,0)
 ;;;    Y......Internal date.
"RTN","ZVEMSF1",75,0)
 ;;;***
"RTN","ZVEMSF2")
0^225^B21894065
"RTN","ZVEMSF2",1,0)
ZVEMSF2 ;DJB,VSHL**DIC [8/3/97 1:29pm]
"RTN","ZVEMSF2",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMSF2",3,0)
 ;
"RTN","ZVEMSF2",4,0)
DIC ;;;
"RTN","ZVEMSF2",5,0)
 ;;; D I C     Look-up/Add New Entries
"RTN","ZVEMSF2",6,0)
 ;;;
"RTN","ZVEMSF2",7,0)
 ;;; 1. ENTRY POINT: ^DIC
"RTN","ZVEMSF2",8,0)
 ;;;
"RTN","ZVEMSF2",9,0)
 ;;; 2. INPUT VARIABLES
"RTN","ZVEMSF2",10,0)
 ;;;    DIC.....File number or global root ("^GLOBAL(" or "^GLOBAL(X,Y,").
"RTN","ZVEMSF2",11,0)
 ;;;    DIC(0)....A  Ask entry
"RTN","ZVEMSF2",12,0)
 ;;;              C  Cross reference suppression is turned off
"RTN","ZVEMSF2",13,0)
 ;;;              E  Echo back information
"RTN","ZVEMSF2",14,0)
 ;;;              F  Forget look-up value
"RTN","ZVEMSF2",15,0)
 ;;;              I  Ignore special look-up program
"RTN","ZVEMSF2",16,0)
 ;;;              L  LAYGO allowed
"RTN","ZVEMSF2",17,0)
 ;;;              M  Multiple-index look-up allowed
"RTN","ZVEMSF2",18,0)
 ;;;              N  Internal Number look-up allowed
"RTN","ZVEMSF2",19,0)
 ;;;              O  Only find one entry if it matches exactly
"RTN","ZVEMSF2",20,0)
 ;;;              Q  Question erroneous input
"RTN","ZVEMSF2",21,0)
 ;;;              S  Suppress display of .01
"RTN","ZVEMSF2",22,0)
 ;;;              X  EXact match required
"RTN","ZVEMSF2",23,0)
 ;;;              Z  Zero node returned in Y(0) and external form in Y(0,0)
"RTN","ZVEMSF2",24,0)
 ;;;    X........If DIC(0) doesn't contain A, set X=Value you want to look up.
"RTN","ZVEMSF2",25,0)
 ;;;    DIC("A")...Prompt.
"RTN","ZVEMSF2",26,0)
 ;;;    DIC("B")...Default answer.
"RTN","ZVEMSF2",27,0)
 ;;;    DIC("S")...Screen. When screen is executed Y=Internal number, and naked.
"RTN","ZVEMSF2",28,0)
 ;;;                indicator is at zero node.
"RTN","ZVEMSF2",29,0)
 ;;;    DIC("W")...Command string executed when DIC displays each of the entries
"RTN","ZVEMSF2",30,0)
 ;;;                that match user's input. Y and naked ref is same as DIC("S").
"RTN","ZVEMSF2",31,0)
 ;;;                Overrides identifiers. DIC("W")="" will suppress identifiers.
"RTN","ZVEMSF2",32,0)
 ;;;    DIC("DR")..Fields that will be asked if LAYGO and you add new entry.
"RTN","ZVEMSF2",33,0)
 ;;;    DIC("P")...Needed to successfully add FIRST subentry to a multiple field.
"RTN","ZVEMSF2",34,0)
 ;;;                Set it to 2nd piece of zero node of multiple field's
"RTN","ZVEMSF2",35,0)
 ;;;                definition in ^DD. Ex: S DIC("P")=$P(^DD(2,9,0),"^",2)
"RTN","ZVEMSF2",36,0)
 ;;;    DTIME......Number of seconds for time-out.
"RTN","ZVEMSF2",37,0)
 ;;;    DLAYGO.....If set equal to file number, user may add a new entry.
"RTN","ZVEMSF2",38,0)
 ;;;    DINUM......Identifies subscript at which data is to be stored.
"RTN","ZVEMSF2",39,0)
 ;;;
"RTN","ZVEMSF2",40,0)
 ;;; 3. OUTPUT VARIABLES
"RTN","ZVEMSF2",41,0)
 ;;;    Y........Y=-1   Look-up unsuccessful.
"RTN","ZVEMSF2",42,0)
 ;;;             Y=N^S  N is the internal number, S is the .01 field.
"RTN","ZVEMSF2",43,0)
 ;;;             Y=N^S^1  1 indicates entry has just been added.
"RTN","ZVEMSF2",44,0)
 ;;;    Y(0).....Set to zero node if DIC(0) contains Z.
"RTN","ZVEMSF2",45,0)
 ;;;    Y(0,0)...External form of .01 field if DIC(0) contains Z.
"RTN","ZVEMSF2",46,0)
 ;;;    X........If DIC(0) contains A, X will store users look-up value.
"RTN","ZVEMSF2",47,0)
 ;;;    DTOUT....Time-out occurred.
"RTN","ZVEMSF2",48,0)
 ;;;    DUOUT....User entered "^".
"RTN","ZVEMSF2",49,0)
 ;;;
"RTN","ZVEMSF2",50,0)
 ;;;    Sample code where file ^DIZ(16 has multiple field 9 at node 4.
"RTN","ZVEMSF2",51,0)
 ;;;    S DIC="^DIZ(16,",DIC(0)="QEAL" D ^DIC ;Get entry
"RTN","ZVEMSF2",52,0)
 ;;;    S DA(1)=+Y,DIC=DIC_DA(1)_",4," ;Root of subfile
"RTN","ZVEMSF2",53,0)
 ;;;    S DIC(0)="QEAL",DIC("P")=$P(^DD(16,9,0),"^",2)
"RTN","ZVEMSF2",54,0)
 ;;;    D ^DIC ;Get subentry
"RTN","ZVEMSF2",55,0)
 ;;;    S DIE=DIC KILL DIC S DA=+Y,DR="1;2" D ^DIE ;Edit multiples directly
"RTN","ZVEMSF2",56,0)
 ;;;
"RTN","ZVEMSF2",57,0)
 ;;; 1. ENTRY POINT: IX^DIC
"RTN","ZVEMSF2",58,0)
 ;;;
"RTN","ZVEMSF2",59,0)
 ;;; 2. INPUT VARIABLES
"RTN","ZVEMSF2",60,0)
 ;;;    DIC......Global root
"RTN","ZVEMSF2",61,0)
 ;;;    DIC(0)...Same as ^DIC
"RTN","ZVEMSF2",62,0)
 ;;;    D........The cross reference in which to start looking. If DIC(0) contains
"RTN","ZVEMSF2",63,0)
 ;;;             M, then DIC will continue with further cross references. If it
"RTN","ZVEMSF2",64,0)
 ;;;             does not, then the look-up is only on the single cross reference.
"RTN","ZVEMSF2",65,0)
 ;;;    X........If DIC(0) does not contain an A, then X must equal look-up value.
"RTN","ZVEMSF2",66,0)
 ;;;
"RTN","ZVEMSF2",67,0)
 ;;; 3. OUTPUT VARIABLES
"RTN","ZVEMSF2",68,0)
 ;;;    Y........Y=-1   Look-up unsuccessful.
"RTN","ZVEMSF2",69,0)
 ;;;             Y=N^S  N is the internal number, S is the .01 field.
"RTN","ZVEMSF2",70,0)
 ;;;             Y=N^S^1  1 indicates entry has just been added.
"RTN","ZVEMSF2",71,0)
 ;;;    Y(0).....Set to zero node if DIC(0) contains Z.
"RTN","ZVEMSF2",72,0)
 ;;;    Y(0,0)...External form of .01 field if DIC(0) contains Z.
"RTN","ZVEMSF2",73,0)
 ;;;    X........If DIC(0) contains A, X will store users look-up value.
"RTN","ZVEMSF2",74,0)
 ;;;    DTOUT....Time-out occurred.
"RTN","ZVEMSF2",75,0)
 ;;;    DUOUT....User entered "^".
"RTN","ZVEMSF2",76,0)
 ;;;
"RTN","ZVEMSF2",77,0)
 ;;; 1. ENTRY POINT: MIX^DIC1
"RTN","ZVEMSF2",78,0)
 ;;;
"RTN","ZVEMSF2",79,0)
 ;;; 2. INPUT VARIABLES
"RTN","ZVEMSF2",80,0)
 ;;;    Same as IX^DIC except variable D can contain a list of xrefs
"RTN","ZVEMSF2",81,0)
 ;;;    separated by up-arrow. If DIC(0) does not contain M, only the
"RTN","ZVEMSF2",82,0)
 ;;;    first xref in D will be used for the look-up.
"RTN","ZVEMSF2",83,0)
 ;;;
"RTN","ZVEMSF2",84,0)
 ;;; 3. OUTPUT VARIABLES
"RTN","ZVEMSF2",85,0)
 ;;;    Same as IX^DIC.
"RTN","ZVEMSF2",86,0)
 ;;;***
"RTN","ZVEMSF3")
0^226^B17059126
"RTN","ZVEMSF3",1,0)
ZVEMSF3 ;DJB,VSHL**DIC1,DICN [04/17/94]
"RTN","ZVEMSF3",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMSF3",3,0)
 ;
"RTN","ZVEMSF3",4,0)
DIC1 ;;;
"RTN","ZVEMSF3",5,0)
 ;;; D I C 1     Custom Look-up & File Information Setup
"RTN","ZVEMSF3",6,0)
 ;;;
"RTN","ZVEMSF3",7,0)
 ;;; 1. ENTRY POINT: DO^DIC1
"RTN","ZVEMSF3",8,0)
 ;;;    If $D(DO), DO^DIC1 will QUIT. If DIC("W") is defined it won't be changed.
"RTN","ZVEMSF3",9,0)
 ;;;
"RTN","ZVEMSF3",10,0)
 ;;; 2. INPUT VARIABLES
"RTN","ZVEMSF3",11,0)
 ;;;    DIC......Global root
"RTN","ZVEMSF3",12,0)
 ;;;    DIC(0)...Same as ^DIC
"RTN","ZVEMSF3",13,0)
 ;;;
"RTN","ZVEMSF3",14,0)
 ;;; 3. OUTPUT VARIABLES
"RTN","ZVEMSF3",15,0)
 ;;;    DO.......File name^file number and specifiers. This is the file
"RTN","ZVEMSF3",16,0)
 ;;;             descriptor node. (Use letter O, not zero.)
"RTN","ZVEMSF3",17,0)
 ;;;    DO(2)....File number and specifiers. This is the 2nd piece of DO.
"RTN","ZVEMSF3",18,0)
 ;;;             +DO(2) will always equal the file number.
"RTN","ZVEMSF3",19,0)
 ;;;    DIC("W")..Contains write logic for identifiers. ^DD(+DO(2),0,"ID",value)
"RTN","ZVEMSF3",20,0)
 ;;;              Specifier I, must be in DO(2) for Fileman to look at ID nodes.
"RTN","ZVEMSF3",21,0)
 ;;;    DO("SCR")..Contains IF statement that screens out entries. Screen is
"RTN","ZVEMSF3",22,0)
 ;;;              applied to inquiries and printouts as well as look-ups.
"RTN","ZVEMSF3",23,0)
 ;;;
"RTN","ZVEMSF3",24,0)
 ;;; 1. ENTRY POINT: MIX^DIC1
"RTN","ZVEMSF3",25,0)
 ;;;    ^DIC does look-up starting with B cross ref. You can make it do a
"RTN","ZVEMSF3",26,0)
 ;;;    look-up on a specific set of cross references by calling DIC1 at MIX.
"RTN","ZVEMSF3",27,0)
 ;;;
"RTN","ZVEMSF3",28,0)
 ;;; 2. INPUT VARIABLES
"RTN","ZVEMSF3",29,0)
 ;;;    DIC......Global root
"RTN","ZVEMSF3",30,0)
 ;;;    DIC(0)...Same as ^DIC. If it doesn't contain M, only first cross ref
"RTN","ZVEMSF3",31,0)
 ;;;             in D will be used for look-up.
"RTN","ZVEMSF3",32,0)
 ;;;    D........The list of cross references, separated by up-arrow.
"RTN","ZVEMSF3",33,0)
 ;;;    X........If DIC(0) doesn't contain A, variable X must be equal to the
"RTN","ZVEMSF3",34,0)
 ;;;             value you want to look-up.
"RTN","ZVEMSF3",35,0)
 ;;;
"RTN","ZVEMSF3",36,0)
 ;;; 3. OUTPUT VARIABLES
"RTN","ZVEMSF3",37,0)
 ;;;    Y........Y=-1   Look-up unsuccessful.
"RTN","ZVEMSF3",38,0)
 ;;;             Y=N^S  N is the internal number, S is the .01 field.
"RTN","ZVEMSF3",39,0)
 ;;;             Y=N^S^1  1 indicates entry has just been added.
"RTN","ZVEMSF3",40,0)
 ;;;    Y(0).....Set to zero node if DIC(0) contains Z.
"RTN","ZVEMSF3",41,0)
 ;;;    Y(0,0)...External form of .01 field if DIC(0) contains Z.
"RTN","ZVEMSF3",42,0)
 ;;;    DTOUT....Time-out occurred.
"RTN","ZVEMSF3",43,0)
 ;;;    DUOUT....User entered "^".
"RTN","ZVEMSF3",44,0)
 ;;;***
"RTN","ZVEMSF3",45,0)
DICN ;;;
"RTN","ZVEMSF3",46,0)
 ;;; D I C N     Adding New Entries. YES/NO Prompts.
"RTN","ZVEMSF3",47,0)
 ;;;
"RTN","ZVEMSF3",48,0)
 ;;; 1. ENTRY POINT: FILE^DICN
"RTN","ZVEMSF3",49,0)
 ;;;    You must Kill DD. If DO does not contain the characteristics of the file
"RTN","ZVEMSF3",50,0)
 ;;;    you are adding to, then DO should be killed.
"RTN","ZVEMSF3",51,0)
 ;;;
"RTN","ZVEMSF3",52,0)
 ;;; 2. INPUT VARIABLES
"RTN","ZVEMSF3",53,0)
 ;;;    DIC......Global root
"RTN","ZVEMSF3",54,0)
 ;;;    DIC(0)...Same as ^DIC
"RTN","ZVEMSF3",55,0)
 ;;;    X........The value of the .01 field. Programmer must insure value has
"RTN","ZVEMSF3",56,0)
 ;;;             already met input transform criteria.
"RTN","ZVEMSF3",57,0)
 ;;;    DINUM....Optional. Identifies subscript where data is to be stored.
"RTN","ZVEMSF3",58,0)
 ;;;    DIC("DR")..Optional. Used to input other data elements when entry is made.
"RTN","ZVEMSF3",59,0)
 ;;;
"RTN","ZVEMSF3",60,0)
 ;;; 3. OUTPUT VARIABLES
"RTN","ZVEMSF3",61,0)
 ;;;    Y........Y=-1   Look-up unsuccessful. No new entry.
"RTN","ZVEMSF3",62,0)
 ;;;             Y=N^S^1  1 indicates entry has just been added.
"RTN","ZVEMSF3",63,0)
 ;;;    Y(0).....Set to zero node if DIC(0) contains Z.
"RTN","ZVEMSF3",64,0)
 ;;;    Y(0,0)...External form of .01 field if DIC(0) contains Z.
"RTN","ZVEMSF3",65,0)
 ;;;    DTOUT....Time-out occurred.
"RTN","ZVEMSF3",66,0)
 ;;;    DUOUT....User entered "^".
"RTN","ZVEMSF3",67,0)
 ;;;
"RTN","ZVEMSF3",68,0)
 ;;; 1. ENTRY POINT: YN^DICN
"RTN","ZVEMSF3",69,0)
 ;;;    Process a YES/NO response.
"RTN","ZVEMSF3",70,0)
 ;;;
"RTN","ZVEMSF3",71,0)
 ;;; 2. INPUT VARIABLES
"RTN","ZVEMSF3",72,0)
 ;;;    %........Default response. 0=No default
"RTN","ZVEMSF3",73,0)
 ;;;                               1=YES
"RTN","ZVEMSF3",74,0)
 ;;;                               2=NO
"RTN","ZVEMSF3",75,0)
 ;;;
"RTN","ZVEMSF3",76,0)
 ;;; 3. OUTPUT VARIABLES
"RTN","ZVEMSF3",77,0)
 ;;;     %.......-1   User entered ^
"RTN","ZVEMSF3",78,0)
 ;;;              0   User entered ?
"RTN","ZVEMSF3",79,0)
 ;;;              1   User entered YES
"RTN","ZVEMSF3",80,0)
 ;;;              2   User entered NO
"RTN","ZVEMSF3",81,0)
 ;;;     %Y.......Actual text that the user entered.
"RTN","ZVEMSF3",82,0)
 ;;;***
"RTN","ZVEMSF4")
0^227^B11292960
"RTN","ZVEMSF4",1,0)
ZVEMSF4 ;DJB,VSHL**DICQ,DICRW,DID,DIEZ,DIFG,DICD,DIKZ [12/4/95 7:08pm]
"RTN","ZVEMSF4",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMSF4",3,0)
 ;
"RTN","ZVEMSF4",4,0)
DICQ ;;;
"RTN","ZVEMSF4",5,0)
 ;;; D I C Q     Entry Display for Loop-ups
"RTN","ZVEMSF4",6,0)
 ;;;
"RTN","ZVEMSF4",7,0)
 ;;; 1. ENTRY POINT: DQ^DICQ
"RTN","ZVEMSF4",8,0)
 ;;;    Use this subroutine to process a question mark response directly.
"RTN","ZVEMSF4",9,0)
 ;;;
"RTN","ZVEMSF4",10,0)
 ;;; 2. INPUT VARIABLES
"RTN","ZVEMSF4",11,0)
 ;;;    DIC........Global root
"RTN","ZVEMSF4",12,0)
 ;;;    DIC(0).....Same as ^DIC
"RTN","ZVEMSF4",13,0)
 ;;;    DIC("S")...Optional. Same as ^DIC
"RTN","ZVEMSF4",14,0)
 ;;;    D..........Set to "B".
"RTN","ZVEMSF4",15,0)
 ;;;    DZ.........Set to "??" to prevent "DO YOU WANT TO SEE ALL nn ENTRIES?"
"RTN","ZVEMSF4",16,0)
 ;;;               prompt.
"RTN","ZVEMSF4",17,0)
 ;;;***
"RTN","ZVEMSF4",18,0)
DICRW ;;;
"RTN","ZVEMSF4",19,0)
 ;;; D I C R W     Required Variables
"RTN","ZVEMSF4",20,0)
 ;;;
"RTN","ZVEMSF4",21,0)
 ;;; 1. ENTRY POINT: DT^DICRW
"RTN","ZVEMSF4",22,0)
 ;;;
"RTN","ZVEMSF4",23,0)
 ;;; 2. OUTPUT VARIABLES
"RTN","ZVEMSF4",24,0)
 ;;;    DUZ......Set to zero if not already defined.
"RTN","ZVEMSF4",25,0)
 ;;;    DUZ(0)...Set to null if not already defined. If DUZ(0)=@ enables
"RTN","ZVEMSF4",26,0)
 ;;;             terminal break if operating system supports it.
"RTN","ZVEMSF4",27,0)
 ;;;    IO(0)....Set to $I if IO(0) is not defined. Therefore this program should
"RTN","ZVEMSF4",28,0)
 ;;;             not be used if user is on a device different from the home
"RTN","ZVEMSF4",29,0)
 ;;;             terminal and IO(0) is undefined.
"RTN","ZVEMSF4",30,0)
 ;;;    DT.......Set to the current date.
"RTN","ZVEMSF4",31,0)
 ;;;    U........Up-arrow (^).
"RTN","ZVEMSF4",32,0)
 ;;;***
"RTN","ZVEMSF4",33,0)
DID ;;;
"RTN","ZVEMSF4",34,0)
 ;;; D I D     Data Dictionary Listing
"RTN","ZVEMSF4",35,0)
 ;;;
"RTN","ZVEMSF4",36,0)
 ;;; 1. ENTRY POINT: EN^DID
"RTN","ZVEMSF4",37,0)
 ;;;
"RTN","ZVEMSF4",38,0)
 ;;; 2. INPUT VARIABLES
"RTN","ZVEMSF4",39,0)
 ;;;    DIC........Data dictionary number
"RTN","ZVEMSF4",40,0)
 ;;;    DIFORMAT...Equal to desired data dictionary format:
"RTN","ZVEMSF4",41,0)
 ;;;               STANDARD, BRIEF, MODIFIED STANDARD, TEMPLATES ONLY
"RTN","ZVEMSF4",42,0)
 ;;;               GLOBAL MAP, CONDENSED
"RTN","ZVEMSF4",43,0)
 ;;;***
"RTN","ZVEMSF4",44,0)
DIEZ ;;;
"RTN","ZVEMSF4",45,0)
 ;;; D I E Z     Input Template Compilation
"RTN","ZVEMSF4",46,0)
 ;;;
"RTN","ZVEMSF4",47,0)
 ;;; 1. ENTRY POINT: ^DIEZ
"RTN","ZVEMSF4",48,0)
 ;;;
"RTN","ZVEMSF4",49,0)
 ;;; 1. ENTRY POINT: EN^DIEZ
"RTN","ZVEMSF4",50,0)
 ;;;    Recompile an input template without user intervention.
"RTN","ZVEMSF4",51,0)
 ;;;
"RTN","ZVEMSF4",52,0)
 ;;; 2. INPUT VARIABLES
"RTN","ZVEMSF4",53,0)
 ;;;    X.......Routine name.
"RTN","ZVEMSF4",54,0)
 ;;;    Y.......The internal entry number of template.
"RTN","ZVEMSF4",55,0)
 ;;;    DMAX....Maximum size of compiled routines.
"RTN","ZVEMSF4",56,0)
 ;;;***
"RTN","ZVEMSF4",57,0)
DIFG ;;;
"RTN","ZVEMSF4",58,0)
 ;;; D I F G     Filegrams
"RTN","ZVEMSF4",59,0)
 ;;;
"RTN","ZVEMSF4",60,0)
 ;;;  Refer to the VA Fileman Programmer's Manual.
"RTN","ZVEMSF4",61,0)
 ;;;***
"RTN","ZVEMSF4",62,0)
DICD ;;;
"RTN","ZVEMSF4",63,0)
 ;;; D I C D     Wait Messages
"RTN","ZVEMSF4",64,0)
 ;;;
"RTN","ZVEMSF4",65,0)
 ;;; 1. ENTRY POINT: WAIT^DICD
"RTN","ZVEMSF4",66,0)
 ;;;    Generates wait messages.
"RTN","ZVEMSF4",67,0)
 ;;;***
"RTN","ZVEMSF4",68,0)
DIKZ ;;;
"RTN","ZVEMSF4",69,0)
 ;;; D I K Z     Cross Reference Compilation
"RTN","ZVEMSF4",70,0)
 ;;;
"RTN","ZVEMSF4",71,0)
 ;;; 1. ENTRY POINT: ^DIKZ
"RTN","ZVEMSF4",72,0)
 ;;;    Compiled routines are then used when any calls to ^DIK are made.
"RTN","ZVEMSF4",73,0)
 ;;;
"RTN","ZVEMSF4",74,0)
 ;;; 1. ENTRY POINT: EN^DIKZ
"RTN","ZVEMSF4",75,0)
 ;;;    Recompile a file's cross references without user intervention.
"RTN","ZVEMSF4",76,0)
 ;;;
"RTN","ZVEMSF4",77,0)
 ;;; 2. INPUT VARIABLES
"RTN","ZVEMSF4",78,0)
 ;;;    X.......Routine name.
"RTN","ZVEMSF4",79,0)
 ;;;    Y.......The file number.
"RTN","ZVEMSF4",80,0)
 ;;;    DMAX....Maximum size of compiled routines.
"RTN","ZVEMSF4",81,0)
 ;;;***
"RTN","ZVEMSF5")
0^228^B17303117
"RTN","ZVEMSF5",1,0)
ZVEMSF5 ;DJB,VSHL**DIE [12/4/95 7:12pm]
"RTN","ZVEMSF5",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMSF5",3,0)
 ;
"RTN","ZVEMSF5",4,0)
DIE ;;;
"RTN","ZVEMSF5",5,0)
 ;;; D I E     Edit Data
"RTN","ZVEMSF5",6,0)
 ;;;
"RTN","ZVEMSF5",7,0)
 ;;; 1. ENTRY POINT: ^DIE
"RTN","ZVEMSF5",8,0)
 ;;;
"RTN","ZVEMSF5",9,0)
 ;;; 2. INPUT VARIABLES
"RTN","ZVEMSF5",10,0)
 ;;;    DIE........Global root or file number.
"RTN","ZVEMSF5",11,0)
 ;;;    DA.........Internal entry number.
"RTN","ZVEMSF5",12,0)
 ;;;    DR.........Fields to be edited. Examples:
"RTN","ZVEMSF5",13,0)
 ;;;          S DR="27"  Field number.
"RTN","ZVEMSF5",14,0)
 ;;;          S DR="27//TODAY"  Offer default prompt. Value on file overrides
"RTN","ZVEMSF5",15,0)
 ;;;                            default.
"RTN","ZVEMSF5",16,0)
 ;;;          S DR="27///TODAY"  "Stuffs" a value. Value is in external form
"RTN","ZVEMSF5",17,0)
 ;;;                             and passes thru input transform.
"RTN","ZVEMSF5",18,0)
 ;;;          S DR="27///^S X=VAR"  "Stuffs" a value stored in a variable.
"RTN","ZVEMSF5",19,0)
 ;;;          S DR="27////2570120"  "Stuffs" a value. Value is in internal
"RTN","ZVEMSF5",20,0)
 ;;;                             form, and doesn't pass thru input transform.
"RTN","ZVEMSF5",21,0)
 ;;;                             Can't be used for .01 field.
"RTN","ZVEMSF5",22,0)
 ;;;          S DR="27:60"  A range of field numbers.
"RTN","ZVEMSF5",23,0)
 ;;;          A place holder like @1.
"RTN","ZVEMSF5",24,0)
 ;;;          A line of M code.
"RTN","ZVEMSF5",25,0)
 ;;;          A sequence of any of the above types separated by ";".
"RTN","ZVEMSF5",26,0)
 ;;;          An input template enclosed in brackets.
"RTN","ZVEMSF5",27,0)
 ;;;    DIE("NO^")..."OUTOK"         No jump. Exit ok.
"RTN","ZVEMSF5",28,0)
 ;;;                 "BACK"          Jump back ok. No exit.
"RTN","ZVEMSF5",29,0)
 ;;;                 "BACKOUTOK"     Jump back ok. Exit ok.
"RTN","ZVEMSF5",30,0)
 ;;;                 "Other value"   No jump. No exit.
"RTN","ZVEMSF5",31,0)
 ;;;    DIDEL........Override Delete Access (Set DIDEL=File number).
"RTN","ZVEMSF5",32,0)
 ;;;
"RTN","ZVEMSF5",33,0)
 ;;; 3. OUTPUT VARIABLES
"RTN","ZVEMSF5",34,0)
 ;;;    DTOUT........Time out
"RTN","ZVEMSF5",35,0)
 ;;;
"RTN","ZVEMSF5",36,0)
 ;;;  LOCKING: So 2 users can't edit entry at same time.
"RTN","ZVEMSF5",37,0)
 ;;;      S DIE="^FILE(,",DA=777,DR="[EDIT]"
"RTN","ZVEMSF5",38,0)
 ;;;      L ^FILE(777):0 I $T D ^DIE L  Q
"RTN","ZVEMSF5",39,0)
 ;;;      W !?5,"Another user is editing this entry." Q
"RTN","ZVEMSF5",40,0)
 ;;;
"RTN","ZVEMSF5",41,0)
 ;;;  SPECIFIERS: When responding to EDIT WHICH FIELD prompt:
"RTN","ZVEMSF5",42,0)
 ;;;      T.........Use Title instead of Label.
"RTN","ZVEMSF5",43,0)
 ;;;      "xxx".....Use literal as prompt.
"RTN","ZVEMSF5",44,0)
 ;;;      DUP.......Duplicate response to this field from entry to entry.
"RTN","ZVEMSF5",45,0)
 ;;;      REQ.......Require an answer.
"RTN","ZVEMSF5",46,0)
 ;;;      3T........Title.
"RTN","ZVEMSF5",47,0)
 ;;;      3xxx......Use literal as prompt. No quotes.
"RTN","ZVEMSF5",48,0)
 ;;;      3d........Duplicate response. Lowercase D.
"RTN","ZVEMSF5",49,0)
 ;;;      3R........Require an answer.
"RTN","ZVEMSF5",50,0)
 ;;;      Use "~" to combine specifiers. Ex: 3R~T
"RTN","ZVEMSF5",51,0)
 ;;;
"RTN","ZVEMSF5",52,0)
 ;;;  BRANCHING: Insert executable M statement in the DR string. If the code
"RTN","ZVEMSF5",53,0)
 ;;;             sets Y, DIE will jump to that field (field must be in DR string).
"RTN","ZVEMSF5",54,0)
 ;;;             Y may be set to place holder, e.g. @1. If Y is set to 0 or "",
"RTN","ZVEMSF5",55,0)
 ;;;             DIE will exit. If Y is killed or never set, no branching will
"RTN","ZVEMSF5",56,0)
 ;;;             occur. Y can be calculated using X which equals internal value
"RTN","ZVEMSF5",57,0)
 ;;;             of field previously asked for.
"RTN","ZVEMSF5",58,0)
 ;;;             Ex: S DR="4;I X=""YES"" S Y=10;.01;10;15"
"RTN","ZVEMSF5",59,0)
 ;;;
"RTN","ZVEMSF5",60,0)
 ;;;  SPECIFIC FIELDS IN MULTIPLES:
"RTN","ZVEMSF5",61,0)
 ;;;        Multiple field 15, subfields .01 and 7:
"RTN","ZVEMSF5",62,0)
 ;;;        S DR=".01;15;6"
"RTN","ZVEMSF5",63,0)
 ;;;        S DR(2,16001.02)=".01;7"
"RTN","ZVEMSF5",64,0)
 ;;;
"RTN","ZVEMSF5",65,0)
 ;;;  CONTINUED DR STRING: If more than 245 characters.
"RTN","ZVEMSF5",66,0)
 ;;;        S DR(2,16001.02,1)
"RTN","ZVEMSF5",67,0)
 ;;;        S DR(2,16001.02,2)
"RTN","ZVEMSF5",68,0)
 ;;;
"RTN","ZVEMSF5",69,0)
 ;;;  UP-ARROW EXIT: If user up-arrowed out of ^DIE variable Y will be defined.
"RTN","ZVEMSF5",70,0)
 ;;;
"RTN","ZVEMSF5",71,0)
 ;;;  EDITING SUBFILE DIRECTLY: Data in subfile 16000.02 is stored on node
"RTN","ZVEMSF5",72,0)
 ;;;        20 and you want to edit number 777, subentry 1:
"RTN","ZVEMSF5",73,0)
 ;;;        S DIE="^FILE(777,20,"
"RTN","ZVEMSF5",74,0)
 ;;;        S DA(1)=777
"RTN","ZVEMSF5",75,0)
 ;;;        S DA=1
"RTN","ZVEMSF5",76,0)
 ;;;        S DR=".01;7"
"RTN","ZVEMSF5",77,0)
 ;;;        D ^DIE
"RTN","ZVEMSF5",78,0)
 ;;;        Subfile zero node must be defined.
"RTN","ZVEMSF5",79,0)
 ;;;
"RTN","ZVEMSF5",80,0)
 ;;;  SCREENING VARIABLE POINTER: Set DIC("V"). Refer to the VA Fileman
"RTN","ZVEMSF5",81,0)
 ;;;                              Programmer's Manual.
"RTN","ZVEMSF5",82,0)
 ;;;
"RTN","ZVEMSF5",83,0)
 ;;;***
"RTN","ZVEMSF6")
0^229^B13243807
"RTN","ZVEMSF6",1,0)
ZVEMSF6 ;DJB,VSHL**DIK,DIPZ,DIR,DIS [12/4/95 7:07pm]
"RTN","ZVEMSF6",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMSF6",3,0)
 ;
"RTN","ZVEMSF6",4,0)
DIK ;;;
"RTN","ZVEMSF6",5,0)
 ;;; D I K     Entry Deletion and File Reindexing
"RTN","ZVEMSF6",6,0)
 ;;;
"RTN","ZVEMSF6",7,0)
 ;;; 1. ENTRY POINT: ^DIK
"RTN","ZVEMSF6",8,0)
 ;;;    Delete an entry. Doesn't update pointers to deleted entries.
"RTN","ZVEMSF6",9,0)
 ;;;    It does execute all cross references and triggers.
"RTN","ZVEMSF6",10,0)
 ;;;
"RTN","ZVEMSF6",11,0)
 ;;; 2. INPUT VARIABLES
"RTN","ZVEMSF6",12,0)
 ;;;    DIK......Global root.
"RTN","ZVEMSF6",13,0)
 ;;;    DA.......Entry number you wish to delete.
"RTN","ZVEMSF6",14,0)
 ;;;    DA(1)....Needed when deleting at a lower level.
"RTN","ZVEMSF6",15,0)
 ;;;
"RTN","ZVEMSF6",16,0)
 ;;;    Examples:  S DIK="^EMP(",DA=7 D ^DIK
"RTN","ZVEMSF6",17,0)
 ;;;               S DA(1)=1,DA=2,DIK="^EMP("_DA(1)_",""SX""," D ^DIK
"RTN","ZVEMSF6",18,0)
 ;;;               S DIK="^EMP(" F DA=2,9,11 D ^DIK
"RTN","ZVEMSF6",19,0)
 ;;;
"RTN","ZVEMSF6",20,0)
 ;;; 1. ENTRY POINT: ENALL^DIK
"RTN","ZVEMSF6",21,0)
 ;;;    Reindexes all entries in a file or subfile.
"RTN","ZVEMSF6",22,0)
 ;;;    Executes only the SET logic.
"RTN","ZVEMSF6",23,0)
 ;;;
"RTN","ZVEMSF6",24,0)
 ;;; 2. INPUT VARIABLES
"RTN","ZVEMSF6",25,0)
 ;;;    DIK......Global root.
"RTN","ZVEMSF6",26,0)
 ;;;    DIK(1)...Field number or Field number and specific cross reference
"RTN","ZVEMSF6",27,0)
 ;;;             separated by up-arrow.
"RTN","ZVEMSF6",28,0)
 ;;;             S DIK(1)=.01   -or-   S DIK(1)=".01^B^C"
"RTN","ZVEMSF6",29,0)
 ;;;    DA(1)....Needed when reindexing at a lower level.
"RTN","ZVEMSF6",30,0)
 ;;;
"RTN","ZVEMSF6",31,0)
 ;;; 1. ENTRY POINT: EN^DIK
"RTN","ZVEMSF6",32,0)
 ;;;    Reindexes a single field in a file or subfile, for one entry.
"RTN","ZVEMSF6",33,0)
 ;;;    Executes KILL and SET logic.
"RTN","ZVEMSF6",34,0)
 ;;;    Needs DIK,DA,DA(1),DIK(1).
"RTN","ZVEMSF6",35,0)
 ;;;
"RTN","ZVEMSF6",36,0)
 ;;; 1. ENTRY POINT: EN1^DIK
"RTN","ZVEMSF6",37,0)
 ;;;    Reindexes a single field in a file or subfile, for one entry.
"RTN","ZVEMSF6",38,0)
 ;;;    Executes only the SET logic.
"RTN","ZVEMSF6",39,0)
 ;;;    Needs DIK,DA,DA(1),DIK(1).
"RTN","ZVEMSF6",40,0)
 ;;;
"RTN","ZVEMSF6",41,0)
 ;;; 1. ENTRY POINT: IXALL^DIK
"RTN","ZVEMSF6",42,0)
 ;;;    Reindexes all cross references for all entries.
"RTN","ZVEMSF6",43,0)
 ;;;    Executes only the SET logic.
"RTN","ZVEMSF6",44,0)
 ;;;    Needs DIK.
"RTN","ZVEMSF6",45,0)
 ;;;
"RTN","ZVEMSF6",46,0)
 ;;; 1. ENTRY POINT: IX^DIK
"RTN","ZVEMSF6",47,0)
 ;;;    Reindexes all cross references for only one entry.
"RTN","ZVEMSF6",48,0)
 ;;;    Executes KILL and SET logic.
"RTN","ZVEMSF6",49,0)
 ;;;    Needs DIK,DA,DA(1).
"RTN","ZVEMSF6",50,0)
 ;;;
"RTN","ZVEMSF6",51,0)
 ;;; 1. ENTRY POINT: IX1^DIK
"RTN","ZVEMSF6",52,0)
 ;;;    Reindexes all cross references for only one entry.
"RTN","ZVEMSF6",53,0)
 ;;;    Executes only the SET logic.
"RTN","ZVEMSF6",54,0)
 ;;;    Needs DIK,DA,DA(1).
"RTN","ZVEMSF6",55,0)
 ;;;***
"RTN","ZVEMSF6",56,0)
DIPZ ;;;
"RTN","ZVEMSF6",57,0)
 ;;; D I P Z     Print Template Compilation
"RTN","ZVEMSF6",58,0)
 ;;;
"RTN","ZVEMSF6",59,0)
 ;;; 1. ENTRY POINT: ^DIPZ
"RTN","ZVEMSF6",60,0)
 ;;;    A DIPZ-compiled routine may be called by any program that passes to
"RTN","ZVEMSF6",61,0)
 ;;;    it DT,DUZ,IOSL,U, and D0 (entry number). Variable DXS must be killed
"RTN","ZVEMSF6",62,0)
 ;;;    before and after the call.
"RTN","ZVEMSF6",63,0)
 ;;;
"RTN","ZVEMSF6",64,0)
 ;;; 1. ENTRY POINT: EN^DIPZ
"RTN","ZVEMSF6",65,0)
 ;;;    Recompile an input template without user intervention.
"RTN","ZVEMSF6",66,0)
 ;;;
"RTN","ZVEMSF6",67,0)
 ;;; 2. INPUT VARIABLES
"RTN","ZVEMSF6",68,0)
 ;;;    X.......Routine name.
"RTN","ZVEMSF6",69,0)
 ;;;    Y.......The internal entry number of template.
"RTN","ZVEMSF6",70,0)
 ;;;    DMAX....Maximum size of compiled routines.
"RTN","ZVEMSF6",71,0)
 ;;;***
"RTN","ZVEMSF6",72,0)
DIR ;;;
"RTN","ZVEMSF6",73,0)
 ;;; D I R     Reader
"RTN","ZVEMSF6",74,0)
 ;;;
"RTN","ZVEMSF6",75,0)
 ;;;  Refer to the VA Fileman Programmer's Manual.
"RTN","ZVEMSF6",76,0)
 ;;;***
"RTN","ZVEMSF6",77,0)
DIS ;;;
"RTN","ZVEMSF6",78,0)
 ;;; D I S     Search File Entries
"RTN","ZVEMSF6",79,0)
 ;;;
"RTN","ZVEMSF6",80,0)
 ;;; 1. ENTRY POINT: EN^DIS
"RTN","ZVEMSF6",81,0)
 ;;;    Calls the Search File Entries option of VA Fileman. Needs DT and DUZ.
"RTN","ZVEMSF6",82,0)
 ;;;
"RTN","ZVEMSF6",83,0)
 ;;; 2. INPUT VARIABLES
"RTN","ZVEMSF6",84,0)
 ;;;    DIC.....Global root or file number.
"RTN","ZVEMSF6",85,0)
 ;;;***
"RTN","ZVEMSF7")
0^230^B16563158
"RTN","ZVEMSF7",1,0)
ZVEMSF7 ;DJB,VSHL**DIP,DIPT [07/16/94]
"RTN","ZVEMSF7",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMSF7",3,0)
 ;
"RTN","ZVEMSF7",4,0)
DIP ;;;
"RTN","ZVEMSF7",5,0)
 ;;; D I P     Print Data
"RTN","ZVEMSF7",6,0)
 ;;;
"RTN","ZVEMSF7",7,0)
 ;;; 1. ENTRY POINT: EN1^DIP
"RTN","ZVEMSF7",8,0)
 ;;;    Kills all input variables before it quits.
"RTN","ZVEMSF7",9,0)
 ;;;
"RTN","ZVEMSF7",10,0)
 ;;; 2. INPUT VARIABLES
"RTN","ZVEMSF7",11,0)
 ;;;    L........Set to zero or a string whose numeric evaluation is zero.
"RTN","ZVEMSF7",12,0)
 ;;;    DIC......The global root or file number.
"RTN","ZVEMSF7",13,0)
 ;;;    FLDS.....Fields to be printed, separated by commas.
"RTN","ZVEMSF7",14,0)
 ;;;             FLDS=".01,.03,1;C20"
"RTN","ZVEMSF7",15,0)
 ;;;             FLDS="[DEMO]"
"RTN","ZVEMSF7",16,0)
 ;;;    FLDS(1)..If there are more fields than can fit in string FLDS.
"RTN","ZVEMSF7",17,0)
 ;;;    BY.......Sort fields separated by commas. If BY is undefined, user is
"RTN","ZVEMSF7",18,0)
 ;;;             prompted for sort conditions.
"RTN","ZVEMSF7",19,0)
 ;;;             BY=".01;C1,.02"
"RTN","ZVEMSF7",20,0)
 ;;;             BY="DIAGNOSIS,@" @ will ask user for that SORT BY response.
"RTN","ZVEMSF7",21,0)
 ;;;             BY="[DEMOSORT]"
"RTN","ZVEMSF7",22,0)
 ;;;             If BY includes more than one field, the same comma-piece
"RTN","ZVEMSF7",23,0)
 ;;;             will identify the field in the FR and TO variables.
"RTN","ZVEMSF7",24,0)
 ;;;    FR.......The START WITH: values of the SORT BY fields. If FR is
"RTN","ZVEMSF7",25,0)
 ;;;             undefined, user will be asked START WITH: questions.
"RTN","ZVEMSF7",26,0)
 ;;;             Each comma-piece can be:
"RTN","ZVEMSF7",27,0)
 ;;;             The START WITH value.
"RTN","ZVEMSF7",28,0)
 ;;;             Null. Sort will start from beginning of file.
"RTN","ZVEMSF7",29,0)
 ;;;             ?. Causes START WITH: prompt.
"RTN","ZVEMSF7",30,0)
 ;;;             @. Sort will begin with null values (entries that have no data).
"RTN","ZVEMSF7",31,0)
 ;;;    TO.......The GO TO: values. Its characteristics are same as FR.
"RTN","ZVEMSF7",32,0)
 ;;;    DHD......The header desired for the output. Can be:
"RTN","ZVEMSF7",33,0)
 ;;;             @ if no header is desired.
"RTN","ZVEMSF7",34,0)
 ;;;             @@ if no header and no formfeed is desired.
"RTN","ZVEMSF7",35,0)
 ;;;             A literal.
"RTN","ZVEMSF7",36,0)
 ;;;             A line of M code which must begin with a write statement.
"RTN","ZVEMSF7",37,0)
 ;;;             Ex. DHD="W ?0 D ^ZZHDR"
"RTN","ZVEMSF7",38,0)
 ;;;             A print template enclosed in brackets.
"RTN","ZVEMSF7",39,0)
 ;;;             Two print templates separated by a minus sign. The first will
"RTN","ZVEMSF7",40,0)
 ;;;             be the header and the second the trailer. ("[DEMO]-[DEMO1]")
"RTN","ZVEMSF7",41,0)
 ;;;   DIASKHD...If set to null user will be prompted to enter a header.
"RTN","ZVEMSF7",42,0)
 ;;;   PG........Starting page number.
"RTN","ZVEMSF7",43,0)
 ;;;   DHIT......M code which will be executed for every entry after all the
"RTN","ZVEMSF7",44,0)
 ;;;             fields specified in FLDS have been printed.
"RTN","ZVEMSF7",45,0)
 ;;;   DIOEND....M code executed after printout has finished.
"RTN","ZVEMSF7",46,0)
 ;;;   DIOBEG....M code executed before printout starts.
"RTN","ZVEMSF7",47,0)
 ;;;   DCOPIES...If %ZIS chooses an SDP. Gives multiple copies.
"RTN","ZVEMSF7",48,0)
 ;;;   IOP.......Set equal to a device name to preanswer the DEVICE prompt.
"RTN","ZVEMSF7",49,0)
 ;;;             Set IOP="Q;MY PRINTER" to establish queueing.
"RTN","ZVEMSF7",50,0)
 ;;;   DQTIME....If output is queued, this contains time to print (T@1500).
"RTN","ZVEMSF7",51,0)
 ;;;   DIS(0)....Screen out certain entries. Contains an IF statement. If TRUE
"RTN","ZVEMSF7",52,0)
 ;;;             the entry will print. D0 will equal internal entry number.
"RTN","ZVEMSF7",53,0)
 ;;;   DIS(n)....You can set other elements of the DIS array. If many elements,
"RTN","ZVEMSF7",54,0)
 ;;;             DIS(0) must be true and any one of the other elements must be
"RTN","ZVEMSF7",55,0)
 ;;;             true for the entry to print.
"RTN","ZVEMSF7",56,0)
 ;;;***
"RTN","ZVEMSF7",57,0)
DIPT ;;;
"RTN","ZVEMSF7",58,0)
 ;;; D I P T    Print and Sort Template Display
"RTN","ZVEMSF7",59,0)
 ;;;
"RTN","ZVEMSF7",60,0)
 ;;; 1. ENTRY POINT: ^DIPT
"RTN","ZVEMSF7",61,0)
 ;;;
"RTN","ZVEMSF7",62,0)
 ;;; 2. INPUT VARIABLES
"RTN","ZVEMSF7",63,0)
 ;;;    D0.....Internal number of PRINT TEMPLATE file.
"RTN","ZVEMSF7",64,0)
 ;;;
"RTN","ZVEMSF7",65,0)
 ;;; 1. ENTRY POINT: DIBT^DIPT
"RTN","ZVEMSF7",66,0)
 ;;;
"RTN","ZVEMSF7",67,0)
 ;;; 2. INPUT VARIABLES
"RTN","ZVEMSF7",68,0)
 ;;;    D0.....Internal number of SORT TEMPLATE file.
"RTN","ZVEMSF7",69,0)
 ;;;***
"RTN","ZVEMSF8")
0^231^B15138868
"RTN","ZVEMSF8",1,0)
ZVEMSF8 ;DJB,VSHL**DIQ,DIQ1 [04/17/94]
"RTN","ZVEMSF8",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMSF8",3,0)
 ;
"RTN","ZVEMSF8",4,0)
DIQ ;;;
"RTN","ZVEMSF8",5,0)
 ;;; D I Q     Data Display, Date Conversion
"RTN","ZVEMSF8",6,0)
 ;;;
"RTN","ZVEMSF8",7,0)
 ;;; 1. ENTRY POINT: EN^DIQ
"RTN","ZVEMSF8",8,0)
 ;;;
"RTN","ZVEMSF8",9,0)
 ;;; 2. INPUT VARIABLES
"RTN","ZVEMSF8",10,0)
 ;;;    DIC......The global root or file number.
"RTN","ZVEMSF8",11,0)
 ;;;    DA.......Internal entry number of file entry to be printed.
"RTN","ZVEMSF8",12,0)
 ;;;    DR.......Literal name of subscript or subscripts to be displayed.
"RTN","ZVEMSF8",13,0)
 ;;;             Use ":" for a range. All data fields within and decendent
"RTN","ZVEMSF8",14,0)
 ;;;             from the subscript(s) will be displayed. If DR is not defined,
"RTN","ZVEMSF8",15,0)
 ;;;             all fields are displayed.
"RTN","ZVEMSF8",16,0)
 ;;;     DIQ(0)..C=display computed flds, A=display audit records
"RTN","ZVEMSF8",17,0)
 ;;;
"RTN","ZVEMSF8",18,0)
 ;;; 1. ENTRY POINT: Y^DIQ
"RTN","ZVEMSF8",19,0)
 ;;;    Converts a data element from its internal form to its external form.
"RTN","ZVEMSF8",20,0)
 ;;;    When call is made, naked reference must be at ^DD(File#,Fld#,0).
"RTN","ZVEMSF8",21,0)
 ;;;
"RTN","ZVEMSF8",22,0)
 ;;; 2. INPUT VARIABLES
"RTN","ZVEMSF8",23,0)
 ;;;    Y.......Internal form of value being converted.
"RTN","ZVEMSF8",24,0)
 ;;;    C........2nd Piece of ^DD zero node. Following sets C and naked ref:
"RTN","ZVEMSF8",25,0)
 ;;;             S C=$P(^DD(file#,fld#,0),U,2) D Y^DIQ
"RTN","ZVEMSF8",26,0)
 ;;;
"RTN","ZVEMSF8",27,0)
 ;;; 3. OUTPUT VARIABLES
"RTN","ZVEMSF8",28,0)
 ;;;    Y........External form of value.
"RTN","ZVEMSF8",29,0)
 ;;;
"RTN","ZVEMSF8",30,0)
 ;;; 1. ENTRY POINT: D^DIQ
"RTN","ZVEMSF8",31,0)
 ;;;    Converts internal date to external form. Same as DD^%DT.
"RTN","ZVEMSF8",32,0)
 ;;;
"RTN","ZVEMSF8",33,0)
 ;;; 2. INPUT VARIABLES
"RTN","ZVEMSF8",34,0)
 ;;;    Y.......Internal date.
"RTN","ZVEMSF8",35,0)
 ;;;
"RTN","ZVEMSF8",36,0)
 ;;; 3. OUTPUT VARIABLES
"RTN","ZVEMSF8",37,0)
 ;;;    Y.......External form of date/time.
"RTN","ZVEMSF8",38,0)
 ;;;
"RTN","ZVEMSF8",39,0)
 ;;; 1. ENTRY POINT: DT^DIQ
"RTN","ZVEMSF8",40,0)
 ;;;    Converts date in Y exactly like D^DIQ. It also writes the date after
"RTN","ZVEMSF8",41,0)
 ;;;    it's been converted. Input and output variables same as D^DIQ.
"RTN","ZVEMSF8",42,0)
 ;;;***
"RTN","ZVEMSF8",43,0)
DIQ1 ;;;
"RTN","ZVEMSF8",44,0)
 ;;; D I Q 1     Data Retrieval
"RTN","ZVEMSF8",45,0)
 ;;;
"RTN","ZVEMSF8",46,0)
 ;;; 1. ENTRY POINT: EN^DIQ1
"RTN","ZVEMSF8",47,0)
 ;;;    KILL ^UTILITY("DIQ1",$J) before and after this call.
"RTN","ZVEMSF8",48,0)
 ;;;
"RTN","ZVEMSF8",49,0)
 ;;; 2. INPUT VARIABLES
"RTN","ZVEMSF8",50,0)
 ;;;    DIC.....Global root or file number.
"RTN","ZVEMSF8",51,0)
 ;;;    DR......Field numbers separated by semicolons. Use ":" for range.
"RTN","ZVEMSF8",52,0)
 ;;;            S DR=".01;1;10-15"
"RTN","ZVEMSF8",53,0)
 ;;;    DA......Internal number of entry.
"RTN","ZVEMSF8",54,0)
 ;;;    DIQ.....Local array name where field values will be placed. If undefined
"RTN","ZVEMSF8",55,0)
 ;;;            values will be put in ^UTILITY("DIQ1",$J,. Array name should
"RTN","ZVEMSF8",56,0)
 ;;;            not begin with DI.
"RTN","ZVEMSF8",57,0)
 ;;;    DIQ(0)..Optional. I=Internal value,E=External value,N=Don't return null.
"RTN","ZVEMSF8",58,0)
 ;;;
"RTN","ZVEMSF8",59,0)
 ;;;    RETRIEVING FROM A SUBFILE
"RTN","ZVEMSF8",60,0)
 ;;;    DR(Subfile number) = List of fields in subfile.
"RTN","ZVEMSF8",61,0)
 ;;;    DA(Subfile number) = Entry in subfile.
"RTN","ZVEMSF8",62,0)
 ;;;    S DIC=16000,DR=".01;2",DA=77,DR(16000.02)=".01;1",DA(16000.02)=1 D EN^DIQ1
"RTN","ZVEMSF8",63,0)
 ;;;
"RTN","ZVEMSF8",64,0)
 ;;; 3. OUTPUT VARIABLES
"RTN","ZVEMSF8",65,0)
 ;;;    DIQ AND DIQ(0) UNDEFINED
"RTN","ZVEMSF8",66,0)
 ;;;       ^UTILITY("DIQ1",$J,file#,DA,fld#)=external value
"RTN","ZVEMSF8",67,0)
 ;;;    DIQ(0) DEFINED, DIQ UNDEFINED
"RTN","ZVEMSF8",68,0)
 ;;;       ^UTILITY("DIQ1",$J,file#,DA,fld#,"E")=external value
"RTN","ZVEMSF8",69,0)
 ;;;       ^UTILITY("DIQ1",$J,file#,DA,fld#,"I")=internal value
"RTN","ZVEMSF8",70,0)
 ;;;    DIQ DEFINED
"RTN","ZVEMSF8",71,0)
 ;;;       Output is similar but stored in specified local array.
"RTN","ZVEMSF8",72,0)
 ;;;    WORD PROCESSING FIELD
"RTN","ZVEMSF8",73,0)
 ;;;       DIQ not defined - ^UTILITY("DIQ1",$J,file#,DA,fld#,1)
"RTN","ZVEMSF8",74,0)
 ;;;                         ^UTILITY("DIQ1",$J,file#,DA,fld#,2)
"RTN","ZVEMSF8",75,0)
 ;;;       DIQ defined  - Similar but stored in local array.
"RTN","ZVEMSF8",76,0)
 ;;;***
"RTN","ZVEMSF9")
0^232^B18122882
"RTN","ZVEMSF9",1,0)
ZVEMSF9 ;DJB,VSHL**DIWF [07/16/94]
"RTN","ZVEMSF9",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMSF9",3,0)
 ;
"RTN","ZVEMSF9",4,0)
DIWF ;;;
"RTN","ZVEMSF9",5,0)
 ;;; D I W F     Form Document Print
"RTN","ZVEMSF9",6,0)
 ;;;
"RTN","ZVEMSF9",7,0)
 ;;; DIWF uses contents of a word processing field as a target document into which
"RTN","ZVEMSF9",8,0)
 ;;; data can be inserted at print time. The data may come from another file or be
"RTN","ZVEMSF9",9,0)
 ;;; provided by the user interactively when the document is printed. The word
"RTN","ZVEMSF9",10,0)
 ;;; processing text uses windows into which data from the target file gets
"RTN","ZVEMSF9",11,0)
 ;;; inserted by DIWF. Any nonmultiple field label or computed expression can be
"RTN","ZVEMSF9",12,0)
 ;;; used within a "|" window. If the expression can't be evaluated or the field
"RTN","ZVEMSF9",13,0)
 ;;; doesn't exist, and the output is being sent to a different terminal than
"RTN","ZVEMSF9",14,0)
 ;;; the one used to call up the output, then the user will be asked to type in
"RTN","ZVEMSF9",15,0)
 ;;; a value for the window, for each data entry printed.
"RTN","ZVEMSF9",16,0)
 ;;;
"RTN","ZVEMSF9",17,0)
 ;;; 1. ENTRY POINT: ^DIWF
"RTN","ZVEMSF9",18,0)
 ;;;    Invoking DIWF at the top results in an interactive dialogue:
"RTN","ZVEMSF9",19,0)
 ;;;         Select Document File: FORM LETTER
"RTN","ZVEMSF9",20,0)
 ;;;         Select DOCUMENT: APPOINTMENT REMINDER
"RTN","ZVEMSF9",21,0)
 ;;;         Print from what FILE: EMPLOYEE
"RTN","ZVEMSF9",22,0)
 ;;;         WANT EACH ENTRY ON A SEPARATE PAGE? YES//
"RTN","ZVEMSF9",23,0)
 ;;;         SORT BY: NAME// FOLLOWUP DATE=MAY 1, 1986
"RTN","ZVEMSF9",24,0)
 ;;;         DEVICE:
"RTN","ZVEMSF9",25,0)
 ;;;    In this example, the word processing text found in the APPOINTMENT
"RTN","ZVEMSF9",26,0)
 ;;;    REMINDER entry of the FORM LETTER file is used to print a sheet of output
"RTN","ZVEMSF9",27,0)
 ;;;    for each entry in the EMPLOYEE file whose FOLLOWUP DATE equals May 1,1986.
"RTN","ZVEMSF9",28,0)
 ;;;
"RTN","ZVEMSF9",29,0)
 ;;;    If the document file contains a pointer field pointing to file #1, and if
"RTN","ZVEMSF9",30,0)
 ;;;    the document entry selected has a value for that pointer, then the file
"RTN","ZVEMSF9",31,0)
 ;;;    pointed to will be used to print from and the user will not be asked
"RTN","ZVEMSF9",32,0)
 ;;;    "Print from what FILE:".
"RTN","ZVEMSF9",33,0)
 ;;;    NOTE: Read access is checked for both files selected.
"RTN","ZVEMSF9",34,0)
 ;;;
"RTN","ZVEMSF9",35,0)
 ;;; 1. ENTRY POINT: EN1^DIWF
"RTN","ZVEMSF9",36,0)
 ;;;    This entry point is used when calling program knows which file contains
"RTN","ZVEMSF9",37,0)
 ;;;    the desired word processing text to be used as a target document.
"RTN","ZVEMSF9",38,0)
 ;;;
"RTN","ZVEMSF9",39,0)
 ;;; 2. INPUT VARIABLES
"RTN","ZVEMSF9",40,0)
 ;;;    DIC......Global root or file number.
"RTN","ZVEMSF9",41,0)
 ;;;
"RTN","ZVEMSF9",42,0)
 ;;; 3. OUTPUT VARIABLES
"RTN","ZVEMSF9",43,0)
 ;;;    Y........-1 only if the DIC file doesn't contain a word processing field.
"RTN","ZVEMSF9",44,0)
 ;;;
"RTN","ZVEMSF9",45,0)
 ;;; 1. ENTRY POINT: EN2^DIWF
"RTN","ZVEMSF9",46,0)
 ;;;    This entry point is used when calling program knows both the document file
"RTN","ZVEMSF9",47,0)
 ;;;    and the entry within that file which contains the desired word processing
"RTN","ZVEMSF9",48,0)
 ;;;    text to be used as a target document.
"RTN","ZVEMSF9",49,0)
 ;;;
"RTN","ZVEMSF9",50,0)
 ;;; 2. INPUT VARIABLES
"RTN","ZVEMSF9",51,0)
 ;;;    DIWF......Global root at which text is stored. Thus, if APPOINTMENT
"RTN","ZVEMSF9",52,0)
 ;;;    REMINDER is the third document in the FORM LETTER file (^DIZ(16001,) and
"RTN","ZVEMSF9",53,0)
 ;;;    the word processing field is stored in subscript 1, you can:
"RTN","ZVEMSF9",54,0)
 ;;;         SET DIWF="^DIZ(16001,3,1,"
"RTN","ZVEMSF9",55,0)
 ;;;    DIWF(1)...If calling program wants to specifiy which file should be used
"RTN","ZVEMSF9",56,0)
 ;;;    as a source for generating output, the number of the file should be in
"RTN","ZVEMSF9",57,0)
 ;;;    DIWF(1). Otherwise, the user will be asked the "Print from what FILE:"
"RTN","ZVEMSF9",58,0)
 ;;;    question.
"RTN","ZVEMSF9",59,0)
 ;;;
"RTN","ZVEMSF9",60,0)
 ;;;    After this point, EN1^DIP is invoked. The calling program can set the
"RTN","ZVEMSF9",61,0)
 ;;;    usual BY, FR, and TO variables if it wants to control the SORT sequence.
"RTN","ZVEMSF9",62,0)
 ;;;
"RTN","ZVEMSF9",63,0)
 ;;; 3. OUTPUT VARIABLES
"RTN","ZVEMSF9",64,0)
 ;;;    Y........Will be -1 if:
"RTN","ZVEMSF9",65,0)
 ;;;                There is no data beneath the root passed in DIWF.
"RTN","ZVEMSF9",66,0)
 ;;;                The file passed in DIWF(1) could not be found.
"RTN","ZVEMSF9",67,0)
 ;;;***
"RTN","ZVEMSFA")
0^233^B15852291
"RTN","ZVEMSFA",1,0)
ZVEMSFA ;DJB,VSHL**DIU2,DIWE,DIWP,DIWW [04/17/94]
"RTN","ZVEMSFA",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMSFA",3,0)
 ;
"RTN","ZVEMSFA",4,0)
DIU2 ;;;
"RTN","ZVEMSFA",5,0)
 ;;; D I U 2     Data Dictionary Deletion
"RTN","ZVEMSFA",6,0)
 ;;;
"RTN","ZVEMSFA",7,0)
 ;;; 1. ENTRY POINT: EN^DIU2
"RTN","ZVEMSFA",8,0)
 ;;;
"RTN","ZVEMSFA",9,0)
 ;;; 2. INPUT VARIABLES
"RTN","ZVEMSFA",10,0)
 ;;;     DIU.....File number or global root. This must be a subfile number when
"RTN","ZVEMSFA",11,0)
 ;;;             deleting a subfile's data dictionary.
"RTN","ZVEMSFA",12,0)
 ;;;     DIU(0)..D=Delete data as well as data dictionary
"RTN","ZVEMSFA",13,0)
 ;;;             E=Echo back info during deletion
"RTN","ZVEMSFA",14,0)
 ;;;             S=Subfile data dictionary is to be deleted
"RTN","ZVEMSFA",15,0)
 ;;;             T=Templates are to be deleted
"RTN","ZVEMSFA",16,0)
 ;;;
"RTN","ZVEMSFA",17,0)
 ;;;     Example: S DIU="^DIZ(16000.1,",DIU(0)="" D EN^DIU2
"RTN","ZVEMSFA",18,0)
 ;;;              This will delete data dictionary. Data and templates remain.
"RTN","ZVEMSFA",19,0)
 ;;;              When deleting the dictionary for a subfile you must include
"RTN","ZVEMSFA",20,0)
 ;;;              the S in DIU(0).
"RTN","ZVEMSFA",21,0)
 ;;;
"RTN","ZVEMSFA",22,0)
 ;;;     NOTE: If your file is in ^DIC(file#, the data will ALWAYS be deleted.
"RTN","ZVEMSFA",23,0)
 ;;;***
"RTN","ZVEMSFA",24,0)
DIWE ;;;
"RTN","ZVEMSFA",25,0)
 ;;; D I W E     Edit Word Processing Text
"RTN","ZVEMSFA",26,0)
 ;;;
"RTN","ZVEMSFA",27,0)
 ;;; 1. ENTRY POINT: ^DIWE
"RTN","ZVEMSFA",28,0)
 ;;;
"RTN","ZVEMSFA",29,0)
 ;;; 2. INPUT VARIABLES
"RTN","ZVEMSFA",30,0)
 ;;;    DIC.....Global root.
"RTN","ZVEMSFA",31,0)
 ;;;    DWLW....Optional. Maximum number of characters stored on a word
"RTN","ZVEMSFA",32,0)
 ;;;            processing node.
"RTN","ZVEMSFA",33,0)
 ;;;    DWPK....Optional.
"RTN","ZVEMSFA",34,0)
 ;;;            1 = If user enters lines shorter than DWLW, they will not
"RTN","ZVEMSFA",35,0)
 ;;;                be joined. If lines are longer than DWLW, they will
"RTN","ZVEMSFA",36,0)
 ;;;                be broken at word boundaries.
"RTN","ZVEMSFA",37,0)
 ;;;            2 = Lines shorter will be joined til they get to DWLW.
"RTN","ZVEMSFA",38,0)
 ;;;                If lines are longer they will broken at word boundaries.
"RTN","ZVEMSFA",39,0)
 ;;;***
"RTN","ZVEMSFA",40,0)
DIWP ;;;
"RTN","ZVEMSFA",41,0)
 ;;; D I W P     Word Processing
"RTN","ZVEMSFA",42,0)
 ;;;
"RTN","ZVEMSFA",43,0)
 ;;; 1. ENTRY POINT: ^DIWP
"RTN","ZVEMSFA",44,0)
 ;;;    Before calling DIWP, kill global ^UTILITY($J,"W"). Then DIWP is invoked
"RTN","ZVEMSFA",45,0)
 ;;;    for each text line.
"RTN","ZVEMSFA",46,0)
 ;;;
"RTN","ZVEMSFA",47,0)
 ;;; 2. INPUT VARIABLES
"RTN","ZVEMSFA",48,0)
 ;;;    X.......The string of text to be added as input to the formatter. X may
"RTN","ZVEMSFA",49,0)
 ;;;            contain |-windows. The expressions within the windows will be
"RTN","ZVEMSFA",50,0)
 ;;;            processed as long as they DO NOT refer to database field names.
"RTN","ZVEMSFA",51,0)
 ;;;            Thus, |TODAY| will cause today's date to be inserted into the
"RTN","ZVEMSFA",52,0)
 ;;;            formatted text.
"RTN","ZVEMSFA",53,0)
 ;;;    DIWL....Left margin.
"RTN","ZVEMSFA",54,0)
 ;;;    DIWR....Right margin
"RTN","ZVEMSFA",55,0)
 ;;;    DIWF....A string of format control parameters:
"RTN","ZVEMSFA",56,0)
 ;;;            W = The formatted text will be written out to the current device,
"RTN","ZVEMSFA",57,0)
 ;;;                and will not be stored in ^UTILITY($J,"W").
"RTN","ZVEMSFA",58,0)
 ;;;            B = Followed by integer, n. The text will stop printing n lines
"RTN","ZVEMSFA",59,0)
 ;;;                from the bottom of the page.
"RTN","ZVEMSFA",60,0)
 ;;;            C = Followed by integer, n. Column width. Overrides DIWR.
"RTN","ZVEMSFA",61,0)
 ;;;            D = Double spaced.
"RTN","ZVEMSFA",62,0)
 ;;;            I = Followed by integer, n. Indent n col from left margin (DIWL).
"RTN","ZVEMSFA",63,0)
 ;;;            N = No-wrap. If DIWF contains N, DIWR will be ignored.
"RTN","ZVEMSFA",64,0)
 ;;;            R = Right justified.
"RTN","ZVEMSFA",65,0)
 ;;;***
"RTN","ZVEMSFA",66,0)
DIWW ;;;
"RTN","ZVEMSFA",67,0)
 ;;; D I W W     Output Last Line of Text
"RTN","ZVEMSFA",68,0)
 ;;;
"RTN","ZVEMSFA",69,0)
 ;;; 1. ENTRY POINT: ^DIWW
"RTN","ZVEMSFA",70,0)
 ;;;    DIWW must be invoked after the last X string is input to DIWP. It allows
"RTN","ZVEMSFA",71,0)
 ;;;    the final line of formatted text to be output.
"RTN","ZVEMSFA",72,0)
 ;;;***
"RTN","ZVEMSFB")
0^234^B14995914
"RTN","ZVEMSFB",1,0)
ZVEMSFB ;DJB,VSHL**%DT,COMMA [04/17/94]
"RTN","ZVEMSFB",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMSFB",3,0)
 ;
"RTN","ZVEMSFB",4,0)
%DT ;;;
"RTN","ZVEMSFB",5,0)
 ;;; % D T     Date and Time Input and Conversion
"RTN","ZVEMSFB",6,0)
 ;;;
"RTN","ZVEMSFB",7,0)
 ;;; 1. ENTRY POINT: ^%DT
"RTN","ZVEMSFB",8,0)
 ;;;    Returns date in VA Fileman format: YYYMMDD.HHMMSS
"RTN","ZVEMSFB",9,0)
 ;;;    Date is a canonic number - no trailing zeroes after the decimal.
"RTN","ZVEMSFB",10,0)
 ;;;
"RTN","ZVEMSFB",11,0)
 ;;; 2. INPUT VARIABLES
"RTN","ZVEMSFB",12,0)
 ;;;    %DT.......A = Ask for date input
"RTN","ZVEMSFB",13,0)
 ;;;              E = Echo the answer
"RTN","ZVEMSFB",14,0)
 ;;;              F = Future dates are assumed
"RTN","ZVEMSFB",15,0)
 ;;;              P = Pure numeric input not allowed
"RTN","ZVEMSFB",16,0)
 ;;;              R = Require time input
"RTN","ZVEMSFB",17,0)
 ;;;              S = Seconds should be returned
"RTN","ZVEMSFB",18,0)
 ;;;              T = Time input allowed but not required
"RTN","ZVEMSFB",19,0)
 ;;;              X = Exact date required (with month and day).
"RTN","ZVEMSFB",20,0)
 ;;;    X.........If %DT doesn't contain A, X must equal value to be processed.
"RTN","ZVEMSFB",21,0)
 ;;;    %DT("A")..Default prompt.
"RTN","ZVEMSFB",22,0)
 ;;;    %DT("B"...Default answer.
"RTN","ZVEMSFB",23,0)
 ;;;    %DT(0)....Optional. Prevents input date from being before or after a
"RTN","ZVEMSFB",24,0)
 ;;;              particular date:
"RTN","ZVEMSFB",25,0)
 ;;;              %DT(0)=2930101 Allows input only of dates GREATER THAN or
"RTN","ZVEMSFB",26,0)
 ;;;                             EQUAL TO that date.
"RTN","ZVEMSFB",27,0)
 ;;;              %DT(0)=-2930101 Allows input only of dates LESS THAN or EQUAL
"RTN","ZVEMSFB",28,0)
 ;;;                              TO that date.
"RTN","ZVEMSFB",29,0)
 ;;;              %DT(0)="NOW" Allows dates from current time forward.
"RTN","ZVEMSFB",30,0)
 ;;;              %DT(0)="-NOW" Allows dates up to the current time.
"RTN","ZVEMSFB",31,0)
 ;;;    DTIME.....Time out.
"RTN","ZVEMSFB",32,0)
 ;;;
"RTN","ZVEMSFB",33,0)
 ;;; 3. OUTPUT VARIABLES
"RTN","ZVEMSFB",34,0)
 ;;;    Y.........-1 (Date/time was invalid) -or- YYYMMDD.HHMMSS.
"RTN","ZVEMSFB",35,0)
 ;;;    X.........What was passed (%DT doesn't contain A) or what was entered.
"RTN","ZVEMSFB",36,0)
 ;;;    DTOUT.....%DT timed out.
"RTN","ZVEMSFB",37,0)
 ;;;
"RTN","ZVEMSFB",38,0)
 ;;; 1. ENTRY POINT: DD^%DT
"RTN","ZVEMSFB",39,0)
 ;;;    Converts internal date in Y to its external format.
"RTN","ZVEMSFB",40,0)
 ;;;
"RTN","ZVEMSFB",41,0)
 ;;; 2. INPUT VARIABLES
"RTN","ZVEMSFB",42,0)
 ;;;    Y.......Internal date.
"RTN","ZVEMSFB",43,0)
 ;;;    %DT.....Optional. If it contains S, forces seconds to be returned.
"RTN","ZVEMSFB",44,0)
 ;;;
"RTN","ZVEMSFB",45,0)
 ;;; 3. OUTPUT VARIABLES
"RTN","ZVEMSFB",46,0)
 ;;;    Y.......Date in external format.
"RTN","ZVEMSFB",47,0)
 ;;;
"RTN","ZVEMSFB",48,0)
 ;;; 1. ENTRY POINT: X ^DD("DD")
"RTN","ZVEMSFB",49,0)
 ;;;    Converts a date from internal to external format. Set Y=internal date
"RTN","ZVEMSFB",50,0)
 ;;;    and X ^DD("DD"). Y will equal external format.
"RTN","ZVEMSFB",51,0)
 ;;;***
"RTN","ZVEMSFB",52,0)
COMMA ;;;
"RTN","ZVEMSFB",53,0)
 ;;; % D T C     Number Formatting
"RTN","ZVEMSFB",54,0)
 ;;;
"RTN","ZVEMSFB",55,0)
 ;;; 1. ENTRY POINT: COMMA^%DTC
"RTN","ZVEMSFB",56,0)
 ;;;    Formats a number with commas.
"RTN","ZVEMSFB",57,0)
 ;;;
"RTN","ZVEMSFB",58,0)
 ;;; 2. INPUT VARIABLES
"RTN","ZVEMSFB",59,0)
 ;;;    X........Number to be formatted. May be positive or negative.
"RTN","ZVEMSFB",60,0)
 ;;;    X2.......Number of decimal digits. If X2 is undefined, 2 decimal digits
"RTN","ZVEMSFB",61,0)
 ;;;             are returned. If X2 is a number followed by a dollar sign
"RTN","ZVEMSFB",62,0)
 ;;;             (e.g. 3$), then a dollar sign will be prefixed to X.
"RTN","ZVEMSFB",63,0)
 ;;;    X3.......Length of the desired output. If X3 is less than the formatted X,
"RTN","ZVEMSFB",64,0)
 ;;;             X3 will be ignored. If X3 is not defined, then a length of 12
"RTN","ZVEMSFB",65,0)
 ;;;             is used.
"RTN","ZVEMSFB",66,0)
 ;;;
"RTN","ZVEMSFB",67,0)
 ;;; 3. OUTPUT VARIABLES
"RTN","ZVEMSFB",68,0)
 ;;;    X........The initial value of X formatted.
"RTN","ZVEMSFB",69,0)
 ;;;              Examples of COMMA^%DTC output:
"RTN","ZVEMSFB",70,0)
 ;;;                 S X=12345.678 D COMMA^%DTC       X="  12,345.68 "
"RTN","ZVEMSFB",71,0)
 ;;;                 S X=9876.54,X2="0$"              X="     $9,877 "
"RTN","ZVEMSFB",72,0)
 ;;;                 S X=-3,X2="2$"                   X="     ($3.00)"
"RTN","ZVEMSFB",73,0)
 ;;;                 S X=12345.678,X3=10              X="12,345.68 "
"RTN","ZVEMSFB",74,0)
 ;;;***
"RTN","ZVEMSFC")
0^235^B20158740
"RTN","ZVEMSFC",1,0)
ZVEMSFC ;DJB,VSHL**%DTC [04/17/94]
"RTN","ZVEMSFC",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMSFC",3,0)
 ;
"RTN","ZVEMSFC",4,0)
%DTC ;;;
"RTN","ZVEMSFC",5,0)
 ;;; % D T C     Date/Time Manipulation
"RTN","ZVEMSFC",6,0)
 ;;;
"RTN","ZVEMSFC",7,0)
 ;;; 1. ENTRY POINT: ^%DTC
"RTN","ZVEMSFC",8,0)
 ;;;    Return number of days between two dates.
"RTN","ZVEMSFC",9,0)
 ;;;
"RTN","ZVEMSFC",10,0)
 ;;; 2. INPUT VARIABLES
"RTN","ZVEMSFC",11,0)
 ;;;    X1.......1st date
"RTN","ZVEMSFC",12,0)
 ;;;    X2.......2nd date
"RTN","ZVEMSFC",13,0)
 ;;;
"RTN","ZVEMSFC",14,0)
 ;;; 3. OUTPUT VARIABLES
"RTN","ZVEMSFC",15,0)
 ;;;    X........Number of days between the 2 dates (X2-X1).
"RTN","ZVEMSFC",16,0)
 ;;;    %Y.......1 = Dates have both month and day values.
"RTN","ZVEMSFC",17,0)
 ;;;             0 = Dates were imprecise and not workable.
"RTN","ZVEMSFC",18,0)
 ;;;
"RTN","ZVEMSFC",19,0)
 ;;; 1. ENTRY POINT: C^%DTC
"RTN","ZVEMSFC",20,0)
 ;;;    Add or subtract a number of days to a date.
"RTN","ZVEMSFC",21,0)
 ;;;
"RTN","ZVEMSFC",22,0)
 ;;; 2. INPUT VARIABLES
"RTN","ZVEMSFC",23,0)
 ;;;    X1.......Date in VA Fileman format.
"RTN","ZVEMSFC",24,0)
 ;;;    X2.......If positive, number of days to add. If negative, number of
"RTN","ZVEMSFC",25,0)
 ;;;             days to subtract.
"RTN","ZVEMSFC",26,0)
 ;;;
"RTN","ZVEMSFC",27,0)
 ;;; 3. OUTPUT VARIABLES
"RTN","ZVEMSFC",28,0)
 ;;;    X........Resulting date.
"RTN","ZVEMSFC",29,0)
 ;;;    %H.......The $H form of the date.
"RTN","ZVEMSFC",30,0)
 ;;;
"RTN","ZVEMSFC",31,0)
 ;;; 1. ENTRY POINT: H^%DTC
"RTN","ZVEMSFC",32,0)
 ;;;    Converts a VA Fileman date/time to a $H format.
"RTN","ZVEMSFC",33,0)
 ;;;
"RTN","ZVEMSFC",34,0)
 ;;; 2. INPUT VARIABLES
"RTN","ZVEMSFC",35,0)
 ;;;    X.......Date in VA Fileman format.
"RTN","ZVEMSFC",36,0)
 ;;;
"RTN","ZVEMSFC",37,0)
 ;;; 3. OUTPUT VARIABLES
"RTN","ZVEMSFC",38,0)
 ;;;    %H.......The $H form of the date. If date is imprecise, then first of
"RTN","ZVEMSFC",39,0)
 ;;;             the month or year is returned.
"RTN","ZVEMSFC",40,0)
 ;;;    %T.......The time in $H format. If no time, %T equals zero.
"RTN","ZVEMSFC",41,0)
 ;;;    %Y.......Day-of-week as numberic from 0 to 6. 0=Sunday. If the date is
"RTN","ZVEMSFC",42,0)
 ;;;             imprecise, %Y equals -1.
"RTN","ZVEMSFC",43,0)
 ;;;
"RTN","ZVEMSFC",44,0)
 ;;; 1. ENTRY POINT: DW^%DTC
"RTN","ZVEMSFC",45,0)
 ;;;    This entry point produces results similar to H^%DTC. The difference is
"RTN","ZVEMSFC",46,0)
 ;;;    that X is reset to the name of the day. If the date is imprecise, X
"RTN","ZVEMSFC",47,0)
 ;;;    is returned equal to null.
"RTN","ZVEMSFC",48,0)
 ;;;
"RTN","ZVEMSFC",49,0)
 ;;; 1. ENTRY POINT: NOW^%DTC
"RTN","ZVEMSFC",50,0)
 ;;;    Returns the current date/time in VA Fileman and $H formats.
"RTN","ZVEMSFC",51,0)
 ;;;
"RTN","ZVEMSFC",52,0)
 ;;; 2. OUTPUT VARIABLES
"RTN","ZVEMSFC",53,0)
 ;;;    %..........VA Fileman date/time to the second.
"RTN","ZVEMSFC",54,0)
 ;;;    %H.........$H date/time.
"RTN","ZVEMSFC",55,0)
 ;;;    %I(1)......Numeric value of the month.
"RTN","ZVEMSFC",56,0)
 ;;;    %I(2)......Numeric value of the day.
"RTN","ZVEMSFC",57,0)
 ;;;    %I(3)......Numeric value of the year.
"RTN","ZVEMSFC",58,0)
 ;;;    X..........VA Fileman date only.
"RTN","ZVEMSFC",59,0)
 ;;;
"RTN","ZVEMSFC",60,0)
 ;;; 1. ENTRY POINT: YMD^%DTC
"RTN","ZVEMSFC",61,0)
 ;;;    Converts $H format date to VA Fileman format.
"RTN","ZVEMSFC",62,0)
 ;;;
"RTN","ZVEMSFC",63,0)
 ;;; 2. INPUT VARIABLES
"RTN","ZVEMSFC",64,0)
 ;;;    %H.........A $H format date/time.
"RTN","ZVEMSFC",65,0)
 ;;;
"RTN","ZVEMSFC",66,0)
 ;;; 3. OUTPUT VARIABLES
"RTN","ZVEMSFC",67,0)
 ;;;    %..........Time to the second, as a decimal. If %H doesn't have time,
"RTN","ZVEMSFC",68,0)
 ;;;               % equals zero.
"RTN","ZVEMSFC",69,0)
 ;;;    X..........Date in VA Fileman format.
"RTN","ZVEMSFC",70,0)
 ;;;
"RTN","ZVEMSFC",71,0)
 ;;; 1. ENTRY POINT: YX^%DTC
"RTN","ZVEMSFC",72,0)
 ;;;    Converts $H format date to VA Fileman format and to a printable date/time.
"RTN","ZVEMSFC",73,0)
 ;;;
"RTN","ZVEMSFC",74,0)
 ;;; 2. INPUT VARIABLES
"RTN","ZVEMSFC",75,0)
 ;;;    %H.........A $H format date/time.
"RTN","ZVEMSFC",76,0)
 ;;;
"RTN","ZVEMSFC",77,0)
 ;;; 3. OUTPUT VARIABLES
"RTN","ZVEMSFC",78,0)
 ;;;    Y..........The date and time (if time's sent) in external format. Seconds
"RTN","ZVEMSFC",79,0)
 ;;;               will be included if the input contained seconds.
"RTN","ZVEMSFC",80,0)
 ;;;    %..........Time to the second, as a decimal. If %H doesn't have time,
"RTN","ZVEMSFC",81,0)
 ;;;               then % equals zero.
"RTN","ZVEMSFC",82,0)
 ;;;    X..........Date in VA Fileman format.
"RTN","ZVEMSFC",83,0)
 ;;;
"RTN","ZVEMSFC",84,0)
 ;;; 1. ENTRY POINT: S^%DTC
"RTN","ZVEMSFC",85,0)
 ;;;    Converts seconds from midnight to hours, min, and sec as decimal part
"RTN","ZVEMSFC",86,0)
 ;;;    of a VA Fileman date.
"RTN","ZVEMSFC",87,0)
 ;;;
"RTN","ZVEMSFC",88,0)
 ;;; 2. INPUT VARIABLES
"RTN","ZVEMSFC",89,0)
 ;;;    %..........Number of seconds from midnight, $P($H,",",2).
"RTN","ZVEMSFC",90,0)
 ;;;
"RTN","ZVEMSFC",91,0)
 ;;; 3. OUTPUT VARIABLES
"RTN","ZVEMSFC",92,0)
 ;;;    %..........Decimal part of a VA Fileman date.
"RTN","ZVEMSFC",93,0)
 ;;;
"RTN","ZVEMSFC",94,0)
 ;;; 1. ENTRY POINT: HELP^%DTC
"RTN","ZVEMSFC",95,0)
 ;;;    Displays help prompt based on %DT and %DT(0).
"RTN","ZVEMSFC",96,0)
 ;;;
"RTN","ZVEMSFC",97,0)
 ;;; 2. INPUT VARIABLES
"RTN","ZVEMSFC",98,0)
 ;;;    %DT........Same as %DT
"RTN","ZVEMSFC",99,0)
 ;;;    %DT(0).....Optional. Causes HELP to display upper or lower bound
"RTN","ZVEMSFC",100,0)
 ;;;               that is acceptable for this particular call.
"RTN","ZVEMSFC",101,0)
 ;;;***
"RTN","ZVEMSFD")
0^236^B18949552
"RTN","ZVEMSFD",1,0)
ZVEMSFD ;DJB,VSHL**%RCR,DIAXU,DDIOL [07/16/94]
"RTN","ZVEMSFD",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMSFD",3,0)
 ;
"RTN","ZVEMSFD",4,0)
%RCR ;;;
"RTN","ZVEMSFD",5,0)
 ;;; % R C R     Array Moving
"RTN","ZVEMSFD",6,0)
 ;;;
"RTN","ZVEMSFD",7,0)
 ;;; 1. ENTRY POINT: %XY^%RCR
"RTN","ZVEMSFD",8,0)
 ;;;
"RTN","ZVEMSFD",9,0)
 ;;; 2. INPUT VARIABLES
"RTN","ZVEMSFD",10,0)
 ;;;    %X.....The global or array root of an existing array.
"RTN","ZVEMSFD",11,0)
 ;;;    %Y.....The global or array root of the target array.
"RTN","ZVEMSFD",12,0)
 ;;;           Example: To move array X to ^TMP($J you would write:
"RTN","ZVEMSFD",13,0)
 ;;;                       S %X="X("
"RTN","ZVEMSFD",14,0)
 ;;;                       S %Y="^TMP($J,"
"RTN","ZVEMSFD",15,0)
 ;;;                       D %XY^%RCR
"RTN","ZVEMSFD",16,0)
 ;;;***
"RTN","ZVEMSFD",17,0)
DDIOL ;;;
"RTN","ZVEMSFD",18,0)
 ;;; D D I O L     Writer
"RTN","ZVEMSFD",19,0)
 ;;;
"RTN","ZVEMSFD",20,0)
 ;;;    Programmers will have to remove embedded WRITE statements from data
"RTN","ZVEMSFD",21,0)
 ;;;    dictionaries as alternate user interfaces are developed for FM. Direct
"RTN","ZVEMSFD",22,0)
 ;;;    writes might cause the text to display improperly in the new interface.
"RTN","ZVEMSFD",23,0)
 ;;;
"RTN","ZVEMSFD",24,0)
 ;;; 1. ENTRY POINT: EN^DDIOL
"RTN","ZVEMSFD",25,0)
 ;;;    This is designed to replace WRITE statements in data dictionaries, such
"RTN","ZVEMSFD",26,0)
 ;;;    as executable help. Each string literal passed is written on a new line.
"RTN","ZVEMSFD",27,0)
 ;;;    Strings passed should not be longer than 70 characters.
"RTN","ZVEMSFD",28,0)
 ;;;    
"RTN","ZVEMSFD",29,0)
 ;;; FORMATS:  a. DO EN^DDIOL(Value)
"RTN","ZVEMSFD",30,0)
 ;;;           b. DO EN^DDIOL(.Array)
"RTN","ZVEMSFD",31,0)
 ;;;           c. DO EN^DDIOL("","^Global Name")
"RTN","ZVEMSFD",32,0)
 ;;;
"RTN","ZVEMSFD",33,0)
 ;;;     Value = Any MUMPS expression passed by value, such as a string literal
"RTN","ZVEMSFD",34,0)
 ;;;             or a variable.
"RTN","ZVEMSFD",35,0)
 ;;;     Array = The name of a local array passed by reference.
"RTN","ZVEMSFD",36,0)
 ;;;                A(1) = String 1
"RTN","ZVEMSFD",37,0)
 ;;;                A(2) = String 2
"RTN","ZVEMSFD",38,0)
 ;;;     Global Name = Name of a global containing string literals.
"RTN","ZVEMSFD",39,0)
 ;;;                @GlobalName@(1,0) = String 1
"RTN","ZVEMSFD",40,0)
 ;;;                @GlobalName@(2,0) = String 2
"RTN","ZVEMSFD",41,0)
 ;;;***
"RTN","ZVEMSFD",42,0)
DIAXU ;;;
"RTN","ZVEMSFD",43,0)
 ;;; D I A X U     Extract Data
"RTN","ZVEMSFD",44,0)
 ;;;
"RTN","ZVEMSFD",45,0)
 ;;; 1. ENTRY POINT: EN^DIAXU
"RTN","ZVEMSFD",46,0)
 ;;;    Extracts data specified in template for a single entry, and moves
"RTN","ZVEMSFD",47,0)
 ;;;    that data to a destination file. Source entry may be deleted.
"RTN","ZVEMSFD",48,0)
 ;;;
"RTN","ZVEMSFD",49,0)
 ;;; 2. INPUT VARIABLES
"RTN","ZVEMSFD",50,0)
 ;;;    DIAXF......Global root or number of file containing source entry.
"RTN","ZVEMSFD",51,0)
 ;;;    DIAXT......Extract template (in brackets)  in source file that
"RTN","ZVEMSFD",52,0)
 ;;;               contains specifications of data to be extracted.
"RTN","ZVEMSFD",53,0)
 ;;;    DIAXFE.....Internal entry number of source entry.
"RTN","ZVEMSFD",54,0)
 ;;;    DIAXDEL....Optional. If defined, tells pgm to delete source entry.
"RTN","ZVEMSFD",55,0)
 ;;;
"RTN","ZVEMSFD",56,0)
 ;;; 3. OUTPUT VARIABLES
"RTN","ZVEMSFD",57,0)
 ;;;    DIAXDA......Internal entry number of entry created in destination file.
"RTN","ZVEMSFD",58,0)
 ;;;    DIAXNTC.....Internal entry number of validated extract template.
"RTN","ZVEMSFD",59,0)
 ;;;
"RTN","ZVEMSFD",60,0)
 ;;;    DIAXFE killed upon exit. DIAXF,DIAXT,DIAXDEL not killed.
"RTN","ZVEMSFD",61,0)
 ;;;
"RTN","ZVEMSFD",62,0)
 ;;;    DIAXNTC is flag used to determine if extract template has been validated.
"RTN","ZVEMSFD",63,0)
 ;;;    Validation is necessary to ensure mapping information is valid. If this
"RTN","ZVEMSFD",64,0)
 ;;;    entry point is used within a FOR loop to move several entries, kill this
"RTN","ZVEMSFD",65,0)
 ;;;    variable outside the loop since re-validation occurs for each call within
"RTN","ZVEMSFD",66,0)
 ;;;    the loop.
"RTN","ZVEMSFD",67,0)
 ;;;
"RTN","ZVEMSFD",68,0)
 ;;;    If an error occurred during extract process, the following array is
"RTN","ZVEMSFD",69,0)
 ;;;    returned instead:
"RTN","ZVEMSFD",70,0)
 ;;;    ^TMP("DIERR",$J,n,"TEXT",0) = ^^m^m
"RTN","ZVEMSFD",71,0)
 ;;;    ^TMP("DIERR",$J,n,"TEXT",1:m,0) = error msg
"RTN","ZVEMSFD",72,0)
 ;;;         n = error sequence number. DIERR can be used as a terminating
"RTN","ZVEMSFD",73,0)
 ;;;             value when looping through this array.
"RTN","ZVEMSFD",74,0)
 ;;;         m = Total number of nodes of msg text for error n.
"RTN","ZVEMSFD",75,0)
 ;;;
"RTN","ZVEMSFD",76,0)
 ;;;    DIAXDA is not defined. All input variables are left defined.
"RTN","ZVEMSFD",77,0)
 ;;;***
"RTN","ZVEMSG")
0^237^B8067461
"RTN","ZVEMSG",1,0)
ZVEMSG ;DJB,VSHL**Global Loader ; 8/29/02 9:15pm
"RTN","ZVEMSG",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMSG",3,0)
 ;
"RTN","ZVEMSG",4,0)
 Q
"RTN","ZVEMSG",5,0)
ALL ;Load entire ^%ZVEMS global
"RTN","ZVEMSG",6,0)
 NEW I,RTN,TAG,TXT
"RTN","ZVEMSG",7,0)
 D INIT
"RTN","ZVEMSG",8,0)
 S RTN="ZVEMSGC" D ENTRY,A,C,K,O,Q
"RTN","ZVEMSG",9,0)
 S RTN="ZVEMSGD" D R,S,SY,T
"RTN","ZVEMSG",10,0)
 ;
"RTN","ZVEMSG",11,0)
 ;Build System QWIKs
"RTN","ZVEMSG",12,0)
 D ^ZVEMSGS
"RTN","ZVEMSG",13,0)
 D ^ZVEMSGT
"RTN","ZVEMSG",14,0)
 D ^ZVEMSGU
"RTN","ZVEMSG",15,0)
 ;
"RTN","ZVEMSG",16,0)
 ;Load ZOSF nodes
"RTN","ZVEMSG",17,0)
 ;D ^ZVEMSGR
"RTN","ZVEMSG",18,0)
 ;
"RTN","ZVEMSG",19,0)
 ;Load Help and other text
"RTN","ZVEMSG",20,0)
 D TEXT^ZVEMSGH
"RTN","ZVEMSG",21,0)
 Q
"RTN","ZVEMSG",22,0)
 ;
"RTN","ZVEMSG",23,0)
ENTRY ;Load ^%ZVEMS Global entry point
"RTN","ZVEMSG",24,0)
 S ^%ZVEMS="NEW FLAGQ,VEE S FLAGQ=0 D ^%ZVEMSY Q:FLAGQ  KILL FLAGQ X ^%ZVEMS(""ZS"",1) NEW VEESHC,VEESHL S VEESHL=""RUN"" F  X ^%ZVEMS(""ZA"",1) I $G(VEESHC)=""^"" X:$D(^%ZVEMS(""ZK"",1)) ^(1) Q:VEESHC'=""NO EXIT"""
"RTN","ZVEMSG",25,0)
 Q
"RTN","ZVEMSG",26,0)
 ;
"RTN","ZVEMSG",27,0)
BUILD ;Build ^%ZVEMS global
"RTN","ZVEMSG",28,0)
 W "."
"RTN","ZVEMSG",29,0)
 X "F I=1:1 S TXT=$T("_TAG_"+I^"_RTN_") Q:TXT']""""  S TXT=$P(TXT,"" "",2,999) Q:TXT="";;;***""  S ^%ZVEMS("""_TAG_""",I)=TXT"
"RTN","ZVEMSG",30,0)
 Q
"RTN","ZVEMSG",31,0)
 ;
"RTN","ZVEMSG",32,0)
A ;
"RTN","ZVEMSG",33,0)
 KILL ^%ZVEMS("ZA")
"RTN","ZVEMSG",34,0)
 S ^%ZVEMS("ZA")="Main Section"
"RTN","ZVEMSG",35,0)
 S TAG="ZA" D BUILD
"RTN","ZVEMSG",36,0)
 Q
"RTN","ZVEMSG",37,0)
 ;
"RTN","ZVEMSG",38,0)
C ;
"RTN","ZVEMSG",39,0)
 KILL ^%ZVEMS("ZC")
"RTN","ZVEMSG",40,0)
 S ^%ZVEMS("ZC")="Check for global KILL"
"RTN","ZVEMSG",41,0)
 S TAG="ZC" D BUILD
"RTN","ZVEMSG",42,0)
 Q
"RTN","ZVEMSG",43,0)
 ;
"RTN","ZVEMSG",44,0)
K ;
"RTN","ZVEMSG",45,0)
 KILL ^%ZVEMS("ZK")
"RTN","ZVEMSG",46,0)
 S ^%ZVEMS("ZK")="Kill ^%ZVEMS(""%"") on exit, VA KERNEL interface"
"RTN","ZVEMSG",47,0)
 S TAG="ZK" D BUILD
"RTN","ZVEMSG",48,0)
 Q
"RTN","ZVEMSG",49,0)
 ;
"RTN","ZVEMSG",50,0)
O ;
"RTN","ZVEMSG",51,0)
 KILL ^%ZVEMS("ZO")
"RTN","ZVEMSG",52,0)
 S ^%ZVEMS("ZO")="Other"
"RTN","ZVEMSG",53,0)
 S TAG="ZO" D BUILD
"RTN","ZVEMSG",54,0)
 Q
"RTN","ZVEMSG",55,0)
 ;
"RTN","ZVEMSG",56,0)
Q ;
"RTN","ZVEMSG",57,0)
 KILL ^%ZVEMS("ZQ")
"RTN","ZVEMSG",58,0)
 S ^%ZVEMS("ZQ")="Process QWIKs. VEEWARN turns off glb kill warning."
"RTN","ZVEMSG",59,0)
 S TAG="ZQ" D BUILD
"RTN","ZVEMSG",60,0)
 Q
"RTN","ZVEMSG",61,0)
 ;
"RTN","ZVEMSG",62,0)
R ;
"RTN","ZVEMSG",63,0)
 KILL ^%ZVEMS("ZR")
"RTN","ZVEMSG",64,0)
 S ^%ZVEMS("ZR")="Single Character READ"
"RTN","ZVEMSG",65,0)
 S TAG="ZR" D BUILD
"RTN","ZVEMSG",66,0)
 Q
"RTN","ZVEMSG",67,0)
 ;
"RTN","ZVEMSG",68,0)
S ;
"RTN","ZVEMSG",69,0)
 KILL ^%ZVEMS("ZS")
"RTN","ZVEMSG",70,0)
 S ^%ZVEMS("ZS")="Save/Restore Variables"
"RTN","ZVEMSG",71,0)
 S TAG="ZS" D BUILD
"RTN","ZVEMSG",72,0)
 Q
"RTN","ZVEMSG",73,0)
 ;
"RTN","ZVEMSG",74,0)
SY ;Use to guarantee unique subscript - $J_$G(^%ZVEMS("SY"))
"RTN","ZVEMSG",75,0)
 ;Necessary because not all systems support $SY.
"RTN","ZVEMSG",76,0)
 S ^%ZVEMS("SY")=""
"RTN","ZVEMSG",77,0)
 ;Set error trap to test if vendor supports $SY
"RTN","ZVEMSG",78,0)
 D  ;
"RTN","ZVEMSG",79,0)
 . NEW X
"RTN","ZVEMSG",80,0)
 . S X="ERROR^ZVEMSG",@($$TRAP^%ZVEMKU1)
"RTN","ZVEMSG",81,0)
 . I $SY]"" S ^%ZVEMS("SY")="-"_$SY
"RTN","ZVEMSG",82,0)
 Q
"RTN","ZVEMSG",83,0)
 ;
"RTN","ZVEMSG",84,0)
T ;
"RTN","ZVEMSG",85,0)
 KILL ^%ZVEMS("ZT")
"RTN","ZVEMSG",86,0)
 S ^%ZVEMS("ZT")="Session timed out"
"RTN","ZVEMSG",87,0)
 S TAG="ZT" D BUILD
"RTN","ZVEMSG",88,0)
 Q
"RTN","ZVEMSG",89,0)
 ;
"RTN","ZVEMSG",90,0)
INIT ;
"RTN","ZVEMSG",91,0)
 S U="^"
"RTN","ZVEMSG",92,0)
 S ^%ZVEMS("%")="Scratch area"
"RTN","ZVEMSG",93,0)
 S ^%ZVEMS("CLH")="Command line history"
"RTN","ZVEMSG",94,0)
 S ^%ZVEMS("ID")="User IDs"
"RTN","ZVEMSG",95,0)
 S ^%ZVEMS("PARAM")="Shell parameters"
"RTN","ZVEMSG",96,0)
 Q
"RTN","ZVEMSG",97,0)
 ;
"RTN","ZVEMSG",98,0)
ERROR ;
"RTN","ZVEMSG",99,0)
 Q
"RTN","ZVEMSGC")
0^238^B15263283
"RTN","ZVEMSGC",1,0)
ZVEMSGC ;DJB,VSHL**VShell Global - ZA,ZC,ZO,ZQ ; 4/5/03 7:32am
"RTN","ZVEMSGC",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMSGC",3,0)
 ;
"RTN","ZVEMSGC",4,0)
ZA ;;;Main area for processing users input at >> prompt.
"RTN","ZVEMSGC",5,0)
 S @($$T^%ZVEMSY) X ^%ZVEMS("ZO",4),^%ZVEMS("ZO",2) F  Q:'$D(^%ZVEMS)  X ^%ZVEMS("ZA",6) I $G(VEESHC)]"" Q:VEESHC="^"  W ! X ^%ZVEMS("ZO",1),VEESHC D RESET^%ZVEMSY X ^%ZVEMS("ZS",2)
"RTN","ZVEMSGC",6,0)
 X ^%ZVEMS("ZK",4),^%ZVEMS("ZA",4) Q:"^"[VEESHC  X:VEESHC="<TO>" ^%ZVEMS("ZT",1) Q:"^"[VEESHC  X ^%ZVEMS("ZS",4),$S(VEESHC?1.2".":^%ZVEMS("ZQ",1),VEESHC?1.2"."1A.E:^%ZVEMS("ZQ",1),1:^%ZVEMS("ZA",3))
"RTN","ZVEMSGC",7,0)
 I VEESHC?1"<".E1">"!(VEESHC?1.2"."1N.E) D ^%ZVEMSQ S VEESHC=$S(VEESHC?1"**".E:$E(VEESHC,3,999),1:"") I VEESHC]"" X ^%ZVEMS("ZA",2) ;CLH
"RTN","ZVEMSGC",8,0)
 S:VEESHC?.E1P1"VEESHL".1P.E VEESHC="" S:$E(VEESHC)="?"!(VEESHC="<ESCH>") VEESHC="D ^%ZVEMSH" I ",^,H,h,HALT,halt,"[(","_VEESHC_",") S VEESHC="^"
"RTN","ZVEMSGC",9,0)
 X ^%ZVEMS("ZS",3),^%ZVEMS("ZA",7),^%ZVEMS("ZO",2) KILL VEEWARN S VEESHL="RUN" D USEZERO^%ZVEMSU ;Reset variables
"RTN","ZVEMSGC",10,0)
 X ^%ZVEMS("ZA",5),^%ZVEMS("ZR",1) Q:"^"[VEESHC  X ^%ZVEMS("ZA",2) Q:"^"[VEESHC  X ^%ZVEMS("ZC",1) KILL VEEWARN
"RTN","ZVEMSGC",11,0)
 I $G(VEE("OS"))=8 X "ZM 0" ;Disable MSM trace function
"RTN","ZVEMSGC",12,0)
 ;;;***
"RTN","ZVEMSGC",13,0)
ZC ;;;Check for Global KILL
"RTN","ZVEMSGC",14,0)
 Q:$G(VEEWARN)="QWIK"  NEW HLD X ^%ZVEMS("ZQ",2) I HLD["K",HLD["^" NEW FLAGG S FLAGG="GLB" D KILLCHK^%ZVEMKU(HLD)
"RTN","ZVEMSGC",15,0)
 ;;;***
"RTN","ZVEMSGC",16,0)
ZK ;;;Exit Shell-KILL ^%ZVEMS("%"). VA KERNEL interface.
"RTN","ZVEMSGC",17,0)
 X:'$D(VEE("ID"))!('$D(VEE("OS"))) ^%ZVEMS("ZS",3) X ^%ZVEMS("ZK",3) Q:$G(VEESHC)="NO EXIT"  X ^%ZVEMS("ZK",2),^%ZVEMS("ZK",5),^%ZVEMS("ZK",6),^%ZVEMS("ZK",7),^%ZVEMS("ZK",9)
"RTN","ZVEMSGC",18,0)
 Q:'$D(^%ZVEMS("%",$J_$G(^%ZVEMS("SY")),"XUTL"))  KILL ^XUTL("XQ",$J) NEW %X,%Y S %X="^%ZVEMS(""%"","""_$J_$G(^%ZVEMS("SY"))_""",""XUTL"",",%Y="^XUTL(""XQ"",$J," D %XY^%RCR
"RTN","ZVEMSGC",19,0)
 NEW U1,U2 X ^%ZVEMS("ZK",8) I U1]"",U2]"",U1'=U2 S VEESHC="NO EXIT" W $C(7),!!?2,"VA KERNEL menu option active.",!?2,"Move to UCI '",U2,"' to HALT.",!
"RTN","ZVEMSGC",20,0)
 I $D(^XUSEC(0)),",D ^ZU,DO ^ZU,d ^zu,do ^zu,d ^ZU,do ^ZU,"[(","_VEESHC_",") S VEESHC="" W $C(7),!!?2,"HALT out of VSHELL before calling ^ZU.",!
"RTN","ZVEMSGC",21,0)
 I VEE("OS")=9,$D(^%ZVEMS("%",$J_$G(^%ZVEMS("SY")),"DTM")) X "U $I:(IXXLATE=$P(^(""DTM""),""^"",1))"
"RTN","ZVEMSGC",22,0)
 I $D(^%ZVEMS("%",$J_$G(^%ZVEMS("SY")),"KRNUCI")) D NOBRK^%ZVEMKY2
"RTN","ZVEMSGC",23,0)
 I $D(^%ZVEMS("%",$J_$G(^%ZVEMS("SY")),"SYMTAB")) D RESSYM^%ZVEMSU ;Restore sym table
"RTN","ZVEMSGC",24,0)
 S U1=$G(^%ZVEMS("CLH","UCI",VEE("ID")_$G(^%ZVEMS("SY")))),U2=$G(^%ZVEMS("%",$J_$G(^%ZVEMS("SY")),"KRNUCI"))
"RTN","ZVEMSGC",25,0)
 KILL ^%ZVEMS("%",$J_$G(^%ZVEMS("SY")))
"RTN","ZVEMSGC",26,0)
 ;;;***
"RTN","ZVEMSGC",27,0)
ZO ;;;Other
"RTN","ZVEMSGC",28,0)
 NEW X S:$G(VEE("$ZR"))]"" @("X=$"_$S(VEE("$ZR")["(":"O",1:"D")_"("_VEE("$ZR")_")") I $G(VEE("$T")) ;Reset $ZR and $T
"RTN","ZVEMSGC",29,0)
 Q:'$D(VEE("ID"))  Q:'$D(^%ZOSF("UCI"))  NEW Y X ^("UCI") Q:$G(^%ZVEMS("CLH","UCI",VEE("ID")_$G(^%ZVEMS("SY"))))=Y  X ^%ZVEMS("ZO",3)
"RTN","ZVEMSGC",30,0)
 S ^%ZVEMS("CLH","UCI",VEE("ID")_$G(^%ZVEMS("SY")))=Y KILL ^%ZVEMS("CLH",VEE("ID"),"VSHL") ;Kill VShell's CLH if user switches UCIs.
"RTN","ZVEMSGC",31,0)
 S:$D(%1) X=%1 KILL:'$D(%1) X KILL %1 ;Reset X after ^%ZOSF("TRAP")
"RTN","ZVEMSGC",32,0)
 ;;;***
"RTN","ZVEMSGC",33,0)
ZQ ;;;Process QWIK Commands. VEEWARN turns off Global Kill Warning.
"RTN","ZVEMSGC",34,0)
 NEW HLD S VEEWARN="QWIK" X ^%ZVEMS("ZQ",2) D QWIK^%ZVEMSQS(HLD)
"RTN","ZVEMSGC",35,0)
 S HLD=$TR(VEESHC,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","ZVEMSGC",36,0)
 ;;;***
"RTN","ZVEMSGD")
0^239^B7738660
"RTN","ZVEMSGD",1,0)
ZVEMSGD ;DJB,VSHL**VShell Global - ZR,ZS,ZT ; 9/6/02 7:56am
"RTN","ZVEMSGD",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMSGD",3,0)
 ;
"RTN","ZVEMSGD",4,0)
ZR ;;;Load ^%ZVEMS("ZR")
"RTN","ZVEMSGD",5,0)
 NEW CD,FLAGCLH,PROMPT,Y S:'$D(VEE("IOM")) VEE("IOM")=80 X ^%ZVEMS("ZR",2) S CD="",FLAGCLH=">>" D SCREEN^%ZVEMKEA(PROMPT,0,VEE("IOM")-2) X ^%ZVEMS("ZR",4),^%ZVEMS("ZR",3)
"RTN","ZVEMSGD",6,0)
 X:$D(^%ZOSF("UCI"))&($D(^%ZVEMS("PARAM",VEE("ID"),"PROMPT"))) ^%ZOSF("UCI")  S PROMPT=$G(Y)_">>" X ^%ZVEMS("ZR",5)
"RTN","ZVEMSGD",7,0)
 S VEESHC=$S(VEESHC="<RET>":CD,VEESHC?1"<".E1">".E&(CD']""):VEESHC,1:"")
"RTN","ZVEMSGD",8,0)
 I VEESHC="TOO LONG" W ! D CLHSET^%ZVEMSCL("VSHL",CD) S VEESHC=""
"RTN","ZVEMSGD",9,0)
 KILL ^%ZVEMS("ERROR",VEE("ID"))
"RTN","ZVEMSGD",10,0)
 ;;;***
"RTN","ZVEMSGD",11,0)
ZS ;;;Load ^%ZVEMS("ZS")
"RTN","ZVEMSGD",12,0)
 NEW % S ^%ZVEMS("%",$J_$G(^%ZVEMS("SY")))=+$H_"^Scratch Area" X ^%ZVEMS("ZS",7)
"RTN","ZVEMSGD",13,0)
 Q:$G(^%ZVEMS("%",$J_$G(^%ZVEMS("SY")),"SV"))=""  X ^%ZVEMS("ZS",8)
"RTN","ZVEMSGD",14,0)
 X ^%ZVEMS("ZS",2) D BS^%ZVEMKY1 NEW I F I=1:1:9 KILL @("%"_I) ;kill parameter variables
"RTN","ZVEMSGD",15,0)
 Q:VEESHC?1"<".E1">"!(",^,H,h,HALT,halt,"[(","_VEESHC_","))  NEW CHK,X S CHK=0,X=$G(^%ZVEMS("CLH",VEE("ID"),"VSHL")) X ^%ZVEMS("ZS",6) Q:CHK  X ^%ZVEMS("ZS",5)
"RTN","ZVEMSGD",16,0)
 S X=$G(^%ZVEMS("CLH",VEE("ID"),"VSHL"))+1,^("VSHL")=X,^("VSHL",X)=VEESHC I X>20 S X=$O(^%ZVEMS("CLH",VEE("ID"),"VSHL","")) KILL ^(X)
"RTN","ZVEMSGD",17,0)
 I X>0,$G(^%ZVEMS("CLH",VEE("ID"),"VSHL",X))=VEESHC!($G(^(X-1))=VEESHC) S CHK=1
"RTN","ZVEMSGD",18,0)
 NEW %,LIST,VAR X ^%ZVEMS("ZS",9) S ^%ZVEMS("%",$J_$G(^%ZVEMS("SY")),"SV")="" F %=1:1:$L(LIST,"^") S VAR=$P(LIST,"^",%) S ^("SV")=^("SV")_$S($D(@VAR)#2:@VAR,1:"")_"^"
"RTN","ZVEMSGD",19,0)
 NEW %,LIST X ^%ZVEMS("ZS",9) F %=1:1:$L(LIST,"^") S @($P(LIST,"^",%)_"=$P(^%ZVEMS(""%"",$J_$G(^%ZVEMS(""SY"")),""SV""),""^"",%)")
"RTN","ZVEMSGD",20,0)
 S LIST="VEE(""ID"")^VEE(""EON"")^VEE(""EOFF"")^VEE(""IOF"")^VEE(""IOSL"")^VEE(""OS"")^VEE(""IO"")^VEE(""IOM"")^VEE(""TRMON"")^VEE(""TRMOFF"")^VEE(""TRMRD"")^VEE(""$ZE"")"
"RTN","ZVEMSGD",21,0)
 ;;;***
"RTN","ZVEMSGD",22,0)
ZT ;;;Shell timed out
"RTN","ZVEMSGD",23,0)
 S VEESHC=$G(^%ZVEMS("QU",VEE("ID"),"TO")) Q:VEESHC=""  S:VEESHC="HALT"!(VEESHC="halt") VEESHC="^"
"RTN","ZVEMSGD",24,0)
 ;;;***
"RTN","ZVEMSGH")
0^240^B6307007
"RTN","ZVEMSGH",1,0)
ZVEMSGH ;DJB,VSHL**VShell Global - Help Text ; 8/29/02 9:21pm
"RTN","ZVEMSGH",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMSGH",3,0)
 ;
"RTN","ZVEMSGH",4,0)
 Q
"RTN","ZVEMSGH",5,0)
TEXT ;Load HELP and other text
"RTN","ZVEMSGH",6,0)
 NEW CNT,LN,RTN,TAG,TXT
"RTN","ZVEMSGH",7,0)
 KILL ^%ZVEMS("ZZ") S ^%ZVEMS("ZZ")="Help Text"
"RTN","ZVEMSGH",8,0)
 S RTN="ZVEMSH1",TAG="INTRO" D TEXT1
"RTN","ZVEMSGH",9,0)
 S RTN="ZVEMSH2",TAG="KEYS" D TEXT1
"RTN","ZVEMSGH",10,0)
 S RTN="ZVEMSH3" F TAG="QWIK","USER" D TEXT1
"RTN","ZVEMSGH",11,0)
 S RTN="ZVEMSH4",TAG="SYSTEM" D TEXT1
"RTN","ZVEMSGH",12,0)
 S RTN="ZVEMSH5" F TAG="BOXES","VENDOR" D TEXT1
"RTN","ZVEMSGH",13,0)
 S RTN="ZVEMSH6" F TAG="CLH","PGM" D TEXT1
"RTN","ZVEMSGH",14,0)
 S RTN="ZVEMSH7" F TAG="PARAM","PROT" D TEXT1
"RTN","ZVEMSGH",15,0)
 S RTN="ZVEMSH8",TAG="MISC" D TEXT1
"RTN","ZVEMSGH",16,0)
 S RTN="ZVEMSH9",TAG="KERN" D TEXT1
"RTN","ZVEMSGH",17,0)
 S RTN="ZVEMSF1" F TAG="DDS","DIAC","DIB","DIM","DIO2" D TEXT1
"RTN","ZVEMSGH",18,0)
 S RTN="ZVEMSF2",TAG="DIC" D TEXT1
"RTN","ZVEMSGH",19,0)
 S RTN="ZVEMSF3" F TAG="DIC1","DICN" D TEXT1
"RTN","ZVEMSGH",20,0)
 S RTN="ZVEMSF4" F TAG="DICQ","DICRW","DID","DIEZ","DIFG","DICD","DIKZ" D TEXT1
"RTN","ZVEMSGH",21,0)
 S RTN="ZVEMSF5",TAG="DIE" D TEXT1
"RTN","ZVEMSGH",22,0)
 S RTN="ZVEMSF6" F TAG="DIK","DIPZ","DIR","DIS" D TEXT1
"RTN","ZVEMSGH",23,0)
 S RTN="ZVEMSF7" F TAG="DIP","DIPT" D TEXT1
"RTN","ZVEMSGH",24,0)
 S RTN="ZVEMSF8" F TAG="DIQ","DIQ1" D TEXT1
"RTN","ZVEMSGH",25,0)
 S RTN="ZVEMSF9",TAG="DIWF" D TEXT1
"RTN","ZVEMSGH",26,0)
 S RTN="ZVEMSFA" F TAG="DIU2","DIWE","DIWP","DIWW" D TEXT1
"RTN","ZVEMSGH",27,0)
 S RTN="ZVEMSFB" F TAG="%DT","COMMA" D TEXT1
"RTN","ZVEMSGH",28,0)
 S RTN="ZVEMSFC",TAG="%DTC" D TEXT1
"RTN","ZVEMSGH",29,0)
 S RTN="ZVEMSFD" F TAG="%RCR","DDIOL","DIAXU" D TEXT1
"RTN","ZVEMSGH",30,0)
 S RTN="ZVEMSLA",TAG="DATE" D TEXT1
"RTN","ZVEMSGH",31,0)
 S RTN="ZVEMSLB",TAG="STRING" D TEXT1
"RTN","ZVEMSGH",32,0)
 S RTN="ZVEMSLC",TAG="MATH" D TEXT1
"RTN","ZVEMSGH",33,0)
 S RTN="ZVEMSLD",TAG="MEAS" D TEXT1
"RTN","ZVEMSGH",34,0)
 S RTN="ZVEMSN",TAG="NOTES" D TEXT1
"RTN","ZVEMSGH",35,0)
 S CNT=1
"RTN","ZVEMSGH",36,0)
 S RTN="ZVEMDH1",TAG="VEDD1" D TEXT2
"RTN","ZVEMSGH",37,0)
 S RTN="ZVEMDH2",TAG="VEDD1" D TEXT2
"RTN","ZVEMSGH",38,0)
 S RTN="ZVEMDH3",TAG="VEDD1" D TEXT2
"RTN","ZVEMSGH",39,0)
 S RTN="ZVEMDH4",TAG="VEDD2" D TEXT2
"RTN","ZVEMSGH",40,0)
 S RTN="ZVEMDH5",TAG="VEDD2" D TEXT2
"RTN","ZVEMSGH",41,0)
 S RTN="ZVEMGH",TAG="VGL1" D TEXT1
"RTN","ZVEMSGH",42,0)
 S CNT=1
"RTN","ZVEMSGH",43,0)
 S RTN="ZVEMGH1",TAG="VGL2" D TEXT2
"RTN","ZVEMSGH",44,0)
 S RTN="ZVEMGH2",TAG="VGL2" D TEXT2
"RTN","ZVEMSGH",45,0)
 S CNT=1
"RTN","ZVEMSGH",46,0)
 S RTN="ZVEMRH",TAG="VRR1" D TEXT2
"RTN","ZVEMSGH",47,0)
 S RTN="ZVEMRH1",TAG="VRR1" D TEXT2
"RTN","ZVEMSGH",48,0)
 S RTN="ZVEMRHK",TAG="VRR2" D TEXT2
"RTN","ZVEMSGH",49,0)
 S RTN="ZVEMRHL",TAG="LIBRARY" D TEXT2
"RTN","ZVEMSGH",50,0)
 S RTN="ZVEMRHW",TAG="WEB" D TEXT2
"RTN","ZVEMSGH",51,0)
 Q
"RTN","ZVEMSGH",52,0)
TEXT1 ;Move text to ^%ZVEMS("ZZ")
"RTN","ZVEMSGH",53,0)
 S CNT=1 W "."
"RTN","ZVEMSGH",54,0)
 ;
"RTN","ZVEMSGH",55,0)
TEXT2 ;
"RTN","ZVEMSGH",56,0)
 X "F LN=1:1 S TXT=$T("_TAG_"+LN^"_RTN_") Q:TXT']""""  S TXT=$P(TXT,"";;;"",2,999) Q:TXT=""***""  S ^%ZVEMS(""ZZ"",TAG,CNT)=TXT,CNT=CNT+1"
"RTN","ZVEMSGH",57,0)
 Q
"RTN","ZVEMSGR")
0^241^B1507659
"RTN","ZVEMSGR",1,0)
ZVEMSGR ;DJB,VSHL**VShell Global - ZOSF Nodes ; 12/15/00 11:49pm
"RTN","ZVEMSGR",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMSGR",3,0)
 ;
"RTN","ZVEMSGR",4,0)
ZOSF ;Load system specific code into ZOSF nodes
"RTN","ZVEMSGR",5,0)
 NEW I,ND,TXT,VEND
"RTN","ZVEMSGR",6,0)
 KILL ^%ZVEMS("ZOSF")
"RTN","ZVEMSGR",7,0)
 S ^%ZVEMS("ZOSF")="System specific code"
"RTN","ZVEMSGR",8,0)
 F I=1:1 S TXT=$T(SYS+I) Q:$P(TXT,";",3)="***"  D  ;
"RTN","ZVEMSGR",9,0)
 . S ND=$P(TXT,";",3)
"RTN","ZVEMSGR",10,0)
 . S VEND=$P(TXT,";",4)
"RTN","ZVEMSGR",11,0)
 . S ^%ZVEMS("ZOSF",VEND,ND)=$P(TXT,";",5,999) ;Vendor specific code
"RTN","ZVEMSGR",12,0)
 Q
"RTN","ZVEMSGR",13,0)
SYS ;System specific code
"RTN","ZVEMSGR",14,0)
 ;;EON;8;U $I:(:::::1)
"RTN","ZVEMSGR",15,0)
 ;;EOFF;8;U $I:(::::1)
"RTN","ZVEMSGR",16,0)
 ;;TRMON;8;U $I:(::::::::$C(0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,127))
"RTN","ZVEMSGR",17,0)
 ;;TRMOFF;8;U $I:(::::::::$C(13,27))
"RTN","ZVEMSGR",18,0)
 ;;TRMRD;8;S Y=$ZB
"RTN","ZVEMSGR",19,0)
 ;;EON;18;U $I:("":"-S")
"RTN","ZVEMSGR",20,0)
 ;;EOFF;18;U $I:("":"+S")
"RTN","ZVEMSGR",21,0)
 ;;TRMON;18;U $I:("":"+I+T")
"RTN","ZVEMSGR",22,0)
 ;;TRMOFF;18;U $I:("":"-I-T":$C(13,27))
"RTN","ZVEMSGR",23,0)
 ;;TRMRD;18;S Y=$A($ZB),Y=$S(Y<32:Y,Y=127:Y,1:0)
"RTN","ZVEMSGR",24,0)
 ;;***
"RTN","ZVEMSGS")
0^242^B19123992
"RTN","ZVEMSGS",1,0)
ZVEMSGS ;DJB,VSHL**VShell Global - System QWIKs ; 12/15/00 10:44pm
"RTN","ZVEMSGS",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMSGS",3,0)
 ;
"RTN","ZVEMSGS",4,0)
SYSTEM ;Load the System QWIKs
"RTN","ZVEMSGS",5,0)
 NEW I,QWIK,TYPE,TXT,VEN
"RTN","ZVEMSGS",6,0)
 KILL ^%ZVEMS("QS")
"RTN","ZVEMSGS",7,0)
 S ^%ZVEMS("QS")="System QWIK COMMANDs"
"RTN","ZVEMSGS",8,0)
 S ^%ZVEMS("QU")="User QWIK COMMANDs"
"RTN","ZVEMSGS",9,0)
 F I=1:1 S TXT=$T(QWIK+I) Q:$P(TXT,";",3)="***"  S QWIK=$P(TXT,";",3),TYPE=$P(TXT,";",4) D
"RTN","ZVEMSGS",10,0)
 . I TYPE="D" S ^%ZVEMS("QS",QWIK,"DSC")=$P(TXT,";",5,999)
"RTN","ZVEMSGS",11,0)
 . I TYPE="C" S ^%ZVEMS("QS",QWIK)=$P(TXT,";",5,999) ;Code
"RTN","ZVEMSGS",12,0)
 . I TYPE?1.N S ^%ZVEMS("QS",QWIK,TYPE)=$P(TXT,";",5,999) ;Vendor specific code
"RTN","ZVEMSGS",13,0)
 Q
"RTN","ZVEMSGS",14,0)
 ;
"RTN","ZVEMSGS",15,0)
QWIK ;System QWIK Commands
"RTN","ZVEMSGS",16,0)
 ;;ASCII;D;ASCII Table^^3
"RTN","ZVEMSGS",17,0)
 ;;ASCII;C;D ASCII^%ZVEMST
"RTN","ZVEMSGS",18,0)
 ;;CAL;D;Calendar Display^%1=Number of Starting Month^3
"RTN","ZVEMSGS",19,0)
 ;;CAL;C;D CALENDAR^%ZVEMST
"RTN","ZVEMSGS",20,0)
 ;;CLH;D;Resequence Command Line History^^2
"RTN","ZVEMSGS",21,0)
 ;;CLH;C;D CLH^%ZVEMSY1
"RTN","ZVEMSGS",22,0)
 ;;DIC;D;Fileman DIC Look-up Template^^4
"RTN","ZVEMSGS",23,0)
 ;;DIC;C;D DICCALL^%ZVEMSU1
"RTN","ZVEMSGS",24,0)
 ;;DTMVT;D;Reset VT-100 in DataTree^^2
"RTN","ZVEMSGS",25,0)
 ;;DTMVT;C;Q:VEE("OS")'=9  Q:VEE("IO")'=1  U 1:VT=1
"RTN","ZVEMSGS",26,0)
 ;;E;D;Routine Editor^%1=Rtn Name^3
"RTN","ZVEMSGS",27,0)
 ;;E;C;X ^%ZVEMS("E")
"RTN","ZVEMSGS",28,0)
 ;;FMC;D;Fileman Calls^^4
"RTN","ZVEMSGS",29,0)
 ;;FMC;C;D ^%ZVEMSF
"RTN","ZVEMSGS",30,0)
 ;;FMTI;D;Fileman Input Template Display^^4
"RTN","ZVEMSGS",31,0)
 ;;FMTI;C;D DIET^%ZVEMSU1
"RTN","ZVEMSGS",32,0)
 ;;FMTP;D;Fileman Print Template Display^^4
"RTN","ZVEMSGS",33,0)
 ;;FMTP;C;D DIPT^%ZVEMSU1
"RTN","ZVEMSGS",34,0)
 ;;FMTS;D;Fileman Sort Template Display^^4
"RTN","ZVEMSGS",35,0)
 ;;FMTS;C;D DIBT^%ZVEMSU1
"RTN","ZVEMSGS",36,0)
 ;;KEY;D;Display Escape Sequence for any Key^^3
"RTN","ZVEMSGS",37,0)
 ;;KEY;C;D KEY^%ZVEMSU1
"RTN","ZVEMSGS",38,0)
 ;;LBRY;D;Routine Library^%1=ON/OFF %2=Module (L/V)^3
"RTN","ZVEMSGS",39,0)
 ;;LBRY;C;D ^%ZVEMRLM
"RTN","ZVEMSGS",40,0)
 ;;LF;D;VA KERNEL Library Functions^^4
"RTN","ZVEMSGS",41,0)
 ;;LF;C;D ^%ZVEMSL
"RTN","ZVEMSGS",42,0)
 ;;NOTES;D;VPE Programmer Notes^^3
"RTN","ZVEMSGS",43,0)
 ;;NOTES;C;D HELP^%ZVEMKT("NOTES")
"RTN","ZVEMSGS",44,0)
 ;;PARAM;D;System Parameters^^2
"RTN","ZVEMSGS",45,0)
 ;;PARAM;C;D ^%ZVEMSP
"RTN","ZVEMSGS",46,0)
 ;;PUR;D;Purge VShell Temp Storage Area - %ZVEMS("%")^%1=Number of days to preserve^2
"RTN","ZVEMSGS",47,0)
 ;;PUR;C;D PURGE^%ZVEMSU
"RTN","ZVEMSGS",48,0)
 ;;PURVGL;D;Purge Command Line History (VGL)^^2
"RTN","ZVEMSGS",49,0)
 ;;PURVGL;C;KILL ^%ZVEMS("CLH",VEE("ID"),"VGL")
"RTN","ZVEMSGS",50,0)
 ;;PURVRR;D;Purge Command Line History (VRR)^^2
"RTN","ZVEMSGS",51,0)
 ;;PURVRR;C;KILL ^%ZVEMS("CLH",VEE("ID"),"VRR")
"RTN","ZVEMSGS",52,0)
 ;;PURVEDD;D;Purge Command Line History (VEDD)^^2
"RTN","ZVEMSGS",53,0)
 ;;PURVEDD;C;KILL ^%ZVEMS("CLH",VEE("ID"),"VEDD")
"RTN","ZVEMSGS",54,0)
 ;;PURVSHL;D;Purge Command Line History (VShell)^^2
"RTN","ZVEMSGS",55,0)
 ;;PURVSHL;C;KILL ^%ZVEMS("CLH",VEE("ID"),"VSHL")
"RTN","ZVEMSGS",56,0)
 ;;QB;D;Assign QWIK to Display Box^^1
"RTN","ZVEMSGS",57,0)
 ;;QB;C;D BOX^%ZVEMSQU
"RTN","ZVEMSGS",58,0)
 ;;QC;D;Copy a QWIK^^1
"RTN","ZVEMSGS",59,0)
 ;;QC;C;D COPY^%ZVEMSQU
"RTN","ZVEMSGS",60,0)
 ;;QD;D;Delete a QWIK^^1
"RTN","ZVEMSGS",61,0)
 ;;QD;C;D DELETE^%ZVEMSQU
"RTN","ZVEMSGS",62,0)
 ;;QE;D;Add/Edit a QWIK^^1
"RTN","ZVEMSGS",63,0)
 ;;QE;C;S VEESHC="<TAB>" D ^%ZVEMSQ
"RTN","ZVEMSGS",64,0)
 ;;QL1;D;List User QWIKs & Description^^1
"RTN","ZVEMSGS",65,0)
 ;;QL1;C;S VEESHC="<F1-1>" D ^%ZVEMSQ
"RTN","ZVEMSGS",66,0)
 ;;QL2;D;List User QWIKs & Code^^1
"RTN","ZVEMSGS",67,0)
 ;;QL2;C;S VEESHC="<F1-2>" D ^%ZVEMSQ
"RTN","ZVEMSGS",68,0)
 ;;QL3;D;List System QWIKs & Description^^1
"RTN","ZVEMSGS",69,0)
 ;;QL3;C;S VEESHC="<F1-3>" D ^%ZVEMSQ
"RTN","ZVEMSGS",70,0)
 ;;QL4;D;List System QWIKs & Code^^1
"RTN","ZVEMSGS",71,0)
 ;;QL4;C;S VEESHC="<F1-4>" D ^%ZVEMSQ
"RTN","ZVEMSGS",72,0)
 ;;QSAVE;D;Save/Restore User QWIKs^^1
"RTN","ZVEMSGS",73,0)
 ;;QSAVE;C;D SAVE^%ZVEMSS
"RTN","ZVEMSGS",74,0)
 ;;QV;D;Add Vendor Specific Code^^1
"RTN","ZVEMSGS",75,0)
 ;;QV;C;D VENDOR^%ZVEMSQV
"RTN","ZVEMSGS",76,0)
 ;;QVL;D;List Vendor Specific Code^^1
"RTN","ZVEMSGS",77,0)
 ;;QVL;C;D VENLIST^%ZVEMSQW
"RTN","ZVEMSGS",78,0)
 ;;UL;D;List Users DUZ/ID^^2
"RTN","ZVEMSGS",79,0)
 ;;UL;C;D LIST^%ZVEMSID
"RTN","ZVEMSGS",80,0)
 ;;VEDD;D;VElectronic Data Dictionary^^3
"RTN","ZVEMSGS",81,0)
 ;;VEDD;C;D PARAM^%ZVEMD(%1,%2,%3)
"RTN","ZVEMSGS",82,0)
 ;;VER;D;VShell Version Information^^2
"RTN","ZVEMSGS",83,0)
 ;;VER;C;D VERSION^%ZVEMSU2
"RTN","ZVEMSGS",84,0)
 ;;VGL;D;VGlobal Lister^^3
"RTN","ZVEMSGS",85,0)
 ;;VGL;C;D PARAM^%ZVEMG(%1)
"RTN","ZVEMSGS",86,0)
 ;;VRR;D;VRoutine Reader^^3
"RTN","ZVEMSGS",87,0)
 ;;VRR;C;D PARAM^%ZVEMR(%1)
"RTN","ZVEMSGS",88,0)
 ;;XQH;D;Help Text for Kernel Menu Options^%1=Kernel Menu Option^4
"RTN","ZVEMSGS",89,0)
 ;;XQH;C;D XQH^%ZVEMST
"RTN","ZVEMSGS",90,0)
 ;;ZD;D;KILL variables whose names start with these letters^%1=letters %2=letters ...^3
"RTN","ZVEMSGS",91,0)
 ;;ZD;C;D ^%ZVEMSD
"RTN","ZVEMSGS",92,0)
 ;;ZP;D;ZPrint a Routine^%1=Rtn Name^3
"RTN","ZVEMSGS",93,0)
 ;;ZP;C;D ZPRINT^%ZVEMSU2
"RTN","ZVEMSGS",94,0)
 ;;ZR;D;ZRemove 1 to 9 Routines^%1=Rtn Name  %2=Rtn Name ...^3
"RTN","ZVEMSGS",95,0)
 ;;ZR;C;Q:'$$ZREMOVE^%ZVEMSU2()  NEW I,X F I=1:1:9 S X=@("%"_I) Q:X']""  ZR  ZS @X W !?2,X," Removed..."
"RTN","ZVEMSGS",96,0)
 ;;ZW;D;ZWrite Symbol Table^%1=Starting letter^3
"RTN","ZVEMSGS",97,0)
 ;;ZW;C;D WRITE^%ZVEMSPS(%1)
"RTN","ZVEMSGS",98,0)
 ;;***
"RTN","ZVEMSGT")
0^243^B10059374
"RTN","ZVEMSGT",1,0)
ZVEMSGT ;DJB,VSHL**VShell Global - System QWIKs cont.. ; 9/6/02 8:47am
"RTN","ZVEMSGT",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMSGT",3,0)
 ;
"RTN","ZVEMSGT",4,0)
SYSTEM ;Load the System QWIKs
"RTN","ZVEMSGT",5,0)
 NEW I,QWIK,TYPE,TXT,VEN
"RTN","ZVEMSGT",6,0)
 F I=1:1 S TXT=$T(QWIK+I) Q:$P(TXT,";",3)="***"  S QWIK=$P(TXT,";",3),TYPE=$P(TXT,";",4) D
"RTN","ZVEMSGT",7,0)
 . I TYPE="D" S ^%ZVEMS("QS",QWIK,"DSC")=$P(TXT,";",5,999)
"RTN","ZVEMSGT",8,0)
 . I TYPE="C" S ^%ZVEMS("QS",QWIK)=$P(TXT,";",5,999) ;Code
"RTN","ZVEMSGT",9,0)
 . I TYPE?1.N S ^%ZVEMS("QS",QWIK,TYPE)=$P(TXT,";",5,999) ;Vendor specific code
"RTN","ZVEMSGT",10,0)
 Q
"RTN","ZVEMSGT",11,0)
QWIK ;System QWIK Commands
"RTN","ZVEMSGT",12,0)
 ;;DOS;D;DOS Interface^^5
"RTN","ZVEMSGT",13,0)
 ;;DOS;C;W $C(7),!?2,"Not available for this M Vendor.",!
"RTN","ZVEMSGT",14,0)
 ;;DOS;8;D ^%OS
"RTN","ZVEMSGT",15,0)
 ;;DOS;9;d ^%dos
"RTN","ZVEMSGT",16,0)
 ;;G;D;Global List^^5
"RTN","ZVEMSGT",17,0)
 ;;G;C;W $C(7),!?2,"Not available for this M Vendor.",!
"RTN","ZVEMSGT",18,0)
 ;;G;2;D ^%G
"RTN","ZVEMSGT",19,0)
 ;;G;8;D ^%GL
"RTN","ZVEMSGT",20,0)
 ;;G;9;d ^%g
"RTN","ZVEMSGT",21,0)
 ;;G;16;D ^%G
"RTN","ZVEMSGT",22,0)
 ;;G;17;D ^%G
"RTN","ZVEMSGT",23,0)
 ;;G;18;D ^%G
"RTN","ZVEMSGT",24,0)
 ;;G;19;D ^%G
"RTN","ZVEMSGT",25,0)
 ;;GCOPY;D;Global Copy^^5
"RTN","ZVEMSGT",26,0)
 ;;GCOPY;C;W $C(7),!?2,"Not available for this M Vendor.",!
"RTN","ZVEMSGT",27,0)
 ;;GCOPY;2;D ^%GC
"RTN","ZVEMSGT",28,0)
 ;;GCOPY;8;D ^%GCOPY
"RTN","ZVEMSGT",29,0)
 ;;GCOPY;9;d ^%gcopy
"RTN","ZVEMSGT",30,0)
 ;;GCOPY;16;D ^%GC
"RTN","ZVEMSGT",31,0)
 ;;GCOPY;17;D ^%GC
"RTN","ZVEMSGT",32,0)
 ;;GCOPY;19;D ^%GC
"RTN","ZVEMSGT",33,0)
 ;;GD;D;Global Directory^^5
"RTN","ZVEMSGT",34,0)
 ;;GD;C;W $C(7),!?2,"Not available for this M Vendor.",!
"RTN","ZVEMSGT",35,0)
 ;;GD;2;D ^%GD
"RTN","ZVEMSGT",36,0)
 ;;GD;8;D ^%GD
"RTN","ZVEMSGT",37,0)
 ;;GD;9;d ^%gd
"RTN","ZVEMSGT",38,0)
 ;;GD;16;D ^%GD
"RTN","ZVEMSGT",39,0)
 ;;GD;17;D ^%GD
"RTN","ZVEMSGT",40,0)
 ;;GD;18;D ^%GD
"RTN","ZVEMSGT",41,0)
 ;;GD;19;D ^%GD
"RTN","ZVEMSGT",42,0)
 ;;GDE;D;Extended Global Directory^^5
"RTN","ZVEMSGT",43,0)
 ;;GDE;C;W $C(7),!?2,"Not available for this M Vendor.",!
"RTN","ZVEMSGT",44,0)
 ;;GDE;8;D ^%GDE
"RTN","ZVEMSGT",45,0)
 ;;GDE;16;D ^%EGD
"RTN","ZVEMSGT",46,0)
 ;;GEDIT;D;Global Edit^^5
"RTN","ZVEMSGT",47,0)
 ;;GEDIT;C;W $C(7),!?2,"Not available for this M Vendor.",!
"RTN","ZVEMSGT",48,0)
 ;;GEDIT;2;D ^%GEDIT
"RTN","ZVEMSGT",49,0)
 ;;GEDIT;8;D ^%GEDIT
"RTN","ZVEMSGT",50,0)
 ;;GEDIT;9;d ^%gedit
"RTN","ZVEMSGT",51,0)
 ;;GEDIT;16;D ^%GEDIT
"RTN","ZVEMSGT",52,0)
 ;;GEDIT;17;D ^%GED
"RTN","ZVEMSGT",53,0)
 ;;GEDIT;18;D ^%GED
"RTN","ZVEMSGT",54,0)
 ;;GEDIT;19;D ^%GED
"RTN","ZVEMSGT",55,0)
 ;;GLB;D;Global Screen Capture^%1=Global Reference  %2=How many lines before pause^5
"RTN","ZVEMSGT",56,0)
 ;;GLB;C;D GLB^%ZVEMKT(%1,"SC",%2)
"RTN","ZVEMSGT",57,0)
 ;;GR;D;Global Restore^^5
"RTN","ZVEMSGT",58,0)
 ;;GR;C;W $C(7),!?2,"Not available for this M Vendor.",!
"RTN","ZVEMSGT",59,0)
 ;;GR;2;D ^%GTI
"RTN","ZVEMSGT",60,0)
 ;;GR;8;D ^%GR
"RTN","ZVEMSGT",61,0)
 ;;GR;9;d ^%gload
"RTN","ZVEMSGT",62,0)
 ;;GR;16;D ^%GTI
"RTN","ZVEMSGT",63,0)
 ;;GR;17;D ^%GI
"RTN","ZVEMSGT",64,0)
 ;;GR;18;D ^%GI
"RTN","ZVEMSGT",65,0)
 ;;GR;19;D ^%GI
"RTN","ZVEMSGT",66,0)
 ;;GS;D;Global Save^^5
"RTN","ZVEMSGT",67,0)
 ;;GS;C;W $C(7),!?2,"Not available for this M Vendor.",!
"RTN","ZVEMSGT",68,0)
 ;;GS;2;D ^%GTO
"RTN","ZVEMSGT",69,0)
 ;;GS;8;D ^%GS
"RTN","ZVEMSGT",70,0)
 ;;GS;9;d ^%gsave
"RTN","ZVEMSGT",71,0)
 ;;GS;16;D ^%GTO
"RTN","ZVEMSGT",72,0)
 ;;GS;17;D ^%GO
"RTN","ZVEMSGT",73,0)
 ;;GS;19;D ^%GO
"RTN","ZVEMSGT",74,0)
 ;;GSE;D;Global Search^^5
"RTN","ZVEMSGT",75,0)
 ;;GSE;C;W $C(7),!?2,"Not available for this M Vendor.",!
"RTN","ZVEMSGT",76,0)
 ;;GSE;8;D ^%GSE
"RTN","ZVEMSGT",77,0)
 ;;GSE;9;d ^%gedit
"RTN","ZVEMSGT",78,0)
 ;;GSE;17;D ^%GSE
"RTN","ZVEMSGT",79,0)
 ;;GSE;19;D ^%GSE
"RTN","ZVEMSGT",80,0)
 ;;GSEL;D;Global Select^^5
"RTN","ZVEMSGT",81,0)
 ;;GSEL;C;W $C(7),!?2,"Not available for this M Vendor.",!
"RTN","ZVEMSGT",82,0)
 ;;GSEL;2;D ^%GSEL
"RTN","ZVEMSGT",83,0)
 ;;GSEL;8;D ^%GSEL
"RTN","ZVEMSGT",84,0)
 ;;GSEL;9;w $$^%gselect," globals selected"
"RTN","ZVEMSGT",85,0)
 ;;GSEL;16;D ^%GSEL
"RTN","ZVEMSGT",86,0)
 ;;GSEL;17;D ^%GSEL
"RTN","ZVEMSGT",87,0)
 ;;GSEL;18;D ^%GSET
"RTN","ZVEMSGT",88,0)
 ;;GSEL;19;D ^%GSEL
"RTN","ZVEMSGT",89,0)
 ;;***
"RTN","ZVEMSGU")
0^244^B15550473
"RTN","ZVEMSGU",1,0)
ZVEMSGU ;DJB,VSHL**VShell Global - System QWIKs cont.. ; 9/6/02 8:58am
"RTN","ZVEMSGU",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMSGU",3,0)
 ;
"RTN","ZVEMSGU",4,0)
SYSTEM ;Load the System QWIKs
"RTN","ZVEMSGU",5,0)
 NEW I,QWIK,TYPE,TXT,VEN
"RTN","ZVEMSGU",6,0)
 F I=1:1 S TXT=$T(QWIK+I) Q:$P(TXT,";",3)="***"  S QWIK=$P(TXT,";",3),TYPE=$P(TXT,";",4) D
"RTN","ZVEMSGU",7,0)
 . I TYPE="D" S ^%ZVEMS("QS",QWIK,"DSC")=$P(TXT,";",5,999)
"RTN","ZVEMSGU",8,0)
 . I TYPE="C" S ^%ZVEMS("QS",QWIK)=$P(TXT,";",5,999) ;Code
"RTN","ZVEMSGU",9,0)
 . I TYPE?1.N S ^%ZVEMS("QS",QWIK,TYPE)=$P(TXT,";",5,999) ;Vendor specific code
"RTN","ZVEMSGU",10,0)
 Q
"RTN","ZVEMSGU",11,0)
QWIK ;System QWIK Commands
"RTN","ZVEMSGU",12,0)
 ;;LOCKTAB;D;Lock Table^^5
"RTN","ZVEMSGU",13,0)
 ;;LOCKTAB;C;W $C(7),!?2,"Not available for this M Vendor.",!
"RTN","ZVEMSGU",14,0)
 ;;LOCKTAB;2;D ^LOCKTAB
"RTN","ZVEMSGU",15,0)
 ;;LOCKTAB;8;D ^LOCKTAB
"RTN","ZVEMSGU",16,0)
 ;;LOCKTAB;9;d ^%lockexam
"RTN","ZVEMSGU",17,0)
 ;;LOCKTAB;16;D ^LOCKTAB
"RTN","ZVEMSGU",18,0)
 ;;RCHANGE;D;Routine Change^^5
"RTN","ZVEMSGU",19,0)
 ;;RCHANGE;C;W $C(7),!?2,"Not available for this M Vendor.",!
"RTN","ZVEMSGU",20,0)
 ;;RCHANGE;2;D ^%RCE
"RTN","ZVEMSGU",21,0)
 ;;RCHANGE;8;D ^%RCHANGE
"RTN","ZVEMSGU",22,0)
 ;;RCHANGE;9;d ^%rchange
"RTN","ZVEMSGU",23,0)
 ;;RCHANGE;16;D ^%RCE
"RTN","ZVEMSGU",24,0)
 ;;RCHANGE;17;D ^%RCE
"RTN","ZVEMSGU",25,0)
 ;;RCHANGE;18;D ^%RCHANGE
"RTN","ZVEMSGU",26,0)
 ;;RCHANGE;19;D ^%RCE
"RTN","ZVEMSGU",27,0)
 ;;RCMP;D;Routine Compare^^5
"RTN","ZVEMSGU",28,0)
 ;;RCMP;C;W $C(7),!?2,"Not available for this M Vendor.",!
"RTN","ZVEMSGU",29,0)
 ;;RCMP;2;D ^%RCMP
"RTN","ZVEMSGU",30,0)
 ;;RCMP;8;D ^%RCMP
"RTN","ZVEMSGU",31,0)
 ;;RCMP;9;d ^%rcompare
"RTN","ZVEMSGU",32,0)
 ;;RCMP;16;D ^%RCMP
"RTN","ZVEMSGU",33,0)
 ;;RCMP;18;D ^%RCMP
"RTN","ZVEMSGU",34,0)
 ;;RCOPY;D;Routine Copy to Another UCI^^5
"RTN","ZVEMSGU",35,0)
 ;;RCOPY;C;W $C(7),!?2,"Not available for this M Vendor.",!
"RTN","ZVEMSGU",36,0)
 ;;RCOPY;8;D ^%RCOPY
"RTN","ZVEMSGU",37,0)
 ;;RCOPY;9;D ^%rcopy
"RTN","ZVEMSGU",38,0)
 ;;RCOPY;16;D ^%RCOPY
"RTN","ZVEMSGU",39,0)
 ;;RCOPY;18;D ^%RCOPY
"RTN","ZVEMSGU",40,0)
 ;;RD;D;Routine Directory^^5
"RTN","ZVEMSGU",41,0)
 ;;RD;C;W $C(7),!?2,"Not available for this M Vendor.",!
"RTN","ZVEMSGU",42,0)
 ;;RD;2;D ^%RD
"RTN","ZVEMSGU",43,0)
 ;;RD;8;D ^%RD
"RTN","ZVEMSGU",44,0)
 ;;RD;9;d ^%rd
"RTN","ZVEMSGU",45,0)
 ;;RD;16;D ^%RD
"RTN","ZVEMSGU",46,0)
 ;;RD;17;D ^%RD
"RTN","ZVEMSGU",47,0)
 ;;RD;18;D ^%RD
"RTN","ZVEMSGU",48,0)
 ;;RD;19;D ^%RD
"RTN","ZVEMSGU",49,0)
 ;;RDEL;D;Routine Delete^^5
"RTN","ZVEMSGU",50,0)
 ;;RDEL;C;W $C(7),!?2,"Not available for this M Vendor.",!
"RTN","ZVEMSGU",51,0)
 ;;RDEL;2;D ^%ZRDELET
"RTN","ZVEMSGU",52,0)
 ;;RDEL;8;D ^%RDEL
"RTN","ZVEMSGU",53,0)
 ;;RDEL;9;d ^%rdelete
"RTN","ZVEMSGU",54,0)
 ;;RDEL;16;D ^%RPURGE
"RTN","ZVEMSGU",55,0)
 ;;RDEL;17;D ^%ZTRDEL
"RTN","ZVEMSGU",56,0)
 ;;RDEL;18;D ^%RDELETE
"RTN","ZVEMSGU",57,0)
 ;;RDEL;19;D ^%ZTRDEL
"RTN","ZVEMSGU",58,0)
 ;;RL;D;Routine Lister^^5
"RTN","ZVEMSGU",59,0)
 ;;RL;C;D ^%ZVEMSRL
"RTN","ZVEMSGU",60,0)
 ;;RR;D;Routine Restore^^5
"RTN","ZVEMSGU",61,0)
 ;;RR;C;W $C(7),!?2,"Not available for this M Vendor.",!
"RTN","ZVEMSGU",62,0)
 ;;RR;2;D ^%RR
"RTN","ZVEMSGU",63,0)
 ;;RR;8;D ^%RR
"RTN","ZVEMSGU",64,0)
 ;;RR;9;d ^%rload
"RTN","ZVEMSGU",65,0)
 ;;RR;16;D ^%RR
"RTN","ZVEMSGU",66,0)
 ;;RR;17;D ^%RI
"RTN","ZVEMSGU",67,0)
 ;;RR;18;D ^%RI
"RTN","ZVEMSGU",68,0)
 ;;RR;19;D ^%RI
"RTN","ZVEMSGU",69,0)
 ;;RS;D;Routine Save^^5
"RTN","ZVEMSGU",70,0)
 ;;RS;C;W $C(7),!?2,"Not available for this M Vendor.",!
"RTN","ZVEMSGU",71,0)
 ;;RS;2;D ^%RS
"RTN","ZVEMSGU",72,0)
 ;;RS;8;D ^%RS
"RTN","ZVEMSGU",73,0)
 ;;RS;9;d ^%rsave
"RTN","ZVEMSGU",74,0)
 ;;RS;16;D ^%RS
"RTN","ZVEMSGU",75,0)
 ;;RS;17;D ^%RO
"RTN","ZVEMSGU",76,0)
 ;;RS;18;D ^%RO
"RTN","ZVEMSGU",77,0)
 ;;RS;19;D ^%RO
"RTN","ZVEMSGU",78,0)
 ;;RSEARCH;D;Routine Search^^5
"RTN","ZVEMSGU",79,0)
 ;;RSEARCH;C;W $C(7),!?2,"Not available for this M Vendor.",!
"RTN","ZVEMSGU",80,0)
 ;;RSEARCH;8;D ^%RSE
"RTN","ZVEMSGU",81,0)
 ;;RSEARCH;9;d ^%rsearch
"RTN","ZVEMSGU",82,0)
 ;;RSEARCH;16;D ^%RSE
"RTN","ZVEMSGU",83,0)
 ;;RSEARCH;17;D ^%RSE
"RTN","ZVEMSGU",84,0)
 ;;RSEARCH;18;D ^%RFIND
"RTN","ZVEMSGU",85,0)
 ;;RSEARCH;19;D ^%RSE
"RTN","ZVEMSGU",86,0)
 ;;RSEL;D;Routine Select^^5
"RTN","ZVEMSGU",87,0)
 ;;RSEL;C;W $C(7),!?2,"Not available for this M Vendor.",!
"RTN","ZVEMSGU",88,0)
 ;;RSEL;2;D ^%RSEL
"RTN","ZVEMSGU",89,0)
 ;;RSEL;8;D ^%RSEL
"RTN","ZVEMSGU",90,0)
 ;;RSEL;9;w $$^%rselect," routines selected"
"RTN","ZVEMSGU",91,0)
 ;;RSEL;16;D ^%RSEL
"RTN","ZVEMSGU",92,0)
 ;;RSEL;17;D ^%RSEL
"RTN","ZVEMSGU",93,0)
 ;;RSEL;18;D ^%RSET
"RTN","ZVEMSGU",94,0)
 ;;RSEL;19;D ^%RSEL
"RTN","ZVEMSGU",95,0)
 ;;RSIZE;D;Routine Size^^5
"RTN","ZVEMSGU",96,0)
 ;;RSIZE;C;W $C(7),!?2,"Not available for this M Vendor.",!
"RTN","ZVEMSGU",97,0)
 ;;RSIZE;2;D ^%RSIZE
"RTN","ZVEMSGU",98,0)
 ;;RSIZE;8;D ^%RSIZE
"RTN","ZVEMSGU",99,0)
 ;;RSIZE;16;D ^%RSIZE
"RTN","ZVEMSGU",100,0)
 ;;RTN;D;Make NEW Routine^^5
"RTN","ZVEMSGU",101,0)
 ;;RTN;C;D ^%ZVEMSNR
"RTN","ZVEMSGU",102,0)
 ;;UCI;D;Switch UCI^^5
"RTN","ZVEMSGU",103,0)
 ;;UCI;C;W $C(7),!?2,"Not available for this M Vendor.",!
"RTN","ZVEMSGU",104,0)
 ;;UCI;2;D ^%ZUCI
"RTN","ZVEMSGU",105,0)
 ;;UCI;8;D ^%LOGON
"RTN","ZVEMSGU",106,0)
 ;;UCI;9;d ^%nspace
"RTN","ZVEMSGU",107,0)
 ;;UCI;16;D ^%ZUCI
"RTN","ZVEMSGU",108,0)
 ;;UTIL;D;Utilities Menu^^5
"RTN","ZVEMSGU",109,0)
 ;;UTIL;C;W $C(7),!?2,"Not available for this M Vendor.",!
"RTN","ZVEMSGU",110,0)
 ;;UTIL;2;D ^%LIB
"RTN","ZVEMSGU",111,0)
 ;;UTIL;8;D ^%UTL
"RTN","ZVEMSGU",112,0)
 ;;UTIL;9;ZZUTIL
"RTN","ZVEMSGU",113,0)
 ;;UTIL;16;D ^%LIB
"RTN","ZVEMSGU",114,0)
 ;;***
"RTN","ZVEMSH1")
0^245^B13860223
"RTN","ZVEMSH1",1,0)
ZVEMSH1 ;DJB,VSHL**INTRO,PROTECTION [3/6/97 8:08pm]
"RTN","ZVEMSH1",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMSH1",3,0)
 ;
"RTN","ZVEMSH1",4,0)
INTRO ;;;
"RTN","ZVEMSH1",5,0)
 ;;; I N T R O D U C T I O N
"RTN","ZVEMSH1",6,0)
 ;;;
"RTN","ZVEMSH1",7,0)
 ;;; I am making the VICTORY PROGRAMMER ENVIRONMENT (VPE) software package
"RTN","ZVEMSH1",8,0)
 ;;; available to M (Mumps) users under the following conditions:
"RTN","ZVEMSH1",9,0)
 ;;; o  VPE may be distributed freely without charge.
"RTN","ZVEMSH1",10,0)
 ;;; o  VPE may not be sold, licensed, or a fee charged for its use.
"RTN","ZVEMSH1",11,0)
 ;;; o  Any other use, distribution, or representation of VPE is expressly
"RTN","ZVEMSH1",12,0)
 ;;;    forbidden without the written consent of David J. Bolduc.
"RTN","ZVEMSH1",13,0)
 ;;; DAVID J. BOLDUC
"RTN","ZVEMSH1",14,0)
 ;;;
"RTN","ZVEMSH1",15,0)
 ;;; Welcome to the VPE VShell. This M Shell is designed for people who work in
"RTN","ZVEMSH1",16,0)
 ;;; programmer mode. It will provide an environment that is safer than normal
"RTN","ZVEMSH1",17,0)
 ;;; programmer mode, and will help you organize your work and reduce the
"RTN","ZVEMSH1",18,0)
 ;;; keystrokes required to accomplish your tasks.
"RTN","ZVEMSH1",19,0)
 ;;;
"RTN","ZVEMSH1",20,0)
 ;;; You enter the VShell with the command 'X ^%ZVEMS'. You exit by entering any
"RTN","ZVEMSH1",21,0)
 ;;; of the following: '^,H,h,HALT,halt'.
"RTN","ZVEMSH1",22,0)
 ;;;
"RTN","ZVEMSH1",23,0)
 ;;; To allow you to distinguish between the VShell and normal programmer mode,
"RTN","ZVEMSH1",24,0)
 ;;; the ">" prompt is replaced with ">>".
"RTN","ZVEMSH1",25,0)
 ;;; >X ^%ZVEMS
"RTN","ZVEMSH1",26,0)
 ;;; >>
"RTN","ZVEMSH1",27,0)
 ;;;
"RTN","ZVEMSH1",28,0)
 ;;; When you first enter the VShell you'll be asked for an ID number. This number
"RTN","ZVEMSH1",29,0)
 ;;; will be your permanent identification number. Any QWIK commands you develop
"RTN","ZVEMSH1",30,0)
 ;;; will be stored using this number. If you enter the VShell with an incorrect
"RTN","ZVEMSH1",31,0)
 ;;; ID number, you will not have access to your QWIKs.
"RTN","ZVEMSH1",32,0)
 ;;;
"RTN","ZVEMSH1",33,0)
 ;;; If you enter the VShell from a UCI that contains the VA KERNEL routine ^XUP,
"RTN","ZVEMSH1",34,0)
 ;;; your ID will be saved with your DUZ and you won't have to enter it again.
"RTN","ZVEMSH1",35,0)
 ;;; If you enter from a UCI that doesn't contain ^XUP, your ID won't be stored
"RTN","ZVEMSH1",36,0)
 ;;; and you will need to enter it each time.
"RTN","ZVEMSH1",37,0)
 ;;;
"RTN","ZVEMSH1",38,0)
 ;;; ** THINGS TO GET USED TO **
"RTN","ZVEMSH1",39,0)
 ;;;
"RTN","ZVEMSH1",40,0)
 ;;; Different M systems handle the user partition differently. Some systems note
"RTN","ZVEMSH1",41,0)
 ;;; the routine that is in the partition, execute your code, and then restore the
"RTN","ZVEMSH1",42,0)
 ;;; routine to your partition. Because of this, you cannot ZLoad a routine and
"RTN","ZVEMSH1",43,0)
 ;;; call your editor on one line, and then ZSave it on another line. It may no
"RTN","ZVEMSH1",44,0)
 ;;; longer be in the partition. When doing things of this nature, all steps must
"RTN","ZVEMSH1",45,0)
 ;;; be placed on ONE line of code.
"RTN","ZVEMSH1",46,0)
 ;;;
"RTN","ZVEMSH1",47,0)
 ;;; Ex: ZL ROUTINE X ^% ZS   <-- All steps on one line of code.
"RTN","ZVEMSH1",48,0)
 ;;;
"RTN","ZVEMSH1",49,0)
 ;;; You can have similar problems if you try to enter lines of code at the '>>'
"RTN","ZVEMSH1",50,0)
 ;;; prompt to make a new routine. A System QWIK called RTN is provided for
"RTN","ZVEMSH1",51,0)
 ;;; starting a new routine. See SYSTEM QWIK help text.
"RTN","ZVEMSH1",52,0)
 ;;;
"RTN","ZVEMSH1",53,0)
 ;;; Any questions you may have concerning VPE may be directed to:
"RTN","ZVEMSH1",54,0)
 ;;;       BOLDUC,DAVID@FORUM.VA.GOV
"RTN","ZVEMSH1",55,0)
 ;;;***
"RTN","ZVEMSH2")
0^246^B15154003
"RTN","ZVEMSH2",1,0)
ZVEMSH2 ;DJB,VSHL**KEYBOARD [9/30/95 6:57pm]
"RTN","ZVEMSH2",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMSH2",3,0)
 ;
"RTN","ZVEMSH2",4,0)
KEYS ;;;
"RTN","ZVEMSH2",5,0)
 ;;; K E Y B O A R D
"RTN","ZVEMSH2",6,0)
 ;;;
"RTN","ZVEMSH2",7,0)
 ;;; There are certain Key combinations used throughout the VShell. To enter them
"RTN","ZVEMSH2",8,0)
 ;;; correctly, hit the first key, release it, then hit the second key.
"RTN","ZVEMSH2",9,0)
 ;;; Example: <ESC>H. Hit the <ESC> key and release it. Then hit the H key.
"RTN","ZVEMSH2",10,0)
 ;;;
"RTN","ZVEMSH2",11,0)
 ;;; <ESC><ESC>  This combination normally allows you to Quit back to the ">>"
"RTN","ZVEMSH2",12,0)
 ;;;             prompt.
"RTN","ZVEMSH2",13,0)
 ;;; <ESC>H      This will bring up any Help text.
"RTN","ZVEMSH2",14,0)
 ;;; <ESC>Q      When you've selected a command from the Command Line History,
"RTN","ZVEMSH2",15,0)
 ;;;             you may hit <ESC>Q if you wish to convert the command to a User
"RTN","ZVEMSH2",16,0)
 ;;;             QWIK.
"RTN","ZVEMSH2",17,0)
 ;;; <ESC>U      When you're editing a QWIK and are at the CODE: prompt, you can
"RTN","ZVEMSH2",18,0)
 ;;;             hit <ESC>U to UNsave code that was SAved in either the VPE
"RTN","ZVEMSH2",19,0)
 ;;;             routine or global editors.
"RTN","ZVEMSH2",20,0)
 ;;;
"RTN","ZVEMSH2",21,0)
 ;;; Certain keys act differently depending on where you are in the VShell.
"RTN","ZVEMSH2",22,0)
 ;;;
"RTN","ZVEMSH2",23,0)
 ;;; -->  A R R O W   K E Y S
"RTN","ZVEMSH2",24,0)
 ;;;
"RTN","ZVEMSH2",25,0)
 ;;; Module:  VShell    VGL                     VRR                VEDD
"RTN","ZVEMSH2",26,0)
 ;;; Prompt:  >>       Session 1...Global ^    Select ROUTINE:    Select FILE:
"RTN","ZVEMSH2",27,0)
 ;;; When you are at the above prompts, if you haven't typed any characters:
"RTN","ZVEMSH2",28,0)
 ;;;    Left Arrow...Display last 20 commands of Command Line History (CLH)
"RTN","ZVEMSH2",29,0)
 ;;;    Up Arrow.....Move up 1 command in the CLH
"RTN","ZVEMSH2",30,0)
 ;;;    Down Arrow...Move down 1 command in the CLH
"RTN","ZVEMSH2",31,0)
 ;;; If you have typed any characters, the arrow keys are used to position the
"RTN","ZVEMSH2",32,0)
 ;;; cursor for editing.
"RTN","ZVEMSH2",33,0)
 ;;;
"RTN","ZVEMSH2",34,0)
 ;;; When moving up and down the CLH, if the cursor is not moved from its position
"RTN","ZVEMSH2",35,0)
 ;;; at the end of the command line, Up & Down Arrow will move you to the next
"RTN","ZVEMSH2",36,0)
 ;;; command. If the cursor is moved and is no longer at the end of the command
"RTN","ZVEMSH2",37,0)
 ;;; line, Up & Down Arrow will move you up and down the lines of the command
"RTN","ZVEMSH2",38,0)
 ;;; itself, if the command has more than one line. Once you've moved the cursor,
"RTN","ZVEMSH2",39,0)
 ;;; if you want the next command in CLH, you reposition the cursor to the end of
"RTN","ZVEMSH2",40,0)
 ;;; the command line (Use <F1><AR> key combination).
"RTN","ZVEMSH2",41,0)
 ;;;
"RTN","ZVEMSH2",42,0)
 ;;; -->  F   K E Y S
"RTN","ZVEMSH2",43,0)
 ;;;
"RTN","ZVEMSH2",44,0)
 ;;; When you are at the VShell prompt ">>", and you have not typed any characters:
"RTN","ZVEMSH2",45,0)
 ;;;   <F1>1  List User QWIK Commands with Description
"RTN","ZVEMSH2",46,0)
 ;;;   <F1>2  List User QWIK Commands with Code
"RTN","ZVEMSH2",47,0)
 ;;;   <F1>3  List System QWIK Commands with Description
"RTN","ZVEMSH2",48,0)
 ;;;   <F1>4  List System QWIK Commands with Code
"RTN","ZVEMSH2",49,0)
 ;;;
"RTN","ZVEMSH2",50,0)
 ;;; When you are using the CLH editor:
"RTN","ZVEMSH2",51,0)
 ;;;   <F1><AL>  Moves cursor to beginning of line
"RTN","ZVEMSH2",52,0)
 ;;;   <F1><AR>  Moves cursor to end of line
"RTN","ZVEMSH2",53,0)
 ;;;   <F2><AL>  Moves cursor left 15 characters
"RTN","ZVEMSH2",54,0)
 ;;;   <F2><AR>  Moves cursor right 15 characters
"RTN","ZVEMSH2",55,0)
 ;;;
"RTN","ZVEMSH2",56,0)
 ;;; NOTE: On VT-100 keyboards substitute the PF1,PF2 keys.
"RTN","ZVEMSH2",57,0)
 ;;;
"RTN","ZVEMSH2",58,0)
 ;;; -->  T A B   K E Y
"RTN","ZVEMSH2",59,0)
 ;;;
"RTN","ZVEMSH2",60,0)
 ;;; When you are at the VShell prompt ">>", and you have not typed any characters:
"RTN","ZVEMSH2",61,0)
 ;;;   <TAB>  Allows you to enter/edit User QWIKs
"RTN","ZVEMSH2",62,0)
 ;;;
"RTN","ZVEMSH2",63,0)
 ;;; When using the CLH editor:
"RTN","ZVEMSH2",64,0)
 ;;;   <TAB>  Can be used to exit
"RTN","ZVEMSH2",65,0)
 ;;;***
"RTN","ZVEMSH3")
0^247^B19427018
"RTN","ZVEMSH3",1,0)
ZVEMSH3 ;DJB,VSHL**QWIK COMMANDS,USER QWIKS [3/6/95 7:27am]
"RTN","ZVEMSH3",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMSH3",3,0)
 ;
"RTN","ZVEMSH3",4,0)
QWIK ;;;
"RTN","ZVEMSH3",5,0)
 ;;; Q W I K   C O M M A N D S
"RTN","ZVEMSH3",6,0)
 ;;;
"RTN","ZVEMSH3",7,0)
 ;;; The VShell allows the use of QWIK commands to greatly reduce the number
"RTN","ZVEMSH3",8,0)
 ;;; of keystrokes required to accomplish your tasks. QWIK commands are words
"RTN","ZVEMSH3",9,0)
 ;;; from 1 to 8 characters long, that, when invoked, will execute one line of
"RTN","ZVEMSH3",10,0)
 ;;; Mumps code. There are two types of QWIK commands: System QWIKs & User QWIKs.
"RTN","ZVEMSH3",11,0)
 ;;; System QWIKs come with the VShell and can not be altered. User QWIKs are
"RTN","ZVEMSH3",12,0)
 ;;; created by you.
"RTN","ZVEMSH3",13,0)
 ;;;
"RTN","ZVEMSH3",14,0)
 ;;; To run a QWIK command, you type one dot and the command for a User QWIK, and
"RTN","ZVEMSH3",15,0)
 ;;; two dots and the command for a System QWIK. If you created a User QWIK called
"RTN","ZVEMSH3",16,0)
 ;;; 'E' to invoke your routine editor, you would type '.E' to run the QWIK. To
"RTN","ZVEMSH3",17,0)
 ;;; run System QWIK VGL, the VGlobal Lister, you would type '..VGL', with two
"RTN","ZVEMSH3",18,0)
 ;;; dots, since it's a System QWIK.
"RTN","ZVEMSH3",19,0)
 ;;;
"RTN","ZVEMSH3",20,0)
 ;;; The question you may have is "When should I create a User QWIK?". I can only
"RTN","ZVEMSH3",21,0)
 ;;; tell you when I create a QWIK - If I type something over 3 times, I make a
"RTN","ZVEMSH3",22,0)
 ;;; User QWIK to do it. For example, I have my own routine that I use to monitor
"RTN","ZVEMSH3",23,0)
 ;;; the error log throughout the day. The routine is ^AAH2EVAX. So, I can type
"RTN","ZVEMSH3",24,0)
 ;;; D ^AAH2EVAX all day long or make a User QWIK called 'ER' and type '.ER'. The
"RTN","ZVEMSH3",25,0)
 ;;; QWIK command 'ER' requires only 1/3 of the keystrokes.
"RTN","ZVEMSH3",26,0)
 ;;;
"RTN","ZVEMSH3",27,0)
 ;;; Making a User QWIK command is very easy and you will learn more about that
"RTN","ZVEMSH3",28,0)
 ;;; in the 'User QWIKS' help text.
"RTN","ZVEMSH3",29,0)
 ;;;
"RTN","ZVEMSH3",30,0)
 ;;; You can use the F1 key to view all QWIK commands that are available to
"RTN","ZVEMSH3",31,0)
 ;;; you:
"RTN","ZVEMSH3",32,0)
 ;;;       <F1>1...List User QWIKs and descriptions
"RTN","ZVEMSH3",33,0)
 ;;;       <F1>2...List User QWIKs and their code
"RTN","ZVEMSH3",34,0)
 ;;;       <F1>3...List System QWIKs and descriptions
"RTN","ZVEMSH3",35,0)
 ;;;       <F1>4...List System QWIKs and their code
"RTN","ZVEMSH3",36,0)
 ;;;
"RTN","ZVEMSH3",37,0)
 ;;; NOTE: On a VT-100 keyboard substitute the PF1 key.
"RTN","ZVEMSH3",38,0)
 ;;;
"RTN","ZVEMSH3",39,0)
 ;;; Typing . or .. will bulk display User or System QWIKs. Typing . or .. and
"RTN","ZVEMSH3",40,0)
 ;;; the first few characters will list QWIKs starting with those characters
"RTN","ZVEMSH3",41,0)
 ;;; and allow a selection.
"RTN","ZVEMSH3",42,0)
 ;;;***
"RTN","ZVEMSH3",43,0)
USER ;;;
"RTN","ZVEMSH3",44,0)
 ;;; U S E R   Q W I K S
"RTN","ZVEMSH3",45,0)
 ;;;
"RTN","ZVEMSH3",46,0)
 ;;; User QWIKs are your ticket to doing your work in half the keystrokes.
"RTN","ZVEMSH3",47,0)
 ;;; Anything you do in programmer's mode can be done with a User QWIK. A User
"RTN","ZVEMSH3",48,0)
 ;;; QWIK is a word, from 1 to 8 characters long, that will execute a line of
"RTN","ZVEMSH3",49,0)
 ;;; Mumps code. To invoke a User QWIK, type one dot and the name.
"RTN","ZVEMSH3",50,0)
 ;;;
"RTN","ZVEMSH3",51,0)
 ;;; Let's assume that on your Mumps system you switch UCIs by entering: DO ^%ZUCI.
"RTN","ZVEMSH3",52,0)
 ;;; Let's make a User QWIK command to do the same thing. To Add/Edit a QWIK, hit
"RTN","ZVEMSH3",53,0)
 ;;; the <TAB> key. You will be prompted for the following:
"RTN","ZVEMSH3",54,0)
 ;;;          Prompt         Your Answer
"RTN","ZVEMSH3",55,0)
 ;;;      --------------  -----------------
"RTN","ZVEMSH3",56,0)
 ;;;      NAME            UCI
"RTN","ZVEMSH3",57,0)
 ;;;      CODE            D ^%ZUCI
"RTN","ZVEMSH3",58,0)
 ;;;      DESCRIPTION     Switch UCIs
"RTN","ZVEMSH3",59,0)
 ;;;      PARAM NOTES
"RTN","ZVEMSH3",60,0)
 ;;;      BOX             1
"RTN","ZVEMSH3",61,0)
 ;;; We've named the QWIK 'UCI'. The code we want it to execute is: 'DO ^%ZUCI'.
"RTN","ZVEMSH3",62,0)
 ;;; The description is 'Switch UCIs' and we've stored it in Box '1'. For more
"RTN","ZVEMSH3",63,0)
 ;;; information about PARAM NOTES and BOX, see help text for PARAMETER PASSING
"RTN","ZVEMSH3",64,0)
 ;;; and BOXES.
"RTN","ZVEMSH3",65,0)
 ;;;
"RTN","ZVEMSH3",66,0)
 ;;; You are now done. Back at the '>>' prompt, you can now type '.UCI' whenever
"RTN","ZVEMSH3",67,0)
 ;;; you want to switch UCIs. To see your new QWIK, hit <F1>1 or <F1>2 (List
"RTN","ZVEMSH3",68,0)
 ;;; User QWIKs). Making a QWIK command is just that easy.
"RTN","ZVEMSH3",69,0)
 ;;;
"RTN","ZVEMSH3",70,0)
 ;;; You can type <F1>4 to list System QWIKs and their code. This may give you
"RTN","ZVEMSH3",71,0)
 ;;; some ideas for making more sophisticated User QWIKs.
"RTN","ZVEMSH3",72,0)
 ;;;***
"RTN","ZVEMSH4")
0^248^B19769085
"RTN","ZVEMSH4",1,0)
ZVEMSH4 ;DJB,VSHL**SYSTEM QWIKS [9/8/97 8:24pm]
"RTN","ZVEMSH4",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMSH4",3,0)
 ;
"RTN","ZVEMSH4",4,0)
SYSTEM ;;;
"RTN","ZVEMSH4",5,0)
 ;;; S Y S T E M   Q W I K S
"RTN","ZVEMSH4",6,0)
 ;;;
"RTN","ZVEMSH4",7,0)
 ;;; System QWIKs come with the VShell. To invoke a System QWIK, type two dots
"RTN","ZVEMSH4",8,0)
 ;;; followed by the name. For example, to run VGL you would type ..VGL.
"RTN","ZVEMSH4",9,0)
 ;;; The following is a list of the available System QWIKs, grouped by category:
"RTN","ZVEMSH4",10,0)
 ;;;
"RTN","ZVEMSH4",11,0)
 ;;; 1.) QWIK RELATED
"RTN","ZVEMSH4",12,0)
 ;;;
"RTN","ZVEMSH4",13,0)
 ;;; QB     Assign User QWIKs to a Box. See BOXES help text.
"RTN","ZVEMSH4",14,0)
 ;;; QC     Copy a QWIK.
"RTN","ZVEMSH4",15,0)
 ;;; QD     Delete a QWIK.
"RTN","ZVEMSH4",16,0)
 ;;; QE     Add/Edit a QWIK. Same as <TAB>.
"RTN","ZVEMSH4",17,0)
 ;;; QL1    List User QWIKs/Description - Same as <F1>1.
"RTN","ZVEMSH4",18,0)
 ;;; QL2    List User QWIKs/Code - Same as <F1>2.
"RTN","ZVEMSH4",19,0)
 ;;; QL3    List System QWIKs/Description - Same as <F1>3.
"RTN","ZVEMSH4",20,0)
 ;;; QL4    List System QWIKs/Code - Same as <F1>4.
"RTN","ZVEMSH4",21,0)
 ;;; QSAVE  Saves your User QWIKs to a routine. Use for back-up or to send your
"RTN","ZVEMSH4",22,0)
 ;;;        QWIKs to another programmer. This option also restores previously
"RTN","ZVEMSH4",23,0)
 ;;;        saved QWIKs.
"RTN","ZVEMSH4",24,0)
 ;;; QV     Create QWIKs that will run on different vendors' Mumps systems. See
"RTN","ZVEMSH4",25,0)
 ;;;        VENDOR SPECIFIC CONFIGURATIONS help text.
"RTN","ZVEMSH4",26,0)
 ;;; QVL    List Vendor Specific Code for QWIKs set up with QV.
"RTN","ZVEMSH4",27,0)
 ;;;
"RTN","ZVEMSH4",28,0)
 ;;; 2.) SHELL RELATED
"RTN","ZVEMSH4",29,0)
 ;;;
"RTN","ZVEMSH4",30,0)
 ;;; CLH     Resequences your Command Line History. The VShell saves your last 20
"RTN","ZVEMSH4",31,0)
 ;;;         commands. As new commands are added and old commands dropped, the
"RTN","ZVEMSH4",32,0)
 ;;;         sequence number of each entry can get large. You may type ..CLH
"RTN","ZVEMSH4",33,0)
 ;;;         at anytime, to resequence the numbers back to 1-20.
"RTN","ZVEMSH4",34,0)
 ;;; DTMVT   For DataTree users. If you Control C out of some DataTree utilities,
"RTN","ZVEMSH4",35,0)
 ;;;         VT100 terminal emulation is no longer in effect and you will see
"RTN","ZVEMSH4",36,0)
 ;;;         junk on the screen. Use this QWIK to reset your terminal to VT100.
"RTN","ZVEMSH4",37,0)
 ;;; PARAM   Enter System Parameters. See MISCELLANEOUS help text.
"RTN","ZVEMSH4",38,0)
 ;;; PUR     The VShell has it's own scratch area: ^%ZVEMS("%"). PUR will purge
"RTN","ZVEMSH4",39,0)
 ;;;         older nodes left behind by a previous session.
"RTN","ZVEMSH4",40,0)
 ;;; PURVGL  Purge VGL's Command Line History.
"RTN","ZVEMSH4",41,0)
 ;;; PURVRR  Purge VRR's Command Line History.
"RTN","ZVEMSH4",42,0)
 ;;; PURVEDD Purge VEDD's Command Line History.
"RTN","ZVEMSH4",43,0)
 ;;; PURVSHL Purge Command Line History for the VShell.
"RTN","ZVEMSH4",44,0)
 ;;; UL      List VShell Users, including DUZ and ID numbers.
"RTN","ZVEMSH4",45,0)
 ;;; VER     Displays VShell version number.
"RTN","ZVEMSH4",46,0)
 ;;;
"RTN","ZVEMSH4",47,0)
 ;;; 3.) PROGRAMMER TOOLS
"RTN","ZVEMSH4",48,0)
 ;;;
"RTN","ZVEMSH4",49,0)
 ;;; ASCII   ASCII table display.
"RTN","ZVEMSH4",50,0)
 ;;; CAL     6 month calendar display.
"RTN","ZVEMSH4",51,0)
 ;;; E       VRoutine Editor.
"RTN","ZVEMSH4",52,0)
 ;;; KEY     Display escape sequence for any key pressed.
"RTN","ZVEMSH4",53,0)
 ;;; LBRY    Routine Library. Used with ..E to help prevent routines from being
"RTN","ZVEMSH4",54,0)
 ;;;         accidentily overwritten when there are multiple programmers working
"RTN","ZVEMSH4",55,0)
 ;;;         on the same routines.
"RTN","ZVEMSH4",56,0)
 ;;; NOTES   VPE programmer notes.
"RTN","ZVEMSH4",57,0)
 ;;; RL      Routine Lister
"RTN","ZVEMSH4",58,0)
 ;;; RTN     Start a new M routine. You may enter your lines of
"RTN","ZVEMSH4",59,0)
 ;;;         code and it will prompt you for a routine name and save it to disk.
"RTN","ZVEMSH4",60,0)
 ;;; VEDD    VElectronic Data Dictionary.
"RTN","ZVEMSH4",61,0)
 ;;; VGL     VGlobal Lister.
"RTN","ZVEMSH4",62,0)
 ;;; VRR     VRoutine Reader.
"RTN","ZVEMSH4",63,0)
 ;;; ZD      Kill all local variables that start with %1(parameter).
"RTN","ZVEMSH4",64,0)
 ;;; ZP      Use to ZPRINT a routine.
"RTN","ZVEMSH4",65,0)
 ;;; ZR      Use to ZREMOVE from 1 to 9 routines.
"RTN","ZVEMSH4",66,0)
 ;;; ZW      ZWRITE the symbol table. Writes the variables one page at a time.
"RTN","ZVEMSH4",67,0)
 ;;;
"RTN","ZVEMSH4",68,0)
 ;;; 4.) FILEMAN/VA KERNEL RELATED
"RTN","ZVEMSH4",69,0)
 ;;;
"RTN","ZVEMSH4",70,0)
 ;;; FMC     Fileman programmer calls.
"RTN","ZVEMSH4",71,0)
 ;;; FMTI    Fileman Input Template display.
"RTN","ZVEMSH4",72,0)
 ;;; FMTP    Fileman Print Template display.
"RTN","ZVEMSH4",73,0)
 ;;; FMTS    Fileman Sort Template display.
"RTN","ZVEMSH4",74,0)
 ;;; LF      VA KERNEL Libray Functions.
"RTN","ZVEMSH4",75,0)
 ;;; XQRT    Help text for VA Kernel menu options.
"RTN","ZVEMSH4",76,0)
 ;;;
"RTN","ZVEMSH4",77,0)
 ;;; 5.) VENDOR GENERIC QWIKS
"RTN","ZVEMSH4",78,0)
 ;;;
"RTN","ZVEMSH4",79,0)
 ;;;     See VENDOR SPECIFIC CONFIGURATIONS help text.
"RTN","ZVEMSH4",80,0)
 ;;;***
"RTN","ZVEMSH5")
0^249^B17891783
"RTN","ZVEMSH5",1,0)
ZVEMSH5 ;DJB,VSHL**BOXES [07/14/94]
"RTN","ZVEMSH5",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMSH5",3,0)
 ;
"RTN","ZVEMSH5",4,0)
BOXES ;;;
"RTN","ZVEMSH5",5,0)
 ;;; B O X E S
"RTN","ZVEMSH5",6,0)
 ;;;
"RTN","ZVEMSH5",7,0)
 ;;; To help you organize the User QWIK commands you develop, the VShell allows you
"RTN","ZVEMSH5",8,0)
 ;;; to store them in boxes. A box can be any whole number.
"RTN","ZVEMSH5",9,0)
 ;;;
"RTN","ZVEMSH5",10,0)
 ;;; Let's look at the UCI QWIK which we set up earlier. We had you assign it to
"RTN","ZVEMSH5",11,0)
 ;;; box 1. You can display the QWIKs stored in box 1 by typing one dot and the
"RTN","ZVEMSH5",12,0)
 ;;; box number. Type '.1' and you will see your UCI QWIK along with any other
"RTN","ZVEMSH5",13,0)
 ;;; QWIKs that have been assigned to box 1.
"RTN","ZVEMSH5",14,0)
 ;;;
"RTN","ZVEMSH5",15,0)
 ;;; If you recall, you may display your User QWIKs by hitting <PF1> or <PF2>. You
"RTN","ZVEMSH5",16,0)
 ;;; will find however, as you develop more and more User QWIKs, it becomes easier
"RTN","ZVEMSH5",17,0)
 ;;; and clearer if you group them into boxes and display the boxes.
"RTN","ZVEMSH5",18,0)
 ;;;
"RTN","ZVEMSH5",19,0)
 ;;; System QWIKs also use boxes. To display the System QWIKs assigned to a box,
"RTN","ZVEMSH5",20,0)
 ;;; type two dots and the box number. For example: '..1' will display all System
"RTN","ZVEMSH5",21,0)
 ;;; QWIKs assigned to box 1. The System QWIKs have been grouped as follows:
"RTN","ZVEMSH5",22,0)
 ;;;
"RTN","ZVEMSH5",23,0)
 ;;;     Box 1..... All QWIK related System QWIKs
"RTN","ZVEMSH5",24,0)
 ;;;     Box 2..... All VShell related System QWIKs
"RTN","ZVEMSH5",25,0)
 ;;;     Box 3..... Programmers' Tools
"RTN","ZVEMSH5",26,0)
 ;;;     Box 4..... Fileman/VA Kernel related System QWIKs
"RTN","ZVEMSH5",27,0)
 ;;;     Box 5..... Vendor Generic Utilities
"RTN","ZVEMSH5",28,0)
 ;;;
"RTN","ZVEMSH5",29,0)
 ;;; Typing one or two dots and the box number will display QWIKs and their
"RTN","ZVEMSH5",30,0)
 ;;; descriptions. If you wish to see the code they will execute, type a letter
"RTN","ZVEMSH5",31,0)
 ;;; 'C' after the box number. So, '.1C' will display User QWIKs assigned to box 1
"RTN","ZVEMSH5",32,0)
 ;;; and the code those QWIKs will execute.
"RTN","ZVEMSH5",33,0)
 ;;;***
"RTN","ZVEMSH5",34,0)
VENDOR ;;;
"RTN","ZVEMSH5",35,0)
 ;;; V E N D O R    S P E C I F I C   C O N F I G U R A T I O N S
"RTN","ZVEMSH5",36,0)
 ;;;
"RTN","ZVEMSH5",37,0)
 ;;; The VShell will allow you to set up an environment that will work the same
"RTN","ZVEMSH5",38,0)
 ;;; regardless of which Mumps system you are running.
"RTN","ZVEMSH5",39,0)
 ;;;
"RTN","ZVEMSH5",40,0)
 ;;; Using the QV System QWIK, you can make User QWIKs that execute different code
"RTN","ZVEMSH5",41,0)
 ;;; depending on your Mumps implementation. To illustrate, let's take the QWIK
"RTN","ZVEMSH5",42,0)
 ;;; called UCI you set up earlier, and make it so this QWIK will work in both
"RTN","ZVEMSH5",43,0)
 ;;; Micronetics and DataTree Mumps.
"RTN","ZVEMSH5",44,0)
 ;;;
"RTN","ZVEMSH5",45,0)
 ;;; In Micronetics Mumps you switch UCIs with 'DO ^%LOGON'. In DataTree you use
"RTN","ZVEMSH5",46,0)
 ;;; 'd ^%nspace'. We've already set up a UCI QWIK. Now type '..QV'. You will be
"RTN","ZVEMSH5",47,0)
 ;;; prompted for a QWIK name. Enter 'UCI'. Next, the VShell will display a list
"RTN","ZVEMSH5",48,0)
 ;;; of vendors and you will be asked to select one. Then it will ask for the
"RTN","ZVEMSH5",49,0)
 ;;; vendor specific code you want this QWIK to execute. You first select
"RTN","ZVEMSH5",50,0)
 ;;; Micronetics and enter 'DO ^%LOGON'. Next, you select DataTree and enter
"RTN","ZVEMSH5",51,0)
 ;;; 'd ^%nspace'. That's all there is to it.
"RTN","ZVEMSH5",52,0)
 ;;;
"RTN","ZVEMSH5",53,0)
 ;;; When you first enter the VShell, it identifies what Mumps vendor you are
"RTN","ZVEMSH5",54,0)
 ;;; using. Whenever it executes a User QWIK, it first checks to see if there
"RTN","ZVEMSH5",55,0)
 ;;; is a vendor specific version. If there is, it executes it. If there isn't,
"RTN","ZVEMSH5",56,0)
 ;;; it executes the non-vendor specific version.
"RTN","ZVEMSH5",57,0)
 ;;;
"RTN","ZVEMSH5",58,0)
 ;;; There are a number of Vendor Generic System QWIKs located in box 5. These
"RTN","ZVEMSH5",59,0)
 ;;; QWIKs have been set up using the principles described above. They will work
"RTN","ZVEMSH5",60,0)
 ;;; the same for DSM, VAX DSM, DataTree, and Micronetics Mumps.
"RTN","ZVEMSH5",61,0)
 ;;;***
"RTN","ZVEMSH6")
0^250^B13779911
"RTN","ZVEMSH6",1,0)
ZVEMSH6 ;DJB,VSHL**COMMAND LINE HISTORY,PROGRAMMER TOOLS [5/8/97 7:46pm]
"RTN","ZVEMSH6",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMSH6",3,0)
 ;
"RTN","ZVEMSH6",4,0)
CLH ;;;
"RTN","ZVEMSH6",5,0)
 ;;; C O M M A N D   L I N E   H I S T O R Y
"RTN","ZVEMSH6",6,0)
 ;;;
"RTN","ZVEMSH6",7,0)
 ;;; The VShell maintains a Command Line History (CLH) that allows you to
"RTN","ZVEMSH6",8,0)
 ;;; capture, edit, and reissue up to 20 commands. Actually there are 4 separate
"RTN","ZVEMSH6",9,0)
 ;;; CLH's, one for each module of VPE (VGL,VRR,VEDD) and one for the VShell itself.
"RTN","ZVEMSH6",10,0)
 ;;; Hitting the left arrow key will display your last 20 commands, and allow you
"RTN","ZVEMSH6",11,0)
 ;;; to edit and reissue any one. You can use the up and down arrow keys to move
"RTN","ZVEMSH6",12,0)
 ;;; up and down the CLH, and edit and reissue any individual command.
"RTN","ZVEMSH6",13,0)
 ;;;
"RTN","ZVEMSH6",14,0)
 ;;; If you have a previous command that you wish to convert to a User QWIK, move
"RTN","ZVEMSH6",15,0)
 ;;; to that command using the arrow keys, and then hit <ESC>Q for the QWIK
"RTN","ZVEMSH6",16,0)
 ;;; dialogue. The QWIK you create will use the code from the CLH.
"RTN","ZVEMSH6",17,0)
 ;;;
"RTN","ZVEMSH6",18,0)
 ;;; You may purge the CLH at any time using the following System QWIKs:
"RTN","ZVEMSH6",19,0)
 ;;;      ..PURVSHL   Purge VShell CLH
"RTN","ZVEMSH6",20,0)
 ;;;      ..PURVRR    Purge Routine Lister/Editor CLH
"RTN","ZVEMSH6",21,0)
 ;;;      ..PURVGL    Purge Global Lister/Editor CLH
"RTN","ZVEMSH6",22,0)
 ;;;      ..PURVEDD   Purge VEDD CLH
"RTN","ZVEMSH6",23,0)
 ;;;
"RTN","ZVEMSH6",24,0)
 ;;; As commands are added and dropped from the CLH, the number of any individual
"RTN","ZVEMSH6",25,0)
 ;;; command can become large. Each time you enter the VShell the CLH is renumbered
"RTN","ZVEMSH6",26,0)
 ;;; back to 1-20. You can manually renumber the CLH with System QWIK ..CLH.
"RTN","ZVEMSH6",27,0)
 ;;;
"RTN","ZVEMSH6",28,0)
 ;;; If you have the ^%ZOSF("UCI") global node on your system, VShell will delete
"RTN","ZVEMSH6",29,0)
 ;;; the SHL Command Line History whenever you switch UCIs. This is to protect you
"RTN","ZVEMSH6",30,0)
 ;;; from accidientily rerunning a command in the wrong UCI.
"RTN","ZVEMSH6",31,0)
 ;;;
"RTN","ZVEMSH6",32,0)
 ;;; The CLH is an extremely useful tool and you should become proficient in its
"RTN","ZVEMSH6",33,0)
 ;;; use. Remember, it is also available in VRR, VGL, and VEDD.
"RTN","ZVEMSH6",34,0)
 ;;;***
"RTN","ZVEMSH6",35,0)
PGM ;;;
"RTN","ZVEMSH6",36,0)
 ;;; P R O G R A M M E R   T O O L S
"RTN","ZVEMSH6",37,0)
 ;;;
"RTN","ZVEMSH6",38,0)
 ;;; The VShell includes a number of programmer tools that range from a single
"RTN","ZVEMSH6",39,0)
 ;;; routine to very sophisticated packages. They all have one thing in common:
"RTN","ZVEMSH6",40,0)
 ;;; They're useful. These tools are System QWIKs and are located in Box 3. Type
"RTN","ZVEMSH6",41,0)
 ;;; '..3' to see them. To use them, type two dots and the name.
"RTN","ZVEMSH6",42,0)
 ;;;
"RTN","ZVEMSH6",43,0)
 ;;; E       A routine editor that uses the VRR module.
"RTN","ZVEMSH6",44,0)
 ;;; ASCII   Displays the ASCII character set.
"RTN","ZVEMSH6",45,0)
 ;;; CAL     Six month calendar display.
"RTN","ZVEMSH6",46,0)
 ;;; KEY     Display escape sequence for any key struck.
"RTN","ZVEMSH6",47,0)
 ;;; VEDD    VElectronic Data Dictionary - An easy to use utility for viewing the
"RTN","ZVEMSH6",48,0)
 ;;;         structure of Fileman files.
"RTN","ZVEMSH6",49,0)
 ;;; VGL     VGlobal Lister/Editor - A tool to examine and edit globals.
"RTN","ZVEMSH6",50,0)
 ;;; VRR     VRoutine Reader - Used to read routines. Allows branching to up
"RTN","ZVEMSH6",51,0)
 ;;;         to 4 routines so you can follow any branching logic contained in the
"RTN","ZVEMSH6",52,0)
 ;;;         code.
"RTN","ZVEMSH6",53,0)
 ;;;***
"RTN","ZVEMSH7")
0^251^B11560809
"RTN","ZVEMSH7",1,0)
ZVEMSH7 ;DJB,VSHL**PARAMETER PASSING [04/17/94]
"RTN","ZVEMSH7",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMSH7",3,0)
 ;
"RTN","ZVEMSH7",4,0)
PARAM ;;;
"RTN","ZVEMSH7",5,0)
 ;;; P A R A M E T E R   P A S S I N G
"RTN","ZVEMSH7",6,0)
 ;;;
"RTN","ZVEMSH7",7,0)
 ;;; User QWIKs can be made more powerful and flexible by using parameter passing.
"RTN","ZVEMSH7",8,0)
 ;;; You pass parameters to your QWIKs by typing one dot and your QWIK name, and
"RTN","ZVEMSH7",9,0)
 ;;; then from 1 to 9 parameters, each separated by a space. If the parameter
"RTN","ZVEMSH7",10,0)
 ;;; itself contains a space, it must be enclosed in quotes. The VShell will look
"RTN","ZVEMSH7",11,0)
 ;;; for any parameters and assign them to variables %1 thru %9. Your QWIK would
"RTN","ZVEMSH7",12,0)
 ;;; use these variables.
"RTN","ZVEMSH7",13,0)
 ;;;
"RTN","ZVEMSH7",14,0)
 ;;; As an example of how to use parameter passing, lets look at System QWIK ZP.
"RTN","ZVEMSH7",15,0)
 ;;; You use ZP to ZPRINT a routine. You would enter '..ZP ROUTINE'. You can see
"RTN","ZVEMSH7",16,0)
 ;;; that ROUTINE is the parameter and the VShell will assign this to %1.
"RTN","ZVEMSH7",17,0)
 ;;;
"RTN","ZVEMSH7",18,0)
 ;;; Here is ZP's code:  Q:%1']""  ZL @%1 ZP
"RTN","ZVEMSH7",19,0)
 ;;;
"RTN","ZVEMSH7",20,0)
 ;;; First, this QWIK will QUIT if no routine name has been passed. Next it will
"RTN","ZVEMSH7",21,0)
 ;;; ZLOAD the routine into your partition and then ZPRINT it. Note that you don't
"RTN","ZVEMSH7",22,0)
 ;;; have to check to see if %1 is defined. %1-%9 are always defined either to a
"RTN","ZVEMSH7",23,0)
 ;;; parameter or to null.
"RTN","ZVEMSH7",24,0)
 ;;;
"RTN","ZVEMSH7",25,0)
 ;;; If you hit '..2' at the >> prompt, to view the System QWIKs in box 2, you
"RTN","ZVEMSH7",26,0)
 ;;; will see:  ZP   ZPrint a Routine
"RTN","ZVEMSH7",27,0)
 ;;;                 -> %1=Routine Name
"RTN","ZVEMSH7",28,0)
 ;;; The '%1=Routine Name' is what you would enter at the 'Edit PARAM NOTES:'
"RTN","ZVEMSH7",29,0)
 ;;; prompt when you Enter/Edit a QWIK. Then when you view your QWIKs, these notes
"RTN","ZVEMSH7",30,0)
 ;;; are displayed as a reminder that you need to pass a parameter when calling
"RTN","ZVEMSH7",31,0)
 ;;; this QWIK.
"RTN","ZVEMSH7",32,0)
 ;;;***
"RTN","ZVEMSH7",33,0)
PROT ;;;
"RTN","ZVEMSH7",34,0)
 ;;; P R O T E C T I O N
"RTN","ZVEMSH7",35,0)
 ;;;
"RTN","ZVEMSH7",36,0)
 ;;; When you enter code at the ">>" prompt, it is first checked for any global
"RTN","ZVEMSH7",37,0)
 ;;; kills. If your code is killing a global, you will receive a warning message
"RTN","ZVEMSH7",38,0)
 ;;; which will ask if you really want the code executed. This allows you to
"RTN","ZVEMSH7",39,0)
 ;;; review your code and abort the execution if you note any errors.
"RTN","ZVEMSH7",40,0)
 ;;;
"RTN","ZVEMSH7",41,0)
 ;;; Your line of code is divided into "pieces" based on spaces. If any piece
"RTN","ZVEMSH7",42,0)
 ;;; contains an "^" and the previous piece contains a "K", you will receive the
"RTN","ZVEMSH7",43,0)
 ;;; warning. Some code may fit this pattern and trigger a warning even tho no
"RTN","ZVEMSH7",44,0)
 ;;; kill is being executed. Example:  LOCK ^XXX(1,2) 
"RTN","ZVEMSH7",45,0)
 ;;;
"RTN","ZVEMSH7",46,0)
 ;;; NOTE: This protection is also available when using the VPE routine and
"RTN","ZVEMSH7",47,0)
 ;;;       global editors.
"RTN","ZVEMSH7",48,0)
 ;;;***
"RTN","ZVEMSH8")
0^252^B17834043
"RTN","ZVEMSH8",1,0)
ZVEMSH8 ;DJB,VSHL**MISCELLANEOUS [3/8/95 6:55am]
"RTN","ZVEMSH8",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMSH8",3,0)
 ;
"RTN","ZVEMSH8",4,0)
MISC ;;;
"RTN","ZVEMSH8",5,0)
 ;;; M I S C E L L A N E O U S
"RTN","ZVEMSH8",6,0)
 ;;;
"RTN","ZVEMSH8",7,0)
 ;;; S H E L L   P A R A M E T E R S
"RTN","ZVEMSH8",8,0)
 ;;;
"RTN","ZVEMSH8",9,0)
 ;;; There are a few VShell parameters which you can adjust to meet your needs by
"RTN","ZVEMSH8",10,0)
 ;;; running the PARAM System QWIK. Type ..PARAM at the '>>' prompt. The following
"RTN","ZVEMSH8",11,0)
 ;;; parameters can be set:
"RTN","ZVEMSH8",12,0)
 ;;;
"RTN","ZVEMSH8",13,0)
 ;;;   Global Kill: NO/YES
"RTN","ZVEMSH8",14,0)
 ;;;                If you enter code at the '>>' prompt that is killing a
"RTN","ZVEMSH8",15,0)
 ;;;                global, you will be warned and asked if you want the code
"RTN","ZVEMSH8",16,0)
 ;;;                executed. The default answer to that question is setable here.
"RTN","ZVEMSH8",17,0)
 ;;;
"RTN","ZVEMSH8",18,0)
 ;;;   Prompt: ACTIVE/INACTIVE
"RTN","ZVEMSH8",19,0)
 ;;;                If Prompt is set to INACTIVE, the VShell's prompt will be
"RTN","ZVEMSH8",20,0)
 ;;;                '>>'. If Prompt is ACTIVE, the VShell's prompt will include
"RTN","ZVEMSH8",21,0)
 ;;;                UCI and Volume Set. Example: VAH,ROU>>
"RTN","ZVEMSH8",22,0)
 ;;;
"RTN","ZVEMSH8",23,0)
 ;;;   Time-out: SECONDS
"RTN","ZVEMSH8",24,0)
 ;;;                You can set the length of time before the VShell times out
"RTN","ZVEMSH8",25,0)
 ;;;                from inactivity. Enter the time out length in seconds.
"RTN","ZVEMSH8",26,0)
 ;;;
"RTN","ZVEMSH8",27,0)
 ;;;   SAVE Routine: ROUTINE NAME
"RTN","ZVEMSH8",28,0)
 ;;;                The routine entered here will be the default routine when
"RTN","ZVEMSH8",29,0)
 ;;;                you run System QWIK ..QSAVE, to save your User QWIKs.
"RTN","ZVEMSH8",30,0)
 ;;;                ..QSAVE is also used to restore your previously saved QWIKs.
"RTN","ZVEMSH8",31,0)
 ;;;                NOTE: It is your responsibility to insure that the routine
"RTN","ZVEMSH8",32,0)
 ;;;                entered here doesn't already exist. If it does, it will
"RTN","ZVEMSH8",33,0)
 ;;;                be overwritten.
"RTN","ZVEMSH8",34,0)
 ;;;
"RTN","ZVEMSH8",35,0)
 ;;;   <DEL> different from <BS>
"RTN","ZVEMSH8",36,0)
 ;;;                  When set to DIFF, the <BS> key (8) deletes the character
"RTN","ZVEMSH8",37,0)
 ;;;                  to the left of the cursor, and the <DEL> key (127)
"RTN","ZVEMSH8",38,0)
 ;;;                  deletes the character under the cursor. When set to SAME,
"RTN","ZVEMSH8",39,0)
 ;;;                  both the <BS> and <DEL> keys delete the character to the
"RTN","ZVEMSH8",40,0)
 ;;;                  left of the cursor. You can do ..KEY to see what your <BS>
"RTN","ZVEMSH8",41,0)
 ;;;                  key is sending. If it's sending 127, the same as your <DEL>
"RTN","ZVEMSH8",42,0)
 ;;;                  key and you want these keys to delete the character to the
"RTN","ZVEMSH8",43,0)
 ;;;                  left of the cursor, set this parameter to SAME.
"RTN","ZVEMSH8",44,0)
 ;;;
"RTN","ZVEMSH8",45,0)
 ;;; V S H E L L   T I M E   O U T
"RTN","ZVEMSH8",46,0)
 ;;;
"RTN","ZVEMSH8",47,0)
 ;;; If no activity occurs at the '>>' prompt, the VShell will time out. It will
"RTN","ZVEMSH8",48,0)
 ;;; then look to see if you have a User QWIK named TO, and execute it. You can
"RTN","ZVEMSH8",49,0)
 ;;; set TO to run any M code you'd like. Setting TO="HALT" will cause the VShell
"RTN","ZVEMSH8",50,0)
 ;;; to quit.
"RTN","ZVEMSH8",51,0)
 ;;;
"RTN","ZVEMSH8",52,0)
 ;;; The VShell comes with its own screensaver which you can use by setting
"RTN","ZVEMSH8",53,0)
 ;;; TO="DO ^%ZVEMSTO". This screensaver will disable Control-C. Hitting any key
"RTN","ZVEMSH8",54,0)
 ;;; will return you back to your normal screen.
"RTN","ZVEMSH8",55,0)
 ;;;
"RTN","ZVEMSH8",56,0)
 ;;; To disable Control-Y in VAX DSM, set TO="DO VMS^%ZVEMSTO". Then set up the
"RTN","ZVEMSH8",57,0)
 ;;; following file called TIMEOUT.COM, in your Log-In Directory:
"RTN","ZVEMSH8",58,0)
 ;;;
"RTN","ZVEMSH8",59,0)
 ;;;     $ SET NOCONTROL=(T,Y)
"RTN","ZVEMSH8",60,0)
 ;;;     $ DEFINE/USER SYS$INPUT SYS$COMMAND
"RTN","ZVEMSH8",61,0)
 ;;;     $ DSM/UCI=VAH/VOL=ROU/ENV=MMPSMGR VMS1^%ZVEMSTO
"RTN","ZVEMSH8",62,0)
 ;;;
"RTN","ZVEMSH8",63,0)
 ;;; NOTE: In the last line, replace MMPSMGR with your own Mumps Manager account.
"RTN","ZVEMSH8",64,0)
 ;;;
"RTN","ZVEMSH8",65,0)
 ;;; The VSHELL also includes a screen blanker. Set TO="BLANK^%ZVEMSTO". If you're
"RTN","ZVEMSH8",66,0)
 ;;; on a VAX, change TIMEOUT.COM to call BLANK^%ZVEMSTO instead of VM1^%ZVEMSTO.
"RTN","ZVEMSH8",67,0)
 ;;;***
"RTN","ZVEMSH9")
0^253^B7480262
"RTN","ZVEMSH9",1,0)
ZVEMSH9 ;DJB,VSHL**VA KERNEL [04/17/94]
"RTN","ZVEMSH9",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMSH9",3,0)
 ;
"RTN","ZVEMSH9",4,0)
KERN ;;;
"RTN","ZVEMSH9",5,0)
 ;;; V A   K E R N E L
"RTN","ZVEMSH9",6,0)
 ;;;
"RTN","ZVEMSH9",7,0)
 ;;; The following information applies to those users who wish to run the VSHELL
"RTN","ZVEMSH9",8,0)
 ;;; as a VA KERNEL menu option.
"RTN","ZVEMSH9",9,0)
 ;;;
"RTN","ZVEMSH9",10,0)
 ;;; You create the VSHELL option as an Action type: X ^%ZVEMS. The name of the
"RTN","ZVEMSH9",11,0)
 ;;; option MUST include the word 'VSHELL'. This is important. If the name doesn't
"RTN","ZVEMSH9",12,0)
 ;;; include 'VSHELL' it will not run. The purpose for this naming convention is
"RTN","ZVEMSH9",13,0)
 ;;; to enable the VSHELL to know when it's being called as a VA KERNEL menu
"RTN","ZVEMSH9",14,0)
 ;;; option.
"RTN","ZVEMSH9",15,0)
 ;;;
"RTN","ZVEMSH9",16,0)
 ;;; The VSHELL sets a flag when it starts running. This flag prevents you from
"RTN","ZVEMSH9",17,0)
 ;;; starting a 2nd VSHELL. If you try to run the VSHELL menu option and get a
"RTN","ZVEMSH9",18,0)
 ;;; message saying "The VSHELL is already running", and you are not running
"RTN","ZVEMSH9",19,0)
 ;;; the VSHELL already, it's because this flag has not been cleared. You can
"RTN","ZVEMSH9",20,0)
 ;;; clear the flag 2 ways.
"RTN","ZVEMSH9",21,0)
 ;;;     1. Log off the system and log back on with a new $J.
"RTN","ZVEMSH9",22,0)
 ;;;     2. Enter Programmer Mode, kill XQY0, start the VSHELL and then HALT.
"RTN","ZVEMSH9",23,0)
 ;;;        This will delete the VSHELL's scratch global, clearing the flag. You
"RTN","ZVEMSH9",24,0)
 ;;;        can now DO ^ZU to reenter the VA KERNEL menu system and run the VSHELL
"RTN","ZVEMSH9",25,0)
 ;;;        option.
"RTN","ZVEMSH9",26,0)
 ;;;
"RTN","ZVEMSH9",27,0)
 ;;; If you enter the VSHELL from a VA KERNEL menu option, switch UCIs, and then
"RTN","ZVEMSH9",28,0)
 ;;; try to HALT, you will receive a message telling you to move back to the UCI
"RTN","ZVEMSH9",29,0)
 ;;; you first came in from, and then you can HALT.
"RTN","ZVEMSH9",30,0)
 ;;;
"RTN","ZVEMSH9",31,0)
 ;;; NOTE: If you run a VA KERNEL menu option using ^XUP while in the VSHELL, you
"RTN","ZVEMSH9",32,0)
 ;;; may be halted from the system upon return. This is NOT caused by the VSHELL,
"RTN","ZVEMSH9",33,0)
 ;;; but is a factor of the VA KERNEL software.
"RTN","ZVEMSH9",34,0)
 ;;;***
"RTN","ZVEMSLA")
0^254^B15237705
"RTN","ZVEMSLA",1,0)
ZVEMSLA ;DJB,VSHL**VA KERNEL Library Functions - Dates [8/18/95 1:30pm]
"RTN","ZVEMSLA",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMSLA",3,0)
 ;
"RTN","ZVEMSLA",4,0)
DATE ;;;
"RTN","ZVEMSLA",5,0)
 ;;; DATE FUNCTIONS - XLFDT
"RTN","ZVEMSLA",6,0)
 ;;;
"RTN","ZVEMSLA",7,0)
 ;;; HTFM(x,y)......%H to Fileman
"RTN","ZVEMSLA",8,0)
 ;;;      x = $H date (in quotes)
"RTN","ZVEMSLA",9,0)
 ;;;      y = 1 (optional) to return date portion only (no seconds)
"RTN","ZVEMSLA",10,0)
 ;;;      Ex: W $$HTFM^XLFDT("54786,40523",1)  --> 2901231
"RTN","ZVEMSLA",11,0)
 ;;;
"RTN","ZVEMSLA",12,0)
 ;;; FMTH(x,y)......Fileman to $H
"RTN","ZVEMSLA",13,0)
 ;;;      x = Fileman date
"RTN","ZVEMSLA",14,0)
 ;;;      y = 1 (Optional) no seconds.
"RTN","ZVEMSLA",15,0)
 ;;;      Ex: W $$FMTH^XLFDT(2901231.111523)   --> 54786,40523
"RTN","ZVEMSLA",16,0)
 ;;;
"RTN","ZVEMSLA",17,0)
 ;;; HTE(x,y)......$H to External
"RTN","ZVEMSLA",18,0)
 ;;;      x = $H date (in quotes)
"RTN","ZVEMSLA",19,0)
 ;;;      y = See FMTE(x,y) for alternate values
"RTN","ZVEMSLA",20,0)
 ;;;      Ex: W $$HTE^XLFDT("54786,40523")   --> Dec 31, 1990@11:15:23
"RTN","ZVEMSLA",21,0)
 ;;;
"RTN","ZVEMSLA",22,0)
 ;;; FMTE(x,y)......Fileman to External
"RTN","ZVEMSLA",23,0)
 ;;;      x = VA Fileman date
"RTN","ZVEMSLA",24,0)
 ;;;      y = optional - if null ('$D(y)) return written-out format
"RTN","ZVEMSLA",25,0)
 ;;;         if +y=1 return written-out format
"RTN","ZVEMSLA",26,0)
 ;;;         if +y=2 return in MM/DD/YY@HH:MM:SS format
"RTN","ZVEMSLA",27,0)
 ;;;         if +y=3 return in DD/MM/YY@HH:MM:SS format
"RTN","ZVEMSLA",28,0)
 ;;;         if +y=4 return in YY/MM/DD@HH:MM:SS format
"RTN","ZVEMSLA",29,0)
 ;;;         if y contains S return seconds
"RTN","ZVEMSLA",30,0)
 ;;;         if y contains D return date portion only
"RTN","ZVEMSLA",31,0)
 ;;;         if y contains P return in HH:MM:SS am/pm format
"RTN","ZVEMSLA",32,0)
 ;;;      Ex: W $$FMTE^XLFDT(2901231.111523,1)  --> Dec 31, 1990@11:15:23
"RTN","ZVEMSLA",33,0)
 ;;;          W $$FMTE^XLFDT(2901231.1115,"4D") --> 90/02/31
"RTN","ZVEMSLA",34,0)
 ;;;
"RTN","ZVEMSLA",35,0)
 ;;; DOW(x,y)......Day-of-Week
"RTN","ZVEMSLA",36,0)
 ;;;      x = VA Fileman date
"RTN","ZVEMSLA",37,0)
 ;;;      y = 1 (optional) to return day-of-week number
"RTN","ZVEMSLA",38,0)
 ;;;      Ex: W $$DOW^XLFDT(2901231.111523)     --> Monday
"RTN","ZVEMSLA",39,0)
 ;;;
"RTN","ZVEMSLA",40,0)
 ;;; HDIFF(x1,x2,x3)....$H Differences
"RTN","ZVEMSLA",41,0)
 ;;;      To calculate the difference between 2 dates in $H format.
"RTN","ZVEMSLA",42,0)
 ;;;      x1 = $H date (in quotes)
"RTN","ZVEMSLA",43,0)
 ;;;      x2 = $H date, to subtract from the x1 date
"RTN","ZVEMSLA",44,0)
 ;;;      x3 = see FMDIFF(x1,x2,x3) for alternative values
"RTN","ZVEMSLA",45,0)
 ;;;
"RTN","ZVEMSLA",46,0)
 ;;; FMDIFF(x1,x2,x3)....Fileman Difference
"RTN","ZVEMSLA",47,0)
 ;;;      To calculate the difference between 2 dates in VA Fileman format.
"RTN","ZVEMSLA",48,0)
 ;;;      x1 = VA Fileman date
"RTN","ZVEMSLA",49,0)
 ;;;      x2 = VA Fileman date to subtract from x1 date
"RTN","ZVEMSLA",50,0)
 ;;;      x3 = optional - if null return difference in days
"RTN","ZVEMSLA",51,0)
 ;;;          if x3=1 return difference in days (x1-x2)
"RTN","ZVEMSLA",52,0)
 ;;;          if x3=2 return difference in seconds
"RTN","ZVEMSLA",53,0)
 ;;;          if x3=3 return difference in DD HH:MM:SS format
"RTN","ZVEMSLA",54,0)
 ;;;      Ex: W $$FMDIFF^XLFDT(2901229,2901231.111523,1)   --> -2
"RTN","ZVEMSLA",55,0)
 ;;;          The 1st date is 2 days less than the 2nd date
"RTN","ZVEMSLA",56,0)
 ;;;          W $$FMDIFF^XLFDT(2901231.111523,2901229.173404,2)  --> 150079
"RTN","ZVEMSLA",57,0)
 ;;;          The 1st date is 150079 seconds greater than the 2nd date
"RTN","ZVEMSLA",58,0)
 ;;;
"RTN","ZVEMSLA",59,0)
 ;;; HADD(x,d,h,m,s)....$H Add
"RTN","ZVEMSLA",60,0)
 ;;;      To add days,hours,minutes, & seconds to a date in $H format (to x).
"RTN","ZVEMSLA",61,0)
 ;;;      x = $H date (in quotes)
"RTN","ZVEMSLA",62,0)
 ;;;      d = days
"RTN","ZVEMSLA",63,0)
 ;;;      h = hours
"RTN","ZVEMSLA",64,0)
 ;;;      m = minutes
"RTN","ZVEMSLA",65,0)
 ;;;      s = seconds
"RTN","ZVEMSLA",66,0)
 ;;;      Ex: W $$HADD^XLFDT("54786,3600",2,2,20,15)  --> 54788,12015
"RTN","ZVEMSLA",67,0)
 ;;;
"RTN","ZVEMSLA",68,0)
 ;;; FMADD(x,d,h,m,s)...Fileman Add
"RTN","ZVEMSLA",69,0)
 ;;;      Add days,hours,minutes, & seconds to a date in VA Fileman format (to x).
"RTN","ZVEMSLA",70,0)
 ;;;      x = VA Fileman date
"RTN","ZVEMSLA",71,0)
 ;;;      d,h,m,s same as HADD above
"RTN","ZVEMSLA",72,0)
 ;;;      Ex: W $$FMADD^XLFDT(2901231.01,2,2,20,15)  --> 2910102.032015
"RTN","ZVEMSLA",73,0)
 ;;;
"RTN","ZVEMSLA",74,0)
 ;;; NOW()...Current date/time in Fileman format
"RTN","ZVEMSLA",75,0)
 ;;;      Ex: W $$NOW^XLFDT  --> 2921009.08425
"RTN","ZVEMSLA",76,0)
 ;;;
"RTN","ZVEMSLA",77,0)
 ;;; DT()....Current date in Fileman format
"RTN","ZVEMSLA",78,0)
 ;;;      Ex: W $$DT^XLFDT  --> 2921009
"RTN","ZVEMSLA",79,0)
 ;;;***
"RTN","ZVEMSLB")
0^255^B6120940
"RTN","ZVEMSLB",1,0)
ZVEMSLB ;DJB,VSHL**VA KERNEL Library Functions - String [8/18/95 1:31pm]
"RTN","ZVEMSLB",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMSLB",3,0)
 ;
"RTN","ZVEMSLB",4,0)
STRING ;;;
"RTN","ZVEMSLB",5,0)
 ;;; STRING FUNCTIONS - XLFSTR
"RTN","ZVEMSLB",6,0)
 ;;;
"RTN","ZVEMSLB",7,0)
 ;;; UP(x)......Uppercase
"RTN","ZVEMSLB",8,0)
 ;;;      Convert string in x to all uppercase letters
"RTN","ZVEMSLB",9,0)
 ;;;      Ex: W $$UP^XLFSTR("freedom")    --> "FREEDOM"
"RTN","ZVEMSLB",10,0)
 ;;;
"RTN","ZVEMSLB",11,0)
 ;;; LOW(x).....Lowercase
"RTN","ZVEMSLB",12,0)
 ;;;      Comvert string in x to all lowercase letters
"RTN","ZVEMSLB",13,0)
 ;;;      Ex: W $$LOW^XLFSTR("JUSTICE")   --> "justice"
"RTN","ZVEMSLB",14,0)
 ;;;
"RTN","ZVEMSLB",15,0)
 ;;; STRIP(x,y).....Strip a string
"RTN","ZVEMSLB",16,0)
 ;;;      Strip all instances of character y in string x
"RTN","ZVEMSLB",17,0)
 ;;;      Ex: W $$STRIP^XLFSTR("hello","e")   --> "hllo"
"RTN","ZVEMSLB",18,0)
 ;;;
"RTN","ZVEMSLB",19,0)
 ;;; REPEAT(x,y)....Repeat a string
"RTN","ZVEMSLB",20,0)
 ;;;      Repeat the value of x for y number of times
"RTN","ZVEMSLB",21,0)
 ;;;      Ex: W $$REPEAT^XLFSTR("-",10)   --> "----------"
"RTN","ZVEMSLB",22,0)
 ;;;
"RTN","ZVEMSLB",23,0)
 ;;; INVERT(x)....Invert a string
"RTN","ZVEMSLB",24,0)
 ;;;      Invert the order of characters in string x
"RTN","ZVEMSLB",25,0)
 ;;;      Ex: W $$INVERT^XLFSTR("ABC")   --> "CBA"
"RTN","ZVEMSLB",26,0)
 ;;;
"RTN","ZVEMSLB",27,0)
 ;;; REPLACE(in,.spec)....Replace strings
"RTN","ZVEMSLB",28,0)
 ;;;      Replace specified strings
"RTN","ZVEMSLB",29,0)
 ;;;      in  input string
"RTN","ZVEMSLB",30,0)
 ;;;      spec  an array passed by reference
"RTN","ZVEMSLB",31,0)
 ;;;      Ex: SET spec("aa")="a",spec("pqr")="alabama"
"RTN","ZVEMSLB",32,0)
 ;;;          $$REPLACE^XLFSTR("aaaaaaapqraaaaaaa",.spec)   --> "aaaaalabamaaaaa"
"RTN","ZVEMSLB",33,0)
 ;;;          SET spec("F")="File",spec("M")="Man"
"RTN","ZVEMSLB",34,0)
 ;;;          $$REPLACE^XLFSTR("FM",.spec)  --> "FileMan"
"RTN","ZVEMSLB",35,0)
 ;;;
"RTN","ZVEMSLB",36,0)
 ;;; RJ(s,i,p)...Right Justify
"RTN","ZVEMSLB",37,0)
 ;;; LJ(s,i,p)...Left Justify
"RTN","ZVEMSLB",38,0)
 ;;; CJ(s,i,p)...Center Justify
"RTN","ZVEMSLB",39,0)
 ;;;      Right,left,center Justify a character string
"RTN","ZVEMSLB",40,0)
 ;;;      s = character string
"RTN","ZVEMSLB",41,0)
 ;;;      i = field size
"RTN","ZVEMSLB",42,0)
 ;;;      p = pad character(optional)
"RTN","ZVEMSLB",43,0)
 ;;;      Ex: W "[",$$RJ^XLFSTR("SAM",10),"]"  --> [        SAM]
"RTN","ZVEMSLB",44,0)
 ;;;          W "[",$$RJ^XLFSTR("SAM",10,"-"),"]"  --> [--------SAM]
"RTN","ZVEMSLB",45,0)
 ;;;          W "[",$$LJ^XLFSTR("DON",10),"]"  --> [DON        ]
"RTN","ZVEMSLB",46,0)
 ;;;          W "[",$$CJ^XLFSTR("SUE",10),"]"  --> [    SUE    ]
"RTN","ZVEMSLB",47,0)
 ;;;***
"RTN","ZVEMSLC")
0^256^B7539969
"RTN","ZVEMSLC",1,0)
ZVEMSLC ;DJB,VSHL**VA KERNEL Library Functions - Math [04/17/94]
"RTN","ZVEMSLC",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMSLC",3,0)
 ;
"RTN","ZVEMSLC",4,0)
MATH ;;;
"RTN","ZVEMSLC",5,0)
 ;;; MATH FUNCTIONS - XLFMTH
"RTN","ZVEMSLC",6,0)
 ;;;
"RTN","ZVEMSLC",7,0)
 ;;; ABS(%X).......Absolute Value
"RTN","ZVEMSLC",8,0)
 ;;;      Returns absolute value of the number in %X.
"RTN","ZVEMSLC",9,0)
 ;;;
"RTN","ZVEMSLC",10,0)
 ;;; MIN(%1,%2)....Minimum
"RTN","ZVEMSLC",11,0)
 ;;;      Returns minimum value between numbers in %1 and %2.
"RTN","ZVEMSLC",12,0)
 ;;;
"RTN","ZVEMSLC",13,0)
 ;;; MAX(%1,%2)....Maximum
"RTN","ZVEMSLC",14,0)
 ;;;      Returns maximum value between numbers in %1 and %2.
"RTN","ZVEMSLC",15,0)
 ;;;
"RTN","ZVEMSLC",16,0)
 ;;; LN(%X)........Natural Log
"RTN","ZVEMSLC",17,0)
 ;;;      Returns natural log of %X (log base e).
"RTN","ZVEMSLC",18,0)
 ;;;      Ex: W $$LN^XLFMTH(4.627426)  --> 1.532
"RTN","ZVEMSLC",19,0)
 ;;;
"RTN","ZVEMSLC",20,0)
 ;;; EXP(%X).......Exponents
"RTN","ZVEMSLC",21,0)
 ;;;      Return e to the %X power.
"RTN","ZVEMSLC",22,0)
 ;;;      Ex: W $$EXP^XLFMTH(1.532)  --> 4.627426
"RTN","ZVEMSLC",23,0)
 ;;;
"RTN","ZVEMSLC",24,0)
 ;;; PWR(%X,%Y)....Power
"RTN","ZVEMSLC",25,0)
 ;;;      Raise %X to the %Y power.
"RTN","ZVEMSLC",26,0)
 ;;;      Ex: W $$PWR^XLFMTH(3,2)   --> 9
"RTN","ZVEMSLC",27,0)
 ;;;
"RTN","ZVEMSLC",28,0)
 ;;; LOG(%X).......Log
"RTN","ZVEMSLC",29,0)
 ;;;      Calculate logarithm (log base 10).
"RTN","ZVEMSLC",30,0)
 ;;;      Ex: W $$LOG^XLFMTH(3.1415  --> .497137
"RTN","ZVEMSLC",31,0)
 ;;;
"RTN","ZVEMSLC",32,0)
 ;;; TAN(%X).......Tangent
"RTN","ZVEMSLC",33,0)
 ;;;      Calculate tangent of %X (tan X = sin X / cos X) in radians.
"RTN","ZVEMSLC",34,0)
 ;;;      Ex: W $$TAN^XLFMTH(.7853982)  --> 1.000
"RTN","ZVEMSLC",35,0)
 ;;;
"RTN","ZVEMSLC",36,0)
 ;;; SIN(%X).......Sine
"RTN","ZVEMSLC",37,0)
 ;;;      Calculate sine of %X in radians.
"RTN","ZVEMSLC",38,0)
 ;;;      Ex: W $$SIN^XLFMTH(.7853982)  --> .707107
"RTN","ZVEMSLC",39,0)
 ;;;
"RTN","ZVEMSLC",40,0)
 ;;; COS(%X).......Cosine
"RTN","ZVEMSLC",41,0)
 ;;;      Calculate cosine of %X in radians.
"RTN","ZVEMSLC",42,0)
 ;;;      Ex: W $$COS^XLFMTH(.7853982)  --> .707096
"RTN","ZVEMSLC",43,0)
 ;;;
"RTN","ZVEMSLC",44,0)
 ;;; DTR(%X)......Degrees to Radians
"RTN","ZVEMSLC",45,0)
 ;;;      Convert numbers of degrees to number of radians.
"RTN","ZVEMSLC",46,0)
 ;;;      Ex: W $$DTR^XLFMTH(45)  --> .7853982
"RTN","ZVEMSLC",47,0)
 ;;;
"RTN","ZVEMSLC",48,0)
 ;;; RTD(%X)......Radians to Degrees
"RTN","ZVEMSLC",49,0)
 ;;;      Convert number of radians to number of degrees.
"RTN","ZVEMSLC",50,0)
 ;;;
"RTN","ZVEMSLC",51,0)
 ;;; PI().........PI=3.1415927
"RTN","ZVEMSLC",52,0)
 ;;;      Returns Pi.
"RTN","ZVEMSLC",53,0)
 ;;;
"RTN","ZVEMSLC",54,0)
 ;;; E()..........e=2.718283
"RTN","ZVEMSLC",55,0)
 ;;;      Returns e.
"RTN","ZVEMSLC",56,0)
 ;;;
"RTN","ZVEMSLC",57,0)
 ;;; SQRT(%X).....Square Root
"RTN","ZVEMSLC",58,0)
 ;;;      Returns square root of %X.
"RTN","ZVEMSLC",59,0)
 ;;;      Ex: W $$SQRT^XLFMTH(144)  --> 12
"RTN","ZVEMSLC",60,0)
 ;;;
"RTN","ZVEMSLC",61,0)
 ;;; SD...........Standard Deviation
"RTN","ZVEMSLC",62,0)
 ;;;      Only available as a call: D SD^XTFN with input variables of
"RTN","ZVEMSLC",63,0)
 ;;;      SX=sum, SSX=sum of squares, and N=count. Standard deviation
"RTN","ZVEMSLC",64,0)
 ;;;      is returned in SD.
"RTN","ZVEMSLC",65,0)
 ;;;***
"RTN","ZVEMSLD")
0^257^B6932697
"RTN","ZVEMSLD",1,0)
ZVEMSLD ;DJB,VSHL**VA KERNEL Library Functions - Measurement [04/17/94]
"RTN","ZVEMSLD",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMSLD",3,0)
 ;
"RTN","ZVEMSLD",4,0)
MEAS ;;;
"RTN","ZVEMSLD",5,0)
 ;;; MEASUREMENT FUNCTIONS - XLFMSMT
"RTN","ZVEMSLD",6,0)
 ;;;
"RTN","ZVEMSLD",7,0)
 ;;; WEIGHT(val,from,to).......Weight Measurement
"RTN","ZVEMSLD",8,0)
 ;;;      Converts metric to U.S. and visa versa.
"RTN","ZVEMSLD",9,0)
 ;;;
"RTN","ZVEMSLD",10,0)
 ;;;       val = must contain a positive numeric value
"RTN","ZVEMSLD",11,0)
 ;;;      from = units of measure of val
"RTN","ZVEMSLD",12,0)
 ;;;        to = units of measure to convert val to
"RTN","ZVEMSLD",13,0)
 ;;;
"RTN","ZVEMSLD",14,0)
 ;;;      Ex: W $$WEIGHT(12,"LB","G")  --> 5448 G
"RTN","ZVEMSLD",15,0)
 ;;;
"RTN","ZVEMSLD",16,0)
 ;;;    Valid units:
"RTN","ZVEMSLD",17,0)
 ;;;       t = metric tons          tn = tons
"RTN","ZVEMSLD",18,0)
 ;;;      kg = kilograms            lb = pounds
"RTN","ZVEMSLD",19,0)
 ;;;       g = grams                oz = ounces
"RTN","ZVEMSLD",20,0)
 ;;;      mg = milligrams           gr = grain
"RTN","ZVEMSLD",21,0)
 ;;;
"RTN","ZVEMSLD",22,0)
 ;;; LENGTH(val,from,to).......Length Measurement
"RTN","ZVEMSLD",23,0)
 ;;;
"RTN","ZVEMSLD",24,0)
 ;;;      Ex: W $$LENGTH(12,"IN","CM")  --> 30.480 CM
"RTN","ZVEMSLD",25,0)
 ;;;
"RTN","ZVEMSLD",26,0)
 ;;;    Valid units:
"RTN","ZVEMSLD",27,0)
 ;;;       km = kilometers          mi = miles
"RTN","ZVEMSLD",28,0)
 ;;;        m = meters              yd = yards
"RTN","ZVEMSLD",29,0)
 ;;;       cm = centimeters         ft = feet
"RTN","ZVEMSLD",30,0)
 ;;;       mm = millmeters          in = inches
"RTN","ZVEMSLD",31,0)
 ;;;
"RTN","ZVEMSLD",32,0)
 ;;; VOLUME(val,from,to).......Weight Measurement
"RTN","ZVEMSLD",33,0)
 ;;;
"RTN","ZVEMSLD",34,0)
 ;;;      Ex: W $$VOLUME(12,"CF","ML")  --> 339800.832 ML
"RTN","ZVEMSLD",35,0)
 ;;;
"RTN","ZVEMSLD",36,0)
 ;;;    Valid units:
"RTN","ZVEMSLD",37,0)
 ;;;       kl = kiloliter           cf = cubic feet
"RTN","ZVEMSLD",38,0)
 ;;;       hl = hectoliter          ci = cubic inch
"RTN","ZVEMSLD",39,0)
 ;;;      dal = dekaliter          gal = gallon
"RTN","ZVEMSLD",40,0)
 ;;;        l = liters              qt = quart
"RTN","ZVEMSLD",41,0)
 ;;;       dl = deciliter           pt = pint
"RTN","ZVEMSLD",42,0)
 ;;;       cl = centiliter           c = cup
"RTN","ZVEMSLD",43,0)
 ;;;       ml = milliliter          oz = ounze
"RTN","ZVEMSLD",44,0)
 ;;;
"RTN","ZVEMSLD",45,0)
 ;;; BSA(ht,wt).......Body Surface Area Measurement
"RTN","ZVEMSLD",46,0)
 ;;;
"RTN","ZVEMSLD",47,0)
 ;;;       ht = height in centimeters
"RTN","ZVEMSLD",48,0)
 ;;;       wt = weight in kilograms
"RTN","ZVEMSLD",49,0)
 ;;;
"RTN","ZVEMSLD",50,0)
 ;;;      Ex: W $$BSA^XLFMSMT(175,86)  --> 1.63
"RTN","ZVEMSLD",51,0)
 ;;;      Ex: W $$BSA($$LENGTH^XLFMSMT(69,"IN","CM"),$$WEIGHT^XLFMSMT(180,"LB",...
"RTN","ZVEMSLD",52,0)
 ;;;          "KG"))  --> 1.57
"RTN","ZVEMSLD",53,0)
 ;;;
"RTN","ZVEMSLD",54,0)
 ;;; TEMP(val,from,to).......Temperature Measurement
"RTN","ZVEMSLD",55,0)
 ;;;
"RTN","ZVEMSLD",56,0)
 ;;;      Ex: W $$TEMP^XLFMSMT(72,"F","C")  --> 22.222 C
"RTN","ZVEMSLD",57,0)
 ;;;
"RTN","ZVEMSLD",58,0)
 ;;;    Valid units:
"RTN","ZVEMSLD",59,0)
 ;;;       f = Fahrenheit           c = Celsius
"RTN","ZVEMSLD",60,0)
 ;;;***
"RTN","ZVEMSN")
0^258^B24843046
"RTN","ZVEMSN",1,0)
ZVEMSN ;DJB,VSHL**VPE Notes [2/1/97 10:32am]
"RTN","ZVEMSN",2,0)
 ;;12;VPE;;COPYRIGHT David Bolduc @1993;Build 8
"RTN","ZVEMSN",3,0)
 ;
"RTN","ZVEMSN",4,0)
NOTES ;;;;
"RTN","ZVEMSN",5,0)
 ;;; ----->   V P E   P A R A M E T E R   P A S S I N G
"RTN","ZVEMSN",6,0)
 ;;;
"RTN","ZVEMSN",7,0)
 ;;; NOTE: When entering fields, if the field is a multiple you MUST use the
"RTN","ZVEMSN",8,0)
 ;;; field's name, not it's number. When entering file or field names, if the
"RTN","ZVEMSN",9,0)
 ;;; name contains a space you MUST enclose the name in quotes.
"RTN","ZVEMSN",10,0)
 ;;;
"RTN","ZVEMSN",11,0)
 ;;; 1) VEDD  PARAM^%ZVEMD(File Name/Num,Menu Option Mnemonic,Field Names/Nums)
"RTN","ZVEMSN",12,0)
 ;;;          Ind Fld Sum............DO PARAM^%ZVEMD("USER","I",".01;2")
"RTN","ZVEMSN",13,0)
 ;;;          Fld Global Location....DO PARAM^%ZVEMD("USER","G",30)
"RTN","ZVEMSN",14,0)
 ;;;          ..VEDD USER I .01;2
"RTN","ZVEMSN",15,0)
 ;;;          ..VEDD "NEW PERSON" G 30
"RTN","ZVEMSN",16,0)
 ;;;
"RTN","ZVEMSN",17,0)
 ;;; 2) VGL   PARAM^%ZVEMG(^Global -or- File Name)
"RTN","ZVEMSN",18,0)
 ;;;          DO PARAM^%ZVEMG("^VA(200")      ..VGL ^VA(200
"RTN","ZVEMSN",19,0)
 ;;;          DO PARAM^%ZVEMG("NEW PERSON")   ..VGL "NEW PERSON"
"RTN","ZVEMSN",20,0)
 ;;;
"RTN","ZVEMSN",21,0)
 ;;; 3) VRR   PARAM^%ZVEMR(Routine Name)
"RTN","ZVEMSN",22,0)
 ;;;          DO PARAM^%ZVEMR("ZVEMD")        ..VRR ZVEMD
"RTN","ZVEMSN",23,0)
 ;;;
"RTN","ZVEMSN",24,0)
 ;;; ----->   V P E   P R O G R A M M E R   C A L L S
"RTN","ZVEMSN",25,0)
 ;;;
"RTN","ZVEMSN",26,0)
 ;;; 1) SINGLE CHARACTER READ
"RTN","ZVEMSN",27,0)
 ;;;    S X=$$READ^%ZVEMKRN   X=String, VEE("K")=Key, VEE array left defined
"RTN","ZVEMSN",28,0)
 ;;;
"RTN","ZVEMSN",29,0)
 ;;; 2) STRING EDITOR
"RTN","ZVEMSN",30,0)
 ;;;    S CD=String D SCREEN^%ZVEMKEA("PROMPT:",2,75)
"RTN","ZVEMSN",31,0)
 ;;;    CD=Edited String, VEESHC=<RET>, VEE array left defined
"RTN","ZVEMSN",32,0)
 ;;;
"RTN","ZVEMSN",33,0)
 ;;; 3) CHOICE SELECTION
"RTN","ZVEMSN",34,0)
 ;;;    W !?2,"Proceed with deletion?" S X=$$CHOICE^%ZVEMKC("YES^NO",1,10,21)
"RTN","ZVEMSN",35,0)
 ;;;    1=Option to be highlighted 10,21=$X,$Y (use when placing prompts)
"RTN","ZVEMSN",36,0)
 ;;;    For MSM, RM0 is in effect, after calling CHOICE.
"RTN","ZVEMSN",37,0)
 ;;;    Returns number of CHOICE selected, or 0. VEE array left defined.
"RTN","ZVEMSN",38,0)
 ;;;
"RTN","ZVEMSN",39,0)
 ;;; 4) MENU
"RTN","ZVEMSN",40,0)
 ;;;    Copy ^ZVEMSH,^ZVEMSHY. Change any calls to the new rtns.
"RTN","ZVEMSN",41,0)
 ;;;    Edit subroutine INIT^ROUTINE:
"RTN","ZVEMSN",42,0)
 ;;;          COLUMNS="6^7"   ;Number of options in each column
"RTN","ZVEMSN",43,0)
 ;;;          WIDTH=31        ;Width of reverse video
"RTN","ZVEMSN",44,0)
 ;;;          HD=Heading      ;Heading for new menu
"RTN","ZVEMSN",45,0)
 ;;;    Insert ";;***" in MENU lines and adj COLUMNS to reduce number of menu
"RTN","ZVEMSN",46,0)
 ;;;    options. Can be more than 2 columns. Edit TOPICS^ROUTINE for subheadings.
"RTN","ZVEMSN",47,0)
 ;;;          Ex: TOPICS+1 - ;;;E D I T;;;3;4
"RTN","ZVEMSN",48,0)
 ;;;
"RTN","ZVEMSN",49,0)
 ;;; 5) GENERIC SELECTOR
"RTN","ZVEMSN",50,0)
 ;;;    Put items in an array.
"RTN","ZVEMSN",51,0)
 ;;;    Call SELECTOR, passing 3 parameters:
"RTN","ZVEMSN",52,0)
 ;;;          Parameter 1: Array root
"RTN","ZVEMSN",53,0)
 ;;;          Parameter 2: 1=All choices in the display will be numbered
"RTN","ZVEMSN",54,0)
 ;;;          Parameter 3: 1=NEW allowed. This adds menu option N=New to bottom
"RTN","ZVEMSN",55,0)
 ;;;                       of the screen. ^TMP("VPE","SELECT",$J,"NEW")="" will
"RTN","ZVEMSN",56,0)
 ;;;                       be returned if user hits N. This allows user to
"RTN","ZVEMSN",57,0)
 ;;;                       indicate that they want to add a new entry.
"RTN","ZVEMSN",58,0)
 ;;;
"RTN","ZVEMSN",59,0)
 ;;;    SELECTOR will return items selected in ^TMP("VPE","SELECT",$J)
"RTN","ZVEMSN",60,0)
 ;;;
"RTN","ZVEMSN",61,0)
 ;;;    Example: Build array of names:
"RTN","ZVEMSN",62,0)
 ;;;               ^TMP("TEST",$J,1)="Bolduc,David J."
"RTN","ZVEMSN",63,0)
 ;;;               ^TMP("TEST",$J,2)="Duck,Donald"
"RTN","ZVEMSN",64,0)
 ;;;               ^TMP("TEST",$J,3)="Mouse,Mickey"
"RTN","ZVEMSN",65,0)
 ;;;             Call SELECTOR:
"RTN","ZVEMSN",66,0)
 ;;;               D SELECT^%ZVEMKT("^TMP(""TEST"","_$J_")",1)
"RTN","ZVEMSN",67,0)
 ;;;             SELECTOR returns items selected:
"RTN","ZVEMSN",68,0)
 ;;;               ^TMP("VPE","SELECT",$J,1)="Bolduc,David J."
"RTN","ZVEMSN",69,0)
 ;;;
"RTN","ZVEMSN",70,0)
 ;;;    You can control what SELECTOR returns in ^TMP("VPE","SELECT",$J).
"RTN","ZVEMSN",71,0)
 ;;;    When array is built, concantenate what you want returned, to the front
"RTN","ZVEMSN",72,0)
 ;;;    of the array node using $C(9) as a delimiter. A common returned value
"RTN","ZVEMSN",73,0)
 ;;;    is the item's Internal Entry Number. The SELECTOR will only display
"RTN","ZVEMSN",74,0)
 ;;;    the characters to the right of the $C(9).
"RTN","ZVEMSN",75,0)
 ;;;
"RTN","ZVEMSN",76,0)
 ;;;    The default heading is "Select: ITEMS". You can replace the word ITEMS
"RTN","ZVEMSN",77,0)
 ;;;    with a word of your choice by setting a "HD" node in your array.
"RTN","ZVEMSN",78,0)
 ;;;
"RTN","ZVEMSN",79,0)
 ;;;    Example:
"RTN","ZVEMSN",80,0)
 ;;;               ^TMP("TEST",$J,"HD")="PARTICIPANT"
"RTN","ZVEMSN",81,0)
 ;;;               ^TMP("TEST",$J,1)="234"_$C(9)_"Bolduc,David J."
"RTN","ZVEMSN",82,0)
 ;;;               ^TMP("TEST",$J,2)="45"_$C(9)_"Duck,Donald"
"RTN","ZVEMSN",83,0)
 ;;;               ^TMP("TEST",$J,3)="14"_$C(9)_"Mouse,Mickey"
"RTN","ZVEMSN",84,0)
 ;;;    If Bolduc were selected, SELECTOR would return:
"RTN","ZVEMSN",85,0)
 ;;;               ^TMP("VPE","SELECT",$J,1)="234$C(9)Bolduc,David J."
"RTN","ZVEMSN",86,0)
 ;;;
"RTN","ZVEMSN",87,0)
 ;;; 6) FILEMAN FIELD SELECTOR
"RTN","ZVEMSN",88,0)
 ;;;    D SELECT^%ZVEMKTF(FileNumber,LEVEL)
"RTN","ZVEMSN",89,0)
 ;;;    LEVEL: "TOP"=Top level flds only  "ALL"=Include multiple flds
"RTN","ZVEMSN",90,0)
 ;;;    Example: D SELECT^%ZVEMKTF(200,"TOP")
"RTN","ZVEMSN",91,0)
 ;;;             Allows you to select from all top level fields
"RTN","ZVEMSN",92,0)
 ;;;             of the NEW PERSON file.
"RTN","ZVEMSN",93,0)
 ;;;    Returns array: ^TMP("VPE","FIELDS",$J,FILE#,FIELD#)
"RTN","ZVEMSN",94,0)
 ;;;***
"VER")
8.0^22.0
**END**
**END**
